{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.0.14.6",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Найдено по артикулам",
                                                "Variable": "finded_by_article",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "20",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f031",
                                "Variable": "btn_goods_ocr"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "6",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "btn_previous_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "@Good",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "btn_next_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Маркировка",
                                "Variable": "btn_marks_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good",
                                        "Variable": "id_good",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@code_art",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@unit_name",
                                        "Variable": "id_unit",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Групповая обработка",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "runprogress",
                                "type": "python",
                                "method": "gs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "CButtons"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Cинхронизировать данные с 1С",
                                "Variable": "sync_doc"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить все сканы на 1С",
                                "Variable": "send_all_scan_lines"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "7",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "@Good",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#7A005C",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Подтвердите действие",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@group_scan_message",
                                        "Variable": "group_scan_message",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Адресное хранение",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_adr_type_select",
                                                "Variable": "doc_adr_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@documents_list",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_title",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "16",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "12",
                                                        "Elements": [
                                                            {
                                                                "Value": "",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "2",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "Elements": [
                                                            {
                                                                "Value": "Текущая ячейка: ",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@current_cell",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextSize": "20",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "10",
                                                "Elements": [
                                                    {
                                                        "Value": "х",
                                                        "Variable": "btn_clear_cell",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextSize": "18",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Табл.",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@tables_type",
                                                "Variable": "table_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выбрать ячейку",
                                "Variable": "btn_select_cell"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@article",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@item_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Сбор ШК",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Шаблон распознавания",
                                "Variable": "btn_ocr_serial_template_settings"
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_find_serial_cv"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "ШаблонРаспознавания",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Количество цифр",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_num_amount",
                                        "Variable": "ocr_serial_template_num_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Префикс",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_prefix",
                                        "Variable": "ocr_serial_template_prefix",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "@current_ocr_serial_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Товары",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Товары список",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Категория:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_txt",
                                        "Variable": "error_txt",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Карточка товара",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "buttons",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Цены",
                                                "Variable": "to_prices",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Остатки",
                                                "Variable": "to_balances",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "name",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_name",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextSize": "22",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@item_key",
                                                "Variable": "item_key",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "good_info",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_type",
                                                "Variable": "good_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "art",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_art",
                                                        "Variable": "good_art",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "code",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Код:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_code",
                                                        "Variable": "good_code",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "descr",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Описание:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "CardsLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@load_info",
                                        "Variable": "load_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_item_good_barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_post_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор категории товаров ",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@goods_types_cards",
                                        "Variable": "goods_types_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Остатки",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверить остатки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Выбор склада:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "art",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул товара:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@item_art_input",
                                                                "Variable": "item_art_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "cell",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "info_block",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@error_msg",
                                        "Variable": "error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Запросить остатки",
                                        "Variable": "get_balance_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextSize": "15",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@balances_table",
                                        "Variable": "balances_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Цены",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверка цен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул товара:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "TextItalic": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "EditTextText"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "price_type",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Тип цены:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "properties",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Характеристики:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@property_select",
                                                                "Variable": "property_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "units",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Упаковка:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_object_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_price_type_name",
                                        "Variable": "selected_price_type_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_property_name",
                                        "Variable": "selected_property_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_unit_name",
                                        "Variable": "selected_unit_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@prices_error_msg",
                                        "Variable": "prices_error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_table",
                                        "Variable": "prices_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Параметры",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки и обмен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Разрешить ввод факт товара",
                                        "Variable": "allow_fact_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Оффлайн режим",
                                        "Variable": "offline_mode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Настройки HTTP подключения",
                                        "Variable": "btn_http_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки шрифтов",
                                        "Variable": "btn_size",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки звука",
                                        "Variable": "btn_sound_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки документов",
                                        "Variable": "btn_documents_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Тест сканера",
                                        "Variable": "btn_test_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Лог ошибок",
                                        "Variable": "btn_err_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить данные на  HTTP сервер",
                                        "Variable": "btn_upload_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Обмен с HTTP 1c сервером",
                                        "Variable": "btn_timer",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки печати",
                                        "Variable": "btn_print_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "СписокФайлов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@files_list",
                                        "Variable": "files_list",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "MultilineText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки Шрифтов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Размеры",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@TitleTextSize",
                                        "Variable": "TitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTitleTextSize",
                                        "Variable": "CardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardDateTextSize",
                                        "Variable": "CardDateTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTextSize",
                                        "Variable": "CardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@GoodsCardTitleTextSize",
                                        "Variable": "GoodsCardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@goodsTextSize",
                                        "Variable": "goodsTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@SeriesPropertiesTextSize",
                                        "Variable": "SeriesPropertiesTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@DocTypeCardTextSize",
                                        "Variable": "DocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@titleDocTypeCardTextSize",
                                        "Variable": "titleDocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_on_save",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_sizes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_size_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Тест сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_1",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_2",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_3",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_4",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_5",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_6",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_7",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "test_barcode_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Очистить",
                                                "Variable": "btn_clear_err",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "@date_sort_select",
                                                "Variable": "date_sort_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_log_table",
                                        "Variable": "error_log_table",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки http соединения",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@url",
                                        "Variable": "url",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user",
                                        "Variable": "user",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@pass",
                                        "Variable": "pass",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user_name",
                                        "Variable": "user_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@btn_test_connection",
                                        "Variable": "btn_test_connection",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@ANDROID_ID",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera2"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройка звука",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@event_cards",
                                        "Variable": "event_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки документов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Время хранения",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Укажите сколько дней документы будут храниться на устройстве.",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_delete_settings_days",
                                        "Variable": "doc_delete_settings_days",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Удалять устаревшие документы",
                                        "Variable": "doc_settings_confirm_delete_old_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Отладка",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Отладочный экран",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить лог",
                                        "Variable": "btn_unload_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Создать таблицы БД",
                                        "Variable": "btn_init",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Заполнить Ratio",
                                        "Variable": "btn_fill_ratio",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_listener",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Печать",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки печати",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройка Bluetooth принтера",
                                        "Variable": "btn_bluetooth_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка WiFi принтера",
                                        "Variable": "btn_wifi_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка шаблонов печати",
                                        "Variable": "btn_label_templates_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Печать через Bluetooth",
                                        "Variable": "check_box_bluetooth_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Печать через WiFi",
                                        "Variable": "check_box_wifi_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Список шаблонов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@templates_cards",
                                        "Variable": "templates_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Результат",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Шаблон:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@html",
                                        "Variable": "html",
                                        "height": "300",
                                        "width": "match_parent",
                                        "orientation": "vertical",
                                        "weight": "3",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "html"
                                    },
                                    {
                                        "Value": "@matching_table",
                                        "Variable": "matching_table_values",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Параметры штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Ширина",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_width",
                                                "Variable": "barcode_width",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Высота",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_height",
                                                "Variable": "barcode_height",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Тип:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_types",
                                                "Variable": "barcode_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Влево",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_left",
                                                "Variable": "barcode_left",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вправо",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_right",
                                                "Variable": "barcode_right",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вверх",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_up",
                                                "Variable": "barcode_up",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вниз",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_down",
                                                "Variable": "barcode_down",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "НастройкаСоответствияДиалог",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "layout",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@list_field",
                                        "Variable": "select_field",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "SpinnerLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Bluetooth",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки принтера Bluetooth",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать присоединенные",
                                        "Variable": "btn_show_connected",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Начать сканирование",
                                        "Variable": "btn_start_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Остановить сканирование",
                                        "Variable": "btn_stop_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_print",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Сбросить подключение",
                                        "Variable": "btn_bt_disconnect",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Подключенный принтер:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@default_printer",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "set",
                                "method": "BTGetBounded",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати WiFi",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Укажите ip устройства",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_ip",
                                        "Variable": "wi_fi_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Сохранить IP",
                                        "Variable": "btn_wifi_save_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить IP",
                                        "Variable": "btn_wifi_delete_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@info_wifi_current_ip",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_wi_fi",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Код ZPL для печати:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_zpl_input",
                                        "Variable": "wi_fi_zpl_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Напечатать zpl",
                                        "Variable": "btn_wi_fi_print_zpl",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Шаблоны",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки шаблонов ценников и этикеток",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Получить шаблоны с сервера",
                                        "Variable": "btn_get_labels",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@current_label_template_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Выбрать из списка",
                                        "Variable": "btn_select_label_template",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить настройки шаблонов печати",
                                        "Variable": "btn_delete_template_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка размеров шаблона",
                                        "Variable": "btn_label_template_size_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@preview_label_template_image",
                                        "Variable": "",
                                        "height": "300",
                                        "width": "match_parent",
                                        "weight": "3",
                                        "type": "Picture"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Размеры",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "label Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@width_print_template",
                                                        "Variable": "width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Label Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@height_print_template",
                                                        "Variable": "height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Img Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_width_print_template",
                                                        "Variable": "image_width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Img Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_height_print_template",
                                                        "Variable": "image_height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "LL",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_ll_print_template",
                                                        "Variable": "image_ll_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "PW",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_pw_print_template",
                                                        "Variable": "image_pw_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сдвиг вправо",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_x_print_template",
                                                        "Variable": "image_x_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Сдвиг вниз",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_y_print_template",
                                                        "Variable": "image_y_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "dpmm",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "6;8;12;24",
                                                        "Variable": "dpmm_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            }
                                        ],
                                        "StrokeWidth": "5"
                                    },
                                    {
                                        "Value": "@image_print",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Picture"
                                    }
                                ],
                                "StrokeWidth": "5"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить на печать",
                                "Variable": "btn_sent_to_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Сохранить шаблон",
                                "Variable": "btn_save_template_sizes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Удалить шаблон",
                                "Variable": "btn_delete_print_template"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Проводник",
                "DefineOnBackPressed": false,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проводник файлов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Вверх",
                                        "Variable": "btn_get_up",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@file_browser_cards",
                                        "Variable": "file_browser_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SeriesProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SeriesSelectScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@properties_name",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@series_cards",
                                        "Variable": "series_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_series_ocr_serial_number"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Настройки шаблона",
                                "Variable": "btn_ocr_serial_template_settings"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "FillingSeriesScreen",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "1",
                                "Elements": [
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Имя серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@name",
                                                "Variable": "name",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Номер серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@number",
                                                "Variable": "number",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Дата производства:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@production_date",
                                                "Variable": "production_date",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Годен до: ",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@best_before",
                                                "Variable": "best_before",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Количество:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@FillingSeriesScreen_qtty",
                                                "Variable": "FillingSeriesScreen_qtty",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "orientation": "horizontal",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "CVOperationName": "Распознавание артикулов",
                "type": "CVOperation",
                "hidden": true,
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "OCR",
                        "CVResolution": "VGA",
                        "CVMode": "list_and_grey",
                        "CVActionButtons": "Обработать",
                        "CVAction": "Поиск по артикулу",
                        "CVInfo": "@art_info",
                        "CVCameraDevice": "Back",
                        "Handlers": [
                            {
                                "event": "OnObjectDetected",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_object_detected",
                                "postExecute": ""
                            },
                            {
                                "event": "OnInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "OnCreate",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SelectItemProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SelectItemScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@SelectItemScreen_items_cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowItemsScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowMarksScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_marks_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_marks_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "BarcodeRegistration",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "BarcodeRegistration",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод товара",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "22",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good_name_barcode",
                                        "Variable": "good_name_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Штрихкод:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@scanned_barcode",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "properties",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Характеристика:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@property_select",
                                                "Variable": "property_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "units",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Упаковка:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@unit_select",
                                                "Variable": "unit_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_ok",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@barcodes_data",
                                        "Variable": "barcodes_data",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_click",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "OcrTextRecognition",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SerialNumberOCRSettings",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Количество цифр",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_num_amount",
                                                "Variable": "ocr_serial_template_num_amount",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Префикс",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_prefix",
                                                "Variable": "ocr_serial_template_prefix",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@ocr_serial_current_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_save_ocr_settings",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple",
            "vendor_url": "",
            "vendor_auth": "",
            "handler_split_mode": false,
            "handler_code": "",
            "handler_url": "",
            "handler_auth": "",
            "dictionaries": ""
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "FaceRecognitionURL": "",
        "ForegroundService": false,
        "StopForegroundServiceOnExit": false,
        "RunPython": true,
        "LaunchProcess": "",
        "MainMenu": [
            {
                "MenuId": "01",
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuTop": false
            },
            {
                "MenuId": "02",
                "MenuItem": "update_conf",
                "MenuTitle": "Обновить конфигурацию",
                "MenuTop": false
            }
        ],
        "Mediafile": [],
        "PyHandlers": "aW1wb3J0IHNtX2Fkcl9kb2NzCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKaW1wb3J0IHVpX21vZGVscwpmcm9tIHVpX21vZGVscyBpbXBvcnQgY3JlYXRlX3NjcmVlbgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgojID09PT09PT09PT09PT09PSBNYWluIGV2ZW50cyA9PT09PT09PT09PT09PT09PQoKCkBIYXNoTWFwKCkKZGVmIGFwcF9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J7QsdGA0LDQsdC+0YLRh9C40Log0L/RgNC4INGB0YLQsNGA0YLQtSDQv9GA0LjQu9C+0LbQtdC90LjRjyAiIiIKCiAgICBtb2RlbCA9IHVpX21vZGVscy5NYWluRXZlbnRzKGhhc2hfbWFwKQogICAgbW9kZWwuYXBwX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0aW1lcl91cGRhdGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRhNC+0L3QvtCy0L7Qs9C+INC+0LHQvNC10L3QsCAiIiIKCiAgICB0aW1lciA9IHVpX21vZGVscy5UaW1lcihoYXNoX21hcCkKICAgIHRpbWVyLnRpbWVyX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBldmVudF9zZXJ2aWNlKGhhc2hfbWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0YDQsNCx0L7RgtGLINCc0J8g0LIg0YDQtdC20LjQvNC1INGB0LXRgNCy0LXRgNCwLgogICAgINCSIHdzX2JvZHkg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0LvQtdC20LjRgiDRgtC10LrRgdGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCAiIiIKCiAgICB1aV9tb2RlbHMuV2ViU2VydmljZVN5bmNDb21tYW5kKGhhc2hfbWFwKS5vbl9zZXJ2aWNlX3JlcXVlc3QoKQoKCgpASGFzaE1hcCgpCmRlZiBvbl9zcWxfZXJyb3IoaGFzaF9tYXApOgogICAgbW9kZWwgPSB1aV9tb2RlbHMuTWFpbkV2ZW50cyhoYXNoX21hcCkKICAgIG1vZGVsLm9uX3NxbF9lcnJvcigpCgoKQEhhc2hNYXAoKQpkZWYgb25fY2xvc2VfYXBwKGhhc2hfbWFwKToKICAgICMg0J/QvtC/0YvRgtC60LAg0L7Rh9C40YHRgtC60Lgg0LrRjdGI0LAg0L/RgNC4INCy0YvRhdC+0LTQtSDRgSDQv9GA0LjQu9C+0LbQtdC90LjRjwogICAgc3VDbGFzcy5kZWxldGVDYWNoZSgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBNYWluIGV2ZW50cyBeXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09IERvY3VtZW50cyA9PT09PT09PT09PT09PT09PQpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCe0YLQtNC10LvRjNC90YvQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC/0LvQuNGC0L7QuiDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDQv9GA0L7RhtC10YHRgdCwIGhhc2hfbWFwJ9C+0LwiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5GbG93RG9jU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd1RpbGVzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dUaWxlc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfZmxvd19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0KHQsdC+0YAg0KjQmi4g0K3QutGA0LDQvTog0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd0RvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX2Zsb3dfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCh0LHQvtGAINCo0JouINCt0LrRgNCw0L06INCf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgYXJ0aWNsZV9jdl9vbl9vYmplY3RfZGV0ZWN0ZWQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7Qsi4g0KjQsNCzOiDQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVi4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5BY3RpdmVDVkFydGljbGVSZWNvZ25pdGlvbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fb2JqZWN0X2RldGVjdGVkKCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpYWxfbnVtYmVyX29jcl9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTogT2NyVGV4dFJlY29nbml0aW9uLiDQrdC60YDQsNC9OiBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmlhbF9udW1iZXJfb2NyX3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiBPY3JUZXh0UmVjb2duaXRpb24uINCt0LrRgNCw0L06IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlcmlhbE51bWJlck9DUlNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6IE9jclRleHRSZWNvZ25pdGlvbi4g0K3QutGA0LDQvTogU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MuIiIiCiAgICB1aV9tb2RlbHMuU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Muc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgZG9jc190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyA9IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdzX3RpbGVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5UaWxlcykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgdGlsZXNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuRG9jdW1lbnRzRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Eb2N1bWVudHNEb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5Eb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKCiMgQEhhc2hNYXAoKQojIGRlZiBkb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiMgICAgIHNjcmVlbjogdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQojICAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2xpc3RlbmVyKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2JlZm9yZV9wcm9jZXNzX2JhcmNvZGUoaGFzaF9tYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRgdC40L3RhdGA0L7QvdC90L7Qs9C+INC30LDQv9GA0L7RgdCwINC4INC+0LHQvdC+0LLQu9C10L3QuNGPINC00LDQvdC90YvRhSDQv9C+0YHQu9C1INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyDQuCDQv9C10YDQtdC0INC+0LHRgNCw0LHQvtGC0LrQvtC5INCo0JoiIiIKCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uYmVmb3JlX3Byb2Nlc3NfYmFyY29kZSgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZChoYXNoX21hcCk6CiAgICAiIiIg0J7RgtC/0YDQsNCy0LrQsCDQtNCw0L3QvdGL0YUg0L/QvtGB0LvQtSDQvtCx0YDQsNCx0L7RgtC60Lgg0KjQmiIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5oYXNoX21hcC5yZW1vdmUoJ3RvYXN0JykKICAgIHNjcmVlbi5wb3N0X2JhcmNvZGVfc2Nhbm5lZCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3NjYW5fZXJyb3Jfc291bmQoaGFzaF9tYXApOgogICAgIiIiINCX0LLRg9C60L7QstGL0LUg0YHQuNCz0L3QsNC70Ysg0L7RiNC40LHQvtC6INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zY2FuX2Vycm9yX3NvdW5kKCkKCgpASGFzaE1hcCgpCmRlZiBoaWdobGlnaHRfc2Nhbm5lZF9pdGVtKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0L7RgtC80LXQvdGLINGA0LDRgdC60YDQsNGB0LrQuCDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAgIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uZGlzYWJsZV9oaWdobGlnaHQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfcG9zdF9saW5lc19kYXRhKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntGC0L/RgNCw0LLQutCwINC90LAgMdChINCy0YvQsdGA0LDQvdC90YvRhSDQsiBub3NxbCDRgdGC0YDQvtC6IHBvc3Qt0LfQsNC/0YDQvtGB0L7QvCAiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3KGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zZW5kX3Vuc2VudF9saW5lc19ydW4oKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfYWxsX3NjYW5fbGluZXMoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0YLQv9GA0LDQstC60LAg0L3QsCAx0KEg0LLRgdC10YUgbm9zcWwg0YHRgtGA0L7QuiDRgtC+0LLQsNGA0LAgcG9zdC3Qt9Cw0L/RgNC+0YHQvtC8ICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLnNlbmRfYWxsX3NjYW5fbGluZXNfcnVuKCkKCgpASGFzaE1hcCgpCmRlZiBhZnRlcl9zZW5kX3Bvc3RfbGluZXNfZGF0YShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J/QvtGB0LvQtSDQvtGC0L/RgNCw0LLQutC4LdC+0LHRgNCw0LHQvtGC0LrQuCBwb3N0LdC30LDQv9GA0L7RgdCwICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLmFmdGVyX3NlbmRfZGF0YSgpCgoKQEhhc2hNYXAoKQpkZWYgYWRyX2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbigKICAgICAgICBoYXNoX21hcD1oYXNoX21hcCwKICAgICAgICBzY3JlZW5fY2xhc3M9c21fYWRyX2RvY3MuQWRyRG9jc0xpc3RTY3JlZW4KICAgICkKICAgIHNjcmVlbi5pbml0X3NjcmVlbigpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgaGFzaF9tYXA9aGFzaF9tYXAsCiAgICAgICAgc2NyZWVuX2NsYXNzPXNtX2Fkcl9kb2NzLkFkckRvY3NMaXN0U2NyZWVuCiAgICApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCBzbV9hZHJfZG9jcy5BZHJEb2NEZXRhaWxzU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZG9jX2RldGFpbHNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyRG9jRGV0YWlsc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vZmZsaW5lX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Eb2NzT2ZmbGluZUxpc3RTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBlbGVtX3ZpZXZfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBlbGVtX3ZpZXZfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZWxlbV92aWV3X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHNtX2Fkcl9kb2NzLkFkckdvb2RzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZWxlbV92aWV3X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHNtX2Fkcl9kb2NzLkFkckdvb2RzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfcmVnaXN0ZXJfZG9jX29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5CYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfcmVnaXN0ZXJfZG9jX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5CYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2VsZW1fdmlld19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuSXRlbVNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBncm91cF9lbGVtX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2Nhbkl0ZW1TY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2VsZW1fdmlld19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuSXRlbVNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9lcnJvcl9zY3JlZW5fbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgaWYgaGFzaF9tYXBbJ2xpc3RlbmVyJ10gaW4gWydPTl9CQUNLX1BSRVNTRUQnLCAnYnRuX2NvbnRpbnVlX3NjYW4nXToKICAgICAgICBoYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl4gRG9jdW1lbnRzIF5eXl5eXl5eXl5eXl5eXl5eCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfaXRlbV9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VsZWN0SXRlbVNjcmVlbikub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X2l0ZW1fb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNlbGVjdEl0ZW1TY3JlZW4pLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfaXRlbV9yZXN1bHQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgaGFzaF9tYXAudG9hc3QoJ3NlbGVjdF9pdGVtX3Jlc3VsdCcpCgpASGFzaE1hcCgpCmRlZiBzaG93X2l0ZW1zX3NjcmVlbl9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2hvd0l0ZW1zU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCkBIYXNoTWFwKCkKZGVmIHNob3dfaXRlbXNfc2NyZWVuX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TaG93SXRlbXNTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKQEhhc2hNYXAoKQpkZWYgc2hvd19tYXJrc19zY3JlZW5fb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNob3dNYXJrc1NjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBzaG93X21hcmtzX3NjcmVlbl9vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2hvd01hcmtzU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojID09PT09PT09PT09PT09PSBHb29kcyA9PT09PT09PT09PT09PT09PQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hb29kc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4uaW5pdF9zY3JlZW4oKS5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZHNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X3R5cGVfZ29vZHNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlbGVjdEdvb2RzVHlwZShoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF90eXBlX2dvb2RzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RHb29kc1R5cGUoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBnb29kX2NhcmRfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkl0ZW1DYXJkKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBnb29kX2NhcmRfcG9zdF9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuSXRlbUNhcmQpCiAgICBzY3JlZW4ub25fcG9zdF9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5JdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgb2ZmbGluZV9nb29kX2NhcmRfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkl0ZW1DYXJkT2ZmbGluZVNjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl4gR29vZHMgXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNCYWxhbmNlcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgYmFsYW5jZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuR29vZHNCYWxhbmNlc0l0ZW1DYXJkID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgYmFsYW5jZXNfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdvb2RzQmFsYW5jZXNJdGVtQ2FyZChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzQmFsYW5jZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNQcmljZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIHByaWNlc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR29vZHNQcmljZXNJdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpY2VzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hb29kc1ByaWNlc0l0ZW1DYXJkKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCkBIYXNoTWFwKCkKZGVmIHNlcmllc19saXN0X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNlcmllc1NlbGVjdFNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmllc19saXN0X29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNlcmllc1NlbGVjdFNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmllc19pdGVtX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNlcmllc0l0ZW0gPSAgY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNlcmllc0l0ZW0pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmllc19pdGVtX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNlcmllc0l0ZW0gPSAgY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNlcmllc0l0ZW0pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzUHJpY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09IFNldHRpbmdzID09PT09PT09PT09PT09PT09CgpASGFzaE1hcCgpCmRlZiBzZXR0aW5nc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXR0aW5nc1NjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3Nfb25fY2xpY2soaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGZvbnRfc2l6ZXNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRm9udFNpemVTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGZvbnRfc2l6ZV9zZXR0aW5nc19saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5Gb250U2l6ZVNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgdGVzdF9iYXJjb2RlX2xpc3RlbmVyKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkJhcmNvZGVUZXN0U2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3NfZXJyb3JzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkVycm9yTG9nU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3NfZXJyb3JzX29uX2NsaWNrKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkVycm9yTG9nU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgaHR0cF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5IdHRwU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBodHRwX3NldHRpbmdzX29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkh0dHBTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNvdW5kX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Tb3VuZFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgc291bmRfc2V0dGluZ3NfbGlzdGVuZXIoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNvdW5kU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2N1bWVudHNfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LDRgNCw0LzQtdGC0YDRiy4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jdW1lbnRzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2N1bWVudHNfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LDRgNCw0LzQtdGC0YDRiy4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jdW1lbnRzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eIFNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PSBQcmludCA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50U2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlbXBsYXRlX2xpc3Rfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LIiIiIKICAgIHNjcmVlbjogdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QgPSB1aV9tb2RlbHMuVGVtcGxhdGVzTGlzdChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlbXBsYXRlX2xpc3Rfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LIiIiIKICAgIHNjcmVlbjogdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QgPSB1aV9tb2RlbHMuVGVtcGxhdGVzTGlzdChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0bWxfdmlld19vbl9zdGFydChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQoNC10LfRg9C70YzRgtCw0YIiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5IdG1sVmlldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0bWxfdmlld19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQoNC10LfRg9C70YzRgtCw0YIiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5IdG1sVmlldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2JsdWV0b290aF9zZXR0aW5nc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IEJsdWV0b290aCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50Qmx1ZXRvb3RoU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9ibHVldG9vdGhfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludEJsdWV0b290aFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2hfbWFwKToKICAgICIiItCe0LHRidC40Lkg0L7QsdGA0LDQsdC+0YLRh9C40Log0L7RiNC40LHQutC4INC/0YDQuCDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBCbHVldG9vdGgiIiIKICAgIFByaW50U2VydmljZS5ibHVldG9vdGhfZXJyb3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfd2lmaV9zZXR0aW5nc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IFdpRmkiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFdpRmlTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X3dpZmlfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRXaUZpU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF93aWZpKGhhc2hfbWFwKToKICAgICIiItCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBXaUZpLiDQlNC+0LvQttC10L0g0LHRi9GC0Ywg0LLRi9C30LLQsNC9INCw0YHQuNC90YXRgNC+0L3QvdC+IiIiCiAgICBQcmludFNlcnZpY2UucHJpbnRfd2lmaShoYXNoX21hcCkKCgpASGFzaE1hcCgpCmRlZiB3aWZpX2Vycm9yKGhhc2hfbWFwKToKICAgICIiItCe0LHRidC40Lkg0L7QsdGA0LDQsdC+0YLRh9C40Log0L7RiNC40LHQutC4INC/0YDQuCDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBXaUZpIiIiCiAgICBQcmludFNlcnZpY2Uud2lmaV9lcnJvcihoYXNoX21hcCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50TGFiZWxUZW1wbGF0ZXNTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRMYWJlbFRlbXBsYXRlc1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfbGFiZWxfdGVtcGxhdGVfc2l6ZV9vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCg0LDQt9C80LXRgNGLIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRUZW1wbGF0ZVNpemVTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlX3NpemVfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50VGVtcGxhdGVTaXplU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXApOgogICAgIiIi0KHRgNCw0LHQsNGC0YvQstCw0LXRgiDQv9C+0YHQu9C1INCy0YvQt9C+0LLQsCBQcmludFNlcnZpY2UucHJpbnQg0Lgg0L/QtdGH0LDRgtCw0LXRgiDRhtC10L3QvdC40LoiIiIKICAgIFByaW50U2VydmljZS5wcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXApCgojIF5eXl5eXl5eXl5eXl5eXl5eIFByaW50IF5eXl5eXl5eXl5eXl5eXl5eCgoKQEhhc2hNYXAoKQpkZWYgZmlsZV9icm93c2VyX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TaW1wbGVGaWxlQnJvd3NlcihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGZpbGVfYnJvd3Nlcl9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2ltcGxlRmlsZUJyb3dzZXIoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojID09PT09PT09PT09PT09PSBEZWJ1ZyA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgZGVidWdfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRGVidWdTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRlYnVnX2xpc3RlbmVyKGhhc2hfbWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzY3JlZW46IHVpX21vZGVscy5EZWJ1Z1NldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgojIF5eXl5eXl5eXl5eXl5eXl5eIERlYnVnIF5eXl5eXl5eXl5eXl5eXl5eCgoK",
        "pyHandlersPath": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\main.py",
        "PyTimerTask": [
            {
                "PyTimerTaskKey": "timer_update",
                "PyTimerTaskDef": "timer_update",
                "PyTimerTaskPeriod": "15000",
                "PyTimerTaskBuilIn": false
            }
        ],
        "PyFiles": [
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\database_init_queryes.py",
                "PyFileKey": "database_init_queryes",
                "PyFileData": "I2ltcG9ydCB1aV9nbG9iYWwKZGVmIGRhdGFiYXNlX3NoZW1hKCk6CiAgICBScyA9IFtdCgoKICAgICPQmtC+0L3RgdGC0LDQvdGC0Ysg0Lgg0YXRgNCw0L3QuNC80YvQtSDQvdCw0YHRgtGA0L7QudC60LggUlNfY29uc3RhbnRzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19jb25zdGFudHMgKAogICAgICAgIGlkICAgICAgICAgICAgIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICB1c2Vfc2VyaWVzICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgdXNlX3Byb3BlcnRpZXMgVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHVzZV9tYXJrICAgICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBhZGRfaWZfbm90X2luX3BsYW4gICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBwYXRoICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUZBVUxUICIvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvIiwKICAgICAgICBkZWxldGVfZmlsZXMgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgcmVzZXJ2ZWQgICAgICAgVEVYVCAgICBOT1QgTlVMTCwKICAgICAgICBtYXhfaWRfZG9jICAgICAgICAgSU5URUdFUiBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMSksCiAgICAgICAgYWxsb3dfb3ZlcnNjYW4gVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHJlbGVhc2UgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCgogICAgIyDQmtC70LDRgdGB0LjRhNC40LrQsNGC0L7RgCDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPIFJTX2NsYXNzaWZpZXJfdW5pdHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NsYXNzaWZpZXJfdW5pdHMgKAogICAgICAgIGlkIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgY29kZSAgICBURVhUIE5PVCBOVUxMLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICMg0JLQuNC00Ysg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3R5cGVzX2dvb2RzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU190eXBlc19nb29kcyAoCiAgICBpZCAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgbmFtZSAgICAgVEVYVCBOT1QgTlVMTCwKICAgIHVzZV9tYXJrIElOVCAgREVGQVVMVCAoMCkgCiAgICApCiAgICAnJycpCgogICAgIyDQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAgUlNfZ29vZHMKICAgIFJzLmFwcGVuZCgnJycKICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19nb29kcyAoCiAgICAgICAgICAgIGlkICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgICAgIGNvZGUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIG5hbWUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIGFydCAgICAgICAgIFRFWFQsCiAgICAgICAgICAgIHVuaXQgICAgICAgIFRFWFQgIFJFRkVSRU5DRVMgUlNfY2xhc3NpZmllcl91bml0cyAoaWQpLAogICAgICAgICAgICB0eXBlX2dvb2QgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU190eXBlc19nb29kcyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVRDSCBbRlVMTF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQKICAgICAgICApCiAgICAgICAgJycnKQoKCiAgICAjINCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3Byb3BlcnRpZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3Byb3BlcnRpZXMgKAogICAgaWQgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBPTiBDT05GTElDVCBSRVBMQUNFLAogICAgaWRfb3duZXIgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCkgT04gREVMRVRFIE5PIEFDVElPTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gVVBEQVRFIE5PIEFDVElPTiwKICAgIG5hbWUgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCgogICAgIyDQo9C/0LDQutC+0LLQutC4INCV0LTQuNC90LjRhtGLINC40LfQvNC10YDQtdC90LjRjyBSU191bml0cwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfdW5pdHMgKAogICAgICAgIGlkICAgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgaWRfb3duZXIgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBjb2RlICAgICAgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgbmFtZSAgICAgICAgICBURVhUICAgIE5PVCBOVUxMLAogICAgICAgIG5vbWluYXRvciAgICAgSU5URUdFUiBOT1QgTlVMTCwKICAgICAgICBkZW5vbWluYXRvciAgIElOVEVHRVIgTk9UIE5VTEwsCiAgICAgICAgaW50X3JlZHVjdGlvbiBURVhUICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgoKCiAgICAjINCh0LXRgNC40Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3NlcmllcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfc2VyaWVzICgKICAgICAgICBpZCAgICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBiZXN0X2JlZm9yZSAgICAgVEVYVCwKICAgICAgICB0eXBlX2dvb2RzICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBwcm9kdWN0aW9uX2RhdGUgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICPQmNC90LTQtdC60YHRiyBSU19zZXJpZXMKICAgIFJzLmFwcGVuZCgnJydDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyAgU2VyaWVzX25hbWUgT04gUlNfc2VyaWVzICgKICAgIG5hbWUgQVNDICkKICAgICcnJykKCiAgICAjINCo0YLRgNC40YXQutC+0LTRiyBSU19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCAnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNvZGVzICgKICAgIGJhcmNvZGUgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBpZF9nb29kICAgICBURVhUIE5PVCBOVUxMLAogICAgaWRfcHJvcGVydHkgVEVYVCwKICAgIGlkX3NlcmllcyAgIFRFWFQsCiAgICBpZF91bml0ICAgICBURVhULAogICAgcmF0aW8gICAgICAgSU5UICBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgogICAgI9Ca0L7QtNGLINC80LDRgNC60LjRgNC+0LLQutC4IFJTX21hcmtpbmdfY29kZXMKICAgIFJzLmFwcGVuZCggJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19tYXJraW5nX2NvZGVzICgKICAgICAgICBpZCAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBtYXJrX2NvZGUgICBURVhUIE5PVCBOVUxMLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9wcm9wZXJ0eSBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSAKICAgICkKICAgICcnJykKCgoKICAgICMg0JrQvtC90YLRgNCw0LPQtdC90YLRiyBSU19jb3VudHJhZ2VudHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NvdW50cmFnZW50cyAoCiAgICAgICAgaWQgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgbmFtZSAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgZnVsbF9uYW1lIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgaW5uICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAga3BwICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCh0LrQu9Cw0LTRiyBSU193YXJlaG91c2VzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU193YXJlaG91c2VzICgKICAgICAgICBpZCBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NlbGxzICgKICAgIGlkICAgVEVYVCBQUklNQVJZIEtFWQogICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgbmFtZSBURVhUIE5PVCBOVUxMLAogICAgYmFyY29kZSBURVhUCiAgICApJycnKQoKICAgICMg0JLQuNC00Ysg0YbQtdC9INC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZV90eXBlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfcHJpY2VfdHlwZXMgKAogICAgICAgIGlkICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCm0LXQvdGLINC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3ByaWNlcyAoCiAgICAgICAgaWQgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX3ByaWNlX3R5cGVzIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBpZF9nb29kcyAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICAgICAgaWRfcHJvcGVydGllcyAgVEVYVCAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgcHJpY2UgICAgICAgICAgUkVBTCwKICAgICAgICBpZF91bml0ICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3VuaXRzIChpZCkgCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jX3R5cGVzICgKICAgIGRvY190eXBlIFRFWFQgUFJJTUFSWSBLRVkgT04gQ09ORkxJQ1QgUkVQTEFDRQogICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICBpc19hZHJfc3RvcmFnZSBJTlQgIERFRkFVTFQgKDApIAogICAgKQogICAgJycnKQoKICAgICMg0JLRgdC1INC00L7QutGD0LzQtdC90YLRiyDRgdC/0LjRgdC60L7QvCBSU19kb2NzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfY291bnRyYWdlbnRzICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfY291bnRyYWdlbnRzIChpZCksCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUIERFRkFVTFQgMCwKICAgICAgICBpc19ncm91cF9zY2FuICAgICAgVEVYVCBERUZBVUxUIDAsCiAgICAgICAgaXNfYmFyY19mbG93ICAgICAgIFRFWFQgREVGQVVMVCAwLAogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgICBURVhUIERFRkFVTFQgMAogICAgICAgIAogICAgKQogICAgJycnKQoKCiAgICAjINCi0LDQsdC70LjRh9C90LDRjyDRh9Cw0YHRgtGMINC00L7QutGD0LzQtdC90YLQvtCyIFJTX2RvY3NfdGFibGUKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfdGFibGUgKAogICAgICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICBpZF9kb2MgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICAgICAgaWRfZ29vZCAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgICAgIGlkX3Byb3BlcnRpZXMgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgaWRfc2VyaWVzICAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSwKICAgICAgICBxdHR5ICAgICAgICAgIFJFQUwsCiAgICAgICAgZF9xdHR5ICAgICAgICBSRUFMLCAgCiAgICAgICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgICAgIHByaWNlICAgICAgICAgUkVBTCwKICAgICAgICBpZF9wcmljZSAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBzZW50ICAgICAgICAgIElOVEVHRVIsCiAgICAgICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGlzX3BsYW4gICAgICAgVEVYVCBERUZBVUxUICJUcnVlIiwKICAgICAgICBpZF9jZWxsICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgSU5URUdFUiBERUZBVUxUIDAgCiAgICApCiAgICAnJycpCgoKICAgICMg0JrQvtC00Ysg0LzQsNGA0LrQuNGA0L7QstC60Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1IFJTX2RvY3NfYmFyY29kZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfYmFyY29kZXMgKAogICAgaWQgICAgICAgICAgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgaWRfZG9jICAgICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUsCiAgICBpZF9nb29kICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydHkgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJvcGVydGllcyAoaWQpLAogICAgaWRfc2VyaWVzICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfc2VyaWVzIChpZCksCiAgICBpZF91bml0ICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpICwKICAgIG1hcmtfY29kZSAgICAgICAgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICBiYXJjb2RlX2Zyb21fc2Nhbm5lciAgICBURVhULAogICAgaXNfcGxhbiAgICAgICAgICAgICAgICAgSU5URUdFUiBERUZBVUxUIDAgTk9UIE5VTEwsCiAgICBhcHByb3ZlZCAgICAgICAgICAgICAgICBJTlRFR0VSIERFRkFVTFQgMCwKICAgIEdUSU4gICAgICAgICAgICAgICAgICAgIFRFWFQsCiAgICBTZXJpZXMgICAgICAgICAgICAgICAgICBURVhUCiAgICApCiAgICAnJycpCgogICAgI9Cf0L7RgtC+0Log0L/RgNC+0LjQt9Cy0L7Qu9GM0L3Ri9GFINGI0YLRgNC40YXQutC+0LTQvtCyCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19iYXJjX2Zsb3cgKAogICAgaWRfZG9jICBURVhUIFJFRkVSRU5DRVMgUlNfZG9jcyAoaWRfZG9jKSwKICAgIGJhcmNvZGUgVEVYVAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzICgKICAgIGlkX2RvYyAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX24gICAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX2RhdGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICB2ZXJpZmllZCAgICAgICAgICAgSU5URUdFUiwKICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgYWRkX21hcmtfc2VsZWN0aW9uIElOVEVHRVIsCiAgICBjcmVhdGVkX2F0ICAgICAgICAgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwKICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICBERUZBVUxUIDAsCiAgICBhbGxvd19mYWN0X2lucHV0ICAgVEVYVCBERUZBVUxUIDAKICAgIAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzX3RhYmxlICgKICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19hZHJfZG9jcyAoaWRfZG9jKSBPTiBERUxFVEUgQ0FTQ0FERQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBTRVQgREVGQVVMVCwKICAgIGlkX2dvb2QgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydGllcyBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpLAogICAgcXR0eSAgICAgICAgICBSRUFMLAogICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgc2VudCAgICAgICAgICBJTlRFR0VSLAogICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiAgICAgICBURVhUICAgICBERUZBVUxUIFRydWUsCiAgICBpZF9jZWxsICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwgCiAgICB0YWJsZV90eXBlICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFQgJ291dCcsCiAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkKICAgICkKICAgICcnJykKCiAgICBScy5hcHBlbmQoJycnCiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRXJyb3JfbG9nICgKICAgICAgICBsb2cgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoJycpLAogICAgICAgIHRpbWVzdGFtcCBEQVRFVElNRSBERUZBVUxUIChDVVJSRU5UX1RJTUVTVEFNUCkpIAogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgbmFtZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX2JhcmNvZGUgT04gUlNfY2VsbHMgKAogICAgYmFyY29kZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3Nfc2VyaWVzICgKICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsCiAgICBpZF9kb2MgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICBpZF9nb29kICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICBpZF9wcm9wZXJ0aWVzICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3dhcmVob3VzZSAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3dhcmVob3VzZXMgKGlkKSwKICAgIHF0dHkgICAgICAgICAgICBSRUFMLAogICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgYmVzdF9iZWZvcmUgICAgIERBVEVUSU1FLAogICAgbnVtYmVyICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgY2VsbCAgICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSBPTiBERUxFVEUgTk8gQUNUSU9OCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICknJycpCgoKCiMgUlNfY29uc3RhbnRzICsgUlNfY2xhc3NpZmllcl91bml0cyArIFJTX3R5cGVzX2dvb2RzCiMgICAgIFJzID0gKyBSU19nb29kcyArIFJTX3Byb3BlcnRpZXNcCiMgICAgICAgICAgKyBSU19zZXJpZXMgKyBSU191bml0cyArIFJTX2JhcmNvZGVzICsgUlNfbWFya2luZ19jb2RlcyArIFJTX2RvY3MgKyBSU19kb2NzX2JhcmNvZGVzXAojICAgICAgICAgICsgUlNfZG9jc190YWJsZSArIFJTX3ByaWNlX3R5cGVzICsgUlNfcHJpY2VzICsgUlNfY291bnRyYWdlbnRzICsgUlNfd2FyZWhvdXNlcwoKICAgIHJldHVybiBScwojcHJpbnQoZGF0YWJhc2Vfc2hlbWEoKSkKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2NvbnN0YW50cykKICAgICMgUnMuYXBwZW5kKFJTX2NsYXNzaWZpZXJfdW5pdHMpCiAgICAjIFJzLmFwcGVuZChSU190eXBlc19nb29kcykKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2dvb2RzKQogICAgIyBScy5hcHBlbmQoUlNfcHJvcGVydGllcykKICAgICMgUnMuYXBwZW5kKFJTX3NlcmllcykKICAgICMgUnMuYXBwZW5kKFJTX3VuaXRzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19tYXJraW5nX2NvZGVzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfZG9jcykKICAgICMgUnMuYXBwZW5kKFJTX2RvY3NfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19kb2NzX3RhYmxlKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfcHJpY2VfdHlwZXMpCiAgICAjIFJzLmFwcGVuZChSU19wcmljZXMpCiAgICAjCiAgICAjIFJzLmFwcGVuZChSU19jb3VudHJhZ2VudHMpCiAgICAjIFJzLmFwcGVuZChSU193YXJlaG91c2VzKQogICAgI3VpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KFJzKQoK"
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\db_services.py",
                "PyFileKey": "db_services",
                "PyFileData": "aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YSwgdGltZXpvbmUKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIExpdGVyYWwsIE9wdGlvbmFsCgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVTUUxQcm92aWRlciBhcyBzcWxDbGFzcwpmcm9tIHVpX2dsb2JhbCBpbXBvcnQgZ2V0X3F1ZXJ5X3Jlc3VsdCwgYnVsa19xdWVyeQpmcm9tIHRpbnlfZGJfc2VydmljZXMgaW1wb3J0IFNjYW5uaW5nUXVldWVTZXJ2aWNlLCBMb2dnZXJTZXJ2aWNlCgoKY2xhc3MgRGJTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSAnJwogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IE5vbmUKICAgICAgICBzZWxmLmRlYnVnID0gRmFsc2UKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlID0gTG9nZ2VyU2VydmljZSgpCgogICAgZGVmIF93cml0ZV9lcnJvcl9vbl9sb2coc2VsZiwgZXJyb3JfdGV4dDogc3RyKToKICAgICAgICBpZiBlcnJvcl90ZXh0OgogICAgICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlLndyaXRlX3RvX2xvZygKICAgICAgICAgICAgICAgIGVycm9yX3R5cGU9IlNRTCIsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PWVycm9yX3RleHQsCiAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSJEQlNlcnZpY2UiCiAgICAgICAgICAgICkKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtczogc3RyID0gJycsIHRhYmxlX25hbWU9JycpOgoKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCgpjbGFzcyBUaW1lclNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2ludF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQoKICAgIGRlZiBzYXZlX2xvYWRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX3ByZXBhcmVfZGF0YV90b19zYXZlKGRhdGEpCgogICAgICAgIGNsZWFyX3RhYmxlcyA9IFsnUlNfZG9jc190YWJsZScsICdSU19hZHJfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfZG9jc19zZXJpZXMnXQoKICAgICAgICBmb3IgdGFibGVfbmFtZSwgdmFsdWVzIGluIGRhdGEuaXRlbXMoKToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiBjbGVhcl90YWJsZXMgYW5kIHZhbHVlczoKICAgICAgICAgICAgICAgIGlkX2RvYyA9IHZhbHVlc1swXVsnaWRfZG9jJ10KICAgICAgICAgICAgICAgIF9maWx0ZXIgPSB7J2lkX2RvYyc6IGlkX2RvY30KCiAgICAgICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyKQogICAgICAgICAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKHZhbHVlcykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucHJvdmlkZXIucmVwbGFjZSh2YWx1ZXMpCgogICAgZGVmIF9wcmVwYXJlX2RhdGFfdG9fc2F2ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiAnUlNfZG9jc19iYXJjb2RlcycgaW4gZGF0YToKICAgICAgICAgICAgZG9jc19iYXJjb2RlcyA9IFtdCiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXToKICAgICAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYucGFyc2VfYmFyY29kZShpdGVtWydtYXJrX2NvZGUnXSkKICAgICAgICAgICAgICAgIGRvY3NfYmFyY29kZXMuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGl0ZW1bJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGl0ZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogaXRlbVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IGl0ZW1bJ2lkX3NlcmllcyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGl0ZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmtfY29kZSc6IGl0ZW1bJ21hcmtfY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZV9mcm9tX3NjYW5uZXInOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2lzX3BsYW4nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcHJvdmVkJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdHVElOJzogYmFyY29kZV9kYXRhWydHVElOJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdTZXJpZXMnOiBiYXJjb2RlX2RhdGFbJ1NlcmllcyddCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBkYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NzX2JhcmNvZGVzCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsID0gdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKS5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBndGluID0gdmFsWzI6MTZdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZ3RpbiA9IHZhbFs6MTRdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBndGluLCAnU2VyaWVzJzogc2VyaWVzfQoKICAgIGRlZiBnZXRfbmV3X2xvYWRfZG9jcyhzZWxmLCBkYXRhOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGxvYWRlZF9kb2N1bWVudHMgPSB7fQoKICAgICAgICBmb3IgZG9jX3R5cGUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ106CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGEuZ2V0KGRvY190eXBlLCBbXSk6CiAgICAgICAgICAgICAgICBsb2FkZWRfZG9jdW1lbnRzW2l0ZW1bJ2lkX2RvYyddXSA9IGl0ZW0KCiAgICAgICAgaWYgbm90IGxvYWRlZF9kb2N1bWVudHM6CiAgICAgICAgICAgIHJldHVybiBsb2FkZWRfZG9jdW1lbnRzCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MKICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzCiAgICAgICAgJycnCgogICAgICAgIGRiX2RvY3MgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQogICAgICAgIGZvciBkb2MgaW4gZGJfZG9jczoKICAgICAgICAgICAgaWYgZG9jWydpZF9kb2MnXSBpbiBsb2FkZWRfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbG9hZGVkX2RvY3VtZW50cy5wb3AoZG9jWydpZF9kb2MnXSkKCiAgICAgICAgcmV0dXJuIGxvYWRlZF9kb2N1bWVudHMKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICBkYXRhID0gRG9jU2VydmljZSgpLmdldF9kYXRhX3RvX3NlbmQoKSArIEFkckRvY1NlcnZpY2UoKS5nZXRfZGF0YV90b19zZW5kKCkKICAgICAgICByZXR1cm4gZGF0YQoKCmNsYXNzIEJhcmNvZGVTZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUnNfYmFyY29kZXMnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKCiAgICBkZWYgYWRkX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZShiYXJjb2RlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2RlX2RhdGEoc2VsZiwgYmFyY29kZV9pbmZvLCBpZF9kb2MsIGlzX2Fkcl9kb2M9RmFsc2UsIGlkX2NlbGw9JycsIHRhYmxlX3R5cGU9JycpOgogICAgICAgIGlmIGJhcmNvZGVfaW5mby5zY2hlbWUgPT0gJ0dTMSc6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5ndGluWzE6XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5iYXJjb2RlCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCBpZF9jZWxsOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdpZF9jZWxsIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCB0YWJsZV90eXBlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd0YWJsZV90eXBlIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgJ3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLnByaWNlJywKICAgICAgICAgICAgJ2lkX3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLmlkX3ByaWNlJywKICAgICAgICAgICAgJ2RfcXR0eV9maWVsZCc6ICdkb2NfdGFibGUucXR0eScgaWYgaXNfYWRyX2RvYyBlbHNlICdkb2NfdGFibGUuZF9xdHR5JywKICAgICAgICAgICAgJ3VzZV9tYXJrX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZ29vZHMudXNlX21hcmsnLAogICAgICAgICAgICAnZG9jc190YWJsZSc6ICdSU19hZHJfZG9jc190YWJsZScgaWYgaXNfYWRyX2RvYyBlbHNlICdSU19kb2NzX3RhYmxlJywKICAgICAgICAgICAgJ2NlbGxfY29uZGl0aW9uJzogZidBTkQgZG9jX3RhYmxlLmlkX2NlbGwgPSAie2lkX2NlbGx9IicgaWYgaXNfYWRyX2RvYyBlbHNlICcnLAogICAgICAgICAgICAndGFibGVfdHlwZV9jb25kaXRpb24nOiBmJ0FORCBkb2NfdGFibGUudGFibGVfdHlwZSA9ICJ7dGFibGVfdHlwZX0iJyBpZiBpc19hZHJfZG9jIGVsc2UgJycsCiAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgICdndGluJzogYmFyY29kZV9pbmZvLmd0aW4sCiAgICAgICAgICAgICdzZXJpZXMnOiBiYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlYXJjaF92YWx1ZSwKICAgICAgICB9CgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfZ29vZCBBUyBpZF9nb29kLCAKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3Byb3BlcnR5IEFTIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfc2VyaWVzIEFTIGlkX3NlcmllcywKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3VuaXQgQVMgaWRfdW5pdCwKICAgICAgICAgICAgICAgIGJhcmNvZGVzLnJhdGlvIEFTIHJhdGlvLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY19iYXJjb2Rlcy5hcHByb3ZlZCwgMCkgQVMgYXBwcm92ZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jX2JhcmNvZGVzLmlkLCAwKSBBUyBtYXJrX2lkLAogICAgICAgICAgICAgICAgSUZOVUxMKHt1c2VfbWFya19maWVsZH0sIGZhbHNlKSBBUyB1c2VfbWFyaywKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUuaWQsICcnKSBBUyByb3dfa2V5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS51c2Vfc2VyaWVzLCAwKSBBUyB1c2Vfc2VyaWVzLAogICAgICAgICAgICAgICAgSUZOVUxMKHtkX3F0dHlfZmllbGR9LCAwLjApIEFTIGRfcXR0eSwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUucXR0eSwgMC4wKSBBUyBxdHR5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuLAogICAgICAgICAgICAgICAgSUZOVUxMKHtwcmljZV9maWVsZH0sIDAuMCkgQVMgcHJpY2UsCiAgICAgICAgICAgICAgICBJRk5VTEwoe2lkX3ByaWNlX2ZpZWxkfSwgJycpIEFTIGlkX3ByaWNlLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuCgogICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzIEFTIGJhcmNvZGVzCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgICAgICAgICAoU0VMRUNUIAogICAgICAgICAgICAgICAgICAgICAgICBnb29kcy5pZCBBUyBpZF9nb29kcywgCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzX2dvb2RzLnVzZV9tYXJrIAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBGUk9NICBSU19nb29kcyBBUyBnb29kcwogICAgICAgICAgICAgICAgICAgIEpPSU4gUlNfdHlwZXNfZ29vZHMgQVMgdHlwZXNfZ29vZHMgT04gZ29vZHMudHlwZV9nb29kID0gdHlwZXNfZ29vZHMuaWQpIEFTIGdvb2RzCiAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF9nb29kID0gZ29vZHMuaWRfZ29vZHMKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiB7ZG9jc190YWJsZX0gQVMgZG9jX3RhYmxlIAogICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfZ29vZCA9IGRvY190YWJsZS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF9wcm9wZXJ0eSA9IGRvY190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF91bml0ID0gZG9jX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgICAgICAgICAgQU5EIGRvY190YWJsZS5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgICAgICAgICAgICAgIHtjZWxsX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgICAgICAge3RhYmxlX3R5cGVfY29uZGl0aW9ufQogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2RvY3NfYmFyY29kZXMgYXMgZG9jX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBPTiBkb2NfYmFyY29kZXMuaWRfZG9jID0gIntpZF9kb2N9IgogICAgICAgICAgICAgICAgICAgIEFORCBkb2NfYmFyY29kZXMuR1RJTiA9ICJ7Z3Rpbn0iCiAgICAgICAgICAgICAgICAgICAgQU5EIGRvY19iYXJjb2Rlcy5TZXJpZXMgPSAie3Nlcmllc30iCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgYmFyY29kZXMuYmFyY29kZSA9ICJ7YmFyY29kZX0iJycnLmZvcm1hdCgqKnBhcmFtcykKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKICAgICAgICBpZiByZXN1bHQ6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF0KCiAgICBkZWYgZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZiwgaWRfZG9jX3RhYmxlOiBzdHIpIC0+IHN0cjoKICAgICAgICBxID0gJycnCiAgICAgICAgU0VMRUNUIGJhcmNvZGUKICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgCiAgICAgICAgTEVGVCBKT0lOICAgUlNfZG9jc190YWJsZSBPTiAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19iYXJjb2Rlcy5pZF9nb29kIEFORCAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMgPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBBTkQgCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfYmFyY29kZXMuaWRfdW5pdCAgCiAgICAgICAgCiAgICAgICAgV0hFUkUgUlNfZG9jc190YWJsZS5pZCA9ID8KICAgICAgICAKICAgICAgICBMSU1JVCAxICcnJwoKICAgICAgICByZXN1bHQgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2NfdGFibGUpCiAgICAgICAgaWYgcmVzdWx0OgogICAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdWydiYXJjb2RlJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJzAwMDAwMDAwMDAwMTEnCgoKICAgIGRlZiByZXBsYWNlX29yX2NyZWF0ZV90YWJsZShzZWxmLCB0YWJsZV9uYW1lLCBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKGRvY3NfdGFibGVfdXBkYXRlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2Rlc19ieV9nb29kc19pZChzZWxmLCBnb29kc19pZCkgLT4gbGlzdDoKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBiYXJjb2Rlcy5iYXJjb2RlLAogICAgICAgICAgICAgICAgSUZOVUxMKHByb3BzLm5hbWUsICcnKSBBUyBwcm9wZXJ0eSwKICAgICAgICAgICAgICAgIElGTlVMTCh1bml0cy5uYW1lLCAnJykgQVMgdW5pdAoKICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgQVMgYmFyY29kZXMKICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIEFTIHByb3BzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfcHJvcGVydHkgPSBwcm9wcy5pZAogICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzIEFTIHVuaXRzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfdW5pdCA9IHVuaXRzLmlkCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdIRVJFIGJhcmNvZGVzLmlkX2dvb2QgPSAne2dvb2RzX2lkfScKICAgICAgICAnJycKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbnNlcnRfbm9fc3FsKHF1ZXVlX3VwZGF0ZV9kYXRhKToKICAgICAgICBwcm92aWRlciA9IFNjYW5uaW5nUXVldWVTZXJ2aWNlKCkKICAgICAgICBwcm92aWRlci5zYXZlX3NjYW5uZWRfcm93X2RhdGEocXVldWVfdXBkYXRlX2RhdGEpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF90YWJsZV9saW5lKHRhYmxlX25hbWUsIGZpbHRlcnM6IGRpY3QgPSBOb25lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT10YWJsZV9uYW1lKQogICAgICAgIHNlbGVjdF9wYXJ0ID0gZiIiIlNFTEVDVCAqIEZST00ge3RhYmxlX25hbWV9IiIiCiAgICAgICAgcXVlcnkgPSBzZWxlY3RfcGFydAogICAgICAgIGlmIGZpbHRlcnM6CiAgICAgICAgICAgIGZpbHRlcnNfcGFydCA9ICIiIiBXSEVSRSAiIiIKICAgICAgICAgICAgZm9yIGNvdW50LCBmaWVsZF9uYW1lIGluIGVudW1lcmF0ZShsaXN0KGZpbHRlcnMpKToKICAgICAgICAgICAgICAgIGZpbHRlcnNfcGFydCArPSBmIiIie2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiIGlmIGNvdW50ID09IDAgZWxzZSBcCiAgICAgICAgICAgICAgICAgICAgZiIiIiBBTkQge2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiCiAgICAgICAgICAgIHF1ZXJ5ID0gZiIiIntzZWxlY3RfcGFydH0ge2ZpbHRlcnNfcGFydH0iIiIKCiAgICAgICAgcmVzdWx0ID0gcHJvdmlkZXIuc3FsX3F1ZXJ5KHF1ZXJ5LCAnJykKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIE5vbmUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdXBkYXRlX2xpbmVfcXR0eSh0YWJsZV9saW5lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUlNfZG9jc190YWJsZScpCiAgICAgICAgcHJvdmlkZXIudXBkYXRlKGRhdGE9dGFibGVfbGluZSkKCgpjbGFzcyBEb2NTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRvY19pZD0nJywgaXNfZ3JvdXBfc2Nhbj1GYWxzZSwgaXNfYmFyY19mbG93PUZhbHNlKToKICAgICAgICBzZWxmLmRvY19pZCA9IGRvY19pZAogICAgICAgIHNlbGYuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgICAgICBzZWxmLmlzQWRyID0gRmFsc2UKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gaXNfZ3JvdXBfc2NhbgogICAgICAgIHNlbGYuaXNfYmFyY19mbG93ID0gaXNfYmFyY19mbG93CiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc2VsZi5kb2NzX3RhYmxlX25hbWUsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2UgPSBMb2dnZXJTZXJ2aWNlKCkKCiAgICBkZWYgZ2V0X2xhc3RfZWRpdGVkX2dvb2RzKHNlbGYsIHRvX2pzb249RmFsc2UpOgogICAgICAgIHF1ZXJ5X2RvY3MgPSBmJ1NFTEVDVCAqIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBXSEVSRSBpZF9kb2MgPSA/IGFuZCB2ZXJpZmllZCA9IDEnCgogICAgICAgIHF1ZXJ5X2dvb2RzID0gZicnJwogICAgICAgIFNFTEVDVCAqIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfV90YWJsZQogICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gYW5kIHNlbnQgPSAwCiAgICAgICAgJycnCgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzX2RvY3MgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2RvY3MsIChzZWxmLmRvY19pZCwpLCBUcnVlKQogICAgICAgICAgICByZXNfZ29vZHMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2dvb2RzLCAoc2VsZi5kb2NfaWQsKSwgVHJ1ZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJhaXNlIGUKICAgICAgICAgICAgIyByZXR1cm4geydFcnJvcic6IGUuYXJnc1swXX0KCiAgICAgICAgaWYgbm90IHJlc19nb29kczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgcmV0dXJuIHNlbGYuZm9ybV9kYXRhX2Zvcl9yZXF1ZXN0KHJlc19kb2NzLCByZXNfZ29vZHMsIHRvX2pzb24pCgogICAgZGVmIGZvcm1fZGF0YV9mb3JfcmVxdWVzdChzZWxmLCByZXNfZG9jcywgcmVzX2dvb2RzLCB0b19qc29uKToKICAgICAgICBmb3IgaXRlbSBpbiByZXNfZG9jczoKICAgICAgICAgICAgZmlsdGVyZWRfbGlzdCA9IFtkIGZvciBkIGluIHJlc19nb29kcyBpZiBkWydpZF9kb2MnXSA9PSBpdGVtWydpZF9kb2MnXV0KICAgICAgICAgICAgZ29vZHNfdGFibGUgPSBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX1fdGFibGUnCiAgICAgICAgICAgIGl0ZW1bZ29vZHNfdGFibGVdID0gZmlsdGVyZWRfbGlzdAogICAgICAgICAgICBpZiBub3Qgc2VsZi5pc0FkcjoKICAgICAgICAgICAgICAgIGl0ZW1bJ1JTX2RvY3NfYmFyY29kZXMnXSA9IFtdCiAgICAgICAgICAgICAgICBpdGVtWydSU19iYXJjX2Zsb3cnXSA9IFtdCgogICAgICAgIGlmIHRvX2pzb246CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKHJlc19kb2NzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiByZXNfZG9jcwoKICAgIGRlZiB1cGRhdGVfZGF0YV9mcm9tX2pzb24oc2VsZiwganNvbl9kYXRhKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWRzKGpzb25fZGF0YSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGRhdGEgPSBqc29uX2RhdGEKCiAgICAgICAgaWYgZGF0YS5nZXQoc2VsZi5kb2NzX3RhYmxlX25hbWUpOgogICAgICAgICAgICBzZWxmLnVwZGF0ZV9kb2NzKGRhdGEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi51cGRhdGVfbnNpKGRhdGEpCgogICAgZGVmIHVwZGF0ZV9kb2NzKHNlbGYsIGRhdGEpOgogICAgICAgIGRvY19pZHMgPSAnLCcuam9pbihbZicie2l0ZW0uZ2V0KCJpZF9kb2MiKX0iJyBmb3IgaXRlbSBpbiBkYXRhW3NlbGYuZG9jc190YWJsZV9uYW1lXV0pCgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgaWRfZG9jLCB2ZXJpZmllZAogICAgICAgICAgICBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgV0hFUkUgaWRfZG9jIElOICh7ZG9jX2lkc30pCiAgICAgICAgJycnCiAgICAgICAgZG9jcyA9IHtpdGVtWydpZF9kb2MnXTogaXRlbVsndmVyaWZpZWQnXSBvciBGYWxzZSBmb3IgaXRlbSBpbgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0PXF1ZXJ5LCByZXR1cm5fZGljdD1UcnVlKX0KCiAgICAgICAgcXVlcmllcyA9IHNlbGYuanNvbl90b19zcWxpdGVfcXVlcnkoZGF0YSwgZG9jcykKCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJpZXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIGUKCiAgICAgICAgcmV0dXJuIGRvY3MKCiAgICBkZWYgdXBkYXRlX25zaShzZWxmLCBkYXRhKToKICAgICAgICBxdWVyaWVzID0gc2VsZi5qc29uX3RvX3NxbGl0ZV9xdWVyeShkYXRhKQoKICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcmllczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmFpc2UgZQoKICAgIGRlZiB1cGRhdGVfc2VudF9kYXRhKHNlbGYsIGRhdGEpOgogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgIGZvciBkb2MgaW4gZGF0YToKICAgICAgICAgICAgICAgIGlkX2RvYyA9IGRvY1snaWRfZG9jJ10KICAgICAgICAgICAgICAgIGlkX2dvb2RzID0gJywnLmpvaW4oW2YnIntpdGVtLmdldCgiaWRfZ29vZCIpfSInIGZvciBpdGVtIGluIGRvYy5nZXQoJ1JTX2RvY3NfdGFibGUnLCBbXSldKQoKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICAgICAgICAgIFVQREFURSB7c2VsZi5kZXRhaWxzX3RhYmxlX25hbWV9CiAgICAgICAgICAgICAgICAgICAgU0VUIHNlbnQgPSAxCiAgICAgICAgICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gJ3tpZF9kb2N9JyBBTkQgaWRfZ29vZCBJTiAoe2lkX2dvb2RzfSkKICAgICAgICAgICAgICAgICAgICAnJycKCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgICAgICAgICAgcXVlcnkgPSBmJ1VQREFURSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFNFVCBzZW50PTEgV0hFUkUgaWRfZG9jID0gIntzZWxmLmRvY19pZH0iJwogICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgIGRlZiBqc29uX3RvX3NxbGl0ZV9xdWVyeShzZWxmLCBkYXRhOiBkaWN0LCBkb2NzPU5vbmUpOgogICAgICAgIGlmIGRvY3MgaXMgTm9uZToKICAgICAgICAgICAgZG9jcyA9IHt9CgogICAgICAgIHFsaXN0ID0gW10KICAgICAgICAjINCm0LjQutC7INC/0L4g0LjQvNC10L3QsNC8INGC0LDQsdC70LjRhgogICAgICAgIHRhYmxlX2xpc3QgPSAoCiAgICAgICAgICAgICdSU19kb2NfdHlwZXMnLCAnUlNfZ29vZHMnLCAnUlNfcHJvcGVydGllcycsICdSU191bml0cycsICdSU190eXBlc19nb29kcycsICdSU19zZXJpZXMnLCAnUlNfY291bnRyYWdlbnRzJywKICAgICAgICAgICAgJ1JTX3dhcmVob3VzZXMnLCAnUlNfcHJpY2VfdHlwZXMnLCAnUlNfY2VsbHMnLCAnUlNfYmFyY29kZXMnLCAnUlNfcHJpY2VzJywgJ1JTX2RvY190eXBlcycsICdSU19kb2NzJywKICAgICAgICAgICAgJ1JTX2RvY3NfdGFibGUnLCAnUlNfZG9jc19iYXJjb2RlcycsICdSU19hZHJfZG9jcycsICdSU19hZHJfZG9jc190YWJsZScpICAjICwsICdSU19iYXJjX2Zsb3cnCiAgICAgICAgdGFibGVfZm9yX2RlbGV0ZSA9ICgnUlNfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfYWRyX2RvY3NfdGFibGUnKSAgIyAsICdSU19iYXJjX2Zsb3cnCiAgICAgICAgZG9jX2lkX2xpc3QgPSBbXQogICAgICAgIGZvciB0YWJsZV9uYW1lIGluIHRhYmxlX2xpc3Q6CiAgICAgICAgICAgIGlmIG5vdCBkYXRhLmdldCh0YWJsZV9uYW1lKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjINCU0L7QsdCw0LLQuNC8INCyINC30LDQv9GA0L7RgdGLINGD0LTQsNC70LXQvdC40LUg0LjQtyDQsdCw0LfRiyDRgdGC0YDQvtC6INGC0LXRhSDQtNC+0LrRg9C80LXQvdGC0L7Qsiwg0YfRgtC+INC80Ysg0LfQsNCz0YDRg9C20LDQtdC8CiAgICAgICAgICAgIGlmIHRhYmxlX25hbWUgaW4gdGFibGVfZm9yX2RlbGV0ZToKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gZiJERUxFVEUgRlJPTSB7dGFibGVfbmFtZX0gV0hFUkUgaWRfZG9jIGluICh7JywgJy5qb2luKGRvY19pZF9saXN0KX0pICIKICAgICAgICAgICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCiAgICAgICAgICAgIGNvbHVtbl9uYW1lcyA9IGRhdGFbdGFibGVfbmFtZV1bMF0ua2V5cygpCiAgICAgICAgICAgIGlmICdtYXJrX2NvZGUnIGluIGNvbHVtbl9uYW1lczoKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcyA9IGxpc3QoY29sdW1uX25hbWVzKQogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLmFwcGVuZCgnR1RJTicpCiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMuYXBwZW5kKCdTZXJpZXMnKQogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLnJlbW92ZSgnbWFya19jb2RlJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcyA9IGxpc3QoY29sdW1uX25hbWVzKQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiAoJ1JTX2RvY3MnLCAnUlNfYWRyX2RvY3MnKTogICMKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcy5hcHBlbmQoJ3ZlcmlmaWVkJykKCiAgICAgICAgICAgIHF1ZXJ5ID0gZiJSRVBMQUNFIElOVE8ge3RhYmxlX25hbWV9ICh7JywgJy5qb2luKHF1ZXJ5X2NvbF9uYW1lcyl9KSBWQUxVRVMgIgogICAgICAgICAgICB2YWx1ZXMgPSBbXQoKICAgICAgICAgICAgZm9yIHJvdyBpbiBkYXRhW3RhYmxlX25hbWVdOgogICAgICAgICAgICAgICAgcm93X3ZhbHVlcyA9IFtdCiAgICAgICAgICAgICAgICBsaXN0X3F1b3RlZF9maWVsZHMgPSAoJ25hbWUnLCAnZnVsbF9uYW1lJywgIm1hcmtfY29kZSIpCiAgICAgICAgICAgICAgICBmb3IgY29sIGluIHF1ZXJ5X2NvbF9uYW1lczoKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgaW4gbGlzdF9xdW90ZWRfZmllbGRzIGFuZCAiXCIiIGluIHJvd1tjb2xdOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9IHJvd1tjb2xdLnJlcGxhY2UoIlwiIiwgIlwiXCIiKQoKICAgICAgICAgICAgICAgICAgICAjINCX0LTQtdGB0Ywg0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YTQu9Cw0LMgdmVyaWZpZWQhISEKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgPT0gJ3ZlcmlmaWVkJyBhbmQgKHRhYmxlX25hbWUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ10pOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9IGRvY3MuZ2V0KHJvd1snaWRfZG9jJ10sIDApCgogICAgICAgICAgICAgICAgICAgIGlmIHJvdy5nZXQoY29sKSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9ICcnCgogICAgICAgICAgICAgICAgICAgIGlmIGNvbCA9PSAnbWFya19jb2RlJzogICMg0JfQsNC80LXQvdGP0LXQvCDRjdGC0L4g0L/QvtC70LUg0L3QsCDQv9C+0LvRjyBHVElOINC4IFNlcmllcwogICAgICAgICAgICAgICAgICAgICAgICBiYXJjX3N0cnVjdCA9IHNlbGYucGFyc2VfYmFyY29kZShyb3dbY29sXSkKICAgICAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQoYmFyY19zdHJ1Y3RbJ0dUSU4nXSkKICAgICAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQoYmFyY19zdHJ1Y3RbJ1NlcmllcyddKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvd192YWx1ZXMuYXBwZW5kKHJvd1tjb2xdKSAgIyAoZicie3Jvd1tjb2xdfSInKQoKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgPT0gJ2lkX2RvYycgYW5kICh0YWJsZV9uYW1lIGluIFsnUlNfZG9jcycsICdSU19hZHJfZG9jcyddKToKICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2lkX2xpc3QuYXBwZW5kKCciJyArIHJvd1tjb2xdICsgJyInKQoKICAgICAgICAgICAgICAgIGZvcm1hdHRlZF92YWwgPSBbZicie3h9IicgaWYgaXNpbnN0YW5jZSh4LCBzdHIpIGVsc2Ugc3RyKHgpIGZvciB4IGluIHJvd192YWx1ZXNdCiAgICAgICAgICAgICAgICB2YWx1ZXMuYXBwZW5kKGYiKHsnLCAnLmpvaW4oZm9ybWF0dGVkX3ZhbCl9KSIpCiAgICAgICAgICAgIHF1ZXJ5ICs9ICIsICIuam9pbih2YWx1ZXMpCiAgICAgICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCiAgICAgICAgcmV0dXJuIHFsaXN0CgogICAgZGVmIGdldF9hbGxfYXJ0aWNsZXNfaW5fZG9jdW1lbnQoc2VsZikgLT4gTGlzdFtzdHJdOgogICAgICAgIHF1ZXJ5ID0gKCdTRUxFQ1QgRElTVElOQ1QgUlNfZ29vZHMuYXJ0IGFzIGFydCcKICAgICAgICAgICAgICAgICAnIEZST00gUlNfZG9jc190YWJsZScKICAgICAgICAgICAgICAgICAnIExFRlQgSk9JTiBSU19nb29kcyBPTiBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZCcKICAgICAgICAgICAgICAgICAnIFdIRVJFIFJTX2RvY3NfdGFibGUuaWRfZG9jID0gPycpCiAgICAgICAgZ29vZHMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxdWVyeSwgc2VsZi5kb2NfaWQpCiAgICAgICAgcmV0dXJuIFtnb29kWydhcnQnXSBmb3IgZ29vZCBpbiBnb29kc10gaWYgZ29vZHMgaXMgbm90IE5vbmUgZWxzZSBbXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzPU5vbmUsIHJldHVybl9kaWN0PUZhbHNlKToKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzPWFyZ3MsIHJldHVybl9kaWN0PXJldHVybl9kaWN0KQoKICAgIGRlZiBzZXRfZG9jX3ZhbHVlKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBTRVQge2tleX0gPSB7dmFsdWV9CiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ICJ7c2VsZi5kb2NfaWR9IgogICAgICAgICAgICAnJycKCiAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKCiAgICBkZWYgc2V0X2RvY192YWx1ZXMoc2VsZiwgKip2YWx1ZXMpOgogICAgICAgIGlmIG5vdCB2YWx1ZXM6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZXRfZmllbGRzID1bZid7a309e3Z9J2ZvciBrLCB2IGluIHZhbHVlcy5pdGVtcygpXQogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBTRVQgeycsJy5qb2luKHNldF9maWVsZHMpfQogICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSAie3NlbGYuZG9jX2lkfSIKICAgICAgICAgICAgJycnCgogICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCgogICAgZGVmIGdldF9kb2NfdmFsdWUoc2VsZiwga2V5LCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5ID0gZidTRUxFQ1Qge2tleX0gZnJvbSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9ICBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIChpZF9kb2MsKSwgVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1ba2V5XQoKICAgIGRlZiBnZXRfZG9jX3R5cGVzKHNlbGYpIC0+IGxpc3Q6CiAgICAgICAgd2hlcmVfZ3JvdXBfc2NhbiA9IGYnaXNfZ3JvdXBfc2NhbiA9ICIwIicgaWYgc2VsZi5pc19ncm91cF9zY2FuIGlzIEZhbHNlIGVsc2UgVHJ1ZQoKICAgICAgICB3aGVyZV9lbXB0eSA9ICgiUlNfZG9jcy5pZF9kb2Mgbm90IGluICIKICAgICAgICAgICAgICAgICAgICAgICAiKFNFTEVDVCBkaXN0aW5jdCBpZF9kb2MgRnJvbSBSU19kb2NzX3RhYmxlKSIpCiAgICAgICAgd2hlcmVfYmFyY19mbG93ID0gZicoaXNfYmFyY19mbG93ID0gIjEiIE9SIHt3aGVyZV9lbXB0eX0pJyBcCiAgICAgICAgICAgIGlmIHNlbGYuaXNfYmFyY19mbG93IGVsc2UgZidpc19iYXJjX2Zsb3cgPSAiMCInCgogICAgICAgIHdoZXJlID0gZiJ7d2hlcmVfZ3JvdXBfc2Nhbn0gQU5EIHt3aGVyZV9iYXJjX2Zsb3d9IgoKICAgICAgICBxdWVyeV90ZXh0ID0gZidTRUxFQ1QgRElTVElOQ1QgZG9jX3R5cGUgZnJvbSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9JwogICAgICAgIHF1ZXJ5ID0gZiJ7cXVlcnlfdGV4dH0gV0hFUkUge3doZXJlfSIKCiAgICAgICAgZG9jX3R5cGVzID0gW3JlY1swXSBmb3IgcmVjIGluIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpXQogICAgICAgIHJldHVybiBkb2NfdHlwZXMKCiAgICBkZWYgZ2V0X2RvY192aWV3X2RhdGEoc2VsZiwgZG9jX3R5cGU9JycsIGRvY19zdGF0dXM9JycpIC0+IGxpc3Q6CiAgICAgICAgZmllbGRzID0gWwogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfZG9jJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY190eXBlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19uJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19kYXRlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwiIikgYXMgUlNfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCIiKSBhcyB3YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnZlcmlmaWVkLCAwKSBhcyB2ZXJpZmllZCcsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uc2VudCwgMCkgYXMgc2VudCcsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5hZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgIF0KCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMnKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfZ3JvdXBfc2NhbiwgMCkgYXMgaXNfZ3JvdXBfc2NhbicpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoUlNfY291bnRyYWdlbnRzLmZ1bGxfbmFtZSwgIiIpIGFzIFJTX2NvdW50cmFnZW50JykKCiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgJyArICcsXG4nLmpvaW4oZmllbGRzKQoKICAgICAgICBqb2lucyA9IGYnJydGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgUlNfd2FyZWhvdXNlcwogICAgICAgICAgICAgICAgT04gUlNfd2FyZWhvdXNlcy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlCiAgICAgICAgJycnCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgam9pbnMgKz0gZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY291bnRyYWdlbnRzIGFzIFJTX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgICcnJwogICAgICAgIHdoZXJlID0gJycKCiAgICAgICAgaWYgZG9jX3N0YXR1czoKICAgICAgICAgICAgaWYgZG9jX3N0YXR1cyA9PSAi0JLRi9Cz0YDRg9C20LXQvSI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBzZW50PTEgQU5EIHZlcmlmaWVkPTEiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9Cz0YDRg9C30LrQtSI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBpZm51bGwodmVyaWZpZWQsMCk9MSBBTkQgaWZudWxsKHNlbnQsMCk9MCIKICAgICAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0L/QvtC70L3QtdC90LjRjiI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBpZm51bGwodmVyaWZpZWQsMCk9MCBBTkQgaWZudWxsKHNlbnQsMCk9MCIKCiAgICAgICAgaWYgbm90IGRvY190eXBlIG9yIGRvY190eXBlID09ICLQktGB0LUiOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3NfdHVwbGUgPSAoZG9jX3R5cGUsKQogICAgICAgICAgICBpZiBub3QgZG9jX3N0YXR1cyBvciBkb2Nfc3RhdHVzID09ICLQktGB0LUiOgogICAgICAgICAgICAgICAgd2hlcmUgPSAnV0hFUkUgZG9jX3R5cGU9PycKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdoZXJlICs9ICcgQU5EIGRvY190eXBlPT8nCgogICAgICAgIGlmIHNlbGYuaXNfZ3JvdXBfc2NhbiBpcyBGYWxzZSBhbmQgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgICAgIHdoZXJlICs9IGYnIEFORCBpc19ncm91cF9zY2FuPXtpbnQoc2VsZi5pc19ncm91cF9zY2FuKX0nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aGVyZSA9IGYnIFdIRVJFIGlzX2dyb3VwX3NjYW49e2ludChzZWxmLmlzX2dyb3VwX3NjYW4pfScKICAgICAgICAKICAgICAgICBpZiBzZWxmLmlzX2JhcmNfZmxvdyBpcyBGYWxzZSBhbmQgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgICAgIHdoZXJlICs9IGYnIEFORCBpc19iYXJjX2Zsb3c9e2ludChzZWxmLmlzX2JhcmNfZmxvdyl9JwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2hlcmUgPSBmJyBXSEVSRSBpc19iYXJjX2Zsb3c9e2ludChzZWxmLmlzX2JhcmNfZmxvdyl9JwogICAgICAgIAogICAgICAgIHF1ZXJ5X3RleHQgPSBmJycnCiAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICB7am9pbnN9CiAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgT1JERVIgQlkge3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfZGF0ZQogICAgICAgICcnJwogICAgICAgIHJlc3VsdCA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc190dXBsZSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGRlbGV0ZV9kb2Moc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeWVzID0gKAogICAgICAgICdERUxFVEUgRlJPTSBSU19iYXJjX2Zsb3cgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2RvY3Nfc2VyaWVzIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICdERUxFVEUgRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgIGYnREVMRVRFIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICApCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJ5ZXM6CiAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIChpZF9kb2MsKSkKCiAgICBkZWYgZGVsZXRlX2Fkcl9kb2Moc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeWVzID0gKAogICAgICAgICdERUxFVEUgRlJPTSBSU19hZHJfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICAnREVMRVRFIEZST00gUlNfYWRyX2RvY3MgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgKQogICAgICAgIGZvciBxdWVyeSBpbiBxdWVyeWVzOgogICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaWRfZG9jLCkpCgogICAgZGVmIGRlbGV0ZV9vbGRfZG9jcyhzZWxmLCBkYXlzOiBpbnQpIC0+IGxpc3Q6CiAgICAgICAgb2xkX2RvY3NfaWRzID0gc2VsZi5fZmluZF9vbGRfZG9jcyhkYXlzKQogICAgICAgIG9sZF9hZHJfZG9jc19pZHMgPSBzZWxmLl9maW5kX29sZF9kb2NzKGRheXMsICdSU19hZHJfZG9jcycpCiAgICAgICAgZm9yIGlkX2RvYyBpbiBvbGRfZG9jc19pZHM6CiAgICAgICAgICAgIHNlbGYuZGVsZXRlX2RvYyhpZF9kb2MpCiAgICAgICAgZm9yIGlkX2RvYyBpbiBvbGRfYWRyX2RvY3NfaWRzOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV9hZHJfZG9jKGlkX2RvYykKICAgICAgICByZXR1cm4gb2xkX2RvY3NfaWRzICsgb2xkX2Fkcl9kb2NzX2lkcwoKICAgIGRlZiBfZmluZF9vbGRfZG9jcygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgZGF5czogaW50LAogICAgICAgICAgICB0YWJsZTogTGl0ZXJhbFsnUlNfZG9jcycsICdSU19hZHJfZG9jcyddID0gJ1JTX2RvY3MnCiAgICApIC0+IExpc3Rbc3RyXToKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdC/0LjRgdC+0LogaWQg0LLRgdC10YUg0YPRgdGC0LDRgNC10LLRiNC40YUg0LTQvtC60YPQvNC10L3RgtC+0LIiIiIKICAgICAgICBxdWVyeSA9IGYnJydTRUxFQ1QgaWRfZG9jIEZST00ge3RhYmxlfSBXSEVSRSBjcmVhdGVkX2F0IDwgPycnJwogICAgICAgIGN1cnJlbnRfZGF0ZXRpbWUgPSBkYXRldGltZS5ub3codHo9dGltZXpvbmUudXRjKQogICAgICAgIHRhcmdldF90aW1lID0gY3VycmVudF9kYXRldGltZSAtIHRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAgICAgZG9jcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksICh0YXJnZXRfdGltZSwgKSkKICAgICAgICByZXR1cm4gW2RvY1swXSBmb3IgZG9jIGluIGRvY3NdCgogICAgZGVmIGdldF9kb2NzX3N0YXQoc2VsZik6CiAgICAgICAgd2hlcmVfZ3JvdXBfc2NhbiA9IGYnaXNfZ3JvdXBfc2NhbiA9ICIwIicgaWYgc2VsZi5pc19ncm91cF9zY2FuIGlzIEZhbHNlIGVsc2UgVHJ1ZQogICAgICAgIHdoZXJlX2JhcmNfZmxvdyA9IGYnaXNfYmFyY19mbG93ID0gIjAiJyBpZiBzZWxmLmlzX2JhcmNfZmxvdyBpcyBGYWxzZSBlbHNlIFRydWUKICAgICAgICB3aGVyZSA9IGYie3doZXJlX2dyb3VwX3NjYW59IEFORCB7d2hlcmVfYmFyY19mbG93fSIKCiAgICAgICAgcXVlcnlfc2VsZWN0ID0gZicnJwogICAgICAgIFdJVEggdG1wIEFTICgKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICBkb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgICAgIDEgYXMgZG9jX0NvdW50LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUuc2VudCwwKSBhcyBzZW50LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUudmVyaWZpZWQsMCkgYXMgdmVyaWZpZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jc190YWJsZS5pc19ncm91cF9zY2FuLCAwKSBhcyBpc19ncm91cF9zY2FuLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUuaXNfYmFyY19mbG93LCAwKSBhcyBpc19iYXJjX2Zsb3csCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTAgVEhFTiAKICAgICAgICAgICAgICAgICAgICBDT1VOVChkb2NzX2RldGFpbHMuaWQpCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgY291bnRfdmVyaWZpZWQsCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTEgVEhFTiAKICAgICAgICAgICAgICAgICAgICBjb3VudChkb2NzX2RldGFpbHMuaWQpCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgY291bnRfdW52ZXJpZmllZCwKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MCBUSEVOCiAgICAgICAgICAgICAgICAgICAgIFNVTShkb2NzX2RldGFpbHMucXR0eV9wbGFuKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIHF0dHlfcGxhbl92ZXJpZmllZCwKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MSBUSEVOIAogICAgICAgICAgICAgICAgICAgIFNVTShkb2NzX2RldGFpbHMucXR0eV9wbGFuKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICAgICAgICAgIEZST00gUlNfZG9jcyBBUyBkb2NzX3RhYmxlCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19kb2NzX3RhYmxlIEFTIGRvY3NfZGV0YWlscwogICAgICAgICAgICAgICAgT04gZG9jc19kZXRhaWxzLmlkX2RvYyA9IGRvY3NfdGFibGUuaWRfZG9jCiAgICAgICAgICAgIEdST1VQIEJZIGRvY3NfdGFibGUuaWRfZG9jCiAgICAgICAgKQogICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgZG9jX3R5cGUgYXMgZG9jVHlwZSwgCiAgICAgICAgICAgIENPVU5UKGlkX2RvYyksCiAgICAgICAgICAgIFNVTShkb2NfQ291bnQpIGFzIGNvdW50LCAKICAgICAgICAgICAgU1VNKHNlbnQpIGFzIHNlbnQsIAogICAgICAgICAgICBTVU0odmVyaWZpZWQpIGFzIHZlcmlmaWVkLAogICAgICAgICAgICBTVU0oY291bnRfdmVyaWZpZWQpIGFzIGNvdW50X3ZlcmlmaWVkLAogICAgICAgICAgICBTVU0oY291bnRfdW52ZXJpZmllZCkgYXMgY291bnRfdW52ZXJpZmllZCwKICAgICAgICAgICAgU1VNKHF0dHlfcGxhbl92ZXJpZmllZCkgYXMgcXR0eV9wbGFuX3ZlcmlmaWVkLAogICAgICAgICAgICBTVU0ocXR0eV9wbGFuX3VudmVyaWZpZWQpIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICAgICAgRlJPTSB0bXAKICAgICAgICBXSEVSRSB7d2hlcmV9CiAgICAgICAgR1JPVVAgQlkgZG9jX3R5cGUKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3NlbGVjdCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGdldF9kb2NfZmxvd19zdGF0KHNlbGYpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgIFdJVEggdG1wIEFTICgKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICBSU19kb2NzLmlkX2RvYywKICAgICAgICAgICAgICAgIDEgYXMgZG9jX0NvdW50LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3Muc2VudCwwKSBhcyBzZW50LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MudmVyaWZpZWQsMCkgYXMgdmVyaWZpZWQsCgogICAgICAgICAgICAgICAgY291bnQoUlNfYmFyY19mbG93LmJhcmNvZGUpIGFzIGJhcmNfY291bnQKCiAgICAgICAgICAgIEZST00gUlNfZG9jcwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2JhcmNfZmxvdyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3MuaWRfZG9jID0gUlNfYmFyY19mbG93LmlkX2RvYwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgV0hFUkUgIFJTX2RvY3MuaWRfZG9jIG5vdCBpbiAoU0VMRUNUIGRpc3RpbmN0CiAgICAgICAgICAgICAgICBpZF9kb2MKICAgICAgICAgICAgICAgIEZyb20gCiAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgQU5EIGlzX2dyb3VwX3NjYW4gPSAwCiAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgCiAgICAgICAgICAgR1JPVVAgQlkgUlNfZG9jcy5pZF9kb2MKICAgICAgICApCiAgICAgICAgU0VMRUNUIAogICAgICAgICAgICBkb2NfdHlwZSBhcyBkb2NUeXBlLCAKICAgICAgICAgICAgQ09VTlQoaWRfZG9jKSBhcyBpZF9jb3VudCwKICAgICAgICAgICAgU1VNKGRvY19Db3VudCkgYXMgY291bnQsIAogICAgICAgICAgICBTVU0oc2VudCkgYXMgc2VudCwgCiAgICAgICAgICAgIFNVTSh2ZXJpZmllZCkgYXMgdmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShiYXJjX2NvdW50KSBhcyBiYXJjX2NvdW50CiAgICAgICAgRlJPTSB0bXAKICAgICAgICBHUk9VUCBCWSBkb2NfdHlwZQogICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jX2RldGFpbHNfZGF0YSgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgaWRfZG9jOiBzdHIsCiAgICAgICAgICAgIGZpcnN0X2VsZW06IGludCwKICAgICAgICAgICAgaXRlbXNfb25fcGFnZTogaW50LAogICAgICAgICAgICBhcnRpY2xlc19saXN0OiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgKSAtPiBsaXN0OgogICAgICAgIHNlbGVjdF9xdWVyeSA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZG9jLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgZ29vZF9uYW1lLAogICAgICAgICAgICBSU19nb29kcy5jb2RlLAogICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9zZXJpZXMsCiAgICAgICAgICAgIFJTX3Nlcmllcy5uYW1lIGFzIHNlcmllc19uYW1lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5kX3F0dHksCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucHJpY2UsCiAgICAgICAgICAgIFJTX3ByaWNlX3R5cGVzLm5hbWUgYXMgcHJpY2VfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4gLVJTX2RvY3NfdGFibGUucXR0eSBhcyBJc0RvbmUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUubGFzdF91cGRhdGVkLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnVzZV9zZXJpZXMKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc190YWJsZSAKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQ9UlNfZG9jc190YWJsZS5pZF9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPVJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiAgICAgICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9UlNfZG9jc190YWJsZS5pZF9zZXJpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfZG9jc190YWJsZS5pZF91bml0CiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcmljZV90eXBlcwogICAgICAgICAgICBPTiBSU19wcmljZV90eXBlcy5pZCA9UlNfZG9jc190YWJsZS5pZF9wcmljZQogICAgICAgICAgICAiIiIKCiAgICAgICAgd2hlcmUgPSBmIiIiV0hFUkUgaWRfZG9jID0gJ3tzdHIoaWRfZG9jKX0nIiIiCiAgICAgICAgcm93X2ZpbHRlcnNfY29uZGl0aW9uID0gIiIiQU5EIHF0dHkgIT0gQ09BTEVTQ0UocXR0eV9wbGFuLCAnMCcpICIiIiBpZiByb3dfZmlsdGVycyBlbHNlICcnCiAgICAgICAgc2VhcmNoX3N0cmluZ19jb25kaXRpb24gPSBmIiIiQU5EIGdvb2RfbmFtZSBMSUtFICcle3NlYXJjaF9zdHJpbmd9JSciIiIgaWYgc2VhcmNoX3N0cmluZyBlbHNlICcnCgogICAgICAgIHdoZXJlX3F1ZXJ5ID0gZiIiIgogICAgICAgIHt3aGVyZX0KICAgICAgICB7cm93X2ZpbHRlcnNfY29uZGl0aW9ufQogICAgICAgIHtzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbn0KICAgICAgICAiIiIKICAgICAgICBhcmdzID0gKCkKICAgICAgICBpZiBhcnRpY2xlc19saXN0OgogICAgICAgICAgICB3aGVyZV9xdWVyeSArPSBmIiIiQU5EIGFydCBJTiAoeycsJy5qb2luKCc/JyBmb3IgXyBpbiBhcnRpY2xlc19saXN0KX0pIiIiCiAgICAgICAgICAgIGFyZ3MgKz0gdHVwbGUoYXJ0aWNsZXNfbGlzdCkKICAgICAgICBvcmRlcl9ieSA9ICIiIk9SREVSIEJZIGxhc3RfdXBkYXRlZCBERVNDIiIiCiAgICAgICAgbGltaXQgPSBmJ0xJTUlUIHtpdGVtc19vbl9wYWdlfSBPRkZTRVQge2ZpcnN0X2VsZW19JwogICAgICAgIHF1ZXJ5ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfcXVlcnl9IHtvcmRlcl9ieX0ge2xpbWl0fSIKCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgYXJncywgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICAjIHJlcyA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeSwgJycpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jX2RldGFpbHNfcm93c19jb3VudChzZWxmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnRpY2xlc19saXN0OiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dfZmlsdGVyczogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogT3B0aW9uYWxbc3RyXSA9IE5vbmUKKToKICAgICAgICBzZWxlY3RfcXVlcnkgPSBmIiIiU0VMRUNUIENPVU5UKCopIGFzIHJvd3NfcXR0eSBGUk9NIHtzZWxmLmRldGFpbHNfdGFibGVfbmFtZX0gQVMgZG9jc190YWJsZQogICAgICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgT04gZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQiIiIKICAgICAgICB3aGVyZSA9IGYiIiJXSEVSRSBpZF9kb2MgPSAne3N0cihpZF9kb2MpfSciIiIKICAgICAgICByb3dfZmlsdGVyc19jb25kaXRpb24gPSAiIiJBTkQgcXR0eSAhPSBDT0FMRVNDRShxdHR5X3BsYW4sICcwJykgIiIiIGlmIHJvd19maWx0ZXJzIGVsc2UgJycKICAgICAgICBzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbiA9IGYiIiJBTkQgbmFtZSBMSUtFICcle3NlYXJjaF9zdHJpbmd9JSciIiIgaWYgc2VhcmNoX3N0cmluZyBlbHNlICcnCgogICAgICAgIHdoZXJlX3F1ZXJ5ID0gZiIiIgogICAgICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICAgICAge3Jvd19maWx0ZXJzX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgIHtzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgICIiIgogICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGlmIGFydGljbGVzX2xpc3Q6CiAgICAgICAgICAgIHdoZXJlX3F1ZXJ5ICs9IGYiIiJBTkQgYXJ0IElOICh7JywnLmpvaW4oJz8nIGZvciBfIGluIGFydGljbGVzX2xpc3QpfSkiIiIKICAgICAgICAgICAgYXJncyArPSB0dXBsZShhcnRpY2xlc19saXN0KQogICAgICAgIHF1ZXJ5ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfcXVlcnl9IgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIGFyZ3MsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc1swXVsncm93c19xdHR5J10KCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKQogICAgICAgIHZhbC5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBHVElOID0gdmFsWzI6MTZdCiAgICAgICAgICAgIFNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgR1RJTiA9IHZhbFs6MTRdCiAgICAgICAgICAgIFNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBHVElOLCAnU2VyaWVzJzogU2VyaWVzfQoKICAgIGRlZiBjbGVhcl9iYXJjb2RlX2RhdGEoc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeV90ZXh0ID0gKCdVcGRhdGUgUlNfZG9jc19iYXJjb2RlcyBTZXQgYXBwcm92ZWQgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX2JhcmNvZGVzIFdoZXJlICBpZF9kb2M9OmlkX2RvYyBBbmQgaXNfcGxhbiA9IDAnLAogICAgICAgICAgICAgICAgICAgICAgJ1VwZGF0ZSBSU19kb2NzX3RhYmxlIFNldCBxdHR5ID0gMCBXaGVyZSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICAgICAgICAgICAnVXBkYXRlIFJTX2RvY3NfdGFibGUgU2V0IGRfcXR0eSA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ1VwZGF0ZSBSU19kb2NzIFNldCBpc19ncm91cF9zY2FuID0gIjAiIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdVcGRhdGUgUlNfZG9jcyBTZXQgaXNfYmFyY19mbG93ID0gIjAiIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYz06aWRfZG9jIGFuZCBpc19wbGFuID0gIkZhbHNlIicsCiAgICAgICAgICAgICAgICAgICAgICAnRGVsZXRlIEZyb20gUlNfYmFyY19mbG93IFdoZXJlIGlkX2RvYyA9IDppZF9kb2MnKQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9yIGVsIGluIHF1ZXJ5X3RleHQ6CiAgICAgICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsLCAoeydpZF9kb2MnOiBpZF9kb2N9KSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IEZhbHNlLCAnZXJyb3InOiBlLmFyZ3NbMF19CgogICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IFRydWUsICdlcnJvcic6ICcnfQoKICAgIGRlZiBnZXRfbWFya3NfZGF0YShzZWxmLCBpZF9kb2MsIGRvY19yb3dfaWQpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBiLm1hcmtfY29kZSwKICAgICAgICAgICAgICAgIGIuYXBwcm92ZWQgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcyBBUyBiCiAgICAgICAgICAgIEpPSU4gUlNfZG9jc190YWJsZSBhcyB0CiAgICAgICAgICAgICAgICBPTiBiLmlkX2RvYz10LmlkX2RvYyBBTkQKICAgICAgICAgICAgICAgICAgICBiLmlkX2dvb2QgPSB0LmlkX2dvb2QgQU5ECiAgICAgICAgICAgICAgICAgICAgYi5pZF9wcm9wZXJ0eSA9IHQuaWRfcHJvcGVydGllcyBBTkQKICAgICAgICAgICAgICAgICAgICBiLmlkX3NlcmllcyA9IHQuaWRfc2VyaWVzIEFORAogICAgICAgICAgICAgICAgICAgIHQuaWQgPSAie2RvY19yb3dfaWR9IgogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgYi5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgJycnCgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jc19jb3VudChzZWxmLCBkb2NfdHlwZT0nJyk6CiAgICAgICAgcXVlcnkgPSBmJ1NFTEVDVCBDT1VOVCgqKSBBUyBkb2NzX2NvdW50IEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfScKICAgICAgICBhcmdzID0gTm9uZQoKICAgICAgICBpZiBkb2NfdHlwZToKICAgICAgICAgICAgcXVlcnkgPSAnXG4nLmpvaW4oW3F1ZXJ5LCAnV0hFUkUgZG9jX3R5cGUgPSA/J10pCiAgICAgICAgICAgIGFyZ3MgPSAoZG9jX3R5cGUsKQoKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCBhcmdzLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXS5nZXQoJ2RvY3NfY291bnQnLCAwKQogICAgICAgIHJldHVybiAwCgogICAgZGVmIGdldF9leGlzdGluZ19kb2NzKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIlNFTEVDVCBkb2Nfbixkb2NfdHlwZSBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0iCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgd3JpdGVfZXJyb3Jfb25fbG9nKHNlbGYsIGVycm9yX3RleHQsICoqa3dhcmdzKToKICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlLndyaXRlX3RvX2xvZyhlcnJvcl90ZXh0LCAqKmt3YXJncykKCiAgICBkZWYgZ2V0X2RvY3NfYW5kX2dvb2RzX2Zvcl91cGxvYWQoc2VsZik6CgogICAgICAgIHF1ZXJ5X2RvY3MgPSBmJycnU0VMRUNUICogRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFdIRVJFIHZlcmlmaWVkID0gMSAgYW5kIChzZW50IDw+IDEgb3Igc2VudCBpcyBudWxsKScnJwogICAgICAgIHF1ZXJ5X2dvb2RzID0gZicnJ1NFTEVDVCAqIEZST00ge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfSBXSEVSRSAoc2VudCA9IDAgT1Igc2VudCBpcyBOdWxsKScnJwogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzX2RvY3MgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2RvY3MsIE5vbmUsIFRydWUpCiAgICAgICAgICAgIHJlc19nb29kcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZ29vZHMsIE5vbmUsIFRydWUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgaWYgbm90IHJlc19nb29kczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICByZXR1cm4gc2VsZi5mb3JtX2RhdGFfZm9yX3JlcXVlc3QocmVzX2RvY3MsIHJlc19nb29kcywgRmFsc2UpCgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmQoc2VsZiwgaWRfZG9jPScnKToKICAgICAgICBkYXRhID0gW10KCiAgICAgICAgZG9jX2lkX2NvbmRpdGlvbiA9IGYnaWRfZG9jPSJ7aWRfZG9jfSInIGlmIGlkX2RvYyBlbHNlICd2ZXJpZmllZCA9IDEgQU5EIElGTlVMTChzZW50LCAwKSA9IDAnCgogICAgICAgIHEgPSBmJycnU0VMRUNUIGlkX2RvYwogICAgICAgICAgICAgICAgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IAogICAgICAgICAgICAgICAgV0hFUkUge2RvY19pZF9jb25kaXRpb259CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEpCgogICAgICAgIGZvciByb3cgaW4gcmVzOgogICAgICAgICAgICBpZF9kb2MgPSByb3dbJ2lkX2RvYyddCgogICAgICAgICAgICBkb2NfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydGllcycsICdpZF9zZXJpZXMnLCAnaWRfdW5pdCcsICdxdHR5JywgJ3F0dHlfcGxhbiddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCAoc2VudCA9IDAgT1Igc2VudCBJUyBOVUxMKQogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBnb29kcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3NfdGFibGUnXSA9IGdvb2RzCgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3Byb3BlcnR5JywgJ2lkX3NlcmllcycsICdiYXJjb2RlX2Zyb21fc2Nhbm5lcicsICdHVElOJywgJ1NlcmllcyddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBJRk5VTEwoYmFyY29kZV9mcm9tX3NjYW5uZXIsICcnKSA8PiAnJwogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBkb2NfYmFyY29kZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2MpCiAgICAgICAgICAgIGRvY19kYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NfYmFyY29kZXMKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2JhcmNvZGUnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIGJhcmNfZmxvdyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2JhcmNfZmxvdyddID0gYmFyY19mbG93CgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3NlcmllcycsICdpZF93YXJlaG91c2UnLCAncXR0eScsICduYW1lJywgJ2Jlc3RfYmVmb3JlJywgJ251bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIHNlcmllc190YWJsZSA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3Nfc2VyaWVzJ10gPSBzZXJpZXNfdGFibGUKICAgICAgICAgICAgZGF0YS5hcHBlbmQoZG9jX2RhdGEpCgogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmRfYnlfZG9jX2lkKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X2RhdGFfdG9fc2VuZChpZF9kb2M9aWRfZG9jKQoKICAgIGRlZiBnZXRfY291bnRfbWFya19jb2RlcyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIERJU1RJTkNUIENPVU5UKGlkKSBhcyBjb2xfc3RyIAogICAgICAgICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMgV0hFUkUgaWRfZG9jID0gPyBBTkQgaXNfcGxhbiA9IDEKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9zcWxfcXVlcnkoCiAgICAgICAgICAgIHE9cSwKICAgICAgICAgICAgcGFyYW1zPWlkX2RvYywKICAgICAgICApCgogICAgICAgIHJldHVybiByZXNbMF1bJ2NvbF9zdHInXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB1cGRhdGVfdXBsb2FkZWRfZG9jc19zdGF0dXMoZG9jX2luX3N0cik6CiAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2Fkcl9kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3NfdGFibGUgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHVwZGF0ZV9yc19kb2NzX3RhYmxlX3NlbnRfc3RhdHVzKHRhYmxlX3N0cmluZ19pZDogc3RyKToKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3NfdGFibGUgU0VUIHNlbnQgPSAwICBXSEVSRSBpZCBpbiAoe3RhYmxlX3N0cmluZ19pZH0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgIGRlZiBzZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZiwgZG9jX2lkKToKICAgICAgICBxdGV4dCA9IGYiVVBEQVRFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gU0VUIHNlbnQgPSAwLCB2ZXJpZmllZCA9IDAgIFdIRVJFIGlkX2RvYyA9ICd7ZG9jX2lkfSciCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICBkZWYgdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgcm93X2lkLCBkYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSBzZWxmLmRldGFpbHNfdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIudXBkYXRlKGRhdGE9ZGF0YSwgX2ZpbHRlcj17J2lkJzogcm93X2lkfSkKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBwYXJhbXMpCiAgICAKICAgIGRlZiBnZXRfZG9jX3Jvd3NfY291bnQoc2VsZiwgaWRfZG9jKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9ICAKICAgICAgICAKICAgICAgICBpZiBpZF9kb2M6ICAKICAgICAgICAgICAgcSA9ICdTRUxFQ1QgY291bnQoaWRfZG9jKSBhcyBkb2Nfcm93cyBGUk9NIFJTX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jPT8nCiAgICAgICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHN0cihpZF9kb2MpKSAgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXMgYW5kICdkb2Nfcm93cycgaW4gcmVzWzBdOiAKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHsnZG9jX3Jvd3MnOiByZXNbMF1bJ2RvY19yb3dzJ119CiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0ICAKCiAgICBkZWYgZ2V0X2JhcmNvZGVfZGF0YShzZWxmLCBiYXJjb2RlKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9ICAKCiAgICAgICAgaWYgYmFyY29kZTogIAogICAgICAgICAgICBxID0gJ1NFTEVDVCAqIEZST00gUlNfYmFyY29kZXMgV0hFUkUgYmFyY29kZT0/JwogICAgICAgICAgICByZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBzdHIoYmFyY29kZSkpIAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzOiAgCiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNbMF0gaWYgcmVzIGVsc2Uge30KCiAgICAgICAgcmV0dXJuIHJlc3VsdCAgICAKCiAgICBkZWYgbWFya192ZXJpZmllZChzZWxmLCB2YWx1ZT0xKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSBzZWxmLmRvY3NfdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIudXBkYXRlKHsndmVyaWZpZWQnOiB2YWx1ZX0sIHsnaWRfZG9jJzogc2VsZi5kb2NfaWR9KQoKICAgIGRlZiByZXNldF9kb2NfdGFibGVzX3F0dHkoc2VsZik6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZSh7J3F0dHknOiAwfSwgeydpZF9kb2MnOiBzZWxmLmRvY19pZH0pCgogICAgZGVmIGdldF90YWJsZV9pbmRleF9kYXRhKHNlbGYsIGlkX2RvYywgZmlyc3RfZWxlbWVudF9wYWdlLCBmaXJzdF9lbGVtZW50X2xpc3QpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgU0VMRUNUIGlkIEFTIHJvd19pZCBGUk9NCiAgICAgICAgCiAgICAgICAgICAgIChTRUxFQ1QgaWQsIDAgQVMgb3JkZXJpbmcgCiAgICAgICAgICAgIEZST00gUlNfZG9jc190YWJsZSAKICAgICAgICAgICAgV0hFUkUgaWQgPCAie2ZpcnN0X2VsZW1lbnRfbGlzdH0iIEFORCBpZCA8PiAie2ZpcnN0X2VsZW1lbnRfcGFnZX0iIEFORCBpZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgICAgIAogICAgICAgICAgICBVTklPTgogICAgICAgICAgICAKICAgICAgICAgICAgU0VMRUNUIGlkLCAxIAogICAgICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgCiAgICAgICAgICAgIFdIRVJFIGlkID0gIntmaXJzdF9lbGVtZW50X3BhZ2V9IiBBTkQgaWRfZG9jID0gIntpZF9kb2N9IgogICAgICAgICAgICAKICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgCiAgICAgICAgICAgIFNFTEVDVCBpZCwgMiAKICAgICAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlIAogICAgICAgICAgICBXSEVSRSBpZCA+PSAie2ZpcnN0X2VsZW1lbnRfbGlzdH0iIEFORCBpZCA8PiAie2ZpcnN0X2VsZW1lbnRfcGFnZX0iIEFORCBpZF9kb2MgPSAie2lkX2RvY30iKQogICAgICAgICAgICAKICAgICAgICBHUk9VUCBCWSAoaWQpCiAgICAgICAgT1JERVIgQlkgTUFYKG9yZGVyaW5nKQogICAgICAgICcnJwoKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHEpCiAgICAgICAgcmV0dXJuIGxpc3QoKnppcCgqcmVzKSkKCiAgICBkZWYgZ2V0X2RvY19yb3dfZGF0YShzZWxmLCByb3dfaWQpOgoKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICB0LmlkX2RvYyBBUyBpZF9kb2MsCiAgICAgICAgICAgICAgICB0LmlkX2dvb2QgQVMgaXRlbV9pZCwKICAgICAgICAgICAgICAgIHQuaWRfcHJvcGVydGllcyBhcyBwcm9wZXJ0eV9pZCwKICAgICAgICAgICAgICAgIHQuaWRfdW5pdCBhcyB1bml0X2lkLAogICAgICAgICAgICAgICAgdC5xdHR5X3BsYW4sCiAgICAgICAgICAgICAgICB0LnF0dHksCiAgICAgICAgICAgICAgICB0LmRfcXR0eSBBUyBkX3F0dHksCiAgICAgICAgICAgICAgICB0LnVzZV9zZXJpZXMsCiAgICAgICAgICAgICAgICB0LnByaWNlLAogICAgICAgICAgICAgICAgSUZOVUxMKGcubmFtZSwgJycpIEFTIGl0ZW1fbmFtZSwKICAgICAgICAgICAgICAgIElGTlVMTChnLmFydCwgJycpIEFTIGFydGljbGUsCiAgICAgICAgICAgICAgICBJRk5VTEwocC5uYW1lLCAnJykgQVMgcHJvcGVydHksCiAgICAgICAgICAgICAgICBJRk5VTEwodS5uYW1lLCAnJykgQVMgdW5pdAoKICAgICAgICAgICAgRlJPTSB7c2VsZi5kZXRhaWxzX3RhYmxlX25hbWV9IEFTIHQKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAgQVMgZwogICAgICAgICAgICBPTiB0LmlkX2dvb2Q9IGcuaWQKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzICBBUyBwCiAgICAgICAgICAgIE9OIHQuaWRfcHJvcGVydGllcyA9IHAuaWQKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cyAgQVMgdQogICAgICAgICAgICBPTiB0LmlkX3VuaXQgPSB1LmlkCgogICAgICAgICAgICBXSEVSRSB0LmlkID0gIntyb3dfaWR9IgogICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKCiAgICAgICAgcmV0dXJuIHJlc1swXSBpZiByZXMgZWxzZSB7fQoKICAgIGRlZiBnZXRfZG9jX3Jvd19ieV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCB0LmlkLCBiLnJhdGlvIAogICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzIGFzIGIgCiAgICAgICAgICAgIEpPSU4ge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfSBhcyB0CiAgICAgICAgICAgICAgICBPTiBiLmlkX2dvb2QgPSB0LmlkX2dvb2QKICAgICAgICAgICAgICAgIEFORCBiLmlkX3Byb3BlcnR5ID0gdC5pZF9wcm9wZXJ0aWVzCiAgICAgICAgCiAgICAgICAgICAgIFdIRVJFIGJhcmNvZGUgPSAne2JhcmNvZGV9JwogICAgICAgICAgICBMSU1JVCAxCiAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxLCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXNbMF0gaWYgcmVzIGVsc2UgTm9uZQoKY2xhc3MgU2VyaWVzU2VydmljZShEYlNlcnZpY2UpOgogICAgZG9jX2Jhc2ljX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgIGRvY19iYXNpY19oYW5kbGVyX25hbWUgPSAnUlNfZG9jcycKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAjaWYgcGFyYW1zIGFuZCBpc2luc3RhbmNlKHBhcmFtcywgZGljdCk6CiAgICAgICAgIyAgICBzZWxmLnBhcmFtcyA9IHBhcmFtcwogICAgICAgICNlbHNlOgogICAgICAgIHNlbGYucGFyYW1zID0ge30KCiAgICBkZWYgZ2V0X3Nlcmllc19ieV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUsIHBhcmFtczogZGljdCk6CgogICAgICAgIHBhcmFtcyA9IFsKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksCiAgICAgICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfcHJvcGVydGllcycpLAogICAgICAgICAgICBiYXJjb2RlLAogICAgICAgICAgICBiYXJjb2RlCiAgICAgICAgXSAgIyBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpLAogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgaWRfcHJvcGVydGllcywKICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgIHF0dHksCiAgICAgICAgICAgbmFtZSwKICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgIGNlbGwKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcyA9ID8gCiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9hZHJfc2VyaWVzX2J5X2JhcmNvZGUoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgcGFyYW1zID0gW3NlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2NlbGwnKSwKICAgICAgICAgICAgICAgICAgYmFyY29kZSwgIGJhcmNvZGVdICAjIHNlbGYucGFyYW1zLmdldCgnaWRfd2FyZWhvdXNlJyksCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCBpZCwKICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICBpZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICBpZF93YXJlaG91c2UsCiAgICAgICAgICAgcXR0eSwKICAgICAgICAgICBuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciwKICAgICAgICAgICBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgY2VsbAogICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIFJTX2RvY3Nfc2VyaWVzLmNlbGwgPSA/CiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9zZXJpZXNfYnlfZG9jX2FuZF9nb29kcyhzZWxmKToKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJykpICAjICwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKQoKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkIGFzIGtleSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyBhcyBpZF9kb2MsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLnF0dHksCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsICcnKSBBUyBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX24sICcnKSBBUyBkb2NfbiwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3dhcmVob3VzZXMubmFtZSAsICcnKSBBUyB3YXJlaG91c2VfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZG9jcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9IFJTX2RvY3MuaWRfZG9jCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIAogICAgICAgICAgICAgICAgT04gUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gUlNfd2FyZWhvdXNlcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gPyAKICAgICAgICAgICAgCiAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBnZXRfc2VyaWVzX2J5X2Fkcl9kb2NfYW5kX2dvb2RzKHNlbGYpOgogICAgICAgIGN1cnJfY2VsbCA9IHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGlmIHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGVsc2Ugc2VsZi5wYXJhbXMuZ2V0KCdpZF9jZWxsJykKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksIGN1cnJfY2VsbCkgICMgLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWQgYXMga2V5LAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MgYXMgaWRfZG9jLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9zZXJpZXMsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMubmFtZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsLAogICAgICAgICAgICBSU19kb2NzLmRvY190eXBlLAogICAgICAgICAgICBSU19kb2NzLmRvY19uLCAKICAgICAgICAgICAgUlNfZG9jcy5kb2NfZGF0ZSwKICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcy5uYW1lIGFzIHdhcmVob3VzZV9uYW1lLAogICAgICAgICAgICBSU19jZWxscy5uYW1lIGFzIGNlbGxfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gCiAgICAgICAgICAgIFJTX2RvY3MgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9ICBSU19kb2NzLmlkX2RvYwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19nb29kcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ICBSU19nb29kcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19wcm9wZXJ0aWVzIE9OIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzID0gIFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gIFJTX3dhcmVob3VzZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jZWxscyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsID0gPwogICAgICAgICAgICAnJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGFkZF9xdHR5X3RvX3RhYmxlX3N0cihzZWxmLCBpdGVtX2lkKToKICAgICAgICBwYXJhbXMgPSAoaXRlbV9pZCwpCiAgICAgICAgcSA9ICcnJ1VQREFURSBSU19kb2NzX3NlcmllcwogICAgICAgICAgICBTRVQgcXR0eSA9IHF0dHkgKyAxCiAgICAgICAgICAgIFdIRVJFIGlkID0gPycnJwoKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCgoKICAgIGRlZiBhZGRfbmV3X3Nlcmllc19pbl9kb2Nfc2VyaWVzX3RhYmxlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHFfcGFyYW1zID0gKAogICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3Byb3BlcnRpZXMnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKSwgMSwKICAgICAgICAgICAgICAgIGJhcmNvZGUsIGJhcmNvZGUsIHNlbGYucGFyYW1zLmdldCgnaWRfY2VsbCcpKQogICAgICAgIHEgPSAnSU5TRVJUIElOVE8gUlNfZG9jc19zZXJpZXMgKGlkX2RvYywgaWRfZ29vZCwgaWRfcHJvcGVydGllcywgaWRfd2FyZWhvdXNlLCBxdHR5LCBuYW1lLCBudW1iZXIsIGNlbGwpIFZBTFVFUyg/LD8sPyw/LD8sPyw/LD8pJwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIHFfcGFyYW1zKQoKICAgIGRlZiBnZXRfaXRlbV9ieV9uYW1lKHNlbGYsIGl0ZW1fbmFtZSwgdGFibGVfbmFtZSk6CiAgICAgICAgcSA9IGYnU0VMRUNUIGlkIEZST00ge3RhYmxlX25hbWV9IFdIRVJFIHt0YWJsZV9uYW1lfS5uYW1lID0gPycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIChpdGVtX25hbWUsKSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1bMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBkZWxldGVfY3VycmVudF9zdChzZWxmLCBpZCk6CiAgICAgICAgcSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3NlcmllcyAgV0hFUkUgaWQgPSA/JwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIChpZCwpKQoKCiAgICBkZWYgZ2V0X3Nlcmllc19wcm9wX2J5X2lkKHNlbGYsIGlkKToKICAgICAgICB0YWJsZV9uYW1lID0gc2VsZi5kb2NfYmFzaWNfdGFibGVfbmFtZQogICAgICAgIGlzX2FkciA9IEZhbHNlIGlmIHRhYmxlX25hbWUgPT0gJ1JTX2RvY3NfdGFibGUnIGVsc2UgVHJ1ZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZCwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfZG9jLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9nb29kLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9zZXJpZXMsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX3VuaXQsCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHksCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHlfcGxhbiwKICAgICAgICAgICAgICAgICAgICAgJycnCiAgICAgICAgcSA9IHEgKyBmJycnIHt0YWJsZV9uYW1lfS5pZF9jZWxsLCAKICAgICAgICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfY2VsbCBhcyBjZWxsLCAKICAgICAgICAgICAgICAgIFJTX2NlbGxzLm5hbWUgYXMgY2VsbF9uYW1lLCAKICAgICAgICAgICAgICAgIDAgYXMgcHJpY2UsCiAgICAgICAgICAgICAgICBOdWxsIGFzIGlkX3ByaWNlLCcnJyBpZiBpc19hZHIgZWxzZSBxICsgIGYnJycKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5wcmljZSwKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcmljZSwnJycKCiAgICAgICAgcSA9IHEgKyBmJycnCiAgICAgICAgICAge3RhYmxlX25hbWV9LnVzZV9zZXJpZXMsCiAgICAgICAgICAgUlNfZ29vZHMuYXJ0IGFzIGNvZGVfYXJ0LCAKICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZQogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0gCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX2dvb2RzCiAgICAgICAgICAgIE9OIHt0YWJsZV9uYW1lfS5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04ge3RhYmxlX25hbWV9LmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gICBSU191bml0cwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfdW5pdCA9IFJTX3VuaXRzLmlkCiAgICAgICAgICAgICcnJwogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gICBSU19jZWxscwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgICcnJyBpZiBpc19hZHIgZWxzZSBxCgogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWQgPSA/CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKGlkLCksIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHt9CgoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2VyaWVzX3RhYmxlX3N0cihpZCk6CiAgICAgICAgcSA9ICcnJwogICAgICAgU0VMRUNUIAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF93YXJlaG91c2UsCiAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLmJlc3RfYmVmb3JlLCAnJykgQVMgYmVzdF9iZWZvcmUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMubnVtYmVyLAogICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCwKICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwgCiAgICAgICAgUlNfY2VsbHMubmFtZSBhcyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgT04gUlNfZ29vZHMuaWQgPSBSU19kb2NzX3Nlcmllcy5pZF9nb29kCiAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgT04gUlNfY2VsbHMuaWQgPSBSU19kb2NzX3Nlcmllcy5jZWxsCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWQgPSA/CiAgICAgICAgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCAoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKCiAgICBkZWYgZ2V0X2RvY19wcm9wX2J5X2lkKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgdGFibGVfbmFtZSA9IHNlbGYuZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZF9kb2MsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmRvY19uLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5kb2NfZGF0ZSwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlIGFzIGlkX3dhcmVob3VzZSwKICAgICAgICAgICBSU193YXJlaG91c2VzLm5hbWUgYXMgd2FyZWhvdXNlCiAgICAgICAgICAgCiAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0KICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBPTgogICAgICAgIHt0YWJsZV9uYW1lfS5pZF93YXJlaG91c2UgPSBSU193YXJlaG91c2VzLmlkCiAgICAgICAgICAKICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWRfZG9jID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWRfZG9jLCksVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCiAgICBkZWYgZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKHNlbGYsIGlkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5wcmljZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfbiwgJycpIEFTIGRvY19uLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfZGF0ZSwgJycpIEFTIGRvY19kYXRlLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMubmFtZSwgJycpIEFTIGdvb2RfbmFtZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmFydCwgJycpIEFTIGdvb2RfYXJ0LAogICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCAnJykgQVMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwgJycpIEFTIGdvb2RfdW5pdCAKICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgQVMgUlNfZG9jc190YWJsZQogICAgICAgIAogICAgICAgIExFRlQgSk9JTiBSU19kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBzYXZlX3RhYmxlX3N0cihzZWxmLCBwYXJhbXMpOgogICAgICAgIHEgPSAnJycKICAgICAgICBVUERBVEUgUlNfZG9jc19zZXJpZXMKICAgICAgICBTRVQgCiAgICAgICAgICAgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcyA9IDppZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlID0gOmlkX3dhcmVob3VzZSwKICAgICAgICAgICBxdHR5ID0gOnF0dHksCiAgICAgICAgICAgbmFtZSA9IDpuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlID0gOmJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciA9IDpudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlID0gOnByb2R1Y3Rpb25fZGF0ZSwKICAgICAgICAgICBjZWxsICA9IDpjZWxsCiAgICAgICAgV0hFUkUgaWQgPSA6aWQgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0X3RvdGFsX3F0dHkoc2VsZik6CgogICAgICAgIHBhcmFtcyA9IChzZWxmLnBhcmFtcy5nZXQoJ2lkX2RvYycpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2dvb2QnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9wcm9wZXJ0aWVzJykpCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCAKICAgICAgICBzdW0ocXR0eSkgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBpZF9nb29kID0gPyBBTkQgaWRfcHJvcGVydGllcyA9ID8nJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIHBhcmFtcykKICAgICAgICBpZiByZXMgYW5kIHJlc1swXVswXSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHJlc1swXVswXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAwCgogICAgZGVmIHVwZGF0ZV90b3RhbF9xdHkoc2VsZiwgcXR5LCByb3dfaWQpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFVQREFURSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgIFNFVCBkX3F0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgQWRyU2VyaWVzU2VydmljZShTZXJpZXNTZXJ2aWNlKToKICAgIGRlZiBnZXRfdmFsdWVzX2Zvcl9zY3JlZW5fYnlfaWQoc2VsZiwgX2lkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2NlbGwsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY190eXBlLCAnJykgQVMgZG9jX3R5cGUsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19uLCAnJykgQVMgZG9jX24sCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5uYW1lLCAnJykgQVMgZ29vZF9uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgZ29vZF9hcnQsCiAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsICcnKSBBUyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCAnJykgQVMgZ29vZF91bml0LCAKICAgICAgICAgICAgSUZOVUxMKFJTX2NlbGxzLm5hbWUsICcnKSBBUyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIEFTIFJTX2RvY3NfdGFibGUKCiAgICAgICAgTEVGVCBKT0lOIFJTX2Fkcl9kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9jZWxsID0gUlNfY2VsbHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKF9pZCwpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiB1cGRhdGVfdG90YWxfcXR5KHNlbGYsIHF0eSwgcm93X2lkKToKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUKICAgICAgICAgICAgU0VUIHF0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgU2VsZWN0SXRlbVNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCgogICAgZGVmIGdldF9zZWxlY3RfZGF0YShzZWxmLCAqKmNvbmQpIC0+IGxpc3Q6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi50YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc2VsZWN0KGNvbmQpCgoKY2xhc3MgQWRyRG9jU2VydmljZShEb2NTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2M9JycsIGN1cl9jZWxsPScnLCB0YWJsZV90eXBlPSdpbicpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX25hbWUgPSAnUlNfQWRyX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfYWRyX2RvY3NfdGFibGUnCiAgICAgICAgc2VsZi5pc0FkciA9IFRydWUKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IEZhbHNlCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSBjdXJfY2VsbAogICAgICAgIHNlbGYudGFibGVfdHlwZSA9IHRhYmxlX3R5cGUKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzZWxmLmRvY3NfdGFibGVfbmFtZSwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gRmFsc2UKCiAgICBkZWYgZ2V0X2RvY19kZXRhaWxzX2RhdGEoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGZpcnN0X2VsZW0sCiAgICAgICAgICAgIGl0ZW1zX29uX3BhZ2UsCiAgICAgICAgICAgIHJvd19maWx0ZXJzPU5vbmUsCiAgICAgICAgICAgIHNlYXJjaF9zdHJpbmc9Tm9uZSwKICAgICAgICAgICAgaWRfZG9jPScnLAogICAgICAgICAgICBjZWxsPScnCiAgICApIC0+IGxpc3Q6CgogICAgICAgIHNlbGVjdF9xdWVyeSA9ICcnJ1NFTEVDVAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5pZCwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWRfZG9jLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBpZm51bGwoUlNfZ29vZHMubmFtZSwgOk51bGxWYWx1ZSkgYXMgZ29vZF9uYW1lLAogICAgICAgICAgICBpZm51bGwoUlNfZ29vZHMuY29kZSwgOkVtcHR5U3RyaW5nKSBhcyBjb2RlLAogICAgICAgICAgICBpZm51bGwoUlNfZ29vZHMuYXJ0LCA6RW1wdHlTdHJpbmcpIGFzIGFydCwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsIDpFbXB0eVN0cmluZykgYXMgaWRfcHJvcGVydGllcywKICAgICAgICAgICAgaWZudWxsKFJTX3Byb3BlcnRpZXMubmFtZSwgOkVtcHR5U3RyaW5nKSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIGlmbnVsbChSU19hZHJfZG9jc190YWJsZS5pZF9zZXJpZXMsIDpFbXB0eVN0cmluZykgYXMgaWRfc2VyaWVzLAogICAgICAgICAgICBpZm51bGwoUlNfc2VyaWVzLm5hbWUsIDpFbXB0eVN0cmluZykgYXMgc2VyaWVzX25hbWUsCiAgICAgICAgICAgIGlmbnVsbChSU19hZHJfZG9jc190YWJsZS5pZF91bml0LCA6RW1wdHlTdHJpbmcpIGFzIGlkX3VuaXQsCiAgICAgICAgICAgIGlmbnVsbChSU191bml0cy5uYW1lLCA6RW1wdHlTdHJpbmcpIGFzIHVuaXRzX25hbWUsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHkgYXMgcXR0eSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eV9wbGFuIGFzIHF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eV9wbGFuIC0gUlNfYWRyX2RvY3NfdGFibGUucXR0eSBhcyBJc0RvbmUsCiAgICAgICAgICAgIGlmbnVsbChSU19hZHJfZG9jc190YWJsZS5pZF9jZWxsLCA6RW1wdHlTdHJpbmcpIGFzIGlkX2NlbGwsCiAgICAgICAgICAgIGlmbnVsbChSU19jZWxscy5uYW1lLCA6TnVsbFZhbHVlKSBhcyBjZWxsX25hbWUsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnVzZV9zZXJpZXMKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIAoKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzIAogICAgICAgICAgICBPTiBSU19nb29kcy5pZD1SU19hZHJfZG9jc190YWJsZS5pZF9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPSBSU19hZHJfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgICAgICAgICAgT04gUlNfc2VyaWVzLmlkID0gUlNfYWRyX2RvY3NfdGFibGUuaWRfc2VyaWVzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICBPTiBSU191bml0cy5pZD1SU19hZHJfZG9jc190YWJsZS5pZF91bml0CiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jZWxscwogICAgICAgICAgICBPTiBSU19jZWxscy5pZD1SU19hZHJfZG9jc190YWJsZS5pZF9jZWxsCiAgICAgICAgICAgICcnJwoKICAgICAgICBiYXNpY193aGVyZSA9IGYiIiJXSEVSRSBpZF9kb2MgPSA6aWRfZG9jIGFuZCB0YWJsZV90eXBlID0gOnRhYmxlX3R5cGUiIiIKCiAgICAgICAgY3VyX2NlbGxfY29uZGl0aW9uID0gJycnYW5kIChpZF9jZWxsPTpjdXJyZW50X2NlbGwgT1IgaWRfY2VsbD0iIiBPUiBpZF9jZWxsIGlzIE51bGwpJycnIGlmIGNlbGwgZWxzZSAnJwogICAgICAgIHJvd19maWx0ZXJzX2NvbmRpdGlvbiA9ICIiIkFORCBxdHR5ICE9IENPQUxFU0NFKHF0dHlfcGxhbiwgJzAnKSAiIiIgaWYgcm93X2ZpbHRlcnMgZWxzZSAnJwogICAgICAgIHNlYXJjaF9zdHJpbmdfY29uZGl0aW9uID0gZiIiIkFORCBnb29kX25hbWUgTElLRSAnJXtzZWFyY2hfc3RyaW5nfSUnIiIiIGlmIHNlYXJjaF9zdHJpbmcgZWxzZSAnJwoKICAgICAgICB3aGVyZV9mdWxsID0gZiIiIgogICAgICAgICAgICAgICAge2Jhc2ljX3doZXJlfQogICAgICAgICAgICAgICAge2N1cl9jZWxsX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgIHtyb3dfZmlsdGVyc19jb25kaXRpb259CiAgICAgICAgICAgICAgICB7c2VhcmNoX3N0cmluZ19jb25kaXRpb259CiAgICAgICAgIiIiCgogICAgICAgIG9yZGVyX2J5ID0gZiIiIk9SREVSIEJZIFJTX2NlbGxzLm5hbWUsIFJTX2Fkcl9kb2NzX3RhYmxlLmxhc3RfdXBkYXRlZCBERVNDIiIiCiAgICAgICAgbGltaXQgPSBmJ0xJTUlUIHtpdGVtc19vbl9wYWdlfSBPRkZTRVQge2ZpcnN0X2VsZW19JwogICAgICAgIHF1ZXJ5X3RleHQgPSBmIntzZWxlY3RfcXVlcnl9IHt3aGVyZV9mdWxsfSB7b3JkZXJfYnl9IHtsaW1pdH0iCgogICAgICAgIHBhcmFtc19kaWN0ID0geydpZF9kb2MnOiBpZF9kb2MsICdOdWxsVmFsdWUnOiBOb25lLCAnRW1wdHlTdHJpbmcnOiAnJywgJ3RhYmxlX3R5cGUnOiBzZWxmLnRhYmxlX3R5cGV9CiAgICAgICAgaWYgY2VsbDoKICAgICAgICAgICAgcGFyYW1zX2RpY3RbJ2N1cnJlbnRfY2VsbCddID0gY2VsbAogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgcGFyYW1zX2RpY3QsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBjbGVhcl9iYXJjb2RlX2RhdGEoc2VsZiwgaWRfZG9jKToKICAgICAgICBfZmlsdGVyID0geydpZF9kb2MnOiBpZF9kb2N9CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gJ1JTX2RvY3Nfc2VyaWVzJwogICAgICAgIHNlbGYucHJvdmlkZXIuZGVsZXRlKF9maWx0ZXI9X2ZpbHRlcikKCiAgICAgICAgcXVlcnlfdGV4dCA9ICgKICAgICAgICAgICAgJ1VQREFURSBSU19hZHJfZG9jc190YWJsZSBzZXQgcXR0eSA9IDAgV0hFUkUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAnVVBEQVRFIFJTX2Fkcl9kb2NzIHNldCB2ZXJpZmllZCA9IDAsIHNlbnQgPSAwIFdIRVJFIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYz06aWRfZG9jIEFORCBpc19wbGFuID0gIkZhbHNlIicKICAgICAgICApCgogICAgICAgIHRyeToKICAgICAgICAgICAgZm9yIGVsIGluIHF1ZXJ5X3RleHQ6CiAgICAgICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsLCAoeydpZF9kb2MnOiBpZF9kb2N9KSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKICAgICAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogRmFsc2UsICdlcnJvcic6IGUuYXJnc1swXX0KCiAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogVHJ1ZSwgJ2Vycm9yJzogJyd9CgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmQoc2VsZiwgaWRfZG9jPScnKToKICAgICAgICBkYXRhID0gW10KCiAgICAgICAgZG9jX2lkX2NvbmRpdGlvbiA9IGYnaWRfZG9jPSJ7aWRfZG9jfSInIGlmIGlkX2RvYyBlbHNlICd2ZXJpZmllZCA9IDEgQU5EIElGTlVMTChzZW50LCAwKSA9IDAnCgogICAgICAgIHEgPSBmJycnU0VMRUNUIGlkX2RvYwogICAgICAgICAgICAgICAgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IAogICAgICAgICAgICAgICAgV0hFUkUge2RvY19pZF9jb25kaXRpb259CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEpCgogICAgICAgIGZvciByb3cgaW4gcmVzOgogICAgICAgICAgICBpZF9kb2MgPSByb3dbJ2lkX2RvYyddCgogICAgICAgICAgICBkb2NfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydGllcycsICdpZF9zZXJpZXMnLCAnaWRfdW5pdCcsICdxdHR5JywgJ3F0dHlfcGxhbicsICd0YWJsZV90eXBlJywKICAgICAgICAgICAgICAgICAgICAgICdpZF9jZWxsJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIAogICAgICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gPyBBTkQgKHNlbnQgPSAwIE9SIHNlbnQgSVMgTlVMTCkKICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQogICAgICAgICAgICBnb29kcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2Fkcl9kb2NzX3RhYmxlJ10gPSBnb29kcwoKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfc2VyaWVzJywgJ2lkX3dhcmVob3VzZScsICdjZWxsJywgJ3F0dHknLCAnbmFtZScsICdiZXN0X2JlZm9yZScsICdudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgJ3Byb2R1Y3Rpb25fZGF0ZSddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gPwogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBzZXJpZXNfdGFibGUgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2MpCiAgICAgICAgICAgIGRvY19kYXRhWydSU19kb2NzX3NlcmllcyddID0gc2VyaWVzX3RhYmxlCgogICAgICAgICAgICBkYXRhLmFwcGVuZChkb2NfZGF0YSkKCgogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIGZpbmRfY2VsbChzZWxmLCBiYXJjb2RlKToKICAgICAgICAjIFRPRE8g0L3QtSDRg9GH0LjRgtGL0LLQsNC10YLRgdGPINCy0LDRgNC40LDQvdGCINGBINC+0LTQuNC90LDQutC+0LLRi9C80Lgg0KjQmiDRgdC10YDQuNC5CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gJ1JTX2NlbGxzJwogICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc2VsZWN0KHsnYmFyY29kZSc6IGJhcmNvZGV9KQoKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KCiAgICBkZWYgZ2V0X2RvY19kYXRhX2J5X2lkKHNlbGYpOgogICAgICAgIGlmIHNlbGYuZG9jX2lkOgogICAgICAgICAgICBxID0gZicnJwogICAgICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgICAgIGQuKiwgCiAgICAgICAgICAgICAgICAgICAgdy5uYW1lIEFTIHdhcmVob3VzZSAKICAgICAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3MgYXMgZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyB3IAogICAgICAgICAgICAgICAgICAgIE9OIGQuaWRfd2FyZWhvdXNlID0gdy5pZAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgV0hFUkUgZC5pZF9kb2MgPSAie3NlbGYuZG9jX2lkfSIKICAgICAgICAgICAgJycnCiAgICAgICAgICAgIGRvY19kYXRhID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxLCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgICAgICByZXR1cm4gZG9jX2RhdGFbMF0gaWYgZG9jX2RhdGEgZWxzZSBOb25lCgogICAgZGVmIGdldF9kb2Nfdmlld19kYXRhKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBkb2NfdHlwZT0nJywKICAgICAgICAgICAgZG9jX3N0YXR1czogTGl0ZXJhbFsn0JLRi9Cz0YDRg9C20LXQvScsICfQmiDQstGL0LPRgNGD0LfQutC1JywgJ9CaINCy0YvQv9C+0LvQvdC10L3QuNGOJ10gPSAnJwogICAgKSAtPiBsaXN0OgogICAgICAgIGZpZWxkcyA9IFsKICAgICAgICAgICAgJ2RvYy5pZF9kb2MnLAogICAgICAgICAgICAnZG9jLmRvY190eXBlJywKICAgICAgICAgICAgJ2RvYy5kb2NfbicsCiAgICAgICAgICAgICdkb2MuZG9jX2RhdGUnLAogICAgICAgICAgICAnZG9jLmlkX3dhcmVob3VzZScsCiAgICAgICAgICAgICdkb2MuYWRkX21hcmtfc2VsZWN0aW9uJywKICAgICAgICAgICAgJ0lGTlVMTChkb2MudmVyaWZpZWQsIDApIEFTIHZlcmlmaWVkJywKICAgICAgICAgICAgJ0lGTlVMTChkb2Muc2VudCwgMCkgQVMgc2VudCcsCiAgICAgICAgICAgICdJRk5VTEwoUlNfd2FyZWhvdXNlcy5uYW1lLCAiJyciKSBBUyB3YXJlaG91c2UnLAogICAgICAgIF0KCiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgJyArICcsXG4nLmpvaW4oZmllbGRzKQoKICAgICAgICBqb2lucyA9IGYnJydGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gQVMgZG9jCiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIGFzIFJTX3dhcmVob3VzZXMKICAgICAgICAgICAgICAgIE9OIFJTX3dhcmVob3VzZXMuaWQgPSBkb2MuaWRfd2FyZWhvdXNlCiAgICAgICAgJycnCgogICAgICAgIHdoZXJlID0gJycKICAgICAgICBjb25kaXRpb24gPSBbXQoKICAgICAgICBpZiBkb2Nfc3RhdHVzID09ICLQktGL0LPRgNGD0LbQtdC9IjoKICAgICAgICAgICAgY29uZGl0aW9uLmFwcGVuZCgic2VudCA9IDEgQU5EIHZlcmlmaWVkID0gMSIpCiAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0LPRgNGD0LfQutC1IjoKICAgICAgICAgICAgY29uZGl0aW9uLmFwcGVuZCgiSUZOVUxMKHZlcmlmaWVkLCAwKSA9IDEgQU5EIElGTlVMTChzZW50LCAwKSA9IDAiKQogICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4iOgogICAgICAgICAgICBjb25kaXRpb24uYXBwZW5kKCJJRk5VTEwodmVyaWZpZWQsIDApID0gMCBBTkQgSUZOVUxMKHNlbnQsIDApID0gMCIpCgogICAgICAgIGlmIGRvY190eXBlOgogICAgICAgICAgICBjb25kaXRpb24uYXBwZW5kKGYnZG9jX3R5cGU9Intkb2NfdHlwZX0iJykKCiAgICAgICAgaWYgY29uZGl0aW9uOgogICAgICAgICAgICB3aGVyZSA9ICdXSEVSRSAnICsgJyBBTkRcbicuIGpvaW4oY29uZGl0aW9uKQoKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICB7cXVlcnlfdGV4dH0KICAgICAgICAgICAge2pvaW5zfQogICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgIE9SREVSIEJZIGRvYy5kb2NfZGF0ZQogICAgICAgICcnJwogICAgICAgIHJlc3VsdCA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGdldF9kb2Nfcm93X2RhdGEoc2VsZiwgcm93X2lkKToKCiAgICAgICAgcSA9IGYnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgdC5pZF9kb2MgQVMgaWRfZG9jLAogICAgICAgICAgICAgICAgdC5pZF9nb29kIEFTIGl0ZW1faWQsCiAgICAgICAgICAgICAgICB0LmlkX3Byb3BlcnRpZXMgYXMgcHJvcGVydHlfaWQsCiAgICAgICAgICAgICAgICB0LmlkX3VuaXQgYXMgdW5pdF9pZCwKICAgICAgICAgICAgICAgIHQucXR0eV9wbGFuLAogICAgICAgICAgICAgICAgdC5xdHR5LAogICAgICAgICAgICAgICAgdC5xdHR5IEFTIGRfcXR0eSwKICAgICAgICAgICAgICAgIHQudXNlX3NlcmllcywKICAgICAgICAgICAgICAgIElGTlVMTChnLm5hbWUsICcnKSBBUyBpdGVtX25hbWUsCiAgICAgICAgICAgICAgICBJRk5VTEwoZy5hcnQsICcnKSBBUyBhcnRpY2xlLAogICAgICAgICAgICAgICAgSUZOVUxMKHAubmFtZSwgJycpIEFTIHByb3BlcnR5LAogICAgICAgICAgICAgICAgSUZOVUxMKHUubmFtZSwgJycpIEFTIHVuaXQKCiAgICAgICAgICAgIEZST00ge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfSBBUyB0CgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgIEFTIGcKICAgICAgICAgICAgT04gdC5pZF9nb29kPSBnLmlkCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyAgQVMgcAogICAgICAgICAgICBPTiB0LmlkX3Byb3BlcnRpZXMgPSBwLmlkCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgIEFTIHUKICAgICAgICAgICAgT04gdC5pZF91bml0ID0gdS5pZAoKICAgICAgICAgICAgV0hFUkUgdC5pZCA9ICJ7cm93X2lkfSIKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHEsIHJldHVybl9kaWN0PVRydWUpCgogICAgICAgIHJldHVybiByZXNbMF0gaWYgcmVzIGVsc2Uge30KCmNsYXNzIEZsb3dEb2NTZXJ2aWNlKERvY1NlcnZpY2UpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkb2NfaWQ9JycpOgogICAgICAgIHNlbGYuZG9jX2lkID0gZG9jX2lkCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLmRldGFpbHNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgICAgIHNlbGYuaXNBZHIgPSBGYWxzZQogICAgICAgIHNlbGYuc3FsX3RleHQgPSAnJwogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IE5vbmUKICAgICAgICBzZWxmLmRlYnVnID0gRmFsc2UKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzZWxmLmRvY3NfdGFibGVfbmFtZSwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gRmFsc2UKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IFRydWUKCiAgICBkZWYgZ2V0X2RvY192aWV3X2RhdGEoc2VsZiwgZG9jX3R5cGU9JycsIGRvY19zdGF0dXM9JycpIC0+IGxpc3Q6CiAgICAgICAgZmllbGRzID0gWwogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfZG9jJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY190eXBlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19uJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19kYXRlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwiIikgYXMgUlNfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS52ZXJpZmllZCwgMCkgYXMgdmVyaWZpZWQnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnNlbnQsIDApIGFzIHNlbnQnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uYWRkX21hcmtfc2VsZWN0aW9uJywKICAgICAgICBdCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfY291bnRyYWdlbnRzJykKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlzX2dyb3VwX3NjYW4sIDApIGFzIGlzX2dyb3VwX3NjYW4nKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfYmFyY19mbG93LCAwKSBhcyBpc19iYXJjX2Zsb3cnKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKFJTX2NvdW50cmFnZW50cy5mdWxsX25hbWUsICIiKSBhcyBSU19jb3VudHJhZ2VudCcpCgogICAgICAgIHF1ZXJ5X3RleHQgPSAnU0VMRUNUICcgKyAnLFxuJy5qb2luKGZpZWxkcykKCiAgICAgICAgam9pbnMgPSBmJycnRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9CiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIGFzIFJTX3dhcmVob3VzZXMKICAgICAgICAgICAgICAgIE9OIFJTX3dhcmVob3VzZXMuaWQgPSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZQogICAgICAgICcnJwoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGpvaW5zICs9IGYnJycKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2NvdW50cmFnZW50cyBhcyBSU19jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgIE9OIFJTX2NvdW50cmFnZW50cy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfY291bnRyYWdlbnRzCiAgICAgICAgICAgICAgICAnJycKCiAgICAgICAgd2hlcmVfbm90X2dyb3VwX3NjYW4gPSBmJ1dIRVJFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfZ3JvdXBfc2NhbiA9IDAnCiAgICAgICAgd2hlcmVfYmFyY19mbG93ID0gZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlzX2JhcmNfZmxvdyA9IDEnCiAgICAgICAgd2hlcmVfZW1wdHkgPSAoIlJTX2RvY3MuaWRfZG9jIG5vdCBpbiAiCiAgICAgICAgICAgICAgICAgICAgICAgIihTRUxFQ1QgZGlzdGluY3QgaWRfZG9jIEZyb20gUlNfZG9jc190YWJsZSkiKQogICAgICAgIHdoZXJlID0gZiJ7d2hlcmVfbm90X2dyb3VwX3NjYW59IEFORCAoe3doZXJlX2JhcmNfZmxvd30gT1Ige3doZXJlX2VtcHR5fSkiCgogICAgICAgIGlmIGRvY19zdGF0dXM6CiAgICAgICAgICAgIGlmIGRvY19zdGF0dXMgPT0gItCS0YvQs9GA0YPQttC10L0iOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gIkFORCBzZW50PTEgQU5EIHZlcmlmaWVkPTEiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9Cz0YDRg9C30LrQtSI6CiAgICAgICAgICAgICAgICB3aGVyZSArPSAiQU5EIGlmbnVsbCh2ZXJpZmllZCwwKT0xIEFORCBpZm51bGwoc2VudCwwKT0wIgogICAgICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQv9C+0LvQvdC10L3QuNGOIjoKICAgICAgICAgICAgICAgIHdoZXJlICs9ICJBTkQgaWZudWxsKHZlcmlmaWVkLDApPTAgQU5EIGlmbnVsbChzZW50LDApPTAiCgogICAgICAgIGlmIG5vdCBkb2NfdHlwZSBvciBkb2NfdHlwZSA9PSAi0JLRgdC1IjoKICAgICAgICAgICAgYXJnc190dXBsZSA9IE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gKGRvY190eXBlLCkKICAgICAgICAgICAgd2hlcmUgKz0gJyBBTkQgZG9jX3R5cGU9PycKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICB7cXVlcnlfdGV4dH0KICAgICAgICAgICAge2pvaW5zfQogICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgIE9SREVSIEJZIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUKICAgICAgICAnJycKICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfdHVwbGUsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBnZXRfZmxvd190YWJsZV9kYXRhKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJydXSVRIIHRlbXBfcSBhcyAoU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNfZmxvdy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kIGFzIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAxIGFzIHF0dHkKCiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfYmFyY29kZXMuYmFyY29kZSA9IFJTX2JhcmNfZmxvdy5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2JhcmNfZmxvdy5pZF9kb2MgPSA/KQoKICAgICAgICAgICAgICAgICAgICAgICAgU0VMRUNUIHRlbXBfcS5iYXJjb2RlLCB0ZW1wX3EuaWRfZ29vZCwgdGVtcF9xLmlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAgICBzdW0ocXR0eSkgYXMgcXR0eQogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHRlbXBfcQogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy5pZCA9IHRlbXBfcS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgICAgIEdST1VQIEJZIHRlbXBfcS5iYXJjb2RlJycnCgogICAgICAgIHJldHVybiBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChzZWxmLmRvY19pZCwpLCBUcnVlKQoKICAgIGRlZiBnZXRfZGF0YV9mb3JfdGlja2V0X3ByaW50aW5nKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJydXSVRIIHRlbXBfcSBhcyAoU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNfZmxvdy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kIGFzIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAxIGFzIHF0dHkKCiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfYmFyY29kZXMuYmFyY29kZSA9IFJTX2JhcmNfZmxvdy5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2JhcmNfZmxvdy5pZF9kb2M9PyBBTkQgUlNfYmFyY19mbG93LmJhcmNvZGUgPSA/KQoKICAgICAgICAgICAgICAgICAgICAgICAgU0VMRUNUIHRlbXBfcS5iYXJjb2RlLCB0ZW1wX3EuaWRfZ29vZCwgdGVtcF9xLmlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgUHJvcF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBzdW0ocXR0eSkgYXMgcXR0eQogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHRlbXBfcQogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy5pZCA9IHRlbXBfcS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IHRlbXBfcS5pZF9wcm9wZXJ0eSAgICAKICAgICAgICAgICAgICAgICAgICAgIEdST1VQIEJZIHRlbXBfcS5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAnJycKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoc2VsZi5kb2NfaWQsIGJhcmNvZGUpLCBUcnVlKQoKICAgIGRlZiBhZGRfYmFyY29kZV90b19kYXRhYmFzZShzZWxmLCBiYXJjb2RlOiBzdHIpOgogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBxdGV4dCA9ICcnJ0lOU0VSVCBJTlRPIFJTX2JhcmNfZmxvdyAoaWRfZG9jLCBiYXJjb2RlKSBWQUxVRVMgKD8sPyknJycKICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHF0ZXh0LCAnLCcuam9pbihbc2VsZi5kb2NfaWQsIGJhcmNvZGVdKSkKICAgICAgICBzZWxmLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmRvY19pZCkKCiAgICBkZWYgc2V0X2JhcmNfZmxvd19zdGF0dXMoc2VsZik6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kb2NzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZSh7J2lzX2JhcmNfZmxvdyc6ICcxJ30sIHsnaWRfZG9jJzogc2VsZi5kb2NfaWR9KQoKCmNsYXNzIEdvb2RzU2VydmljZShEYlNlcnZpY2UpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZW1faWQ9JycpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuaXRlbV9pZCA9IGl0ZW1faWQKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPSJSU19nb29kcyIsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQoKICAgIGRlZiBnZXRfdHlwZV9uYW1lX2J5X2lkKHNlbGYsIGlkKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiJTRUxFQ1QgbmFtZSBGUk9NIFJTX3R5cGVzX2dvb2RzIFdIRVJFIGlkID0ne2lkfSciCiAgICAgICAgcmV0dXJuIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKCiAgICBkZWYgZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxmLCBnb29kc190eXBlPScnLCBpdGVtX2lkPScnKSAtPiBsaXN0OgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgUlNfZ29vZHMuaWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuY29kZSwgJ+KAlCcpIEFTIGNvZGUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lLAogICAgICAgICAgICAgICAgUlNfZ29vZHMuYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsJ+KAlCcpIEFTIHVuaXQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdHlwZXNfZ29vZHMubmFtZSwgJ+KAlCcpIEFTIHR5cGVfZ29vZCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5kZXNjcmlwdGlvbiwn4oCUJykgQVMgZGVzY3JpcHRpb24KICAgICAgICAgICAgRlJPTSBSU19nb29kcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdHlwZXNfZ29vZHMKICAgICAgICAgICAgICAgIE9OIFJTX3R5cGVzX2dvb2RzLmlkID0gUlNfZ29vZHMudHlwZV9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSBSU19nb29kcy51bml0CiAgICAgICAgICAgICIiIgogICAgICAgIHdoZXJlID0gJycgaWYgbm90IGdvb2RzX3R5cGUgZWxzZSAnV0hFUkUgUlNfZ29vZHMudHlwZV9nb29kPT8nCiAgICAgICAgaWYgd2hlcmUgPT0gJycgYW5kIGl0ZW1faWQ6CiAgICAgICAgICAgIHdoZXJlICs9ICdXSEVSRSBSU19nb29kcy5pZD0/JwoKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgICAgICAgICBPUkRFUiBCWSBSU19nb29kcy5pZAogICAgICAgICAgICAgICAgJycnCgogICAgICAgIGlmIGdvb2RzX3R5cGU6CiAgICAgICAgICAgIGFyZ3MgPSBnb29kc190eXBlCiAgICAgICAgZWxpZiBpdGVtX2lkOgogICAgICAgICAgICBhcmdzID0gaXRlbV9pZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3MgPSBOb25lCgogICAgICAgIHJlc3VsdCA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2l0ZW1fZGF0YV9ieV9pZChzZWxmLCBpdGVtX2lkKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmlkLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmNvZGUsICfigJQnKSBBUyBjb2RlLAogICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCfigJQnKSBBUyB1bml0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3R5cGVzX2dvb2RzLm5hbWUsICfigJQnKSBBUyB0eXBlX2dvb2QsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuZGVzY3JpcHRpb24sJ+KAlCcpIEFTIGRlc2NyaXB0aW9uCiAgICAgICAgICAgIEZST00gUlNfZ29vZHMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3R5cGVzX2dvb2RzCiAgICAgICAgICAgICAgICBPTiBSU190eXBlc19nb29kcy5pZCA9IFJTX2dvb2RzLnR5cGVfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfZ29vZHMudW5pdAogICAgICAgICAgICBXSEVSRSBSU19nb29kcy5pZCA9ICJ7aXRlbV9pZH0iCiAgICAgICAgICAgIAogICAgICAgICAgICBMSU1JVCAxCiAgICAgICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0KQogICAgICAgIHJldHVybiByZXN1bHRbMF0gaWYgcmVzdWx0IGVsc2Uge30KCiAgICBkZWYgZ2V0X2l0ZW1fZGF0YV9ieV9jb25kaXRpb24oc2VsZiwgaXRlbV9pZCwgcHJvcGVydHlfaWQ9JycsIHVuaXRfaWQ9JycpIC0+IGRpY3Q6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBSU19nb29kcy5pZCBBUyBpZCwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmNvZGUgQVMgY29kZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgQVMgbmFtZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmFydCBhcyBhcnQsCiAgICAgICAgICAgICAgICBSU19nb29kcy5kZXNjcmlwdGlvbiBBUyBkZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCfigJQnKSBBUyB1bml0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3Byb3BlcnRpZXMubmFtZSwn4oCUJykgQVMgcHJvcGVydHkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2dvb2RzCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gInt1bml0X2lkfSIKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPSAie3Byb3BlcnR5X2lkfSIKICAgICAgICAgICAgV0hFUkUgUlNfZ29vZHMuaWQgPSAie2l0ZW1faWR9IgoKICAgICAgICAgICAgTElNSVQgMQogICAgICAgICAgICAiIiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCkKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIHt9CgogICAgZGVmIGdldF9hbGxfZ29vZHNfdHlwZXNfZGF0YShzZWxmKToKICAgICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCBpZCxuYW1lIEZST00gUlNfdHlwZXNfZ29vZHMnCiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gJ1JTX3R5cGVzX2dvb2RzJwogICAgICAgIHJldHVybiBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgJycpCgogICAgZGVmIGdldF92YWx1ZXNfZnJvbV9iYXJjb2RlKHNlbGYsIGlkZW50aWZ5X2ZpZWxkOiBzdHIsIGlkZW50aWZ5X3ZhbHVlOiBzdHIpIC0+IGxpc3Q6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLm5hbWUsICcnKSBBUyBuYW1lLAogICAgICAgICAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsICcnKSBBUyBwcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICBJRk5VTEwoUlNfc2VyaWVzLm5hbWUsICcnKSBBUyBzZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsICcnKSBBUyB1bml0CgogICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMKICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQgPSBSU19iYXJjb2Rlcy5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5CiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfYmFyY29kZXMuaWRfdW5pdAogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfc2VyaWVzLmlkID0gUlNfYmFyY29kZXMuaWRfc2VyaWVzCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgV0hFUkUge2lkZW50aWZ5X2ZpZWxkfSA9ICd7aWRlbnRpZnlfdmFsdWV9JwogICAgICAgICAgICAgICAgICAgICIiIgoKICAgICAgICByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsICcnKQoKICAgIGRlZiBnZXRfdmFsdWVzX2J5X2ZpZWxkKHNlbGYsIHRhYmxlX25hbWUsIGZpZWxkLCBmaWVsZF92YWx1ZSk6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnNlbGVjdCh7ZmllbGQ6IGZpZWxkX3ZhbHVlfSkKCiAgICBkZWYgZ2V0X3F1ZXJ5X3dpdGhfYXJnX2xpc3Qoc2VsZiwgdGFibGVfbmFtZSwgdmFsdWUsIGZpZWxkLCB0YWJsZV9zdHJpbmdfaWQpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiU0VMRUNUIGlmbnVsbCh7dmFsdWV9LCAnLScpIGFzIHt2YWx1ZX0gRlJPTSB7dGFibGVfbmFtZX0gV0hFUkUge2ZpZWxkfSBpbiAoe3RhYmxlX3N0cmluZ19pZH0pIiIiCiAgICAgICAgIyBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgIyByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsIHRhYmxlX25hbWU9dGFibGVfbmFtZSwgcGFyYW1zPScnKQogICAgICAgIHJldHVybiBxdWVyeV90ZXh0CgogICAgZGVmIGdldF9zZWxlY3RfZGF0YShzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBxdWVyeV90ZXh0ID0gZidTRUxFQ1QgKiBGUk9NIHt0YWJsZV9uYW1lfScKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCAnJykKCgpjbGFzcyBEYkNyZWF0b3IoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKCiAgICBkZWYgY3JlYXRlX3RhYmxlcyhzZWxmKToKICAgICAgICBpbXBvcnQgZGF0YWJhc2VfaW5pdF9xdWVyeWVzCiAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDRgtCw0LHQu9C40YbRiyDQtdGB0LvQuCDQuNGFINC90LXRggogICAgICAgIHNjaGVtYSA9IGRhdGFiYXNlX2luaXRfcXVlcnllcy5kYXRhYmFzZV9zaGVtYSgpCiAgICAgICAgZm9yIGVsIGluIHNjaGVtYToKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChlbCkKCiAgICBkZWYgZHJvcF9hbGxfdGFibGVzKHNlbGYpOgogICAgICAgIHRhYmxlcyA9IHNlbGYuZ2V0X2FsbF90YWJsZXMoKQoKICAgICAgICBmb3IgdGFibGUgaW4gdGFibGVzOgogICAgICAgICAgICBzZWxmLl9zcWxfcXVlcnkoZidEUk9QIFRBQkxFIHt0YWJsZX0nKQoKICAgIGRlZiBnZXRfYWxsX3RhYmxlcyhzZWxmKToKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIG5hbWUgCiAgICAgICAgICAgIEZST00gCiAgICAgICAgICAgICAgICBzcWxpdGVfbWFzdGVyCiAgICAgICAgICAgIFdIRVJFIAogICAgICAgICAgICAgICAgdHlwZT0ndGFibGUnIEFORCAKICAgICAgICAgICAgICAgIG5hbWUgTk9UIExJS0UgJ3NxbGl0ZV8lJwogICAgICAgICcnJwogICAgICAgIHRhYmxlcyA9IHNlbGYuX3NxbF9xdWVyeShxKQoKICAgICAgICByZXR1cm4gW3RhYmxlWyduYW1lJ10gZm9yIHRhYmxlIGluIHRhYmxlc10KCgpjbGFzcyBVbml2ZXJzYWxDYXJkc1NlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnRhYmxlX25hbWU6IHN0cgogICAgICAgIHNlbGYuZmlsdGVyX2ZpZWxkcyA9IFtdCiAgICAgICAgc2VsZi5maWx0ZXJfdmFsdWUgPSAnJwogICAgICAgIHNlbGYuZXhjbHVkZV9saXN0ID0gW10KICAgICAgICBzZWxmLm5vX2xhYmVsID0gRmFsc2UKICAgICAgICBzZWxmLnRhYmxlX25hbWVzID0gc2VsZi5fdGFibGVfbmFtZXNfZGljdCgpCgogICAgZGVmIGdldF92aWV3c19kYXRhKHNlbGYsIHRhYmxlX25hbWU6IHN0cik6CiAgICAgICAgZmllbGRzID0gc2VsZi5fZ2V0X2ZpZWxkcyh0YWJsZV9uYW1lKQogICAgICAgIGZpZWxkc19saW5rcyA9IHt9CiAgICAgICAgcV9maWVsZHMgPSBbXQogICAgICAgIHFfam9pbnMgPSBbXQogICAgICAgIHFfY29uZGl0aW9ucyA9IFsndHJ1ZSddCgogICAgICAgIGZvciBmaWVsZCBpbiBmaWVsZHM6CiAgICAgICAgICAgIGlmIGZpZWxkIGluIHNlbGYuZXhjbHVkZV9saXN0OgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHFfZmllbGRzLmFwcGVuZCgne30ue30gQVMge30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWUsIGZpZWxkLCAna2V5JyBpZiBmaWVsZCA9PSAnaWQnIGVsc2UgZmllbGQpKQoKICAgICAgICAgICAgbGlua190YWJsZV9uYW1lID0gc2VsZi50YWJsZV9uYW1lcy5nZXQoZmllbGQpCiAgICAgICAgICAgIGlmIGxpbmtfdGFibGVfbmFtZToKICAgICAgICAgICAgICAgIHFfZmllbGRzLmFwcGVuZChmJ3tsaW5rX3RhYmxlX25hbWV9Lm5hbWUgYXMge2xpbmtfdGFibGVfbmFtZX1fbmFtZScpCiAgICAgICAgICAgICAgICBxX2pvaW5zLmFwcGVuZCgnTEVGVCBKT0lOIHt9IE9OIHt9LmlkID0ge30ue30nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBsaW5rX3RhYmxlX25hbWUsIGxpbmtfdGFibGVfbmFtZSwgdGFibGVfbmFtZSwgZmllbGQKICAgICAgICAgICAgICAgICkpCgogICAgICAgICAgICAgICAgZmllbGRzX2xpbmtzW2ZpZWxkXSA9IGYne2xpbmtfdGFibGVfbmFtZX1fbmFtZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZpZWxkc19saW5rc1tmaWVsZF0gPSAna2V5JyBpZiBmaWVsZCA9PSAnaWQnIGVsc2UgZmllbGQKCiAgICAgICAgaWYgc2VsZi5maWx0ZXJfdmFsdWU6CiAgICAgICAgICAgIHFfY29uZGl0aW9ucyA9IFtmInt0YWJsZV9uYW1lfS57ZmllbGR9IExJS0UgJyV7c2VsZi5maWx0ZXJfdmFsdWV9JSciIGZvciBmaWVsZCBpbiBzZWxmLmZpbHRlcl9maWVsZHNdCgogICAgICAgIHEgPSAnJydTRUxFQ1Qge30gCiAgICAgICAgICAgICAgICBGUk9NIHt9CiAgICAgICAgICAgICAgICB7fQogICAgICAgICAgICAgICAgV0hFUkUge30KICAgICAgICAnJycuIGZvcm1hdCgnLCcuam9pbihxX2ZpZWxkcyksIHRhYmxlX25hbWUsICcgJy5qb2luKHFfam9pbnMpLCAnIE9SICcuam9pbihxX2NvbmRpdGlvbnMpKQoKICAgICAgICByZXR1cm4gZmllbGRzX2xpbmtzLCBzZWxmLl9zcWxfcXVlcnkocSkKCiAgICBkZWYgX2dldF9maWVsZHMoc2VsZiwgdGFibGVfbmFtZSkgLT4gTGlzdFtzdHJdOgogICAgICAgICIiIgogICAgICAgIDpwYXJhbSB0YWJsZV9uYW1lOgogICAgICAgIDpyZXR1cm4gbGlzdCBjb2x1bW4gbmFtZXM6CiAgICAgICAgIiIiCiAgICAgICAgcSA9IGYnUFJBR01BIHRhYmxlX2luZm8oe3RhYmxlX25hbWV9KScKICAgICAgICByZXMgPSBzZWxmLl9zcWxfcXVlcnkocSwgdGFibGVfbmFtZT10YWJsZV9uYW1lKQoKICAgICAgICByZXR1cm4gW3Jvd1snbmFtZSddIGZvciByb3cgaW4gcmVzXQoKICAgIGRlZiBfdGFibGVfbmFtZXNfZGljdChzZWxmKToKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnaWRfZ29vZCc6ICdSU19nb29kcycsCiAgICAgICAgICAgICd0eXBlX2dvb2QnOiAnUlNfdHlwZXNfZ29vZHMnLAogICAgICAgICAgICAndW5pdCc6ICdSU191bml0cycsCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6ICdSU19wcm9wZXJ0aWVzJywKICAgICAgICAgICAgJ2lkX3Nlcmllcyc6ICdSU19zZXJpZXMnLAogICAgICAgICAgICAnaWRfdW5pdCc6ICdSU191bml0cycsCiAgICAgICAgICAgICdpZF9jb3VudHJhZ2VudHMnOiAnUlNfY291bnRyYWdlbnRzJywKICAgICAgICAgICAgJ2lkX3dhcmVob3VzZSc6ICdSU193YXJlaG91c2VzJywKICAgICAgICAgICAgJ2lkX2RvYyc6ICdSU19kb2NzJywKICAgICAgICAgICAgJ2lkX2NlbGwnOiAnUlNfY2VsbHMnLAogICAgICAgICAgICAnaWRfb3duZXInOiAnUlNfZ29vZHMnLAogICAgICAgICAgICAnaWRfcHJpY2VfdHlwZXMnOiAnUlNfcHJpY2VfdHlwZXMnCiAgICAgICAgfQoKY2xhc3MgU3FsUXVlcnlQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lPScnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSwgZGVidWc9RmFsc2UpOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICAjIHNlbGYuc3FsID0gc3FsX2NsYXNzCiAgICAgICAgc2VsZi5zcWwgPSBzZWxmCiAgICAgICAgc2VsZi5zcWxfdGV4dCA9ICcnCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gTm9uZQogICAgICAgIHNlbGYuZGVidWcgPSBkZWJ1ZwoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHRhYmxlX25hbWUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdGFibGVfbmFtZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RhYmxlX25hbWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYne3NlbGZ9OiB0YWJsZV9uYW1lIG11c3QgYmUgc3BlY2lmaWVkJykKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYnU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPXtzZWxmLl90YWJsZV9uYW1lfSknCgogICAgQHRhYmxlX25hbWUuc2V0dGVyCiAgICBkZWYgdGFibGVfbmFtZShzZWxmLCB2KToKICAgICAgICBzZWxmLl90YWJsZV9uYW1lID0gdgoKICAgIGRlZiBjcmVhdGUoc2VsZiwgZGF0YSk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKGRhdGEpCgogICAgICAgIHJldHVybiBzZWxmLl9leGVjX2NyZWF0ZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXQogICAgICAgICkKCiAgICBkZWYgcmVwbGFjZShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfcmVwbGFjZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXQogICAgICAgICkKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGRhdGEsIF9maWx0ZXI9Tm9uZSk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB3aGVyZSA9IE5vbmUKICAgICAgICBmaWx0ZXJfZGF0YSA9IFtdCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gbGlzdChfZmlsdGVyLnZhbHVlcygpKQoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKGRhdGEsIGZpbHRlcl9kYXRhPWZpbHRlcl9kYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY191cGRhdGUoCiAgICAgICAgICAgIGNvbHVtbnM9cXVlcnlfZGF0YVsnY29sdW1ucyddLAogICAgICAgICAgICBwYXJhbXM9cXVlcnlfZGF0YVsncGFyYW1zJ10sCiAgICAgICAgICAgIHdoZXJlPXdoZXJlCiAgICAgICAgKQoKICAgIGRlZiBkZWxldGUoc2VsZiwgX2ZpbHRlcj1Ob25lKToKICAgICAgICB3aGVyZSA9IE5vbmUKICAgICAgICBmaWx0ZXJfZGF0YSA9IFtdCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gbGlzdChfZmlsdGVyLnZhbHVlcygpKQoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKHt9LCBmaWx0ZXJfZGF0YT1maWx0ZXJfZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfZGVsZXRlKAogICAgICAgICAgICBwYXJhbXM9cXVlcnlfZGF0YVsncGFyYW1zJ10sCiAgICAgICAgICAgIHdoZXJlPXdoZXJlCiAgICAgICAgKQoKICAgIGRlZiBzZWxlY3Qoc2VsZiwgX2ZpbHRlcj1Ob25lKSAtPiBsaXN0OgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIHBhcmFtcyA9ICcnCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIHBhcmFtcyA9IFtzdHIodikgZm9yIHYgaW4gX2ZpbHRlci52YWx1ZXMoKV0KCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfc2VsZWN0KAogICAgICAgICAgICBwYXJhbXM9cGFyYW1zLAogICAgICAgICAgICB3aGVyZT13aGVyZSwKICAgICAgICApCgogICAgZGVmIF9leGVjX2NyZWF0ZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMpOgogICAgICAgIHN0cl92YWx1ZXMgPSAnLCcuam9pbignPycgKiBsZW4oY29sdW1ucykpCiAgICAgICAgc3RyX2tleXMgPSAnLCAnLmpvaW4oW2Yne25hbWV9JyBmb3IgbmFtZSBpbiBjb2x1bW5zXSkKCiAgICAgICAgcSA9IGYnSU5TRVJUIElOVE8ge3NlbGYudGFibGVfbmFtZX0gKHtzdHJfa2V5c30pIFZBTFVFUyAoe3N0cl92YWx1ZXN9KScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfcmVwbGFjZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMpOgogICAgICAgIHN0cl9jb2x1bW5zID0gJywgJy5qb2luKGNvbHVtbnMpCiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsJy5qb2luKCc/JyAqIGxlbihjb2x1bW5zKSkKCiAgICAgICAgcSA9IGYnUkVQTEFDRSBJTlRPIHtzZWxmLnRhYmxlX25hbWV9ICh7c3RyX2NvbHVtbnN9KSBWQUxVRVMgKHtzdHJfdmFsdWVzfSknCgogICAgICAgIHBhcmFtcyA9IGpzb24uZHVtcHMocGFyYW1zLCBlbnN1cmVfYXNjaWk9RmFsc2UpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX2V4ZWNfbWFueShxLCBwYXJhbXMpCgogICAgZGVmIF9leGVjX3VwZGF0ZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMsIHdoZXJlPU5vbmUpOgogICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAnIGFuZCAnLmpvaW4oW2Yne2tleX09PycgZm9yIGtleSBpbiB3aGVyZV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJ3RydWUnCgogICAgICAgIHN0cl92YWx1ZXMgPSAnLCAnLmpvaW4oW2Yne25hbWV9PT8nIGZvciBuYW1lIGluIGNvbHVtbnNdKQoKICAgICAgICBxID0gZidVUERBVEUge3NlbGYudGFibGVfbmFtZX0gU0VUIHtzdHJfdmFsdWVzfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfZGVsZXRlKHNlbGYsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgcSA9IGYnREVMRVRFIEZST00ge3NlbGYudGFibGVfbmFtZX0gV0hFUkUge3N0cl93aGVyZX0nCgogICAgICAgIHBhcmFtcyA9IGpzb24uZHVtcHMocGFyYW1zLCBlbnN1cmVfYXNjaWk9RmFsc2UpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX2V4ZWNfbWFueShxLCBwYXJhbXMpCgogICAgZGVmIF9leGVjX3NlbGVjdChzZWxmLCBwYXJhbXMsIHdoZXJlPU5vbmUpOgogICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAnIGFuZCAnLmpvaW4oW2Yne2tleX09PycgZm9yIGtleSBpbiB3aGVyZV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJ3RydWUnCgogICAgICAgIHEgPSBmJ1NFTEVDVCAqIEZST00ge3NlbGYudGFibGVfbmFtZX0gV0hFUkUge3N0cl93aGVyZX0nCgogICAgICAgIHBhcmFtcyA9ICcsICcuam9pbihwYXJhbXMpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCiAgICBkZWYgc3FsX2V4ZWNfbWFueShzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zcWwuU1FMRXhlY01hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfZXhlYyhzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zcWwuU1FMRXhlYyhxLCBwYXJhbXM9cGFyYW1zKQoKICAgIGRlZiBzcWxfcXVlcnkoc2VsZiwgcSwgcGFyYW1zOiBzdHIgPSAnJykgLT4gTGlzdFtkaWN0XToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gcQogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IHBhcmFtcwoKICAgICAgICBpZiBub3Qgc2VsZi5kZWJ1ZzoKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5zcWwuU1FMUXVlcnkocSwgcGFyYW1zKQogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhyZXN1bHQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSwgZmlsdGVyX2RhdGE9Tm9uZSk6CiAgICAgICAgY29sdW1ucyA9IFtdCiAgICAgICAgcGFyYW1zID0gW10KICAgICAgICBpZiBub3QgZmlsdGVyX2RhdGE6CiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gW10KCiAgICAgICAgaWYgaXNpbnN0YW5jZShkYXRhLCBsaXN0KToKICAgICAgICAgICAgY29sdW1ucyA9IGxpc3QoZGF0YVswXSkKICAgICAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZChbdiBmb3IgdiBpbiByb3cudmFsdWVzKCldICsgZmlsdGVyX2RhdGEpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKGRhdGEsIGRpY3QpOgogICAgICAgICAgICBjb2x1bW5zID0gbGlzdChkYXRhKQogICAgICAgICAgICBwYXJhbXMgPSBbW3YgZm9yIHYgaW4gZGF0YS52YWx1ZXMoKV0gKyBmaWx0ZXJfZGF0YV0KICAgICAgICBlbHNlOgogICAgICAgICAgICBWYWx1ZUVycm9yKGYnZGF0YSBtdXN0IGJlIGxpc3Qgb3IgZGljdCwgbm90IHt0eXBlKGRhdGEpfScpCgogICAgICAgIHJldHVybiB7J2NvbHVtbnMnOiBjb2x1bW5zLCAncGFyYW1zJzogcGFyYW1zfQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjb252ZXJ0X3NxbF9wYXJhbXMoc3FsX3F1ZXJ5LCBwYXJhbXNfZGljdCk6CiAgICAgICAgaW1wb3J0IHJlCiAgICAgICAgcGFyYW1fdmFsdWVzID0gW10KCiAgICAgICAgZGVmIHJlcGxhY2VfbmFtZWRfcGFyYW0obWF0Y2gpOgogICAgICAgICAgICBwYXJhbV9uYW1lID0gbWF0Y2guZ3JvdXAoMSkKCiAgICAgICAgICAgIHBhcmFtX3ZhbHVlcy5hcHBlbmQocGFyYW1zX2RpY3RbcGFyYW1fbmFtZV0pCgogICAgICAgICAgICByZXR1cm4gIj8iCgogICAgICAgIG5ld19xdWVyeSA9IHJlLnN1YihyJzooXHcrKScsIHJlcGxhY2VfbmFtZWRfcGFyYW0sIHNxbF9xdWVyeSkKCiAgICAgICAgcmV0dXJuIG5ld19xdWVyeSwgcGFyYW1fdmFsdWVzCgogICAgIyDQvNC10YLQvtC00Ysg0L3QuNC20LUg0LTQvtCx0LDQstC70LXQvdGLINC00LvRjyDQstGA0LXQvNC10L3QvdC+0LPQviDRgNC10YjQtdC90LjRjyDQv9GA0L7QsdC70LXQvNGLIFNRTFByb3ZpZGVyINC90LAgOSDQsNC90LTRgNC+0LjQtNC1CiAgICBkZWYgU1FMRXhlYyhzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIHBhcmFtczoKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCB0dXBsZShwYXJhbXMuc3BsaXQoJywnKSkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKGdldF9xdWVyeV9yZXN1bHQocSkpCgogICAgZGVmIFNRTEV4ZWNNYW55KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgcmV0dXJuIGJ1bGtfcXVlcnkocSwganNvbi5sb2FkcyhwYXJhbXMpKQoKICAgIGRlZiBTUUxRdWVyeShzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIHBhcmFtczoKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCB0dXBsZShwYXJhbXMuc3BsaXQoJywnKSksIHJldHVybl9kaWN0PVRydWUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKGdldF9xdWVyeV9yZXN1bHQocSwgcmV0dXJuX2RpY3Q9VHJ1ZSkpCg=="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\hs_services.py",
                "PyFileKey": "hs_services",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBDYWxsYWJsZSwgVW5pb24KZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdGlueV9kYl9zZXJ2aWNlcyBpbXBvcnQgTG9nZ2VyU2VydmljZQoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmZyb20gcmVxdWVzdHMuYXV0aCBpbXBvcnQgSFRUUEJhc2ljQXV0aAoKCmNsYXNzIEhzU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBodHRwX3BhcmFtcyk6CiAgICAgICAgc2VsZi51cmwgPSBodHRwX3BhcmFtc1sndXJsJ10KICAgICAgICBzZWxmLnVzZXJuYW1lID0gaHR0cF9wYXJhbXNbJ3VzZXInXQogICAgICAgIHNlbGYucGFzc3dvcmQgPSBodHRwX3BhcmFtc1sncGFzcyddCiAgICAgICAgc2VsZi5hbmRyb2lkX2lkID0gaHR0cF9wYXJhbXNbJ2FuZHJvaWRfaWQnXQogICAgICAgIHNlbGYuZGV2aWNlX21vZGVsID0gaHR0cF9wYXJhbXNbJ2RldmljZV9tb2RlbCddCiAgICAgICAgc2VsZi51c2VyX25hbWUgPSBodHRwX3BhcmFtc1sndXNlcl9uYW1lJ10KICAgICAgICBzZWxmLnBhcmFtcyA9IHsndXNlcl9uYW1lJzogc2VsZi51c2VyX25hbWUsICdkZXZpY2VfbW9kZWwnOiBzZWxmLmRldmljZV9tb2RlbH0KICAgICAgICBzZWxmLl9ocyA9ICcnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5hdXRoID0gSFRUUEJhc2ljQXV0aChzZWxmLnVzZXJuYW1lLCBzZWxmLnBhc3N3b3JkKQogICAgICAgIHNlbGYuaGVhZGVycyA9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9CiAgICAgICAgc2VsZi5odHRwX2Fuc3dlcjogT3B0aW9uYWxbSHNTZXJ2aWNlLkh0dHBBbnN3ZXJdID0gTm9uZQogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2UgPSBMb2dnZXJTZXJ2aWNlKCkKCiAgICBkZWYgZ2V0X3RlbXBsYXRlcyhzZWxmLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5faHMgPSAnbGFiZWxfdGVtcGxhdGVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbi5sb2FkcyhhbnN3ZXJbJ3RleHQnXSkKICAgICAgICAgICAgI3JldHVybiBqc29uX2RhdGEKICAgICAgICBlbGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgIHByaW50KGFuc3dlcikKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXJbJ3JlYXNvbiddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXIuZ2V0KCd0ZXh0JykKCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfZGF0YShzZWxmLCAqKmt3YXJncykgLT4gZGljdDoKICAgICAgICBzZWxmLl9ocyA9ICdkYXRhJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgIGZvcm1hdF9kYXRhID0ganNvbl9kYXRhLmdldCgnZm9ybWF0JykKCiAgICAgICAgICAgIGlmIGZvcm1hdF9kYXRhOgogICAgICAgICAgICAgICAgYW5zd2VyWydmb3JtYXQnXSA9IGZvcm1hdF9kYXRhCiAgICAgICAgICAgICAgICBpZiAnaXNfb2snID09IGZvcm1hdF9kYXRhIGFuZCBqc29uX2RhdGEuZ2V0KCdiYXRjaCcpOgogICAgICAgICAgICAgICAgICAgICMg0J3QsNGIINC30LDQv9GA0L7RgSDQv9GA0LjQvdGP0YIsINC90L4g0LLQtdGA0L3Rg9GC0Ywg0L/QvtC60LAg0L3QtdGH0LXQs9C+LiDQlNCw0L3QvdGL0LUg0LjQu9C4INCz0L7RgtC+0LLRj9GC0YHRjyDQuNC70Lgg0LjRhSDQvdC10YIKICAgICAgICAgICAgICAgICAgICBhbnN3ZXJbJ2JhdGNoJ10gPSBqc29uX2RhdGEuZ2V0KCdiYXRjaCcpCgogICAgICAgICAgICAgICAgZWxpZiBmb3JtYXRfZGF0YSA9PSAnaXNfZGF0YSc6CiAgICAgICAgICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGFbJ2RhdGEnXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydmb3JtYXQnXSA9IE5vbmUKICAgICAgICBlbGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgIHByaW50KGFuc3dlcikKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXJbJ3JlYXNvbiddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXIuZ2V0KCd0ZXh0JykKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jOiBzdHIsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5wYXJhbXNbJ2lkX2RvYyddID0gaWRfZG9jCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBkYXRhLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgc2VuZF9hbGxfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBkYXRhLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXNfcmV3cml0ZScKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CiAgICAgICAgc2VsZi5wYXJhbXNbJ2lkX2RvYyddID0gaWRfZG9jCgogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQoKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiByZXNldF9leGNoYW5nZShzZWxmLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5faHMgPSAncmVzZXRfZXhjaGFuZ2UnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBjcmVhdGVfbWVzc2FnZXMoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBjb21tdW5pY2F0aW9uX3Rlc3Qoc2VsZiwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgc2VsZi5faHMgPSAnY29tbXVuaWNhdGlvbl90ZXN0JwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfYmFsYW5jZXNfZ29vZHMoc2VsZiwgaWRfd2FyZWhvdXNlPUZhbHNlLCBpZF9jZWxsPUZhbHNlLCBpZF9nb29kPUZhbHNlLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgcGFyYW1zID0ge30KICAgICAgICBpZiBpZF9nb29kOgogICAgICAgICAgICBwYXJhbXNbJ2lkX2dvb2QnXSA9IGlkX2dvb2QKICAgICAgICBpZiBpZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9ocyA9ICdnb29kX2JhbGFuY2VzL2NlbGxzJwogICAgICAgICAgICBwYXJhbXNbJ2lkX2NlbGwnXSA9IGlkX2NlbGwKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9ocyA9ICdnb29kX2JhbGFuY2VzL3dhcmVob3VzZXMnCiAgICAgICAgICAgIGlmIGlkX3dhcmVob3VzZToKICAgICAgICAgICAgICAgIHBhcmFtc1snaWRfd2FyZWhvdXNlJ10gPSBpZF93YXJlaG91c2UKICAgICAgICBzZWxmLnBhcmFtcyA9IHBhcmFtcwogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBnZXRfcHJpY2VzX2dvb2RzKHNlbGYsIGlkX2dvb2QsIGlkX3Byb3BlcnR5PUZhbHNlLCBpZF91bml0PUZhbHNlLCBpZF9wcmljZV90eXBlPUZhbHNlLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9wcmljZXMnCiAgICAgICAgcGFyYW1zID0geydpZF9nb29kJzogaWRfZ29vZH0KICAgICAgICBpZiBpZF9wcm9wZXJ0eToKICAgICAgICAgICAgcGFyYW1zWydpZF9wcm9wZXJ0eSddID0gaWRfcHJvcGVydHkKICAgICAgICBpZiBpZF91bml0OgogICAgICAgICAgICBwYXJhbXNbJ2lkX3VuaXQnXSA9IGlkX3VuaXQKICAgICAgICBpZiBpZF9wcmljZV90eXBlOgogICAgICAgICAgICBwYXJhbXNbJ2lkX3ByaWNlX3R5cGUnXSA9IGlkX3ByaWNlX3R5cGUKCiAgICAgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgc2VuZF9kb2N1bWVudHMoc2VsZiwgZGF0YSwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdkb2N1bWVudHMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgc2VuZF9kYXRhKHNlbGYsIGRhdGEsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdkb2N1bWVudHMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfYmFyY29kZXMoc2VsZiwgZGF0YTogbGlzdCwgKiprd2FyZ3MpIC0+ICdIdHRwQW5zd2VyJzoKICAgICAgICAiIiIKICAgICAgICA6cGFyYW0gZGF0YTogZGljdCAoJ2JhcmNvZGUnLCAnaWRfZ29vZCcsICdpZF9wcm9wZXJ0eScsICdpZF91bml0JykKICAgICAgICA6cGFyYW0ga3dhcmdzOiByZXF1ZXN0cyBwb3N0IHBhcmFtcwogICAgICAgIDpyZXR1cm46IEh0dHBBbnN3ZXIKICAgICAgICAiIiIKICAgICAgICBrd2FyZ3NbJ2RhdGEnXSA9IGRhdGEgaWYgaXNpbnN0YW5jZShkYXRhLCBzdHIpIGVsc2UganNvbi5kdW1wcyhkYXRhKQogICAgICAgIHNlbGYuX2hzID0gJ2JhcmNvZGVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBfc2VuZF9yZXF1ZXN0KHNlbGYsIGt3YXJncykgLT4gZGljdDoKICAgICAgICBhbnN3ZXIgPSB7J2VtcHR5JzogVHJ1ZX0KICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSBzZWxmLl9tZXRob2QoZid7c2VsZi51cmx9L3NpbXBsZV9hY2NvdW50aW5nL3tzZWxmLl9oc30/YW5kcm9pZF9pZD17c2VsZi5hbmRyb2lkX2lkfScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aD1zZWxmLmF1dGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1zZWxmLmhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zPXNlbGYucGFyYW1zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBhbnN3ZXJbJ3VybCddID0gci51cmwKICAgICAgICAgICAgYW5zd2VyWydyZWFzb24nXSA9IHIucmVhc29uCiAgICAgICAgICAgIGFuc3dlclsndGV4dCddID0gci50ZXh0LmVuY29kZSgidXRmLTgiKQoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zd2VyWydqc29uJ10gPSByLmpzb24oKQogICAgICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ2pzb24nXSA9IHt9CgogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ0Vycm9yJ10gPSByLnJlYXNvbgogICAgICAgICAgICAgICAgYW5zd2VyWydyZWFzb24nXSA9IHIucmVhc29uCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgICAgICMgYW5zd2VyWydFcnJvciddID0gZS5hcmdzWzBdCgogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgX2NyZWF0ZV9odHRwX2Fuc3dlcihzZWxmLCBhbnN3ZXI6IGRpY3QpOgogICAgICAgIGFuc3dlcl9kYXRhID0gewogICAgICAgICAgICAnc3RhdHVzX2NvZGUnOiBhbnN3ZXIuZ2V0KCdzdGF0dXNfY29kZScpLAogICAgICAgICAgICAndXJsJzogYW5zd2VyLmdldCgndXJsJyksCiAgICAgICAgICAgICdqc29uJzogYW5zd2VyLmdldCgnanNvbicpCiAgICAgICAgfQoKICAgICAgICBpZiBhbnN3ZXJfZGF0YVsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGFuc3dlcl9kYXRhWydkYXRhJ10gPSBhbnN3ZXIuZ2V0KCdkYXRhJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBhbnN3ZXJfZGF0YVsnZXJyb3InXSA9IFRydWUKICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yX3RleHQnXSA9IGFuc3dlci5nZXQoJ0Vycm9yJykgb3IgYW5zd2VyLmdldCgnZXJyb3InKQogICAgICAgICAgICBpZiBhbnN3ZXJfZGF0YVsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgICAgICBhbnN3ZXJfZGF0YVsndW5hdXRob3JpemVkJ10gPSBUcnVlCiAgICAgICAgICAgIGVsaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gNDAzOgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2ZvcmJpZGRlbiddID0gVHJ1ZQoKICAgICAgICAgICAgaWYgYW5zd2VyLmdldCgndGV4dCcpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGpzb25fcmVzdWx0ID0ganNvbi5sb2FkcyhhbnN3ZXJbJ3RleHQnXSkKICAgICAgICAgICAgICAgICAgICBlcnJvcl90ZXh0ID0ganNvbl9yZXN1bHQuZ2V0KCdlcnJvcicpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dCA9IGFuc3dlclsndGV4dCddLmRlY29kZSgpCgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yX3RleHQnXSA9IGVycm9yX3RleHQKCiAgICAgICAgcmV0dXJuIHNlbGYuSHR0cEFuc3dlcigqKmFuc3dlcl9kYXRhKQoKICAgIGRlZiBnZXRfbWV0aG9kX2J5X3BhdGgoc2VsZiwgcGF0aCkgLT4gVW5pb25bQ2FsbGFibGUsIE5vbmVdOgogICAgICAgIG1ldGhvZHMgPSB7CiAgICAgICAgICAgICdiYXJjb2Rlcyc6IHNlbGYuc2VuZF9iYXJjb2RlcywKICAgICAgICAgICAgJ2RvY3VtZW50cyc6IHNlbGYuc2VuZF9kb2N1bWVudHMKICAgICAgICB9CgogICAgICAgIHJldHVybiBtZXRob2RzLmdldChwYXRoKQoKICAgIGRlZiB3cml0ZV9lcnJvcl90b19sb2coc2VsZiwgZXJyb3JfdGV4dCwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2Uud3JpdGVfdG9fbG9nKGVycm9yX3RleHQ9ZXJyb3JfdGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl90eXBlPSJIU19zZXJ2aWNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJncykKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBIdHRwQW5zd2VyOgogICAgICAgIHVybDogc3RyCiAgICAgICAgc3RhdHVzX2NvZGU6IGludAogICAgICAgIGpzb246IE9wdGlvbmFsID0gTm9uZQogICAgICAgIGVycm9yX3RleHQ6IE9wdGlvbmFsW3N0cl0gPSAnJwogICAgICAgIGRhdGE6IE9wdGlvbmFsID0gTm9uZQogICAgICAgIHVuYXV0aG9yaXplZDogYm9vbCA9IEZhbHNlCiAgICAgICAgZm9yYmlkZGVuOiBib29sID0gRmFsc2UKICAgICAgICBlcnJvcjogYm9vbCA9IEZhbHNlCgoKY2xhc3MgRGVidWdTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlwX2hvc3QsIHBvcnQ9MjQ0NCk6CiAgICAgICAgc2VsZi5pcF9ob3N0ID0gaXBfaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAgICBzZWxmLnVybCA9IGYnaHR0cDovL3tzZWxmLmlwX2hvc3R9OntzZWxmLnBvcnR9JwogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgZGVmIGV4cG9ydF9kYXRhYmFzZShzZWxmLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHsnU2ltcGxlS2VlcC5kYic6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2ZpbGUoc2VsZiwgZmlsZV9uYW1lLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHtmaWxlX25hbWU6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2xvZyhzZWxmLCBkYXRhKToKICAgICAgICBzZWxmLl9ocyA9ICd1bmxvYWRfbG9nJwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3Qoeydqc29uJzoganNvbi5kdW1wcyhkYXRhKX0pCgogICAgZGVmIF9zZW5kX3JlcXVlc3Qoc2VsZiwga3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGFuc3dlciA9IHsnZW1wdHknOiBUcnVlfQogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHNlbGYuX21ldGhvZChmJ3tzZWxmLnVybH0ve3NlbGYuX2hzfScsICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci50ZXh0CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCgogICAgICAgIHJldHVybiBhbnN3ZXIK"
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\ui_global.py",
                "PyFileKey": "ui_global",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKaW1wb3J0IHNxbGl0ZTMKZnJvbSBzcWxpdGUzIGltcG9ydCBFcnJvcgppbXBvcnQgb3MKaW1wb3J0IHF1ZXVlCgoKCnF1ZXJ5X2xpc3QgPSBxdWV1ZS5RdWV1ZSgpCiMg0JLQvtGCINGC0LDQutC40Lwg0L3QtdC30LDRgtC10LnQu9C40LLRi9C8INC80LXRgtC+0LTQvtC8INC+0L/RgNC10LTQtdC70Y/QtdC8LCDQvNGLINC30LDQv9GD0YHRgtC40LvQuNGB0Ywg0L3QsCDQutC+0LzQv9C1INC40LvQuCDQvdCwINCi0KHQlCAqKgojINCd0YMg0Lgg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCLCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQsdCw0LfRgyAqKioqCmlmIG9zLnBhdGguZXhpc3RzKCcvL2RhdGEvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS9kYXRhYmFzZXMvJyk6ICPQu9C+0LrQsNC70YzQvdC+CiAgICBkYl9wYXRoID0gJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy9TaW1wbGVLZWVwJyAgIyByaWdodHNjYW4nCmVsc2U6CiAgICBkYl9wYXRoID0gZmlsZV9hYnNfcGF0aCA9IG9zLnBhdGguYWJzcGF0aCgnLi9TaW1wbGVLZWVwLmRiJykgICMgRDpcUHl0aG9uUHJvamVjdHNcUmlnaHRTY2FuXFNVSV9ub1BvbnlcCgpjb25uID0gTm9uZQoKCgpkZWYgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0OiBzdHIsIGFyZ3MgPSAiIiwgcmV0dXJuX2RpY3Q9RmFsc2UpIC0+IGxpc3Q6CiAgICAjICoqKioqKioqKioqKioqKioqKioqKioKCiAgICAjIGdsb2JhbCBjb25uCiAgICAjIGdldF9kYXRhYmFzZV9jb25uZWN0aW9uKCkKICAgIHRyeToKICAgICAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KGRiX3BhdGgpCgogICAgZXhjZXB0IEVycm9yOgoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBpZiBhcmdzOgogICAgICAgICAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5X3RleHQpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgZQoKICAgICMg0JXRgdC70Lgg0L3QsNC00L4gLSDQstC+0LfQstGA0LDRidCw0LXQvCDQvdC1INGA0LXQt9GD0LvRjNGC0LDRgiDQt9Cw0L/RgNC+0YHQsCwg0LAg0YHQu9C+0LLQsNGA0Ywg0YEg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNC90L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtC+0LwKICAgIGlmIHJldHVybl9kaWN0OgogICAgICAgIHJlcyA9IFtkaWN0KGxpbmUpIGZvciBsaW5lIGluCiAgICAgICAgICAgICAgIFt6aXAoW2NvbHVtblswXSBmb3IgY29sdW1uIGluIGN1cnNvci5kZXNjcmlwdGlvbl0sIHJvdykgZm9yIHJvdyBpbiBjdXJzb3IuZmV0Y2hhbGwoKV1dCiAgICBlbHNlOgogICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjb25uLmNvbW1pdCgpCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCmRlZiBidWxrX3F1ZXJ5KHE6IHN0ciwgYXJnczogTGlzdFt0dXBsZV0pOgogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ05vIGNvbm5lY3Rpb24gd2l0aCBkYXRhYmFzZScpCgogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQoKICAgIHRyeToKICAgICAgICBjdXJzb3IuZXhlY3V0ZW1hbnkocSwgYXJncykKICAgICAgICBjb25uLmNvbW1pdCgpCiAgICBleGNlcHQgc3FsaXRlMy5FcnJvciBhcyBlcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGVyKQoKICAgIGNvbm4uY2xvc2UoKQoKCgoKCg=="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\ui_models.py",
                "PyFileKey": "ui_models",
                "PyFileData": "aW1wb3J0IHJlCmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kCmltcG9ydCBqc29uCmZyb20ganNvbi5kZWNvZGVyIGltcG9ydCBKU09ORGVjb2RlRXJyb3IKaW1wb3J0IG9zCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgVHVwbGUsIENhbGxhYmxlCmltcG9ydCBzaHV0aWwKaW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCBoc19zZXJ2aWNlcwpmcm9tIHByaW50aW5nX2ZhY3RvcnkgaW1wb3J0IEhUTUxEb2N1bWVudCwgUHJpbnRTZXJ2aWNlLCBidApmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwLCBnZXRfaXBfYWRkcmVzcwpmcm9tIGJhcmNvZGVfd29ya2VycyBpbXBvcnQgQmFyY29kZVdvcmtlcgpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBEb2NTZXJ2aWNlLCBHb29kc1NlcnZpY2UsIEJhcmNvZGVTZXJ2aWNlLCBUaW1lclNlcnZpY2UKZnJvbSB0aW55X2RiX3NlcnZpY2VzIGltcG9ydCBTY2FubmluZ1F1ZXVlU2VydmljZSwgRXhjaGFuZ2VRdWV1ZUJ1ZmZlciwgTG9nZ2VyU2VydmljZSwgRGF0ZUZvcm1hdCwgTm9TUUxQcm92aWRlcgpmcm9tIGhzX3NlcnZpY2VzIGltcG9ydCBIc1NlcnZpY2UKaW1wb3J0IHN0YXRpY19kYXRhCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmltcG9ydCB3aWRnZXRzCmltcG9ydCB1aV9nbG9iYWwKaW1wb3J0IGJhc2U2NApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpjdXJyZW50X3NjcmVlbjogJ1NjcmVlbicgPSBOb25lCm5leHRfc2NyZWVuOiAnU2NyZWVuJyA9IE5vbmUKX3JzX3NldHRpbmdzID0gbm9DbGFzcygicnNfc2V0dGluZ3MiKQoKY2xhc3MgU2NyZWVuKEFCQyk6CiAgICBzY3JlZW5fbmFtZTogc3RyCiAgICBwcm9jZXNzX25hbWU6IHN0cgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9X3JzX3NldHRpbmdzKToKICAgICAgICBzZWxmLmhhc2hfbWFwOiBIYXNoTWFwID0gaGFzaF9tYXAKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MgPSByc19zZXR0aW5ncwogICAgICAgIHNlbGYuZXZlbnQ6IHN0ciA9IHNlbGYuaGFzaF9tYXBbJ2V2ZW50J10KICAgICAgICBzZWxmLmlzX2ZpbmlzaF9wcm9jZXNzID0gRmFsc2UKICAgICAgICBzZWxmLnBhcmVudF9zY3JlZW4gPSBOb25lCiAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVyczogTGlzdFtDYWxsYWJsZV09W10KICAgICAgICBzZWxmLmluaXRfcGFyYW1zID0ge30KCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLnJlbW92ZShmJ3tzZWxmLl9fY2xhc3NfXy5fX25hbWVfX31faW5pdCcpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGFyZ3MpCiAgICAgICAgc2VsZi5faW5pdF9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUpCgogICAgZGVmIHNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGFyZ3MpCiAgICAgICAgc2VsZi5faW5pdF9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZi5wcm9jZXNzX25hbWUsIHNlbGYuc2NyZWVuX25hbWUpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYne3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffV9pbml0JykKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiByZWZyZXNoX3NjcmVlbihzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGxpc3RlbmVyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmxpc3RlbmVyCgogICAgQGxpc3RlbmVyLnNldHRlcgogICAgZGVmIGxpc3RlbmVyKHNlbGYsIHYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2NsZWFyX3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIGtleSBpbiBzZWxmLnNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgdG9hc3Qoc2VsZiwgdGV4dCk6CiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCh0ZXh0KQoKICAgIGRlZiBfaXNfcmVzdWx0X3Bvc2l0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdFBvc2l0aXZlJwoKICAgIGRlZiBfaXNfcmVzdWx0X25lZ2F0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdE5lZ2F0aXZlJwoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmJ3tzZWxmLnByb2Nlc3NfbmFtZX0gLyB7c2VsZi5zY3JlZW5fbmFtZX0nCgogICAgZGVmIF92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmJ1Byb2Nlc3M6IHtzZWxmLnByb2Nlc3NfbmFtZX0sIHNjcmVlbjoge3NlbGYuc2NyZWVuX25hbWV9LicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidGb3Iga2V5IHtrZXl9IG11c3QgYmUgc2V0IHZhbHVlIG5vdCBOb25lJykKCiAgICBkZWYgZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCiAgICBkZWYgcHV0X25vdGlmaWNhdGlvbihzZWxmLCB0ZXh0LCB0aXRsZT1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbih0ZXh0LCB0aXRsZSkKCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfbGlzdGVuZXJfbm90X2ltcGxlbWVudGVkKHNlbGYpOgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IgKGYnbGlzdGVuZXIge3NlbGYubGlzdGVuZXJ9IG5vdCBpbXBsZW1lbnRlZCcpCgogICAgZGVmIF9pc19pbml0X2hhbmRsZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoZid7c2VsZi5fX2NsYXNzX18uX19uYW1lX199X2luaXQnKQoKICAgIGRlZiBfaW5pdF9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrIGluIHNlbGYuc2NyZWVuX3ZhbHVlczoKICAgICAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzW2tdID0gc2VsZi5oYXNoX21hcFtrXQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5pc19maW5pc2hfcHJvY2VzcyA9IFRydWUKICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxmLmlzX2ZpbmlzaF9wcm9jZXNzID0gVHJ1ZQogICAgICAgIGlmIHNlbGYucGFyZW50X3NjcmVlbjoKICAgICAgICAgICAgc2VsZi5wYXJlbnRfc2NyZWVuLmhhc2hfbWFwID0gc2VsZi5oYXNoX21hcAogICAgICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZi5wYXJlbnRfc2NyZWVuKQogICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3NfcmVzdWx0KCkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYucGFyZW50X3NjcmVlbjoKICAgICAgICAgICAgc2VsZi5wYXJlbnRfc2NyZWVuLmhhc2hfbWFwID0gc2VsZi5oYXNoX21hcAogICAgICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZi5wYXJlbnRfc2NyZWVuKQogICAgICAgIHNlbGYuaGFzaF9tYXAuYmFja19zY3JlZW4oKQoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YShzZWxmLCByZW1vdmU9VHJ1ZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICBpZiByZW1vdmU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdzZWxlY3RlZF9jYXJkX2RhdGEnKQoKICAgICAgICByZXR1cm4gc2VsZWN0ZWRfY2FyZF9kYXRhCgogICAgZGVmIF9ydW5fb25fc3RhcnRfaGFuZGxlcnMoc2VsZik6CiAgICAgICAgZm9yIGhhbmRsZXIgaW4gc2VsZi5vbl9zdGFydF9oYW5kbGVyczoKICAgICAgICAgICAgaGFuZGxlcigpCiAgICAgICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnMucmVtb3ZlKGhhbmRsZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9mb3JtYXRfcXVhbnRpdHkocXR0eSk6CiAgICAgICAgaWYgZmxvYXQocXR0eSkgJSAxID09IDA6CiAgICAgICAgICAgIHJldHVybiBpbnQoZmxvYXQocXR0eSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHJvdW5kKHF0dHksIDMpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9mb3JtYXRfZGF0ZShkYXRlX3N0cjogc3RyKToKICAgICAgICByZXR1cm4gZGF0ZXRpbWUuZnJvbWlzb2Zvcm1hdChkYXRlX3N0cikuc3RyZnRpbWUoJyVtLSVkLSVZICVIOiVNOiVTJykKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUsIHJzX3NldHRpbmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgICAgIHNlbGYuVGV4dFNpemUgPSByc19zZXR0aW5ncy5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKQogICAgICAgICAgICBzZWxmLlRleHRDb2xvciA9ICcjMzMzMzMzJwogICAgICAgICAgICBzZWxmLkJhY2tncm91bmRDb2xvciA9ICdGRkNDOTknCiAgICAgICAgICAgIHNlbGYud2VpZ2h0ID0gMAogICAgICAgICAgICBzZWxmLlZhbHVlID0gdmFsdWUKCiAgICBjbGFzcyBMaW5lYXJMYXlvdXQod2lkZ2V0cy5MaW5lYXJMYXlvdXQpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICdob3Jpem9udGFsJwogICAgICAgICAgICBzZWxmLmhlaWdodCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLlN0cm9rZVdpZHRoID0gMQoKIyA9PT09PT09PT09PT09PT09PT09PSBQcmludGluZyBzY3JlZW5zID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgSHRtbFZpZXcoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cg0LXQt9GD0LvRjNGC0LDRgicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBsYWJsZV9mdWxsX3BhdGggPSBzZWxmLnByaW50X25jbC5nZXQoJ2xhYmxlX2Z1bGxfcGF0aCcpCiAgICAgICAgYmFyY29kZV93aWR0aCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3dpZHRoJykKICAgICAgICBiYXJjb2RlX3dpZHRoID0gc3RyKGludChmbG9hdChiYXJjb2RlX3dpZHRoKSkpIGlmIGJhcmNvZGVfd2lkdGggZWxzZSAnMjAnCiAgICAgICAgYmFyY29kZV9oZWlnaHQgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9oZWlnaHQnKQogICAgICAgIGJhcmNvZGVfaGVpZ2h0ID0gc3RyKGludChmbG9hdChiYXJjb2RlX2hlaWdodCkpKSBpZiBiYXJjb2RlX2hlaWdodCBlbHNlICcyMCcKICAgICAgICBiYXJjb2RlX2xlZnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9sZWZ0JykKICAgICAgICBiYXJjb2RlX2xlZnQgPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfbGVmdCkpKSBpZiBiYXJjb2RlX2xlZnQgZWxzZSAnMCcKICAgICAgICBiYXJjb2RlX3JpZ2h0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfcmlnaHQnKQogICAgICAgIGJhcmNvZGVfcmlnaHQgPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfcmlnaHQpKSkgaWYgYmFyY29kZV9yaWdodCBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfdXAgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV91cCcpCiAgICAgICAgYmFyY29kZV91cCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV91cCkpKSBpZiBiYXJjb2RlX3VwIGVsc2UgJzAnCiAgICAgICAgYmFyY29kZV9kb3duID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfZG93bicpCiAgICAgICAgYmFyY29kZV9kb3duID0gc3RyKGludChmbG9hdChiYXJjb2RlX2Rvd24pKSkgaWYgYmFyY29kZV9kb3duIGVsc2UgJzAnCiAgICAgICAgYmFyY29kZV90eXBlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdHlwZV9jbGljaycpIG9yICdlYW4xMycKCiAgICAgICAgYmFyY29kZV90eXBlcyA9IFsnZWFuMTMnLCAnY29kZTM5JywgJ2NvZGUxMjgnLCAncXItY29kZSddCgogICAgICAgIHRlbXBsYXRlX2RpciwgdGVtcGxhdGVfZmlsZSA9IG9zLnBhdGguc3BsaXQobGFibGVfZnVsbF9wYXRoKQogICAgICAgIGh0bWxfZG9jX3BhcmFtcyA9IEhUTUxEb2N1bWVudC5maW5kX3RlbXBsYXRlX3ZhcmlhYmxlcyh0ZW1wbGF0ZV9kaXIsIHRlbXBsYXRlX2ZpbGUpCiAgICAgICAgZG9jX2RldGFpbHMgPSBzZWxmLmdldF9kZXRhaWxzX2RhdGEoaHRtbF9kb2NfcGFyYW1zKQoKICAgICAgICBkYXRhX2Zvcl9wcmludGluZyA9IHtlbGVtWydrZXknXTogZWxlbVsndmFsdWUnXSBmb3IgZWxlbSBpbiBkb2NfZGV0YWlsc30KICAgICAgICBkYXRhX2Zvcl9wcmludGluZy51cGRhdGUoYmFyY29kZT0nMTIzMTIzMTIzMTIzJykKICAgICAgICBsaXN0X2Zvcl9jaG9vc2UgPSAnOycuam9pbihkYXRhX2Zvcl9wcmludGluZy5rZXlzKCkpCgogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEoZG9jX2RldGFpbHMpCiAgICAgICAgdGFibGVfdmlldyA9IHNlbGYuX2dldF9kb2NfdGFibGVfdmlldyh0YWJsZV9kYXRhPXRhYmxlX2RhdGEpCgogICAgICAgIGh0bWwgPSBIVE1MRG9jdW1lbnQodGVtcGxhdGVfZGlyLCB0ZW1wbGF0ZV9maWxlKS5jcmVhdGVfaHRtbCgKICAgICAgICAgICAgZGF0YV9mb3JfcHJpbnRpbmcsIGJhcmNvZGVfdHlwZT1iYXJjb2RlX3R5cGUpCgogICAgICAgIGh0bWwgPSBIVE1MRG9jdW1lbnQuaW5qZWN0X2Nzc19zdHlsZSgKICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgd2lkdGg9YmFyY29kZV93aWR0aCwKICAgICAgICAgICAgaGVpZ2h0PWJhcmNvZGVfaGVpZ2h0LAogICAgICAgICAgICB4PXN0cihpbnQoYmFyY29kZV9yaWdodCkgLSBpbnQoYmFyY29kZV9sZWZ0KSksCiAgICAgICAgICAgIHk9c3RyKGludChiYXJjb2RlX2Rvd24pIC0gaW50KGJhcmNvZGVfdXApKSwKICAgICAgICApCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfd2lkdGgnLCBiYXJjb2RlX3dpZHRoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX2hlaWdodCcsIGJhcmNvZGVfaGVpZ2h0KQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX2xlZnQnLCBiYXJjb2RlX2xlZnQpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfcmlnaHQnLCBiYXJjb2RlX3JpZ2h0KQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3VwJywgYmFyY29kZV91cCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9kb3duJywgYmFyY29kZV9kb3duKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3R5cGVzJywgJzsnLmpvaW4oYmFyY29kZV90eXBlcykpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2h0bWwnLCBodG1sKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkYXRhX2Zvcl9wcmludGluZ19rZXlzJywgbGlzdF9mb3JfY2hvb3NlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdtYXRjaGluZ190YWJsZScsIHRhYmxlX3ZpZXcudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIGdldF9kZXRhaWxzX2RhdGEoc2VsZiwgaHRtbF9kb2NfcGFyYW1zOiBzZXQpIC0+IExpc3RbRGljdF06CiAgICAgICAgbWF0Y2hpbmdfdGFibGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnbWF0Y2hpbmdfdGFibGUnKQogICAgICAgIGlmIG5vdCBtYXRjaGluZ190YWJsZToKICAgICAgICAgICAgcmV0dXJuIFt7J2tleSc6IGVsZW0sICd2YWx1ZSc6IGVsZW19IGZvciBlbGVtIGluIGh0bWxfZG9jX3BhcmFtc10KICAgICAgICBtYXRjaGluZ190YWJsZSA9IGpzb24ubG9hZHMobWF0Y2hpbmdfdGFibGUpCiAgICAgICAgbWF0Y2hpbmdfdGFibGVfZGF0YSA9IG1hdGNoaW5nX3RhYmxlWydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXQogICAgICAgIHJlc3VsdCA9IFtdCiAgICAgICAgZm9yIGVsZW0gaW4gaHRtbF9kb2NfcGFyYW1zOgogICAgICAgICAgICB2YWx1ZSA9IGVsZW0KICAgICAgICAgICAgZm9yIGRhdGEgaW4gbWF0Y2hpbmdfdGFibGVfZGF0YToKICAgICAgICAgICAgICAgIGlmIGRhdGEuZ2V0KCdrZXknKSA9PSBlbGVtOgogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0YVsndmFsdWUnXQogICAgICAgICAgICByZXN1bHQuYXBwZW5kKHsna2V5JzogZWxlbSwgJ3ZhbHVlJzogdmFsdWV9KQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgaWYgc2VsZi5wcmludF9uY2wuZ2V0KCdmcm9tX2ZpbGVfYnJvd3NlcicpOgogICAgICAgICAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdmcm9tX2ZpbGVfYnJvd3NlcicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9zYXZlJzoKICAgICAgICAgICAgbWF0Y2hpbmdfdGFibGUgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCJtYXRjaGluZ190YWJsZSIpKQogICAgICAgICAgICBjdXJyZW50X3RhYmxlID0gbWF0Y2hpbmdfdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ3RhYmxlZGF0YSddCiAgICAgICAgICAgIGN1cnJlbnRfdGFibGUucG9wKDApCiAgICAgICAgICAgIGZvciBlbCBpbiBjdXJyZW50X3RhYmxlOgogICAgICAgICAgICAgICAgaWYgZWwuZ2V0KCdrZXknKToKICAgICAgICAgICAgICAgICAgICBlbC5wb3AoJ19sYXlvdXQnKQoKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3dpZHRoJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfd2lkdGgnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfaGVpZ2h0Jywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfaGVpZ2h0JyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX2xlZnQnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9sZWZ0JyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3JpZ2h0Jywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfcmlnaHQnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfdXAnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV91cCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9kb3duJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfZG93bicpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnbWF0Y2hpbmdfdGFibGUnLCBqc29uLmR1bXBzKGN1cnJlbnRfdGFibGUpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfdHlwZScsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3R5cGVfY2xpY2snKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfbmFtZScsIHNlbGYucHJpbnRfbmNsLmdldCgnbGFibGVfZmlsZV9uYW1lJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJywgc2VsZi5wcmludF9uY2wuZ2V0KCdsYWJsZV9mdWxsX3BhdGgnKSwgVHJ1ZSkKICAgICAgICAgICAgaHRtbCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdodG1sJykKCiAgICAgICAgICAgIG9sZF9wcmV2aWV3X3RtcCA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKICAgICAgICAgICAgaWYgb2xkX3ByZXZpZXdfdG1wIGFuZCBvcy5wYXRoLmV4aXN0cyhvbGRfcHJldmlld190bXApOgogICAgICAgICAgICAgICAgb3MucmVtb3ZlKG9sZF9wcmV2aWV3X3RtcCkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQoKICAgICAgICAgICAgb2xkX3ByZXZpZXcgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQogICAgICAgICAgICBpZiBvbGRfcHJldmlldyBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXcpOgogICAgICAgICAgICAgICAgb3MucmVtb3ZlKG9sZF9wcmV2aWV3KQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUHJpbnRQcmV2aWV3JywgaHRtbCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1ByaW50VG9CaXRtYXAnKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ1ByaW50Qml0bWFwJzoKICAgICAgICAgICAgcGF0aF90b19wbmcgPSBzZWxmLmhhc2hfbWFwLmdldCgnUHJpbnRCaXRtYXBQYXRoJykKICAgICAgICAgICAgIyDQn9C10YDQtdC90L7RgSDRiNCw0LHQu9C+0L3QvtCyINCyINC+0YLQtNC10LvRjNC90YPRjiDQv9Cw0L/QutGDLgogICAgICAgICAgICBkaXJlY3RvcnksIG5hbWUgPSBvcy5wYXRoLnNwbGl0KHBhdGhfdG9fcG5nKQogICAgICAgICAgICBuZXdfcGF0aCA9IG9zLnBhdGguam9pbihkaXJlY3RvcnksICdzYXZlZF9sYWJlbF90ZW1wbGF0ZXMnLCBuYW1lKQogICAgICAgICAgICBvcy5tYWtlZGlycyhvcy5wYXRoLmpvaW4oZGlyZWN0b3J5LCAnc2F2ZWRfbGFiZWxfdGVtcGxhdGVzJyksIGV4aXN0X29rPVRydWUpCiAgICAgICAgICAgIHNodXRpbC5jb3B5KHBhdGhfdG9fcG5nLCBuZXdfcGF0aCkKICAgICAgICAgICAgb3MucmVtb3ZlKHBhdGhfdG9fcG5nKQoKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJywgbmV3X3BhdGgsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRgdC+0YXRgNCw0L3RkdC9JykKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdmcm9tX2ZpbGVfYnJvd3NlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2RhdGEnKSkKICAgICAgICAgICAgaWYgbm90IGNhcmRfZGF0YToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbGlzdF9maWVsZCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdkYXRhX2Zvcl9wcmludGluZ19rZXlzJykpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ9Cd0LDRgdGC0YDQvtC50LrQsNCh0L7QvtGC0LLQtdGC0YHRgtCy0LjRj9CU0LjQsNC70L7QsycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9Y2FyZF9kYXRhWydrZXknXSwgYnV0dG9ucz1bJ9CU0LAnLCAn0J3QtdGCJ10pCgogICAgICAgIGVsaWYgc2VsZi5oYXNoX21hcC5nZXQoImV2ZW50IikgPT0gJ29uUmVzdWx0UG9zaXRpdmUnOgogICAgICAgICAgICBjYXJkX3Bvc2l0aW9uID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJykpCiAgICAgICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgibWF0Y2hpbmdfdGFibGUiKSkKICAgICAgICAgICAgY3VycmVudF9lbGVtID0gbWF0Y2hpbmdfdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ3RhYmxlZGF0YSddW2NhcmRfcG9zaXRpb25dCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbVsndmFsdWUnXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RfZmllbGQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgibWF0Y2hpbmdfdGFibGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uLmR1bXBzKG1hdGNoaW5nX3RhYmxlLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1dGY4JykuZGVjb2RlKCkpCiAgICAgICAgICAgIHNlbGYub25fc3RhcnQoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgZGV0YWlsczogTGlzdFtkaWN0XSk6CiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICBmb3IgcmVjb3JkIGluIGRldGFpbHM6CiAgICAgICAgICAgIHJlY29yZC51cGRhdGUoX2xheW91dD1zZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkpCiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRkZGRiIgaWYgcmVjb3JkWyd2YWx1ZSddIGVsc2UgJyNGQkU5RTcnCiAgICAgICAgICAgIHJlY29yZFsnX2xheW91dCddLkJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRfY29sb3IKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocmVjb3JkKQogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0JrQu9GO0YcnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9CX0L3QsNGH0LXQvdC40LUnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoc2VsZik6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGtleScsIHNlbGYucnNfc2V0dGluZ3MpLAoKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHZhbHVlJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCgpjbGFzcyBUZW1wbGF0ZXNMaXN0KFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQodC/0LjRgdC+0Log0YjQsNCx0LvQvtC90L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLmdldF9hbGxfZmlsZXNfZnJvbV9wYXRjaCgpCiAgICAgICAgaWYgbm90IGxpc3RfZGF0YToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LIg0L/Rg9GB0YInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZG9jX2NhcmRzID0gc2VsZi5fZ2V0X2RvY19jYXJkc192aWV3KGxpc3RfZGF0YSkKICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3RlbXBsYXRlc19jYXJkcycsIGRvY19jYXJkcy50b19qc29uKCksIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RlbXBsYXRlc19jYXJkcycsIGRvY19jYXJkcy50b19qc29uKCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnbWF0Y2hpbmdfdGFibGUnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgY2FyZF9kYXRhID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJykpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnbGFibGVfZmlsZV9uYW1lJywgY2FyZF9kYXRhLmdldCgnZmlsZV9uYW1lJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnbGFibGVfZnVsbF9wYXRoJywgY2FyZF9kYXRhLmdldCgnZnVsbF9wYXRoJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cg0LXQt9GD0LvRjNGC0LDRgicpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZmlsZV9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJob3Jpem9udGFsIgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZmlsZV9zaXplJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BjcmVhdGlvbl90aW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIGdldF9hbGxfZmlsZXNfZnJvbV9wYXRjaChzZWxmKToKICAgICAgICB0ZW1wbGF0ZXNfZGlyID0gc2VsZi5wcmludF9uY2wuZ2V0KCdsYWJlbF90ZW1wbGF0ZXNfZGlyJykKICAgICAgICBmb2xkZXJfcGF0aCA9IHRlbXBsYXRlc19kaXIgb3Igb3MucGF0aC5qb2luKHN1Q2xhc3MuZ2V0X3RlbXBfZGlyKCksICdsYWJlbHMnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnbGFiZWxfdGVtcGxhdGVzX2RpcicsIGZvbGRlcl9wYXRoLCBUcnVlKQogICAgICAgIGh0bWxfZmlsZXNfaW5mbyA9IFtdCgogICAgICAgIGZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGZvbGRlcl9wYXRoKToKICAgICAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgICAgICBpZiBmaWxlLmxvd2VyKCkuZW5kc3dpdGgoJy5odG0nKTogICMgYW5kIG1hc2sgaW4gZmlsZToKICAgICAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSkKICAgICAgICAgICAgICAgICAgICBmaWxlX3NpemVfYnl0ZXMgPSBvcy5wYXRoLmdldHNpemUoZmlsZV9wYXRoKQogICAgICAgICAgICAgICAgICAgIGZpbGVfc2l6ZV9rYiA9IGZpbGVfc2l6ZV9ieXRlcyAvIDEwMjQgICMgQ29udmVydCBieXRlcyB0byBraWxvYnl0ZXMKICAgICAgICAgICAgICAgICAgICBjcmVhdGlvbl90aW1lID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChvcy5wYXRoLmdldGN0aW1lKGZpbGVfcGF0aCkpCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkX2NyZWF0aW9uX3RpbWUgPSBjcmVhdGlvbl90aW1lLnN0cmZ0aW1lKAogICAgICAgICAgICAgICAgICAgICAgICAnJVktJW0tJWQgJUg6JU06JVMnKSAgIyBGb3JtYXQgZGF0ZXRpbWUgZm9yIHVzZXIgZXllcyApKQoKICAgICAgICAgICAgICAgICAgICBmaWxlX2luZm8gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICdmdWxsX3BhdGgnOiBmaWxlX3BhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICdmaWxlX25hbWUnOiBmaWxlLAogICAgICAgICAgICAgICAgICAgICAgICAnZmlsZV9zaXplJzogZid7ZmlsZV9zaXplX2tiOi4yZn0gS0InLAogICAgICAgICAgICAgICAgICAgICAgICAjIEZvcm1hdCBmaWxlIHNpemUgd2l0aCAyIGRlY2ltYWwgcGxhY2VzCiAgICAgICAgICAgICAgICAgICAgICAgICdjcmVhdGlvbl90aW1lJzogZm9ybWF0dGVkX2NyZWF0aW9uX3RpbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbF9maWxlc19pbmZvLmFwcGVuZChmaWxlX2luZm8pCiAgICAgICAgcmV0dXJuIGh0bWxfZmlsZXNfaW5mbwoKCmNsYXNzIFByaW50U2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygncHJpbnRfbmNsJykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcHJpbnRfdGhyb3VnaCA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJpbnRfdGhyb3VnaCcpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NoZWNrX2JveF9ibHVldG9vdGhfcHJpbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgIHN0cihwcmludF90aHJvdWdoID09ICdCVCcpLmxvd2VyKCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NoZWNrX2JveF93aWZpX3ByaW50Jywgc3RyKHByaW50X3Rocm91Z2ggPT0gJ1dpRmknKS5sb3dlcigpKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX2JsdWV0b290aF9wcmludGVyX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl93aWZpX3ByaW50ZXJfc2V0dGluZ3MnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IFdpRmknKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9sYWJlbF90ZW1wbGF0ZXNfc2V0dGluZ3MnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdjaGVja19ib3hfYmx1ZXRvb3RoX3ByaW50JzoKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdwcmludF90aHJvdWdoJywgJ0JUJywgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J/QtdGH0LDRgtGMINGH0LXRgNC10LcgQmx1ZXRvb3RoJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdjaGVja19ib3hfd2lmaV9wcmludCc6CiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJpbnRfdGhyb3VnaCcsICdXaUZpJywgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J/QtdGH0LDRgtGMINGH0LXRgNC10LcgV2lGaScpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKCmNsYXNzIFByaW50Qmx1ZXRvb3RoU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggQmx1ZXRvb3RoJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmJ0X25jbCA9IG5vQ2xhc3MoImJ0X3NldHRpbmdzIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcHJpbnRlciA9IHNlbGYuYnRfbmNsLmdldCgiZGVmYXVsdF9wcmludGVyIikgb3IgJ9Cd0LUg0LLRi9Cx0YDQsNC9JwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkZWZhdWx0X3ByaW50ZXInLCBwcmludGVyKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX3Nob3dfY29ubmVjdGVkJzoKICAgICAgICAgICAgZGV2aWNlcyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJCVFJlc3VsdCIpCiAgICAgICAgICAgIGRldmljZXMgPSBqc29uLmxvYWRzKGRldmljZXMpIGlmIGRldmljZXMgZWxzZSBbXQogICAgICAgICAgICBqY2FyZHMgPSB7ImNhcmRzIjogW119CgogICAgICAgICAgICBmb3IgZGV2aWNlIGluIGRldmljZXM6CiAgICAgICAgICAgICAgICBjYXJkID0geyJrZXkiOiBkZXZpY2UuZ2V0KCJhZGRyZXNzIiksCiAgICAgICAgICAgICAgICAgICAgICAgICJpdGVtcyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAia2V5IjogItCj0YHRgtGA0L7QudGB0YLQstC+IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBkZXZpY2UuZ2V0KCJuYW1lIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6ICIjMWIzMWMyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9zaXplIjogIjEyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9jb2xvciI6ICIjMWIzMWMyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAia2V5IjogIk1BQyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZGV2aWNlLmdldCgiYWRkcmVzcyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAiIzEzMWU2MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fc2l6ZSI6ICIxMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fY29sb3IiOiAiIzFiMzFjMiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ICJzdGF0ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZGV2aWNlLmdldCgic3RhdGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogIiMxMzFlNjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX3NpemUiOiAiMTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX2NvbG9yIjogIiMxYjMxYzIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF19CgogICAgICAgICAgICAgICAgamNhcmRzWyJjYXJkcyJdLmFwcGVuZChjYXJkKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImNhcmRzIiwganNvbi5kdW1wcyhqY2FyZHMpKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc3RvcF9zY2FuJzoKICAgICAgICAgICAgaWYgc2VsZi5idF9uY2wuZ2V0KCdzY2FubmluZycpOgogICAgICAgICAgICAgICAgc2VsZi5idF9uY2wucHV0KCdzY2FubmluZycsIEZhbHNlLCBUcnVlKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JUU3RvcFNjYW4nLCAnJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ch0LrQsNC90LjRgNC+0LLQsNC90LjQtSDQvtGB0YLQsNC90L7QstC70LXQvdC+JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2J0X2Rpc2Nvbm5lY3QnOgogICAgICAgICAgICBpZiBzZWxmLmJ0X25jbC5nZXQoJ2RlZmF1bHRfcHJpbnRlcicpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGJ0LmNsb3NlX3NvY2tldCgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ2RlZmF1bHRfcHJpbnRlcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5idF9uY2wuZGVsZXRlKCdkZWZhdWx0X3ByaW50ZXInKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkZWZhdWx0X3ByaW50ZXInLCAn0J3QtSDQstGL0LHRgNCw0L0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cf0YDQuNC90YLQtdGAINC+0YLQutC70Y7Rh9C10L0nKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdGL0YUg0L/RgNC40L3RgtC10YDQvtCyJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdGL0YUg0L/RgNC40L3RgtC10YDQvtCyJykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3N0YXJ0X3NjYW4nOgogICAgICAgICAgICBidF9kaXNjb3Zlcl9oYW5kbGVycyA9IFt7CiAgICAgICAgICAgICAgICAiYWN0aW9uIjogInJ1biIsICJ0eXBlIjogInNldCIsCiAgICAgICAgICAgICAgICAibWV0aG9kIjogImJlZXA7dG9hc3Q9QEJURGlzY292ZXJSZXN1bHQiLAogICAgICAgICAgICAgICAgInBvc3RFeGVjdXRlIjogIiIKICAgICAgICAgICAgfV0KICAgICAgICAgICAgc2VsZi5idF9uY2wucHV0KCdzY2FubmluZycsIFRydWUsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJCVFN0YXJ0U2NhbiIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiQlREaXNjb3ZlckhhbmRsZXJzIiwganNvbi5kdW1wcyhidF9kaXNjb3Zlcl9oYW5kbGVycykpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQodC60LDQvdC40YDQvtCy0LDQvdC40LUnKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgYnRfaGFuZGxlcnMgPSBbCiAgICAgICAgICAgICAgICB7ImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJweXRob24iLCAibWV0aG9kIjogImJsdWV0b290aF9lcnJvciJ9CiAgICAgICAgICAgIF0KCiAgICAgICAgICAgIG1hYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgICAgIGRldmljZSA9IGJ0LmdldF9kZXZpY2UobWFjKQogICAgICAgICAgICBpZiBkZXZpY2UgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoItCd0LUg0L/QvtC70YPRh9C40LvQvtGB0Ywg0L/QvtC00LrQu9GO0YfQuNGC0YzRgdGPINC6INGD0YHRgtGA0L7QudGB0YLQstGDIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfRgtC10YHRgicpCiAgICAgICAgICAgIGNvbm5lY3RlZCA9IGJ0LmNvbm5lY3RfdG9fY2xpZW50KGRldmljZSwganNvbi5kdW1wcyhidF9oYW5kbGVycykpCiAgICAgICAgICAgIGlmIG5vdCBjb25uZWN0ZWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCLQo9GB0YLRgNC+0LnRgdGC0LLQviDQvdC1INGP0LLQu9GP0LXRgtGB0Y8g0L/RgNC40L3RgtC10YDQvtC8IikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmJ0X25jbC5wdXQoImRlZmF1bHRfcHJpbnRlciIsIG1hYywgRmFsc2UpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJkZWZhdWx0X3ByaW50ZXIiLCBtYWMpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cj0YHQv9C10YjQvdC+JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Rlc3RfcHJpbnQnOgogICAgICAgICAgICBpZiBzZWxmLmJ0X25jbC5nZXQoJ2RlZmF1bHRfcHJpbnRlcicpOgogICAgICAgICAgICAgICAgenBsID0gJ15YQV5DRkEsMzBeRk8xMCw1MF5GRFRlc3ReRlNeQlkzLDIsMTIwXkZPMTAsMTUwXkJDXkZEMTIzNDU2NzheRlNeWFonCiAgICAgICAgICAgICAgICBzZW50LCByZXN1bHQgPSBQcmludFNlcnZpY2UucHJpbnRfYnQoenBsKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChyZXN1bHQpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3Ri9GFINC/0YDQuNC90YLQtdGA0L7QsicpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCcpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKCmNsYXNzIFByaW50V2lGaVNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IFdpRmknCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgaW1wb3J0IHJlCiAgICAgICAgaXAgPSBzZWxmLnByaW50X25jbC5nZXQoJ2N1cnJlbnRfaXAnKQogICAgICAgIGlmIGlwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnd2lfZmlfaXAnLCBpcCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2luZm9fd2lmaV9jdXJyZW50X2lwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidJUCDQv9C+0LTQutC70Y7Rh9C10L3QvdC+0LPQviDQv9GA0LjQvdGC0LXRgNCwOiB7aXB9JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBpcCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd3aV9maV9pcCcpCiAgICAgICAgICAgIGlmIGlwOgogICAgICAgICAgICAgICAgcGF0dGVybiA9IHInXihcZHsxLDN9XC4pezN9XGR7MSwzfSQnCiAgICAgICAgICAgICAgICBpZiBub3QgcmUubWF0Y2gocGF0dGVybiwgaXApOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCd3aV9maV9pcCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgSVAnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbmZvX3dpZmlfY3VycmVudF9pcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZifQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsCcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidJUCDQv9C+0LTQutC70Y7Rh9C10L3QvdC+0LPQviDQv9GA0LjQvdGC0LXRgNCwOiB7aXB9JykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbmZvX3dpZmlfY3VycmVudF9pcCcsIGYn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90L7Qs9C+INC/0YDQuNC90YLQtdGA0LAnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX3dpZmlfc2F2ZV9pcCc6CiAgICAgICAgICAgIHNlbGYuX3dpZmlfc2F2ZV9pcCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3dpZmlfZGVsZXRlX2lwJzoKICAgICAgICAgICAgc2VsZi5fd2lmaV9kZWxldGVfaXAoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl90ZXN0X3dpX2ZpJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KLQtdGB0YIg0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgc2VsZi5fdGVzdF93aV9maSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3dpX2ZpX3ByaW50X3pwbCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ci0LXRgdGCIHpwbCcpCiAgICAgICAgICAgIHNlbGYuX3ByaW50X3pwbCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCcpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfd2lmaV9zYXZlX2lwKHNlbGYpOgogICAgICAgIGltcG9ydCByZQogICAgICAgIGlwID0gc2VsZi5oYXNoX21hcC5nZXQoJ3dpX2ZpX2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LUg0YPQutCw0LfQsNC9IGlwJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcGF0dGVybiA9IHInXihcZHsxLDN9XC4pezN9XGR7MSwzfSQnCiAgICAgICAgaWYgbm90IHJlLm1hdGNoKHBhdHRlcm4sIGlwKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ3dpX2ZpX2lwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgSVAnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2N1cnJlbnRfaXAnLCBpcCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLmJlZXAoKQogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ0lQINC/0YDQuNC90YLQtdGA0LAg0LfQsNC/0LjRgdCw0L0nKQoKICAgIGRlZiBfd2lmaV9kZWxldGVfaXAoc2VsZik6CiAgICAgICAgaXAgPSBzZWxmLnByaW50X25jbC5nZXQoJ2N1cnJlbnRfaXAnKQogICAgICAgIGlmIG5vdCBpcDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtSDRg9C60LDQt9Cw0L0gaXAnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnd2lfZmlfaXAnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnY3VycmVudF9pcCcpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgnSVAg0L/RgNC40L3RgtC10YDQsCDRg9C00LDQu9GR0L0nKQoKICAgIGRlZiBfcHJpbnRfenBsKHNlbGYpOgogICAgICAgIHpwbCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd3aV9maV96cGxfaW5wdXQnKQogICAgICAgIGlmIG5vdCB6cGw6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiB6cGwg0LrQvtC00LAg0LTQu9GPINC/0LXRh9Cw0YLQuCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnd2lmaV9kYXRhX3RvX3ByaW50JywgenBsLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCiAgICBkZWYgX3Rlc3Rfd2lfZmkoc2VsZik6CiAgICAgICAgenBsID0gJ15YQV5DRkEsMzBeRk8xMCw1MF5GRFRlc3ReRlNeQlkzLDIsMTIwXkZPMTAsMTUwXkJDXkZEMTIzNDU2NzheRlNeWFonCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGwsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3ByaW50X3dpZmknKQoKCmNsYXNzIFByaW50TGFiZWxUZW1wbGF0ZXNTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IEhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHRlbXBsYXRlID0gc2VsZi5wcmludF9uY2wuZ2V0KCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX25hbWUnKSBvciAn0J3QtdGCJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX25hbWUnLCBmJ9Ci0LXQutGD0YnQuNC5INGI0LDQsdC70L7QvToge3RlbXBsYXRlfScpCiAgICAgICAgcGF0aF90b19sYWJlbF9wcmV2aWV3X2ltYWdlID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICBpZiBub3QgcGF0aF90b19sYWJlbF9wcmV2aWV3X2ltYWdlOgogICAgICAgICAgICByZXR1cm4KICAgICAgICB0ZW1wX3ByZXZpZXcgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCiAgICAgICAgcGF0aCA9IHRlbXBfcHJldmlldyBpZiB0ZW1wX3ByZXZpZXcgZWxzZSBwYXRoX3RvX2xhYmVsX3ByZXZpZXdfaW1hZ2UKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScsICd+JyArIHBhdGgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fZ2V0X2xhYmVscyc6CiAgICAgICAgICAgIHNlbGYuX2dldF9sYWJlbHMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZWxlY3RfbGFiZWxfdGVtcGxhdGUnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQodC/0LjRgdC+0Log0YjQsNCx0LvQvtC90L7QsicpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RlbGV0ZV90ZW1wbGF0ZV9zZXR0aW5ncyc6CiAgICAgICAgICAgIHNlbGYuZGVsZXRlX3RlbXBsYXRlX3NldHRpbmdzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fbGFiZWxfdGVtcGxhdGVfc2l6ZV9zZXR0aW5ncyc6CiAgICAgICAgICAgIHBhdGhfdG9fbGFiZWwgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQogICAgICAgICAgICBpZiBub3QgcGF0aF90b19sYWJlbCBvciBub3Qgb3MucGF0aC5pc2ZpbGUocGF0aF90b19sYWJlbCk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQodC90LDRh9Cw0LvQsCDQvdGD0LbQvdC+INCy0YvQsdGA0LDRgtGMINGI0LDQsdC70L7QvScpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiycpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCcpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2xhYmVscyhzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5nZXRfdGVtcGxhdGVzKCkKICAgICAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddICE9IDIwMDoKICAgICAgICAgICAgICAgIHJlYXNvbiA9IGFuc3dlclsnZXJyb3JfcG9vbCddCiAgICAgICAgICAgICAgICByYWlzZSBmJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDRgSDRgdC10YDQstC10YDQvtC8OiB7cmVhc29ufScKCiAgICAgICAgICAgIG91dHB1dF9mb2xkZXIgPSBvcy5wYXRoLmpvaW4oc3VDbGFzcy5nZXRfdGVtcF9kaXIoKSwgJ2xhYmVscycpCgogICAgICAgICAgICBvcy5tYWtlZGlycyhvdXRwdXRfZm9sZGVyLCBleGlzdF9vaz1UcnVlKQoKICAgICAgICAgICAgZGF0YV9saXN0ID0gYW5zd2VyWydkYXRhJ10KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChmJ2RhdGFfbGlzdDp7dHlwZShkYXRhX2xpc3QpfSwge2RhdGFfbGlzdH0nKQoKICAgICAgICAgICAgZm9yIGRhdGFfZGljdCBpbiBkYXRhX2xpc3Q6CiAgICAgICAgICAgICAgICBmaWxlX25hbWUgPSBzZWxmLl9jb3JyZWN0X2ZpbGVuYW1lKGRhdGFfZGljdFsnbmFtZSddKSArICcuaHRtJwogICAgICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKG91dHB1dF9mb2xkZXIsIGZpbGVfbmFtZSkKCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgJ3cnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmaWxlOgogICAgICAgICAgICAgICAgICAgICAgICBmaWxlLndyaXRlKGJhc2U2NC5iNjRkZWNvZGUoZGF0YV9kaWN0WydodG1sJ10pLmRlY29kZSgndXRmLTgnKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KAogICAgICAgICAgICAgICAgICAgICAgICBmJ9Ce0YjQuNCx0LrQsCDRgdC+0YXRgNCw0L3QtdC90LjRjyDRhNCw0LnQu9CwIHtmaWxlX3BhdGh9OiB7c3RyKGUpfScpCiAgICAgICAgICAgICAgICAgICAgcmFpc2UgZifQntGI0LjQsdC60LAg0YHQvtGF0YDQsNC90LXQvdC40Y8g0YTQsNC50LvQsCB7ZmlsZV9wYXRofToge3N0cihlKX0nCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnbGFiZWxfdGVtcGxhdGVzX2RpcicsIG91dHB1dF9mb2xkZXIsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvdGLINC30LDQs9GA0YPQttC10L3RiycpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHN0cihlKSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2NvcnJlY3RfZmlsZW5hbWUoZmlsZW5hbWUpOgogICAgICAgIGlsbGVnYWxfY2hhcnMgPSBbJzwnLCAnPicsICc6JywgJyInLCAiJyIsICcvJywgJ1xcJywgJ3wnLCAnPycsICcqJywgIjwiLCAiPiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAnXHgwMCddCiAgICAgICAgZm9yIGNoYXIgaW4gaWxsZWdhbF9jaGFyczoKICAgICAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZS5yZXBsYWNlKGNoYXIsICcnKQogICAgICAgIHJldHVybiBmaWxlbmFtZQoKICAgIGRlZiBkZWxldGVfdGVtcGxhdGVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3dpZHRoJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfaGVpZ2h0JykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfbGVmdCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3JpZ2h0JykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfdXAnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV9kb3duJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ21hdGNoaW5nX3RhYmxlJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfdHlwZScpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX25hbWUnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJykKCiAgICAgICAgb2xkX3ByZXZpZXdfdG1wID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgIGlmIG9sZF9wcmV2aWV3X3RtcCBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXdfdG1wKToKICAgICAgICAgICAgb3MucmVtb3ZlKG9sZF9wcmV2aWV3X3RtcCkKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCiAgICAgICAgb2xkX3ByZXZpZXcgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQogICAgICAgIGlmIG9sZF9wcmV2aWV3IGFuZCBvcy5wYXRoLmV4aXN0cyhvbGRfcHJldmlldyk6CiAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlldykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQoKCmNsYXNzIFByaW50VGVtcGxhdGVTaXplU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KDQsNC30LzQtdGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgd2lkdGhfdGVtcGxhdGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lkdGhfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIHdpZHRoX3RlbXBsYXRlID0gaW50KGZsb2F0KHdpZHRoX3RlbXBsYXRlKSkgaWYgd2lkdGhfdGVtcGxhdGUgZWxzZSA1MAogICAgICAgIGhlaWdodF90ZW1wbGF0ZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdoZWlnaHRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGhlaWdodF90ZW1wbGF0ZSA9IGludChmbG9hdChoZWlnaHRfdGVtcGxhdGUpKSBpZiBoZWlnaHRfdGVtcGxhdGUgZWxzZSA1MAogICAgICAgIGRwbW0gPSBzZWxmLmhhc2hfbWFwLmdldCgnZHBtbV9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgZHBtbSA9IGludChkcG1tKSBpZiBkcG1tIGVsc2UgOAogICAgICAgIGltYWdlX2hlaWdodCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGltYWdlX2hlaWdodCA9IGludChmbG9hdChpbWFnZV9oZWlnaHQpKSBpZiBpbWFnZV9oZWlnaHQgZWxzZSA1MAogICAgICAgIGltYWdlX3dpZHRoID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlJykKICAgICAgICBpbWFnZV93aWR0aCA9IGludChmbG9hdChpbWFnZV93aWR0aCkpIGlmIGltYWdlX3dpZHRoIGVsc2UgNTAKICAgICAgICBsbCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV9sbF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgbGwgPSBpbnQoZmxvYXQobGwpKSBpZiBsbCBlbHNlIDE1CiAgICAgICAgcHcgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfcHdfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIHB3ID0gaW50KGZsb2F0KHB3KSkgaWYgcHcgZWxzZSAxMDAwCiAgICAgICAgeSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV95X3ByaW50X3RlbXBsYXRlJykKICAgICAgICB5ID0gaW50KGZsb2F0KHkpKSBpZiB5IGVsc2UgMAogICAgICAgIHggPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfeF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgeCA9IGludChmbG9hdCh4KSkgaWYgeCBlbHNlIDAKCiAgICAgICAgcGF0aF90b19pbWcgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQogICAgICAgIHpwbGRhdGEgPSBQcmludFNlcnZpY2UubWFrZV96cGxfZnJvbV9sYWJlbCgKICAgICAgICAgICAgaW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGU9aW1hZ2Vfd2lkdGgsCiAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZT1pbWFnZV9oZWlnaHQsCiAgICAgICAgICAgIGRwbW1fcHJpbnRfdGVtcGxhdGU9ZHBtbSwKICAgICAgICAgICAgaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGU9bGwsCiAgICAgICAgICAgIGltYWdlX3B3X3ByaW50X3RlbXBsYXRlPXB3LAogICAgICAgICAgICBpbWFnZV94X3ByaW50X3RlbXBsYXRlPXgsCiAgICAgICAgICAgIGltYWdlX3lfcHJpbnRfdGVtcGxhdGU9eSwKICAgICAgICAgICAgcGF0aF90b19pbWc9cGF0aF90b19pbWcKICAgICAgICApCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCd6cGxkYXRhJywgenBsZGF0YSwgVHJ1ZSkKICAgICAgICBzdWNjZXNzLCBhbnN3ZXIgPSBQcmludFNlcnZpY2UuenBsX3RvX3BuZ19mcm9tX2FwaSgKICAgICAgICAgICAgenBsZGF0YSwgZHBtbSwgd2lkdGhfdGVtcGxhdGUsIGhlaWdodF90ZW1wbGF0ZSkKICAgICAgICBpZiBub3Qgc3VjY2VzczoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHBhdGgsIGV4dCA9IG9zLnBhdGguc3BsaXRleHQocGF0aF90b19pbWcpCiAgICAgICAgcHJldmlld19wYXRoID0gcGF0aCArICdfcHJldmlldycgKyBleHQKICAgICAgICB3aXRoIG9wZW4ocHJldmlld19wYXRoLCAnd2InKSBhcyBvdXRfZmlsZToKICAgICAgICAgICAgc2h1dGlsLmNvcHlmaWxlb2JqKGFuc3dlciwgb3V0X2ZpbGUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdfcGF0aCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfcHJpbnQnLCAnficgKyBwcmV2aWV3X3BhdGgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3dpZHRoX3ByaW50X3RlbXBsYXRlJywgc3RyKHdpZHRoX3RlbXBsYXRlKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGVpZ2h0X3ByaW50X3RlbXBsYXRlJywgc3RyKGhlaWdodF90ZW1wbGF0ZSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlJywgc3RyKGltYWdlX3dpZHRoKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlJywgc3RyKGltYWdlX2hlaWdodCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RwbW1fcHJpbnRfdGVtcGxhdGUnLCBzdHIoZHBtbSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX2xsX3ByaW50X3RlbXBsYXRlJywgc3RyKGxsKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfcHdfcHJpbnRfdGVtcGxhdGUnLCBzdHIocHcpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV94X3ByaW50X3RlbXBsYXRlJywgc3RyKHgpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV95X3ByaW50X3RlbXBsYXRlJywgc3RyKHkpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdsaXN0ZW5lcicpCgogICAgICAgIGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NhdmVfdGVtcGxhdGVfc2l6ZXMnOgogICAgICAgICAgICB0ZW1wbGF0ZSA9IGRpY3QoCiAgICAgICAgICAgICAgICBpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGRwbW1fcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdkcG1tX3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV94X3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfeF9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3lfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX2xsX3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX3B3X3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfcHdfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3NhdmVkX3ByaW50X3RlbXBsYXRlJywganNvbi5kdW1wcyh0ZW1wbGF0ZSksIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRgdC+0YXRgNCw0L3RkdC9JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RlbGV0ZV9wcmludF90ZW1wbGF0ZSc6CiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L0g0YPQtNCw0LvRkdC9JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NlbnRfdG9fcHJpbnQnOgogICAgICAgICAgICB6cGxkYXRhID0gc2VsZi5wcmludF9uY2wuZ2V0KCd6cGxkYXRhJykKICAgICAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50X3pwbCh6cGxkYXRhLCBzZWxmLmhhc2hfbWFwKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFByaW50aW5nIHNjcmVlbnMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCmNsYXNzIFNpbXBsZUZpbGVCcm93c2VyKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQodC/0LjRgdC+0Log0YTQsNC50LvQvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0YDQvtCy0L7QtNC90LjQuicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRlYnVnX2hvc3RfaXAgPSByc19zZXR0aW5ncy5nZXQoJ2RlYnVnX2hvc3RfaXAnKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkRlYnVnU2VydmljZShpcF9ob3N0PXNlbGYuaGFzaF9tYXAuZ2V0KCdpcF9ob3N0Jykgb3Igc2VsZi5kZWJ1Z19ob3N0X2lwKSAgIyAnMTkyLjE2OC4xLjc3JwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBjdXJyZW50X2RpciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2RpcicpIG9yIHN1Q2xhc3MuZ2V0X3RlbXBfZGlyKCkKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLmdldF9hbGxfZmlsZXNfZnJvbV9wYXRjaChjdXJyZW50X2RpcikKICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcobGlzdF9kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2RpcicsIGN1cnJlbnRfZGlyKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2ZpbGVfYnJvd3Nlcl9jYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGN1cnJlbnRfZGlyZWN0b3J5ID0gUGF0aChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9kaXInKSkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fZ2V0X3VwJzoKICAgICAgICAgICAgaWYgbm90IG9zLmFjY2VzcyhjdXJyZW50X2RpcmVjdG9yeS5wYXJlbnQsIG9zLlJfT0spOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtGB0YLRg9C/INC30LDQv9GA0LXRidGR0L0nKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2N1cnJlbnRfZGlyJ10gPSBjdXJyZW50X2RpcmVjdG9yeS5wYXJlbnQKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgY3VycmVudF9lbGVtID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9kYXRhIikpCiAgICAgICAgICAgIGlmIGN1cnJlbnRfZWxlbVsnZmlsZV90eXBlJ10gPT0gJ0ZvbGRlcic6CiAgICAgICAgICAgICAgICBuZXdfZGlyID0gUGF0aChjdXJyZW50X2RpcmVjdG9yeSwgY3VycmVudF9lbGVtWydmaWxlX25hbWUnXSkKICAgICAgICAgICAgICAgIGlmIG9zLmFjY2VzcyhuZXdfZGlyLCBvcy5SX09LKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2RpciddID0gbmV3X2RpcgoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIHNlbGYuX2xheW91dF9hY3Rpb24oKQoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGE6IExpc3RbRGljdF0pOgogICAgICAgIGZvciByb3cgaW4gdGFibGVfZGF0YToKICAgICAgICAgICAgaWYgcm93WydmaWxlX3R5cGUnXSAhPSAnRmlsZSc6CiAgICAgICAgICAgICAgICByb3dbJ19sYXlvdXQnXSA9IHNlbGYuX2dldF9sYXlvdXQoaXNfZmlsZT1GYWxzZSkKICAgICAgICAgICAgZWxpZiByb3dbJ2V4dGVuc2lvbiddID09ICcuaHRtJzoKICAgICAgICAgICAgICAgIHJvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2xheW91dChpc19odG09VHJ1ZSkKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICBzZWxmLl9nZXRfbGF5b3V0KCksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPXRhYmxlX2RhdGEsCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9nZXRfbGF5b3V0KHNlbGYsIGlzX2ZpbGU6IGJvb2wgPSBUcnVlLCBpc19odG06IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfZGF0ZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCiAgICAgICAgcG9wdXBfdmFsdWVzID0gWyfQmNC90YTQviddCiAgICAgICAgaWYgaXNfZmlsZToKICAgICAgICAgICAgcG9wdXBfdmFsdWVzLmFwcGVuZCgn0J/QtdGA0LXQtNCw0YLRjCDQvdCwINCR0JEnKQogICAgICAgICAgICBpZiBpc19odG06CiAgICAgICAgICAgICAgICBwb3B1cF92YWx1ZXMuYXBwZW5kKCfQqNCw0LHQu9C+0L0g0L/QtdGH0LDRgtC4JykKICAgICAgICBsYXlvdXQgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcGljdHVyZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZmlsZV9uYW1lJywKICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9JzsnLmpvaW4ocG9wdXBfdmFsdWVzKSwKICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ic2VudCIsCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTAsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0iaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfc2l6ZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BjcmVhdGlvbl90aW1lJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICksCgogICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICkKICAgICAgICByZXR1cm4gbGF5b3V0CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF9hbGxfZmlsZXNfZnJvbV9wYXRjaChkaXJlY3Rvcnk6IHN0cikgLT4gTGlzdFtEaWN0XToKICAgICAgICBmaWxlc19pbmZvID0gW10KICAgICAgICAjIFdhbGsgdGhyb3VnaCB0aGUgZm9sZGVyIGFuZCBpdHMgc3ViZGlyZWN0b3JpZXMKICAgICAgICBkaXJlY3RvcnlfcGF0aCA9IFBhdGgoZGlyZWN0b3J5KQogICAgICAgIGZvciBmaWxlIGluIGRpcmVjdG9yeV9wYXRoLml0ZXJkaXIoKToKICAgICAgICAgICAgcGljID0gKCcjZjE1YicgaWYgZmlsZS5pc19maWxlKCkgZWxzZQogICAgICAgICAgICAgICAgICAgJyNmMGMxJyBpZiBmaWxlLmlzX3N5bWxpbmsoKSBlbHNlICcjZjA3YicpCiAgICAgICAgICAgIGZpbGVfdHlwZSA9ICgiRmlsZSIgaWYgZmlsZS5pc19maWxlKCkgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgIlN5bUxpbmsiIGlmIGZpbGUuaXNfc3ltbGluaygpIGVsc2UgIkZvbGRlciIpCiAgICAgICAgICAgIGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lID0gdGltZS5zdHJmdGltZSgKICAgICAgICAgICAgICAgICclWS0lbS0lZCAlSDolTTolUycsCiAgICAgICAgICAgICAgICB0aW1lLmxvY2FsdGltZShpbnQoZmlsZS5zdGF0KCkuc3RfY3RpbWUpKQogICAgICAgICAgICApCiAgICAgICAgICAgIGZpbGVfaW5mbyA9IHsKICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljLAogICAgICAgICAgICAgICAgJ2ZpbGVfdHlwZSc6IGZpbGVfdHlwZSwKICAgICAgICAgICAgICAgICdmaWxlX25hbWUnOiBmaWxlLm5hbWUsCiAgICAgICAgICAgICAgICAnZnVsbF9wYXRoJzogc3RyKGRpcmVjdG9yeV9wYXRoLmpvaW5wYXRoKGZpbGUubmFtZSkpLAogICAgICAgICAgICAgICAgJ2ZpbGVfc2l6ZSc6IGYne2ZpbGUuc3RhdCgpLnN0X3NpemUgLyAxMDI0Oi4yZn0gS0InLAogICAgICAgICAgICAgICAgJ2NyZWF0aW9uX3RpbWUnOiBmb3JtYXR0ZWRfY3JlYXRpb25fdGltZSwKICAgICAgICAgICAgICAgICdleHRlbnNpb24nOiBmaWxlLnN1ZmZpeAogICAgICAgICAgICB9CiAgICAgICAgICAgIGZpbGVzX2luZm8uYXBwZW5kKGZpbGVfaW5mbykKCiAgICAgICAgcmV0dXJuIGZpbGVzX2luZm8KCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGF5b3V0X2xpc3RlbmVyJykKICAgICAgICBzZWxlY3RlZF9jYXJkOiBkaWN0ID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnY2FyZF9kYXRhJykpCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ9Cf0LXRgNC10LTQsNGC0Ywg0L3QsCDQkdCRJzoKICAgICAgICAgICAgc2VsZi5fY29weV9maWxlKFBhdGgoc2VsZWN0ZWRfY2FyZFsnZnVsbF9wYXRoJ10pKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ9CY0L3RhNC+JzoKICAgICAgICAgICAgc2VsZWN0ZWRfY2FyZC5wb3AoJ19sYXlvdXQnLCBOb25lKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHN0cihzZWxlY3RlZF9jYXJkKSkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICfQqNCw0LHQu9C+0L0g0L/QtdGH0LDRgtC4JzoKICAgICAgICAgICAgcHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKICAgICAgICAgICAgcHJpbnRfbmNsLnB1dCgnbGFibGVfZmlsZV9uYW1lJywgc2VsZWN0ZWRfY2FyZC5nZXQoJ2ZpbGVfbmFtZScpLCBUcnVlKQogICAgICAgICAgICBwcmludF9uY2wucHV0KCdsYWJsZV9mdWxsX3BhdGgnLCBzZWxlY3RlZF9jYXJkLmdldCgnZnVsbF9wYXRoJyksIFRydWUpCiAgICAgICAgICAgIHByaW50X25jbC5wdXQoJ2Zyb21fZmlsZV9icm93c2VyJywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCfQn9C10YfQsNGC0YwnLCAn0KDQtdC30YPQu9GM0YLQsNGCJykKCiAgICBkZWYgX2NvcHlfZmlsZShzZWxmLCBmaWxlOiBQYXRoKToKICAgICAgICBpcF9ob3N0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lwX2hvc3QnKSBvciBzZWxmLnJzX3NldHRpbmdzLmdldCgnZGVidWdfaG9zdF9pcCcpICMgJzE5Mi4xNjguMS43NycKICAgICAgICB3aXRoIG9wZW4oZmlsZSwgJ3JiJykgYXMgZjoKICAgICAgICAgICAgIyBzZW5kX3NlcnZpY2UgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkKICAgICAgICAgICAgcmVzID0gc2VsZi5oc19zZXJ2aWNlLmV4cG9ydF9maWxlKGZpbGUubmFtZSwgZikKCiAgICAgICAgICAgIGlmIHJlc1snc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGYn0KTQsNC50Lsge2ZpbGUubmFtZX0g0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQoKCiMgPT09PT09PT09PT09PT09PT09PT0gVGlsZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFRpbGVzKFNjcmVlbik6CiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X3RpbGVfcm93KHNlbGYsIGxheW91dCwgdGlsZV9lbGVtZW50LCBzdGFydF9zY3JlZW49J9CU0L7QutGD0LzQtdC90YLRiycpOgogICAgICAgIHRpbGUgPSB7CiAgICAgICAgICAgICJsYXlvdXQiOiBsYXlvdXQsCiAgICAgICAgICAgICJkYXRhIjogc2VsZi5fZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJjb2xvciI6ICcjRkZGRkZGJywKICAgICAgICAgICAgInN0YXJ0X3NjcmVlbiI6IGYie3N0YXJ0X3NjcmVlbn0iLAogICAgICAgICAgICAic3RhcnRfcHJvY2VzcyI6ICIiLAogICAgICAgICAgICAna2V5JzogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRpbGUKCiAgICBkZWYgX2dldF9tZXNzYWdlX3RpbGUoc2VsZiwgbWVzc2FnZSwgdGV4dF9jb2xvcj0nIzAwMDAwMCcpOgogICAgICAgIHRpbGVfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgVmFsdWU9J0Bub19kYXRhJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXNlbGYucnNfc2V0dGluZ3MuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgIFRleHRDb2xvcj10ZXh0X2NvbG9yLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MCwKICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0iY2VudGVyIiwKICAgICAgICAgICAgICAgIGdyYXZpdHlfdmVydGljYWw9ImNlbnRlciIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0wLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPSIjZmZmZmZmIiwKICAgICAgICAgICAgICAgIFBhZGRpbmc9MAoKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGF1dG9TaXplVGV4dFR5cGU9J3VuaWZvcm0nLAogICAgICAgICAgICB3ZWlnaHQ9MCwKICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9ImNlbnRlciIsCiAgICAgICAgICAgIGdyYXZpdHlfdmVydGljYWw9ImNlbnRlciIsCiAgICAgICAgICAgIFN0cm9rZVdpZHRoPTMsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0iI2ZmZmZmZiIsCiAgICAgICAgICAgIFBhZGRpbmc9MAogICAgICAgICkKCiAgICAgICAgbGF5b3V0ID0ganNvbi5sb2Fkcyh0aWxlX3ZpZXcudG9fanNvbigpKQoKICAgICAgICB0aWxlc19saXN0ID0gW3sKICAgICAgICAgICAgImxheW91dCI6IGxheW91dCwKICAgICAgICAgICAgImRhdGEiOiB7Im5vX2RhdGEiOiBtZXNzYWdlfSwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAiY29sb3IiOiAnI2ZmZmZmZicsCiAgICAgICAgICAgICJzdGFydF9zY3JlZW4iOiAiIiwKICAgICAgICAgICAgInN0YXJ0X3Byb2Nlc3MiOiAiIiwKICAgICAgICAgICAgJ1N0cm9rZVdpZHRoJzogJycsCiAgICAgICAgfV0KCiAgICAgICAgY291bnRfcm93X2VsZW1lbnRzID0gMQogICAgICAgIHRpbGVzID0gewogICAgICAgICAgICAndGlsZXMnOiBbdGlsZXNfbGlzdF0sCiAgICAgICAgICAgICdiYWNrZ3JvdW5kX2NvbG9yJzogJyNmZmZmZmYnLAogICAgICAgICAgICAnU3Ryb2tlV2lkdGgnOiAnJywKICAgICAgICAgICAgJ2hlaWdodCc6ICcnCgogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRpbGVzCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfdGlsZV9kYXRhKHRpbGVfZWxlbWVudCk6CiAgICAgICAgY291bnRfdmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ2NvdW50X3ZlcmlmaWVkJ10gb3IgMAogICAgICAgIGNvdW50X3VudmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ2NvdW50X3VudmVyaWZpZWQnXSBvciAwCiAgICAgICAgcXR0eV9wbGFuX3ZlcmlmaWVkID0gdGlsZV9lbGVtZW50WydxdHR5X3BsYW5fdmVyaWZpZWQnXSBvciAwCiAgICAgICAgcXR0eV9wbGFuX3VudmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ3F0dHlfcGxhbl91bnZlcmlmaWVkJ10gb3IgMAoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAiZG9jTmFtZSI6IHRpbGVfZWxlbWVudFsnZG9jVHlwZSddLAogICAgICAgICAgICAnUXR0eU9mRG9jcyc6ICd7fS97fScuZm9ybWF0KHRpbGVfZWxlbWVudFsnY291bnQnXSwgdGlsZV9lbGVtZW50Wyd2ZXJpZmllZCddKSwKICAgICAgICAgICAgJ2NvdW50X3ZlcmlmaWVkJzogJ3t9L3t9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICBjb3VudF92ZXJpZmllZCArIGNvdW50X3VudmVyaWZpZWQsCiAgICAgICAgICAgICAgICBjb3VudF91bnZlcmlmaWVkKSwKICAgICAgICAgICAgJ3F0dHlfcGxhbl92ZXJpZmllZCc6ICd7fS97fScuZm9ybWF0KAogICAgICAgICAgICAgICAgcXR0eV9wbGFuX3ZlcmlmaWVkICsgcXR0eV9wbGFuX3VudmVyaWZpZWQsCiAgICAgICAgICAgICAgICBxdHR5X3BsYW5fdW52ZXJpZmllZCkKICAgICAgICB9CgogICAgZGVmIF9nZXRfdGlsZV92aWV3KHNlbGYpIC0+IHdpZGdldHMuTGluZWFyTGF5b3V0OgogICAgICAgIHRpbGVzX3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jTmFtZScsCiAgICAgICAgICAgICAgICBUZXh0U2l6ZT1zZWxmLnJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BRdHR5T2ZEb2NzJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KHRgtGA0L7QujogJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAY291bnRfdmVyaWZpZWQnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC+0LLQsNGA0L7QsjogJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAcXR0eV9wbGFuX3ZlcmlmaWVkJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBhdXRvU2l6ZVRleHRUeXBlPSd1bmlmb3JtJywKICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICApCgogICAgICAgIHJldHVybiB0aWxlc192aWV3CgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlLCByc19zZXR0aW5ncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gcnNfc2V0dGluZ3MuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJykKICAgICAgICAgICAgc2VsZi5UZXh0Q29sb3IgPSAnIzMzMzMzMycKICAgICAgICAgICAgc2VsZi5CYWNrZ3JvdW5kQ29sb3IgPSAnRkZDQzk5JwogICAgICAgICAgICBzZWxmLndlaWdodCA9IDAKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgoKY2xhc3MgRmxvd1RpbGVzU2NyZWVuKFRpbGVzKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0LvQuNGC0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQodCx0L7RgCDQqNCaJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IERvY1NlcnZpY2UoaXNfYmFyY19mbG93PVRydWUpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CgogICAgICAgIGRhdGEgPSBzZWxmLmRiX3NlcnZpY2UuZ2V0X2RvY19mbG93X3N0YXQoKQogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgICMgbGF5b3V0ID0gc2VsZi5fZ2V0X3RpbGVfdmlldygpCiAgICAgICAgICAgIGxheW91dCA9IGpzb24ubG9hZHMoc2VsZi5fZ2V0X3RpbGVfdmlldygpLnRvX2pzb24oKSkKCiAgICAgICAgICAgIHRpbGVzX2xpc3QgPSBbc2VsZi5fZ2V0X3RpbGVfcm93KGxheW91dCwgaXRlbSkgZm9yIGl0ZW0gaW4gZGF0YV0KCiAgICAgICAgICAgICMgc3BsaXQgbGlzdCBieSB0d28gZWxlbWVudCBpbiByb3cKICAgICAgICAgICAgY291bnRfcm93X2VsZW1lbnRzID0gMgogICAgICAgICAgICB0aWxlcyA9IHsKICAgICAgICAgICAgICAgICd0aWxlcyc6IFsKICAgICAgICAgICAgICAgICAgICB0aWxlc19saXN0W2k6aSArIGNvdW50X3Jvd19lbGVtZW50c10KICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4odGlsZXNfbGlzdCksIGNvdW50X3Jvd19lbGVtZW50cykKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZF9jb2xvcic6ICcjZjVmNWY1JwoKICAgICAgICAgICAgfQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRpbGVzID0gc2VsZi5fZ2V0X21lc3NhZ2VfdGlsZSgi0J3QtdGCINC30LDQs9GA0YPQttC10L3QvdGL0YUg0LTQvtC60YPQvNC10L3RgtC+0LIiKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndGlsZXMnLCB0aWxlcywgdG9fanNvbj1UcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZGVmIF9nZXRfdGlsZV92aWV3KHNlbGYpIC0+IHdpZGdldHMuTGluZWFyTGF5b3V0OgogICAgICAgIHRpbGVzX3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jTmFtZScsCiAgICAgICAgICAgICAgICBUZXh0U2l6ZT1zZWxmLnJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BRdHR5T2ZEb2NzJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KHRgtGA0L7QujogJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAYmFyY19jb3VudCcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAoKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGF1dG9TaXplVGV4dFR5cGU9J3VuaWZvcm0nLAogICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRpbGVzX3ZpZXcKCiAgICBkZWYgX2dldF90aWxlX3JvdyhzZWxmLCBsYXlvdXQsIHRpbGVfZWxlbWVudCwgc3RhcnRfc2NyZWVuPSfQlNC+0LrRg9C80LXQvdGC0YsnKToKICAgICAgICB0aWxlID0gewogICAgICAgICAgICAibGF5b3V0IjogbGF5b3V0LAogICAgICAgICAgICAiZGF0YSI6IHNlbGYuX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KSwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAiY29sb3IiOiAnI0ZGRkZGRicsCiAgICAgICAgICAgICJzdGFydF9zY3JlZW4iOiBmIntzdGFydF9zY3JlZW59IiwKICAgICAgICAgICAgInN0YXJ0X3Byb2Nlc3MiOiAiIiwKICAgICAgICAgICAgJ2tleSc6IHRpbGVfZWxlbWVudFsnZG9jVHlwZSddCiAgICAgICAgfQogICAgICAgIHJldHVybiB0aWxlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfdGlsZV9kYXRhKHRpbGVfZWxlbWVudCk6CiAgICAgICAgY291bnRfdmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ3ZlcmlmaWVkJ10gb3IgMAogICAgICAgICMgY291bnRfdW52ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsnY291bnRfdW52ZXJpZmllZCddIG9yIDAKICAgICAgICBiYXJjX2NvdW50ID0gdGlsZV9lbGVtZW50WydiYXJjX2NvdW50J10gb3IgMAoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAiZG9jTmFtZSI6IHRpbGVfZWxlbWVudFsnZG9jVHlwZSddLAogICAgICAgICAgICAnUXR0eU9mRG9jcyc6ICd7fS97fScuZm9ybWF0KHRpbGVfZWxlbWVudFsnY291bnQnXSwgdGlsZV9lbGVtZW50Wyd2ZXJpZmllZCddKSwKICAgICAgICAgICAgJ2NvdW50X3ZlcmlmaWVkJzogc3RyKGNvdW50X3ZlcmlmaWVkKSwKICAgICAgICAgICAgJ2JhcmNfY291bnQnOiBzdHIoYmFyY19jb3VudCkKICAgICAgICB9CgoKY2xhc3MgR3JvdXBTY2FuVGlsZXMoVGlsZXMpOgogICAgc2NyZWVuX25hbWUgPSAn0J/Qu9C40YLQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZShpc19ncm91cF9zY2FuPVRydWUpCiAgICAgICAgc2VsZi5zY3JlZW5fbmFtZSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2N1cnJlbnRfc2NyZWVuKCkKICAgICAgICBzZWxmLnByb2Nlc3NfbmFtZSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2N1cnJlbnRfcHJvY2VzcygpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgdGlsZXMgPSBzZWxmLl9nZXRfbWVzc2FnZV90aWxlKCLQntGC0YHRg9GC0YHRgtCy0YPQtdGCINGB0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwiLCB0ZXh0X2NvbG9yPSIjZmYwMDAwIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RpbGVzJywgdGlsZXMsIHRvX2pzb249VHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NoZWNrX2Nvbm5lY3Rpb24nXSA9IEZhbHNlCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZWxmLmhhc2hfbWFwWydjaGVja19jb25uZWN0aW9uJ10gPSBUcnVlCgogICAgICAgIGRhdGEgPSBzZWxmLl9nZXRfZG9jc19zdGF0KCkKCiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgbGF5b3V0ID0ganNvbi5sb2FkcyhzZWxmLl9nZXRfdGlsZV92aWV3KCkudG9fanNvbigpKQoKICAgICAgICAgICAgdGlsZXNfbGlzdCA9IFtzZWxmLl9nZXRfdGlsZV9yb3cobGF5b3V0LCBpdGVtKSBmb3IgaXRlbSBpbiBkYXRhXQoKICAgICAgICAgICAgIyBzcGxpdCBsaXN0IGJ5IHR3byBlbGVtZW50IGluIHJvdwogICAgICAgICAgICBjb3VudF9yb3dfZWxlbWVudHMgPSAyCiAgICAgICAgICAgIHRpbGVzID0gewogICAgICAgICAgICAgICAgJ3RpbGVzJzogWwogICAgICAgICAgICAgICAgICAgIHRpbGVzX2xpc3RbaTppICsgY291bnRfcm93X2VsZW1lbnRzXQogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbih0aWxlc19saXN0KSwgY291bnRfcm93X2VsZW1lbnRzKQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kX2NvbG9yJzogJyNmNWY1ZjUnCgogICAgICAgICAgICB9CiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGlsZXMgPSBzZWxmLl9nZXRfbWVzc2FnZV90aWxlKCLQndC10YIg0LfQsNCz0YDRg9C20LXQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0L7QsiIpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0aWxlcycsIHRpbGVzLCB0b19qc29uPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUsIGFyZ3MpCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIGlmIChzZWxmLnJzX3NldHRpbmdzLmdldCgnb2ZmbGluZV9tb2RlJykgb3IKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoJ2NoZWNrX2Nvbm5lY3Rpb24nKSk6CiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIGhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgIHRyeToKICAgICAgICAgICAgaHNfc2VydmljZS5jb21tdW5pY2F0aW9uX3Rlc3QodGltZW91dD0xKQogICAgICAgICAgICBhbnN3ZXIgPSBoc19zZXJ2aWNlLmh0dHBfYW5zd2VyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBhbnN3ZXIgPSBoc19zZXJ2aWNlLkh0dHBBbnN3ZXIoCiAgICAgICAgICAgICAgICBlcnJvcj1UcnVlLAogICAgICAgICAgICAgICAgZXJyb3JfdGV4dD1zdHIoZS5hcmdzWzBdKSwKICAgICAgICAgICAgICAgIHN0YXR1c19jb2RlPTQwNCwKICAgICAgICAgICAgICAgIHVybD1oc19zZXJ2aWNlLnVybCkKICAgICAgICByZXR1cm4gbm90IGFuc3dlci5lcnJvcgoKICAgIGRlZiBfZ2V0X2RvY3Nfc3RhdChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5kYl9zZXJ2aWNlLmdldF9kb2NzX3N0YXQoKQoKCmNsYXNzIERvY3VtZW50c1RpbGVzKEdyb3VwU2NhblRpbGVzKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0LvQuNGC0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfZ2V0X2RvY3Nfc3RhdChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5kYl9zZXJ2aWNlLmdldF9kb2NzX3N0YXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFRpbGVzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gRG9jc0xpc3QgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBEb2NzTGlzdFNjcmVlbihTY3JlZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwKQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnJwogICAgICAgIHNlbGYucXVldWVfc2VydmljZSA9IFNjYW5uaW5nUXVldWVTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBkb2NfdHlwZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY190eXBlcygpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3R5cGVfc2VsZWN0J10gPSAnOycuam9pbihbJ9CS0YHQtSddICsgZG9jX3R5cGVzKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY19zdGF0dXNfc2VsZWN0J10gPSAn0JLRgdC1O9CaINCy0YvQv9C+0LvQvdC10L3QuNGOO9CS0YvQs9GA0YPQttC10L070Jog0LLRi9Cz0YDRg9C30LrQtScKCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF90aWxlX2tleSddIG9yIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX2NsaWNrJ10KICAgICAgICBkb2Nfc3RhdHVzID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZG9jX3N0YXR1cyddCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3R5cGVfY2xpY2snXSA9IGRvY190eXBlCiAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfdGlsZV9rZXknXSA9ICcnCiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5fZ2V0X2RvY19saXN0X2RhdGEoZG9jX3R5cGUsIGRvY19zdGF0dXMpCgogICAgICAgIHByZXBhcmVkX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEobGlzdF9kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3JldHVybl9zZWxlY3RlZF9kYXRhJ10gPSAnJwogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldyhwcmVwYXJlZF9kYXRhLCBzZWxmLnBvcHVwX21lbnVfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2NDYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gImRvY19zdGF0dXNfY2xpY2siOgogICAgICAgICAgICAjIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RvY19zdGF0dXMnXSA9IHNlbGYuaGFzaF9tYXBbImRvY19zdGF0dXNfY2xpY2siXQogICAgICAgICAgICBzZWxmLl9kb2Nfc3RhdHVzX2NsaWNrKCkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgICAgICBzZWxmLl9sYXlvdXRfYWN0aW9uKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fZGVsZXRlJyk6CiAgICAgICAgICAgIHNlbGYuY29uZmlybV9kZWxldGVfZG9jX2xpc3RlbmVyKCkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX3Jlc2VuZF9kb2MnKToKICAgICAgICAgICAgc2VsZi5fcmVzZW5kX2RvYygpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5fdmFsaWRhdGVfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLnNjcmVlbl9uYW1lLCBhcmdzKQoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKSAtPiBOb25lOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xheW91dF9saXN0ZW5lciddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDQtNC+0LrRg9C80LXQvdGCINGBINGD0YHRgtGA0L7QudGB0YLQstCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX3Jlc2VuZF9kb2MnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4/JwogICAgICAgICAgICApCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKQoKICAgIGRlZiBfZG9jX3N0YXR1c19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9kb2Nfc3RhdHVzJ10gPSBzZWxmLmhhc2hfbWFwWyJkb2Nfc3RhdHVzX2NsaWNrIl0KICAgICAgICBzZWxmLmN1cnJlbnRfc3RhdHVzID0gc2VsZi5oYXNoX21hcFsiZG9jX3N0YXR1c19jbGljayJdCgogICAgZGVmIF9yZXNlbmRfZG9jKHNlbGYpOgogICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZGVidWdfaWRfZG9jJ10gPSBpZF9kb2MKICAgICAgICBkb2NfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfZGF0YV90b19zZW5kX2J5X2RvY19pZChpZF9kb2MpCgogICAgICAgIGlmIGRvY19kYXRhOgogICAgICAgICAgICBodHRwX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2UoaHR0cF9wYXJhbXM9c2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbnN3ZXIgPSBodHRwX3NlcnZpY2Uuc2VuZF9kYXRhKGRvY19kYXRhKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBodHRwX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICAgICAgaHR0cF9zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWFuc3dlci5lcnJvcl90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0LAnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRvY19pZCA9IGlkX2RvYwogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2NfdmFsdWVzKHZlcmlmaWVkPTEsIHNlbnQ9MSkKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9CU0L7QutGD0LzQtdC90YIg0L7RgtC/0YDQsNCy0LvQtdC9INC/0L7QstGC0L7RgNC90L4nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LXRgiDQtNCw0L3QvdGL0YUg0LTQu9GPINC+0YLQv9GA0LDQstC60LgnKQogICAgICAgICAgICByZXR1cm4KCiAgICBkZWYgX2dldF9kb2NfbGlzdF9kYXRhKHNlbGYsIGRvY190eXBlLCBkb2Nfc3RhdHVzKSAtPiBsaXN0OgogICAgICAgIHJlc3VsdHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY192aWV3X2RhdGEoZG9jX3R5cGUsIGRvY19zdGF0dXMpCiAgICAgICAgcmV0dXJuIHJlc3VsdHMKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBsaXN0X2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbXQogICAgICAgIGZvciByZWNvcmQgaW4gbGlzdF9kYXRhOgogICAgICAgICAgICBkb2Nfc3RhdHVzID0gJycKCiAgICAgICAgICAgIGlmIHJlY29yZFsndmVyaWZpZWQnXSBhbmQgcmVjb3JkWydzZW50J106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CS0YvQs9GA0YPQttC10L0nCiAgICAgICAgICAgIGVsaWYgcmVjb3JkWyd2ZXJpZmllZCddOgogICAgICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICfQmiDQstGL0LPRgNGD0LfQutC1JwogICAgICAgICAgICBlbGlmIG5vdCAocmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXSk6CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQv9C+0LvQvdC10L3QuNGOJwoKICAgICAgICAgICAgZG9jX3RpdGxlID0gJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZSddLCBzZWxmLmhhc2hfbWFwWydkb2NfbiddLCBzZWxmLmhhc2hfbWFwWydkb2NfZGF0ZSddKQoKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAndHlwZSc6IHJlY29yZFsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgICAgICdudW1iZXInOiByZWNvcmRbJ2RvY19uJ10sCiAgICAgICAgICAgICAgICAnZG9jX3RpdGxlJzogZG9jX3RpdGxlLAogICAgICAgICAgICAgICAgJ2RhdGEnOiBzZWxmLl9mb3JtYXRfZGF0ZShyZWNvcmRbJ2RvY19kYXRlJ10pLAogICAgICAgICAgICAgICAgJ3dhcmVob3VzZSc6IHJlY29yZFsnUlNfd2FyZWhvdXNlJ10sCiAgICAgICAgICAgICAgICAnY291bnRyYWdlbnQnOiByZWNvcmRbJ1JTX2NvdW50cmFnZW50J10sCiAgICAgICAgICAgICAgICAnYWRkX21hcmtfc2VsZWN0aW9uJzogcmVjb3JkWydhZGRfbWFya19zZWxlY3Rpb24nXSwKICAgICAgICAgICAgICAgICdzdGF0dXMnOiBkb2Nfc3RhdHVzLAogICAgICAgICAgICAgICAgJ2lzX2dyb3VwX3NjYW4nOiByZWNvcmRbJ2lzX2dyb3VwX3NjYW4nXQogICAgICAgICAgICB9KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGEsIHBvcHVwX21lbnVfZGF0YSk6CiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc3RhdHVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHR5cGUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT10aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlBvcHVwTWVudUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9cG9wdXBfbWVudV9kYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNvdW50cmFnZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B3YXJlaG91c2UnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiBkb2NfY2FyZHMKCiAgICBkZWYgX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKHNlbGYsIHB1dF9kYXRhPU5vbmUpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2RhdGEiLCBmcm9tX2pzb249VHJ1ZSkKCiAgICAgICAgcHV0X2RhdGEgPSBwdXRfZGF0YSBvciB7fQogICAgICAgIHB1dF9kYXRhWydpZF9kb2MnXSA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICBwdXRfZGF0YVsnZG9jX3R5cGUnXSA9IGNhcmRfZGF0YVsndHlwZSddCiAgICAgICAgcHV0X2RhdGFbJ2RvY19uJ10gPSBjYXJkX2RhdGFbJ251bWJlciddCiAgICAgICAgcHV0X2RhdGFbJ2RvY19kYXRlJ10gPSBjYXJkX2RhdGFbJ2RhdGEnXQogICAgICAgIHB1dF9kYXRhWyd3YXJlaG91c2UnXSA9IGNhcmRfZGF0YVsnd2FyZWhvdXNlJ10KICAgICAgICBwdXRfZGF0YVsnY291bnRyYWdlbnQnXSA9IGNhcmRfZGF0YVsnY291bnRyYWdlbnQnXQogICAgICAgIHB1dF9kYXRhWydkb2NfdGl0bGUnXSA9IHNlbGYuX2dldF9kb2NfdGl0bGUoKipwdXRfZGF0YSkKCiAgICAgICAgcmV0dXJuIHB1dF9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RpdGxlKHNlbGYsICoqa3dhcmdzKToKICAgICAgICByZXR1cm4gJ3tkb2NfdHlwZX0g4oSWIHtkb2Nfbn0g0L7RgiB7ZG9jX2RhdGV9Jy5mb3JtYXQoKiprd2FyZ3MpCgogICAgZGVmIF9zZXRfZG9jX3ZlcmlmaWVkKHNlbGYsIGlkX2RvYywgdmFsdWU9VHJ1ZSk6CiAgICAgICAgIyBzZXJ2aWNlID0gRG9jU2VydmljZShpZF9kb2MpCiAgICAgICAgdmFsdWUgPSBzdHIoaW50KHZhbHVlKSkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZSgndmVyaWZpZWQnLCB2YWx1ZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGUuYXJnc1swXSkKCiAgICBkZWYgZG9jX2RlbGV0ZShzZWxmLCBpZF9kb2MpOgoKICAgICAgICByZXN1bHQgPSBUcnVlCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRlbGV0ZV9kb2MoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UucmVtb3ZlX2RvY19saW5lcyhpZF9kb2MpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhlLmFyZ3NbMF0pCiAgICAgICAgICAgIHJlc3VsdCA9IEZhbHNlCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2RvY3NfY291bnQoc2VsZiwgZG9jX3R5cGU9JycpOgogICAgICAgIGRvY190eXBlID0gJycgaWYgbm90IGRvY190eXBlIG9yIGRvY190eXBlID09ICfQktGB0LUnIGVsc2UgZG9jX3R5cGUKICAgICAgICByZXR1cm4gc2VsZi5zZXJ2aWNlLmdldF9kb2NzX2NvdW50KGRvY190eXBlKQoKICAgIGRlZiBfY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmV0dXJuIHNlbGYuc2VydmljZS5jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQoKICAgIGRlZiBjb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikKICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCgogICAgICAgIGlmIHNlbGYuZG9jX2RlbGV0ZShpZF9kb2MpOgogICAgICAgICAgICBkb2NzX2NvdW50ID0gc2VsZi5nZXRfZG9jc19jb3VudChkb2NfdHlwZT1kb2NfdHlwZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDRg9GB0L/QtdGI0L3QviDRg9C00LDQu9GR0L0nKQogICAgICAgICAgICBpZiBkb2NzX2NvdW50OgogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDRg9C00LDQu9C10L3QuNGPINC00L7QutGD0LzQtdC90YLQsCcpCgogICAgZGVmIF9mb3JtYXRfZGF0ZShzZWxmLCBkYXRlX3N0cjogc3RyKToKICAgICAgICByZXR1cm4gZGF0ZXRpbWUuZnJvbWlzb2Zvcm1hdChkYXRlX3N0cikuc3RyZnRpbWUoJyVtLSVkLSVZICVIOiVNOiVTJykKCiAgICBkZWYgZ2V0X2lkX2RvYyhzZWxmKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKSBvciB7fQogICAgICAgIGlkX2RvYyA9IGNhcmRfZGF0YS5nZXQoJ2tleScpIG9yIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J10KICAgICAgICByZXR1cm4gaWRfZG9jCgogICAgZGVmIGdldF9kb2NfbnVtYmVyKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpIG9yIHt9CiAgICAgICAgZG9jX251bWJlciA9IGNhcmRfZGF0YS5nZXQoJ251bWJlcicpCiAgICAgICAgcmV0dXJuIGRvY19udW1iZXIKCgpjbGFzcyBHcm91cFNjYW5Eb2NzTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UuaXNfZ3JvdXBfc2NhbiA9IFRydWUKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgXSkgICMn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnN0b3BfdGltZXJzKGJzX2hhc2hfbWFwPVRydWUpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X21vZGUgPSAi0L7RhNGE0LvQsNC50L0iIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBlbHNlICLQvtC90LvQsNC50L0iCiAgICAgICAgICAgIHdhcm5pbmdfbXNnID0gIiDQlNC+0LrRg9C80LXQvdGCINC90LUg0LHRg9C00LXRgiDQtNC+0YHRgtGD0L/QtdC9INCyINC00YDRg9Cz0LjRhSDQv9GA0L7RhtC10YHRgdCw0YUuIgogICAgICAgICAgICBtc2cgPSAoZiLQktGLINC+0YLQutGA0YvQstCw0LXRgtC1INC00L7QutGD0LzQtdC90YIg0LPRgNGD0L/Qv9C+0LLRg9GOINC+0LHRgNCw0LHQvtGC0LrRgyDQtNC+0LrRg9C80LXQvdGC0LAgIgogICAgICAgICAgICAgICAgICAgZiLQsiB7Y3VycmVudF9tb2RlLnVwcGVyKCl9INGA0LXQttC40LzQtS4iKQogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKVsnaXNfZ3JvdXBfc2NhbiddID09ICcwJzoKICAgICAgICAgICAgICAgIG1zZyArPSB3YXJuaW5nX21zZwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZ3JvdXBfc2Nhbl9tZXNzYWdlJywgbXNnKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygn0J/QvtC00YLQstC10YDQtNC40YLQtSDQtNC10LnRgdGC0LLQuNC1JykKICAgICAgICAgICAgc2VsZWN0ZWRfY2FyZF9rZXkgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddID0gc2VsZWN0ZWRfY2FyZF9rZXkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0LTQtdC50YHRgtCy0LjQtScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpWydpc19ncm91cF9zY2FuJ10gPT0gJzAnOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnJlc2V0X2RvY190YWJsZXNfcXR0eSgpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCd2ZXJpZmllZCcsIDEpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCdpc19ncm91cF9zY2FuJywgJzEnKQoKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICAgICAgICAgIHNjcmVlbiA9IFNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgICAgICBzY3JlZW5fbmFtZT1zY3JlZW5fbmFtZSwKICAgICAgICAgICAgICAgIHByb2Nlc3M9c2VsZi5wcm9jZXNzX25hbWUsCiAgICAgICAgICAgICAgICBoYXNoX21hcD1zZWxmLmhhc2hfbWFwLAogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3M9c2VsZi5yc19zZXR0aW5ncykKCiAgICAgICAgICAgIHNjcmVlbi5zaG93KGFyZ3M9c2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoKSkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2NsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCiAgICAgICAgICAgIHNlbGYucXVldWVfc2VydmljZS5yZW1vdmVfZG9jX2xpbmVzKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQlNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwINC4INC80LDRgNC60LjRgNC+0LLQutC4INC+0YfQuNGJ0LXQvdGLJykKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoaWRfZG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J/RgNC4INC+0YfQuNGB0YLQutC1INC00LDQvdC90YvRhSDQv9C10YDQtdGB0YfQtdGC0LAg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIE1haW5FdmVudHMuc3RhcnRfdGltZXIoc2VsZi5oYXNoX21hcCkKICAgICAgICBzdXBlcigpLl9iYWNrX3NjcmVlbigpCgoKY2xhc3MgRG9jdW1lbnRzRG9jc0xpc3RTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnOycuam9pbigKICAgICAgICAgICAgWyfQo9C00LDQu9C40YLRjCcsICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnLCAn0J7RgtC/0YDQsNCy0LjRgtGMINC/0L7QstGC0L7RgNC90L4nXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgaWRfZG9jID0gc2VsZi5nZXRfaWRfZG9jKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10gPSBpZF9kb2MKICAgICAgICAgICAgIyBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5kb2NfaWQgPSBpZF9kb2MKCiAgICAgICAgICAgIG5vQ2xhc3MoJ2FydGljbGVzX29jcl9uY2wnKS5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgICAgICAgICBzY3JlZW4gPSBTY3JlZW5zRmFjdG9yeS5jcmVhdGVfc2NyZWVuKAogICAgICAgICAgICAgICAgc2NyZWVuX25hbWU9c2NyZWVuX25hbWUsCiAgICAgICAgICAgICAgICBwcm9jZXNzPXNlbGYucHJvY2Vzc19uYW1lLAogICAgICAgICAgICAgICAgaGFzaF9tYXA9c2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgICAgIHJzX3NldHRpbmdzPXNlbGYucnNfc2V0dGluZ3MpCgogICAgICAgICAgICBzY3JlZW4uc2hvdyhhcmdzPXNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICByZXMgPSBzZWxmLl9jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UucmVtb3ZlX2RvY19saW5lcyhpZF9kb2MpCiAgICAgICAgICAgIGlmIHJlcy5nZXQoJ3Jlc3VsdCcpOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCDQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQvtGH0LjRidC10L3RiycpCiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKGlkX2RvYykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cf0YDQuCDQvtGH0LjRgdGC0LrQtSDQtNCw0L3QvdGL0YUg0L/QtdGA0LXRgdGH0LXRgtCwINCy0L7Qt9C90LjQutC70LAg0L7RiNC40LHQutCwLicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhyZXMuZ2V0KCdlcnJvcicpKQoKICAgIGRlZiBnZXRfaWRfZG9jKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpIG9yIHt9CiAgICAgICAgaWRfZG9jID0gY2FyZF9kYXRhLmdldCgna2V5Jykgb3Igc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIHJldHVybiBpZF9kb2MKCiAgICBkZWYgX2dldF9kb2NfbGlzdF9kYXRhKHNlbGYsIGRvY190eXBlLCBkb2Nfc3RhdHVzKSAtPiBsaXN0OgogICAgICAgIHJlc3VsdHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY192aWV3X2RhdGEoZG9jX3R5cGUsIGRvY19zdGF0dXMpCiAgICAgICAgcmV0dXJuIHJlc3VsdHMKCgpjbGFzcyBEb2NzT2ZmbGluZUxpc3RTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnOycuam9pbigKICAgICAgICAgICAgWyfQo9C00LDQu9C40YLRjCcsICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnXSkKCgpjbGFzcyBGbG93RG9jU2NyZWVuKERvY3NMaXN0U2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKICAgIHByb2Nlc3NfbmFtZSA9ICfQodCx0L7RgCDQqNCaJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkZsb3dEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNlcnZpY2UuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAn0KPQtNCw0LvQuNGC0Yw70J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIGFyZ3MgPSBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9wdXRfZGF0YSgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCcsIGFyZ3MpCiAgICAgICAgICAgICMgc2NyZWVuOiBGbG93RG9jRGV0YWlsc1NjcmVlbiA9IEZsb3dEb2NEZXRhaWxzU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgICAgICMgc2NyZWVuLnNob3coYXJncz1hcmdzKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/Qu9C40YLQutC4JykgICMgZmluaXNoX3Byb2Nlc3MoKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnZG9jX3R5cGVfY2xpY2snOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV9jbGVhcl9iYXJjb2RlX2RhdGEnKToKICAgICAgICAgICAgaWRfZG9jID0gc2VsZi5nZXRfaWRfZG9jKCkKICAgICAgICAgICAgcmVzID0gc2VsZi5fY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChpZF9kb2MpCiAgICAgICAgICAgIGlmIHJlcy5nZXQoJ3Jlc3VsdCcpOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JLRgdC1INGI0YLRgNC40YXQutC+0LTRiyDRg9C00LDQu9C10L3RiyDQuNC3INC00L7QutGD0LzQtdC90YLQsCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQn9GA0Lgg0L7Rh9C40YHRgtC60LUg0LTQsNC90L3Ri9GFINCy0L7Qt9C90LjQutC70LAg0L7RiNC40LHQutCwLicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhyZXMuZ2V0KCdlcnJvcicpKQoKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBEb2NzTGlzdCBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IERvY0RldGFpbHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBEb2NEZXRhaWxzU2NyZWVuKFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzPU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCiAgICAgICAgc2VsZi5iYXJjb2RlX3dvcmtlciA9IE5vbmUKICAgICAgICBzZWxmLmlkX2RvYyA9IHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gRG9jU2VydmljZShzZWxmLmlkX2RvYykKICAgICAgICBzZWxmLml0ZW1zX29uX3BhZ2UgPSAyMAogICAgICAgIHNlbGYucXVldWVfc2VydmljZSA9IFNjYW5uaW5nUXVldWVTZXJ2aWNlKCkKICAgICAgICBzZWxmLmRvY19yb3dzID0gTm9uZQogICAgICAgIHNlbGYudGFibGVfZGF0YSA9IFtdCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIm5leHRfcGFnZSI6CiAgICAgICAgICAgIHNlbGYuX25leHRfcGFnZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJldmlvdXNfcGFnZSc6CiAgICAgICAgICAgIHNlbGYuX3ByZXZpb3VzX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdpdGVtc19vbl9wYWdlX2NsaWNrJzoKICAgICAgICAgICAgc2VsZi5fc2V0X2l0ZW1zX29uX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsICcxJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Jvd3NfZmlsdGVyJywgJzEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29mZic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTZWFyY2hTdHJpbmcnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIlNlYXJjaCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgJzEnKQogICAgICAgICAgICBzZWxmLl9vbl9zdGFydCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9iYXJjb2Rlcyc6CiAgICAgICAgICAgIHNlbGYuX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2V0VGl0bGUnLCBzZWxmLmhhc2hfbWFwWyJkb2NfdHlwZSJdKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgbGFzdF9zY2FubmVkX2RldGFpbHMgPSBzZWxmLl9nZXRfZG9jX2RldGFpbHNfZGF0YShsYXN0X3NjYW5uZWQ9VHJ1ZSkKICAgICAgICBsYXN0X3NjYW5uZWRfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShsYXN0X3NjYW5uZWRfZGV0YWlscykKICAgICAgICBsYXN0X3NjYW5uZWRfaXRlbSA9IGxhc3Rfc2Nhbm5lZF9kYXRhWzFdIGlmIGxlbihsYXN0X3NjYW5uZWRfZGF0YSkgPj0gMiBlbHNlIE5vbmUKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX2dldF9kb2NfZGV0YWlsc19kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIGlmIHRhYmxlX2RhdGEgYW5kIGxhc3Rfc2Nhbm5lZF9pdGVtOgogICAgICAgICAgICB0YWJsZV9kYXRhLmluc2VydCgxLCBsYXN0X3NjYW5uZWRfaXRlbSkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpID09ICcxJzoKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEucG9wKDEpCiAgICAgICAgICAgIHRhYmxlX2RhdGFbMV0gPSBsYXN0X3NjYW5uZWRfaXRlbQogICAgICAgIHNlbGYudGFibGVfZGF0YSA9IHRhYmxlX2RhdGEKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2RvY190YWJsZV92aWV3KHRhYmxlX2RhdGE9dGFibGVfZGF0YSkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnaXRlbXNfb25fcGFnZV9zZWxlY3QnXSA9ICcyMDs0MDs2MCcKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdoaWdobGlnaHQnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hpZ2hsaWdodCcsIEZhbHNlKQogICAgICAgICAgICAjIHNlbGYuZW5hYmxlX2hpZ2hsaWdodCh0YWJsZV92aWV3LmN1c3RvbXRhYmxlKQogICAgICAgICAgICAjIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdoaWdobGlnaHRfc2Nhbm5lZF9pdGVtJykKCiAgICAgICAgaWYgZG9jX2RldGFpbHM6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3RhYmxlX2xpbmVzX3F0dHknXSA9IGxlbihkb2NfZGV0YWlscykKICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBzdW0oCiAgICAgICAgICAgICAgICBbc2VsZi5fZm9ybWF0X3RvX2Zsb2F0KHN0cihpdGVtWydxdHR5X3BsYW4nXSkpIGZvciBpdGVtIGluIGRvY19kZXRhaWxzIGlmIGl0ZW1bJ3F0dHlfcGxhbiddXSkgPiAwCiAgICAgICAgICAgICMgaGF2ZV96ZXJvX3BsYW4gPSBub3QgaGF2ZV9xdHR5X3BsYW4KICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBUcnVlCiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gc2VsZi5fZ2V0X2hhdmVfbWFya19wbGFuKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnaGF2ZV9xdHR5X3BsYW4nXSA9IGhhdmVfcXR0eV9wbGFuCiAgICAgICAgc2VsZi5oYXNoX21hcFsnaGF2ZV96ZXJvX3BsYW4nXSA9IGhhdmVfemVyb19wbGFuCiAgICAgICAgc2VsZi5oYXNoX21hcFsnaGF2ZV9tYXJrX3BsYW4nXSA9IGhhdmVfbWFya19wbGFuCgogICAgICAgIGNvbnRyb2wgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY192YWx1ZSgnY29udHJvbCcsIHNlbGYuaWRfZG9jKSBub3QgaW4gKDAsICcwJywgJ2ZhbHNlJywgJ0ZhbHNlJywgTm9uZSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydjb250cm9sJ10gPSBjb250cm9sCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3JldHVybl9zZWxlY3RlZF9kYXRhJ10gPSAnJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJkb2NfZ29vZHNfdGFibGUiLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKCiAgICBkZWYgX2l0ZW1fYmFyY29kZV9zY2FubmVkKHNlbGYpOgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ZsZF9iYXJjb2RlJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykKCiAgICAgICAgaWYgbm90IGJhcmNvZGU6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gQmFyY29kZVdvcmtlcihpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKipzZWxmLl9nZXRfYmFyY29kZV9wcm9jZXNzX3BhcmFtcygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZV9zY2FubmluZ19xdWV1ZT1UcnVlKQogICAgICAgIHJlc3VsdCA9IHNlbGYuYmFyY29kZV93b3JrZXIucHJvY2Vzc190aGVfYmFyY29kZShiYXJjb2RlKQogICAgICAgIGlmIHJlc3VsdC5lcnJvcjoKICAgICAgICAgICAgc2VsZi5fcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUocmVzdWx0KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0LmVycm9yCgogICAgZGVmIF9nZXRfYmFyY29kZV9wcm9jZXNzX3BhcmFtcyhzZWxmKToKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnaGF2ZV9xdHR5X3BsYW4nOiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdoYXZlX3F0dHlfcGxhbicpLAogICAgICAgICAgICAnaGF2ZV96ZXJvX3BsYW4nOiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdoYXZlX3plcm9fcGxhbicpLAogICAgICAgICAgICAnaGF2ZV9tYXJrX3BsYW4nOiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdoYXZlX21hcmtfcGxhbicpLAogICAgICAgICAgICAnY29udHJvbCc6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2NvbnRyb2wnKQogICAgICAgIH0KCiAgICBkZWYgX3Byb2Nlc3NfZXJyb3Jfc2Nhbl9iYXJjb2RlKHNlbGYsIHNjYW5fcmVzdWx0KToKICAgICAgICBpZiBzY2FuX3Jlc3VsdC5lcnJvciA9PSAndXNlX3Nlcmllcyc6CiAgICAgICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnMuYXBwZW5kKAogICAgICAgICAgICAgICAgbGFtYmRhOiBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2Nhbl9yZXN1bHQucm93X2tleSkKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydChzZWxmKToKICAgICAgICBfdmFycyA9IFsnd2FyZWhvdXNlJywgJ2NvdW50cmFnZW50J10KCiAgICAgICAgZm9yIHYgaW4gX3ZhcnM6CiAgICAgICAgICAgIG5hbWUgPSBmJ1Nob3dfe3Z9JwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW25hbWVdID0gJzEnIGlmIHNlbGYuaGFzaF9tYXBbdl0gZWxzZSAnLTEnCgogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X2lucHV0IiwgJzEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnLTEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9ub3RlIiwgJy0xJyBpZiBhbGxvd19mYWN0X2lucHV0IGVsc2UgJzEnKQoKICAgIGRlZiBfZ2V0X2RvY19kZXRhaWxzX2RhdGEoc2VsZiwgbGFzdF9zY2FubmVkPUZhbHNlKToKICAgICAgICBzZWxmLl9jaGVja19wcmV2aW91c19wYWdlKCkKICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpCiAgICAgICAgcm93X2ZpbHRlcnMgPSBzZWxmLmhhc2hfbWFwLmdldCgncm93c19maWx0ZXInKQogICAgICAgIHNlYXJjaF9zdHJpbmcgPSBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ1NlYXJjaFN0cmluZycpIGVsc2UgTm9uZQogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9IG5vQ2xhc3MoJ2FydGljbGVzX29jcl9uY2wnKS5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfZGF0YSgKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICBmaXJzdF9lbGVtPTAgaWYgbGFzdF9zY2FubmVkIGVsc2UgZmlyc3RfZWxlbWVudCwKICAgICAgICAgICAgaXRlbXNfb25fcGFnZT0xIGlmIGxhc3Rfc2Nhbm5lZCBlbHNlIHNlbGYuaXRlbXNfb25fcGFnZSwKICAgICAgICAgICAgYXJ0aWNsZXNfbGlzdD1qc29uLmxvYWRzKGZpbmRlZF9hcnRpY2xlcykgaWYgZmluZGVkX2FydGljbGVzIGVsc2UgTm9uZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM9cm93X2ZpbHRlcnMsCiAgICAgICAgICAgIHNlYXJjaF9zdHJpbmc9c2VhcmNoX3N0cmluZwogICAgICAgICkKICAgICAgICBzZWxmLmRvY19yb3dzID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfZGV0YWlsc19yb3dzX2NvdW50KAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGFydGljbGVzX2xpc3Q9anNvbi5sb2FkcyhmaW5kZWRfYXJ0aWNsZXMpIGlmIGZpbmRlZF9hcnRpY2xlcyBlbHNlIE5vbmUsCiAgICAgICAgICAgIHJvd19maWx0ZXJzPXJvd19maWx0ZXJzLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPXNlYXJjaF9zdHJpbmcKICAgICAgICApCgogICAgICAgIGlmIG5vdCBsYXN0X3NjYW5uZWQ6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX25leHRfcGFnZShsZW4oZGF0YSkpCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgX25leHRfcGFnZShzZWxmKToKICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpICsgc2VsZi5pdGVtc19vbl9wYWdlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCBzdHIoZmlyc3RfZWxlbWVudCkpCiAgICAgICAgY3VycmVudF9wYWdlID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3BhZ2UnKSkgKyAxIG9yIDEKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgc3RyKGN1cnJlbnRfcGFnZSkpCgogICAgZGVmIF9wcmV2aW91c19wYWdlKHNlbGYpOgogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkgLSBzZWxmLml0ZW1zX29uX3BhZ2UKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsIHN0cihmaXJzdF9lbGVtZW50KSkKICAgICAgICBjdXJyZW50X3BhZ2UgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpKSAtIDEgb3IgMQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCBzdHIoY3VycmVudF9wYWdlKSkKCiAgICBkZWYgX2NoZWNrX3ByZXZpb3VzX3BhZ2Uoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKToKICAgICAgICAgICAgZmlyc3RfZWxlbWVudCA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKQogICAgICAgICAgICBpZiBmaXJzdF9lbGVtZW50ID4gMDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3ByZXZpb3VzX3BhZ2UiLCAiMSIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgJzEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3ByZXZpb3VzX3BhZ2UiLCAiMCIpCgogICAgZGVmIF9jaGVja19uZXh0X3BhZ2Uoc2VsZiwgZWxlbXNfY291bnQpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmNvbnRhaW5zS2V5KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgIHBhZ2VfZWxlbXNfc3VtID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpICsgc2VsZi5pdGVtc19vbl9wYWdlCiAgICAgICAgaWYgcGFnZV9lbGVtc19zdW0gPCBzZWxmLmRvY19yb3dzOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19uZXh0X3BhZ2UiLCAiMSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfbmV4dF9wYWdlIiwgIjAiKQoKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2hvd19wcmV2aW91c19wYWdlJykgPT0gJzAnIGFuZCBzZWxmLmhhc2hfbWFwLmdldCgnU2hvd19uZXh0X3BhZ2UnKSA9PSAnMCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3BhZ2luYXRpb25fY29udHJvbHMiLCAiLTEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3BhZ2luYXRpb25fY29udHJvbHMiLCAiMSIpCgogICAgZGVmIF9zZXRfaXRlbXNfb25fcGFnZShzZWxmKToKICAgICAgICB2YWx1ZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtc19vbl9wYWdlX2NsaWNrJykKICAgICAgICBzZWxmLml0ZW1zX29uX3BhZ2UgPSBpbnQodmFsdWUpCiAgICAgICAgbmV3X3BhZ2UgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkvL3NlbGYuaXRlbXNfb25fcGFnZSArIDEKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgbmV3X3BhZ2UpCiAgICAgICAgbmV3X2N1cnJlbnRfZmlyc3QgPSBzZWxmLml0ZW1zX29uX3BhZ2UgKiAobmV3X3BhZ2UgLSAxKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgc3RyKG5ld19jdXJyZW50X2ZpcnN0KSkKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBkb2NfZGV0YWlscyk6CiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICByb3dfZmlsdGVyID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgncm93c19maWx0ZXInKQoKICAgICAgICBmb3IgcmVjb3JkIGluIGRvY19kZXRhaWxzOgogICAgICAgICAgICBpZiByb3dfZmlsdGVyIGFuZCByZWNvcmRbJ2RfcXR0eSddID09IHJlY29yZFsncXR0eV9wbGFuJ106CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgcGljID0gJyNmMDJhJyBpZiByZWNvcmRbJ0lzRG9uZSddICE9IDAgZWxzZSAnI2YwMGMnCiAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eSddID09IDAgYW5kIHJlY29yZFsncXR0eV9wbGFuJ10gPT0gMDoKICAgICAgICAgICAgICAgIHBpYyA9ICcnCgogICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIocmVjb3JkWydpZCddKSwKICAgICAgICAgICAgICAgICdnb29kX25hbWUnOiBzdHIocmVjb3JkWydnb29kX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IHN0cihyZWNvcmRbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaWRfcHJvcGVydGllcyc6IHN0cihyZWNvcmRbJ2lkX3Byb3BlcnRpZXMnXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllc19uYW1lJzogc3RyKHJlY29yZFsncHJvcGVydGllc19uYW1lJ10gb3IgJycpLAogICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHN0cihyZWNvcmRbJ2lkX3NlcmllcyddKSwKICAgICAgICAgICAgICAgICdzZXJpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Nlcmllc19uYW1lJ10gb3IgJycpLAogICAgICAgICAgICAgICAgJ2lkX3VuaXQnOiBzdHIocmVjb3JkWydpZF91bml0J10pLAogICAgICAgICAgICAgICAgJ3VuaXRzX25hbWUnOiBzdHIocmVjb3JkWyd1bml0c19uYW1lJ10gb3IgJycpLAogICAgICAgICAgICAgICAgJ2NvZGVfYXJ0JzogJ9Ca0L7QtDogJyArIHN0cihyZWNvcmRbJ2NvZGUnXSksCiAgICAgICAgICAgICAgICAnYXJ0Jzogc3RyKHJlY29yZFsnYXJ0J10pLAogICAgICAgICAgICAgICAgJ3ByaWNlJzogc3RyKHJlY29yZFsncHJpY2UnXSBpZiByZWNvcmRbJ3ByaWNlJ10gaXMgbm90IE5vbmUgZWxzZSAwKSwKICAgICAgICAgICAgICAgICdwcmljZV9uYW1lJzogc3RyKHJlY29yZFsncHJpY2VfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljLAogICAgICAgICAgICAgICAgJ3VzZV9zZXJpZXMnOiBzdHIocmVjb3JkWyd1c2Vfc2VyaWVzJ10pCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3BzID0gWwogICAgICAgICAgICAgICAgJ3t9ICcuZm9ybWF0KHByb2R1Y3Rfcm93WydhcnQnXSkgaWYgcHJvZHVjdF9yb3dbJ2FydCddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAnKHt9KSAnLmZvcm1hdChwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93Wydwcm9wZXJ0aWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJ3t9Jy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Nlcmllc19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAnLCB7fScuZm9ybWF0KHByb2R1Y3Rfcm93Wyd1bml0c19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93Wyd1bml0c19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgXQogICAgICAgICAgICBwcm9kdWN0X3Jvd1snZ29vZF9pbmZvJ10gPSAnJy5qb2luKHByb3BzKQoKICAgICAgICAgICAgZm9yIGtleSBpbiBbJ3F0dHknLCAnZF9xdHR5JywgJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgdmFsdWUgPSBzZWxmLl9mb3JtYXRfdG9fZmxvYXQoc3RyKHJlY29yZC5nZXQoa2V5LCAwLjApIG9yIDAuMCkpCiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1trZXldID0gc3RyKGludCh2YWx1ZSkpIGlmIHZhbHVlLmlzX2ludGVnZXIoKSBlbHNlIHZhbHVlCgogICAgICAgICAgICB1c2Vfc2VyaWVzID0gYm9vbChpbnQocHJvZHVjdF9yb3cuZ2V0KCd1c2Vfc2VyaWVzJywgMCkpKQogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpCiAgICAgICAgICAgIHNlbGYuX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihwcm9kdWN0X3JvdykKCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0J3QsNC30LLQsNC90LjQtScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0zCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0J/Qu9Cw0L0nKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ck0LDQutGCJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMob3ZlcnJpZGVfc2VhcmNoPVRydWUpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmLCB1c2Vfc2VyaWVzPUZhbHNlLCB1c2VfbWFyaz1GYWxzZSk6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlBpY3R1cmUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXN0YXRpY19kYXRhLnNuX2ljb25fZ3JlZW4gaWYgdXNlX3NlcmllcyBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPTE2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9MTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlBpY3R1cmUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXN0YXRpY19kYXRhLm1hcmtfZ3JlZW4gaWYgdXNlX21hcmsgZWxzZSBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0xNiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PTEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBhZGRpbmcgPSAxNgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAoKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTMsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZF9xdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfc2V0X2JhY2tncm91bmRfcm93X2NvbG9yKHNlbGYsIHByb2R1Y3Rfcm93KToKICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gJyNGRkZGRkYnCiAgICAgICAgcXR0eSwgcXR0eV9wbGFuID0gZmxvYXQocHJvZHVjdF9yb3dbJ2RfcXR0eSddKSwgZmxvYXQocHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddKQogICAgICAgIGlmIHF0dHlfcGxhbiA+IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZCRTlFNyIKCiAgICAgICAgZWxpZiBxdHR5X3BsYW4gPCBxdHR5OgogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gIiNGRkY5QzQiCgogICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZF9jb2xvcgoKICAgIGRlZiBfYWRkZWRfZ29vZHNfaGFzX2tleShzZWxmLCBrZXkpOgogICAgICAgIGFkZGVkX2dvb2RzID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignYWRkZWRfZ29vZHMnKQogICAgICAgIHJlc3VsdCA9IEZhbHNlCgogICAgICAgIGlmIGFkZGVkX2dvb2RzOgogICAgICAgICAgICBhZGRlZF9nb29kc19kb2MgPSBhZGRlZF9nb29kcy5nZXQoc2VsZi5pZF9kb2MsIFtdKQogICAgICAgICAgICByZXN1bHQgPSBzdHIoa2V5KSBpbiBbc3RyKGl0ZW0pIGZvciBpdGVtIGluIGFkZGVkX2dvb2RzX2RvY10KICAgICAgICAgICAgc2VsZi50b2FzdChyZXN1bHQpCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZW5hYmxlX2hpZ2hsaWdodChjdXN0b210YWJsZSk6CiAgICAgICAgY3VzdG9tdGFibGVbJ3RhYmxlZGF0YSddWzFdWydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gJyNGMEY4RkYnCgogICAgZGVmIGRpc2FibGVfaGlnaGxpZ2h0KHNlbGYpOgogICAgICAgIHNlbGYuX29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX2ZpbGxfbm9uZV92YWx1ZXMoc2VsZiwgZGF0YSwga2V5cywgZGVmYXVsdD0nJyk6CiAgICAgICAgbm9uZV9saXN0ID0gW05vbmUsICdOb25lJ10KICAgICAgICBmb3Iga2V5IGluIGtleXM6CiAgICAgICAgICAgIGRhdGFba2V5XSA9IGRlZmF1bHQgaWYgZGF0YVtrZXldIGluIG5vbmVfbGlzdCBlbHNlIGRhdGFba2V5XQoKICAgIGRlZiBzY2FuX2Vycm9yX3NvdW5kKHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdzY2FuX2Vycm9yJykgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdzY2FuX2Vycm9yJykgIT0gIk5vbmUiOgogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnc2Nhbl9lcnJvcicpIGluIFsnUXVhbnRpdHlQbGFuUmVhY2hlZCcsICdBbHJlYWR5U2Nhbm5lZCcsICdaZXJvX3BsYW5fZXJyb3InXToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCd3YXJuaW5nJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9mb3JtYXRfdG9fZmxvYXQoc2VsZiwgdmFsdWU6IHN0cik6CiAgICAgICAgcmV0dXJuIGZsb2F0KHZhbHVlLnJlcGxhY2UodSdceGEwJywgdScnKS5yZXBsYWNlKCcsJywgJy4nKSBvciAnMC4wJykKCiAgICBkZWYgX2dldF9oYXZlX21hcmtfcGxhbihzZWxmKToKICAgICAgICBjb3VudCA9IHNlbGYuc2VydmljZS5nZXRfY291bnRfbWFya19jb2RlcyhpZF9kb2M9c2VsZi5pZF9kb2MpCiAgICAgICAgcmV0dXJuIGNvdW50ID4gMAoKICAgIGRlZiBfb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYsIGRvY19yb3dfa2V5KToKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgICAgICd1c2VfYWRyX2RvY3NfdGFibGVzJzogJzAnCiAgICAgICAgfQoKICAgICAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICBTZXJpZXNTZWxlY3RTY3JlZW4sCiAgICAgICAgICAgIHNjcmVlbl92YWx1ZXM9c2NyZWVuX3ZhbHVlcwogICAgICAgICkKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9zaG93X2RpYWxvZ19pbnB1dF9iYXJjb2RlKHNlbGYpOgogICAgICAgIGxveWF1dCA9ICcnJ3sKICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAZmxkX2JhcmNvZGUiLAogICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICJmbGRfYmFyY29kZSIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiRWRpdFRleHROdW1lcmljIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdCiAgICAgICAgfScnJwogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJywgdGl0bGU9ItCS0LLQtdC00LjRgtC1INGI0YLRgNC40YXQutC+0LQg0YLQvtCy0LDRgNCwIiwgZGlhbG9nX2xheW91dD1sb3lhdXQpCgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgICAgIHNlbGYuVGV4dFNpemUgPSAnMTUnCiAgICAgICAgICAgIHNlbGYuVGV4dEJvbGQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAnbWF0Y2hfcGFyZW50JwogICAgICAgICAgICBzZWxmLlZhbHVlID0gdmFsdWUKCiAgICBjbGFzcyBMaW5lYXJMYXlvdXQod2lkZ2V0cy5MaW5lYXJMYXlvdXQpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICdob3Jpem9udGFsJwogICAgICAgICAgICBzZWxmLmhlaWdodCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLlN0cm9rZVdpZHRoID0gMQoKCmNsYXNzIEdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4oRG9jRGV0YWlsc1NjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiycKICAgIHByb2Nlc3NfbmFtZSA9ICfQk9GA0YPQv9C/0L7QstCw0Y8g0L7QsdGA0LDQsdC+0YLQutCwJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaWRfZG9jJzogaGFzaF9tYXBbJ2lkX2RvYyddLAogICAgICAgICAgICAnZG9jX3R5cGUnOiBoYXNoX21hcFsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgJ2RvY19uJzogaGFzaF9tYXBbJ2RvY19uJ10sCiAgICAgICAgICAgICdkb2NfZGF0ZSc6IGhhc2hfbWFwWydkb2NfZGF0ZSddLAogICAgICAgICAgICAnd2FyZWhvdXNlJzogaGFzaF9tYXBbJ3dhcmVob3VzZSddLAogICAgICAgICAgICAnY291bnRyYWdlbnQnOiBoYXNoX21hcFsnY291bnRyYWdlbnQnXSwKICAgICAgICB9CgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICd0cnVlJykKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xpc3RlbmVyJ10KCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuX3J1bl9wcm9ncmVzc19iYXJjb2RlX3NjYW5uaW5nKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJyk6CiAgICAgICAgICAgIHNlbGYuX3J1bl9wcm9ncmVzc19iYXJjb2RlX3NjYW5uaW5nKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ1JldHJ5Q29ubmVjdGlvbicpOgogICAgICAgICAgICBzZWxmLl9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZygpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X25lZ2F0aXZlKCdSZXRyeUNvbm5lY3Rpb24nKToKICAgICAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKEZhbHNlKQogICAgICAgIGVsaWYgbGlzdGVuZXIgaW4gWydPTl9CQUNLX1BSRVNTRUQnLCAnQkFDS19CVVRUT04nXToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF90aW1lcl91cGRhdGUnLCAnZmFsc2UnKQoKICAgIGRlZiBfcnVuX3Byb2dyZXNzX2JhcmNvZGVfc2Nhbm5pbmcoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfcHJvZ3Jlc3MoJ2RvY19kZXRhaWxzX2JlZm9yZV9wcm9jZXNzX2JhcmNvZGUnKQoKICAgIGRlZiBiZWZvcmVfcHJvY2Vzc19iYXJjb2RlKHNlbGYpOgogICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhUcnVlKQogICAgICAgIGlmIHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgc2VsZi5fdXBkYXRlX2RvY3VtZW50X2RhdGEoKQogICAgICAgICAgICBzY2FuX3Jlc3VsdCA9IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCgpCgogICAgICAgICAgICBpZiBzY2FuX3Jlc3VsdC5nZXQoJ0Vycm9yJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudCgnZG9jX3NjYW5fZXJyb3Jfc291bmQnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ2RvY19ydW5fcG9zdF9iYXJjb2RlX3NjYW5uZWQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdF9leGVjdXRlX21ldGhvZD0nZG9jX3NjYW5fZXJyb3Jfc291bmQnKQogICAgICAgICAgICBzZWxmLnNldF9zY2FubmVyX2xvY2soRmFsc2UpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgnNzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKGxpc3RlbmVyPSJSZXRyeUNvbm5lY3Rpb24iLCB0aXRsZT0n0J7RgtGB0YPRgtGB0YLQstGD0LXRgiDRgdC+0LXQtNC40L3QtdC90LjQtSDRgSDRgdC10YDQstC10YDQvtC8JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zPVsi0J/QvtCy0YLQvtGA0LjRgtGMIiwgItCe0YLQvNC10L3QsCJdKQoKICAgIGRlZiBfdXBkYXRlX2RvY3VtZW50X2RhdGEoc2VsZik6CiAgICAgICAgZG9jc19kYXRhID0gc2VsZi5fZ2V0X3VwZGF0ZV9jdXJyZW50X2RvY19kYXRhKCkKICAgICAgICBpZiBkb2NzX2RhdGE6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZGF0YV9mcm9tX2pzb24oZG9jc19kYXRhKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKAogICAgICAgICAgICAgICAgICAgIGVycm9yX3R5cGU9Ikdyb3VwU2NhbiIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dD1lLAogICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQt9Cw0L/QuNGB0Lgg0LTQvtC60YPQvNC10L3RgtCwJykKCiAgICBkZWYgX2dldF91cGRhdGVfY3VycmVudF9kb2NfZGF0YShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS5nZXRfZGF0YSgpCiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgoKICAgICAgICAgICAgaWYgYW5zd2VyLnVuYXV0aG9yaXplZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDQsNCy0YLQvtGA0LjQt9Cw0YbQuNC4INGB0LXRgNCy0LXRgNCwIDHQoScpCiAgICAgICAgICAgIGVsaWYgYW5zd2VyLmZvcmJpZGRlbjoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKGFuc3dlci5lcnJvcl90ZXh0LCB0aXRsZT0n0J7RiNC40LHQutCwINC+0LHQvNC10L3QsCcpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGFuc3dlci5lcnJvcl90ZXh0KQogICAgICAgICAgICBlbGlmIGFuc3dlci5lcnJvcjoKICAgICAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1hbnN3ZXIuZXJyb3JfdGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBhbnN3ZXIuZGF0YQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKEZhbHNlKQoKICAgIGRlZiBwb3N0X2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdiYXJjb2RlX3NjYW5uZWQnKToKICAgICAgICAgICAgYW5zd2VyID0gTm9uZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLl9wb3N0X2dvb2RzX3RvX3NlcnZlcigpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1lLmFyZ3NbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQvtGC0L/RgNCw0LLQutC4INC00LDQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0LAnKQogICAgICAgICAgICBpZiBhbnN3ZXIgYW5kIGFuc3dlci5nZXQoJ0Vycm9yJykgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhhbnN3ZXIuZ2V0KCdFcnJvcicpKQoKICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCgogICAgZGVmIF9wb3N0X2dvb2RzX3RvX3NlcnZlcihzZWxmKToKICAgICAgICByZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2xhc3RfZWRpdGVkX2dvb2RzKHRvX2pzb249RmFsc2UpCiAgICAgICAgaHNfc2VydmljZSA9IEhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCgogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzLCBkaWN0KSBhbmQgcmVzLmdldCgnRXJyb3InKToKICAgICAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWUsICdFcnJvcic6IHJlcy5nZXQoJ0Vycm9yJyl9CiAgICAgICAgICAgIHJldHVybiBhbnN3ZXIKICAgICAgICBlbGlmIHJlczoKICAgICAgICAgICAgaHNfc2VydmljZS5zZW5kX2RvY3VtZW50cyhyZXMpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWFuc3dlci5lcnJvcl90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0L7RgtC/0YDQsNCy0LrQuCDQtNCw0L3QvdGL0YUg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX3NlbnRfZGF0YShyZXMpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWUuYXJnc1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQvtGC0L/RgNCw0LLQutC4INC00LDQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0LAnKQoKICAgICAgICAjINC/0L7QutCwINGH0YLQviDQvtGC0LrQu9GO0YfQuNC7INC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0LkgZ2V0LdC30LDQv9GA0L7RgSwg0L/RgNC+0LLQtdGA0Y/QtdC8INC/0YDQvtC40LfQstC+0LTQuNGC0LXQu9GM0L3QvtGB0YLRjAoKICAgICAgICAjIGRvY3NfZGF0YSA9IGhzX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICMKICAgICAgICAjIGlmIGRvY3NfZGF0YS5nZXQoJ2RhdGEnKToKICAgICAgICAjICAgICB0cnk6CiAgICAgICAgIyAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZGF0YV9mcm9tX2pzb24oZG9jc19kYXRhWydkYXRhJ10pCiAgICAgICAgIyAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICMgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLmh0dHBfYW5zd2VyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPXNlbGYuaHNfc2VydmljZS51cmwpCgogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIHNldF9zY2FubmVyX2xvY2soc2VsZiwgdmFsdWU6IGJvb2wpOgogICAgICAgIGlmICd1cm92bycgaW4gc2VsZi5oYXNoX21hcC5nZXQoJ0RFVklDRV9NT0RFTCcpLmxvd2VyKCk6CiAgICAgICAgICAgIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcih2YWx1ZSkKCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gRmFsc2UKCgpjbGFzcyBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3KERvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UgPSBTY2FubmluZ1F1ZXVlU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0ge30KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICd0cnVlJykKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3N0b3Bfc3luY19kb2MnKSBhbmQgXAogICAgICAgICAgICAgICAgbm90IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKToKICAgICAgICAgICAgc2VsZi5fc3luY19kb2MoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3N5bmNfZG9jJywgJ3RydWUnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBsYW1iZGE6IHNlbGYuX2dyb3VwX2JhcmNvZGVfc2Nhbm5lZChzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKSksCiAgICAgICAgICAgICdidG5fYmFyY29kZXMnOiBsYW1iZGE6IHNlbGYuX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoKSwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuZ29fYmFjaywKICAgICAgICAgICAgJ3N5bmNfZG9jJzogc2VsZi5fc3luY19kb2MsCiAgICAgICAgICAgICdzZW5kX2FsbF9zY2FuX2xpbmVzJzogc2VsZi5zZW5kX2FsbF9zY2FuX2xpbmVzX2NhbGxfaGFuZGxlciwKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljawogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnKToKICAgICAgICAgICAgc2VsZi5fZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYuaGFzaF9tYXAuZ2V0KCdmbGRfYmFyY29kZScpKQoKICAgIGRlZiBfZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5iYXJjb2RlX3dvcmtlciA9IEJhcmNvZGVXb3JrZXIoaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2Vfc2Nhbm5pbmdfcXVldWU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cF9zY2FuPVRydWUpCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCgogICAgICAgIGlmIHJlc3VsdC5lcnJvcjoKICAgICAgICAgICAgc2VsZi5fcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUocmVzdWx0KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0LmVycm9yCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdzZW5kX2RvY3VtZW50X2xpbmVzX3J1bm5pbmcnKSBhbmQgXAogICAgICAgICAgICAgICAgbm90IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3NlbmRfcG9zdF9saW5lc19kYXRhJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdF9leGVjdXRlX21ldGhvZD0nYWZ0ZXJfc2VuZF9wb3N0X2xpbmVzX2RhdGEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VuZF9kb2N1bWVudF9saW5lc19ydW5uaW5nJywgVHJ1ZSkKCiAgICBkZWYgZ29fYmFjayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc3RvcF9zeW5jX2RvYycpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3N0b3BfdGltZXJfdXBkYXRlJywgJ2ZhbHNlJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQlNC+0LrRg9C80LXQvdGC0YsnKQoKICAgIGRlZiBzZW5kX3Bvc3RfbGluZXNfZGF0YShzZWxmLCBzZW50PU5vbmUpOgogICAgICAgIHNlbmRfZGF0YSA9IHNlbGYucXVldWVfc2VydmljZS5nZXRfZG9jdW1lbnRfbGluZXMoc2VsZi5pZF9kb2MsIHNlbnQ9c2VudCkKICAgICAgICB2YWxpZGF0ZWRfc2VuZF9kYXRhID0gbGlzdCgoZGljdCgoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gZC5pdGVtcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBbJ3Jvd19rZXknLCAnc2VudCddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZCBpbiBzZW5kX2RhdGEpKQogICAgICAgIGlmIG5vdCB2YWxpZGF0ZWRfc2VuZF9kYXRhOgogICAgICAgICAgICB2YWxpZGF0ZWRfc2VuZF9kYXRhID0gW3t9XQoKICAgICAgICBpZiBzZW50IGlzIEZhbHNlOgogICAgICAgICAgICBodHRwX3Jlc3VsdCA9IHNlbGYuaHNfc2VydmljZS5zZW5kX2RvY3VtZW50X2xpbmVzKHNlbGYuaWRfZG9jLCB2YWxpZGF0ZWRfc2VuZF9kYXRhLCB0aW1lb3V0PTgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaHR0cF9yZXN1bHQgPSBzZWxmLmhzX3NlcnZpY2Uuc2VuZF9hbGxfZG9jdW1lbnRfbGluZXMoc2VsZi5pZF9kb2MsIHZhbGlkYXRlZF9zZW5kX2RhdGEsIHRpbWVvdXQ9OCkKCiAgICAgICAgaWYgaHR0cF9yZXN1bHQuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKAogICAgICAgICAgICAgICAgZXJyb3JfdGV4dD0icmVzcG9uc2Ugc3RhdHVzIGNvZGUgIT0gMjAwIiwKICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDQv9GA0Lgg0L7RgtC/0YDQsNCy0LrQtSDQtNCw0L3QvdGL0YUg0LPRgNGD0L/Qv9C+0LLQvtCz0L4gJwogICAgICAgICAgICAgICAgICAgICfRgdC60LDQvdC40YDQvtCy0LDQvdC40Y8g0YLQvtCy0LDRgNCwJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgbm90IGh0dHBfcmVzdWx0LmRhdGEuZ2V0KCdkYXRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBmb3IgZWxlbWVudCBpbiBodHRwX3Jlc3VsdC5kYXRhWydkYXRhJ106CiAgICAgICAgICAgIHRhYmxlX2xpbmUgPSBzZWxmLmRiX3NlcnZpY2UuZ2V0X3RhYmxlX2xpbmUoJ1JTX2RvY3NfdGFibGUnLCBmaWx0ZXJzPXsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBlbGVtZW50WydpZF9kb2MnXSwKICAgICAgICAgICAgICAgICdpZF9nb29kJzogZWxlbWVudFsnaWRfZ29vZCddLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBlbGVtZW50WydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGVsZW1lbnRbJ2lkX3VuaXQnXX0pCiAgICAgICAgICAgIGlmIHRhYmxlX2xpbmU6CiAgICAgICAgICAgICAgICB0YWJsZV9saW5lWydxdHR5J10gPSBlbGVtZW50WydxdHR5J10KICAgICAgICAgICAgICAgIHRhYmxlX2xpbmVbJ3NlbnQnXSA9IDEKICAgICAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5yZXBsYWNlX29yX2NyZWF0ZV90YWJsZSgnUlNfZG9jc190YWJsZScsIHRhYmxlX2xpbmUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuZXdfdGFibGVfbGluZSA9IHNlbGYuY3JlYXRlX25ld190YWJsZV9saW5lKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUoJ1JTX2RvY3NfdGFibGUnLCBuZXdfdGFibGVfbGluZSkKCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlLnVwZGF0ZV9zZW50X2xpbmVzKHNlbmRfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VuZF9kb2N1bWVudF9saW5lc19ydW5uaW5nJywgRmFsc2UpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgc2VsZi5vbl9zdGFydCgpCgogICAgZGVmIGFmdGVyX3NlbmRfZGF0YShzZWxmKToKICAgICAgICBpZiBzZWxmLnF1ZXVlX3NlcnZpY2UuaGFzX3Vuc2VudF9saW5lcyhzZWxmLmlkX2RvYykgYW5kIHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3NlbmRfcG9zdF9saW5lc19kYXRhJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdF9leGVjdXRlX21ldGhvZD0nYWZ0ZXJfc2VuZF9wb3N0X2xpbmVzX2RhdGEnKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGVfbmV3X3RhYmxlX2xpbmUoZWxlbWVudCk6CiAgICAgICAgbmV3X3RhYmxlX2xpbmUgPSBlbGVtZW50CiAgICAgICAgZGVsIG5ld190YWJsZV9saW5lWyd0YWJsZV90eXBlJ10KICAgICAgICBuZXdfdGFibGVfbGluZS51cGRhdGUoeydkX3F0dHknOiBuZXdfdGFibGVfbGluZVsncXR0eSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6ICcnLCAnaWRfcHJpY2UnOiAnJywgJ3NlbnQnOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3F0dHlfcGxhbic6IE5vbmV9KQogICAgICAgIHJldHVybiBuZXdfdGFibGVfbGluZQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgJ2hhdmVfcXR0eV9wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV9xdHR5X3BsYW4nKSwKICAgICAgICAgICAgJ2hhdmVfemVyb19wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV96ZXJvX3BsYW4nKSwKICAgICAgICAgICAgJ2hhdmVfbWFya19wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV9tYXJrX3BsYW4nKSwKICAgICAgICAgICAgJ2NvbnRyb2wnOiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJykKICAgICAgICB9CgogICAgZGVmIF9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShzZWxmLCBzY2FuX3Jlc3VsdCk6CiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzY2FuX3Jlc3VsdC5kZXNjcmlwdGlvbikKICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9NAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpNCw0LrRgiDRg9GB0YLRgNC+0LnRgdGC0LLQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0J7QsdGJ0LjQuSDRhNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTQsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MiwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZF9xdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0yLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS5jb21tdW5pY2F0aW9uX3Rlc3QodGltZW91dD0xKQogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5IdHRwQW5zd2VyKAogICAgICAgICAgICAgICAgZXJyb3I9VHJ1ZSwKICAgICAgICAgICAgICAgIGVycm9yX3RleHQ9c3RyKGUuYXJnc1swXSksCiAgICAgICAgICAgICAgICBzdGF0dXNfY29kZT00MDQsCiAgICAgICAgICAgICAgICB1cmw9c2VsZi5oc19zZXJ2aWNlLnVybCkKCiAgICAgICAgcmV0dXJuIG5vdCBhbnN3ZXIuZXJyb3IKCiAgICBkZWYgX3N5bmNfZG9jKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfcHJvZ3Jlc3MoJ3NlbmRfcG9zdF9saW5lc19kYXRhJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC10YIg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCAx0KEnKQoKICAgIGRlZiBzZW5kX2FsbF9zY2FuX2xpbmVzX2NhbGxfaGFuZGxlcihzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X3Byb2dyZXNzKCdzZW5kX2FsbF9zY2FuX2xpbmVzJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC10YIg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCAx0KEnKQoKICAgIGRlZiBzZW5kX2FsbF9zY2FuX2xpbmVzX3J1bihzZWxmKToKICAgICAgICBzZWxmLnNlbmRfcG9zdF9saW5lc19kYXRhKCkKCiAgICBkZWYgc2VuZF91bnNlbnRfbGluZXNfcnVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VuZF9wb3N0X2xpbmVzX2RhdGEoc2VudD1GYWxzZSkKCiAgICBkZWYgX2NhcmRzX2NsaWNrKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAKCiAgICAgICAgY3VycmVudF9lbGVtID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJykpCiAgICAgICAgIyDQv9GA0Lgg0LrQu9C40LrQtSDQv9C+INGI0LDQv9C60LUg0YLQsNCx0LvQuNGG0Ysg0L/RgNC40LvQtdGC0LDQtdGCINC/0YPRgdGC0L7QuSDRgdC70L7QstCw0YDRjAogICAgICAgIGlmIG5vdCBjdXJyZW50X2VsZW06CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjdXJyZW50X3N0ciA9IHNlbGYuaGFzaF9tYXBbInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iXQogICAgICAgIHRhYmxlX2xpbmVzX3F0dHkgPSBzZWxmLmhhc2hfbWFwWyd0YWJsZV9saW5lc19xdHR5J10KICAgICAgICB0aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10pCiAgICAgICAgcHV0X2RhdGFfZGljdCA9IHsKICAgICAgICAgICAgJ0RvY19kYXRhJzogdGl0bGUsCiAgICAgICAgICAgICdHb29kJzogY3VycmVudF9lbGVtWydnb29kX25hbWUnXSwKICAgICAgICAgICAgJ2lkX2dvb2QnOiBjdXJyZW50X2VsZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBjdXJyZW50X2VsZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogY3VycmVudF9lbGVtWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICdnb29kX2FydCc6IGN1cnJlbnRfZWxlbVsnYXJ0J10sCiAgICAgICAgICAgICdnb29kX3NuJzogY3VycmVudF9lbGVtWydzZXJpZXNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9wcm9wZXJ0eSc6IGN1cnJlbnRfZWxlbVsncHJvcGVydGllc19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3ByaWNlJzogY3VycmVudF9lbGVtWydwcmljZSddLAogICAgICAgICAgICAnZ29vZF91bml0JzogY3VycmVudF9lbGVtWyd1bml0c19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3N0cic6IGYne2N1cnJlbnRfc3RyfSAvIHt0YWJsZV9saW5lc19xdHR5fScsCiAgICAgICAgICAgICdxdHR5X3BsYW4nOiBjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddLAogICAgICAgICAgICAnZ29vZF9wbGFuJzogY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2tleSc6IGN1cnJlbnRfZWxlbVsna2V5J10sCiAgICAgICAgICAgICdwcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSwKICAgICAgICAgICAgJ3ByaWNlX3R5cGUnOiBjdXJyZW50X2VsZW1bJ3ByaWNlX25hbWUnXSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoY3VycmVudF9lbGVtWydkX3F0dHknXSksCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IEdyb3VwU2Nhbkl0ZW1TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4uc2hvdyhhcmdzPXB1dF9kYXRhX2RpY3QpCgoKY2xhc3MgRG9jdW1lbnRzRG9jRGV0YWlsU2NyZWVuKERvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLl9vbl9zdGFydCgpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcFsnbGlzdGVuZXInXQogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGVjdGVkX2NhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZF9jYXJkX2RhdGE6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgKHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgICAgICAgICAgYW5kIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpKToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZG9jX3RhYmxlX3JvdygKICAgICAgICAgICAgICAgICAgICBkYXRhPXsnc2VudCc6IDAsICdkX3F0dHknOiBmbG9hdChzZWxlY3RlZF9jYXJkX2RhdGFbJ2RfcXR0eSddKSArIDEuMH0sCiAgICAgICAgICAgICAgICAgICAgcm93X2lkPWludChzZWxlY3RlZF9jYXJkX2RhdGFbJ2tleSddKSkKICAgICAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KAogICAgICAgICAgICAgICAgICAgIGYn0JDRgNGC0LjQutGD0Ls6IHtzZWxlY3RlZF9jYXJkX2RhdGFbImFydCJdfVxuJwogICAgICAgICAgICAgICAgICAgIGYne3NlbGVjdGVkX2NhcmRfZGF0YVsiZ29vZF9uYW1lIl19XG4nCiAgICAgICAgICAgICAgICAgICAgZid7c2VsZWN0ZWRfY2FyZF9kYXRhWyJwcm9wZXJ0aWVzX25hbWUiXX1cbicKICAgICAgICAgICAgICAgICAgICBmJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INGD0LLQtdC70LjRh9C10L3QviDQvdCwIDEnKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnZG9jX2dvb2RzX3RhYmxlJykKICAgICAgICAgICAgc2VsZi5fb3Blbl9nb29kc19zZWxlY3Rfc2NyZWVuKAogICAgICAgICAgICAgICAgaW50KHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J10pCiAgICAgICAgICAgICkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZScgb3Igc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdtb2RhbF9kaWFsb2dfaW5wdXRfYmFyY29kZScpOgogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICByZXMgPSBzZWxmLl9pdGVtX2JhcmNvZGVfc2Nhbm5lZCgpCiAgICAgICAgICAgICMgVE9ETyDRgSDRgNC10LfRg9C70YzRgtCw0YLQvtC8INC+0LHRgNCw0LHQvtGC0LrRgwoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZ29vZHNfb2NyJzoKICAgICAgICAgICAgYXJ0aWNsZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9hcnRpY2xlc19pbl9kb2N1bWVudCgpCiAgICAgICAgICAgIGlmIG5vdCBhcnRpY2xlczoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CSINC00L7QutGD0LzQtdC90YLQtSDQvtGC0YHRgtGD0YLRgdGC0LLRg9GO0YIg0LDRgNGC0LjQutGD0LvRiycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncyhhcnRpY2xlcz1hcnRpY2xlcykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1J1bkNWJywgJ9Cg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7QsicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0FjdGl2ZUNWJzoKICAgICAgICAgICAgaWYgbm90IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnKToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdidXR0b25fbWFuYWdlX2FydGljbGVzJykKICAgICAgICAgICAgZmluZGVkX2FydGljbGVzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgaWYgZmluZGVkX2FydGljbGVzIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkNGA0YLQuNC60YPQu9GLINC90LUg0L3QsNC50LTQtdC90YsnKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiBsaXN0ZW5lciBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdCQUNLX0JVVFRPTiddOgogICAgICAgICAgICBpZiBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKToKICAgICAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3Jvd3NfZmlsdGVyJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCAnMCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpdGVtc19vbl9wYWdlX2NsaWNrJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fdmVyaWZpZWQnKToKICAgICAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLm1hcmtfdmVyaWZpZWQoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kb2NfbWFya192ZXJpZmllZCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ2NvbmZpcm1fdmVyaWZpZWQnLCAn0JfQsNCy0LXRgNGI0LjRgtGMINC00L7QutGD0LzQtdC90YI/JywgWyfQlNCwJywgJ9Cd0LXRgiddKQoKICAgIGRlZiBfc2V0X3Zpc2lvbl9zZXR0aW5ncyhzZWxmLCBhcnRpY2xlczogTGlzdFtzdHJdKToKICAgICAgICBzZXR0aW5ncyA9IHsKICAgICAgICAgICAgInZhbHVlc19saXN0IjogJzsnLmpvaW4oYXJ0aWNsZXMpLAogICAgICAgICAgICAibWluX2xlbmd0aCI6IGxlbihtaW4oYXJ0aWNsZXMsIGtleT1sZW4pKSwKICAgICAgICAgICAgIm1heF9sZW5ndGgiOiBsZW4obWF4KGFydGljbGVzLCBrZXk9bGVuKSksCiAgICAgICAgfQogICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5wdXQoJ2FydGljbGVzX29jcl9zZXR0aW5ncycsIGpzb24uZHVtcHMoc2V0dGluZ3MpLCBUcnVlKQoKICAgIGRlZiBfb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYsIGRvY19yb3dfa2V5KToKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgICAgICd1c2VfYWRyX2RvY3NfdGFibGVzJzogJzAnCiAgICAgICAgfQoKICAgICAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICBTZXJpZXNTZWxlY3RTY3JlZW4sCiAgICAgICAgICAgIHNjcmVlbl92YWx1ZXM9c2NyZWVuX3ZhbHVlcwogICAgICAgICkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9vcGVuX2dvb2RzX3NlbGVjdF9zY3JlZW4oc2VsZiwgZG9jX3Jvd19pZCk6CiAgICAgICAgaWYgbGVuKHNlbGYudGFibGVfZGF0YSkgPT0gMjoKICAgICAgICAgICAgZmlyc3RfZWxlbWVudF9wYWdlID0gc2VsZi50YWJsZV9kYXRhWzFdWydrZXknXQogICAgICAgICAgICBmaXJzdF9lbGVtZW50X2xpc3QgPSBmaXJzdF9lbGVtZW50X3BhZ2UKICAgICAgICBlbGlmIGxlbihzZWxmLnRhYmxlX2RhdGEpID4gMjoKICAgICAgICAgICAgZmlyc3RfZWxlbWVudF9wYWdlID0gc2VsZi50YWJsZV9kYXRhWzFdWydrZXknXQogICAgICAgICAgICBmaXJzdF9lbGVtZW50X2xpc3QgPSBzZWxmLnRhYmxlX2RhdGFbMl1bJ2tleSddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRhYmxlX2luZGV4X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3RhYmxlX2luZGV4X2RhdGEoCiAgICAgICAgICAgIHNlbGYuaWRfZG9jLCBmaXJzdF9lbGVtZW50X3BhZ2UsIGZpcnN0X2VsZW1lbnRfbGlzdAogICAgICAgICkKCiAgICAgICAgc2NyZWVuID0gR29vZHNTZWxlY3RTY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgdGFibGVfaW5kZXhfZGF0YT10YWJsZV9pbmRleF9kYXRhLAogICAgICAgICAgICBkb2Nfcm93X2lkPWRvY19yb3dfaWQKICAgICAgICApCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoc2VsZik6CiAgICAgICAgZmluZGVkX2FydGljbGVzID0gJy0xJyBpZiBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKSBlbHNlICcxJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2J0bl9kb2NfbWFya192ZXJpZmllZCcsIGZpbmRlZF9hcnRpY2xlcykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd19kb2NfZGF0ZScsIGZpbmRlZF9hcnRpY2xlcykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd193YXJlaG91c2UnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfY291bnRyYWdlbnQnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfZmluZGVkX2J5X2FydGljbGUnLCBzdHIoLWludChmaW5kZWRfYXJ0aWNsZXMpKSkKCgpjbGFzcyBGbG93RG9jRGV0YWlsc1NjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQodCx0L7RgCDQqNCaJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkZsb3dEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLnNjcmVlbl9uYW1lLCBhcmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl9iYXJjb2RlX2Zsb3dfb25fc3RhcnQoKQogICAgICAgIHNlbGYuX3NldF92aXNpb25fc2V0dGluZ3MoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X3N0ciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICAgICAgamxpc3QgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCJkb2NfYmFyY19mbG93IikpCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgICAgICBkYXRhID0geydiYXJjb2RlJzogY3VycmVudF9lbGVtWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6IGN1cnJlbnRfZWxlbVsnbmFtZSddLAogICAgICAgICAgICAgICAgICAgICdxdHR5JzogY3VycmVudF9lbGVtWydxdHR5J10sICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJzogJyd9CgogICAgICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYmFyY29kZXMnOgogICAgICAgICAgICBzZWxmLl9zaG93X2RpYWxvZ19pbnB1dF9iYXJjb2RlKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2UoYmFyY29kZSkKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmlkX2RvYykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9iYXJjX2Zsb3dfc3RhdHVzKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJyk6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2UoYmFyY29kZSkKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmlkX2RvYykKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fdmVyaWZpZWQnKToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLm1hcmtfdmVyaWZpZWQoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdjb25maXJtX3ZlcmlmaWVkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JfQsNCy0LXRgNGI0LjRgtGMINC00L7QutGD0LzQtdC90YI/JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ9CU0LAnLCAn0J3QtdGCJ10pCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbl9jYW5jZWwnOgogICAgICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWxfY291bnRlci5kZXN0cm95KCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndmlzaW9uJzoKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ9Cf0LXRh9Cw0YLRjNCf0YDQtdCy0YzRjic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdSZWZyZXNoU2NyZWVuJywgJycpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9vY3Jfc2VyaWFsX3RlbXBsYXRlX3NldHRpbmdzJzoKICAgICAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ09jclRleHRSZWNvZ25pdGlvbicsICdTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncycpCgogICAgZGVmIF9iYXJjb2RlX2Zsb3dfb25fc3RhcnQoc2VsZik6CgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGZhbHNlVmFsdWVMaXN0ID0gKDAsICcwJywgJ2ZhbHNlJywgJ0ZhbHNlJywgTm9uZSkKICAgICAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgtCw0LHQu9C40YbRgyDQutCw0YDRgtC+0YfQtdC6INC4INC30LDQv9GA0L7RgSDQuiDQsdCw0LfQtQoKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuc2VydmljZS5nZXRfZmxvd190YWJsZV9kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBpZiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKCiAgICAgICAgICAgICMg0J/RgNC40LfQvdCw0LosIGhhdmVfcXR0eV9wbGFuINCV0YHRgtGM0J/Qu9Cw0L3Qn9Ce0JrQntC70LjRh9C10YHRgtCy0YMgIC0gINCY0YHRgtC40L3QsCDQutC+0LPQtNCwINGB0YPQvNC80LAg0LrQvtC70L7QvdC60LggUXR0eV9wbGFuID4gMAogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6ICBoYXZlX21hcmtfcGxhbiAi0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDigJMg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNC+0Log0YLQsNCx0LsuIFJTX2RvY3NfYmFyY29kZXMg0YEg0LfQsNC00LDQvdC90YvQvCBpZF9kb2Mg0LggaXNfcGxhbiAg0LHQvtC70YzRiNC1INC90YPQu9GPLgogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6IGhhdmVfemVyb19wbGFuICLQldGB0YLRjCDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSIg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC10YHRgtGMINC30LDQv9C+0LvQvdC10L3QvdGL0LUg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQvtCyINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6ICLQmtC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMIiAgLSDQv9GA0LjQt9C90LDQuiDQtNC70Y8g0LTQvtC60YPQvNC10L3RgtCwLCDQvdCw0LTQviDQu9C4INC60L7QvdGC0YDQvtC70LjRgNC+0LLQsNGC0YwKCiAgICAgICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIsCiAgICAgICAgICAgICAgICBzdW0oaWZudWxsKHF0dHlfcGxhbiwwKSkgYXMgcXR0eV9wbGFuCiAgICAgICAgICAgICAgICBmcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jID0gOmlkX2RvYycnJwogICAgICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgeydpZF9kb2MnOiBpZF9kb2N9KQogICAgICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSByZXNbMF1bMF0gPiAwICAjINCSINC00L7QutGD0LzQtdC90YLQtSDQtdGB0YLRjCDRgdGC0YDQvtC60LgKICAgICAgICAgICAgICAgIGlmIGhhdmVfemVyb19wbGFuOgogICAgICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gcmVzWzBdWzFdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0LrQvtC70LLQviDQv9C70LDQvQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgICAgICMg0JXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0L/QviDQutC+0LTQsNC8INC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIKICAgICAgICAgICAgICAgIGZyb20gUlNfZG9jc19iYXJjb2RlcyBXaGVyZSBpZF9kb2MgPSA6aWRfZG9jIEFORCBpc19wbGFuID0gOmlzX3BsYW4nJycKICAgICAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jLCAnaXNfcGxhbic6ICcxJ30pCiAgICAgICAgICAgIGlmIG5vdCByZXM6CiAgICAgICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSByZXNbMF1bMF0gPiAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hhdmVfcXR0eV9wbGFuJywgc3RyKGhhdmVfcXR0eV9wbGFuKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGF2ZV96ZXJvX3BsYW4nLCBzdHIoaGF2ZV96ZXJvX3BsYW4pKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdoYXZlX21hcmtfcGxhbicsIHN0cihoYXZlX21hcmtfcGxhbikpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ1NFTEVDVCBjb250cm9sIGZyb20gUlNfZG9jcyAgV0hFUkUgaWRfZG9jID0gPycsIChpZF9kb2MsKSkKICAgICAgICAjINCV0YHRgtGMINC70Lgg0LrQvtC90YLRgNC+0LvRjCDQv9C70LDQvdCwINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgaWYgcmVzWzBdWzBdOgogICAgICAgICAgICAgICAgaWYgcmVzWzBdWzBdIGluIGZhbHNlVmFsdWVMaXN0OgogICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnVHJ1ZScKCiAgICAgICAgICAgICAgICAjIGNvbnRyb2wgPSByZXNbMF1bMF0gIydUcnVlJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY29udHJvbCcsIGNvbnRyb2wpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRvY19iYXJjX2Zsb3ciLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKCiAgICAgICAgaWYgVHJ1ZSBpbiAoaGF2ZV9xdHR5X3BsYW4sIGhhdmVfemVyb19wbGFuLCBoYXZlX21hcmtfcGxhbiwgY29udHJvbCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICfQlNCw0L3QvdGL0Lkg0LTQvtC60YPQvNC10L3RgiDRgdC+0LTQtdGA0LbQuNGCINC/0LvQsNC90L7QstGL0LUg0YHRgtGA0L7QutC4LiDQodC/0LjRgdC+0Log0YjRgtGA0LjRhdC60L7QtNC+0LIg0LIg0L3QtdCz0L4g0L/QvtC80LXRgdGC0LjRgtGMINC90LXQu9GM0LfRjycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoc2VsZik6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGJhcmNvZGUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0zLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRvY19kZXRhaWxzKToKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgICAgICBiYXJjb2RlID0gc3RyKHNlbGYuaGFzaF9tYXAuZ2V0KCdmbGRfYmFyY29kZScpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzdHIoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykpCgogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIGRvY19kZXRhaWxzID0gc2VsZi5fc29ydF90YWJsZV9ieV9iYXJjb2RlKGRvY19kZXRhaWxzLCBiYXJjb2RlKQoKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgICMgc2VsZi5oYXNoX21hcC50b2FzdChzZWxmLmhhc2hfbWFwLmdldCgnYWRkZWRfZ29vZHMnKSkKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0geydrZXknOiBzdHIocmVjb3JkWydiYXJjb2RlJ10pLCAnYmFyY29kZSc6IHN0cihyZWNvcmRbJ2JhcmNvZGUnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICduYW1lJzogcmVjb3JkWyduYW1lJ10gaWYgcmVjb3JkWyduYW1lJ10gaXMgbm90IE5vbmUgZWxzZSAnLdC90LXRgiDQtNCw0L3QvdGL0YUtJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIocmVjb3JkWydxdHR5J10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoKX0KCiAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gJyNGRkZGRkYnIGlmIHJlY29yZFsnbmFtZSddIGlzIG5vdCBOb25lIGVsc2UgIiNGQkU5RTciCgogICAgICAgICAgICAjINGN0YLQviDQvdC1INGA0LDQsdC+0YLQsNC10YIg0YHRg9C00Y8g0L/QviDQstGB0LXQvNGDINC/0L7RgtC+0LzRgyDRh9GC0L4g0L3QtdGCINCyIGhhc2hfbWFwINC60LvRjtGH0LAgYWRkZWRfZ29vZHMKICAgICAgICAgICAgaWYgc2VsZi5fYWRkZWRfZ29vZHNfaGFzX2tleShwcm9kdWN0X3Jvd1sna2V5J10pOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5pbnNlcnQoMSwgcHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX3NvcnRfdGFibGVfYnlfYmFyY29kZShzZWxmLCB0YWJsZSwgYmFyY29kZSk6CgogICAgICAgIGZvciBpLCByb3cgaW4gZW51bWVyYXRlKHRhYmxlKToKICAgICAgICAgICAgaWYgc3RyKHJvdy5nZXQoJ2JhcmNvZGUnKSkgPT0gYmFyY29kZToKICAgICAgICAgICAgICAgIGRlbCB0YWJsZVtpXQogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KDAsIHJvdykKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIHJldHVybiB0YWJsZQoKICAgIGRlZiBfc2V0X3Zpc2lvbl9zZXR0aW5ncyhzZWxmKSAtPiBOb25lOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBvY3Jfbm9zcWwuZ2V0KCdzZXJpYWxfb2NyX3NldHRpbmdzJykKICAgICAgICBpZiBzZXJpYWxfb2NyX3NldHRpbmdzOgogICAgICAgICAgICBzZXJpYWxfb2NyX3NldHRpbmdzID0ganNvbi5sb2FkcyhzZXJpYWxfb2NyX3NldHRpbmdzKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF92aXNpb25fc2V0dGluZ3MoKipzZXJpYWxfb2NyX3NldHRpbmdzKQogICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdmcm9tX3NjcmVlbicsICdGbG93RG9jRGV0YWlsc1NjcmVlbicsIFRydWUpCgoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERvY0RldGFpbHMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kcyBzZWxlY3QgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBCYXNlR29vZFNlbGVjdChTY3JlZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCBfcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pZF9kb2MgPSAnJwogICAgICAgIHNlbGYuZG9jX3Jvd19pZCA9ICcnCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gRG9jU2VydmljZShzZWxmLmlkX2RvYykKICAgICAgICBzZWxmLmFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpIG9yIEZhbHNlCiAgICAgICAgc2VsZi5jdXJyZW50X3RvYXN0X21lc3NhZ2UgPSAnJwogICAgICAgIHNlbGYuaGFzaF9tYXBfa2V5cyA9IFsnaXRlbV9uYW1lJywgJ2FydGljbGUnLCAncHJvcGVydHknLCAncHJpY2UnLCAndW5pdCcsICdxdHR5X3BsYW4nLCAncXR0eSddCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHt9CiAgICAgICAgc2VsZi5kZWx0YSA9IDAuMAogICAgICAgIHNlbGYubmV3X3F0eSA9IDAuMAoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eSgpCiAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX3ByaW50Jzogc2VsZi5wcmludF90aWNrZXQsCiAgICAgICAgICAgICdiYXJjb2RlJzogc2VsZi5fcHJvY2Vzc190aGVfYmFyY29kZSwKICAgICAgICAgICAgJ2J0bl9kb2NfZ29vZF9iYXJjb2RlJzogc2VsZi5fb3Blbl9yZWdpc3Rlcl9iYXJjb2RlX3NjcmVlbiwKICAgICAgICAgICAgJ2J0bl9zZXJpZXNfc2hvdyc6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbiwKICAgICAgICAgICAgJ2J0bl9pbnB1dF9xdHR5Jzogc2VsZi5fc2hvd19kaWFsb2dfcXR0eSwKICAgICAgICAgICAgJ2J0bl9tYXJrc19zaG93Jzogc2VsZi5fb3Blbl9tYXJrc19zY3JlZW4sCiAgICAgICAgICAgICdidG5fdG9fc2VyaWVzJzogc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgaW4gWydidG5fb2snLCAiYnRuX2NhbmNlbCIsICdCQUNLX0JVVFRPTicsICdPTl9CQUNLX1BSRVNTRUQnXToKICAgICAgICAgICAgc2VsZi5faGFuZGxlX2J0bl9vaygpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9xdHR5Jyk6CiAgICAgICAgICAgIHNlbGYuX3NldF9xdHlfcmVzdWx0KCkKICAgICAgICBlbGlmICdvcHMnIGluIHNlbGYubGlzdGVuZXI6CiAgICAgICAgICAgIHNlbGYuX29wc19saXN0ZW5lcigpCgogICAgZGVmIF9vcHNfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgaWYgaW50KHNlbGYuc2NyZWVuX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJywgMCkpOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNldF92YWx1ZSA9IGZsb2F0KHNlbGYubGlzdGVuZXJbNDpdKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEoc2V0X3ZhbHVlKQoKICAgIGRlZiBfaGFuZGxlX2J0bl9vayhzZWxmKToKICAgICAgICBxdHR5X3BsYW4gPSBmbG9hdChzZWxmLnNjcmVlbl9kYXRhLmdldCgncXR0eV9wbGFuJykgb3IgMCkKICAgICAgICBxdHR5ID0gZmxvYXQoc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ3F0dHknKSBvciAwKQoKICAgICAgICBpZiBzZWxmLm5ld19xdHkgPCAwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQmNGC0L7Qs9C+0LLQvtC1INC60L7Qu9C40YfQtdGB0YLQstC+INC80LXQvdGM0YjQtSAwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjb250cm9sID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgaWYgY29udHJvbCBhbmQgKG1heChzZWxmLm5ld19xdHksIHF0dHkpID4gcXR0eV9wbGFuKToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0g0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0YDQtdCy0YvRiNC10L3QvicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcXR0eSA9IHNlbGYubmV3X3F0eQogICAgICAgIHNlbGYuX2hhbmRsZV9jaG9pY2UocXR0eSkKICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKCiAgICBkZWYgX2hhbmRsZV9jaG9pY2Uoc2VsZiwgcXR0eSk6CiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMCwKICAgICAgICB9CiAgICAgICAgc2VsZi5fdXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXNlbGYuZG9jX3Jvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKCiAgICBkZWYgX3Byb2Nlc3NfdGhlX2JhcmNvZGUoc2VsZik6CiAgICAgICAgc2VsZi5fbGlzdGVuZXJfbm90X2ltcGxlbWVudGVkKCkKCiAgICBkZWYgX3NhdmVfbmV3X2RlbHRhKHNlbGYpOgogICAgICAgIGlmIHNlbGYubmV3X3F0eSA8IDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CY0YLQvtCz0L7QstC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LzQtdC90YzRiNC1IDAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbnRyb2wgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJykKICAgICAgICBpZiBjb250cm9sOgogICAgICAgICAgICBpZiBzZWxmLm5ld19xdHkgPiBzZWxmLnNjcmVlbl9kYXRhLmdldCgncXR0eV9wbGFuJyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/RgNC10LLRi9GI0LXQvdC+JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICBxdHR5ID0gc2VsZi5uZXdfcXR5CiAgICAgICAgb2xkX3F0dHkgPSBmbG9hdChzZWxmLnNjcmVlbl9kYXRhLmdldCgncXR0eScpIG9yIDApCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3BhcmVudF9zY3JlZW4nKSA9PSAn0JLRi9Cx0L7RgNCi0L7QstCw0YDQsNCQ0YDRgtC40LrRg9C7JzoKICAgICAgICAgICAgc2VsZi5fbGlzdGVuZXJfbm90X2ltcGxlbWVudGVkKCkKCiAgICAgICAgICAgIGlmIHF0dHkgPT0gc2VsZi5fZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5JykpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JLRi9Cx0L7RgNCi0L7QstCw0YDQsNCQ0YDRgtC40LrRg9C7IikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBmaW5kZWRfZ29vZHNfY2FyZHMgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmluZGVkX2dvb2RzX2NhcmRzJywgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIGNhcmRzZGF0YSA9IGZpbmRlZF9nb29kc19jYXJkc1snY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICAgICAgICAgIGNhcmRfZGF0YSA9IG5leHQoZWxlbSBmb3IgZWxlbSBpbiBjYXJkc2RhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlbGVtWydrZXknXSA9PSBzZWxmLmRvY19yb3dfaWQpCiAgICAgICAgICAgIGNhcmRfZGF0YVsncXR0eSddID0gcXR0eQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZmluZGVkX2dvb2RzX2NhcmRzJywgZmluZGVkX2dvb2RzX2NhcmRzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCS0YvQsdC+0YDQotC+0LLQsNGA0LDQkNGA0YLQuNC60YPQuyIpCiAgICAgICAgZWxpZiBxdHR5ICE9IG9sZF9xdHR5OgogICAgICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgICAgICdxdHR5JzogcXR0eSwKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLl91cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9c2VsZi5kb2Nfcm93X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBzdHIocm91bmQocXR0eSwgMykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncXR0eScsIHN0cihxdHR5KSkKCiAgICBkZWYgX2dldF9mbG9hdF92YWx1ZShzZWxmLCB2YWx1ZSkgLT4gZmxvYXQ6CiAgICAgICAgaWYgdmFsdWUgYW5kIHJlLm1hdGNoKCIoXlxkKlwuP1xkKiQpIiwgdmFsdWUpOgogICAgICAgICAgICByZXR1cm4gZmxvYXQodmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIDAuMAoKICAgIGRlZiBfc2V0X2RlbHRhKHNlbGYsIHZhbHVlOiBmbG9hdCA9IDAuMCwgcmVzZXQ6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgaWYgcmVzZXQ6CiAgICAgICAgICAgIHNlbGYuZGVsdGEgPSAwCiAgICAgICAgICAgIHNlbGYubmV3X3F0eSA9IHNlbGYuc2NyZWVuX2RhdGFbJ3F0dHknXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuZGVsdGEgPSB2YWx1ZQogICAgICAgICAgICBzZWxmLm5ld19xdHkgKz0gc2VsZi5kZWx0YQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyduZXdfcXR0eSddID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KHNlbGYubmV3X3F0eSkKCgogICAgZGVmIF9zZXRfcmVzdWx0X3F0dHkoc2VsZiwgZGVsdGEpOgogICAgICAgIG5ld19xdHR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSBvciAwKSArIGRlbHRhCiAgICAgICAgbmV3X3F0dHkgPSBzdHIoc2VsZi5fZm9ybWF0X3F1YW50aXR5KG5ld19xdHR5KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBuZXdfcXR0eSkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBkZWYgcHJpbnRfdGlja2V0KHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpLmdldF9iYXJjb2RlX2Zyb21fZG9jX3RhYmxlKHN0cihzZWxmLmRvY19yb3dfaWQpKQoKICAgICAgICBkYXRhID0geyfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiAnaXRlbV9uYW1lJywKICAgICAgICAgICAgICAgICfQkNGA0YLQuNC60YPQuyc6ICdhcnRpY2xlJywKICAgICAgICAgICAgICAgICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJzogJ3Byb3BlcnR5JywKICAgICAgICAgICAgICAgICfQptC10L3QsCc6ICdwcmljZScsCiAgICAgICAgICAgICAgICAn0JXQtNCY0LfQvCc6ICd1bml0JywKICAgICAgICAgICAgICAgICfQmtC70Y7Rhyc6ICdrZXknLAogICAgICAgICAgICAgICAgJ9CS0LDQu9GO0YLQsCc6ICdwcmljZV90eXBlJ30KCiAgICAgICAgZm9yIGtleSBpbiBkYXRhOgogICAgICAgICAgICBkYXRhW2tleV0gPSBzZWxmLmhhc2hfbWFwLmdldChkYXRhW2tleV0pCiAgICAgICAgZGF0YVsnYmFyY29kZSddID0gYmFyY29kZSBpZiBiYXJjb2RlIGVsc2UgJzAwMDAwMDAwMDAwMDAnCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZik6CiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2RvY19yb3dfaWQnOiBzZWxmLmRvY19yb3dfaWQsCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gU2VyaWVzU2VsZWN0U2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93X3Byb2Nlc3NfcmVzdWx0KHNjcmVlbl92YWx1ZXMpCgogICAgZGVmIF9vcGVuX3JlZ2lzdGVyX2JhcmNvZGVfc2NyZWVuKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnaXRlbV9pZCcsICcnKSwKICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ3Byb3BlcnR5X2lkJywgJycpLAogICAgICAgICAgICAndW5pdF9pZCc6IHNlbGYuc2NyZWVuX2RhdGEuZ2V0KCd1bml0X2lkJywgJycpCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IEJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdChpbml0X2RhdGEpCgogICAgZGVmIF9vcGVuX21hcmtzX3NjcmVlbihzZWxmKToKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fZ2V0X21hcmtzX2RhdGEoc2VsZi5kb2Nfcm93X2lkKQogICAgICAgIGlmIG5vdCB0YWJsZV9kYXRhOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2NyZWVuX2FyZ3MgPSB7CiAgICAgICAgICAgICd0aXRsZSc6ICfQnNCw0YDQutC4INGC0L7QstCw0YDQsCcsCiAgICAgICAgICAgICd0YWJsZV9kYXRhJzoganNvbi5kdW1wcyh0YWJsZV9kYXRhKSwKICAgICAgICAgICAgJ3RhYmxlX2hlYWRlcic6IGpzb24uZHVtcHMoeydtYXJrX2NvZGUnOiAn0JzQsNGA0LrQsCd9KSwKICAgICAgICAgICAgJ2VudW1lcmF0ZSc6IFRydWUKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gU2hvd0l0ZW1zU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX2FyZ3MpCgogICAgZGVmIF9nZXRfbWFya3NfZGF0YShzZWxmLCBkb2Nfcm93X2lkKToKICAgICAgICByZXR1cm4gc2VsZi5zZXJ2aWNlLmdldF9tYXJrc19kYXRhKHNlbGYuaWRfZG9jLCBkb2Nfcm93X2lkKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkKToKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAnZF9xdHR5JzogZmxvYXQoZGF0YVsncXR0eSddKSwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChkYXRhWydxdHR5J10pLAogICAgICAgIH0KCiAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykpCgogICAgZGVmIF9zaG93X2RpYWxvZ19xdHR5KHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gIjEiOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZGVsdGEnXSA9IDAuMAogICAgICAgIHNlbGYuaGFzaF9tYXBbJ0ZvY3VzRmllbGQnXSA9ICdkZWx0YScKICAgICAgICBsYXlvdXQgPSAnJyd7CiAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGRlbHRhIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiZGVsdGEiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkVkaXRUZXh0TnVtZXJpYyIKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0nJycKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAnbW9kYWxfZGlhbG9nX2lucHV0X3F0dHknLAogICAgICAgICAgICB0aXRsZT1mItCS0LLQtdGB0YLQuCDQuNGC0L7Qs9C+0LLQvtC1INC60L7Qu9C40YfQtdGB0YLQstC+OiIsCiAgICAgICAgICAgIGRpYWxvZ19sYXlvdXQ9bGF5b3V0CiAgICAgICAgKQoKICAgIGRlZiBfc2V0X3F0eV9yZXN1bHQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdmFsaWRhdGVfZGVsdGFfaW5wdXQoKToKICAgICAgICAgICAgc2VsZi5uZXdfcXR5ID0gc2VsZi5fZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYuaGFzaF9tYXBbJ2RlbHRhJ10pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ25ld19xdHR5J10gPSBzZWxmLmhhc2hfbWFwWydkZWx0YSddCiAgICAgICAgICAgICMgc2VsZi5fc2V0X2RlbHRhKCkpCgogICAgZGVmIF92YWxpZGF0ZV9kZWx0YV9pbnB1dChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZsb2F0KHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi50b2FzdCgn0JLQstC10LTQtdC90L4g0L3QtdC60L7RgNGA0LXQutGC0L3QvtC1INC30L3QsNGH0LXQvdC40LUnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5KHNlbGYpOgogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLmFsbG93X2ZhY3RfaW5wdXQgYW5kIG5vdCBpbnQoc2VsZi5zY3JlZW5fZGF0YVsndXNlX3NlcmllcyddKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9pbnB1dCIsICcxJyBpZiBhbGxvd19mYWN0X2lucHV0IGVsc2UgJy0xJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfbm90ZSIsICctMScgaWYgYWxsb3dfZmFjdF9pbnB1dCBlbHNlICcxJykKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnU2hvd19idG5fdG9fc2VyaWVzJ10gPSBpbnQoc2VsZi5zY3JlZW5fZGF0YVsndXNlX3NlcmllcyddKQoKY2xhc3MgR29vZHNTZWxlY3RTY3JlZW4oQmFzZUdvb2RTZWxlY3QpOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgCDQstGL0LHQvtGAJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGhhc2hfbWFwOiBIYXNoTWFwLAogICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgIGRvY19yb3dfaWQsCiAgICAgICAgICAgIHRhYmxlX2luZGV4X2RhdGEsCiAgICAgICAgICAgIHJzX3NldHRpbmdzPU5vbmUKICAgICk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLmlkX2RvYyA9IGlkX2RvYwogICAgICAgIHNlbGYudGFibGVfaW5kZXhfZGF0YTogbGlzdCA9IHRhYmxlX2luZGV4X2RhdGEKICAgICAgICBzZWxmLmFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpIG9yIEZhbHNlCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZShzZWxmLmlkX2RvYykKICAgICAgICBzZWxmLmRvY19yb3dfaWQgPSBkb2Nfcm93X2lkCiAgICAgICAgc2VsZi5jdXJyZW50X2luZGV4ID0gMAoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmN1cnJlbnRfaW5kZXggPSBzZWxmLnRhYmxlX2luZGV4X2RhdGEuaW5kZXgoc2VsZi5kb2Nfcm93X2lkKQogICAgICAgIHNlbGYuX3VwZGF0ZV9oYXNoX21hcF9rZXlzKCkKICAgICAgICBzdXBlcigpLmluaXRfc2NyZWVuKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fbmV4dF9nb29kJzogbGFtYmRhOiBzZWxmLl9nb29kc19zZWxlY3RvcignbmV4dCcpLAogICAgICAgICAgICAnYnRuX3ByZXZpb3VzX2dvb2QnOiBsYW1iZGE6IHNlbGYuX2dvb2RzX3NlbGVjdG9yKCJwcmV2aW91cyIpLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKCiAgICBkZWYgX3VwZGF0ZV9oYXNoX21hcF9rZXlzKHNlbGYpOgogICAgICAgIHNlbGYuZG9jX3Jvd19pZCA9IHNlbGYudGFibGVfaW5kZXhfZGF0YVtzZWxmLmN1cnJlbnRfaW5kZXhdCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfZG9jX3Jvd19kYXRhKHNlbGYuZG9jX3Jvd19pZCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHsKICAgICAgICAgICAga2V5OiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoc2VsZi5zY3JlZW5fZGF0YS5nZXQoa2V5LCAwKSkKICAgICAgICAgICAgaWYga2V5IGluIFsncXR0eV9wbGFuJywgJ3F0dHknXSBlbHNlIHNlbGYuc2NyZWVuX2RhdGEuZ2V0KGtleSwgJycpCiAgICAgICAgICAgIGZvciBrZXkgaW4gc2VsZi5oYXNoX21hcF9rZXlzCiAgICAgICAgfSkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnaXRlbV9wb3NpdGlvbiddID0gZid7c2VsZi5jdXJyZW50X2luZGV4KzF9IC8ge2xlbihzZWxmLnRhYmxlX2luZGV4X2RhdGEpfScKCiAgICBkZWYgX2dvb2RzX3NlbGVjdG9yKHNlbGYsIGFjdGlvbiwgaW5kZXg9Tm9uZSk6CiAgICAgICAgaWYgaW5kZXggaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5fc2F2ZV9uZXdfZGVsdGEoKQogICAgICAgIGlmIGFjdGlvbiA9PSAnbmV4dCc6CiAgICAgICAgICAgIG5ld19pbmRleCA9IHNlbGYuY3VycmVudF9pbmRleCsxIGlmIChzZWxmLmN1cnJlbnRfaW5kZXgrMSA8IGxlbihzZWxmLnRhYmxlX2luZGV4X2RhdGEpKSBlbHNlIDAKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CiAgICAgICAgZWxpZiBhY3Rpb24gPT0gJ3ByZXZpb3VzJzoKICAgICAgICAgICAgbmV3X2luZGV4ID0gbGVuKHNlbGYudGFibGVfaW5kZXhfZGF0YSktMSBpZiAoc2VsZi5jdXJyZW50X2luZGV4LTEgPCAwKSBlbHNlIHNlbGYuY3VycmVudF9pbmRleC0xCiAgICAgICAgICAgIHNlbGYuY3VycmVudF9pbmRleCA9IG5ld19pbmRleAogICAgICAgIGVsaWYgYWN0aW9uID09ICdpbmRleCcgYW5kIG5vdCBpbmRleCBpcyBOb25lOgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfaW5kZXggPSBpbmRleAoKICAgICAgICBzZWxmLl91cGRhdGVfaGFzaF9tYXBfa2V5cygpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHkoKQogICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQoKICAgIGRlZiBfcHJvY2Vzc190aGVfYmFyY29kZShzZWxmKToKICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfZ29vZF9zZWxlY3QnKQoKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHJlcyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3Jvd19ieV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICBpbmRleCA9IHNlbGYudGFibGVfaW5kZXhfZGF0YS5pbmRleChyZXNbJ2lkJ10pCiAgICAgICAgICAgIGlmIHNlbGYuY3VycmVudF9pbmRleCAhPSBpbmRleDoKICAgICAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKGFjdGlvbj0naW5kZXgnLCBpbmRleD1pbmRleCkKCiAgICAgICAgICAgIGlmIG5vdCBpbnQoc2VsZi5zY3JlZW5fZGF0YVsndXNlX3NlcmllcyddKToKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YSgxKQogICAgICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzZWxmLmN1cnJlbnRfdG9hc3RfbWVzc2FnZSBvciBmJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1IScpCgoKCmNsYXNzIEdyb3VwU2Nhbkl0ZW1TY3JlZW4oQmFzZUdvb2RTZWxlY3QpOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgCDQstGL0LHQvtGAJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF9zeW5jX2RvYycsICcnKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkKToKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ2RfcXR0eSc6IGRhdGFbJ3F0dHknXSwKICAgICAgICB9CiAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykpCgogICAgICAgIGluc2VydF90b19xdWV1ZSA9IHsKICAgICAgICAgICAgImlkX2RvYyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgImlkX2dvb2QiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfZ29vZCIpLAogICAgICAgICAgICAiaWRfcHJvcGVydGllcyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9wcm9wZXJ0eSIpLAogICAgICAgICAgICAiaWRfc2VyaWVzIjogc2VsZi5oYXNoX21hcC5nZXQoImlkX3NlcmllcyIpLAogICAgICAgICAgICAiaWRfdW5pdCI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF91bml0IiksCiAgICAgICAgICAgICJpZF9jZWxsIjogIiIsCiAgICAgICAgICAgICJkX3F0dHkiOiBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKSksCiAgICAgICAgICAgICJzZW50IjogRmFsc2UsCiAgICAgICAgICAgICJwcmljZSI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX3ByaWNlIiksCiAgICAgICAgICAgICJpZF9wcmljZSI6ICIiCiAgICAgICAgfQoKICAgICAgICBiYXJjb2RlX3dvcmtlciA9IEJhcmNvZGVXb3JrZXIoc2VsZi5oYXNoX21hcC5nZXQoImlkX2RvYyIpKQogICAgICAgIGJhcmNvZGVfd29ya2VyLnF1ZXVlX3VwZGF0ZV9kYXRhID0gaW5zZXJ0X3RvX3F1ZXVlCiAgICAgICAgYmFyY29kZV93b3JrZXIudXBkYXRlX2RvY3VtZW50X2JhcmNvZGVfZGF0YSgpCgoKY2xhc3MgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnQmFyY29kZVJlZ2lzdHJhdGlvbicKICAgIHByb2Nlc3NfbmFtZSA9ICdCYXJjb2RlUmVnaXN0cmF0aW9uJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLmdvb2RzX3NlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwWydpdGVtX2lkJ10sCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6IHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X2lkJ10gb3IgJycsCiAgICAgICAgICAgICd1bml0X2lkJzogc2VsZi5oYXNoX21hcFsndW5pdF9pZCddIG9yICcnLAogICAgICAgIH0KICAgICAgICBzZWxmLnRpdGxlID0gJ9Cg0LXQs9C40YHRgtGA0LDRhtC40Y8g0YjRgtGA0LjRhdC60L7QtNCwJwoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSBzZWxmLmdvb2RzX3NlcnZpY2UuZ2V0X2l0ZW1fZGF0YV9ieV9jb25kaXRpb24oKipzZWxmLnNjcmVlbl92YWx1ZXMpCiAgICAgICAgaWYgaW5pdF9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RfbmFtZV9iYXJjb2RlJ10gPSBpbml0X2RhdGFbJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9IGluaXRfZGF0YVsncHJvcGVydHknXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gaW5pdF9kYXRhWyd1bml0J10KCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdF9pZCddID0gc2VsZi5zY3JlZW5fdmFsdWVzWydwcm9wZXJ0eV9pZCddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0X2lkJ10gPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3VuaXRfaWQnXQoKICAgICAgICAgICAgc2VsZi5fZmlsbF9iYXJjb2Rlc190YWJsZShzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi50aXRsZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0Jzogc2VsZi5fc2VsZWN0X2l0ZW0sCiAgICAgICAgICAgICd1bml0X3NlbGVjdCc6IHNlbGYuX3NlbGVjdF9pdGVtLAogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0X3N1Y2Nlc3MnOiBsYW1iZGEgOiBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3Byb3BlcnR5X3NlbGVjdCcpLAogICAgICAgICAgICAndW5pdF9zZWxlY3Rfc3VjY2Vzcyc6IGxhbWJkYSA6IHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgndW5pdF9zZWxlY3QnKSwKICAgICAgICAgICAgJ2JhcmNvZGUnOiBzZWxmLl9iYXJjb2RlX3NjYW5uZWQsCiAgICAgICAgICAgICdidG5fb2snOiBzZWxmLl9oYW5kbGVfb2ssCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9maW5pc2hfcHJvY2VzcywKICAgICAgICAgICAgJ0JBQ0tfQlVUVE9OJzogc2VsZi5fZmluaXNoX3Byb2Nlc3MsCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBfc2VsZWN0X2l0ZW0oc2VsZik6CiAgICAgICAgaXRlbV90YWJsZXMgPSB7CiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3QnOiAnUlNfcHJvcGVydGllcycsCiAgICAgICAgICAgICd1bml0X3NlbGVjdCc6ICdSU191bml0cycsCiAgICAgICAgfQoKICAgICAgICBpdGVtX3R5cGUgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgc2NyZWVuID0gU2VsZWN0SXRlbVNjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgdGFibGVfbmFtZT1pdGVtX3RhYmxlc1tpdGVtX3R5cGVdLAogICAgICAgICAgICByZXN1bHRfbGlzdGVuZXI9Zid7aXRlbV90eXBlfV9zdWNjZXNzJwogICAgICAgICkKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9zZWxlY3RfaXRlbV9yZXN1bHQoc2VsZiwgZmllbGRfbmFtZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX2NhcmQ6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSBzZWxlY3RlZF9jYXJkLmdldCgnbmFtZScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZid7ZmllbGRfbmFtZX1faWQnXSA9IHNlbGVjdGVkX2NhcmQuZ2V0KCdpZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9ICcnCgogICAgZGVmIF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgc2Nhbm5lZF9iYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoImJhcmNvZGUiKQogICAgICAgIHNlbGYuX2NoZWNrX2JhcmNvZGUoc2Nhbm5lZF9iYXJjb2RlKQoKICAgIGRlZiBfaGFuZGxlX29rKHNlbGYpOgogICAgICAgIHNjYW5uZWRfYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzY2FubmVkX2JhcmNvZGUiKQogICAgICAgIGlmIG5vdCBzY2FubmVkX2JhcmNvZGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoItCo0YLRgNC40YXQutC+0LQg0L3QtSDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L0iKQogICAgICAgIGVsaWYgc2VsZi5fY2hlY2tfYmFyY29kZShzY2FubmVkX2JhcmNvZGUpOgogICAgICAgICAgICBpdGVtX2lkID0gc2VsZi5oYXNoX21hcC5nZXQoIml0ZW1faWQiKQogICAgICAgICAgICBiYXJjb2RlX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAiaWRfZ29vZCI6IGl0ZW1faWQsCiAgICAgICAgICAgICAgICAiYmFyY29kZSI6IHNjYW5uZWRfYmFyY29kZSwKICAgICAgICAgICAgICAgICJpZF9wcm9wZXJ0eSI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJwcm9wZXJ0eV9zZWxlY3RfaWQiKSBvciAnJywKICAgICAgICAgICAgICAgICJpZF91bml0Ijogc2VsZi5oYXNoX21hcC5nZXQoInVuaXRfc2VsZWN0X2lkIikgb3IgJycsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYuX3NhdmVfYmFyY29kZShiYXJjb2RlX2RhdGEpCiAgICAgICAgICAgIHNlbGYuX2ZpbGxfYmFyY29kZXNfdGFibGUoaXRlbV9pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9zYXZlX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGUoYmFyY29kZV9kYXRhKQoKICAgICAgICBidWZmZXIgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgYnVmZmVyLnNhdmVfZGF0YV90b19zZW5kKGJhcmNvZGVfZGF0YSwgcGs9J2JhcmNvZGUnKQoKICAgIGRlZiBfY2hlY2tfYmFyY29kZShzZWxmLCBiYXJjb2RlKToKICAgICAgICBiYXJjb2RlX2RhdGEgPSBzZWxmLmdvb2RzX3NlcnZpY2UuZ2V0X3ZhbHVlc19mcm9tX2JhcmNvZGUoImJhcmNvZGUiLCBiYXJjb2RlKQoKICAgICAgICBpZiBiYXJjb2RlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZifQqNGC0YDQuNGF0LrQvtC0IHtiYXJjb2RlfSDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIg0LIg0LHQsNC30LUg0LTQsNC90L3Ri9GFJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2Nhbm5lZF9iYXJjb2RlJ10gPSAnJwogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9IGJhcmNvZGUKCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX2ZpbGxfYmFyY29kZXNfdGFibGUoc2VsZiwgaXRlbV9pZCk6CiAgICAgICAgIyBiYXJjb2Rlc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9iYXJjb2Rlc19ieV9nb29kc19pZChzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKICAgICAgICBiYXJjb2Rlc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9iYXJjb2Rlc19ieV9nb29kc19pZChpdGVtX2lkKQogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEoYmFyY29kZXNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydiYXJjb2Rlc19kYXRhJ10gPSBzZWxmLl9nZXRfYmFyY29kZXNfdGFibGVfdmlldyh0YWJsZV9kYXRhKS50b19qc29uKCkKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBiYXJjb2Rlc19kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW10KICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZCh7J19sYXlvdXQnOiBzZWxmLl9nZXRfdGFibGVfaGVhZGVyKCl9KSAjINGI0LDQv9C60LAKICAgICAgICBmb3Igcm93IGluIGJhcmNvZGVzX2RhdGE6CiAgICAgICAgICAgICMgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkg0L/RgNC+0LHQu9C10LzQsCDQv9GA0L7QuNC30LLQvtC00LjRgtC10LvRjNC90L7RgdGC0LgKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3RhYmxlX2hlYWRlcihzZWxmKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQqNGC0YDQuNGF0LrQvtC0JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cj0L/QsNC60L7QstC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApCgogICAgZGVmIF9nZXRfYmFyY29kZXNfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGJhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0eScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzIHNlbGVjdCBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kcyhQcm9jZXNzKSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgR29vZHNMaXN0U2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6JwogICAgcHJvY2Vzc19uYW1lID0gJ9Ci0L7QstCw0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIGNhcmRzX2RhdGEgPSBzZWxmLl9nZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9nb29kc190eXBlJykpCiAgICAgICAgZ29vZHNfY2FyZHMgPSBzZWxmLl9nZXRfZ29vZHNfY2FyZHNfdmlldyhjYXJkc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RzX2NhcmRzJ10gPSBnb29kc19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gIiIKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzY3JlZW5fdmFsdWVzID0geydpdGVtX2lkJzogc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXX0KICAgICAgICAgICAgSXRlbUNhcmQoc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvdyhhcmdzPXNjcmVlbl92YWx1ZXMpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAic2VsZWN0X2dvb2RzX3R5cGUiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQktGL0LHQvtGAINC60LDRgtC10LPQvtGA0LjQuCDRgtC+0LLQsNGA0L7QsiIpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5faWRlbnRpZnlfYmFyY29kZV9nb29kcygpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9nZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGYsIHNlbGVjdGVkX2dvb2RfdHlwZT1Ob25lKSAtPiBsaXN0OgogICAgICAgIHJlc3VsdHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxlY3RlZF9nb29kX3R5cGUpCiAgICAgICAgY2FyZHNfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBzaW5nbGVfY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWQnXSwKICAgICAgICAgICAgICAgICdjb2RlJzogcmVjb3JkWydjb2RlJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZFsnbmFtZSddLAogICAgICAgICAgICAgICAgJ2FydCc6IHJlY29yZFsnYXJ0J10gaWYgcmVjb3JkWydhcnQnXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgJ3VuaXQnOiByZWNvcmRbJ3VuaXQnXSBpZiByZWNvcmRbJ3VuaXQnXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgJ3R5cGVfZ29vZCc6IHJlY29yZFsndHlwZV9nb29kJ10sCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiByZWNvcmRbJ2Rlc2NyaXB0aW9uJ10gaWYgcmVjb3JkWydkZXNjcmlwdGlvbiddIGVsc2UgIuKAlCIKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXJkc19kYXRhLmFwcGVuZChzaW5nbGVfY2FyZF9kYXRhKQoKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2dvb2RzX2NhcmRzX3ZpZXcoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpCgogICAgICAgIGdvb2RzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyM3QTAwNUMnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNvZGUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BhcnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdHlwZV9nb29kJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZ29vZHNfY2FyZHMKCiAgICBkZWYgX2lkZW50aWZ5X2JhcmNvZGVfZ29vZHMoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKToKICAgICAgICAgICAgYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJykKICAgICAgICAgICAgdmFsdWVzID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfZnJvbV9iYXJjb2RlKCJiYXJjb2RlIiwgYmFyY29kZSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnaXRlbV9pZCddID0gdmFsdWVzWzBdWydpZF9nb29kJ10KICAgICAgICAgICAgICAgIEl0ZW1DYXJkKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3coKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0KLQvtCy0LDRgCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSDQv9C+INGI0YLRgNC40YXQutC+0LTRgycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQoKCmNsYXNzIFNlbGVjdEdvb2RzVHlwZShTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JLRi9Cx0L7RgCDQutCw0YLQtdCz0L7RgNC40Lgg0YLQvtCy0LDRgNC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0KLQvtCy0LDRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGdvb2RzX3R5cGVzX2RhdGEgPSBzZWxmLl9nZXRfZ29vZHNfdHlwZXNfZGF0YSgpCiAgICAgICAgZ29vZHNfdHlwZXNfY2FyZHMgPSBzZWxmLl9nZXRfZ29vZHNfdHlwZXNfY2FyZHNfdmlldyhnb29kc190eXBlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RzX3R5cGVzX2NhcmRzJ10gPSBnb29kc190eXBlc19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gIiIKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9kYXRhIiwgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIHR5cGVfaWQgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgICAgIHR5cGVfbmFtZSA9IGNhcmRfZGF0YVsnbmFtZSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RfZ29vZHNfdHlwZScsIHR5cGVfbmFtZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2dvb2RzX3R5cGUnLCB0eXBlX2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0X2dvb2RzX3R5cGUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2dvb2RzX3R5cGUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkJhY2tTY3JlZW4iLCAiIikKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9nZXRfZ29vZHNfdHlwZXNfZGF0YShzZWxmKToKICAgICAgICBnb29kc190eXBlc19kYXRhX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfYWxsX2dvb2RzX3R5cGVzX2RhdGEoKQogICAgICAgIGdvb2RzX3R5cGVzX2RhdGEgPSBbXQogICAgICAgIGZvciByZWNvcmQgaW4gZ29vZHNfdHlwZXNfZGF0YV9yZXN1bHQ6CiAgICAgICAgICAgIHNpbmdsZV9jYXJkX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZCddLAogICAgICAgICAgICAgICAgJ25hbWUnOiByZWNvcmRbJ25hbWUnXSwKICAgICAgICAgICAgfQogICAgICAgICAgICBnb29kc190eXBlc19kYXRhLmFwcGVuZChzaW5nbGVfY2FyZF9kYXRhKQogICAgICAgIHJldHVybiBnb29kc190eXBlc19kYXRhCgogICAgZGVmIF9nZXRfZ29vZHNfdHlwZXNfY2FyZHNfdmlldyhzZWxmLCBnb29kc190eXBlc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCgogICAgICAgIHR5cGVfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1nb29kc190eXBlc19kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdHlwZV9jYXJkcwoKCmNsYXNzIEl0ZW1DYXJkKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQmtCw0YDRgtC+0YfQutCwINGC0L7QstCw0YDQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQotC+0LLQsNGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXBbJ2l0ZW1faWQnXSwKICAgICAgICB9CiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgICAgICAnQ2FyZHNDbGljayc6IHNlbGYuX3ByaW50X3RpY2tldCwKICAgICAgICAgICAgJ2J0bl9wcmludCc6IHNlbGYuX3ByaW50X3RpY2tldCwKICAgICAgICAgICAgJ3RvX3ByaWNlcyc6IHNlbGYuX3RvX3ByaWNlcywKICAgICAgICAgICAgJ3RvX2JhbGFuY2VzJzogc2VsZi5fdG9fYmFsYW5jZXMsCiAgICAgICAgICAgICdidG5faXRlbV9nb29kX2JhcmNvZGUnOiBzZWxmLl9oYW5kbGVfYmFyY29kZV9yZWdpc3RlciwKCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fcHJvcGVydGllcyA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2Zyb21fYmFyY29kZSgiaWRfZ29vZCIsIHNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQoKICAgICAgICBpZiBpdGVtX3Byb3BlcnRpZXM6CiAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzX2RhdGEgPSBzZWxmLl9nZXRfdmFyaWFudHNfY2FyZHNfZGF0YShpdGVtX3Byb3BlcnRpZXMpCiAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzID0gc2VsZi5fZ2V0X3ZhcmlhbnRzX2NhcmRzX3ZpZXcodmFyaWFudHNfY2FyZHNfZGF0YSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnYmFyY29kZV9jYXJkcyddID0gdmFyaWFudHNfY2FyZHMudG9fanNvbigpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJsb2FkX2luZm8iLCAiIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgibG9hZF9pbmZvIiwgItCU0LDQvdC90YvQtSDQviDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCw0YUg0L7RgtGB0YPRgtGB0YLQstGD0Y7RgiIpCgoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzdXBlcigpLmluaXRfc2NyZWVuKCkKCiAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9pdGVtX2RhdGFfYnlfaWQoaXRlbV9pZD1zZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKICAgICAgICBpZiBpdGVtX2RhdGE6CiAgICAgICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAgICAgImdvb2RfbmFtZSI6IGl0ZW1fZGF0YVsnbmFtZSddLAogICAgICAgICAgICAgICAgImdvb2RfYXJ0IjogaXRlbV9kYXRhWydhcnQnXSBpZiBpdGVtX2RhdGFbJ2FydCddIGVsc2UgIuKAlCIsCiAgICAgICAgICAgICAgICAiZ29vZF9jb2RlIjogaXRlbV9kYXRhWydjb2RlJ10sCiAgICAgICAgICAgICAgICAiZ29vZF9kZXNjciI6IGl0ZW1fZGF0YVsnZGVzY3JpcHRpb24nXSBpZiBpdGVtX2RhdGFbJ2Rlc2NyaXB0aW9uJ10gZWxzZSAi4oCUIiwKICAgICAgICAgICAgICAgICJnb29kX3R5cGUiOiBpdGVtX2RhdGFbJ3R5cGVfZ29vZCddLAogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLl9jbGVhcl9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnYmFyY29kZV9jYXJkcycpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLmhhc2hfbWFwWydwYXJlbnRfc2NyZWVuJ10pCgogICAgZGVmIF90b19iYWxhbmNlcyhzZWxmKToKICAgICAgICBkaWN0X2RhdGEgPSB7CiAgICAgICAgICAgICdpbnB1dF9pdGVtX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1faWQnKSwKICAgICAgICAgICAgJ2l0ZW1fYXJ0X2lucHV0Jzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JyksCiAgICAgICAgICAgICdzZWxlY3RlZF9vYmplY3RfbmFtZSc6IGYne3NlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX25hbWUiKX0sIHtzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9jb2RlIil9JywKICAgICAgICAgICAgJ29iamVjdF9uYW1lJzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfbmFtZScpLAogICAgICAgICAgICAicmV0dXJuX3RvX2l0ZW1fY2FyZCI6ICJ0cnVlIiwKICAgICAgICAgICAgJ1Nob3dQcm9jZXNzUmVzdWx0JzogJ9Ce0YHRgtCw0YLQutC4fNCf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCcsCiAgICAgICAgICAgICJub1JlZnJlc2giOiAnJwogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX3RvX3ByaWNlcyhzZWxmKToKICAgICAgICBkaWN0X2RhdGEgPSB7CiAgICAgICAgICAgICdpbnB1dF9nb29kX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1faWQnKSwKICAgICAgICAgICAgJ2lucHV0X2dvb2RfYXJ0Jzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JyksCiAgICAgICAgICAgICdwcmljZXNfb2JqZWN0X25hbWUnOiBmJ3tzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9uYW1lIil9LCB7c2VsZi5oYXNoX21hcC5nZXQoImdvb2RfY29kZSIpfScsCiAgICAgICAgICAgICJyZXR1cm5fdG9faXRlbV9jYXJkIjogInRydWUiLAogICAgICAgICAgICAnb2JqZWN0X25hbWUnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9uYW1lJyksCiAgICAgICAgICAgICdTaG93UHJvY2Vzc1Jlc3VsdCc6ICfQptC10L3Ri3zQn9GA0L7QstC10YDQutCwINGG0LXQvScsCiAgICAgICAgICAgICJub1JlZnJlc2giOiAnJwogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX2hhbmRsZV9iYXJjb2RlX3JlZ2lzdGVyKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9pZCcpLAogICAgICAgICAgICAncHJvcGVydHlfaWQnOiAnJywKICAgICAgICAgICAgJ3VuaXRfaWQnOiAnJwogICAgICAgIH0KICAgICAgICBCYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3dfcHJvY2Vzc19yZXN1bHQoaW5pdF9kYXRhKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3ZhcmlhbnRzX2NhcmRzX2RhdGEoaXRlbV9wcm9wZXJ0aWVzKToKICAgICAgICB2YXJpYW50c19jYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgaSwgZWxlbWVudCBpbiBlbnVtZXJhdGUoaXRlbV9wcm9wZXJ0aWVzKToKICAgICAgICAgICAgdmFyaWFudHNfY2FyZHNfZGF0YS5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImtleSI6IHN0cihpKSwKICAgICAgICAgICAgICAgICAgICAiYmFyY29kZSI6IGVsZW1lbnRbJ2JhcmNvZGUnXSwKICAgICAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6IGVsZW1lbnRbJ3Byb3BlcnR5J10gaWYgZWxlbWVudFsncHJvcGVydHknXSBlbHNlICIiLAogICAgICAgICAgICAgICAgICAgICJ1bml0IjogZWxlbWVudFsndW5pdCddLAogICAgICAgICAgICAgICAgICAgICJzZXJpZXMiOiBlbGVtZW50WydzZXJpZXMnXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIHZhcmlhbnRzX2NhcmRzX2RhdGEKCiAgICBkZWYgX2dldF92YXJpYW50c19jYXJkc192aWV3KHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZScpIGVsc2UgMjAKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKSBpZiBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykgZWxzZSAxNQoKICAgICAgICB2YXJpYW50c19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0aWVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHVuaXQnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGJhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzZXJpZXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gdmFyaWFudHNfY2FyZHMKCiAgICBkZWYgX3ByaW50X3RpY2tldChzZWxmKToKICAgICAgICBjdXJyZW50X2NhcmQgPSBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKCkKCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBjdXJyZW50X2NhcmQuZ2V0KCdiYXJjb2RlJywgJzAwMDAwMDAwMDAwMDAnKSwKICAgICAgICAgICAgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiBjdXJyZW50X2NhcmQuZ2V0KCdwcm9wZXJ0aWVzJywgJycpLAogICAgICAgICAgICAn0KPQv9Cw0LrQvtCy0LrQsCc6IGN1cnJlbnRfY2FyZC5nZXQoJ3VuaXQnLCAnJykKICAgICAgICB9CgogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YShzZWxmKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9CiAgICAgICAgY2FyZF9rZXkgPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9rZXknKQogICAgICAgIGNhcmRzID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiYmFyY29kZV9jYXJkcyIpCgogICAgICAgIGlmIGNhcmRfa2V5IGFuZCBjYXJkczoKICAgICAgICAgICAgcmVzdWx0ID0gY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjYXJkX2tleSldCgogICAgICAgIHJldHVybiByZXN1bHQKCmNsYXNzIEl0ZW1DYXJkT2ZmbGluZVNjcmVlbihJdGVtQ2FyZCk6CgogICAgZGVmIF90b19wcmljZXMoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygncHJpY2VzX25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQt9Cw0L/RgNC+0YEg0YbQtdC9INC90LXQtNC+0YHRgtGD0L/QtdC9JykKCiAgICBkZWYgX3RvX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ2JhbGFuY2VzX25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQt9Cw0L/RgNC+0YEg0L7RgdGC0LDRgtC60L7QsiDQvdC10LTQvtGB0YLRg9C/0LXQvScpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygncHJpbnRfdGlja2V0X25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQv9C10YfQsNGC0Ywg0L3QtdC00L7RgdGC0YPQv9C90LAnKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHMoUHJvY2VzcykgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kc0JhbGFuY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc0JhbGFuY2VzSXRlbUNhcmQoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQntGB0YLQsNGC0LrQuCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgc2VsZi50YWJsZV90eXBlID0gJ3dhcmVob3VzZXMnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF9vYmplY3RfbmFtZScsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfY2VsbF9uYW1lJywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF93aF9uYW1lJywKICAgICAgICAgICAgICAgICdpdGVtX2JhcmNvZGUnCiAgICAgICAgICAgIF0KICAgICAgICApCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYWxhbmNlc190YWJsZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfYmFsYW5jZXNfY29udHJvbHMiLCAiMSIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICItMSIpCgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ25ld19hcnQnKToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfaXRlbV92YXJpYW50cygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnd2hfc2VsZWN0JzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X3doKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd3aF9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF93aF9yZXN1bHQoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2dldF9iYWxhbmNlX2J0bic6CiAgICAgICAgICAgIHNlbGYuX2dldF9iYWxhbmNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2lkZW50aWZ5X2JhcmNvZGVfYmFsYW5jZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuX3Jlc2V0X2JhbGFuY2VzX3RhYmxlcygpCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2Vzc1Jlc3VsdCIsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnc2hvd19maWx0ZXJzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJywgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZiJ7Y2FyZF9kYXRhWyduYW1lJ119LCB7Y2FyZF9kYXRhWydjb2RlJ119IiwKICAgICAgICAgICAgICAgICAgICAiaW5wdXRfaXRlbV9pZCI6IGNhcmRfZGF0YVsnaWQnXSwgJ2l0ZW1fY29kZSc6IGNhcmRfZGF0YVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICd2YXJpYW50X3NlbGVjdGVkJzogVHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCduZXdfYXJ0JykKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgn0JLRi9Cx0LXRgNC40YLQtSDQstCw0YDQuNCw0L3RgiDRgtC+0LLQsNGA0LA6Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9iYWxhbmNlc19jb250cm9scyIsICIxIikKCiAgICBkZWYgX2dldF9iYWxhbmNlcyhzZWxmKToKICAgICAgICBpZiAoc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykgIT0gc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JykKICAgICAgICAgICAgYW5kIG5vdCBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCd2YXJpYW50X3NlbGVjdGVkJykpOgoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19hcnQnLCBUcnVlKQogICAgICAgICAgICBzZWxmLnZhbGlkYXRlX2lucHV0KCkKCiAgICAgICAgcmF3X2JhbGFuY2VzX2RhdGEgPSBzZWxmLl9nZXRfYmFsYW5jZXNfZGF0YSgpCiAgICAgICAgYmFsYW5jZXNfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShyYXdfYmFsYW5jZXNfZGF0YSkKICAgICAgICBiYWxhbmNlc190YWJsZSA9IHNlbGYuX2dldF9iYWxhbmNlc190YWJsZV92aWV3KGJhbGFuY2VzX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoewogICAgICAgICAgICAgICAgJ2JhbGFuY2VzX3RhYmxlJzogYmFsYW5jZXNfdGFibGUudG9fanNvbigpLAogICAgICAgICAgICAgICAgJ1Nob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzJzogJy0xJywKICAgICAgICAgICAgICAgICdTaG93X3Nob3dfZmlsdGVycyc6ICcxJywKICAgICAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICcnLAogICAgICAgICAgICAgICAgJ2Zyb21fYmFyY29kZSc6IEZhbHNlLAogICAgICAgICAgICAgICAgJ2l0ZW1fY29kZSc6ICcnLAogICAgICAgICAgICAgICAgJ3ZhcmlhbnRfc2VsZWN0ZWQnOiBGYWxzZQogICAgICAgICAgICB9KQoKICAgIGRlZiBfc2VsZWN0X3doKHNlbGYpOgogICAgICAgIFNlbGVjdEl0ZW1TY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX3dhcmVob3VzZXMnLAogICAgICAgICAgICByZXN1bHRfbGlzdGVuZXI9J3doX3NlbGVjdF9zdWNjZXNzJywKICAgICAgICAgICAgdGl0bGU9J9CS0YvQsdC10YDQuNGC0LUg0YHQutC70LDQtCcKICAgICAgICApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X3doX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxlY3RlZF93aCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX3doOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd3aF9zZWxlY3QnXSA9IHNlbGVjdGVkX3doLmdldCgnbmFtZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnd2hfc2VsZWN0J10gPSAnJwoKICAgIGRlZiB2YWxpZGF0ZV9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KCkKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2NlbGwoKQoKICAgICAgICBpZiBub3QgKHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0Jykgb3Igc2VsZi5oYXNoX21hcC5nZXQoJ3doX3NlbGVjdCcpCiAgICAgICAgICAgICAgICBvciBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2VsbF9pZCcpKToKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoewogICAgICAgICAgICAgICAgICAgICdiYWxhbmNlc190YWJsZXMnOiAnJywKICAgICAgICAgICAgICAgICAgICAnb2JqZWN0X25hbWUnOiAnJywKICAgICAgICAgICAgICAgICAgICAnY2VsbF9uYW1lJzogJycsCiAgICAgICAgICAgICAgICAgICAgJ2Vycm9yX21zZyc6ICLQlNC+0LvQttC10L0g0LHRi9GC0Ywg0LLRi9Cx0YDQsNC9INGB0LrQu9Cw0LQsINGC0L7QstCw0YAg0LjQu9C4INGP0YfQtdC50LrQsCIKICAgICAgICAgICAgICAgIH0pCgogICAgZGVmIF9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0Jyk6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICdvYmplY3RfbmFtZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnbmFtZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnaW5wdXRfaXRlbV9pZCc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZid7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJuYW1lIl19LCB7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJjb2RlIl19JywKICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW1fY29kZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtX2FydF9pbnB1dCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpLAogICAgICAgICAgICAgICAgICAgICAgICAnaXRlbV9iYXJjb2RlJzogJycKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQgIT0gJ+KAlCcgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsIGYiINCi0L7QstCw0YAg0YEg0LDRgNGC0LjQutGD0LvQvtC8ICd7aXRlbV9hcnRfaW5wdXR9JyAg0L3QtSDQvdCw0LnQtNC10L0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9pdGVtX2lkJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCAnJykKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfY2VsbChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnY2VsbF9pbnB1dCcpOgogICAgICAgICAgICBjZWxsX3ZhbHVlc19yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX2NlbGxzJywKICAgICAgICAgICAgICAgIGZpZWxkPSduYW1lJywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0JykKICAgICAgICAgICAgKQoKICAgICAgICAgICAgaWYgY2VsbF92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi50YWJsZV90eXBlID0gJ2NlbGxzJwogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCBjZWxsX3ZhbHVlc19yZXN1bHRbMF1bJ2lkJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2VsbF9uYW1lJywgc2VsZi5oYXNoX21hcC5nZXQoJ2NlbGxfaW5wdXQnKSkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjdXJyZW50X2Vycm9yID0gZiJ7c2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ119XG4iIGlmIHNlbGYuaGFzaF9tYXBbJ2Vycm9yX21zZyddIGVsc2UgJycKICAgICAgICAgICAgICAgIGVycm9yX3RleHQgPSAne33Qr9GH0LXQudC60LAgYyDQuNC80LXQvdC10Lwge30g0L3QtSDQvdCw0LnQtNC10L3QsCcuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZXJyb3IsIHNlbGYuaGFzaF9tYXBbJ2NlbGxfaW5wdXQnXQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ10gPSBlcnJvcl90ZXh0CiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgJycpCgogICAgZGVmIF9pZGVudGlmeV9iYXJjb2RlX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIG5vX2RhdGEgPSBGYWxzZQogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19iYXJjb2RlcyIsCiAgICAgICAgICAgIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKQogICAgICAgICkKCiAgICAgICAgaWYgYmFyY29kZV9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKSkKCiAgICAgICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5Jyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJvcGVydHlfaWQnLCBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9wcm9wZXJ0eScpKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfZ29vZCcpOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IGJhcmNvZGVfZGF0YVswXVsnaWRfZ29vZCddCgogICAgICAgICAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfZ29vZHMiLAogICAgICAgICAgICAgICAgICAgIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9aXRlbV9pZAogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGlmIGl0ZW1fZGF0YVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfaXRlbV9pZCcsIGl0ZW1faWQpCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdWydhcnQnXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2l0ZW1fYXJ0X2lucHV0JywgaXRlbV9kYXRhWzBdWydhcnQnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9hcnRfaW5wdXQnLCAn4oCUJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCBmJ3tpdGVtX2RhdGFbMF1bIm5hbWUiXX0sICB7aXRlbV9kYXRhWzBdWyJjb2RlIl19JykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdmcm9tX2JhcmNvZGUnLCBUcnVlKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgJycpCiAgICAgICAgICAgIGNlbGxfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfY2VsbHMiLCBmaWVsZD0nYmFyY29kZScsCiAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGNlbGxfZGF0YToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgY2VsbF9kYXRhWzBdWydpZCddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsIGNlbGxfZGF0YVswXVsnbmFtZSddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfaW5wdXQnLCBjZWxsX2RhdGFbMF1bJ25hbWUnXSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5vX2RhdGEgPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAi0KjRgtGA0LjRhdC60L7QtCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSIpCiAgICAgICAgaWYgbm90IG5vX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2dldF9iYWxhbmNlcygpCgogICAgZGVmIF9yZXNldF9iYWxhbmNlc190YWJsZXMoc2VsZik6CiAgICAgICAgdmFyc19saXN0ID0gWyd3aF9zZWxlY3QnLCAnaW5wdXRfaXRlbV9pZCcsICdjZWxsX2lucHV0JywgJ2NlbGxfbmFtZScsICdvYmplY3RfbmFtZScsICdlcnJvcl9tc2cnLAogICAgICAgICAgICAgICAgICAgICAnYmFsYW5jZXNfdGFibGUnLCAnYmFyY29kZScsICdzZWxlY3RlZF9jZWxsX2lkJywgJ3Byb3BlcnR5X2lkJywgJ3NlbGVjdGVkX29iamVjdF9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3doX2lkJywgJ2l0ZW1fYmFyY29kZScsICdzZWxlY3RlZF93aF9uYW1lJywgJ3NlbGVjdGVkX2NlbGxfbmFtZSddCiAgICAgICAgZGljdF9kYXRhID0ge3ZhcjogIiIgZm9yIHZhciBpbiB2YXJzX2xpc3R9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShkaWN0X2RhdGEpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydChzZWxmLCBlbGVtZW50cyk6CiAgICAgICAgZm9yIHYgaW4gZWxlbWVudHM6CiAgICAgICAgICAgIG5hbWUgPSBmJ1Nob3dfe3Z9JwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW25hbWVdID0gJzEnIGlmIHNlbGYuaGFzaF9tYXBbdl0gZWxzZSAnLTEnCgogICAgZGVmIF9nZXRfYmFsYW5jZXNfZGF0YShzZWxmKToKICAgICAgICBkYXRhID0gc2VsZi5oc19zZXJ2aWNlLmdldF9iYWxhbmNlc19nb29kcygKICAgICAgICAgICAgaWRfZ29vZD1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfaXRlbV9pZCcpLAogICAgICAgICAgICBpZF9jZWxsPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jZWxsX2lkJyksCiAgICAgICAgICAgIGlkX3dhcmVob3VzZT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfd2hfaWQnKQogICAgICAgICkuZGF0YQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIHJhd19iYWxhbmNlc19kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIGZvciBlbCBpbiByYXdfYmFsYW5jZXNfZGF0YToKICAgICAgICAgICAgc3RvcmFnZV9uYW1lID0gc3RyKGVsWyduYW1lX3dhcmVob3VzZSddKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc3RyKGVsWyduYW1lX2NlbGwnXSkKCiAgICAgICAgICAgIGl0ZW1fbGF5b3V0ID0gc2VsZi5fZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoewogICAgICAgICAgICAgICAgJ3N0b3JhZ2VfbmFtZV9sZW4nOiBsZW4oc3RvcmFnZV9uYW1lKSwKICAgICAgICAgICAgICAgICdpdGVtX25hbWVfbGVuJzogbGVuKGVsWyduYW1lX2dvb2QnXSkKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIHRhYmxlX3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIoZWxbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaXRlbV9uYW1lJzogc3RyKGVsWyduYW1lX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnc3RvcmFnZV9uYW1lJzogc3RvcmFnZV9uYW1lLAogICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIoZWxbJ3F0dHknXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllcyc6IHN0cihlbFsnbmFtZV9wcm9wZXJ0eSddIG9yICfigJQnKSwKICAgICAgICAgICAgICAgICdfbGF5b3V0JzogaXRlbV9sYXlvdXQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfaWQnKSA9PSBzdHIoZWxbJ2lkX3Byb3BlcnR5J10pOgogICAgICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9iYWxhbmNlc190YWJsZV92aWV3KHNlbGYsIGRhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0LrQu9Cw0LQnKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC+0LLQsNGAJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQmtC+0LvQuNGH0LXRgdGC0LLQvicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQuCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnCiAgICAgICAgICAgICksCgogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT1kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoc2VsZiwgcm93X2RhdGEpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHN0b3JhZ2VfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcKCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JyBpZiByb3dfZGF0YVsnc3RvcmFnZV9uYW1lX2xlbiddIDwgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSBlbHNlICd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGl0ZW1fbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcgaWYgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSA8IHJvd19kYXRhWydzdG9yYWdlX25hbWVfbGVuJ10gZWxzZSAnd3JhcF9jb250ZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByb3BlcnRpZXMnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRjBGOEZGJywKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfY2hlY2tfaXRlbV92YXJpYW50cyhzZWxmKToKICAgICAgICBpdGVtX2FydF9pbnB1dCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpCiAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQ6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGl0ZW1fdmFsdWVzX3Jlc3VsdDoKICAgICAgICAgICAgICAgIGlmIGxlbihpdGVtX3ZhbHVlc19yZXN1bHQpID4gMToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnLCAnJykKICAgICAgICAgICAgICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnKSBlbHNlIDE4CgogICAgICAgICAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSksCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNkYXRhPWl0ZW1fdmFsdWVzX3Jlc3VsdAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtX3ZhcmlhbnRzJ10gPSB2YXJpYW50c19jYXJkcy50b19qc29uKCkKCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXI9J9CS0YvQsdC10YDQuNGC0LUg0LLQsNGA0LjQsNC90YIg0YLQvtCy0LDRgNCwOicsCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyfQktGL0LHRgNCw0YLRjCcsICfQntGC0LzQtdC90LAnXQogICAgICAgICAgICAgICAgICAgICkKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc0JhbGFuY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzUHJpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc1ByaWNlc0l0ZW1DYXJkKEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9GA0L7QstC10YDQutCwINGG0LXQvScKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoCiAgICAgICAgICAgIFsncHJpY2VzX2Vycm9yX21zZycsICdwcmljZXNfb2JqZWN0X25hbWUnLCAnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywKICAgICAgICAgICAgJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJ2JhcmNvZGVfaW5mbyddKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3ByaWNlc190YWJsZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKCiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICdwcmljZV90eXBlX3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdwcm9wZXJ0eV9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndW5pdF9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJpY2VfdHlwZV9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgncHJpY2VfdHlwZV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Byb3BlcnR5X3NlbGVjdF9zdWNjZXNzJzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCdwcm9wZXJ0eV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3VuaXRfc2VsZWN0X3N1Y2Nlc3MnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3VuaXRfc2VsZWN0JykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdnZXRfcHJpY2VzX2J0bic6CiAgICAgICAgICAgIHNlbGYuX2dldF9wcmljZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9pZGVudGlmeV9iYXJjb2RlX3ByaWNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fcmVzZXRfcHJpY2VzX3RhYmxlcygpCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2Vzc1Jlc3VsdCIsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdzaG93X2ZpbHRlcnMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NlbGVjdF9pdGVtKHNlbGYpOgogICAgICAgIGl0ZW1fdGFibGVzID0gewogICAgICAgICAgICAncHJpY2VfdHlwZV9zZWxlY3QnOiAnUlNfcHJpY2VfdHlwZXMnLAogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0JzogJ1JTX3Byb3BlcnRpZXMnLAogICAgICAgICAgICAndW5pdF9zZWxlY3QnOiAnUlNfdW5pdHMnLAogICAgICAgIH0KICAgICAgICBpdGVtX3R5cGUgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIFNlbGVjdEl0ZW1TY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIHRhYmxlX25hbWU9aXRlbV90YWJsZXNbaXRlbV90eXBlXSwKICAgICAgICAgICAgcmVzdWx0X2xpc3RlbmVyPWYne2l0ZW1fdHlwZX1fc3VjY2VzcycKICAgICAgICApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2l0ZW1fcmVzdWx0KHNlbGYsIGZpZWxkX25hbWUpOgogICAgICAgIHNlbGVjdGVkX2NhcmQgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jYXJkOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW2ZpZWxkX25hbWVdID0gc2VsZWN0ZWRfY2FyZC5nZXQoJ25hbWUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSAnJwoKICAgIGRlZiBfZ2V0X3ByaWNlcyhzZWxmKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgcmF3X3ByaWNlc19kYXRhID0gc2VsZi5fZ2V0X3ByaWNlc19kYXRhKCkKICAgICAgICBwcmljZXNfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShyYXdfcHJpY2VzX2RhdGEpCiAgICAgICAgcHJpY2VzX3RhYmxlID0gc2VsZi5fZ2V0X3ByaWNlc190YWJsZV92aWV3KHByaWNlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfdGFibGUnLCBwcmljZXNfdGFibGUudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9wcmljZXNfY29udHJvbHMiLCAiLTEiKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICIxIikKCiAgICBkZWYgX3ZhbGlkYXRlX2lucHV0KHNlbGYpOgogICAgICAgIHNlbGYuX3Byb2Nlc3NfaW5wdXRfZ29vZF9hcnQoKQogICAgICAgIGlmIG5vdCAoc2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfYXJ0JykpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX3RhYmxlcycsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCU0L7Qu9C20LXQvSDQsdGL0YLRjCDQstGL0LHRgNCw0L0g0YLQvtCy0LDRgCIpCgogICAgZGVmIF9wcm9jZXNzX2lucHV0X2dvb2RfYXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfYXJ0JykKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2lucHV0X2dvb2RfaWQnOiAnJywKICAgICAgICAgICAgJ3ByaWNlc19vYmplY3RfbmFtZSc6ICcnLAogICAgICAgICAgICAnZXJyb3JfbXNnJzogJycKICAgICAgICB9CgogICAgICAgIGlmIGl0ZW1fYXJ0X2lucHV0OgogICAgICAgICAgICBpdGVtX3ZhbHVlc19yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX2dvb2RzJywgZmllbGQ9J2FydCcsIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0KQoKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgJ2lucHV0X2dvb2RfaWQnOiBpdGVtX3ZhbHVlc19yZXN1bHRbMF1bJ2lkJ10sCiAgICAgICAgICAgICAgICAgICAgJ2dvb2RfY29kZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICdwcmljZXNfb2JqZWN0X25hbWUnOiBmJ3tpdGVtX3ZhbHVlc19yZXN1bHRbMF1bIm5hbWUiXX0sICdmJ3tpdGVtX3ZhbHVlc19yZXN1bHRbMF1bImNvZGUiXX0nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBpdGVtX2FydF9pbnB1dCAhPSAn4oCUJyBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ3JldHVybl90b19pdGVtX2NhcmQnKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgZiIg0KLQvtCy0LDRgCDRgSDQsNGA0YLQuNC60YPQu9C+0LwgJ3tpdGVtX2FydF9pbnB1dH0nINC90LUg0L3QsNC50LTQtdC9IikKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgX2lkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX2luZm8nLCBzdHIoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsICcnKQogICAgICAgIG5vX2RhdGEgPSBGYWxzZQoKICAgICAgICBiYXJjb2RlX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSJSU19iYXJjb2RlcyIsIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpKQogICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXToKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfcHJvcGVydHknKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5JykpCiAgICAgICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0nUlNfcHJvcGVydGllcycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9YmFyY29kZV9kYXRhWzBdLmdldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JykpCiAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdLmdldCgnbmFtZScpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgc2VsZWN0ZWRfcHJvcGVydHlfbmFtZVswXS5nZXQoJ25hbWUnKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnJykKCiAgICAgICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX2dvb2QnKToKICAgICAgICAgICAgICAgIGl0ZW1faWQgPSBiYXJjb2RlX2RhdGFbMF1bJ2lkX2dvb2QnXQoKICAgICAgICAgICAgICAgIGl0ZW1fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9IlJTX2dvb2RzIiwgZmllbGQ9J2lkJywgZmllbGRfdmFsdWU9aXRlbV9pZCkKICAgICAgICAgICAgICAgIGlmIGl0ZW1fZGF0YVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9pZCcsIGl0ZW1faWQpCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdWydhcnQnXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2lucHV0X2dvb2RfYXJ0JywgaXRlbV9kYXRhWzBdWydhcnQnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9hcnQnLCAn4oCUJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgaXRlbV9kYXRhWzBdWyduYW1lJ10pCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICIiKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBub19kYXRhID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICLQqNGC0YDQuNGF0LrQvtC0INC90LUg0YDQsNGB0L/QvtC30L3QsNC9IikKCiAgICAgICAgaWYgbm90IG5vX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2dldF9wcmljZXMoKQoKICAgIGRlZiBfcmVzZXRfcHJpY2VzX3RhYmxlcyhzZWxmKToKICAgICAgICB2YXJzX2xpc3QgPSBbJ2lucHV0X2dvb2RfYXJ0JywgJ3ByaWNlc19vYmplY3RfbmFtZScsICdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgJ3NlbGVjdGVkX3ByaWNlX3R5cGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICdwcmljZV90eXBlX3NlbGVjdCcsICdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgJ3Byb3BlcnR5X3NlbGVjdCcsCiAgICAgICAgICAgICAgICAgICAgICdzZWxlY3RlZF91bml0X2lkJywgJ3NlbGVjdGVkX3VuaXRfbmFtZScsICd1bml0X3NlbGVjdCcsICdwcmljZXNfY3VzdG9tX3RhYmxlJywgJ2lucHV0X2dvb2RfaWQnLAogICAgICAgICAgICAgICAgICAgICAnYmFyY29kZScsICdiYXJjb2RlX2luZm8nLCAncHJpY2VzX3RhYmxlJ10KICAgICAgICBkaWN0X2RhdGEgPSB7dmFyOiAiIiBmb3IgdmFyIGluIHZhcnNfbGlzdH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYsIGVsZW1lbnRzKToKICAgICAgICBmb3IgdiBpbiBlbGVtZW50czoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICBkZWYgX2dldF9wcmljZXNfZGF0YShzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3Byb3BlcnR5X3NlbGVjdCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnJykKCiAgICAgICAgZGF0YSA9IHNlbGYuaHNfc2VydmljZS5nZXRfcHJpY2VzX2dvb2RzKGlkX2dvb2Q9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfcHJvcGVydHk9c2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3VuaXQ9c2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX3VuaXRfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfcHJpY2VfdHlwZT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfcHJpY2VfdHlwZV9pZCcpKS5kYXRhCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCByYXdfYmFsYW5jZXNfZGF0YSk6CgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgZm9yIGVsIGluIHJhd19iYWxhbmNlc19kYXRhOgogICAgICAgICAgICB0YWJsZV9yb3cgPSB7J2tleSc6IHN0cihlbFsnaWRfZ29vZCddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICdwcmljZV90eXBlJzogc3RyKGVsWyduYW1lX3ByaWNlX3R5cGUnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAncHJpY2UnOiBzdHIoZWxbJ3ByaWNlJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3VuaXQnOiBzdHIoZWxbJ25hbWVfdW5pdCddKSBvciAn4oCUJywKICAgICAgICAgICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzJzogc3RyKGVsWyduYW1lX3Byb3BlcnR5J10gb3IgJ+KAlCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBzZWxmLl9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyhlbCl9CiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9wcmljZXNfdGFibGVfdmlldyhzZWxmLCBkYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC40L8g0YbQtdC90YsnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LgnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cm0LXQvdCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQo9C/0LDQutC+0LLQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0YwRjhGRicKICAgICAgICAgICAgKSwKCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPWRhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyhzZWxmLCByb3dfZGF0YSk6CgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByaWNlX3R5cGUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvcGVydGllcycsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJpY2UnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdW5pdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgpjbGFzcyBTZWxlY3RQcm9wZXJ0aWVzKEdvb2RzUHJpY2VzSXRlbUNhcmQpOgogICAgc2NyZWVuX25hbWUgPSAn0JLRi9Cx0L7RgCDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQuicKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuX2dldF9kYXRhKCkKICAgICAgICBwcm9wZXJ0aWVzX2NhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Byb3BlcnR5X2NhcmRzJywgcHJvcGVydGllc19jYXJkcy50b19qc29uKCkpCgogICAgZGVmIF9nZXRfZGF0YShzZWxmKToKICAgICAgICB0YWJsZV9uYW1lID0gIlJTX3Byb3BlcnRpZXMiCiAgICAgICAgcmF3X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lLCBmaWVsZD0naWRfb3duZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSkKICAgICAgICBjYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgZWxlbWVudCBpbiByYXdfZGF0YToKICAgICAgICAgICAgY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGVsZW1lbnRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IGVsZW1lbnRbJ25hbWUnXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzX2RhdGEuYXBwZW5kKGNhcmRfZGF0YSkKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgICwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gY2FyZHMKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZWN0ZWRfcHJvcGVydHlfaWQgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0nUlNfcHJvcGVydGllcycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxlY3RlZF9wcm9wZXJ0eV9pZClbMF1bJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnLCBzZWxlY3RlZF9wcm9wZXJ0eV9pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsncHJvcGVydHlfc2VsZWN0J10gPSBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnXSA9IHNlbGVjdGVkX3Byb3BlcnR5X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiIG9yICdiYWNrX3RvX3ByaWNlcyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJ10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKCmNsYXNzIFNlbGVjdFVuaXQoR29vZHNQcmljZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQktGL0LHQvtGAINGD0L/QsNC60L7QstC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0KbQtdC90YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCiAgICAgICAgc2VsZi5fdmFsaWRhdGVfaW5wdXQoKQogICAgICAgIGNhcmRzX2RhdGEgPSBzZWxmLl9nZXRfZGF0YSgpCiAgICAgICAgcHJvcGVydGllc19jYXJkcyA9IHNlbGYuX2dldF9jYXJkcyhjYXJkc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd1bml0X2NhcmRzJywgcHJvcGVydGllc19jYXJkcy50b19qc29uKCkpCgogICAgZGVmIF9nZXRfZGF0YShzZWxmKToKICAgICAgICB0YWJsZV9uYW1lID0gIlJTX3VuaXRzIgogICAgICAgIHJhd19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZSwgZmllbGQ9J2lkX293bmVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykpCiAgICAgICAgY2FyZHNfZGF0YSA9IFtdCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gcmF3X2RhdGE6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBlbGVtZW50WydpZCddLAogICAgICAgICAgICAgICAgJ25hbWUnOiBlbGVtZW50WyduYW1lJ10KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXJkc19kYXRhLmFwcGVuZChjYXJkX2RhdGEpCiAgICAgICAgcmV0dXJuIGNhcmRzX2RhdGEKCiAgICBkZWYgX2dldF9jYXJkcyhzZWxmLCBjYXJkc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykKCiAgICAgICAgY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApKQogICAgICAgICAgICAsCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCiAgICAgICAgcmV0dXJuIGNhcmRzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGVjdGVkX3VuaXRfaWQgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBzZWxlY3RlZF91bml0X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU191bml0cycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGVjdGVkX3VuaXRfaWQpWzBdWyduYW1lJ10KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfaWQnLCBzZWxlY3RlZF91bml0X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gc2VsZWN0ZWRfdW5pdF9uYW1lCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF91bml0X25hbWUnLCBzZWxlY3RlZF91bml0X25hbWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIiBvciAnYmFja190b19wcmljZXMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF91bml0X2lkJ10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfbmFtZScsICcnKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHNQcmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBTZXJpZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNlcmllc1NlbGVjdFNjcmVlbihTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1Nlcmllc1Byb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZXJpZXNTZWxlY3RTY3JlZW4nCiAgICBkb2NfYmFzaWNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZSA9ICdSU19kb2NzJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLnNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5TZXJpZXNTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0ge30KICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICd0aXRsZSc6ICfQktGL0LHQvtGAINGB0LXRgNC40LgnLAogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IHNlbGYuaGFzaF9tYXBbJ2RvY19yb3dfaWQnXSwKICAgICAgICB9CiAgICAgICAgc2VsZi51c2VfYWRyX2RvY3NfdGFibGVzID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgndXNlX2Fkcl9kb2NzX3RhYmxlcycpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYudXNlX2Fkcl9kb2NzX3RhYmxlczoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuQWRyU2VyaWVzU2VydmljZSgpCiAgICAgICAga2V5ID0gc2VsZi5zY3JlZW5fdmFsdWVzWydkb2Nfcm93X2lkJ10KICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfZm9yX3NjcmVlbl9ieV9pZChrZXkpCiAgICAgICAgIyAjINCe0LHRgNCw0LHQvtGC0LDQtdC8INGH0LjRgdC70L7QstGL0LUg0LrQu9GO0YfQuCDQsiDRgdC70L7QstCw0YDQtQogICAgICAgIHNlbGYuX2hhbmRsZV9udW1fa2V5cyhzZWxmLnNjcmVlbl9kYXRhKQogICAgICAgIHNlbGYuc2VydmljZS5wYXJhbXMgPSBzZWxmLnNjcmVlbl9kYXRhCiAgICAgICAgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RvY190aXRsZScpOgogICAgICAgICAgICB0aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgc2VsZi5zY3JlZW5fZGF0YVsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY19uJ10sCiAgICAgICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWydkb2NfZGF0ZSddCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY190aXRsZScsIHRpdGxlKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHNlbGYuc2NyZWVuX2RhdGEpCiAgICAgICAgIyBzZWxmLl9yZWZyZXNoX3RvdGFsX3F0dHkoKSDQuNC30LHRi9GC0L7Rh9C90L7QtSDRgdC+0YXRgNCw0L3QtdC90LjQtSDRhNC70LDQs9CwIHVzZV9zZXJpZXMKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdmFsdWVzWyd0aXRsZSddKQogICAgICAgIHNlbGYuaW5pdF9zY3JlZW4oKQogICAgICAgIHNlbGYuX3NldF92aXNpb25fc2V0dGluZ3MoKQogICAgICAgICMgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZi5fY2FyZHNfY2xpY2tfaGFuZGxlcigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSJidG5fYWRkX3NlcmllcyI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJzZWxlY3RlZF9jYXJkX2tleSIsICcnKQogICAgICAgICAgICBzZWxmLl9jYXJkc19jbGlja19oYW5kbGVyKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2JhcmNvZGVfbGlzdGVuZXIoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbl9jYW5jZWwnOgogICAgICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWxfY291bnRlci5kZXN0cm95KCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd2aXNpb24nOgogICAgICAgICAgICBzZWxmLl9iYXJjb2RlX2xpc3RlbmVyKCkKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgICAgICBzZWxmLl9sYXlvdXRfYWN0aW9uKCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV9kZWxldGUnKToKICAgICAgICAgICAgc2VsZi5kZWxldGVfc2VyaWVzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fb2NyX3NlcmlhbF90ZW1wbGF0ZV9zZXR0aW5ncyc6CiAgICAgICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdzaG93X3Byb2Nlc3NfcmVzdWx0JywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCdPY3JUZXh0UmVjb2duaXRpb24nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1NlcmlhbE51bWJlck9DUlNldHRpbmdzJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcHJpbnQnOgogICAgICAgICAgICBzZWxmLl9wcmludF90aWNrZXQoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZXJpZXNfYWRkX2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9idG5fYWRkX2JhcmNvZGUoKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5zaG93X3Byb2Nlc3NfcmVzdWx0KGFyZ3MpCgogICAgZGVmIF9jYXJkc19jbGlja19oYW5kbGVyKHNlbGYpOgogICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX2l0ZW1fc2NyZWVuKCkKCiAgICBkZWYgX29wZW5fc2VyaWVzX2l0ZW1fc2NyZWVuKHNlbGYpOgogICAgICAgIGFyZ3MgPSB7CiAgICAgICAgICAgICdzZXJpZXNfaWQnOiBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKSwKICAgICAgICAgICAgJ3RpdGxlJzogJ9Ch0LXRgNC40Y8nCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IFNlcmllc0l0ZW0oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvdyhhcmdzKQoKICAgIGRlZiBfcmVmcmVzaF90b3RhbF9xdHR5KHNlbGYpOgogICAgICAgIHJlYWxfcXR0eSA9IHNlbGYuc2VydmljZS5nZXRfdG90YWxfcXR0eSgpCiAgICAgICAgb2xkX3F0eSA9IGZsb2F0KHNlbGYuaGFzaF9tYXBbJ3F0dHknXSBvciAwKQoKICAgICAgICBpZiBvbGRfcXR5ICE9IGZsb2F0KHJlYWxfcXR0eSBvciAwKToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV90b3RhbF9xdHkocXR5PXJlYWxfcXR0eSwgcm93X2lkPXNlbGYuc2NyZWVuX3ZhbHVlc1snZG9jX3Jvd19pZCddKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydxdHR5J10gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkocmVhbF9xdHR5KQoKICAgIGRlZiBfYmFyY29kZV9saXN0ZW5lcihzZWxmKToKICAgICAgICBzZWxmLl9pZGVudGlmeV9hZGRfYmFyY29kZV9zZXJpZXMoKQogICAgICAgIHNlbGYuX3JlZnJlc2hfc2VyaWVzX2NhcmRzKCkKICAgICAgICBzZWxmLl9yZWZyZXNoX3RvdGFsX3F0dHkoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfY2hlY2tfcXR0eV9saW1pdHMoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpOgogICAgICAgICAgICBxdHR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSkKICAgICAgICAgICAgcXR0eV9wbGFuID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHlfcGxhbicpKQogICAgICAgICAgICBpZiBxdHR5ID4gcXR0eV9wbGFuOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgi0KTQsNC60YIg0L/RgNC10LLRi9GI0LDQtdGCINC/0LvQsNC9IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19xdHR5X2xpbWl0cygpOgogICAgICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzdXBlcigpLl9maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQoKICAgIGRlZiBfcmVmcmVzaF9zZXJpZXNfY2FyZHMoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9zZXJpZXNfYnlfZG9jX2FuZF9nb29kcygpCiAgICAgICAgbGlzdF9kYXRhID0gW3NlbGYuX2hhbmRsZV9udW1fa2V5cyhpdGVtKSBmb3IgaXRlbSBpbiBsaXN0X2RhdGFdCiAgICAgICAgbGlzdF9kYXRhID0gW3NlbGYuX2FkZF90ZXh0X2luX3ZhbHVlcyhpdGVtKSBmb3IgaXRlbSBpbiBsaXN0X2RhdGFdCiAgICAgICAgZG9jX2NhcmRzID0gc2VsZi5fZ2V0X2RvY19jYXJkc192aWV3KGxpc3RfZGF0YSkKICAgICAgICAjINCU0L7QsdCw0LLQuNC8INC90LDQtNC/0LjRgdGMINC10YHQu9C4INC90LXRgiDRgdC10YDQuNC5INCyINGB0L/QuNGB0LrQtQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlbXB0eV9zZXJpZXMnLCAoIiIsItCe0YLRgdC60LDQvdC40YDRg9C50YLQtSDRgdC10YDQuNC4IilbbGVuKGxpc3RfZGF0YSk9PTBdKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Nlcmllc19jYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBfaGFuZGxlX251bV9rZXlzKHNlbGYsIHZhbHVlczogZGljdCkgLT4gZGljdDoKICAgICAgICBudW1lcmljX2tleXMgPSAoJ3F0dHknLCAncXR0eV9wbGFuJywgJ2RfcXR0eScpCiAgICAgICAgZm9yIGtleSBpbiBudW1lcmljX2tleXM6CiAgICAgICAgICAgIGlmIGtleSBpbiB2YWx1ZXMgYW5kIHJlLm1hdGNoKCJeXGQrXC4/XGQqJCIsIHN0cih2YWx1ZXNba2V5XSkpOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoZmxvYXQodmFsdWVzW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSAnMCcKICAgICAgICByZXR1cm4gdmFsdWVzCgogICAgZGVmIF9hZGRfdGV4dF9pbl92YWx1ZXMoc2VsZiwgdmFsdWVzOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGZvciBrZXkgaW4gdmFsdWVzLmtleXMoKToKICAgICAgICAgICAgaWYga2V5ID09ICdiZXN0X2JlZm9yZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9Cz0L7QtNC10L0g0LTQvjoge3ZhbHVlc1trZXldfScKICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ3Byb2R1Y3Rpb25fZGF0ZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C00LDRgtCwINC/0YDQvtC40LfQsi46IHt2YWx1ZXNba2V5XX0nCiAgICAgICAgICAgIGVsaWYga2V5ID09ICdxdHR5JyBhbmQgdmFsdWVzW2tleV0gaXMgbm90IE5vbmUgYW5kIHZhbHVlc1trZXldICE9ICcnOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C60L7Quy3QstC+OiB7dmFsdWVzW2tleV19JwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKCiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BiZXN0X2JlZm9yZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0n0KPQtNCw0LvQuNGC0YwnLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMGYwM2ZjJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9JyAnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvZHVjdGlvbl9kYXRlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfaWRlbnRpZnlfYWRkX2JhcmNvZGVfc2VyaWVzKHNlbGYpOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpIG9yIG9jcl9ub3NxbC5nZXQoJ29jcl9yZXN1bHQnKQogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIG9jcl9ub3NxbC5kZWxldGUoJ29jcl9yZXN1bHQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnYmFyY29kZScpCiAgICAgICAgICAgIHZhbHVlcyA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX2J5X2JhcmNvZGUoYmFyY29kZSwgc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IHZhbHVlc1swXVsnaWQnXQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9xdHR5X3RvX3RhYmxlX3N0cihpdGVtX2lkKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9uZXdfc2VyaWVzX2luX2RvY19zZXJpZXNfdGFibGUoYmFyY29kZSkKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDRgdC10YDQuNGOPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQmNC30LzQtdC90LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9zZXJpZXNfaWQnXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLCBzZWxmLnBhcmFtcykKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBkZWxldGVfc2VyaWVzKHNlbGYpOgogICAgICAgIGlkID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICBzZWxmLnNlcnZpY2UuZGVsZXRlX2N1cnJlbnRfc3QoaWQpCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IG9jcl9ub3NxbC5nZXQoJ3NlcmlhbF9vY3Jfc2V0dGluZ3MnKQogICAgICAgIGlmIHNlcmlhbF9vY3Jfc2V0dGluZ3M6CiAgICAgICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBqc29uLmxvYWRzKHNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3Zpc2lvbl9zZXR0aW5ncygqKnNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ2Zyb21fc2NyZWVuJywgJ1Nlcmllc1NlbGVjdFNjcmVlbicsIFRydWUpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgIyDQn9C+0LvRg9GH0LjQvCDQv9C10YDQstGL0Lkg0LHQsNGA0LrQvtC0INC00L7QutGD0LzQtdC90YLQsAogICAgICAgIGJhcmNvZGUgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpLmdldF9iYXJjb2RlX2Zyb21fZG9jX3RhYmxlKHNlbGYuc2NyZWVuX3ZhbHVlc1snZG9jX3Jvd19pZCddKQogICAgICAgIGRhdGEgPSB7J9CU0LDRgtCwX9C00L7Quic6ICdEb2NfZGF0YScsICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiAnR29vZCcsCiAgICAgICAgICAgICAgICAn0JDRgNGC0LjQutGD0LsnOiAnZ29vZF9hcnQnLCAn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAJzogJ2dvb2Rfc24nLAogICAgICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiAnZ29vZF9wcm9wZXJ0eScsICfQptC10L3QsCc6ICdnb29kX3ByaWNlJywKICAgICAgICAgICAgICAgICfQldC00JjQt9C8JzogJ2dvb2RfdW5pdCcsICfQmtC70Y7Rhyc6ICdrZXknLCAn0JLQsNC70Y7RgtCwJzogJ3ByaWNlX3R5cGUnfQogICAgICAgIGZvciBrZXkgaW4gZGF0YToKICAgICAgICAgICAgZGF0YVtrZXldID0gc2VsZi5oYXNoX21hcC5nZXQoZGF0YVtrZXldKQogICAgICAgIGRhdGFbJ2JhcmNvZGUnXSA9IGJhcmNvZGUgaWYgYmFyY29kZSBlbHNlICcwMDAwMDAwMDAwMDAwJwogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfYnRuX2FkZF9iYXJjb2RlKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiAgc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2lkX2dvb2QnLCAnJyksCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICBzZWxmLnNjcmVlbl9kYXRhLmdldCgnaWRfcHJvcGVydGllcycsICcnKSwKICAgICAgICAgICAgJ3VuaXRfaWQnOiAgc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2lkX3VuaXQnLCAnJykKICAgICAgICB9CiAgICAgICAgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93X3Byb2Nlc3NfcmVzdWx0KGluaXRfZGF0YSkKCmNsYXNzIFNlcmllc0l0ZW0oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICdTZXJpZXNQcm9jZXNzJwogICAgc2NyZWVuX25hbWUgPSAnRmlsbGluZ1Nlcmllc1NjcmVlbicKICAgIGRvY19iYXNpY190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICBkb2NfYmFzaWNfaGFuZGxlcl9uYW1lID0gJ1JTX2RvY3MnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuU2VyaWVzU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHt9CiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAndGl0bGUnOiAn0JfQsNC/0L7Qu9C90LXQvdC40LUg0YHQtdGA0LjQuCcsCiAgICAgICAgICAgICdzZXJpZXNfaWQnOiBzZWxmLmhhc2hfbWFwWydzZXJpZXNfaWQnXSwKICAgICAgICB9CgoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZXJpZXNfaWQgPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3Nlcmllc19pZCddCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX3RhYmxlX3N0cihzZXJpZXNfaWQpCgogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnZ29vZF9uYW1lJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2dvb2RfbmFtZScpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgJ25hbWUnOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnbmFtZScsJycpLAogICAgICAgICAgICAnbnVtYmVyJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ251bWJlcicsJycpLAogICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ3Byb2R1Y3Rpb25fZGF0ZScsJycpLAogICAgICAgICAgICAnYmVzdF9iZWZvcmUnOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnYmVzdF9iZWZvcmUnLCcnKSwKICAgICAgICAgICAgJ0ZpbGxpbmdTZXJpZXNTY3JlZW5fcXR0eScgOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgncXR0eScsJycpCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9oYW5kbGVfbnVtX2tleXMocHV0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQogICAgICAgICMgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJidG5fc2F2ZSI6CiAgICAgICAgICAgIHNlbGYuX2J0bl9zYXZlX2hhbmRsZXIoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fY2FuY2VsIjoKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX3VwZGF0ZV9zZXJpZXMnKToKICAgICAgICAgICAgcGFyYW1zID0gc2VsZi5fZ2V0X3BhcmFtcygpCiAgICAgICAgICAgIHBhcmFtcy51cGRhdGUoc2VsZi5fY2hlY2tfc2VyaWVzX251bWJlcigpKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2F2ZV90YWJsZV9zdHIocGFyYW1zKQogICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfc2F2ZV9kYXRhKHNlbGYpOgogICAgICAgIHBhcmFtcyA9IHNlbGYuX2dldF9wYXJhbXMoKQogICAgICAgIHNlbGYuc2VydmljZS5zYXZlX3RhYmxlX3N0cihwYXJhbXMpCgogICAgZGVmIF9pc192YWxpZF9kYXRlX2Zvcm1hdChzZWxmLCBkYXRlX3N0cik6CiAgICAgICAgcGF0dGVybiA9IHIiXigwWzEtOV18WzEyXVswLTldfDNbMDFdKVwuKDBbMS05XXwxWzAtMl0pXC5cZHs0fSQiCiAgICAgICAgcmV0dXJuIGJvb2wocmUubWF0Y2gocGF0dGVybiwgZGF0ZV9zdHIpKQoKICAgIGRlZiBfaGFuZGxlX251bV9rZXlzKHNlbGYsIHZhbHVlczogZGljdCkgLT4gZGljdDoKICAgICAgICBudW1lcmljX2tleXMgPSAoJ3F0dHknLCAncXR0eV9wbGFuJywgJ2RfcXR0eScsICdGaWxsaW5nU2VyaWVzU2NyZWVuX3F0dHknKQogICAgICAgIGZvciBrZXkgaW4gbnVtZXJpY19rZXlzOgogICAgICAgICAgICBpZiBrZXkgaW4gdmFsdWVzIGFuZCByZS5tYXRjaCgiXlxkK1wuP1xkKiQiLCBzdHIodmFsdWVzW2tleV0pKToKICAgICAgICAgICAgICAgIHZhbHVlc1trZXldID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KGZsb2F0KHZhbHVlc1trZXldKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHZhbHVlc1trZXldID0gJzAnCiAgICAgICAgcmV0dXJuIHZhbHVlcwoKICAgIGRlZiBfZm9ybWF0X3F1YW50aXR5KHNlbGYsIHF0dHkpOgogICAgICAgIGlmIGZsb2F0KHF0dHkpICUgMSA9PSAwOgogICAgICAgICAgICByZXR1cm4gaW50KGZsb2F0KHF0dHkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBxdHR5CgogICAgZGVmIF9idG5fc2F2ZV9oYW5kbGVyKHNlbGYpOgogICAgICAgIGlmIHNlbGYuc2NyZWVuX2RhdGEuZ2V0KCdpZCcpOgogICAgICAgICAgICBzZWxmLl9zYXZlX2RhdGEoKQogICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgc2VsZi5fY2hlY2tfc2VyaWVzX251bWJlcigpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnY29uZmlybV91cGRhdGVfc2VyaWVzJywgJ9Ch0LXRgNC40Y8g0YEg0LTQsNC90L3Ri9C8INC90L7QvNC10YDQvtC8INGD0LbQtSDRgdGD0YnQtdGB0YLQstGD0LXRgi4g0J7QsdC90L7QstC40YLRjCDQtNCw0L3QvdGL0LU/JykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBhcmFtcyA9IHNlbGYuX2dldF9wYXJhbXMoKQogICAgICAgICAgICAgICAgc2VsZi5fYWRkX25ld19zZXJpZXMocGFyYW1zKQogICAgICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgIGRlZiBfZ2V0X3BhcmFtcyhzZWxmKToKICAgICAgICBjb21tb25fcGFyYW1zID0gewogICAgICAgICAgICAnaWRfZG9jJzogc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9nb29kJyksCiAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc2VsZi5oYXNoX21hcC5nZXQoJ2lkX3Byb3BlcnRpZXMnKSwKICAgICAgICAgICAgJ2lkX3dhcmVob3VzZSc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF93YXJlaG91c2UnKSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLmhhc2hfbWFwLmdldCgnRmlsbGluZ1Nlcmllc1NjcmVlbl9xdHR5JyksCiAgICAgICAgICAgICduYW1lJzogc2VsZi5oYXNoX21hcC5nZXQoJ25hbWUnKSwKICAgICAgICAgICAgJ2Jlc3RfYmVmb3JlJzogc2VsZi5oYXNoX21hcC5nZXQoJ2Jlc3RfYmVmb3JlJykgaWYgc2VsZi5faXNfdmFsaWRfZGF0ZV9mb3JtYXQoc2VsZi5oYXNoX21hcC5nZXQoJ2Jlc3RfYmVmb3JlJykpIGVsc2UgTm9uZSwKICAgICAgICAgICAgJ251bWJlcic6IHNlbGYuaGFzaF9tYXAuZ2V0KCdudW1iZXInKSwKICAgICAgICAgICAgJ3Byb2R1Y3Rpb25fZGF0ZSc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdwcm9kdWN0aW9uX2RhdGUnKSBpZiBzZWxmLl9pc192YWxpZF9kYXRlX2Zvcm1hdChzZWxmLmhhc2hfbWFwLmdldCgncHJvZHVjdGlvbl9kYXRlJykpIGVsc2UgTm9uZSwKICAgICAgICAgICAgJ2lkX2NlbGwnOiBzZWxmLmhhc2hfbWFwLmdldCgnaWRfY2VsbCcpLAogICAgICAgICAgICAnY2VsbCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9jZWxsJykKICAgICAgICB9CgogICAgICAgIGlmIHNlbGYuc2NyZWVuX2RhdGE6CiAgICAgICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICdpZCc6IGludChzZWxmLnNjcmVlbl9kYXRhLmdldCgnaWQnLCAwKSksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc2VsZi5oYXNoX21hcFsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICAgICAqKmNvbW1vbl9wYXJhbXMKICAgICAgICAgICAgfQogICAgICAgICAgICBwYXJhbXNbJ2NlbGwnXSA9IGNvbW1vbl9wYXJhbXNbJ2lkX2NlbGwnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICdiYXJjb2RlJzogc2VsZi5oYXNoX21hcC5nZXQoJ251bWJlcicpLAogICAgICAgICAgICAgICAgKipjb21tb25fcGFyYW1zCiAgICAgICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcmFtcwoKICAgIGRlZiBfY2hlY2tfc2VyaWVzX251bWJlcihzZWxmKSAtPiBkaWN0OgogICAgICAgIHNlcmllc19udW1iZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbnVtYmVyJykKICAgICAgICBzZWxmLnNlcnZpY2UucGFyYW1zID0gc2VsZi5fZ2V0X3BhcmFtcygpCiAgICAgICAgaWYgc2VyaWVzX251bWJlcjoKICAgICAgICAgICAgdmFsdWVzID0gc2VsZi5zZXJ2aWNlLmdldF9zZXJpZXNfYnlfYmFyY29kZShzZXJpZXNfbnVtYmVyLCB7fSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgcmV0dXJuIHsnaWQnOiB2YWx1ZXNbMF1bJ2lkJ10sICdpZF9zZXJpZXMnOiB2YWx1ZXNbMF1bJ2lkX3NlcmllcyddfQogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIF9hZGRfbmV3X3NlcmllcyhzZWxmLCBwYXJhbXM6IGRpY3QpOgogICAgICAgIHNlcmllc19udW1iZXIgPSBwYXJhbXMuZ2V0KCdudW1iZXInKQogICAgICAgIHNlbGYuc2VydmljZS5hZGRfbmV3X3Nlcmllc19pbl9kb2Nfc2VyaWVzX3RhYmxlKHNlcmllc19udW1iZXIpCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBTZXJpZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBTZWxlY3RJdGVtU2NyZWVuID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZWxlY3RJdGVtU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VsZWN0SXRlbVByb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZWxlY3RJdGVtU2NyZWVuJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgdGFibGVfbmFtZSwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLmZpZWxkczogTGlzdFtzdHJdID0ga3dhcmdzLmdldCgnZmllbGRzJywgWyduYW1lJ10pCiAgICAgICAgc2VsZi5yZXN1bHRfbGlzdGVuZXIgPSBrd2FyZ3MuZ2V0KCdyZXN1bHRfbGlzdGVuZXInLCAnc2VsZWN0X3N1Y2Nlc3MnKQogICAgICAgIHNlbGYucmV0dXJuX3ZhbHVlX2tleSA9IGt3YXJncy5nZXQoJ3JldHVybl92YWx1ZV9rZXknLCAnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgc2VsZi50aXRsZSA9IGt3YXJncy5nZXQoJ3RpdGxlJywgJ9CS0YvQsdC+0YAg0LfQvdCw0YfQtdC90LjRjycpCgogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlbGVjdEl0ZW1TZXJ2aWNlKHNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi50aXRsZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnQ2FyZHNDbGljayc6IHNlbGYuX2NhcmRzX2NsaWNrLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5TZWxlY3RJdGVtU2VydmljZShzZWxmLnRhYmxlX25hbWUpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfc2VsZWN0X2RhdGEoKQogICAgICAgIGNhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ1NlbGVjdEl0ZW1TY3JlZW5faXRlbXNfY2FyZHMnXSA9IGNhcmRzLnRvX2pzb24oKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwWydTZXRSZXN1bHRMaXN0ZW5lciddID0gc2VsZi5yZXN1bHRfbGlzdGVuZXIKICAgICAgICBzZWxmLnNob3dfcHJvY2Vzc19yZXN1bHQoKQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBmaWVsZHNfdmlld3MgPSBbXQogICAgICAgIGZvciBmaWVsZCBpbiBzZWxmLmZpZWxkczoKICAgICAgICAgICAgZmllbGRzX3ZpZXdzLmFwcGVuZCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPWYnQHtmaWVsZH0nLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgKmZpZWxkc192aWV3cywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQogICAgICAgIHJldHVybiBjYXJkcwoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoc2VsZi5yZXR1cm5fdmFsdWVfa2V5LCBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKCksIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShzZWxmLnJldHVybl92YWx1ZV9rZXkpCiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ1NlbGVjdEl0ZW1TY3JlZW5faXRlbXNfY2FyZHMnKQogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCgoKY2xhc3MgU2hvd0l0ZW1zU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VsZWN0SXRlbVByb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTaG93SXRlbXNTY3JlZW4nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pbml0X3BhcmFtcyA9IFsndGl0bGUnLCAndGFibGVfZGF0YScsICd0YWJsZV9oZWFkZXInLCAnZW51bWVyYXRlJ10KICAgICAgICBzZWxmLmVudW1lcmF0ZT1UcnVlCiAgICAgICAgc2VsZi50YWJsZV9kYXRhID0gW10KICAgICAgICBzZWxmLmZpZWxkcyA9IFtdCiAgICAgICAgc2VsZi50YWJsZV9oZWFkZXIgPSB7fQogICAgICAgIHNlbGYudGV4dF9zaXplID0gMTUKICAgICAgICBzZWxmLmhlYWRlcl90ZXh0X3NpemUgPSAxNQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLmhhc2hfbWFwWyd0aXRsZSddIG9yICfQodC/0LjRgdC+0LonKQogICAgICAgIHNlbGYuZW51bWVyYXRlID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnZW51bWVyYXRlJykKICAgICAgICBzZWxmLnRhYmxlX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCd0YWJsZV9kYXRhJykKICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3RhYmxlX2hlYWRlcicpCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2RhdGE6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IgKCd0YWJsZV9kYXRhIG5vdCBpbml0aWFsaXplZCcpCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2hlYWRlcjoKICAgICAgICAgICAgc2VsZi50YWJsZV9oZWFkZXIgPSB7a2V5OiBrZXkgZm9yIGtleSBpbiBuZXh0KGl0ZXIoc2VsZi50YWJsZV9kYXRhKSkua2V5cygpfQoKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtc190YWJsZSddID0gc2VsZi5fZ2V0X3RhYmxlX3ZpZXcodGFibGVfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmKToKICAgICAgICBzZWxmLmZpZWxkcyA9IGxpc3Qoc2VsZi50YWJsZV9oZWFkZXIua2V5cygpKQogICAgICAgIHRhYmxlX2hlYWRlcl9sYXlvdXQgPSB7J19sYXlvdXQnOiBzZWxmLl9nZXRfdGFibGVfaGVhZGVyX3ZpZXcoKX0KCiAgICAgICAgaWYgc2VsZi5lbnVtZXJhdGU6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnsncG9zJzogJ04nfSwgKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0KICAgICAgICAgICAgdGFibGVfZGF0YSArPSBbZGljdCgqKnsncG9zJzogcG9zfSwgKipyb3cpIGZvciBwb3MsIHJvdyBpbiBlbnVtZXJhdGUoc2VsZi50YWJsZV9kYXRhLCBzdGFydD0xKV0KICAgICAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKICAgICAgICBlbHNlOgogICAgICAgICAgICB0YWJsZV9kYXRhID0gW2RpY3QoKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0gKyBzZWxmLnRhYmxlX2RhdGEKICAgICAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF90YWJsZV9oZWFkZXJfdmlldyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X2ZpZWxkc19sYXlvdXQoaXNfaGVhZGVyPVRydWUpCgogICAgZGVmIF9nZXRfZmllbGRzX2xheW91dChzZWxmLCBpc19oZWFkZXI9RmFsc2UsIGJhY2tncm91bmRfY29sb3I9JyNGQkU5RTcnLCB3ZWlnaHQ9MSk6CiAgICAgICAgaWYgaXNfaGVhZGVyOgogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gJyNGRkZGRkYnCiAgICAgICAgICAgIHRleHRfc2l6ZSA9IHNlbGYuaGVhZGVyX3RleHRfc2l6ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRleHRfc2l6ZSA9IHNlbGYudGV4dF9zaXplCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2RhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBmaWVsZHNfbGF5b3V0ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj1iYWNrZ3JvdW5kX2NvbG9yLAogICAgICAgICkKCiAgICAgICAgaWYgc2VsZi5lbnVtZXJhdGU6CiAgICAgICAgICAgIHBvc19sYXlvdXQgPSBzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9J3BvcycsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpCiAgICAgICAgICAgIGZpZWxkc19sYXlvdXQuYXBwZW5kKHBvc19sYXlvdXQpCgogICAgICAgIGZpZWxkc19sYXlvdXQuYXBwZW5kKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICpbc2VsZi5fZ2V0X2NvbHVtbl92aWV3KHZhbHVlPWZpZWxkLCB0ZXh0X3NpemU9dGV4dF9zaXplLCB3ZWlnaHQ9d2VpZ2h0KSBmb3IgZmllbGQgaW4gc2VsZi5maWVsZHNdLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9OAogICAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZmllbGRzX2xheW91dAoKICAgIGRlZiBfZ2V0X2NvbHVtbl92aWV3KHNlbGYsIHZhbHVlLCB0ZXh0X3NpemU9MjAsIHdlaWdodD0xKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT1mJ0B7dmFsdWV9JywKICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXRleHRfc2l6ZSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIHdlaWdodD13ZWlnaHQsCiAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEsCiAgICAgICAgKQoKICAgIGRlZiBfZ2V0X3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X2ZpZWxkc19sYXlvdXQoKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldy50b19qc29uKCkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCmNsYXNzIFNob3dNYXJrc1NjcmVlbihTaG93SXRlbXNTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1NlbGVjdEl0ZW1Qcm9jZXNzJwogICAgc2NyZWVuX25hbWUgPSAnU2hvd01hcmtzU2NyZWVuJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgdGFibGVfbmFtZSwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHRhYmxlX25hbWUsICoqa3dhcmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgc2VsZi5maWVsZHMgPSBsaXN0KHNlbGYudGFibGVfaGVhZGVyLmtleXMoKSkKICAgICAgICB0YWJsZV9oZWFkZXJfbGF5b3V0ID0geydfbGF5b3V0Jzogc2VsZi5fZ2V0X3RhYmxlX2hlYWRlcl92aWV3KCl9CgogICAgICAgIGlmIHNlbGYuZW51bWVyYXRlOgogICAgICAgICAgICB0YWJsZV9kYXRhID0gW2RpY3QoKip7J3Bvcyc6ICdOJ30sICoqeydpbWcnOiBOb25lfSwgKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0KICAgICAgICAgICAgdGFibGVfZGF0YSArPSBbZGljdCgqKnsncG9zJzogcG9zfSwgKip7J2ltZyc6IHNlbGYuX2dldF9pbWFnZV9mb3Jfcm93KHJvdyl9LCAqKnJvdykgZm9yIHBvcywgcm93IGluIGVudW1lcmF0ZShzZWxmLnRhYmxlX2RhdGEsIHN0YXJ0PTEpXQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXSArIHNlbGYudGFibGVfZGF0YQogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfaW1hZ2VfZm9yX3JvdyhzZWxmLCByb3dfZGF0YSk6CiAgICAgICAgaWYgcm93X2RhdGEuZ2V0KCJhcHByb3ZlZCIpID09ICIxIjoKICAgICAgICAgICAgcmV0dXJuIHN0YXRpY19kYXRhLm1hcmtfZ3JlZW4KICAgICAgICBlbGlmIHJvd19kYXRhLmdldCgiYXBwcm92ZWQiKSA9PSAiMCI6CiAgICAgICAgICAgIHJldHVybiBzdGF0aWNfZGF0YS5tYXJrX3BpbmsKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfZ2V0X2ZpZWxkc19sYXlvdXQoc2VsZiwgaXNfaGVhZGVyPUZhbHNlLCBiYWNrZ3JvdW5kX2NvbG9yPScjRkZGRkZGJywgd2VpZ2h0PTEpOgogICAgICAgIGlmIGlzX2hlYWRlcjoKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgICAgICB0ZXh0X3NpemUgPSBzZWxmLmhlYWRlcl90ZXh0X3NpemUKICAgICAgICAgICAgdGV4dF9ib2xkID0gVHJ1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRleHRfc2l6ZSA9IHNlbGYudGV4dF9zaXplCiAgICAgICAgICAgIHRleHRfYm9sZCA9IEZhbHNlCgogICAgICAgIHRleHRfc2l6ZSA9IHNlbGYudGV4dF9zaXplCgogICAgICAgIGZpZWxkc19sYXlvdXQgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPWJhY2tncm91bmRfY29sb3IsCiAgICAgICAgKQoKICAgICAgICBpZiBzZWxmLmVudW1lcmF0ZToKICAgICAgICAgICAgcG9zX2xheW91dCA9IHNlbGYuX2dldF9jb2x1bW5fdmlldyh2YWx1ZT0ncG9zJywgdGV4dF9zaXplPXRleHRfc2l6ZSwgd2VpZ2h0PXdlaWdodCwgdGV4dF9ib2xkPXRleHRfYm9sZCkKICAgICAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQocG9zX2xheW91dCkKCiAgICAgICAgIyDQktGB0YLQsNCy0LvRj9C10Lwg0LjQt9C+0LHRgNCw0LbQtdC90LjQtSDQv9C+0YHQu9C1INC60L7Qu9C+0L3QutC4ICdwb3MnINC4INC/0LXRgNC10LQg0L7RgdGC0LDQu9GM0L3Ri9C80Lgg0LrQvtC70L7QvdC60LDQvNC4CiAgICAgICAgaWYgbm90IGlzX2hlYWRlcjoKICAgICAgICAgICAgaW1nID0gJ0BpbWcnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaW1nID0gTm9uZQogICAgICAgIGltZ19sYXlvdXQgPSBzZWxmLl9nZXRfaW1hZ2VfY29sdW1uX3ZpZXcodmFsdWU9aW1nLCB3aWR0aD0xNiwgaGVpZ2h0PTEyLCB3ZWlnaHQ9MSkKICAgICAgICBmaWVsZHNfbGF5b3V0LmFwcGVuZChpbWdfbGF5b3V0KQoKICAgICAgICBmaWVsZHNfbGF5b3V0LmFwcGVuZCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAqW3NlbGYuX2dldF9jb2x1bW5fdmlldyh2YWx1ZT1maWVsZCwgdGV4dF9zaXplPXRleHRfc2l6ZSwgd2VpZ2h0PXdlaWdodCwgdGV4dF9ib2xkPXRleHRfYm9sZCkgZm9yIGZpZWxkIGluIHNlbGYuZmllbGRzXSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTcKICAgICAgICAgICAgKQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGZpZWxkc19sYXlvdXQKCiAgICBkZWYgX2dldF9pbWFnZV9jb2x1bW5fdmlldyhzZWxmLCB2YWx1ZSwgd2lkdGgsIGhlaWdodCwgd2VpZ2h0KToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuUGljdHVyZSgKICAgICAgICAgICAgICAgIFZhbHVlPXZhbHVlLAogICAgICAgICAgICAgICAgd2lkdGg9d2lkdGgsCiAgICAgICAgICAgICAgICBoZWlnaHQ9aGVpZ2h0LAogICAgICAgICAgICAgICAgd2VpZ2h0PXdlaWdodAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MSwKICAgICAgICApCgogICAgZGVmIF9nZXRfY29sdW1uX3ZpZXcoc2VsZiwgdmFsdWUsIHRleHRfc2l6ZT0yMCwgd2VpZ2h0PTEsIHRleHRfYm9sZD1GYWxzZSk6CiAgICAgICAgcmV0dXJuIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgVmFsdWU9ZidAe3ZhbHVlfScsCiAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICBUZXh0U2l6ZT10ZXh0X3NpemUsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIFRleHRCb2xkPXRleHRfYm9sZAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICB3ZWlnaHQ9d2VpZ2h0LAogICAgICAgICAgICBTdHJva2VXaWR0aD0xLAogICAgICAgICkKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlbGVjdEl0ZW1TY3JlZW4gXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCgojID09PT09PT09PT09PT09PT09PT09IFNldHRpbmdzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZXR0aW5nc1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZXR0aW5nc19rZXlzID0gWwogICAgICAgICAgICAndXNlX21hcmsnLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCcsCiAgICAgICAgICAgICdhZGRfaWZfbm90X2luX3BsYW4nLAogICAgICAgICAgICAncGF0aCcsCiAgICAgICAgICAgICdhbGxvd19vdmVyc2NhbicsCiAgICAgICAgICAgICdvZmZsaW5lX21vZGUnCiAgICAgICAgXQoKICAgICAgICBwdXRfZGF0YSA9IHtrZXk6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KGtleSkgZm9yIGtleSBpbiBzZXR0aW5nc19rZXlzfQogICAgICAgIHB1dF9kYXRhWydpcF9hZHInXSA9IHNlbGYuX2dldF9pcF9hZGRyZXNzKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc2VsZi5fdXBkYXRlX3JzX3NldHRpbmdzKCkKCiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX2h0dHBfc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60LggaHR0cCDRgdC+0LXQtNC40L3QtdC90LjRjycpLAogICAgICAgICAgICAnYnRuX3NpemUnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0KjRgNC40YTRgtC+0LInKSwKICAgICAgICAgICAgJ2J0bl9zb3VuZF9zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQsCDQt9Cy0YPQutCwJyksCiAgICAgICAgICAgICdidG5fZG9jdW1lbnRzX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyJyksCiAgICAgICAgICAgICdidG5fb2NyX3JlY29nbml0aW9uX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnB1dCgnU3RhcnRQcm9jZXNzJywgJ09jclRleHRSZWNvZ25pdGlvbicpLAogICAgICAgICAgICAnYnRuX3ByaW50X3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnB1dCgnU3RhcnRQcm9jZXNzJywgJ9Cf0LXRh9Cw0YLRjCcpLAogICAgICAgICAgICAnYnRuX3Rlc3RfYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Ci0LXRgdGCINGB0LrQsNC90LXRgNCwJyksCiAgICAgICAgICAgICdidG5fZXJyX2xvZyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Ce0YjQuNCx0LrQuCcpLAogICAgICAgICAgICAnYnRuX3VwbG9hZF9kb2NzJzogc2VsZi5fdXBsb2FkX2RvY3MsCiAgICAgICAgICAgICdidG5fdGltZXInOiBzZWxmLl9sb2FkX2RvY3MsCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBsYW1iZGE6IHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF91cGxvYWRfZG9jcyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHRpbWVyID0gVGltZXIoc2VsZi5oYXNoX21hcCkKICAgICAgICAgICAgdGltZXIudXBsb2FkX2RhdGEoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LUg0LfQsNC00LDQvdGLINC90LDRgdGC0YDQvtC50LrQuCDRgdC+0LXQtNC40L3QtdC90LjRjycpCgogICAgZGVmIF9sb2FkX2RvY3Moc2VsZik6CiAgICAgICAgaWYgc2VsZi5fY2hlY2tfaHR0cF9zZXR0aW5ncygpOgogICAgICAgICAgICB0aW1lciA9IFRpbWVyKHNlbGYuaGFzaF9tYXApCiAgICAgICAgICAgIHRpbWVyLnRpbWVyX29uX3N0YXJ0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INC30LDQtNCw0L3RiyDQvdCw0YHRgtGA0L7QudC60Lgg0YHQvtC10LTQuNC90LXQvdC40Y8nKQoKICAgIGRlZiBfdXBkYXRlX3JzX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgdXNlX21hcmsgPSBzZWxmLmhhc2hfbWFwLmdldCgndXNlX21hcmsnKSBvciAnZmFsc2UnCiAgICAgICAgcGF0aCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdwYXRoJykgb3IgJy8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS8nCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2FsbG93X2ZhY3RfaW5wdXQnKSBvciBGYWxzZQogICAgICAgIG9mZmxpbmVfbW9kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ29mZmxpbmVfbW9kZScpIG9yIEZhbHNlCgogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VfbWFyaycsIHVzZV9tYXJrLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdwYXRoJywgcGF0aCwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnYWxsb3dfZmFjdF9pbnB1dCcsIGFsbG93X2ZhY3RfaW5wdXQsIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ29mZmxpbmVfbW9kZScsIG9mZmxpbmVfbW9kZSwgVHJ1ZSkKCiAgICBkZWYgX3Nob3dfc2NyZWVuKHNlbGYsIHNjcmVlbl9uYW1lKSAtPiBOb25lOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2NyZWVuX25hbWUpCgogICAgZGVmIF9nZXRfaHR0cF9zZXR0aW5ncyhzZWxmKSAtPiBkaWN0OgogICAgICAgIGh0dHBfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgiVVJMIiksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1VTRVInKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnUEFTUycpLAogICAgICAgICAgICAnZGV2aWNlX21vZGVsJzogc2VsZi5oYXNoX21hcFsnREVWSUNFX01PREVMJ10sCiAgICAgICAgICAgICdhbmRyb2lkX2lkJzogc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfaXBfYWRkcmVzcygpIC0+IHN0cjoKICAgICAgICByZXMgPSBnZXRfaXBfYWRkcmVzcygpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuICfQvdC10YIg0YHQtdGC0LgnCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKCmNsYXNzIEZvbnRTaXplU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQqNGA0LjRhNGC0L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHB1dF9kYXRhID0ge30KICAgICAgICBmaWVsZHNfZGF0YSA9IHsKICAgICAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCcsCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQoNCw0LfQvNC10YAg0LfQsNCz0L7Qu9C+0LLQutCwINC60LDRgNGC0L7Rh9C60LgnLAogICAgICAgICAgICAiQ2FyZERhdGVUZXh0U2l6ZSI6ICfQlNCw0L3QvdGL0LUg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICAgICAgICAgICdDYXJkVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINGC0LXQutGB0YLQsCDRjdC70LXQvNC10L3RgtC+0LInLAogICAgICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQl9Cw0LPQvtC70L7QstC+0Log0YLQvtCy0LDRgNCwJywKICAgICAgICAgICAgJ2dvb2RzVGV4dFNpemUnOiAn0KLQvtCy0LDRgCcsCiAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiAn0KHQtdGA0LjQuCDRgdCy0L7QudGB0YLQstCwJywKICAgICAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAn0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCcsCiAgICAgICAgICAgICd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnOiAn0J3QsNC30LLQsNC90LjQtSDQtNC+0LrRg9C80LXQvdGC0LAg0LIg0LrQsNGA0YLQvtGH0LrQtScKICAgICAgICB9CgogICAgICAgIGZvciBmaWVsZCwgaGludCBpbiBmaWVsZHNfZGF0YS5pdGVtcygpOgogICAgICAgICAgICBwdXRfZGF0YVtmaWVsZF0gPSB3aWRnZXRzLk1vZGVybkZpZWxkKAogICAgICAgICAgICAgICAgaGludD1oaW50LAogICAgICAgICAgICAgICAgZGVmYXVsdF90ZXh0PXNlbGYucnNfc2V0dGluZ3MuZ2V0KGZpZWxkKSBvciAnJwogICAgICAgICAgICApLnRvX2pzb24oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fb25fc2F2ZSc6CiAgICAgICAgICAgIHNhdmVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdUaXRsZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnVGl0bGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0NhcmRUaXRsZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnQ2FyZFRpdGxlVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdDYXJkVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydDYXJkVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdDYXJkRGF0ZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnQ2FyZERhdGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydHb29kc0NhcmRUaXRsZVRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ2dvb2RzVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnRG9jVHlwZUNhcmRUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSddLAogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgaywgdiBpbiBzYXZlX2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KGssIHYsIFRydWUpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX29uX2NhbmNlbCcgb3Igc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JhY2tTY3JlZW4nLCAnJykKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnbm9SZWZyZXNoJ10gPSAnJwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBCYXJjb2RlVGVzdFNjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KLQtdGB0YIg0YHQutCw0L3QtdGA0LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBzZWxmLl9iYXJjb2RlX3NjYW5uZWQsCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ0JBQ0tfQlVUVE9OJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnQmFja1NjcmVlbicsICcnKQoKICAgIGRlZiBfYmFyY29kZV9zY2FubmVkKHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgYmFyY29kZV9wYXJzZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz0nJykKICAgICAgICByZXN1bHQgPSBiYXJjb2RlX3BhcnNlci5wYXJzZShiYXJjb2RlKQogICAgICAgIGZpZWxkc19jb3VudCA9IDcKCiAgICAgICAga2V5c19saXN0ID0gWydFUlJPUicsICdHVElOJywgJ1NFUklBTCcsICdGdWxsQ29kZScsICdCQVJDT0RFJywgJ1NDSEVNRScsICdFWFBJUlknLCAnQkFUQ0gnLCAnTkhSTicsICdDSEVDSycsCiAgICAgICAgICAgICAgICAgICAgICdXRUlHSFQnLCAnUFBOJ10KCiAgICAgICAgdmFsdWVzID0gW2Yne2tleX06IHtyZXN1bHRba2V5XX0nIGZvciBrZXkgaW4ga2V5c19saXN0IGlmIHJlc3VsdC5nZXQoa2V5KSBpcyBub3QgTm9uZV0KCiAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgIGYnZmxkX3tpICsgMX0nOiB2YWx1ZXNbaV0gaWYgbGVuKHZhbHVlcykgPiBpIGVsc2UgJycKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgZmllbGRzX2NvdW50KQogICAgICAgIH0KCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCgpjbGFzcyBIdHRwU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCBodHRwINGB0L7QtdC00LjQvdC10L3QuNGPJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBOb25lCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnYnRuX3Rlc3RfY29ubmVjdGlvbiddID0gJ9Ci0LXRgdGCINGB0L7QtdC00LjQvdC10L3QuNGPJwogICAgICAgIGh0dHBfc2V0dGluZ3MgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCgogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSfQkNC00YDQtdGBINGB0LXRgNCy0LXRgNCwJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VybCddIG9yICcnKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9Cf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyJ10gb3IgJycpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0n0J/QsNGA0L7Qu9GMJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3Bhc3MnXSBvciAnJywgcGFzc3dvcmQ9VHJ1ZSksCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9CS0LDRiNC1INC40LzRjyDQtNC70Y8g0LjQtNC10L3RgtC40YTQuNC60LDRhtC40Lgg0LIgMdChJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VzZXJfbmFtZSddIG9yICcnKSwKICAgICAgICB9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fdGVzdF9jb25uZWN0aW9uJzogc2VsZi5fdGVzdF9jb25uZWN0aW9uLAogICAgICAgICAgICAnYnRuX3NhdmUnOiBzZWxmLl9zYXZlX3NldHRpbmdzLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCwKICAgICAgICAgICAgJ2J0bl9jYW5jZWwnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF90ZXN0X2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkpCgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTMpCiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgoKICAgICAgICAgICAgaWYgcmVzdWx0LnVuYXV0aG9yaXplZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDQsNCy0YLQvtGA0LjQt9Cw0YbQuNC4INGB0LXRgNCy0LXRgNCwIDHQoScpCiAgICAgICAgICAgIGVsaWYgcmVzdWx0LmZvcmJpZGRlbjoKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9CX0LDQv9GA0L7RgSDQvdCwINCw0LLRgtC+0YDQuNC30LDRhtC40Y4g0L/RgNC40L3Rj9GCJykKICAgICAgICAgICAgZWxpZiByZXN1bHQuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INGD0LTQsNC70L7RgdGMINGD0YHRgtCw0L3QvtCy0LjRgtGMINGB0L7QtdC00LjQvdC10L3QuNC1JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQodC+0LXQtNC40L3QtdC90LjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC+JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdzdWNjZXNzJykKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgi0J3QtSDRg9C60LDQt9Cw0L3RiyDQvdCw0YHRgtGA0L7QudC60LggSFRUUCDQv9C+0LTQutC70Y7Rh9C10L3QuNGPINC6INGB0LXRgNCy0LXRgNGDIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX3NhdmVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VSTCcsIHNlbGYuaGFzaF9tYXBbJ3VybCddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVU0VSJywgc2VsZi5oYXNoX21hcFsndXNlciddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdQQVNTJywgc2VsZi5oYXNoX21hcFsncGFzcyddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBzZWxmLmhhc2hfbWFwWyd1c2VyX25hbWUnXSwgVHJ1ZSkKCiAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgIGRlZiBfYmFyY29kZV9zY2FubmVkKHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEyJykKICAgICAgICB0cnk6CiAgICAgICAgICAgIGJhcmNfc3RydWN0ID0ganNvbi5sb2FkcyhiYXJjb2RlKQoKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VSTCcsIGJhcmNfc3RydWN0LmdldCgndXJsJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVU0VSJywgYmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdQQVNTJywgYmFyY19zdHJ1Y3QuZ2V0KCdwYXNzJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBiYXJjX3N0cnVjdC5nZXQoJ3VzZXJfbmFtZScpLCBUcnVlKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VybCcsIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXJsJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgndXJsJykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndXNlcicsIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXNlcicsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VzZXInKSkpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwYXNzJywgc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSdwYXNzJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgncGFzcycpKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VzZXJfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXNlcl9uYW1lJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgndXNlcl9uYW1lJykpKQogICAgICAgIGV4Y2VwdCAoSlNPTkRlY29kZUVycm9yLCBBdHRyaWJ1dGVFcnJvcikgYXMgZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgUVIt0LrQvtC00LAnKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JhY2tTY3JlZW4nLCAnJykKCiAgICBkZWYgX2dldF9tb2Rlcm5fZmllbGQoc2VsZiwgKipkYXRhKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5Nb2Rlcm5GaWVsZCgqKmRhdGEpLnRvX2pzb24oKQoKICAgIGRlZiBfY2hlY2tfaHR0cF9zZXR0aW5ncyhzZWxmKSAtPiBib29sOgogICAgICAgIGh0dHAgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgcmV0dXJuIGFsbChbaHR0cC5nZXQoJ3VybCcpLCBodHRwLmdldCgndXNlcicpLCBodHRwLmdldCgncGFzcycpXSkKCiAgICBkZWYgX2dldF9odHRwX3NldHRpbmdzKHNlbGYpOgogICAgICAgIGh0dHBfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgiVVJMIiksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1VTRVInKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnUEFTUycpLAogICAgICAgICAgICAnZGV2aWNlX21vZGVsJzogc2VsZi5oYXNoX21hcFsnREVWSUNFX01PREVMJ10sCiAgICAgICAgICAgICdhbmRyb2lkX2lkJzogc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgoKY2xhc3MgU291bmRTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutCwINC30LLRg9C60LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZXZlbnRzID0geydzdWNjZXNzJzogJ9Ch0LjQs9C90LDQuyDRg9C00LDRh9C90L7Qs9C+INGB0L7QsdGL0YLQuNGPJywgJ3dhcm5pbmcnOiAn0KHQuNCz0L3QsNC7INC/0YDQtdC00YPQv9GA0LXQttC00LXQvdC40Y8nLAogICAgICAgICAgICAgICAgICAgICAgICdlcnJvcic6ICfQodC40LPQvdCw0Lsg0L7RiNC40LHQutC4J30KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5faW5pdF9zb3VuZHMoKQogICAgICAgIGV2ZW50c19kYXRhID0gc2VsZi5fZ2V0X2V2ZW50c19kYXRhKCkKICAgICAgICBldmVudHNfY2FyZHMgPSBzZWxmLl9nZXRfZXZlbnRfY2FyZHNfdmlldyhldmVudHNfZGF0YSwgcG9wdXBfbWVudV9kYXRhPScxOzI7Mzs0OzU7Njs3Ozg7OTsxMDsxMTsxMjsxMzsxNDsxNScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2V2ZW50X2NhcmRzJywgZXZlbnRzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnc2F2ZV9idG4nOgogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnc3VjY2Vzc19zaWduYWwnLCBzZWxmLmhhc2hfbWFwLmdldCgiY3VycmVudF9zdWNjZXNzX3NpZ25hbCIpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnd2FybmluZ19zaWduYWwnLCBzZWxmLmhhc2hfbWFwLmdldCgiY3VycmVudF93YXJuaW5nX3NpZ25hbCIpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZXJyb3Jfc2lnbmFsJywgc2VsZi5oYXNoX21hcC5nZXQoImN1cnJlbnRfZXJyb3Jfc2lnbmFsIiksIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKICAgICAgICAgICAgIyBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fb25fY2FuY2VsJyBvciBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9zdWNjZXNzX3NpZ25hbCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF93YXJuaW5nX3NpZ25hbCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9lcnJvcl9zaWduYWwnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBzZWxlY3RlZF9ldmVudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKGV2ZW50PXNlbGVjdGVkX2V2ZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VuZF92YWw9c2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3tzZWxlY3RlZF9ldmVudH1fc2lnbmFsJykpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5pdF9zb3VuZHMoc2VsZik6CiAgICAgICAgIyBmb3Iga2V5LCB2YWwgaW4gc2VsZi5ldmVudHMuaXRlbXMoKToKICAgICAgICAjICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3trZXl9X3NpZ25hbCcpOgogICAgICAgICMgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChmJ2N1cnJlbnRfe2tleX1fc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoZid7ZXZlbnR9X3NpZ25hbCcgb3IgIjYiKSkKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3N1Y2Nlc3Nfc2lnbmFsJykpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3dhcm5pbmdfc2lnbmFsJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3dhcm5pbmdfc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3dhcm5pbmdfc2lnbmFsJykpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2Vycm9yX3NpZ25hbCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9lcnJvcl9zaWduYWwnLCBzZWxmLnJzX3NldHRpbmdzLmdldCgnZXJyb3Jfc2lnbmFsJykpCgogICAgZGVmIF9nZXRfZXZlbnRzX2RhdGEoc2VsZik6CiAgICAgICAgZGF0YSA9IFtdCiAgICAgICAgZm9yIGtleSwgdmFsIGluIHNlbGYuZXZlbnRzLml0ZW1zKCk6CiAgICAgICAgICAgIGV2ZW50ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGtleSwKICAgICAgICAgICAgICAgICdldmVudF9uYW1lJzogdmFsLAogICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3ZhbHVlJzogc2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3trZXl9X3NpZ25hbCcpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGF0YS5hcHBlbmQoZXZlbnQpCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgX2dldF9ldmVudF9jYXJkc192aWV3KHNlbGYsIGV2ZW50c19kYXRhLCBwb3B1cF9tZW51X2RhdGEpOgogICAgICAgIHRpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJUaXRsZVRleHRTaXplIikKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJDYXJkVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGV2ZW50X25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT10aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzZWxlY3RlZF92YWx1ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTI4LAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfc2VsZWN0X3NvdW5kIiwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9ItCf0YDQvtGB0LvRg9GI0LDRgtGMIiwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1ldmVudHNfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKToKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGF5b3V0X2xpc3RlbmVyJykKICAgICAgICBjdXJyZW50X2tleSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpWydrZXknXQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYnY3VycmVudF97Y3VycmVudF9rZXl9X3NpZ25hbCcsIGxheW91dF9saXN0ZW5lcikKCgpjbGFzcyBEb2N1bWVudHNTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoJ2RvY19zZXR0aW5nc19vbl9zdGFydCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3NldHRpbmdzX29uX3N0YXJ0JywgJ3RydWUnKQogICAgICAgICAgICBzZWxmLl9pbml0X29sZF9kb2NfZGVsZXRlX3NldHRpbmdzKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnc2F2ZV9idG4nOgogICAgICAgICAgICBkZWxfZG9jc19mbGFnID0gc2VsZi5oYXNoX21hcC5nZXQoJ2RvY19zZXR0aW5nc19jb25maXJtX2RlbGV0ZV9vbGRfZG9jcycpCiAgICAgICAgICAgIGRlbF9kb2NzX2ZsYWcgPSBUcnVlIGlmIGRlbF9kb2NzX2ZsYWcgPT0gJ3RydWUnIGVsc2UgRmFsc2UKICAgICAgICAgICAgaWYgbm90IGRlbF9kb2NzX2ZsYWc6CiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZGVsZXRlX29sZF9kb2NzJywgRmFsc2UsIFRydWUpCiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLmRlbGV0ZSgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRheXMgPSBzZWxmLmhhc2hfbWFwLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICAgICAgICAgIGlmIG5vdCBkYXlzIG9yIGRheXMgPT0gJzAnIG9yIG5vdCBkYXlzLmlzZGlnaXQoKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cj0LrQsNC20LjRgtC1INC60L7RgNGA0LXQutGC0L3QvtC1INC60L7Qu9C40YfQtdGB0YLQstC+INC00L3QtdC5JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyDQtNC70Y8g0L3QsNGB0YLRgNC+0LnQutC4INGD0LTQsNC70LXQvdC40Y8g0YHRgtCw0YDRi9GFINC00L7QutGD0LzQtdC90YLQvtCyJykKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGlmIGRheXMgPj0gJzk5OTknOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JrQvtC70LjRh9C10YHRgtCy0L4g0LTQvdC10Lkg0L/RgNC10LLRi9GI0LDQtdGCIDk5OTknKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RlbGV0ZV9vbGRfZG9jcycsIFRydWUsIFRydWUpCiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJywgZGF5cywgVHJ1ZSkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LDRgdGC0YDQvtC50LrQuCDRgdC+0YXRgNCw0L3QtdC90YsnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnZG9jX3NldHRpbmdzX29uX3N0YXJ0JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdkb2Nfc2V0dGluZ3Nfb25fc3RhcnQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5pdF9vbGRfZG9jX2RlbGV0ZV9zZXR0aW5ncyhzZWxmKToKICAgICAgICBjdXJyZW50X2RheXNfdmFsdWUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICBpbml0X2RheXMgPSBzdHIoY3VycmVudF9kYXlzX3ZhbHVlKSBpZiBjdXJyZW50X2RheXNfdmFsdWUgaXMgbm90IE5vbmUgZWxzZSAnMScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJywgaW5pdF9kYXlzKQoKICAgICAgICBmbGFnID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9vbGRfZG9jcycpCiAgICAgICAgaW5pdF9mbGFnID0gc3RyKGZsYWcpLmxvd2VyKCkgaWYgZmxhZyBpcyBub3QgTm9uZSBlbHNlICdmYWxzZScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3NldHRpbmdzX2NvbmZpcm1fZGVsZXRlX29sZF9kb2NzJywgaW5pdF9mbGFnKQoKCmNsYXNzIEVycm9yTG9nU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQntGI0LjQsdC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IExvZ2dlclNlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5kZXNjX3NvcnQgPSBUcnVlCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgZXJyb3JzX3RhYmxlX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9lcnJvcnMoc2VsZi5kZXNjX3NvcnQpCiAgICAgICAgdGFibGVfcmF3cyA9IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfcm93cyhlcnJvcnNfdGFibGVfZGF0YSkKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2Vycm9yc190YWJsZV92aWV3KHRhYmxlX3Jhd3MpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImVycm9yX2xvZ190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RhdGVfc29ydF9zZWxlY3QnXSA9ICfQndC+0LLRi9C1O0PRgtCw0YDRi9C1JwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJidG5fY2xlYXJfZXJyIjoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmNsZWFyKCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvSIpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAiZGF0ZV9zb3J0X2NsaWNrIjoKICAgICAgICAgICAgc2VsZi5kZXNjX3NvcnQgPSBub3Qgc2VsZi5kZXNjX3NvcnQKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUsIGFyZ3MpCgogICAgZGVmIF9nZXRfZXJyb3JzX3RhYmxlX3Jvd3Moc2VsZiwgZXJyb3JzX3RhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgaSA9IDEKICAgICAgICBmb3IgcmVjb3JkIGluIGVycm9yc190YWJsZV9kYXRhOgogICAgICAgICAgICBlcnJvcl9yb3cgPSB7ImtleSI6IGksICJtZXNzYWdlIjogcmVjb3JkWydlcnJvcl90ZXh0J10sCiAgICAgICAgICAgICAgICAgICAgICAgICAidGltZSI6IERhdGVGb3JtYXQoKS5nZXRfdGFibGVfdmlld19mb3JtYXQocmVjb3JkWyd0aW1lc3RhbXAnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfcm93X2xheW91dCgpfQogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChlcnJvcl9yb3cpCiAgICAgICAgICAgIGkgKz0gMQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2Vycm9yc190YWJsZV92aWV3KHNlbGYsIHRhYmxlX3Jvd3MpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9CS0YDQtdC80Y8nKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0L7QvtCx0YnQtdC90LjQtScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0zCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX3Jvd3MKICAgICAgICApCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9lcnJvcnNfdGFibGVfcm93X2xheW91dChzZWxmKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B0aW1lJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG1lc3NhZ2UnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTMsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicsCiAgICAgICAgICAgIGhlaWdodD0nd3JhcF9jb250ZW50JywKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAndmVydGljYWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgICAgIHNlbGYuVGV4dFNpemUgPSAnMTUnCiAgICAgICAgICAgIHNlbGYuVGV4dEJvbGQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAnbWF0Y2hfcGFyZW50JwogICAgICAgICAgICBzZWxmLlZhbHVlID0gdmFsdWUKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBTZXR0aW5ncyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKIyA9PT09PT09PT09PT09PT09PT09PSBEZWJ1ZyBzZXR0aW5ncyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERlYnVnU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICfQntGC0LvQsNC00LrQsCcKICAgIHNjcmVlbl9uYW1lID0gJ9Ce0YLQu9Cw0LTQvtGH0L3Ri9C5INGN0LrRgNCw0L0nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuRGVidWdTZXJ2aWNlCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGRlYnVnX2hvc3RfaXAgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnZGVidWdfaG9zdF9pcCcpIG9yIHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KAogICAgICAgICAgICAnaXBfaG9zdCcsCiAgICAgICAgICAgIHsnaGludCc6ICdJUC3QsNC00YDQtdGBINC00LvRjyDQstGL0LPRgNGD0LfQutC4INCx0LDQt9GLL9C70L7Qs9CwJywgJ2RlZmF1bHRfdGV4dCc6IGRlYnVnX2hvc3RfaXAgb3IgJyd9LAogICAgICAgICAgICB0b19qc29uPVRydWUpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2J0bl9maWxsX3JhdGlvJzogc2VsZi5fZmlsbF9yYXRpbywKICAgICAgICAgICAgJ2J0bl9jb3B5X2Jhc2UnOiBzZWxmLl9jb3B5X2Jhc2UsCiAgICAgICAgICAgICdidG5fdW5sb2FkX2xvZyc6IHNlbGYuX3VubG9hZF9sb2csCiAgICAgICAgICAgICdidG5fdGVtcGxhdGVzJzogc2VsZi5vcGVuX3RlbXBsYXRlc19zY3JlZW4sCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9vbl9iYWNrX3ByZXNzZWQKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZmlsbF9yYXRpbyhzZWxmKToKICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgIFVQREFURSBSU19iYXJjb2RlcwogICAgICAgIFNFVCByYXRpbyA9IENPQUxFU0NFKCgKICAgICAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvciAvIFJTX3VuaXRzLmRlbm9taW5hdG9yCiAgICAgICAgICAgIEZST00gUlNfdW5pdHMKICAgICAgICAgICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICAgICAgKSwgMSknJycKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KLQsNCx0LvQuNGG0LAg0LHQsNGA0LrQvtC00L7QsiDQt9Cw0L/QvtC70L3QtdC90LAg0LfQvdCw0YfQtdC90LjRj9C80Lgg0LjQtyDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPJykKCiAgICBkZWYgX2NvcHlfYmFzZShzZWxmKToKICAgICAgICBpcF9ob3N0ID0gc2VsZi5oYXNoX21hcFsnaXBfaG9zdCddCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdzcWxpdGVfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGZpbGVfcGF0aCk6CiAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGY6CiAgICAgICAgICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2RhdGFiYXNlKGYpCgogICAgICAgICAgICAgICAgaWYgcmVzWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkdCw0LfQsCBTUUxpdGUg0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvdCwJykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScpCgogICAgZGVmIF91bmxvYWRfbG9nKHNlbGYpOgogICAgICAgIGlwX2hvc3QgPSBzZWxmLmhhc2hfbWFwWydpcF9ob3N0J10KCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdsb2dfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgICMgVE9ETyDQl9C00LXRgdGMINC90YPQttC90L4g0LHRg9C00LXRgiDQstGL0LfRi9Cy0LDRgtGMINC60LvQsNGB0YEt0YHQtdGA0LLQuNGBINC00LvRjyDQstC30LDQuNC80L7QtNC10LnRgdGC0LLQuNGPINGBIFRpbnlEQgogICAgICAgIGZyb20gdGlueWRiIGltcG9ydCBUaW55REIKCiAgICAgICAgZGIgPSBUaW55REIoZmlsZV9wYXRoKQogICAgICAgIGRhdGEgPSBkYi5hbGwoKQoKICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2xvZyhkYXRhKQogICAgICAgIGlmIHJlc1snc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cb0L7QsyDRg9GB0L/QtdGI0L3QviDQstGL0LPRgNGD0LbQtdC9JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQogICAgZGVmIF9vbl9iYWNrX3ByZXNzZWQoc2VsZik6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkZWJ1Z19ob3N0X2lwJywgaXBfaG9zdCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBvcGVuX3RlbXBsYXRlc19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCfQn9C10YfQsNGC0YwnLCAn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERlYnVnIHNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gQWN0aXZlQ1YgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEFjdGl2ZUNWQXJ0aWNsZVJlY29nbml0aW9uKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVicKICAgIHByb2Nlc3NfbmFtZSA9ICfQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LInCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2FydF9pbmZvJywgJ9Cd0LDQudC00LXQvdC90YvQtSDQsNGA0YLQuNC60YPQu9GLOiAnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICfQntCx0YDQsNCx0L7RgtCw0YLRjCc6CiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5wdXQoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgb25fb2JqZWN0X2RldGVjdGVkKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgY3VycmVudF9vYmplY3QgPSBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9vYmplY3QnKQogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgZmluZGVkX2FydGljbGVzID0ganNvbi5sb2FkcyhmaW5kZWRfYXJ0aWNsZXMpIGlmIGZpbmRlZF9hcnRpY2xlcyBlbHNlIFtdCiAgICAgICAgaWYgY3VycmVudF9vYmplY3Qgbm90IGluIGZpbmRlZF9hcnRpY2xlczoKICAgICAgICAgICAgZmluZGVkX2FydGljbGVzLmFwcGVuZChjdXJyZW50X29iamVjdCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICAgICAnYXJ0X2luZm8nLCAn0J3QsNC50LTQtdC90L3Ri9C1INCw0YDRgtC40LrRg9C70Ys6ICcgKyAnOycuam9pbihmaW5kZWRfYXJ0aWNsZXMpKQogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wucHV0KCdmaW5kZWRfYXJ0aWNsZXMnLCBqc29uLmR1bXBzKGZpbmRlZF9hcnRpY2xlcyksIFRydWUpCgogICAgICAgIGdvb2RfbmFtZSA9IHNlbGYuZ2V0X2dvb2RfaW5mbyhjdXJyZW50X29iamVjdCkKICAgICAgICBzZWxmLmhhc2hfbWFwLmFkZF90b19jdl9saXN0KAogICAgICAgICAgICB7J29iamVjdCc6IHN0cihjdXJyZW50X29iamVjdCksCiAgICAgICAgICAgICAnaW5mbyc6IGYn0KLQvtCy0LDRgDogPGJpZz57Z29vZF9uYW1lfTwvYmlnPid9LAogICAgICAgICAgICAnb2JqZWN0X2luZm9fbGlzdCcsIF9kaWN0PVRydWUpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfZ29vZF9pbmZvKHNlbGYsIGFydGljbGU6IHN0cikgLT4gc3RyOgogICAgICAgIHF1ZXJ5ID0gKCdTRUxFQ1QgUlNfZ29vZHMubmFtZSBhcyBuYW1lJwogICAgICAgICAgICAgICAgICcgRlJPTSBSU19kb2NzX3RhYmxlJwogICAgICAgICAgICAgICAgICcgTEVGVCBKT0lOIFJTX2dvb2RzIE9OIFJTX2RvY3NfdGFibGUuaWRfZ29vZCA9IFJTX2dvb2RzLmlkJwogICAgICAgICAgICAgICAgICcgV0hFUkUgUlNfZG9jc190YWJsZS5pZF9kb2MgPSA/IEFORCBSU19nb29kcy5hcnQgPSA/JykKICAgICAgICBnb29kcyA9IHNlbGYuc2VydmljZS5wcm92aWRlci5zcWxfcXVlcnkocXVlcnksIGYne3NlbGYuaWRfZG9jfSx7YXJ0aWNsZX0nKQogICAgICAgIHJldHVybiBnb29kc1swXVsnbmFtZSddIGlmIGdvb2RzIGVsc2UgJ9Cd0LUg0L3QsNC50LTQtdC90L4nCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNldHRpbmdzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnYXJ0aWNsZXNfb2NyX3NldHRpbmdzJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF92aXNpb25fc2V0dGluZ3MoKipqc29uLmxvYWRzKHNldHRpbmdzKSkKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEFjdGl2ZUNWIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IE9DUiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ1NlcmlhbE51bWJlck9DUlNldHRpbmdzJwogICAgcHJvY2Vzc19uYW1lID0gJ09jclRleHRSZWNvZ25pdGlvbicKICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICBvY3Jfbm9zcWxfY291bnRlciA9IG5vQ2xhc3MoIm9jcl9ub3NxbF9jb3VudGVyIikKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKICAgICAgICBzZWxmLm9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgc2VsZi5zY3JlZW5fdGl0bGUgPSAn0KjQsNCx0LvQvtC9INGA0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIFMvTicKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX21pbl9yZWNfYW1vdW50JzogJzUnLAogICAgICAgICAgICAnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JzogJzEwJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JzogJ1NOJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfY29udGludW91c19yZWNvZ25pdGlvbic6ICdmYWxzZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnOiAndHJ1ZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX2N1cnJlbnRfdGVtcGxhdGUnOiAiIgogICAgICAgIH0KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdGl0bGUpCiAgICAgICAgc2VsZi5fc2V0X3NjcmVlbl92YWx1ZXMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fc2F2ZV9vY3Jfc2V0dGluZ3MnOgogICAgICAgICAgICBpc192YWxpZCwgZXJyb3IgPSBzZWxmLl92YWxpZGF0ZV9vY3Jfc2V0dGluZ3MoKQogICAgICAgICAgICBpZiBub3QgaXNfdmFsaWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGVycm9yKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuX3NhdmVfdGVtcGxhdGVfcGF0dGVybnMoKQogICAgICAgICAgICBzZWxmLl9zYXZlX3RlbXBsYXRlX3NldHRpbmdzKCkKICAgICAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRgdC+0YXRgNCw0L3RkdC9JykKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfc2V0X3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUsIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBuZXdfdmFsdWUgPSBzZWxmLmhhc2hfbWFwLmdldCh2YWx1ZV9uYW1lKSBvciBzZWxmLm9jcl9ub3NxbC5nZXQodmFsdWVfbmFtZSkgb3IgdmFsdWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQodmFsdWVfbmFtZSwgbmV3X3ZhbHVlKQoKCiAgICBkZWYgX3NhdmVfdGVtcGxhdGVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUgaW4gc2VsZi5zY3JlZW5fdmFsdWVzOgogICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQodmFsdWVfbmFtZSwgc2VsZi5oYXNoX21hcC5nZXQodmFsdWVfbmFtZSksIFRydWUpCgogICAgZGVmIF9zYXZlX3RlbXBsYXRlX3BhdHRlcm5zKHNlbGYpOgogICAgICAgIG51bV9hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JykKICAgICAgICBwcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnKQogICAgICAgIHVzZV9wcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBpZiB1c2VfcHJlZml4ID09ICd0cnVlJzoKICAgICAgICAgICAgcGF0dGVybnMgPSBbcmYnXntwcmVmaXh9JywgcmYnKFteXGRvT10pKFxke3t7bnVtX2Ftb3VudH19fSkkJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXR0ZXJucyA9IFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGN1cnJlbnRfdGVtcGxhdGUgPSAoZifQotC10LrRg9GJ0LjQuSDRiNCw0LHQu9C+0L06IHtwcmVmaXggaWYgdXNlX3ByZWZpeCA9PSAidHJ1ZSIgZWxzZSAiIn0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ3siKiIgKiBpbnQobnVtX2Ftb3VudCl9JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2NyX3NlcmlhbF9jdXJyZW50X3RlbXBsYXRlJywgY3VycmVudF90ZW1wbGF0ZSkKICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcGF0dGVybnMnLCBqc29uLmR1bXBzKHBhdHRlcm5zKSwgVHJ1ZSkKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICAiIiLQo9GB0YLQsNC90LDQstC70LjQstCw0LXRgiDQvdCw0YHRgtGA0L7QudC60Lgg0LTQu9GPINC60L3QvtC/0LrQuCDRgNCw0YHQv9C+0LfQvdCw0LLQsNC90LjRjyDRgtC10LrRgdGC0LAiIiIKICAgICAgICBudW1fYW1vdW50ID0gaW50KHNlbGYub2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50Jykgb3IgJzEwJykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5vY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnKQogICAgICAgIGlmIHVzZV9wcmVmaXggPT0gJ3RydWUnOgogICAgICAgICAgICBwcmVmaXggPSBzZWxmLm9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICAgICAgbWluX2xlbmd0aCA9IG51bV9hbW91bnQgKyBsZW4ocHJlZml4KQogICAgICAgICAgICBtYXhfbGVuZ3RoID0gbWluX2xlbmd0aCArIDIKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaW5fbGVuZ3RoLCBtYXhfbGVuZ3RoID0gbnVtX2Ftb3VudCwgbnVtX2Ftb3VudAogICAgICAgIHZhbHVlc19saXN0ID0gKCJ+W3tcImFjdGlvblwiOlwicnVuXCIsXCJ0eXBlXCI6XCJweXRob25cIiwiCiAgICAgICAgICAgICAgICAgICAgICAgIlwibWV0aG9kXCI6XCJzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jclwifV0iKQogICAgICAgIHJlY19zZXR0aW5ncyA9IGRpY3QoCiAgICAgICAgICAgIHZhbHVlc19saXN0PXZhbHVlc19saXN0LAogICAgICAgICAgICBtYXhfbGVuZ3RoPW1heF9sZW5ndGgsCiAgICAgICAgICAgIG1pbl9sZW5ndGg9bWluX2xlbmd0aCwKICAgICAgICApCiAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsLnB1dCgnc2VyaWFsX29jcl9zZXR0aW5ncycsIGpzb24uZHVtcHMocmVjX3NldHRpbmdzKSwgVHJ1ZSkKCiAgICBkZWYgX3ZhbGlkYXRlX29jcl9zZXR0aW5ncyhzZWxmKSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgICAgICIiItCS0LDQu9C40LTQsNGG0LjRjyDQtNCw0L3QvdGL0YUg0LLQstC10LTQtdC90L3Ri9GFINCyINC00LjQsNC70L7Qs9C1INCo0LDQsdC70L7QvdCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIiIiCiAgICAgICAgbWluX3JlY19hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9taW5fcmVjX2Ftb3VudCcpCiAgICAgICAgbnVtX2Ftb3VudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnKQogICAgICAgIHByZWZpeDogc3RyID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfdXNlX3ByZWZpeCcpCiAgICAgICAgaWYgbm90IG1pbl9yZWNfYW1vdW50LmlzZGlnaXQoKSBvciBpbnQobWluX3JlY19hbW91bnQpID09IDA6CiAgICAgICAgICAgIGVycm9yID0gKCfQo9C60LDQttC40YLQtSDQutC+0YDRgNC10LrRgtC90L7QtSDQvNC40L3QuNC80LDQu9GM0L3QvtC1INC60L7Qu9C40YfQtdGB0YLQstC+JwogICAgICAgICAgICAgICAgICAgICcg0L7QsdC90LDRgNGD0LbQtdC90LjQuSDRgdC10YDQuNC50L3QvtCz0L4g0L3QvtC80LXRgNCwJykKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIGlmIG5vdCBudW1fYW1vdW50LmlzZGlnaXQoKToKICAgICAgICAgICAgZXJyb3IgPSAn0JrQvtC70LjRh9C10YHRgtCy0L4g0YbQuNGE0YAg0LIg0YjQsNCx0LvQvtC90LUg0L3QtSDQutC+0YDRgNC10LrRgtC90L4nCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZXJyb3IKICAgICAgICBpZiBub3QgMSA8IGludChudW1fYW1vdW50KSA8IDIxOgogICAgICAgICAgICBlcnJvciA9ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDRhtC40YTRgCDQsiDRiNCw0LHQu9C+0L3QtSDQtNC+0LvQttC90L4g0LHRi9GC0Ywg0LIg0LjQvdGC0LXRgNCy0LDQu9C1INC+0YIgMiDQtNC+IDIwJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4Lmlzc3BhY2UoKSBhbmQgdXNlX3ByZWZpeCA9PSAndHJ1ZSc6CiAgICAgICAgICAgIGVycm9yID0gJ9Cd0LUg0YPQutCw0LfQsNC9INC/0YDQtdGE0LjQutGBJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4ICE9IHByZWZpeC5zdHJpcCgpOgogICAgICAgICAgICBlcnJvciA9ICfQn9GA0L7QsdC10LvRiyDQsiDQvdCw0YfQsNC70LUg0LjQu9C4INCyINC60L7QvdGG0LUg0L/RgNC10YTQuNC60YHQsCcKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIHJldHVybiBUcnVlLCAnJwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jcihoYXNoX21hcDogSGFzaE1hcCkgLT4gTm9uZToKICAgICAgICAiIiLQndCw0YXQvtC00LjRgiDQsiDQv9C10YDQtdC00LDQvdC90L7QuSDQuNC3IE9DUiDRgdGC0YDQvtC60LUg0YHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGALCDQv9C+INC30LDQtNCw0L3QvdC+0LzRgyDRiNCw0LHQu9C+0L3RgyIiIgogICAgICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIgPSBub0NsYXNzKCJvY3Jfbm9zcWxfY291bnRlciIpCiAgICAgICAgb2NyX3RleHQgPSBoYXNoX21hcC5nZXQoIm9jcl90ZXh0IikKICAgICAgICB1c2VfcHJlZml4ID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBudW1fYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbnVtX2Ftb3VudCcpKSBvciAxMAogICAgICAgIHBhdHRlcm5zID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wYXR0ZXJucycpCiAgICAgICAgcGF0dGVybnMgPSBqc29uLmxvYWRzKHBhdHRlcm5zKSBpZiBwYXR0ZXJucyBlbHNlIFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGZvciBwYXR0ZXJuIGluIHBhdHRlcm5zOgogICAgICAgICAgICBtYXRjaF9udW0gPSByZS5zZWFyY2gocGF0dGVybiwgb2NyX3RleHQpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaF9udW06CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICByZXN1bHQgPSBtYXRjaF9udW0uZ3JvdXAoMikgaWYgdXNlX3ByZWZpeCA9PSAndHJ1ZScgZWxzZSBtYXRjaF9udW0uZ3JvdXAoKQogICAgICAgIG1pbl9yZWNfYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbWluX3JlY19hbW91bnQnKSkKICAgICAgICByZXN1bHRfaW5fbWVtb3J5ID0gb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHJlc3VsdCkKICAgICAgICBpZiByZXN1bHRfaW5fbWVtb3J5IGlzIE5vbmU6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIDEsIFRydWUpCiAgICAgICAgZWxpZiByZXN1bHRfaW5fbWVtb3J5IDwgbWluX3JlY19hbW91bnQ6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIHJlc3VsdF9pbl9tZW1vcnkgKyAxLCBUcnVlKQogICAgICAgIGVsaWYgcmVzdWx0X2luX21lbW9yeSA9PSBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIucHV0KHJlc3VsdCwgcmVzdWx0X2luX21lbW9yeSArIDEsIFRydWUpCiAgICAgICAgICAgIGZyb21fc2NyZWVuID0gb2NyX25vc3FsLmdldCgnZnJvbV9zY3JlZW4nKQogICAgICAgICAgICBpZiBmcm9tX3NjcmVlbiA9PSAnRmxvd0RvY0RldGFpbHNTY3JlZW4nOgogICAgICAgICAgICAgICAgZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoaGFzaF9tYXBbJ2lkX2RvYyddKS5hZGRfYmFyY29kZV90b19kYXRhYmFzZShyZXN1bHQpCiAgICAgICAgICAgIGVsaWYgZnJvbV9zY3JlZW4gPT0gJ1Nlcmllc1NlbGVjdFNjcmVlbic6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXQoIm9jcl9yZXN1bHQiLCByZXN1bHQpCiAgICAgICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdvY3JfcmVzdWx0JywgcmVzdWx0LCBUcnVlKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAOiAnICsgcmVzdWx0KQogICAgICAgICAgICBpZiBvY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX2NvbnRpbnVvdXNfcmVjb2duaXRpb24nKSA9PSAnZmFsc2UnOgogICAgICAgICAgICAgICAgaGFzaF9tYXAucHV0KCJvY3JfcmVzdWx0IiwgcmVzdWx0KQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGZvciBzZXJpYWwgaW4ganNvbi5sb2FkcyhvY3Jfbm9zcWxfY291bnRlci5nZXRhbGxrZXlzKCkpOgogICAgICAgICAgICAgICAgaWYgb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHNlcmlhbCkgPCBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgICAgICAgICBvY3Jfbm9zcWxfY291bnRlci5wdXQoc2VyaWFsLCAwLCBUcnVlKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gT0NSIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IFNlcnZpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgVGltZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYucnNfc2V0dGluZ3MgPSBfcnNfc2V0dGluZ3MKICAgICAgICBzZWxmLmh0dHBfc2V0dGluZ3MgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZSgpCiAgICAgICAgc2VsZi5odHRwX3NlcnZpY2UgPSBIc1NlcnZpY2Uoc2VsZi5odHRwX3NldHRpbmdzKQoKICAgIGRlZiB0aW1lcl9vbl9zdGFydChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdzdG9wX3RpbWVyX3VwZGF0ZScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2xvYWRfZG9jcygpCiAgICAgICAgc2VsZi51cGxvYWRfZGF0YSgpCiAgICAgICAgc2VsZi5fdXBsb2FkX2J1ZmZlcl9kYXRhKCkKCiAgICBkZWYgX3B1dF9ub3RpZmljYXRpb24oc2VsZiwgdGV4dCwgdGl0bGU9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5ub3RpZmljYXRpb24odGV4dCwgdGl0bGUpCgogICAgZGVmIF9nZXRfaHR0cF9zZXR0aW5ncyhzZWxmKToKICAgICAgICBodHRwX3NldHRpbmdzID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgICAgICAgICAndXNlcic6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICAgICAgICAgJ2RldmljZV9tb2RlbCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZXZpY2VfbW9kZWwnKSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnYW5kcm9pZF9pZCcpLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgogICAgZGVmIF9sb2FkX2RvY3Moc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgZG9jc19kYXRhID0gc2VsZi5odHRwX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICAgICBkYXRhID0gZG9jc19kYXRhLmdldCgnZGF0YScpCiAgICAgICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuVGltZXJTZXJ2aWNlKCkKICAgICAgICAgICAgbmV3X2RvY3VtZW50cyA9IHNlcnZpY2UuZ2V0X25ld19sb2FkX2RvY3MoZGF0YSkKICAgICAgICAgICAgc2VydmljZS5zYXZlX2xvYWRfZGF0YShkYXRhKQogICAgICAgICAgICAjIHNlbGYuZGJfc2VydmljZS51cGRhdGVfZGF0YV9mcm9tX2pzb24oZG9jc19kYXRhWydkYXRhJ10pINCh0YLQsNGA0YvQuSDQstCw0YDQuNCw0L3RgiDQvtCx0LzQtdC90LAuCgogICAgICAgICAgICBpZiBuZXdfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbm90aWZ5X3RleHQgPSBzZWxmLl9nZXRfbm90aWZ5X3RleHQobmV3X2RvY3VtZW50cykKICAgICAgICAgICAgICAgIHNlbGYuX3B1dF9ub3RpZmljYXRpb24odGV4dD1ub3RpZnlfdGV4dCwgdGl0bGU9ItCX0LDQs9GA0YPQttC10L3RiyDQtNC+0LrRg9C80LXQvdGC0Ys6IikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9ZS5hcmdzWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQt9Cw0LPRgNGD0LfQutC4INC00L7QutGD0LzQtdC90YLQvtCyJykKCiAgICBkZWYgdXBsb2FkX2RhdGEoc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlcnZpY2UgPSBUaW1lclNlcnZpY2UoKQogICAgICAgIGRhdGEgPSBzZXJ2aWNlLmdldF9kYXRhX3RvX3NlbmQoKQoKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5odHRwX3NlcnZpY2Uuc2VuZF9kYXRhKGRhdGEpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsicpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1hbnN3ZXIuZXJyb3JfdGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsicpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZG9jc19saXN0X3N0cmluZyA9ICcsICcuam9pbihbZiIne2RbJ2lkX2RvYyddfSciIGZvciBkIGluIGRhdGFdKQogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UudXBkYXRlX3VwbG9hZGVkX2RvY3Nfc3RhdHVzKGRvY3NfbGlzdF9zdHJpbmcpCgogICAgZGVmIF91cGxvYWRfYnVmZmVyX2RhdGEoc2VsZik6CiAgICAgICAgIyDQmNC80Y8g0YLQsNCx0LvQuNGG0Ysg0L7Rh9C10YDQtdC00LggKNC40LzRjyDQvNC10YLQvtC00LAg0LIgdXJsIGh0dHAt0YHQtdGA0LLQuNGB0LApCiAgICAgICAgYnVmZmVyX3RhYmxlcyA9IFsKICAgICAgICAgICAgJ2JhcmNvZGVzJywKICAgICAgICAgICAgJ2RvY3VtZW50cycKICAgICAgICBdCgogICAgICAgIGZvciBidWZmZXJfdGFibGUgaW4gYnVmZmVyX3RhYmxlczoKICAgICAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKGJ1ZmZlcl90YWJsZSkKICAgICAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCgogICAgICAgICAgICBtZXRob2QgPSBzZWxmLmh0dHBfc2VydmljZS5nZXRfbWV0aG9kX2J5X3BhdGgoYnVmZmVyX3RhYmxlKQogICAgICAgICAgICBpZiBkYXRhX3RvX3NlbmQgYW5kIG1ldGhvZDoKICAgICAgICAgICAgICAgIHJlcyA9IG1ldGhvZChkYXRhX3RvX3NlbmQpCgogICAgICAgICAgICAgICAgaWYgbm90IHJlcy5lcnJvcjoKICAgICAgICAgICAgICAgICAgICBidWZmZXJfc2VydmljZS5yZW1vdmVfc2VudF9kYXRhKGRhdGFfdG9fc2VuZCkKCiAgICBkZWYgX2NoZWNrX2h0dHBfc2V0dGluZ3Moc2VsZikgLT4gYm9vbDoKICAgICAgICBodHRwID0gc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKQogICAgICAgIHJldHVybiBhbGwoW2h0dHAuZ2V0KCd1cmwnKSwgaHR0cC5nZXQoJ3VzZXInKSwgaHR0cC5nZXQoJ3Bhc3MnKV0pCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfbm90aWZ5X3RleHQobmV3X2RvY3VtZW50cyk6CiAgICAgICAgZG9jX3RpdGxlcyA9IFsKICAgICAgICAgICAgJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoaXRlbVsnZG9jX3R5cGUnXSwgaXRlbVsnZG9jX24nXSwgaXRlbVsnZG9jX2RhdGUnXSkKICAgICAgICAgICAgZm9yIGl0ZW0gaW4gbmV3X2RvY3VtZW50cy52YWx1ZXMoKV0KICAgICAgICByZXR1cm4gIiwgIi5qb2luKGRvY190aXRsZXMpCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIGhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5IdHRwQW5zd2VyKAogICAgICAgICAgICAgICAgZXJyb3I9VHJ1ZSwKICAgICAgICAgICAgICAgIGVycm9yX3RleHQ9c3RyKGUuYXJnc1swXSksCiAgICAgICAgICAgICAgICBzdGF0dXNfY29kZT00MDQsCiAgICAgICAgICAgICAgICB1cmw9aHNfc2VydmljZS51cmwpCiAgICAgICAgcmV0dXJuIG5vdCBhbnN3ZXIuZXJyb3IKCmNsYXNzIFdlYlNlcnZpY2VTeW5jQ29tbWFuZDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hfbWFwCiAgICAgICAgc2VsZi5saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAubGlzdGVuZXIKCiAgICBkZWYgb25fc2VydmljZV9yZXF1ZXN0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2JhcmNvZGVzJzogc2VsZi5fZ2V0X2JhcmNvZGVzX2RhdGEsCiAgICAgICAgICAgICdoYXNoX21hcCc6IHNlbGYuX2dldF9oYXNoX21hcCwKICAgICAgICAgICAgJ2hhc2hfbWFwX3NpemUnOiBzZWxmLl9nZXRfaGFzaF9tYXBfc2l6ZSwKICAgICAgICAgICAgJ3JzX3NldHRpbmdzJzogc2VsZi5fZ2V0X3JzX3NldHRpbmdzCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVzX2RhdGEoc2VsZik6CiAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCiAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlSGVhZGVycycsIGhlYWRlcnMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZScsIGRhdGFfdG9fc2VuZCwgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBfZ2V0X2hhc2hfbWFwKHNlbGYpOgogICAgICAgIHByb2Nlc3NfbWFwID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigncHJvY2Vzc19tYXAnKQoKICAgICAgICBib2R5ID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignd3NfYm9keScpCiAgICAgICAgaWYgYm9keToKICAgICAgICAgICAgcmVzcG9uc2UgPSBwcm9jZXNzX21hcC5nZXQoYm9keVsnaXRlbSddKQoKICAgICAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlJywgcmVzcG9uc2UpCgogICAgZGVmIF9nZXRfaGFzaF9tYXBfc2l6ZShzZWxmKToKICAgICAgICBpbXBvcnQgc3lzCiAgICAgICAgcHJvY2Vzc19tYXAgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdwcm9jZXNzX21hcCcpIG9yIHt9CgogICAgICAgIGhlYWRlcnMgPSBbeydrZXknOiAnQ29udGVudC1UeXBlJywgJ3ZhbHVlJzogJ2FwcGxpY2F0aW9uL2pzb24nfV0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCgogICAgICAgIHJlc3AgPSB7a2V5OiByb3VuZChzeXMuZ2V0c2l6ZW9mKHYpIC8gMTAyNCwgMykgZm9yIGtleSwgdiAgaW4gcHJvY2Vzc19tYXAuaXRlbXMoKX0KICAgICAgICByZXNwWyd0b3RhbCddID0gcm91bmQoc3VtKHJlc3AudmFsdWVzKCkpLCAzKQoKICAgICAgICByZXNwX3NvcnRlZCA9IHtrOiB2IGZvciBrLCB2IGluIHNvcnRlZChyZXNwLml0ZW1zKCksIGtleT1sYW1iZGEgaXRlbTogaXRlbVsxXSwgcmV2ZXJzZT1UcnVlKX0KCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1dTUmVzcG9uc2UnLCByZXNwX3NvcnRlZCwgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBfZ2V0X3JzX3NldHRpbmdzKHNlbGYpOgoKICAgICAgICBwcm92aWRlciA9IE5vU1FMUHJvdmlkZXIoJ3JzX3NldHRpbmdzJykKCiAgICAgICAgcmVzcG9uc2UgPSBqc29uLmR1bXBzKHtpdGVtWzBdOiBpdGVtWzFdIGZvciBpdGVtIGluIHByb3ZpZGVyLml0ZW1zKCl9KQoKICAgICAgICBoZWFkZXJzID0gW3sna2V5JzogJ0NvbnRlbnQtVHlwZScsICd2YWx1ZSc6ICdhcHBsaWNhdGlvbi9qc29uJ31dCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1dTUmVzcG9uc2VIZWFkZXJzJywgaGVhZGVycywgdG9fanNvbj1UcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlJywgcmVzcG9uc2UpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gU2VydmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gTWFpbiBldmVudHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBNYWluRXZlbnRzOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBzZWxmLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBzZWxmLnJzX3NldHRpbmdzID0gX3JzX3NldHRpbmdzCgogICAgZGVmIGFwcF9vbl9zdGFydChzZWxmKToKICAgICAgICBNYWluRXZlbnRzLnN0YXJ0X3RpbWVyKHNlbGYuaGFzaF9tYXApCgogICAgICAgICMgVE9ETyDQntCx0YDQsNCx0L7RgtGH0LjQutC4INC+0LHQvdC+0LLQu9C10L3QuNGPIQogICAgICAgIHJlbGVhc2UgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnUmVsZWFzZScpIG9yICcnCiAgICAgICAgdG9hc3QgPSAn0JPQvtGC0L7QsiDQuiDRgNCw0LHQvtGC0LUnCgogICAgICAgIGN1cnJlbnRfcmVsZWFzZSA9IHNlbGYuaGFzaF9tYXBbJ19jb25maWd1cmF0aW9uVmVyc2lvbiddCgoKCiAgICAgICAgaWYgY3VycmVudF9yZWxlYXNlIGlzIE5vbmU6CiAgICAgICAgICAgIHRvYXN0ID0gJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0L7Qv9GA0LXQtNC10LvQuNGC0Ywg0LLQtdGA0YHQuNGOINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCcKCiAgICAgICAgaWYgY3VycmVudF9yZWxlYXNlIGFuZCByZWxlYXNlICE9IGN1cnJlbnRfcmVsZWFzZToKICAgICAgICAgICAgIyBpbXBvcnQgdmVyc2lvbl9jb250cm9sCiAgICAgICAgICAgICMgcmVzdWx0X2xpc3QgPSB2ZXJzaW9uX2NvbnRyb2wucnVuX3JlbGVhc2VzKHJlbGVhc2UsIGN1cnJlbnRfcmVsZWFzZSkKICAgICAgICAgICAgIyBmb3IgZWxlbSBpbiByZXN1bHRfbGlzdDoKICAgICAgICAgICAgIyAgICAgaWYgbm90IGVsZW1bJ3Jlc3VsdCddOgogICAgICAgICAgICAjICAgICAgICAgcGFzcwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnSW5zdGFsbENvbmZpZ3VyYXRpb24nLCAnJykKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1JlbGVhc2UnLCBjdXJyZW50X3JlbGVhc2UsIFRydWUpCiAgICAgICAgICAgIHRvYXN0ID0gZifQktGL0L/QvtC70L3QtdC90L4g0L7QsdC90L7QstC70LXQvdC40LUg0L3QsCDQstC10YDRgdC40Y4ge2N1cnJlbnRfcmVsZWFzZX0nCgogICAgICAgIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZWxldGVfb2xkX2RvY3MnKSBpcyBUcnVlOgogICAgICAgICAgICBkZWxldGVkX2RvY3MgPSBzZWxmLl9kZWxldGVfb2xkX2RvY3MoKQogICAgICAgICAgICBpZiBkZWxldGVkX2RvY3M6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbigKICAgICAgICAgICAgICAgICAgICB0ZXh0PWYn0KPQtNCw0LvQtdC90Ysg0LTQvtC60YPQvNC10L3RgtGLOiAoe2xlbihkZWxldGVkX2RvY3MpfSknLAogICAgICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LrQsCDQvdC10LDQutGC0YPQsNC70YzQvdGL0YUg0LTQsNC90L3Ri9GFJykKCiAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiAxOCwKICAgICAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnOiAyMCwKICAgICAgICAgICAgJ0NhcmREYXRlVGV4dFNpemUnOiAxMCwKICAgICAgICAgICAgJ0NhcmRUZXh0U2l6ZSc6IDE1LAogICAgICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogMTYsCiAgICAgICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogMTUsCiAgICAgICAgICAgICdzaWduYWxfbnVtJzogNSwKICAgICAgICAgICAgJ3VzZV9tYXJrJzogJ2ZhbHNlJywKICAgICAgICAgICAgJ2FkZF9pZl9ub3RfaW5fcGxhbic6ICdmYWxzZScsCiAgICAgICAgICAgICdwYXRoJzogJycsCiAgICAgICAgICAgICdzdWNjZXNzX3NpZ25hbCc6IDcsCiAgICAgICAgICAgICd3YXJuaW5nX3NpZ25hbCc6IDgsCiAgICAgICAgICAgICdlcnJvcl9zaWduYWwnOiA1LAogICAgICAgICAgICAnYWxsb3dfb3ZlcnNjYW4nOiAnZmFsc2UnLAogICAgICAgICAgICAicGF0aF90b19kYXRhYmFzZXMiOiAiLi8iLAogICAgICAgICAgICAnc3FsaXRlX25hbWUnOiAnU2ltcGxlS2VlcCcsCiAgICAgICAgICAgICdsb2dfbmFtZSc6ICdsb2cuanNvbicsCiAgICAgICAgICAgICd0aW1lcl9pc19kaXNhYmxlZCc6IEZhbHNlLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCc6IEZhbHNlLAogICAgICAgICAgICAnb2ZmbGluZV9tb2RlJzogRmFsc2UsCiAgICAgICAgICAgICdkZWxldGVfb2xkX2RvY3MnOiBGYWxzZSwKICAgICAgICAgICAgJ3VzZXJfdG16X29mZnNldCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCJUTVoiKQogICAgICAgIH0KCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy8nKToKICAgICAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5nc1sncGF0aF90b19kYXRhYmFzZXMnXSA9ICcvL2RhdGEvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS9kYXRhYmFzZXMnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5nc1sncGF0aF90b19kYXRhYmFzZXMnXSA9ICIuLyIKCiAgICAgICAgZm9yIGssIHYgaW4gcnNfZGVmYXVsdF9zZXR0aW5ncy5pdGVtcygpOgogICAgICAgICAgICBpZiBzZWxmLnJzX3NldHRpbmdzLmdldChrKSBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoaywgdiwgVHJ1ZSkKCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RldmljZV9tb2RlbCcsIHNlbGYuaGFzaF9tYXBbJ0RFVklDRV9NT0RFTCddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdhbmRyb2lkX2lkJywgc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLCBUcnVlKQoKICAgICAgICBzZWxmLl9jcmVhdGVfdGFibGVzKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsiU1FMQ29ubmVjdERhdGFiYXNlIl0gPSAiU2ltcGxlS2VlcCIKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHRvYXN0KQoKICAgIGRlZiBvbl9zcWxfZXJyb3Ioc2VsZik6CiAgICAgICAgc3FsX2Vycm9yID0gc2VsZi5oYXNoX21hcFsnU1FMRXJyb3InXQogICAgICAgIGlmIHNxbF9lcnJvcjoKICAgICAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgICAgICBzZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZygKICAgICAgICAgICAgICAgIGVycm9yX3R5cGU9IlNRTF9FcnJvciIsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXNxbF9lcnJvciwKICAgICAgICAgICAgICAgIGVycm9yX2luZm89JycKICAgICAgICAgICAgICAgICkKCiAgICBkZWYgX2NyZWF0ZV90YWJsZXMoc2VsZik6CiAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRiQ3JlYXRvcigpCiAgICAgICAgc2VydmljZS5jcmVhdGVfdGFibGVzKCkKCiAgICBkZWYgX2RlbGV0ZV9vbGRfZG9jcyhzZWxmKSAtPiBsaXN0OgogICAgICAgIGRheXMgPSBpbnQoc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycpKQogICAgICAgIHNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5Eb2NTZXJ2aWNlKCkKICAgICAgICByZXR1cm4gc2VydmljZS5kZWxldGVfb2xkX2RvY3MoZGF5cykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgc3RhcnRfdGltZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnN0YXJ0X3RpbWVycygndGltZXJfdXBkYXRlJywgcGVyaW9kPTE1MDAwLCBic19oYXNoX21hcD1UcnVlKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIE1haW4gZXZlbnRzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTY3JlZW5zRmFjdG9yeToKICAgIHNjcmVlbnMgPSBbR29vZHNTZWxlY3RTY3JlZW4sCiAgICAgICAgSHRtbFZpZXcsCiAgICAgICAgVGVtcGxhdGVzTGlzdCwKICAgICAgICBGbG93VGlsZXNTY3JlZW4sCiAgICAgICAgRmxvd0RvY1NjcmVlbiwKICAgICAgICBGbG93RG9jRGV0YWlsc1NjcmVlbiwKICAgICAgICBHcm91cFNjYW5UaWxlcywKICAgICAgICBEb2N1bWVudHNUaWxlcywKICAgICAgICBHcm91cFNjYW5Eb2NzTGlzdFNjcmVlbiwKICAgICAgICBEb2N1bWVudHNEb2NzTGlzdFNjcmVlbiwKICAgICAgICBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3LAogICAgICAgIEdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4sCiAgICAgICAgRG9jdW1lbnRzRG9jRGV0YWlsU2NyZWVuLAogICAgICAgIEVycm9yTG9nU2NyZWVuLAogICAgICAgIERlYnVnU2V0dGluZ3NTY3JlZW4sCiAgICAgICAgSHR0cFNldHRpbmdzU2NyZWVuLAogICAgICAgIFNldHRpbmdzU2NyZWVuLAogICAgICAgIEdvb2RzTGlzdFNjcmVlbiwKICAgICAgICBTZWxlY3RHb29kc1R5cGUsCiAgICAgICAgSXRlbUNhcmQsCiAgICAgICAgRm9udFNpemVTZXR0aW5nc1NjcmVlbiwKICAgICAgICBCYXJjb2RlVGVzdFNjcmVlbiwKICAgICAgICBTb3VuZFNldHRpbmdzLAogICAgICAgIEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCwKICAgICAgICBHb29kc1ByaWNlc0l0ZW1DYXJkLAogICAgXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lPU5vbmUsIHByb2Nlc3M9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBzY3JlZW5fbmFtZToKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSBrd2FyZ3NbJ2hhc2hfbWFwJ10uZ2V0X2N1cnJlbnRfc2NyZWVuKCkKICAgICAgICBpZiBub3QgcHJvY2VzczoKICAgICAgICAgICAgcHJvY2VzcyA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9wcm9jZXNzKCkKCiAgICAgICAgZm9yIGl0ZW0gaW4gU2NyZWVuc0ZhY3Rvcnkuc2NyZWVuczoKICAgICAgICAgICAgaWYgZ2V0YXR0cihpdGVtLCAnc2NyZWVuX25hbWUnKSA9PSBzY3JlZW5fbmFtZSBhbmQgZ2V0YXR0cihpdGVtLCAncHJvY2Vzc19uYW1lJykgPT0gcHJvY2VzczoKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZV9zY3JlZW4oc2NyZWVuX25hbWU9Tm9uZSwgcHJvY2Vzcz1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IHNjcmVlbl9uYW1lOgogICAgICAgICAgICBzY3JlZW5fbmFtZSA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIGlmIG5vdCBwcm9jZXNzOgogICAgICAgICAgICBwcm9jZXNzID0ga3dhcmdzWydoYXNoX21hcCddLmdldF9jdXJyZW50X3Byb2Nlc3MoKQoKICAgICAgICBzY3JlZW5fY2xhc3MgPSBTY3JlZW5zRmFjdG9yeS5nZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lLCBwcm9jZXNzKQogICAgICAgIHJldHVybiBzY3JlZW5fY2xhc3MoKiprd2FyZ3MpCgoKY2xhc3MgTW9ja1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnTW9jaycKICAgIHByb2Nlc3NfbmFtZSA9ICdNb2NrJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKZGVmIHNldF9jdXJyZW50X3NjcmVlbihzY3JlZW4pOgogICAgZ2xvYmFsIGN1cnJlbnRfc2NyZWVuCiAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgpkZWYgc2V0X25leHRfc2NyZWVuKHNjcmVlbik6CiAgICBnbG9iYWwgbmV4dF9zY3JlZW4KICAgIG5leHRfc2NyZWVuID0gc2NyZWVuCiAgICByZXR1cm4gbmV4dF9zY3JlZW4KCmRlZiBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwOiBIYXNoTWFwLCBzY3JlZW5fY2xhc3M9Tm9uZSwgc2NyZWVuX3ZhbHVlcz1Ob25lKToKICAgICIiIgogICAg0JzQtdGC0L7QtCDQtNC70Y8g0L/QvtC70YPRh9C10L3QuNGPINC80L7QtNC10LvQuCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10Lkg0YLQtdC60YPRidC10LzRgyDQv9GA0L7RhtC10YHRgdGDINC4INGN0LrRgNCw0L3Rgy4KICAgINCV0YHQu9C4INC80L7QtNC10LvRjCDQvdC1INGA0LXQsNC70LjQt9C+0LLQsNC90LAg0LLQvtC30LLRgNCw0YnQsNC10YIg0LfQsNCz0LvRg9GI0LrRgwogICAg0KDQtdCw0LvQuNC30L7QstCw0L0g0YHQuNC90LPQu9GC0L7QvSDRh9C10YDQtdC3INCz0LvQvtCx0LDQu9GM0L3Rg9GOINC/0LXRgNC10LzQtdC90L3Rg9GOIGN1cnJlbnRfc2NyZWVuLCDQtNC70Y8g0YHQvtGF0YDQtdC90LXQvdC40Y8g0YHQvtGB0YLQvtGP0L3QuNGPINGC0LXQutGD0YnQtdCz0L4g0Y3QutGA0LDQvdCwCiAgICAiIiIKICAgIGdsb2JhbCBjdXJyZW50X3NjcmVlbiwgbmV4dF9zY3JlZW4KCiAgICBzY3JlZW5fcGFyYW1zID0gewogICAgICAgICdoYXNoX21hcCc6IGhhc2hfbWFwLAogICAgICAgICdyc19zZXR0aW5ncyc6IF9yc19zZXR0aW5ncwogICAgfQogICAgaWYgc2NyZWVuX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgc2NyZWVuX2NsYXNzID0gU2NyZWVuc0ZhY3RvcnkuZ2V0X3NjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCgogICAgaWYgbm90IHNjcmVlbl9jbGFzczoKICAgICAgICBjdXJyZW50X3NjcmVlbiA9IE1vY2tTY3JlZW4oKipzY3JlZW5fcGFyYW1zKQogICAgZWxpZiB0eXBlKGN1cnJlbnRfc2NyZWVuKSBpcyBub3Qgc2NyZWVuX2NsYXNzOgogICAgICAgIGlmIHR5cGUobmV4dF9zY3JlZW4pIGlzIHNjcmVlbl9jbGFzczoKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4gPSBuZXh0X3NjcmVlbgogICAgICAgICAgICBuZXh0X3NjcmVlbiA9IE5vbmUKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4uaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIHNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXRfZGF0YShzY3JlZW5fdmFsdWVzKQogICAgICAgICAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCiAgICBlbHNlOgogICAgICAgIGN1cnJlbnRfc2NyZWVuLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBjdXJyZW50X3NjcmVlbi5saXN0ZW5lciA9IGhhc2hfbWFwWydsaXN0ZW5lciddCiAgICAgICAgY3VycmVudF9zY3JlZW4uZXZlbnQgPSBoYXNoX21hcFsnZXZlbnQnXQoKICAgIGlmIGN1cnJlbnRfc2NyZWVuLmlzX2ZpbmlzaF9wcm9jZXNzOgogICAgICAgIGZpbmlzaF9zY3JlZW4gPSBjdXJyZW50X3NjcmVlbgogICAgICAgIGN1cnJlbnRfc2NyZWVuID0gTm9uZQogICAgICAgIHJldHVybiBmaW5pc2hfc2NyZWVuCgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgo="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\ui_utils.py",
                "PyFileKey": "ui_utils",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzb2NrZXQKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzLCBhc2RpY3QKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBVbmlvbiwgTGlzdCwgRGljdCwgTGl0ZXJhbCwgT3B0aW9uYWwsIFR1cGxlCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBIYXNoTWFwOgogICAgIiIiCiAgICAgICAg0JrQu9Cw0YHRgS3QtNC10LrQvtGA0LDRgtC+0YAg0LTQu9GPINGD0LTQvtCx0L3QvtC5INGA0LDQsdC+0YLRiyDRgSBoYXNoTWFwLiDQotCw0LrQttC1INC80L7QttC90L4g0LTQvtCx0LDQstC40YLRjCDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Rg9GOINC70L7Qs9C40LrRgy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcD1Ob25lLCBkZWJ1ZzogYm9vbCA9IEZhbHNlKToKICAgICAgICBzZWxmLmxpc3RlbmVyID0gTm9uZQogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYuZGVidWdfbW9kZSA9IGRlYnVnCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIGZ1bmM6IENhbGxhYmxlWy4uLiwgTm9uZV0pOgogICAgICAgIEB3cmFwcyhmdW5jKQogICAgICAgIGRlZiB3cmFwcGVyKGhhc2hNYXAsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHNlbGYuaW5pdChoYXNoTWFwKQogICAgICAgICAgICBmdW5jKHNlbGYpCiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgZGVmIGluaXQoc2VsZiwgaGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hNYXAKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3NfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCgogICAgQHByb3BlcnR5CiAgICBkZWYgbGlzdGVuZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2xpc3RlbmVyJ10KCiAgICBAbGlzdGVuZXIuc2V0dGVyCiAgICBkZWYgbGlzdGVuZXIoc2VsZiwgdik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzZXRfcmVzdWx0X2xpc3RlbmVyKHNlbGYsIGxpc3RlbmVyKToKICAgICAgICBpZiBsaXN0ZW5lciBhbmQgaXNpbnN0YW5jZShsaXN0ZW5lciwgc3RyKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgbGlzdGVuZXIpCgogICAgZGVmIHRvYXN0KHNlbGYsIHRleHQsIGFkZF90b19sb2c9RmFsc2UpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsIHN0cih0ZXh0KSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBub3RpZmljYXRpb24oc2VsZiwgdGV4dCwgdGl0bGU9Tm9uZSwgYWRkX3RvX2xvZz1GYWxzZSk6CiAgICAgICAgbm90aWZpY2F0aW9uX2lkID0gcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSArIDEgaWYgcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSBlbHNlIDEKICAgICAgICBpZiB0aXRsZSBpcyBOb25lOgogICAgICAgICAgICB0aXRsZSA9IHNlbGYuZ2V0X2N1cnJlbnRfc2NyZWVuKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJiYXNpY19ub3RpZmljYXRpb24iLAogICAgICAgICAgICBqc29uLmR1bXBzKFt7J251bWJlcic6IG5vdGlmaWNhdGlvbl9pZCwgJ3RpdGxlJzogc3RyKHRpdGxlKSwgJ21lc3NhZ2UnOiB0ZXh0fV0pCiAgICAgICAgKQoKICAgICAgICByc19zZXR0aW5ncy5wdXQoIm5vdGlmaWNhdGlvbl9pZCIsIG5vdGlmaWNhdGlvbl9pZCwgVHJ1ZSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBkZWJ1ZyhzZWxmLCB0ZXh0KToKICAgICAgICBpZiBzZWxmLmRlYnVnX21vZGU6CiAgICAgICAgICAgIHNlbGYudG9hc3QodGV4dCwgYWRkX3RvX2xvZz1UcnVlKQoKICAgIGRlZiByZWZyZXNoX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgIGRlZiBydW5fZXZlbnQoc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSkpCgogICAgZGVmIHJ1bl9ldmVudF9hc3luYyhzZWxmLCBtZXRob2RfbmFtZSwgcG9zdF9leGVjdXRlX21ldGhvZD1Ob25lKToKICAgICAgICBydW5fZXZlbnQgPSBzZWxmLl9nZXRfZXZlbnQobWV0aG9kX25hbWUsICdydW5hc3luYycpCiAgICAgICAgaWYgcG9zdF9leGVjdXRlX21ldGhvZDoKICAgICAgICAgICAgcnVuX2V2ZW50WzBdWydwb3N0RXhlY3V0ZSddID0ganNvbi5kdW1wcyhzZWxmLl9nZXRfZXZlbnQocG9zdF9leGVjdXRlX21ldGhvZCkpCiAgICAgICAgc2VsZlsnUnVuRXZlbnQnXSA9IGpzb24uZHVtcHMocnVuX2V2ZW50KQoKICAgIGRlZiBydW5fZXZlbnRfcHJvZ3Jlc3Moc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSwgJ3J1bnByb2dyZXNzJykpCgogICAgZGVmIGJlZXAoc2VsZiwgdG9uZT0nJyk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JlZXAnLCBzdHIodG9uZSkpCgogICAgZGVmIHBsYXlzb3VuZChzZWxmLCBldmVudDogc3RyLCBzb3VuZF92YWw6IHN0ciA9ICcnKToKICAgICAgICBpZiBub3Qgc291bmRfdmFsOgogICAgICAgICAgICBzb3VuZCA9IHJzX3NldHRpbmdzLmdldChmJ3tldmVudH1fc2lnbmFsJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzb3VuZCA9IHNvdW5kX3ZhbAogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYncGxheXNvdW5kX3tzb3VuZH0nLCAiIikKCiAgICBkZWYgX2dldF9ldmVudChzZWxmLCBtZXRob2RfbmFtZSwgYWN0aW9uPU5vbmUpIC0+IExpc3RbZGljdF06CiAgICAgICAgIiIiCiAgICAgICAgOnBhcmFtIG1ldGhvZF9uYW1lOiBoYW5kbGVycyBuYW1lCiAgICAgICAgOnBhcmFtIGFjdGlvbjogcnVufHJ1bmFzeW5jfHJ1bnByb2dyZXNzCgogICAgICAgIDpyZXR1cm46IGV2ZW50IGRpY3QKICAgICAgICAiIiIKCiAgICAgICAgZXZ0ID0gW3sKICAgICAgICAgICAgJ2FjdGlvbic6IGFjdGlvbiBpZiBhY3Rpb24gZWxzZSAncnVuJywKICAgICAgICAgICAgJ3R5cGUnOiAncHl0aG9uJywKICAgICAgICAgICAgJ21ldGhvZCc6IG1ldGhvZF9uYW1lLAogICAgICAgIH1dCgogICAgICAgIHJldHVybiBldnQKCiAgICBkZWYgZXJyb3JfbG9nKHNlbGYsIGVycl9kYXRhKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGVycl9kYXRhID0ganNvbi5kdW1wcyhlcnJfZGF0YSwgZW5zdXJlX2FzY2lpPUZhbHNlLCBpbmRlbnQ9MikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGVycl9kYXRhID0gc3RyKGVycl9kYXRhKQoKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2Vycm9yX2xvZycsIGVycl9kYXRhLCBUcnVlKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBpdGVtKToKICAgICAgICByZXR1cm4gc2VsZi5nZXQoaXRlbSwgRmFsc2UpCgogICAgZGVmIF9fc2V0aXRlbV9fKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHNlbGYucHV0KGtleSwgdmFsdWUsIEZhbHNlKQoKICAgIGRlZiBnZXQoc2VsZiwgaXRlbSwgZnJvbV9qc29uPUZhbHNlKToKICAgICAgICBpZiBmcm9tX2pzb246CiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pKSBpZiBzZWxmLmhhc2hfbWFwLmdldChpdGVtKSBlbHNlIE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkKCiAgICBkZWYgZ2V0X2pzb24oc2VsZiwgaXRlbSk6CiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkpIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pIGVsc2UgTm9uZQoKICAgIGRlZiBnZXRfYm9vbChzZWxmLCBpdGVtKToKICAgICAgICB2YWx1ZSA9IHN0cihzZWxmLmhhc2hfbWFwLmdldChpdGVtKSkubG93ZXIoKSBub3QgaW4gKCcwJywgJ2ZhbHNlJywgJ25vbmUnKQogICAgICAgIHJldHVybiB2YWx1ZQoKICAgIGRlZiBwdXQoc2VsZiwga2V5LCB2YWx1ZTogVW5pb25bc3RyLCBMaXN0LCBEaWN0LCBib29sXSA9ICcnLCB0b19qc29uPUZhbHNlKToKICAgICAgICBpZiB0b19qc29uOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChrZXksIGpzb24uZHVtcHModmFsdWUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIGJvb2wpOgogICAgICAgICAgICAgICAgdmFsdWUgPSBzdHIodmFsdWUpLmxvd2VyKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoa2V5LCBzdHIodmFsdWUpKQoKICAgIGRlZiBwdXRfZGF0YShzZWxmLCBkYXRhOiBkaWN0LCBmaWxsX25vbmU9RmFsc2UsIGRlZmF1bHQ9JycpOgogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIGRhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIGlmIHZhbHVlIGlzIE5vbmUgYW5kIGZpbGxfbm9uZToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHQKCiAgICAgICAgICAgICAgICBzZWxmW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBjb250YWluc0tleShzZWxmLCBrZXkpOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmNvbnRhaW5zS2V5KGtleSkKCiAgICBkZWYga2V5X3NldChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAua2V5U2V0KCkKCiAgICBkZWYga2V5cyhzZWxmKSAtPiBMaXN0W3N0cl06CiAgICAgICAga2V5cyA9IHN0cihzZWxmLmtleV9zZXQoKSkKICAgICAgICByZXR1cm4ga2V5c1sxOmxlbihrZXlzKS0xXS5zcGxpdCgnLCAnKQoKICAgIGRlZiBpdGVtcyhzZWxmKSAtPiBMaXN0W1R1cGxlW3N0ciwgT3B0aW9uYWxbc3RyXV1dOgogICAgICAgIHJldHVybiBbKGtleSwgc2VsZltrZXldKSBmb3Iga2V5IGluIHNlbGYua2V5cygpXQoKICAgIGRlZiBzaG93X2l0ZW1zKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBvbmx5OiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgZXhjbHVkZTogT3B0aW9uYWxbTGlzdFtzdHJdXSA9IE5vbmUsCiAgICAgICAgICAgIGlzX3ZhbHVlX2V4aXN0czogYm9vbCA9IEZhbHNlLAogICAgKSAtPiBOb25lOgogICAgICAgIHRleHQgPSAn0KHQv9C40YHQvtC6INGN0LvQtdC80LXQvdGC0L7QsiBIYXNoTWFwOiBcbicKICAgICAgICBpZiBpc192YWx1ZV9leGlzdHM6CiAgICAgICAgICAgIHRleHQgKz0gJ1RydWUg0LXRgdC70Lgg0LXRgdGC0Ywg0LvRjtCx0L7QtSDQt9C90LDRh9C10L3QuNC1IFxuJwogICAgICAgIGhhc2htYXBfa2V5cyA9IHNlbGYua2V5cygpCiAgICAgICAgaXRlbXMgPSBzZWxmLml0ZW1zKCkKICAgICAgICBpZiBvbmx5OgogICAgICAgICAgICBpdGVtcyA9IFtpdGVtIGZvciBpdGVtIGluIGl0ZW1zIGlmIGl0ZW1bMF0gaW4gb25seV0KICAgICAgICAgICAgZm9yIGtleSBpbiBvbmx5OgogICAgICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBoYXNobWFwX2tleXM6CiAgICAgICAgICAgICAgICAgICAgaXRlbXMuYXBwZW5kKChrZXksICfQndC10YIg0LrQu9GO0YfQsCcpKQogICAgICAgIGlmIGV4Y2x1ZGU6CiAgICAgICAgICAgIGl0ZW1zID0gW2l0ZW0gZm9yIGl0ZW0gaW4gaXRlbXMgaWYgaXRlbVswXSBub3QgaW4gZXhjbHVkZV0KCiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gaXRlbXM6CiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgaWYgbm90IGlzX3ZhbHVlX2V4aXN0cyBlbHNlIHZhbHVlIGlzIG5vdCBOb25lCiAgICAgICAgICAgIHRleHQgKz0gZid7a2V5fToge3ZhbHVlfVxuJwogICAgICAgIHNlbGYudG9hc3QodGV4dCkKCgogICAgZGVmIHJlbW92ZShzZWxmLCBrZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgZGVsZXRlKHNlbGYsIGtleSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoa2V5KQoKICAgIGRlZiBhZGRfdG9fY3ZfbGlzdCgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgZWxlbWVudDogVW5pb25bc3RyLCBkaWN0XSwKICAgICAgICAgICAgY3ZfbGlzdDogTGl0ZXJhbFsnZ3JlZW5fbGlzdCcsICd5ZWxsb3dfbGlzdCcsICdyZWRfbGlzdCcsICdncmF5X2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdibHVlX2xpc3QnLCAnaGlkZGVuX2xpc3QnLCAnb2JqZWN0X2luZm9fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3N0b3BfbGlzdGVuZXJfbGlzdCcsICdvYmplY3RfY2FwdGlvbl9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2JqZWN0X2RldGVjdG9yX21vZGUnXSwKICAgICAgICAgICAgX2RpY3Q6IGJvb2wgPSBGYWxzZQogICAgKSAtPiBOb25lOgogICAgICAgICIiIiDQlNC+0LHQsNCy0LvRj9C10YIg0LIgY3Yt0YHQv9C40YHQvtC6INGN0LvQtdC80LXQvdGCLCDQuNC70Lgg0YHQvtC30LTQsNC10YIg0L3QvtCy0YvQuSDRgdC/0LjRgdC+0Log0YEg0Y3RgtC40Lwg0Y3Qu9C10LzQtdC90YLQvtC8LgogICAgICAgICAgICBvYmplY3RfaW5mb19saXN0IC0g0JjQvdGE0L7RgNC80LDRhtC40Y8g0L7QsSDQvtCx0YrQtdC60YLQtSAo0YHQvdC40LfRgykuIFt7J29iamVjdCc6IG9iamVjdF9pZDogc3RyLCAnaW5mbyc6IHZhbHVlfV0KICAgICAgICAgICAgb2JqZWN0X2RldGVjdG9yX21vZGUgLSDQoNC10LbQuNC8INC00LXRgtC10LrRgtC+0YDQsC4gW3snb2JqZWN0X2lkJzogb2JqZWN0X2lkOiBpbnQsICdtb2RlJzogYmFyY29kZXxvY3J8c3RvcH1dCiAgICAgICAgICAgIG9iamVjdF9jYXB0aW9uX2xpc3QgLSDQmNC90YTQvtGA0LzQsNGG0LjRjyDQvtCxINC+0LHRitC10LrRgtC1ICjRgdCy0LXRgNGF0YMpLiBbeydvYmplY3QnOiBvYmplY3RfaWQ6IHN0ciwgJ2NhcHRpb24nOiB2YWx1ZX1dCiAgICAgICAgICAgIHN0b3BfbGlzdGVuZXJfbGlzdCAtINCR0LvQvtC60LjRgNGD0LXRgiDQstGL0L/QvtC70L3QuNC1INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QsiDQtNC70Y8g0L7QsdGK0LXQutGC0L7QsiDQsiDRgdC/0LjRgdC60LUKICAgICAgICAiIiIKCiAgICAgICAgaWYgX2RpY3Q6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QsIGZyb21fanNvbj1UcnVlKSBvciBbXQogICAgICAgICAgICBpZiBlbGVtZW50IG5vdCBpbiBsc3Q6CiAgICAgICAgICAgICAgICBsc3QuYXBwZW5kKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLnB1dChjdl9saXN0LCBqc29uLmR1bXBzKGxzdCwgZW5zdXJlX2FzY2lpPUZhbHNlKSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbHN0ID0gc2VsZi5nZXQoY3ZfbGlzdCkKICAgICAgICAgICAgbHN0ID0gbHN0LnNwbGl0KCc7JykgaWYgbHN0IGVsc2UgW10KICAgICAgICAgICAgaWYgZWxlbWVudCBub3QgaW4gbHN0OgogICAgICAgICAgICAgICAgbHN0LmFwcGVuZChlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwgJzsnLmpvaW4obHN0KSkKCiAgICBkZWYgcmVtb3ZlX2Zyb21fY3ZfbGlzdCgKICAgICAgICBzZWxmLAogICAgICAgIGVsZW1lbnQ6IFVuaW9uW3N0ciwgZGljdF0sCiAgICAgICAgY3ZfbGlzdDogTGl0ZXJhbFsnZ3JlZW5fbGlzdCcsICd5ZWxsb3dfbGlzdCcsICdyZWRfbGlzdCcsICdncmF5X2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ2JsdWVfbGlzdCcsICdoaWRkZW5fbGlzdCcsICdvYmplY3RfaW5mb19saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICdzdG9wX2xpc3RlbmVyX2xpc3QnLCAnb2JqZWN0X2NhcHRpb25fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAnb2JqZWN0X2RldGVjdG9yX21vZGUnXSwKICAgICAgICBfZGljdDogYm9vbCA9IEZhbHNlCiAgICApOgogICAgICAgICIiItCj0LTQsNC70Y/QtdGCINC40LcgY3Yt0YHQv9C40YHQutCwIiIiCiAgICAgICAgaWYgX2RpY3Q6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QsIGZyb21fanNvbj1UcnVlKSBvciBbXQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBsc3QucmVtb3ZlKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLnB1dChjdl9saXN0LCBqc29uLmR1bXBzKGxzdCwgZW5zdXJlX2FzY2lpPUZhbHNlKSkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbHN0ID0gc2VsZi5nZXQoY3ZfbGlzdCkKICAgICAgICAgICAgbHN0ID0gbHN0LnNwbGl0KCc7JykgaWYgbHN0IGVsc2UgW10KICAgICAgICAgICAgaWYgZWxlbWVudCBpbiBsc3Q6CiAgICAgICAgICAgICAgICBsc3QucmVtb3ZlKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLnB1dChjdl9saXN0LCAnOycuam9pbihsc3QpKQoKICAgIGRlZiBzZXRfdmlzaW9uX3NldHRpbmdzKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICB2YWx1ZXNfbGlzdDogc3RyLAogICAgICAgICAgICB0eXBlX3JlYzogc3RyID0gJ1RleHQnLAogICAgICAgICAgICBOdW1iZXJSZWNvZ25pdGlvbjogYm9vbCA9IEZhbHNlLAogICAgICAgICAgICBEYXRlUmVjb2duaXRpb246IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgUGxhdGVOdW1iZXJSZWNvZ25pdGlvbjogYm9vbCA9IEZhbHNlLAogICAgICAgICAgICBtaW5fbGVuZ3RoOiBpbnQgPSAxLAogICAgICAgICAgICBtYXhfbGVuZ3RoOiBpbnQgPSAyMCwKICAgICAgICAgICAgcmVzdWx0X3Zhcjogc3RyID0gJ29jcl9yZXN1bHQnLAogICAgICAgICAgICBtZXN1cmVfcXR5OiBpbnQgPSAxLAogICAgICAgICAgICBtaW5fZnJlcTogaW50ID0gMSwKICAgICAgICAgICAgcXVlcnk6IHN0ciA9ICcnLAogICAgICAgICAgICBjb250cm9sX2ZpZWxkOiBzdHIgPSAnJywKICAgICAgICAgICAgY3Vyc29yOiBPcHRpb25hbFtsaXN0XSA9IE5vbmUsCiAgICAgICAgICAgIGNvdW50X29iamVjdHM6IGludCA9IDAsCiAgICAgICAgICAgIFJlcGxhY2VPOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgIFRvVXBjYXNlOiBib29sID0gRmFsc2UsCiAgICApOgogICAgICAgICIiInF1ZXJ5IC0gU1FMINC30LDQv9GA0L7RgSDQtNC70Y8g0LLQsNGA0LjQsNC90YLQsCDQv9C+0LjRgdC60LAg0L/QviBTUUwt0YLQsNCx0LvQuNGG0LUg0YEg0L7QtNC40L3QvCDQv9Cw0YDQsNC80LXRgtGA0L7QvCjQsiDQutC+0YLQvtGA0YvQuSDQv9C10YDQtdC00LDQtdGC0YHRjyDRgNCw0YHQv9C+0LfQvdCw0L3QvdGL0Lkg0YLQtdC60YHRgiApCiAgICAgICAgICAgICAgICDQndCw0L/RgNC40LzQtdGAOiBzZWxlY3QgKiBmcm9tIFNXX0dvb2RzIHdoZXJlIHByb2R1Y3RfbnVtYmVyIGxpa2UgID8KICAgICAgICAgICBjb250cm9sX2ZpZWxkIC0g0L/QvtC70LUg0YLQsNCx0LvQuNGG0Ysg0L/QviDQutC+0YLQvtGA0L7QvNGDINC/0YDQvtCy0LXRgNGP0LXRgtGB0Y8gT0NSICwg0YPRgdC70L7QstC90L4g0JDRgNGC0LjQutGD0LsgKNC90LXRgdC80L7RgtGA0Y8g0L3QsCDRgtC+LCDRh9GC0L4g0LIgcXVlcnkg0L7QvdC+INGB0LrQvtGA0LXQtSDQstGB0LXQs9C+INGC0LDQutC20LUg0YPRh9Cw0YHRgtCy0YPQtdGCKQogICAgICAgICAgIGN1cnNvciAtINCc0LDRgdGB0LjQsiAg0YEg0L7QsdGK0LXQutGC0LDQvNC4IHsiZmllbGQiOjzQv9C+0LvQtSDRgtCw0LHQu9C40YbRiz4sInZhciI6PNC/0LXRgNC10LzQtdC90L3QsNGPINGA0LXQt9GD0LvRjNGC0LDRgj59CiAgICAgICAgICAgdmFsdWVzX2xpc3QgLSDQoNC10LbQuNC8INC/0L7QuNGB0LrQsCDQv9C+INGB0L/QuNGB0LrRgywg0LvQuNCx0L4g0L7QsdGA0LDQsdC+0YLRh9C40LrQvtC8ICgifiIpCiAgICAgICAgICAgbWVzdXJlX3F0eSAtINCa0L7Qu9C40YfQtdGB0YLQstC+INC40LfQvNC10YDQtdC90LjQuSDQv9C70L7RgtC90L7RgdGC0Lgg0LLQtdGA0L7Rj9GC0L3QvtGB0YLQuCAo0L3QvtGA0LwuINGA0LDRgdC/0YDQtdC00LXQu9C10L3QuNC1KQogICAgICAgICAgIG1pbl9mcmVxIC0g0JLQtdGA0L7Rj9GC0L3QvtGB0YLRjCAo0LIg0L/RgNC+0YbQtdC90YLQsNGFINC+0YIgMCDQtNC+IDEwMCDQtNC70Y8g0YPQtNC+0LHRgdGC0LLQsCDQstCy0L7QtNCwKQogICAgICAgICAgIG1pbl9sZW5ndGggLSDQnNC40L3QuNC80LDQu9GM0L3QsNGPINC00LvQuNC90LAg0YLQtdC60YHRgtCwCiAgICAgICAgICAgbWF4X2xlbmd0aCAtINCc0LDQutGB0LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINGC0LXQutGB0YLQsAogICAgICAgICAgIGNvdW50X29iamVjdHMgLSDQlNC70Y8gTnVtYmVyUmVjb2duaXRpb24g0LrQvtC70LjRh9C10YHRgtCy0L4g0YbQuNC60LvQvtCyINC40LfQvNC10YDQtdC90LjQuSDQtNC70Y8g0YDQtdGI0LXQvdC40Y8g0LrQvtC80LHQuNC90LDRgtC+0YDQvdC+0Lkg0LfQsNC00LDRh9C4LiDQp9C10Lwg0LHQvtC70YzRiNC1INGG0LjQutC70L7QsiDRgtC10Lwg0LHQvtC70YzRiNC1INGC0L7Rh9C90L7RgdGC0YwKICAgICAgICAgICBSZXBsYWNlTyAtINCX0LDQvNC10L3QuNGC0Ywg0LHRg9C60LLRiyDQniDQvdCwIDAgKNC90YPQu9C4KQogICAgICAgICAgIFRvVXBjYXNlIC0g0J/RgNC10L7QsdGA0LDQt9C+0LLQsNC90LjQtSDQsiDQstC10YDRhdC90LjQuSDRgNC10LPQuNGB0YLRgAogICAgICAgICAgIFBsYXRlTnVtYmVyUmVjb2duaXRpb24gLSDQoNC+0YHRgdC40LnRgdC60LjQtSDQvdC+0LzQtdGA0LAgKNGC0L7Qu9GM0LrQviDQtNC70Y8gQWN0aXZlQ1YpCiAgICAgICAgICAgTnVtYmVyUmVjb2duaXRpb24gLSDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDRh9C40YHQtdC7CiAgICAgICAgICAgRGF0ZVJlY29nbml0aW9uIC0g0KDQsNGB0L/QvtC30L3QsNCy0L3QuNC1INC00LDRggogICAgICAgICAgIHJlc3VsdF9maWVsZCAg0LTQu9GPINGA0LDRgdC/0L7Qt9C90LLQsNC90LjRjyDQtNCw0YIg0Lgg0L3QvtC80LXRgNC+0LIsINGC0YPQtNCwINC/0L7QvNC10YnQsNC10YLRgdGPINGA0LXQt9GD0LvRjNGC0LDRgtGLINC+0YHQvtCx0YvQvCDQvtCx0YDQsNC30L7QvCAo0YHQvNC+0YLRgNGPINGH0YLQviDQuNGJ0LXQvCkiIiIKICAgICAgICBpZiBjdXJzb3IgaXMgTm9uZToKICAgICAgICAgICAgY3Vyc29yID0gW10KICAgICAgICBzZXR0aW5ncyA9IHsKICAgICAgICAgICAgIlR5cGVSZWNvZ25pdGlvbiI6IHR5cGVfcmVjLAogICAgICAgICAgICAiTnVtYmVyUmVjb2duaXRpb24iOiBOdW1iZXJSZWNvZ25pdGlvbiwKICAgICAgICAgICAgIkRhdGVSZWNvZ25pdGlvbiI6IERhdGVSZWNvZ25pdGlvbiwKICAgICAgICAgICAgIlBsYXRlTnVtYmVyUmVjb2duaXRpb24iOiBQbGF0ZU51bWJlclJlY29nbml0aW9uLAogICAgICAgICAgICAibWluX2xlbmd0aCI6IG1pbl9sZW5ndGgsCiAgICAgICAgICAgICJtYXhfbGVuZ3RoIjogbWF4X2xlbmd0aCwKICAgICAgICAgICAgInZhbHVlc19saXN0IjogdmFsdWVzX2xpc3QsCiAgICAgICAgICAgICJyZXN1bHRfdmFyIjogcmVzdWx0X3ZhciwKICAgICAgICAgICAgIm1lc3VyZV9xdHkiOiBtZXN1cmVfcXR5LAogICAgICAgICAgICAibWluX2ZyZXEiOiBtaW5fZnJlcSwKICAgICAgICAgICAgInF1ZXJ5IjogcXVlcnksCiAgICAgICAgICAgICJjb250cm9sX2ZpZWxkIjogY29udHJvbF9maWVsZCwKICAgICAgICAgICAgImN1cnNvciI6IGN1cnNvciwKICAgICAgICAgICAgImNvdW50X29iamVjdHMiOiBjb3VudF9vYmplY3RzLAogICAgICAgICAgICAiUmVwbGFjZU8iOiBSZXBsYWNlTywKICAgICAgICAgICAgIlRvVXBjYXNlIjogVG9VcGNhc2UKICAgICAgICB9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNldFZpc2lvblNldHRpbmdzIiwganNvbi5kdW1wcyhzZXR0aW5ncykpCgogICAgZGVmIHNob3dfc2NyZWVuKHNlbGYsIG5hbWUsIGRhdGE9Tm9uZSk6CiAgICAgICAgc2VsZi5wdXQoJ1Nob3dTY3JlZW4nLCBuYW1lKQogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgIHNlbGYucHV0X2RhdGEoZGF0YSkKCiAgICBkZWYgc2hvd19wcm9jZXNzX3Jlc3VsdChzZWxmLCBwcm9jZXNzLCBzY3JlZW4sIGRhdGE6IGRpY3QgPSBOb25lKToKICAgICAgICBpZiBwcm9jZXNzIGFuZCBzY3JlZW46CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsIGYne3Byb2Nlc3N9fHtzY3JlZW59JykKCiAgICAgICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgICAgICBzZWxmLnB1dF9kYXRhKGRhdGEpCgogICAgZGVmIHN3aXRjaF9wcm9jZXNzX3NjcmVlbihzZWxmLCBwcm9jZXNzOiBzdHIsIHNjcmVlbjogT3B0aW9uYWxbc3RyXSA9IE5vbmUpOgogICAgICAgIHByb2Nlc3Nfc2NyZWVuID0gZid7cHJvY2Vzc318e3NjcmVlbn0nIGlmIHNjcmVlbiBlbHNlIHByb2Nlc3MKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU3dpdGNoUHJvY2Vzc1NjcmVlbicsIHByb2Nlc3Nfc2NyZWVuKQoKICAgIGRlZiBzaG93X2RpYWxvZyhzZWxmLCBsaXN0ZW5lciwgdGl0bGU9JycsIGJ1dHRvbnM9Tm9uZSwgZGlhbG9nX2xheW91dD1Ob25lKToKICAgICAgICBzZWxmLnB1dCgiU2hvd0RpYWxvZyIsIGxpc3RlbmVyKQogICAgICAgIAogICAgICAgIGlmIGRpYWxvZ19sYXlvdXQ6CiAgICAgICAgICAgIHNlbGYucHV0KCdTaG93RGlhbG9nTGF5b3V0JywgZGlhbG9nX2xheW91dCkKCiAgICAgICAgaWYgdGl0bGUgb3IgYnV0dG9uczoKICAgICAgICAgICAgZGlhbG9nX3N0eWxlID0gewogICAgICAgICAgICAgICAgJ3RpdGxlJzogdGl0bGUgb3IgbGlzdGVuZXIsCiAgICAgICAgICAgICAgICAneWVzJzogJ9Ce0LonLAogICAgICAgICAgICAgICAgJ25vJzogJ9Ce0YLQvNC10L3QsCcKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiBidXR0b25zIGFuZCBsZW4oYnV0dG9ucykgPiAxOgogICAgICAgICAgICAgICAgZGlhbG9nX3N0eWxlWyd5ZXMnXSA9IGJ1dHRvbnNbMF0KICAgICAgICAgICAgICAgIGRpYWxvZ19zdHlsZVsnbm8nXSA9IGJ1dHRvbnNbMV0KCiAgICAgICAgICAgIHNlbGYucHV0KCdTaG93RGlhbG9nU3R5bGUnLCBkaWFsb2dfc3R5bGUpCgogICAgZGVmIGdldF9jdXJyZW50X3NjcmVlbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZlsnY3VycmVudF9zY3JlZW5fbmFtZSddIGlmIHNlbGYuY29udGFpbnNLZXkoJ2N1cnJlbnRfc2NyZWVuX25hbWUnKSBlbHNlICcnCgogICAgZGVmIGdldF9wYXJlbnRfc2NyZWVuKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmWydwYXJlbnRfc2NyZWVuJ10gaWYgc2VsZi5jb250YWluc0tleSgncGFyZW50X3NjcmVlbicpIGVsc2UgJycKCiAgICBkZWYgZ2V0X2N1cnJlbnRfcHJvY2VzcyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZlsnY3VycmVudF9wcm9jZXNzX25hbWUnXQoKICAgIGRlZiBzZXRfdGl0bGUoc2VsZiwgdGl0bGUpOgogICAgICAgIHNlbGZbJ1NldFRpdGxlJ10gPSB0aXRsZQoKICAgIGRlZiBydW5fcHlfdGhyZWFkX3Byb2dyZXNzKHNlbGYsIGhhbmRsZXJzX25hbWU6IHN0cik6CiAgICAgICAgIiIiCiAgICAgICAg0JfQsNC/0YPRgdC60LDQtdGCINCw0YHQuNC90YXRgNC+0L3QvdC+0LUg0YTQvtC90L7QstC+0LUg0LLRi9C/0L7Qu9C90LXQvdC40LUg0YHQutGA0LjQv9GC0LAgYyDQsdC70L7QutC40YDRg9GO0YnQuNC8INC/0YDQvtCz0YDQtdGB0YEt0LHQsNGA0L7QvCwg0LrQvtGC0L7RgNGL0Lkg0LHQu9C+0LrQuNGA0YPQtdGCIFVJLdC/0L7RgtC+0LouCiAgICAgICAg0JIg0LrQsNGH0LXRgdGC0LLQtSDQsNGA0LPRg9C80LXQvdGC0LAgLSDQuNC80Y8g0YTRg9C90LrRhtC40Lgt0YXQtdC90LTQu9C10YDQsC4KICAgICAgICAiIiIKCiAgICAgICAgc2VsZlsnUnVuUHlUaHJlYWRQcm9ncmVzc0RlZiddID0gaGFuZGxlcnNfbmFtZQoKICAgIGRlZiBzcWxfZXhlYyhzZWxmLCBxdWVyeSwgcGFyYW1zPScnKToKICAgICAgICBzZWxmLl9wdXRfc3FsKCdTUUxFeGVjJywgcXVlcnksIHBhcmFtcykKCiAgICBkZWYgc3FsX2V4ZWNfbWFueShzZWxmLCBxdWVyeSwgcGFyYW1zPU5vbmUpOgogICAgICAgIHBhcmFtcyA9IHBhcmFtcyBvciBbXQogICAgICAgIHNlbGYuX3B1dF9zcWwoJ1NRTEV4ZWNNYW55JywgcXVlcnksIHBhcmFtcykKCiAgICBkZWYgc3FsX3F1ZXJ5KHNlbGYsIHF1ZXJ5LCBwYXJhbXM9JycpOgogICAgICAgIHNlbGYuX3B1dF9zcWwoJ1NRTFF1ZXJ5JywgcXVlcnksIHBhcmFtcykKCiAgICBkZWYgX3B1dF9zcWwoc2VsZiwgc3FsX3R5cGUsIHF1ZXJ5LCBwYXJhbXMpOgogICAgICAgIHNlbGYucHV0KAogICAgICAgICAgICBzcWxfdHlwZSwKICAgICAgICAgICAgeyJxdWVyeSI6IHF1ZXJ5LCAncGFyYW1zJzogcGFyYW1zfSwKICAgICAgICAgICAgdG9fanNvbj1UcnVlCiAgICAgICAgKQoKICAgIGRlZiBiYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmWydCYWNrU2NyZWVuJ10gPSAnJwoKICAgIGRlZiBub19yZWZyZXNoKHNlbGYpOgogICAgICAgIHNlbGZbJ05vUmVmcmVzaCddID0gJycKCiAgICBkZWYgc3RhcnRfdGltZXJzKHNlbGYsICpoYW5kbGVycywgcGVyaW9kPU5vbmUsIGJzX2hhc2hfbWFwOiBib29sPUZhbHNlKToKICAgICAgICAiIiIKICAgICAgICDQl9Cw0L/Rg9GB0LrQsNC10YIg0YTQvtC90L7QstGL0Lkg0YHQtdGA0LLQuNGBINC00LvRjyDQt9Cw0L/Rg9GB0LrQsCDQv9C10YDQuNC+0LTQuNGH0LXRgdC60L7Qs9C+INCy0YvQv9C+0LvQvdC10L3QuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60LAKICAgICAgICA6cGFyYW0gaGFuZGxlcnM6INC+0LHRgNCw0LHQvtGC0YfQuNC60LgKICAgICAgICA6cGFyYW0gcGVyaW9kOiDQv9C10YDQuNC+0LQg0LfQsNC/0YPRgdC60LAg0LIg0LzQuNC70LvQuNGB0LXQutGD0L3QtNCw0YUKICAgICAgICA6cGFyYW0gYnNfaGFzaF9tYXA6INC/0YDQuNC30L3QsNC6INC40YHQv9C+0LvRjNC30L7QstCw0L3QuNGPIGhhc2hfbWFwINGE0L7QvdC+0LLQvtCz0L4g0YHQtdGA0LLQuNGB0LAsINC40L3QsNGH0LUg0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGPIGhhc2hfbWFwINC/0YDQvtGG0LXRgdGB0L7QsgogICAgICAgIDpyZXR1cm46IE5vbmUKICAgICAgICAiIiIKCiAgICAgICAgc3RhcnRfY29tbWFuZCA9ICdTdGFydFRpbWVyc0JTJyBpZiBic19oYXNoX21hcCBlbHNlICdTdGFydFRpbWVycycKICAgICAgICBzZWxmLnB1dChzdGFydF9jb21tYW5kKQogICAgICAgIHNlbGYuYWRkX3RpbWVycygqaGFuZGxlcnMsIHBlcmlvZD1wZXJpb2QsIGJzX2hhc2hfbWFwPWJzX2hhc2hfbWFwKQoKICAgIGRlZiBhZGRfdGltZXJzKHNlbGYsICpoYW5kbGVycywgcGVyaW9kPTEwMDAwLCBic19oYXNoX21hcDogYm9vbD1GYWxzZSk6CiAgICAgICAgIiIiCiAgICAgICAg0JTQvtCx0LDQstC70Y/QtdGCINC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0LIg0YTQvtC90L7QstGL0Lkg0YHQtdGA0LLQuNGBCiAgICAgICAgOnBhcmFtIGhhbmRsZXJzOiDQvtCx0YDQsNCx0L7RgtGH0LjQutC4CiAgICAgICAgOnBhcmFtIHBlcmlvZDog0L/QtdGA0LjQvtC0INC30LDQv9GD0YHQutCwINCyINC80LjQu9C70LjRgdC10LrRg9C90LTQsNGFCiAgICAgICAgOnBhcmFtIGJzX2hhc2hfbWFwOiDQv9GA0LjQt9C90LDQuiDQuNGB0L/QvtC70YzQt9C+0LLQsNC90LjRjyBoYXNoX21hcCDRhNC+0L3QvtCy0L7Qs9C+INGB0LXRgNCy0LjRgdCwLCDQuNC90LDRh9C1INC40YHQv9C+0LvRjNC30YPQtdGC0YHRjyBoYXNoX21hcCDQv9GA0L7RhtC10YHRgdC+0LIKICAgICAgICA6cmV0dXJuOiBOb25lCiAgICAgICAgIiIiCgogICAgICAgIHN0YXJ0X2NvbW1hbmQgPSAnU3RhcnRUaW1lckJTJyBpZiBic19oYXNoX21hcCBlbHNlICdTdGFydFRpbWVyJwogICAgICAgIHRpbWVycyA9IFtzZWxmLl9nZXRfZXZlbnQoaGFuZGxlcl9uYW1lKVswXSBmb3IgaGFuZGxlcl9uYW1lIGluIGhhbmRsZXJzXQoKICAgICAgICBpZiB0aW1lcnM6CiAgICAgICAgICAgIHNlbGYucHV0KHN0YXJ0X2NvbW1hbmQseyJoYW5kbGVyIjogdGltZXJzLCAicGVyaW9kIjogcGVyaW9kfSwgdG9fanNvbj1UcnVlKQoKCiAgICBkZWYgc3RvcF90aW1lcnMoc2VsZiwgYnNfaGFzaF9tYXA6IGJvb2w9RmFsc2UpOgogICAgICAgICIiIgogICAgICAgINCe0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGCINCy0YvQv9C+0LvQvdC10L3QuNC1INGC0LDQudC80LXRgNC+0LIKICAgICAgICA6cGFyYW0gYnNfaGFzaF9tYXA6INC/0YDQuNC30L3QsNC6INC40YHQv9C+0LvRjNC30L7QstCw0L3QuNGPIGhhc2hfbWFwINGE0L7QvdC+0LLQvtCz0L4g0YHQtdGA0LLQuNGB0LAsINC40L3QsNGH0LUg0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGPIGhhc2hfbWFwINC/0YDQvtGG0LXRgdGB0L7QsgogICAgICAgIDpyZXR1cm46CiAgICAgICAgIiIiCgogICAgICAgIHN0b3BfY29tbWFuZCA9ICdTdG9wVGltZXJzQlMnIGlmIGJzX2hhc2hfbWFwIGVsc2UgJ1N0b3BUaW1lcnMnCiAgICAgICAgc2VsZi5wdXQoc3RvcF9jb21tYW5kKQoKCmNsYXNzIEJhcmNvZGVQYXJzZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgYmFyY29kZSk6CiAgICAgICAgc2VsZi5iYXJjb2RlID0gYmFyY29kZQogICAgICAgIHNlbGYuYmFyY29kZV9pbmZvID0gQmFyY29kZVBhcnNlci5CYXJjb2RlSW5mbyhiYXJjb2RlPWJhcmNvZGUpCiAgICAgICAgc2VsZi5tYWNyb18wNSA9IGYnWyk+e2NocigzMCl9MDUnCiAgICAgICAgc2VsZi5tYWNyb18wNiA9IGYnWyk+e2NocigzMCl9MDYnCiAgICAgICAgc2VsZi5nczFfc2VwYXJhdG9yID0gY2hyKDI5KQogICAgICAgIHNlbGYuaWRlbnRpZmllciA9ICddZDInCgogICAgZGVmIHBhcnNlKHNlbGYsIGFzX2RpY3Q9VHJ1ZSk6CiAgICAgICAgaWYgc2VsZi5pc192YWxpZF9lYW4xMyhzZWxmLmJhcmNvZGUpOgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPSAnRUFOMTMnCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBzZWxmLmJhcmNvZGUKCiAgICAgICAgZWxpZiBsZW4oc2VsZi5iYXJjb2RlKSA9PSAyOToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2NoZW1lID0gJ0dTMScKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IHNlbGYuYmFyY29kZVswOjE0XQogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zZXJpYWwgPSBzZWxmLmJhcmNvZGVbMTQ6MjFdCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLm1yYyA9IHNlbGYuYmFyY29kZVsyMToyNV0KICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uY2hlY2sgPSBzZWxmLmJhcmNvZGVbMjU6MjldCgogICAgICAgIGVsaWYgc2VsZi5nczFfc2VwYXJhdG9yIGluIHNlbGYuYmFyY29kZSBvciAnPEdTPicgaW4gc2VsZi5iYXJjb2RlOgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPSAnR1MxJwogICAgICAgICAgICBzZWxmLmNoZWNrX2RhdGFtYXRyaXgoc2VsZi5iYXJjb2RlKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPSAnVU5LTk9XTicKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IHNlbGYuYmFyY29kZQoKICAgICAgICBpZiBhc19kaWN0OgogICAgICAgICAgICByZXR1cm4gc2VsZi5iYXJjb2RlX2luZm8uZGljdCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuYmFyY29kZV9pbmZvCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGlzX3ZhbGlkX2VhbjEzKGNvZGUpOgogICAgICAgIHBhdHRlcm4gPSByJ15cZHsxM30kJwogICAgICAgIGlmIG5vdCByZS5tYXRjaChwYXR0ZXJuLCBjb2RlKToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIGZhY3RvcnMgPSBbMSwgM10gKiA2CiAgICAgICAgY2hlY2tzdW0gPSBzdW0oaW50KGNvZGVbaV0pICogZmFjdG9yc1tpXSBmb3IgaSBpbiByYW5nZSgxMikpCiAgICAgICAgY2hlY2tzdW0gPSAoMTAgLSAoY2hlY2tzdW0gJSAxMCkpICUgMTAKCiAgICAgICAgcmV0dXJuIGNoZWNrc3VtID09IGludChjb2RlWy0xXSkKCiAgICBkZWYgY2hlY2tfZGF0YW1hdHJpeChzZWxmLCBiYXJjb2RlKToKICAgICAgICBiYXJjb2RlID0gc2VsZi5jbGVhcl9pZGVudGlmaWVyKGJhcmNvZGUpCiAgICAgICAgc2VsZi5jaGVja19nczFfZ3RpbihiYXJjb2RlKQoKICAgIGRlZiBjaGVja19nczFfZ3RpbihzZWxmLCBiYXJjb2RlOiBzdHIpOgogICAgICAgIGlmIHNlbGYuZ3MxX3NlcGFyYXRvciBpbiBiYXJjb2RlOgogICAgICAgICAgICB3aGlsZSBiYXJjb2RlOgogICAgICAgICAgICAgICAgaWYgYmFyY29kZVs6Ml0gPT0gJzAxJzoKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gYmFyY29kZVsyOjE2XQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDE2OgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxNjpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjNdID09IGNocigyOSkgKyAnMDEnOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBiYXJjb2RlWzM6MTddCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gMTc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzE3Ol0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzE3JzoKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5leHBpcnkgPSBiYXJjb2RlWzI6OF0KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYmFyY29kZSkgPiA4OgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVs4Ol0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzEwJzoKICAgICAgICAgICAgICAgICAgICBpZiBjaHIoMjkpIGluIGJhcmNvZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5iYXRjaCA9IGJhcmNvZGVbMjppbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbaW5kZXggKyAxOl0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5iYXRjaCA9IGJhcmNvZGVbMjpdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMjEnOgogICAgICAgICAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbCA9IGJhcmNvZGVbMjppbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbaW5kZXggKyAxOl0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zZXJpYWwgPSBiYXJjb2RlWzI6XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzkxJzoKICAgICAgICAgICAgICAgICAgICBpZiBjaHIoMjkpIGluIGJhcmNvZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQoKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubmhybiA9IGJhcmNvZGVbMjppbmRleF0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbaW5kZXggKyAxOl0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5uaHJuID0gYmFyY29kZVsyOjZdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTMnOiAgIyDQnNC+0LvQvtGH0LrQsCwg0LLQvtC00LAKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5jaGVjayA9IGJhcmNvZGVbMjo2XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzc6XQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzkyJzogICMg0JTQsNC70LXQtSDRgdC70LXQtNGD0LXRgiDQutC+0LQg0L/RgNC+0LLQtdGA0LrQuCwgNDQg0YHQuNC80LLQvtC70LAKICAgICAgICAgICAgICAgICAgICAjIGlmIGxlbihiYXJjb2RlWzI6XSk9PTQ0OgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmNoZWNrID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6NF0gPT0gJzgwMDUnOiAgIyDQotCw0LHQsNC6LCDQkdC70L7QugogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLm5ocm4gPSBiYXJjb2RlWzQ6MTBdCiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTE6XQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6NF0gPT0gJzMxMDMnOiAgIyDQnNC+0LvQvtGH0LrQsCDRgSDQktC10YHQvtC8CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ud2VpZ2h0ID0gYmFyY29kZVs0Ol0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZXJyb3IgPSAnSU5WQUxJRCBCQVJDT0RFJwogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmVycm9yID0gJ05vIEdTIFNlcGFyYXRvcicKCiAgICAgICAgIyBpZiAoJ0dUSU4nICwgJ0JBVENIJyAsICdFWFBJUlknICwgJ1NFUklBTCcpIGluIHJlc3VsdC5rZXlzKCk6CiAgICAgICAgIyAgICAgaWYgZ3Rpbl9jaGVjayhyZXN1bHRbJ0dUSU4nXSkgPT0gRmFsc2UgYW5kIGV4cGlyeV9kYXRlX2NoZWNrKHJlc3VsdFsnRVhQSVJZJ10pID09IEZhbHNlOgogICAgICAgICMgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIEdUSU4gJiBFWFBJUlkgREFURScsICdCQVJDT0RFJzogcmVzdWx0fQogICAgICAgICMgICAgIGVsaWYgZXhwaXJ5X2RhdGVfY2hlY2socmVzdWx0WydFWFBJUlknXSkgPT0gRmFsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgRVhQSVJZIERBVEUnLCAnQkFSQ09ERSc6IHJlc3VsdH0KICAgICAgICAjICAgICBlbGlmIGd0aW5fY2hlY2socmVzdWx0WydHVElOJ10pID09IEZhbHNlOgogICAgICAgICMgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIEdUSU4nLCAnQkFSQ09ERSc6IHJlc3VsdH0KICAgICAgICAjICAgICBlbHNlOgogICAgICAgICMgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgIyBlbHNlOgogICAgICAgICMgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOQ09NUExFVEUgREFUQScsICdCQVJDT0RFJzogcmVzdWx0fQoKICAgIGRlZiBjbGVhcl9pZGVudGlmaWVyKHNlbGYsIGJhcmNvZGUpOgogICAgICAgICIiIgogICAgICAgIE1vc3QgYmFyY29kZSBzY2FubmVycyBwcmVwZW5kICddZDInIGlkZW50aWZpZXIgZm9yIHRoZSBHUzEgZGF0YW1hdHJpeC4KICAgICAgICBUaGlzIHNlY3Rpb24gcmVtb3ZlcyB0aGUgaWRlbnRpZmllci4KICAgICAgICAiIiIKCiAgICAgICAgaWYgYmFyY29kZVs6M10gPT0gc2VsZi5pZGVudGlmaWVyOgogICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVszOl0KCiAgICAgICAgcmV0dXJuIGJhcmNvZGUKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBCYXJjb2RlSW5mbzoKICAgICAgICBiYXJjb2RlOiBzdHIgPSAnJwogICAgICAgIHNjaGVtZTogc3RyID0gJycKICAgICAgICBzZXJpYWw6IHN0ciA9ICcnCiAgICAgICAgZ3Rpbjogc3RyID0gJycKICAgICAgICBlcnJvcjogc3RyID0gJycKICAgICAgICBtcmM6IHN0ciA9ICcnCiAgICAgICAgY2hlY2s6IHN0ciA9ICcnCiAgICAgICAgZnVsbF9jb2RlOiBzdHIgPSAnJwogICAgICAgIGV4cGlyeTogc3RyID0gJycKICAgICAgICBiYXRjaDogc3RyID0gJycKICAgICAgICBuaHJuOiBzdHIgPSAnJwogICAgICAgIHdlaWdodDogc3RyID0gJycKCiAgICAgICAgZGVmIGRpY3Qoc2VsZik6CiAgICAgICAgICAgIHJldHVybiB7ay51cHBlcigpOiBzdHIodikgZm9yIGssIHYgaW4gYXNkaWN0KHNlbGYpLml0ZW1zKCkgaWYgdn0KCgpjbGFzcyBEYXRlRm9ybWF0OgoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfbm93X25vc3FsX2Zvcm1hdCgpIC0+IHN0cjoKICAgICAgICB1dGNfZGF0ZSA9IGRhdGV0aW1lLnV0Y25vdygpCiAgICAgICAgcmV0dXJuIHV0Y19kYXRlLnN0cmZ0aW1lKCIlWS0lbS0lZCAlSDolTTolUyIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF90YWJsZV92aWV3X2Zvcm1hdChkYXRlOiBzdHIsIHVzZXJfdG16X29mZnNldD1Ob25lKSAtPiBzdHI6CiAgICAgICAgdXNlcl90bXpfb2Zmc2V0ID0gdXNlcl90bXpfb2Zmc2V0IG9yIHJzX3NldHRpbmdzLmdldCgndXNlcl90bXpfb2Zmc2V0JykKICAgICAgICB0aW1lem9uZV9vZmZzZXQgPSB0aW1lZGVsdGEoaG91cnM9aW50KHVzZXJfdG16X29mZnNldCkpCiAgICAgICAgZHRfZGF0ZSA9IGRhdGV0aW1lLnN0cnB0aW1lKGRhdGUsICIlWS0lbS0lZCAlSDolTTolUyIpCiAgICAgICAgcmV0dXJuIHN0cihkdF9kYXRlICsgdGltZXpvbmVfb2Zmc2V0KQoKCmRlZiBnZXRfaXBfYWRkcmVzcygpOgogICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgdHJ5OgogICAgICAgIHMuY29ubmVjdCgoIjguOC44LjgiLCA4MCkpCiAgICAgICAgaXBfYWRkcmVzcyA9IHMuZ2V0c29ja25hbWUoKVswXQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGlwX2FkZHJlc3MgPSBOb25lCiAgICBmaW5hbGx5OgogICAgICAgIHMuY2xvc2UoKQoKICAgIHJldHVybiBpcF9hZGRyZXNzCg=="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\widgets.py",
                "PyFileKey": "widgets",
                "PyFileData": "ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0CmltcG9ydCBqc29uCgp3cmFwX2NvbnRlbnQgPSAid3JhcF9jb250ZW50IgptYXRjaF9wYXJlbnQgPSAnbWF0Y2hfcGFyZW50JwoKCmNsYXNzIFdpZGdldChBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZTogc3RyCiAgICAgICAgc2VsZi5WYWx1ZTogc3RyCiAgICAgICAgc2VsZi53aWR0aCA9IHdyYXBfY29udGVudAogICAgICAgIHNlbGYuaGVpZ2h0ID0gd3JhcF9jb250ZW50CiAgICAgICAgc2VsZi53ZWlnaHQgPSAwCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4ga3dhcmdzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLl9fZGljdF9fW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidXaWRnZXQodHlwZT17c2VsZi50eXBlfSwgVmFsdWU9e3NlbGYuVmFsdWV9KScKCiAgICBkZWYgdG9fanNvbihzZWxmKToKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhzZWxmLCBkZWZhdWx0PWxhbWJkYSB4OiB2YXJzKHgpLCBpbmRlbnQ9NCkKCgpjbGFzcyBQaWN0dXJlKFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHBpYycKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQaWN0dXJlIgoKCmNsYXNzIFRleHRWaWV3KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHZhbHVlJwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gIlRleHRWaWV3IgoKCmNsYXNzIENoZWNrQm94KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gJ0NoZWNrQm94JwoKCmNsYXNzIFBvcHVwTWVudUJ1dHRvbihXaWRnZXQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICBzZWxmLlZhbHVlID0gJ0B2YWx1ZScKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQb3B1cE1lbnVCdXR0b24iCiAgICAgICAgc2VsZi5zaG93X2J5X2NvbmRpdGlvbiA9ICcnCiAgICAgICAgc2VsZi5Ob1JlZnJlc2ggPSBGYWxzZQogICAgICAgIHNlbGYuZG9jdW1lbnRfdHlwZSA9ICcnCiAgICAgICAgc2VsZi5tYXNrID0gJycKCgpjbGFzcyBMaW5lYXJMYXlvdXQoV2lkZ2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZSA9ICdMaW5lYXJMYXlvdXQnCiAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICJ2ZXJ0aWNhbCIKCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykKICAgICAgICBzZWxmLkVsZW1lbnRzID0gbGlzdChhcmdzKSBvciBbXQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgKndpZGdldHMpOgogICAgICAgIGZvciB3aWRnZXQgaW4gd2lkZ2V0czoKICAgICAgICAgICAgc2VsZi5FbGVtZW50cy5hcHBlbmQod2lkZ2V0KQoKCmNsYXNzIE9wdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2VhcmNoX2VuYWJsZWQ9VHJ1ZSwgc2F2ZV9wb3NpdGlvbj1UcnVlLCBvdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgICAgIHNlbGYub3B0aW9ucyA9IHsKICAgICAgICAgICAgJ3NlYXJjaF9lbmFibGVkJzogc2VhcmNoX2VuYWJsZWQsCiAgICAgICAgICAgICdzYXZlX3Bvc2l0aW9uJzogc2F2ZV9wb3NpdGlvbiwKICAgICAgICAgICAgJ292ZXJyaWRlX3NlYXJjaCc6IG92ZXJyaWRlX3NlYXJjaAogICAgICAgIH0KCgpjbGFzcyBDdXN0b21DYXJkczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgY2FyZHNkYXRhOiBMaXN0W2RpY3RdID0gW10pOgogICAgICAgIHNlbGYuY3VzdG9tY2FyZHMgPSB7CiAgICAgICAgICAgICdvcHRpb25zJzogb3B0aW9ucyBvciBPcHRpb25zKCksCiAgICAgICAgICAgICdsYXlvdXQnOiBsYXlvdXQsCiAgICAgICAgICAgICdjYXJkc2RhdGEnOiBjYXJkc2RhdGEKICAgICAgICB9CgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoc2VsZiwgZGVmYXVsdD1sYW1iZGEgeDogdmFycyh4KSwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkKCgpjbGFzcyBDdXN0b21UYWJsZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgdGFibGVkYXRhOiBMaXN0W2RpY3RdKToKICAgICAgICBzZWxmLmN1c3RvbXRhYmxlID0gewogICAgICAgICAgICAnb3B0aW9ucyc6IG9wdGlvbnMgb3IgT3B0aW9ucygpLAogICAgICAgICAgICAnbGF5b3V0JzogbGF5b3V0LAogICAgICAgICAgICAndGFibGVkYXRhJzogdGFibGVkYXRhCiAgICAgICAgfQoKICAgIGRlZiB0b19qc29uKHNlbGYpOgogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHNlbGYsIGRlZmF1bHQ9bGFtYmRhIHg6IHZhcnMoeCksIGluZGVudD00LCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpCgoKQGRhdGFjbGFzcwpjbGFzcyBNb2Rlcm5GaWVsZDoKICAgIGhpbnQ6IHN0ciA9ICcnCiAgICBkZWZhdWx0X3RleHQ6IHN0ciA9ICcnCiAgICBjb3VudGVyOiBib29sID0gRmFsc2UKICAgIGNvdW50ZXJfbWF4OiBpbnQgPSAwCiAgICBpbnB1dF90eXBlOiBpbnQgPSAwCiAgICBwYXNzd29yZDogYm9vbCA9IEZhbHNlCiAgICBldmVudHM6IGJvb2wgPSBGYWxzZQoKICAgICIiIgogICAgVFlQRV9OVUxMOiAwCiAgICAKICAgIFRZUEVfQ0xBU1NfTlVNQkVSOiAyCiAgICBUWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUw6IDgxOTIgCiAgICBUWVBFX05VTUJFUl9GTEFHX1NJR05FRDogNDA5NiAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9QQVNTV09SRDogMTYKICAgIAogICAgVFlQRV9DTEFTU19EQVRFVElNRSA6IDQKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX0RBVEU6IDE2CiAgICBUWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX1RJTUU6IDMyCiAgICAKICAgIFRZUEVfQ0xBU1NfUEhPTkU6IDMKICAgIAogICAgVFlQRV9NQVNLX0NMQVNTOiAxNQogICAgVFlQRV9NQVNLX0ZMQUdTOiAxNjc3MzEyMCAKICAgIFRZUEVfTUFTS19WQVJJQVRJT046IDQwODAgCgogICAgVFlQRV9DTEFTU19URVhUOiAxCiAgICBUWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFOiA2NTUzNiAKICAgIFRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDogMzI3NjggCiAgICBUWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUzogNDA5NiAKICAgIFRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM6IDE2Mzg0IAogICAgVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTOiA4MTkyICAKICAgIFRZUEVfVEVYVF9GTEFHX0VOQUJMRV9URVhUX0NPTlZFUlNJT05fU1VHR0VTVElPTlM6IDEwNDg1NzYgCiAgICBUWVBFX1RFWFRfRkxBR19JTUVfTVVMVElfTElORTogMjYyMTQ0IAogICAgVFlQRV9URVhUX0ZMQUdfTVVMVElfTElORTogMTMxMDcyIAogICAgVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM6IDUyNDI4OCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfQUREUkVTUzogMzIKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfU1VCSkVDVDogNDgKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRklMVEVSOiAxNzYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX0xPTkdfTUVTU0FHRTogODAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMOiAwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEOiAxMjggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BFUlNPTl9OQU1FOiAgOTYKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUEhPTkVUSUM6IDE5MiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUE9TVEFMX0FERFJFU1M6IDExMiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fU0hPUlRfTUVTU0FHRTogNjQgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1VSSTogMTYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1ZJU0lCTEVfUEFTU1dPUkQ6IDE0NCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fV0VCX0VESVRfVEVYVDogMTYwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9FTUFJTF9BRERSRVNTOiAyMDggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9QQVNTV09SRDogMjI0IAogICAgIiIiCgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRlZmF1bHQ9bGFtYmRhIHg6IHtrOiB2IGZvciBrLCB2IGluIHZhcnMoeCkuaXRlbXMoKSBpZiB2fSwKICAgICAgICAgICAgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZQogICAgICAgICkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkK"
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\version_control.py",
                "PyFileKey": "version_control",
                "PyFileData": "aW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCAgcmUKI2Zyb20KZGVmIGlzX3ZhbGlkX3ZlcnNpb24odmVyc2lvbik6CiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBjaGVjayBpZiB0aGUgdmVyc2lvbiBoYXMgdGhlIGNvcnJlY3QgZm9ybWF0ICh4LngueC54KQogICAgaWYgbm90IGlzaW5zdGFuY2UodmVyc2lvbiwgc3RyKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBwYXR0ZXJuID0gcideXGR7MSwyfShcLlxkezEsMn0pezR9JwoKICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIHZlcnNpb24pKQoKCiPQn9C10YDQtdCx0LjRgNCw0LXQvCDRgNC10LvQuNC30Ysg0L/QviDQvtC00L3QvtC80YMuINCk0YPQvdC60YbQuNGPINC/0YvRgtCw0LXRgtGB0Y8g0L3QsNC50YLQuCDQsiDQvNC+0LTRg9C70LUg0YTRg9C90LrRhtC40Y4g0YEg0LjQvNC10L3QtdC8LAojINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQvCDQvdC+0LzQtdGA0YMg0YDQtdC70LjQt9CwINC4INC10YHQu9C4INC90LDRiNC70LAgLSDQstGL0L/QvtC70L3QuNGC0Ywg0LXRkQpkZWYgcnVuX3JlbGVhc2VzKF9zdGFydF92ZXJzaW9uOnN0ciwgX2VuZF92ZXJzaW9uOnN0cik6CiAgICByZXR1cm5fbGlzdCA9IFtdCiAgICBpZiBub3QgaXNfdmFsaWRfdmVyc2lvbihfc3RhcnRfdmVyc2lvbikgb3Igbm90IGlzX3ZhbGlkX3ZlcnNpb24oX2VuZF92ZXJzaW9uKToKICAgICAgICByZXR1cm5fbGlzdC5hcHBlbmQoeydyZXN1bHQnOiBGYWxzZSwgJ2RldGFpbHMnOiAn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIg0LLQtdGA0YHQuNC4INC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuC4g0KTQvtGA0LzQsNGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCDQtNC+0LvQttC10L0g0LHRi9GC0YwgeC54LngueCd9KQogICAgICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiAgICB2ZXJzaW9uID0gX3N0YXJ0X3ZlcnNpb24KICAgIHdoaWxlIGNvbXBhcmVfdmVyc2lvbnModmVyc2lvbiwgX2VuZF92ZXJzaW9uKSA8PSAwOgogICAgICAgIHJlbGVhc2VfZnVuY3Rpb25fbmFtZSA9ICdyJyArIHZlcnNpb24ucmVwbGFjZSgnLicsICdfJykKICAgICAgICByZWxlYXNlX2Z1bmN0aW9uID0gZ2xvYmFscygpLmdldChyZWxlYXNlX2Z1bmN0aW9uX25hbWUpCiAgICAgICAgaWYgcmVsZWFzZV9mdW5jdGlvbiBhbmQgY2FsbGFibGUocmVsZWFzZV9mdW5jdGlvbik6CgogICAgICAgICAgICByZXMgPSByZWxlYXNlX2Z1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuX2xpc3QuYXBwZW5kKHJlcykKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcHJpbnQoZiJSZWxlYXNlIGZ1bmN0aW9uICd7cmVsZWFzZV9mdW5jdGlvbl9uYW1lfScgbm90IGZvdW5kLiIpCgogICAgICAgIHZlcnNpb24gPSBpbmNyZW1lbnRfdmVyc2lvbih2ZXJzaW9uKQoKICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiPQodGA0LDQstC90LjQstCw0LXQvCDQvdC+0LzQtdGA0LAg0LLQtdGA0YHQuNC4LiDQktC+0LfQstGA0LDRidCw0LXRgiAtMSDQn9C+0YHQu9C10LTQvdGP0Y8g0LLQtdGA0YHQuNGPINCy0YHQtSDQtdGJ0ZEg0LHQvtC70YzRiNC1LAojIDAg0LXRgdC70Lgg0YDQsNCy0L3RiyDQuCAxINC10YHQu9C4INGC0LXQutGD0YnQsNGPINCy0LXRgNGB0LjRjyDQsdC+0LvRjNGI0LUg0L/QvtGB0LvQtdC00L3QtdC5CmRlZiBjb21wYXJlX3ZlcnNpb25zKHZlcnNpb24xLCB2ZXJzaW9uMik6CiAgICBwYXJ0czEgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24xLnNwbGl0KCcuJykpKQogICAgcGFydHMyID0gbGlzdChtYXAoaW50LCB2ZXJzaW9uMi5zcGxpdCgnLicpKSkKCiAgICBmb3IgcDEsIHAyIGluIHppcChwYXJ0czEsIHBhcnRzMik6CiAgICAgICAgaWYgcDEgPCBwMjoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgZWxpZiBwMSA+IHAyOgogICAgICAgICAgICByZXR1cm4gMQoKICAgIHJldHVybiAwCgoKI9Cf0YDQuNCx0LDQstC70Y/QtdC8IDEg0Log0L3QvtC80LXRgNGDINGC0LXQutGD0YnQtdC5INCy0LXRgNGB0LjQuCAo0L/QviDQs9GA0YPQv9C/0LDQvCwKIyDQvNCw0LrRgdC40LzRg9C8IDk5INCyINC+0LTQvdC+0Lkg0LPRgNGD0L/Qv9C1KSDQndCw0L/RgNC40LzQtdGAIDEuMS4xLjEuOTkgKyAxINC00LDRgdGCINC90LDQvCAxLjEuMS4yLjAKZGVmIGluY3JlbWVudF92ZXJzaW9uKHZlcnNpb24pOgogICAgcGFydHMgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24uc3BsaXQoJy4nKSkpCiAgICBwYXJ0c1stMV0gKz0gMQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHBhcnRzKSAtIDEsIDAsIC0xKToKICAgICAgICBpZiBwYXJ0c1tpXSA9PSAxMDA6CiAgICAgICAgICAgIHBhcnRzW2ldID0gMAogICAgICAgICAgICBwYXJ0c1tpIC0gMV0gKz0gMQogICAgcmV0dXJuICcuJy5qb2luKG1hcChzdHIsIHBhcnRzKSkKCgoKZGVmIHIwXzFfMF8xMl8zKGhhc2hfbWFwKToKICAgICMgQ29kZSBmb3IgcmVsZWFzZSAwLjEuMC4xMi4zCiAgICBxdGV4dCA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlIEFTIFNFTEVDVCAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzOwogICAgCiAgICBEUk9QIFRBQkxFIFJTX2JhcmNvZGVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfYmFyY29kZXMgKAogICAgICAgIGJhcmNvZGUgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfcHJvcGVydHkgVEVYVCwKICAgICAgICBpZF9zZXJpZXMgICBURVhULAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQsCiAgICAgICAgcmF0aW8gICAgICAgSU5URUdFUiBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19iYXJjb2RlcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgICAgICAKICAgIFVQREFURQogICAgUlNfYmFyY29kZXMKICAgIFNFVAogICAgcmF0aW8gPSBDT0FMRVNDRSgoCiAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvci9SU191bml0cy5kZW5vbWluYXRvcgogICAgRlJPTSBSU191bml0cwogICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICApLCAxKTsKICAgIAogICAgICAgIAogICAgRFJPUCBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZTsKICAgIAogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDE7CiAgICAnJycKCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocXRleHQsJycpCiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOlRydWV9CiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOkZhbHNlLCAnZGV0YWlscyc6ZifQntGI0LjQsdC60LAg0LIg0LfQsNC/0YDQvtGB0LU6IHtxdGV4dH0nfQoKCmRlZiByMF8xXzBfMTNfNyhoYXNoX21hcCk6CgogICAgcSA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFCiAgICBUQUJMRQogICAgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUKICAgIEFTCiAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3NfdGFibGU7CgogICAgRFJPUCBUQUJMRSBSU19kb2NzX3RhYmxlOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc190YWJsZSgKICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgUlNfZG9jcyhpZF9kb2MpCiAgICBPTiBERUxFVEUgQ0FTQ0FERSBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICBpZF9nb29kIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyBSU19nb29kcyhpZCksCiAgICBpZF9wcm9wZXJ0aWVzIFRFWFQgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzKGlkKSwKICAgIGlkX3NlcmllcyBURVhUIFJFRkVSRU5DRVMgUlNfc2VyaWVzKGlkKSwKICAgIGlkX3VuaXQgVEVYVCBOT1QgTlVMTCBSRUZFUkVOQ0VTIFJTX3VuaXRzKGlkKSwKICAgIHF0dHkgUkVBTCwgCiAgICBxdHR5X3BsYW4gUkVBTCwKICAgIHByaWNlIFJFQUwsCiAgICBpZF9wcmljZSBURVhUIFJFRkVSRU5DRVMgIFJTX3ByaWNlX3R5cGVzKGlkKSwKICAgIHNlbnQgSU5URUdFUiwKICAgIGxhc3RfdXBkYXRlZCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiBURVhUIERFRkFVTFQgVHJ1ZSwKICAgIGlkX2NlbGwgVEVYVCBSRUZFUkVOQ0VTIFJTX2NlbGxzKGlkKSwKICAgIHVzZV9zZXJpZXMgICAgSU5UICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMCkKICAgICk7CgogICAgSU5TRVJUIElOVE8gUlNfZG9jc190YWJsZSgKICAgICAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksCiAgICAgICAgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UsIHNlbnQsIGxhc3RfdXBkYXRlZCwgaXNfcGxhbiwgaWRfY2VsbAogICAgKQogICAgU0VMRUNUCiAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwKICAgIHByaWNlLCBpZF9wcmljZSwgc2VudCwgbGFzdF91cGRhdGVkLCBpc19wbGFuLCBpZF9jZWxsIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgIERST1AgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKCiAgICBDUkVBVEUgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUgQVMgU0VMRUNUICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllczsKCiAgICBEUk9QIFRBQkxFIFJTX2RvY3Nfc2VyaWVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc19zZXJpZXMgKAogICAgICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX2RvYyAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICAgICAgaWRfZ29vZCAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgICAgICBpZF93YXJlaG91c2UgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICAgICAgcXR0eSAgICAgICAgICAgIFJFQUwsCiAgICAgICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGJlc3RfYmVmb3JlICAgICBEQVRFVElNRSwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgICAgIGNlbGwgICAgICAgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19jZWxscyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICk7CiAgICAKICAgIElOU0VSVCBJTlRPIFJTX2RvY3Nfc2VyaWVzICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF0dHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdHR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICAKICAgIENSRUFURSBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZSBBUyBTRUxFQ1QgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jczsKICAgIAogICAgRFJPUCBUQUJMRSBSU19hZHJfZG9jczsKICAgIAogICAgQ1JFQVRFIFRBQkxFIFJTX2Fkcl9kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSAgICBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICAgICBERUZBVUxUIDAsCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCBURVhUICAgICBERUZBVUxUICgwKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkgCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19hZHJfZG9jcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19kYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmlmaWVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21hcmtfc2VsZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBQUkFHTUEgZm9yZWlnbl9rZXlzID0gMTsKCgogICAgJycnCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocSwnJykKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6VHJ1ZX0KICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6RmFsc2UsICdkZXRhaWxzJzpmJ9Ce0YjQuNCx0LrQsCDQsiDQt9Cw0L/RgNC+0YHQtToge3F9J30KCgojIGlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiMgICAgICMgUmVwbGFjZSB0aGVzZSB2ZXJzaW9ucyB3aXRoIHlvdXIgYWN0dWFsIHZlcnNpb24gbnVtYmVycwojICAgICBzdGFydF92ZXJzaW9uID0gIjAuMS4wLjExLjciCiMgICAgIHN0YXJ0X3ZlcnNpb24gPSAoInMiKQojICAgICBlbmRfdmVyc2lvbiA9ICIwLjEuMC4xMi4zIgojCiMgICAgIHByaW50KHJ1bl9yZWxlYXNlcyhzdGFydF92ZXJzaW9uLCBlbmRfdmVyc2lvbikpCiNwcmludChpc192YWxpZF92ZXJzaW9uKCIwMS4xLjAuMTEuMjYiKSk="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\printing_factory.py",
                "PyFileKey": "printing_factory",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBUdXBsZSwgQW55LCBVbmlvbgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVVdGlsaXRlcyBhcyBzdUNsYXNzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgenBsCmZyb20gUElMIGltcG9ydCBJbWFnZQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cAppbXBvcnQgYmFyY29kZQpmcm9tIGJhcmNvZGUud3JpdGVyIGltcG9ydCBJbWFnZVdyaXRlcgppbXBvcnQgcXJjb2RlCmZyb20gamluamEyIGltcG9ydCBFbnZpcm9ubWVudCwgRmlsZVN5c3RlbUxvYWRlciwgc2VsZWN0X2F1dG9lc2NhcGUsIG1ldGEKaW1wb3J0IGJhc2U2NApmcm9tIGlvIGltcG9ydCBCeXRlc0lPCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwpmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZUJsdWV0b290aApub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCmJ0ID0gU2ltcGxlQmx1ZXRvb3RoKCkKCgpjbGFzcyBIVE1MRG9jdW1lbnQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVtcGxhdGVfZGlyZWN0b3J5LCB0ZW1wbGF0ZV9maWxlKToKICAgICAgICBzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSA9IHRlbXBsYXRlX2RpcmVjdG9yeQogICAgICAgIHNlbGYudGVtcGxhdGVfZmlsZSA9IHRlbXBsYXRlX2ZpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2VuZXJhdGVfYmFyY29kZShkYXRhLCBiYXJjb2RlX3R5cGU9J2VhbjEzJyk6CiAgICAgICAgZWFuX2NsYXNzID0gYmFyY29kZS5nZXRfYmFyY29kZV9jbGFzcyhiYXJjb2RlX3R5cGUpCiAgICAgICAgd3JpdGVyID0gSW1hZ2VXcml0ZXIoKQogICAgICAgIGVhbiA9IGVhbl9jbGFzcyhkYXRhLCB3cml0ZXI9d3JpdGVyKQoKICAgICAgICBiYXJjb2RlX2ltYWdlID0gQnl0ZXNJTygpCiAgICAgICAgZWFuLndyaXRlKGJhcmNvZGVfaW1hZ2UpCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYmFyY29kZV9pbWFnZS5nZXR2YWx1ZSgpKS5kZWNvZGUoKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZW5lcmF0ZV9xcl9jb2RlKGJhcmNvZGVfZGF0YSk6CiAgICAgICAgcXIgPSBxcmNvZGUuUVJDb2RlKHZlcnNpb249MSwgYm94X3NpemU9MTAsIGJvcmRlcj01KQogICAgICAgIHFyLmFkZF9kYXRhKGJhcmNvZGVfZGF0YSkKICAgICAgICBxci5tYWtlKGZpdD1UcnVlKQogICAgICAgIGltZyA9IHFyLm1ha2VfaW1hZ2UoZmlsbF9jb2xvcj0iYmxhY2siLCBiYWNrX2NvbG9yPSJ3aGl0ZSIpCgogICAgICAgIGJ1ZmZlcmVkID0gQnl0ZXNJTygpCiAgICAgICAgaW1nLnNhdmUoYnVmZmVyZWQsIGZvcm1hdD0iUE5HIikKCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYnVmZmVyZWQuZ2V0dmFsdWUoKSkuZGVjb2RlKCkKCiAgICBkZWYgY3JlYXRlX2h0bWwoc2VsZiwgcGFyYW1ldGVycywgYmFyY29kZV90eXBlPSdlYW4xMycpOgogICAgICAgIGVudiA9IEVudmlyb25tZW50KAogICAgICAgICAgICBsb2FkZXI9RmlsZVN5c3RlbUxvYWRlcihzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSksCiAgICAgICAgICAgIGF1dG9lc2NhcGU9c2VsZWN0X2F1dG9lc2NhcGUoWydodG1sJywgJ3htbCddKSwKICAgICAgICAgICAgdmFyaWFibGVfc3RhcnRfc3RyaW5nPSdbJywKICAgICAgICAgICAgdmFyaWFibGVfZW5kX3N0cmluZz0nXScsCiAgICAgICAgKQogICAgICAgIGlmIGJhcmNvZGVfdHlwZSA9PSAncXItY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGVfaW1hZ2VfYmFzZTY0ID0gc2VsZi5nZW5lcmF0ZV9xcl9jb2RlKHBhcmFtZXRlcnNbJ2JhcmNvZGUnXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlX2ltYWdlX2Jhc2U2NCA9IHNlbGYuZ2VuZXJhdGVfYmFyY29kZShwYXJhbWV0ZXJzWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGVfdHlwZSkKCiAgICAgICAgdGVtcGxhdGUgPSBlbnYuZ2V0X3RlbXBsYXRlKHNlbGYudGVtcGxhdGVfZmlsZSkKCiAgICAgICAgYWEgPSB0ZW1wbGF0ZS5yZW5kZXIocGFyYW1ldGVycykKCiAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAoYWEsICdodG1sLnBhcnNlcicpCiAgICAgICAgZm9yIGltZ3RhZyBpbiBzb3VwLmZpbmRfYWxsKCJpbWciKToKICAgICAgICAgICAgaW1ndGFnWydzcmMnXSA9ICgiZGF0YTppbWFnZS9wbmc7IHdpZHRoOmF1dG87IGhlaWdodDphdXRvOyBiYXNlNjQsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYmFyY29kZV9pbWFnZV9iYXNlNjQpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZmluZF90ZW1wbGF0ZV92YXJpYWJsZXMoZGlyZWN0b3J5OiBzdHIsIGZpbGVfbmFtZTogc3RyKToKICAgICAgICBlbnYgPSBFbnZpcm9ubWVudCgKICAgICAgICAgICAgbG9hZGVyPUZpbGVTeXN0ZW1Mb2FkZXIoZGlyZWN0b3J5KSwKICAgICAgICAgICAgYXV0b2VzY2FwZT1zZWxlY3RfYXV0b2VzY2FwZShbJ2h0bWwnLCAneG1sJ10pLAogICAgICAgICAgICB2YXJpYWJsZV9zdGFydF9zdHJpbmc9J1snLAogICAgICAgICAgICB2YXJpYWJsZV9lbmRfc3RyaW5nPSddJywKICAgICAgICApCiAgICAgICAgdGVtcGxhdGVfc291cmNlID0gZW52LmxvYWRlci5nZXRfc291cmNlKGVudiwgZmlsZV9uYW1lKVswXQogICAgICAgIHBhcnNlZF9jb250ZW50ID0gZW52LnBhcnNlKHRlbXBsYXRlX3NvdXJjZSkKICAgICAgICBwYXJhbXMgPSBtZXRhLmZpbmRfdW5kZWNsYXJlZF92YXJpYWJsZXMocGFyc2VkX2NvbnRlbnQpCiAgICAgICAgaWYgJ2JhcmNvZGUnIG5vdCBpbiBwYXJhbXM6CiAgICAgICAgICAgIHBhcmFtcy5hZGQoJ2JhcmNvZGUnKQogICAgICAgIHJldHVybiBwYXJhbXMKCiAgICBkZWYgZ2V0X3RlbXBsYXRlKHNlbGYpOgoKICAgICAgICB3aXRoIG9wZW4oUGF0aChzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSkgLyBzZWxmLnRlbXBsYXRlX2ZpbGUsICJyIiwKICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9InV0Zi04IikgYXMgZmlsZToKICAgICAgICAgICAgaHRtbF9ib2R5ID0gZmlsZS5yZWFkKCkKCiAgICAgICAgcmV0dXJuIGh0bWxfYm9keQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbmplY3RfY3NzX3N0eWxlKGh0bWwsIHdpZHRoOiBzdHIsIGhlaWdodDogc3RyLCB4OiBzdHIsIHk6IHN0cik6CiAgICAgICAgY3NzX3RlbXBsYXRlMiA9ICcnJwogICAgICAgICAgQHBhZ2UgewogICAgICAgICAgICBtYXJnaW46IDFtbTsgLyogQWRqdXN0IGlmIG5lY2Vzc2FyeSAqLwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZmZmZjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsOwogICAgICAgICAgICBmb250LXNpemU6IDhwdDsKICAgICAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgICAgIH0KCiAgICAgICAgLmZ1bGwtdGVtcGxhdGUgewogICAgICAgICAgICB3aWR0aDogY2FsYygxMDB2dyAtIDJtbSk7ICAKICAgICAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMm1tKTsKICAgICAgICAgICAgbWluLXdpZHRoOiA0MG1tOyAgICAvKiBNaW5pbXVtIHdpZHRoICovCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQwbW07ICAgLyogTWluaW11bSBoZWlnaHQgKi8KICAgICAgICAgICAgYm9yZGVyOiAxcHQgc29saWQgYmxhY2s7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IC8qIGVuc3VyZXMgcGFkZGluZyBhbmQgYm9yZGVyIGFyZSBpbmNsdWRlZCBpbiB0aGUgdG90YWwgd2lkdGggYW5kIGhlaWdodCAqLwogICAgICAgICAgICBwYWdlLWJyZWFrLWluc2lkZTogYXZvaWQ7IC8qIEF2b2lkIGJyZWFraW5nIGluc2lkZSB0aGUgdGVtcGxhdGUgKi8KICAgICAgICB9CgogICAgICAgIGltZyB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKCcnJyArIHggKyAnJydweCwgJycnICsgeSArICcnJ3B4KTsKICAgICAgICAgICAgd2lkdGg6ICcnJyArIHdpZHRoICsgJycnbW07CiAgICAgICAgICAgIGhlaWdodDogJycnICsgaGVpZ2h0ICsgJycnbW07CiAgICAgICAgfQoKICAgICAgICB0YWJsZSB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7CiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgICAgICAgICAgIHBhZ2UtYnJlYWstaW5zaWRlOiBhdm9pZDsgLyogQXZvaWQgYnJlYWtpbmcgaW5zaWRlIHRoZSB0YWJsZSAqLwogICAgICAgIH0KCiAgICAgICAgdGQgewogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgfQogICAgICAgICcnJwoKICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cChodG1sLCAiaHRtbC5wYXJzZXIiKQogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INGB0LLQvtC4INGB0YLQuNC70Lgg0LIg0LTQvtC60YPQvNC10L3RggogICAgICAgIGhlYWRfdGFnID0gc291cC5oZWFkCiAgICAgICAgc3R5bGVfdGFnID0gc291cC5uZXdfdGFnKCJzdHlsZSIpCiAgICAgICAgc3R5bGVfdGFnLnN0cmluZyA9IGNzc190ZW1wbGF0ZTIKICAgICAgICBoZWFkX3RhZy5hcHBlbmQoc3R5bGVfdGFnKQogICAgICAgICMg0JfQsNC/0LjRhdGD0LXQvCDQstC10YHRjCDQtNC+0LrRg9C80LXQvdGCINCyINC60L7QvdGC0LXQudC90LXRgAogICAgICAgIHdyYXBwZXIgPSBzb3VwLm5ld190YWcoImRpdiIpCiAgICAgICAgd3JhcHBlclsnY2xhc3MnXSA9ICdmdWxsLXRlbXBsYXRlJwogICAgICAgIGJvZHlfY2hpbGRyZW4gPSBsaXN0KHNvdXAuYm9keS5jaGlsZHJlbikKICAgICAgICBzb3VwLmJvZHkuY2xlYXIoKQogICAgICAgIHNvdXAuYm9keS5hcHBlbmQod3JhcHBlcikKICAgICAgICBmb3IgY2hpbGQgaW4gYm9keV9jaGlsZHJlbjoKICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoY2hpbGQpCgogICAgICAgICMg0KPQtNCw0LvRj9C10Lwg0L/Rg9GB0YLRi9C1INGP0YfQtdC50LrQuCDQuNC3INGC0LDQsdC70LjRhtGLLCDQutC+0YLQvtGA0YvQtSDRgtCw0Log0LvRjtCx0LjRgiAx0YEKICAgICAgICBmb3IgdHIgaW4gc291cC5maW5kX2FsbCgndHInKToKCiAgICAgICAgICAgIGZvciB0ZCBpbiB0ci5maW5kX2FsbCgndGQnKToKICAgICAgICAgICAgICAgIGlmIG5vdCB0ZC5hdHRycy5nZXQoJ2NsYXNzJyk6CiAgICAgICAgICAgICAgICAgICAgdGQuZGVjb21wb3NlKCkKICAgICAgICAjINCb0LjRiNC90LjQtSDQutC+0LvQvtC90LrQuCDRgdC/0YDQsNCy0LAg0YPQtNCw0LvRj9C10Lwg0YLQvtC20LUKICAgICAgICBmb3IgY29sIGluIHNvdXAuZmluZF9hbGwoJ2NvbCcpOgogICAgICAgICAgICBpZiBub3QgY29sLmF0dHJzOgogICAgICAgICAgICAgICAgY29sLmRlY29tcG9zZSgpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCgpjbGFzcyBQcmludFNlcnZpY2U6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU6IGludCwKICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBwYXRoX3RvX2ltZzogc3RyCiAgICApIC0+IHN0cjoKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMgenBsINGBINC60LDRgNGC0LjQvdC60L7QuSDQstC90YPRgtGA0LgiIiIKICAgICAgICBsYWJlbCA9IHpwbC5MYWJlbCgKICAgICAgICAgICAgd2lkdGg9aW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUgKiAyLAogICAgICAgICAgICBoZWlnaHQ9aW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlICogMiwKICAgICAgICAgICAgZHBtbT1kcG1tX3ByaW50X3RlbXBsYXRlCiAgICAgICAgKQogICAgICAgIGxhYmVsLm9yaWdpbihpbWFnZV94X3ByaW50X3RlbXBsYXRlLCBpbWFnZV95X3ByaW50X3RlbXBsYXRlKQogICAgICAgIGxhYmVsLndyaXRlX2dyYXBoaWMoCiAgICAgICAgICAgIGltYWdlPUltYWdlLm9wZW4ocGF0aF90b19pbWcpLAogICAgICAgICAgICB3aWR0aD1pbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZSAqIDIsCiAgICAgICAgICAgIGhlaWdodD1pbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUgKiAyCiAgICAgICAgKQogICAgICAgIGxhYmVsLmVuZG9yaWdpbigpCiAgICAgICAgenBsX2RhdGEgPSBsYWJlbC5kdW1wWlBMKCkKICAgICAgICBsbCA9IGltYWdlX2xsX3ByaW50X3RlbXBsYXRlCiAgICAgICAgcHcgPSBpbWFnZV9wd19wcmludF90ZW1wbGF0ZQogICAgICAgIGlmIGxsIGFuZCBwdzoKICAgICAgICAgICAgenBsX2RhdGEgPSB6cGxfZGF0YS5yZXBsYWNlKCdeWEEnLCAnXlhBJyArIGYnXkxMe2xsfScgKyBmJ15QV3twd30nLCAxKQogICAgICAgIHJldHVybiB6cGxfZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB6cGxfdG9fcG5nX2Zyb21fYXBpKAogICAgICAgICAgICB6cGxfZGF0YTogc3RyLAogICAgICAgICAgICBkcG1tOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX3dpZHRoOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX2hlaWdodDogaW50LAogICAgKSAtPiBUdXBsZVtib29sLCBBbnldOgogICAgICAgICIiIgogICAgICAgINCU0LXQu9Cw0LXRgiDQt9Cw0L/RgNC+0YEg0LogQVBJLiDQntGC0L/RgNCw0LLQu9GP0Y7RgtGB0Y8genBsINC60L7QtCDQuCDRgNCw0LfQvNC10YDRiyDRjdGC0LjQutC10YLQutC4LgogICAgICAgICIiIgogICAgICAgIGZpbGVzID0geydmaWxlJzogenBsX2RhdGF9CgogICAgICAgIHVybCA9IChmJ2h0dHA6Ly9hcGkubGFiZWxhcnkuY29tL3YxL3ByaW50ZXJzL3tkcG1tfWRwbW0vJwogICAgICAgICAgICAgICBmJ2xhYmVscy97bW1fdG9faW5jaChsYWJlbF93aWR0aCAqIDIpfXh7bW1fdG9faW5jaChsYWJlbF9oZWlnaHQgKiAyKX0vMC8nKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIHN0cmVhbT1UcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgcmVzcG9uc2UudGV4dAoKICAgICAgICByZXNwb25zZS5yYXcuZGVjb2RlX2NvbnRlbnQgPSBUcnVlCiAgICAgICAgcmV0dXJuIFRydWUsIHJlc3BvbnNlLnJhdwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludChoYXNoX21hcCwgZGF0YTogZGljdCk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsYWJlbF9wYXRoID0gcHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJykKICAgICAgICBpZiBub3QgbGFiZWxfcGF0aDoKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRiNCw0LHQu9C+0L3QsCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhwcmludF9uY2wuZ2V0KCdtYXRjaGluZ190YWJsZScpKQogICAgICAgIHRlbXBsYXRlX2RpcmVjdG9yeSwgdGVtcGxhdGVfZmlsZSA9IG9zLnBhdGguc3BsaXQobGFiZWxfcGF0aCkKICAgICAgICBkYXRhX2Zvcl9wcmludGluZyA9IHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGEsIG1hdGNoaW5nX3RhYmxlKQoKICAgICAgICBodG1scmVzdWx0ID0gSFRNTERvY3VtZW50KAogICAgICAgICAgICB0ZW1wbGF0ZV9kaXJlY3RvcnksIHRlbXBsYXRlX2ZpbGUKICAgICAgICApLmNyZWF0ZV9odG1sKGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9cHJpbnRfbmNsLmdldCgnYmFyY29kZV90eXBlJykpCgogICAgICAgIGh0bWxyZXN1bHQgPSBIVE1MRG9jdW1lbnQuaW5qZWN0X2Nzc19zdHlsZSgKICAgICAgICAgICAgaHRtbHJlc3VsdCwKICAgICAgICAgICAgd2lkdGg9c3RyKGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX3dpZHRoJykpKSwKICAgICAgICAgICAgaGVpZ2h0PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9oZWlnaHQnKSkpLAogICAgICAgICAgICB4PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9yaWdodCcpKQogICAgICAgICAgICAgICAgICAtIGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX2xlZnQnKSkpLAogICAgICAgICAgICB5PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9kb3duJykpCiAgICAgICAgICAgICAgICAgIC0gaW50KHByaW50X25jbC5nZXQoJ2JhcmNvZGVfdXAnKSkpLAogICAgICAgICkKCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Ce0YLQv9GA0LDQstC70LXQvdC+INC90LAg0L/QtdGH0LDRgtGMJykKICAgICAgICBoYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJSdW5FdmVudCIsCiAgICAgICAgICAgIGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICJhY3Rpb24iOiAicnVuYXN5bmMiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiaHRtbDJpbWFnZSIsCiAgICAgICAgICAgICAgICAibWV0aG9kIjogaHRtbHJlc3VsdCwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6IGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uIjogInJ1biIsCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicHl0aG9uIiwKICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogInByaW50X3Bvc3RfZXhlY3V0ZSIKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9XSkKICAgICAgICApCgogICAgICAgIGZpbGVuYW1lID0gc3VDbGFzcy5nZXRfdGVtcF9maWxlKCJwbmciKQogICAgICAgIHByaW50X25jbC5wdXQoJ3BhdGhfdG9faHRtbDJpbWFnZV9maWxlJywgZmlsZW5hbWUsIFRydWUpCiAgICAgICAgaGFzaF9tYXAucHV0KCJodG1sMmltYWdlX1RvRmlsZSIsIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHBhdGhfdG9faW1nID0gcHJpbnRfbmNsLmdldCgncGF0aF90b19odG1sMmltYWdlX2ZpbGUnKQogICAgICAgIHNhdmVkX3RlbXBsYXRlID0gcHJpbnRfbmNsLmdldCgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGlmIG5vdCBzYXZlZF90ZW1wbGF0ZToKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRgdC+0YXRgNCw0L3QtdC90L3QvtCz0L4g0YjQsNCx0LvQvtC90LAg0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2F2ZWRfdGVtcGxhdGUgPSBqc29uLmxvYWRzKHNhdmVkX3RlbXBsYXRlKQogICAgICAgIHpwbGRhdGEgPSBQcmludFNlcnZpY2UubWFrZV96cGxfZnJvbV9sYWJlbCgKICAgICAgICAgICAgcGF0aF90b19pbWc9cGF0aF90b19pbWcsICoqc2F2ZWRfdGVtcGxhdGUpCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50X3pwbCh6cGxkYXRhLCBoYXNoX21hcCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfenBsKHpwbF9kYXRhOiBzdHIsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBwcmludF90aHJvdWdoID0gcHJpbnRfbmNsLmdldCgncHJpbnRfdGhyb3VnaCcpCiAgICAgICAgaWYgbm90IHByaW50X3Rocm91Z2g6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INCy0YvQsdGA0LDQvdC+INGD0YHRgtGA0L7QudGB0YLQstC+INC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgIGVsaWYgcHJpbnRfdGhyb3VnaCA9PSAnQlQnOgogICAgICAgICAgICBzZW50LCByZXN1bHQgPSBQcmludFNlcnZpY2UucHJpbnRfYnQoenBsX2RhdGEpCiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KHJlc3VsdCkKICAgICAgICBlbGlmIHByaW50X3Rocm91Z2ggPT0gJ1dpRmknOgogICAgICAgICAgICBwcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGxfZGF0YSwgVHJ1ZSkKICAgICAgICAgICAgaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfd2lmaShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaXAgPSBwcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRhdGEgPSBwcmludF9uY2wuZ2V0KCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L/QtdGH0LDRgtC4IHdpZmknKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBwcmludF9uY2wuZGVsZXRlKCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGZhaWxfaGFuZGxlcnMgPSBbeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJ3aWZpX2Vycm9yIn1dCiAgICAgICAgc2VuZGVkID0gc3VDbGFzcy53cml0ZV9zb2NrZXQoaXAsIDkxMDAsIGRhdGEsIGpzb24uZHVtcHMoZmFpbF9oYW5kbGVycykpCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cj0YHQv9C10YjQvdC+JyBpZiBzZW5kZWQgZWxzZSAn0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3QvicpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHByaW50X2J0KGRhdGE6IFVuaW9uW3N0ciwgaW50LCBieXRlc10pOgogICAgICAgIG5jbCA9IG5vQ2xhc3MoImJ0X3NldHRpbmdzIikKICAgICAgICBidF9oYW5kbGVycyA9IFt7ImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJweXRob24iLCAibWV0aG9kIjogImJsdWV0b290aF9lcnJvciJ9XQogICAgICAgIHByaW50ZXIgPSBuY2wuZ2V0KCJkZWZhdWx0X3ByaW50ZXIiKQogICAgICAgIGlmIHByaW50ZXIgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCAi0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3Qvi7QndC1INCy0YvQsdGA0LDQvSBCVC3Qv9GA0LjQvdGC0LXRgCIKICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKHByaW50ZXIpCiAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgItCd0LUg0L7RgtC/0YDQsNCy0LvQtdC90L4u0J3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8g0Log0YPRgdGC0YDQvtC50YHRgtCy0YMiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgKCLQntGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjC4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiDQn9C10YDQtdC/0L7QtNC60LvRjtGH0LjRgtC1INC/0YDQuNC90YLQtdGALCDQtdGB0LvQuCDQv9C10YfQsNGC0Ywg0L3QtSDQvdCw0YfQsNC70LDRgdGMIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJ0LmNvbm5lY3RfdG9fY2xpZW50KGRldmljZSwganNvbi5kdW1wcyhidF9oYW5kbGVycykpCiAgICAgICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUsICLQo9GB0L/QtdGI0L3QviDQvtGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjCIKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2htYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2htYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgaGFzaG1hcC5wdXQoInNwZWFrIiwgItCd0LUg0YPQtNCw0LvQvtGB0Ywg0L/QvtC00LrQu9GO0YfQuNGC0YzRgdGPIEJsdWV0b290aCIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHdpZmlfZXJyb3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIGhhc2hfbWFwLnB1dCgic3BlYWsiLCAi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8gV2lGaSIpCgoKZGVmIG1tX3RvX2luY2goc2l6ZV9tbTogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX21tIC8gMjUuNAoKCmRlZiBpbmNoX3RvX21tKHNpemVfaW5jaDogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX2luY2ggKiAyNS40CgoKZGVmIHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGFfZm9yX3ByaW50aW5nLCBwYXJhbXNfbWF0Y2gpOgogICAgbmV3X2RhdGEgPSB7fQogICAgZm9yIG1hdGNoIGluIHBhcmFtc19tYXRjaDoKICAgICAgICBpZiBtYXRjaFsndmFsdWUnXSBpbiBkYXRhX2Zvcl9wcmludGluZy5rZXlzKCk6CiAgICAgICAgICAgIG5ld19kYXRhW21hdGNoWydrZXknXV0gPSBkYXRhX2Zvcl9wcmludGluZ1ttYXRjaFsndmFsdWUnXV0KICAgIHJldHVybiBuZXdfZGF0YQo="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\tiny_db_services.py",
                "PyFileKey": "tiny_db_services",
                "PyFileData": "aW1wb3J0IGRhdGV0aW1lCmltcG9ydCBqc29uCmltcG9ydCBvcwpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgVW5pb24sIERpY3QsIEFueSwgT3B0aW9uYWwsIFR1cGxlCmZyb20gZnVuY3Rvb2xzIGltcG9ydCByZWR1Y2UKZnJvbSB0aW55ZGIgaW1wb3J0IFRpbnlEQiwgUXVlcnksIHdoZXJlCmZyb20gdWlfdXRpbHMgaW1wb3J0IERhdGVGb3JtYXQKCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBUaW55Tm9TUUxQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lLCBiYXNlX25hbWU9J1NpbXBsZUtlZXAnLCBkYl9wYXRoPScnKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5iYXNlX25hbWUgPSBiYXNlX25hbWUgb3IgcnNfc2V0dGluZ3MuZ2V0KCdzcWxpdGVfbmFtZScpCiAgICAgICAgc2VsZi5kYl9wYXRoID0gZGJfcGF0aCBvciByc19zZXR0aW5ncy5nZXQoJ3BhdGhfdG9fZGF0YWJhc2VzJykKICAgICAgICBzZWxmLmRiID0gVGlueURCKG9zLnBhdGguam9pbihzZWxmLmRiX3BhdGgsIGYne3NlbGYuYmFzZV9uYW1lfS5qc29uJykpCiAgICAgICAgc2VsZi50YWJsZSA9IHNlbGYuZGIudGFibGUoc2VsZi50YWJsZV9uYW1lKQogICAgICAgIHNlbGYucXVlcnkgPSBRdWVyeSgpCgogICAgZGVmIGRyb3BfdGFibGUoc2VsZiwgdGFibGVfbmFtZSk6CiAgICAgICAgc2VsZi5kYi5kcm9wX3RhYmxlKHRhYmxlX25hbWUpCgogICAgZGVmIGdldF9hbGwoc2VsZikgLT4gbGlzdDoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5hbGwoKQoKICAgIGRlZiBnZXQoc2VsZiwgKipjb25kKSAtPiBVbmlvbltEaWN0LCBOb25lXToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5nZXQoY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHNlYXJjaChzZWxmLCAqKmNvbmQpIC0+IGxpc3Q6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuc2VhcmNoKGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBpbnNlcnQoc2VsZiwgZGF0YTogZGljdCkgLT4gaW50OgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmluc2VydChkYXRhKQoKICAgIGRlZiBpbnNlcnRfbXVsdGlwbGUoc2VsZiwgZGF0YTogTGlzdFtkaWN0XSkgLT4gTGlzdFtpbnRdOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmluc2VydF9tdWx0aXBsZShkYXRhKQoKICAgIGRlZiB1cGRhdGUoc2VsZiwgZGF0YTogZGljdCwgKipjb25kKSAtPiBMaXN0W2ludF06CiAgICAgICAgIiIiCiAgICAgICAgZGVsZXRlKGtleSk6IGRlbGV0ZSBhIGtleSBmcm9tIHRoZSBkb2N1bWVudAogICAgICAgIGluY3JlbWVudChrZXkpOiBpbmNyZW1lbnQgdGhlIHZhbHVlIG9mIGEga2V5CiAgICAgICAgZGVjcmVtZW50KGtleSk6IGRlY3JlbWVudCB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBhZGQoa2V5LCB2YWx1ZSk6IGFkZCB2YWx1ZSB0byB0aGUgdmFsdWUgb2YgYSBrZXkgKGFsc28gd29ya3MgZm9yIHN0cmluZ3MpCiAgICAgICAgc3VidHJhY3Qoa2V5LCB2YWx1ZSk6IHN1YnRyYWN0IHZhbHVlIGZyb20gdGhlIHZhbHVlIG9mIGEga2V5CiAgICAgICAgc2V0KGtleSwgdmFsdWUpOiBzZXQga2V5IHRvIHZhbHVlCiAgICAgICAgZGIudXBkYXRlKGRlbGV0ZSgna2V5MScpLCBVc2VyLm5hbWUgPT0gJ0pvaG4nKQogICAgICAgIGRiLnVwZGF0ZSh5b3VyX29wZXJhdGlvbihhcmd1bWVudHMpLCBxdWVyeSkKICAgICAgICAiIiIKCiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUudXBkYXRlKGRhdGEsIGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiB1cHNlcnQoc2VsZiwgZGF0YSwgKipjb25kKSAtPiBMaXN0W2ludF06CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUudXBzZXJ0KGRhdGEsIGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiByZW1vdmUoc2VsZiwgZG9jX2lkcz1Ob25lLCAqKmNvbmQpOgogICAgICAgIGlmIGRvY19pZHM6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnRhYmxlLnJlbW92ZShkb2NfaWRzPWRvY19pZHMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYudGFibGUucmVtb3ZlKGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpLCBkb2NfaWRzPWRvY19pZHMpCgogICAgZGVmIGNvbnRhaW5zKHNlbGYsICoqY29uZCk6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuY29udGFpbnMoc2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBjb3VudChzZWxmLCAqKmNvbmQpOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmNvdW50KHNlbGYuX2NyZWF0ZV9jb25kaXRpb24oKipjb25kKSkKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgc2VsZi5kYi5jbG9zZSgpCgogICAgZGVmIF9jcmVhdGVfY29uZGl0aW9uKHNlbGYsICoqY29uZCkgLT4gUXVlcnk6CiAgICAgICAgY29uZGl0aW9ucyA9IFsoc2VsZi5xdWVyeVtrZXldID09IHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBjb25kLml0ZW1zKCldCiAgICAgICAgcmV0dXJuIHJlZHVjZShsYW1iZGEgYSwgYjogYSAmIGIsIGNvbmRpdGlvbnMpCgoKY2xhc3MgU2Nhbm5pbmdRdWV1ZVNlcnZpY2U6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJvdmlkZXI9Tm9uZSk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gJ3NjYW5uaW5nX3F1ZXVlJwogICAgICAgIHNlbGYucHJvdmlkZXIgPSBwcm92aWRlciBvciBUaW55Tm9TUUxQcm92aWRlcih0YWJsZV9uYW1lPXNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgZ2V0X2RvY19zY2FubmluZ19xdWV1ZShzZWxmLCBpZF9kb2MpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0ge30KICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYykKCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICByZXN1bHRbcm93Wydyb3dfa2V5J11dID0gcm93WydxdHR5J10jIyBOT1QgV09SSwoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHNhdmVfc2Nhbm5lZF9yb3dfZGF0YShzZWxmLCBkYXRhLCBzZW50PUZhbHNlKTogICNUT0RPINCyINGC0LXRgdGC0Ysg0J7Qu9C10LMKICAgICAgICAjIGlkX2RvYywgcm93X2lkLCBxdHR5CiAgICAgICAgZGF0YVsnc2VudCddID0gc2VudAogICAgICAgIHNlbGYucHJvdmlkZXIuaW5zZXJ0KGRhdGE9ZGF0YSkKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5jb3VudChpZF9kb2M9ZGF0YVsnaWRfZG9jJ10pCgogICAgZGVmIGdldF9zY2FubmVkX3Jvd19xdHR5KHNlbGYsIGlkX2RvYywgcm93X2lkKToKICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYywgcm93X2lkPXJvd19pZCkKICAgICAgICByZXR1cm4gc3VtKFtyb3dbJ3F0dHknXSBmb3Igcm93IGluIGRhdGFdKSAgIyBvciAnZF9xdHR5JwoKICAgIGRlZiBnZXRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBzZW50PU5vbmUpIC0+IGxpc3Q6CiAgICAgICAgaWYgc2VudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgZGF0YSA9IHNlbGYucHJvdmlkZXIuc2VhcmNoKGlkX2RvYz1pZF9kb2MsIHNlbnQ9c2VudCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYykKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiB1cGRhdGVfc2VudF9saW5lcyhzZWxmLCBzZW50X2RhdGE6IGxpc3QsIHNlbnQ9VHJ1ZSk6CiAgICAgICAgZG9jX2lkX2xpc3QgPSBbeC5kb2NfaWQgZm9yIHggaW4gc2VudF9kYXRhXQogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGUudXBkYXRlKHsnc2VudCc6IHNlbnR9LCBkb2NfaWRzPWRvY19pZF9saXN0KQoKICAgIGRlZiBoYXNfdW5zZW50X2xpbmVzKHNlbGYsIGlkX2RvYykgLT4gYm9vbDoKICAgICAgICBxdHR5ID0gc2VsZi5wcm92aWRlci5jb3VudChpZF9kb2M9aWRfZG9jLCBzZW50PUZhbHNlKQogICAgICAgIHJldHVybiBUcnVlIGlmIHF0dHkgPiAwIGVsc2UgRmFsc2UKCiAgICBkZWYgcmVtb3ZlX2RvY19saW5lcyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHNlbGYucHJvdmlkZXIucmVtb3ZlKGlkX2RvYz1pZF9kb2MpCgoKY2xhc3MgRXhjaGFuZ2VRdWV1ZUJ1ZmZlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lLCApOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyID0gVGlueU5vU1FMUHJvdmlkZXIodGFibGVfbmFtZT1zZWxmLnRhYmxlX25hbWUpCgogICAgZGVmIHNhdmVfZGF0YV90b19zZW5kKHNlbGYsIGRhdGEsIHBrKToKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci51cHNlcnQoZGF0YT1kYXRhLCBwaz1waykKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5nZXRfYWxsKCkKCiAgICBkZWYgcmVtb3ZlX3NlbnRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBkb2NfaWRfbGlzdCA9IFt4LmRvY19pZCBmb3IgeCBpbiBkYXRhXQogICAgICAgIHNlbGYucHJvdmlkZXIucmVtb3ZlKGRvY19pZHM9ZG9jX2lkX2xpc3QpCgoKY2xhc3MgTm9TUUxQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lOiBzdHIpOgogICAgICAgIHNlbGYubm9zcWwgPSBub0NsYXNzKG5hbWUpCiAgICAgICAgc2VsZi5ub3NxbF9uYW1lID0gbmFtZQoKICAgIGRlZiBwdXQoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGtleTogc3RyLAogICAgICAgICAgICB2YWx1ZTogVW5pb25bc3RyLCBpbnQsIGJvb2wsIExpc3QsIERpY3QsIFR1cGxlXSwKICAgICAgICAgICAgcXVldWU6IGJvb2wgPSBUcnVlLAogICAgICAgICAgICB0b19qc29uOiBib29sID0gRmFsc2UKICAgICkgLT4gTm9uZToKICAgICAgICAiIiIKICAgICAgICDQn9C+0LzQtdGJ0LDQtdGCINC30L3QsNGH0LXQvdC40LUg0LIg0YPQutCw0LfQsNC90L3Ri9C5INC60LvRjtGHLgogICAgICAgIHN0ciwgaW50LCBib29sIC0g0L/QvtC80LXRidCw0LXQvCDQutCw0Log0LXRgdGC0YwKICAgICAgICBsaXN0LCBkaWN0LCB0dXBsZSAtINC/0YDQtdC+0LHRgNCw0LfQvtCy0YvQstCw0LXQvCDQsiDRgdGC0YDQvtC60YMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoa2V5LCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ9Ca0LvRjtGHIE5vU1FMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRgdGC0YDQvtC60L7QuScpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgKHN0ciwgaW50LCBib29sKSk6CiAgICAgICAgICAgIHNlbGYubm9zcWwucHV0KGtleSwgdmFsdWUsIHF1ZXVlKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBub3QgdG9fanNvbjoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCfQodC/0LjRgdC+0Log0LTQvtC/0YPRgdGC0LjQvNGL0YUg0YLQuNC/0L7QsiBOb1NRTDogc3RyLCBpbnQsIGJvb2wnKQogICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIChMaXN0LCBEaWN0LCBUdXBsZSkpOgogICAgICAgICAgICBzZWxmLm5vc3FsLnB1dChrZXksIGpzb24uZHVtcHModmFsdWUpLCBxdWV1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZidOb1NRTC4g0J3QtdC70YzQt9GPINGB0LXRgNC40LDQu9C40LfQvtCy0LDRgtGMIHt0eXBlKHZhbHVlKX0nKQoKICAgIGRlZiBnZXQoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGtleTogc3RyLAogICAgICAgICAgICBkZWZhdWx0OiBPcHRpb25hbFtBbnldID0gTm9uZSwKICAgICAgICAgICAgZnJvbV9qc29uOiBib29sID0gRmFsc2UKICAgICkgLT4gQW55OgogICAgICAgICIiItCf0L7Qu9GD0YfQsNC10YIg0LfQvdCw0YfQtdC90LjQtSDQv9C+INC60LvRjtGH0YMiIiIKICAgICAgICByZXN1bHQgPSBzZWxmLm5vc3FsLmdldChrZXkpCiAgICAgICAgaWYgcmVzdWx0IGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gcmVzdWx0IGlmIG5vdCBmcm9tX2pzb24gZWxzZSBqc29uLmxvYWRzKHJlc3VsdCkKICAgICAgICByZXR1cm4gcmVzdWx0IGlmIG5vdCBkZWZhdWx0IGVsc2UgZGVmYXVsdAoKICAgIGRlZiBkZWxldGUoc2VsZiwga2V5OiBzdHIpIC0+IE5vbmU6CiAgICAgICAgIiIi0KPQtNCw0LvRj9C10YIg0LrQu9GO0YciIiIKICAgICAgICBzZWxmLm5vc3FsLmRlbGV0ZShrZXkpCgogICAgZGVmIGRlc3Ryb3koc2VsZikgLT4gTm9uZToKICAgICAgICAiIiLQo9C90LjRh9GC0L7QttCw0LXRgiDQstGB0LUg0LrQu9GO0YfQuCDQsdCw0LfRiyIiIgogICAgICAgIHNlbGYubm9zcWwuZGVzdHJveSgpCgogICAgZGVmIGdldF9hbGxfa2V5cyhzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIi0J/QvtC70YPRh9C40YLRjCDRgdC/0LjRgdC+0Log0LLRgdC10YUg0LrQu9GO0YfQtdC5INCx0LDQt9GLINCyINCy0LjQtNC1INGB0YLRgNC+0LrQuCDRhNC+0YDQvNCw0YLQsCBKU09OLdC80LDRgdGB0LjQstCwINGB0YLRgNC+0LoiIiIKICAgICAgICByZXR1cm4gc2VsZi5ub3NxbC5nZXRhbGxrZXlzKCkKCiAgICBkZWYgZmluZF9qc29uKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBmaWVsZDogc3RyLAogICAgICAgICAgICB2YWx1ZTogQW55LAogICAgICAgICAgICBpbmRleF9uYW1lOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAg0JzQtdC00LvQtdC90L3Ri9C5INC/0L7QuNGB0Log0YHRgNC10LTQuCDQstGB0LXRhSDQvtCx0YrQtdC60YLQvtCyINCx0LDQt9GLINC60L7RgtC+0YDRi9C1INC40LzQtdGO0YIg0YLQuNC/IEpTT04KICAgICAgICDQuCDQsiDQv9C+0LvQtSDQutC+0YLQvtGA0YvRhSDQtdGB0YLRjCDQt9C90LDRh9C10L3QuNC1LiDQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMg0YEgSlNPTi3QvNCw0YHRgdC40LLQvtC8CiAgICAgICAg0L3QsNC50LTQtdC90L3Ri9GFINC+0LHRitC10LrRgtC+0LIuCiAgICAgICAg0JXRgdC70Lgg0LIg0LHQsNC30LUg0LzQvdC+0LPQviDQt9C90LDRh9C10L3QuNC5IC0g0LvRg9GH0YjQtSDQuNGB0L/QvtC70YzQt9C+0LLRgtCw0Ywg0L/QvtC40YHQuiDRgSDQuNC90LTQtdC60YHQvtC8LgogICAgICAgICIiIgogICAgICAgIGlmIGluZGV4X25hbWU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm5vc3FsLmZpbmRKU09OX2luZGV4KGluZGV4X25hbWUsIGZpZWxkLCB2YWx1ZSkKICAgICAgICByZXR1cm4gc2VsZi5ub3NxbC5maW5kSlNPTihmaWVsZCwgdmFsdWUpCgogICAgZGVmIHJ1bl9pbmRleChzZWxmLCBpbmRleDogc3RyLCBmaWVsZDogc3RyKSAtPiBOb25lOgogICAgICAgICIiIgogICAgICAgINCh0L7Qt9C00LDQvdC40LUg0LjQvdC00LXQutGB0LAg0L/QviBKU09OLdC+0LHRitC10LrRgtCw0Lwg0LTQu9GPINC00LDQu9GM0L3QtdC50YjQtdCz0L4g0LjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40Y8g0LTQu9GPINC/0L7QuNGB0LrQsC4KICAgICAgICDQodC+0LfQtNCw0LXRgiwg0LDRgdC40L3RhdGA0L7QvdC90L3QviDQuNC90LTQtdC60YEsINGB0L7RgdGC0L7Rj9GJ0LjQuSDQuNC3INC+0LHRitC10LrRgtC+0LIg0YEg0YPQutCw0LfQsNC90L3Ri9C8INC/0L7Qu9C10LwuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5ub3NxbC5ydW5faW5kZXgoaW5kZXgsIGZpZWxkKQoKICAgIGRlZiBrZXlzKHNlbGYpIC0+IExpc3Rbc3RyXToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhzZWxmLm5vc3FsLmdldGFsbGtleXMoKSkKCiAgICBkZWYgaXRlbXMoc2VsZikgLT4gTGlzdFtUdXBsZVtzdHIsIE9wdGlvbmFsW3N0cl1dXToKICAgICAgICByZXR1cm4gWyhrZXksIHNlbGYubm9zcWwuZ2V0KGtleSkpIGZvciBrZXkgaW4gc2VsZi5rZXlzKCldCgoKY2xhc3MgTG9nZ2VyU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcm92aWRlcj1Ob25lKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSAiRXJyb3JMb2ciCiAgICAgICAgc2VsZi5wcm92aWRlciA9IHByb3ZpZGVyIG9yIFRpbnlOb1NRTFByb3ZpZGVyKHRhYmxlX25hbWU9c2VsZi50YWJsZV9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlX25hbWU9J1NpbXBsZUxvZ2dlcicpCgogICAgZGVmIHdyaXRlX3RvX2xvZyhzZWxmLCBlcnJvcl90ZXh0LCAqKmt3YXJncyk6CgogICAgICAgIGRhdGEgPSB7InRpbWVzdGFtcCI6IERhdGVGb3JtYXQuZ2V0X25vd19ub3NxbF9mb3JtYXQoKSwKICAgICAgICAgICAgICAgICJlcnJvcl90eXBlIjoga3dhcmdzLmdldCgnZXJyb3JfdHlwZScpIG9yICcnLAogICAgICAgICAgICAgICAgImVycm9yX3RleHQiOiBlcnJvcl90ZXh0LAogICAgICAgICAgICAgICAgImVycm9yX2luZm8iOiBrd2FyZ3MuZ2V0KCdlcnJvcl9pbmZvJykgb3IgJyd9CgogICAgICAgIHNlbGYucHJvdmlkZXIuaW5zZXJ0KGRhdGEpCgogICAgZGVmIGdldF9hbGxfZXJyb3JzKHNlbGYsIGRlc2Nfc29ydCk6CiAgICAgICAgYWxsX2Vycm9ycyA9IHNvcnRlZChzZWxmLnByb3ZpZGVyLmdldF9hbGwoKSwga2V5PWxhbWJkYSBrOiBrWyd0aW1lc3RhbXAnXSwgcmV2ZXJzZT1kZXNjX3NvcnQpCiAgICAgICAgcmV0dXJuIGFsbF9lcnJvcnMKCiAgICBkZWYgY2xlYXIoc2VsZik6CiAgICAgICAgc2VsZi5wcm92aWRlci5kYi50YWJsZShzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUpLnRydW5jYXRlKCkK"
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\static_data.py",
                "PyFileKey": "static_data",
                "PyFileData": "c25faWNvbl9ncmVlbiA9ICdBQUFCQUFFQUdCZ0FBQUVBSUFBb0NRQUFGZ0FBQUNnQUFBQVlBQUFBTUFBQUFBRUFJQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy85Ly8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vLy8vLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vLzIvLy8vLy8vLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vLy8vLy84di8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1mLy8vOFQvLy8vKy8vLy8zdi8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbWYvLy8vUC8vLy90Ly8vL3IvLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWi8vLy93di8vLy8vLy8vKzAvLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaLy8vLzcvLy8vKzcvLy85YS8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaLy8vLzBmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUpuLy8vKzAvLy8vLy8vLy83d0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSm4vLy8vdS8vLy84Ly8vLzJvQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vNC8vLy81Z0NNQUprQWpBQ1pBSXdBbWYvLy8vNy8vLy9GQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbWYvLy83TC8vLy8rLy8vL3dnQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbWYvLy81ei8vLy8vQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vL2YvLy8vTlFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVi8vLy9VZi8vLytuLy8vLzAvLy8vYmdDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtZi8vLzV6Ly8vLy9BSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSm4vLy8vay8vLy9RZ0NNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WLy8vL3FmLy8vLzcvLy8vTEFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1mLy8vNXovLy8vL0FJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKbi8vLy9mLy8vL05RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL2UvLy8vNlAvLy8vZi8vLzk1QUl3QW1RQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKbi8vLy8yLy8vLzVnQ01BSmtBakFDWkFJd0FtZi8vLy83Ly8vL0ZBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vOS8vLy8vdi8vLzg0QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy8vLy8vLytmLy8vNElBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWi8vLy96Zi8vLy96Ly8vLysvLy8vN2YvLy80OEFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKaz0nCnNuX2ljb25fcmVkID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vLzkvLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vLy8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vMi8vLy8vLy8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9BQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1ovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1ovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDhBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNW4vLy8rMC8vLy8vLy8vLzd3QUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81bi8vLy91Ly8vLzgvLy8vMm9BQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy80Ly8vLzVnQUEvNWtBQVArWkFBRC9tZi8vLy83Ly8vL0ZBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tZi8vLzdMLy8vLysvLy8vd2dBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tZi8vLzV6Ly8vLy9BQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vZi8vLy9OUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9iZ0FBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21mLy8vNXovLy8vL0FBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81bi8vLy9rLy8vL1FnQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbWYvLy81ei8vLy8vQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVuLy8vL2YvLy8vTlFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVBQUQvbVFBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVuLy8vLzIvLy8vNWdBQS81a0FBUCtaQUFEL21mLy8vLzcvLy8vRkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODRBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80SUFBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrPScKc25faWNvbl9ncmF5ID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vLzkvLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vLy8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vMi8vLy8vLy8vLy8vLy8vKzhabVptbVdabVpwbi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9abVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDltWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acG4vLy8rMC8vLy8vLy8vLzd4bVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbi8vLy91Ly8vLzgvLy8vMnBtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbi8vLy80Ly8vLzVtWm1acGxtWm1hWlptWm1tZi8vLy83Ly8vL0ZabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tZi8vLzdMLy8vLysvLy8vd21abVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tZi8vLzV6Ly8vLy9abVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vZi8vLy9OV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9ibVptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1mLy8vNXovLy8vL1ptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbi8vLy9rLy8vL1FtWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbWYvLy81ei8vLy8vWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBuLy8vL2YvLy8vTldabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVabVptbVdabVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBuLy8vLzIvLy8vNW1abVpwbG1abWFaWm1abW1mLy8vLzcvLy8vRlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODVtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80Sm1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ5bVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBrPScKbWFya19ncmVlbj0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVY1SlJFRlVPRStsVWlGTXcxQVF2ZjYxV1Nab3dsQUVDSE1zeTRKREROVjZIRmtnd1NFSURzTU1RU0J3S053VWpnUThFNmpXUVRLTEtHNkNEZ0diNk5Ld01aYnkzNVhyRnV5ZXViNS85MTdldjM2ajluaWEwQnd3V21FN3VYeTVwN0s5bXA1b3U1dmFDUm1Ha2ZJL0pFbENoMC9YV3BIeUlIcWo4K29lcWZldmZuWVFSQ0hsbGNtOEdiVEljUndXb2dMb1lRYXpBTFE1dFZ1K2lIK0duR0RUTHRGMmNZTXFpK3ZVcUIrUjUzbmt1aTVYWVBnOW9rSXVUM25Ub3M5UlJGMXRvQkFEZ09za21WQnZQR0FPaUJnVlFBOHprb0N2Y052eG1TQkJ4VjZqSld1QitYNnp3VlhFQUhxWWtYMUJxL2hMQTY0Zk9wWWt1RHUreXFKTFJROHprZ0JRQjZWMFFYQzFsSlVsbUlXa1FBOHprZ0JhaFY4SXdQVzUvNW9sK0w5QUFEM01TQUpvMWM3S0ZoTzQ0amYxeGpIejJRVk9yeER6akNTQTFsd3VGSm1JYXpBSTZheGFKOS8zczhlRWl2ZncwRzFyTm4yNDBNNzVsSWwrQWJSR3NIdGM1a296QUFBQUFFbEZUa1N1UW1DQyIKbWFya19waW5rPSJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBTUNBWUFBQUJyNXoyQkFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFEc1FBQUE3RUFaVXJEaHNBQUFVYmFWUllkRmhOVERwamIyMHVZV1J2WW1VdWVHMXdBQUFBQUFBOFAzaHdZV05yWlhRZ1ltVm5hVzQ5SXUrN3Z5SWdhV1E5SWxjMVRUQk5jRU5sYUdsSWVuSmxVM3BPVkdONmEyTTVaQ0kvUGlBOGVEcDRiWEJ0WlhSaElIaHRiRzV6T25nOUltRmtiMkpsT201ek9tMWxkR0V2SWlCNE9uaHRjSFJyUFNKQlpHOWlaU0JZVFZBZ1EyOXlaU0EyTGpBdFl6QXdNaUF4TVRZdU1UWTBOelkyTENBeU1ESXhMekF5THpFNUxUSXpPakV3T2pBM0lDQWdJQ0FnSUNBaVBpQThjbVJtT2xKRVJpQjRiV3h1Y3pweVpHWTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1Rrdk1ESXZNakl0Y21SbUxYTjViblJoZUMxdWN5TWlQaUE4Y21SbU9rUmxjMk55YVhCMGFXOXVJSEprWmpwaFltOTFkRDBpSWlCNGJXeHVjenA0YlhBOUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOGlJSGh0Ykc1ek9tUmpQU0pvZEhSd09pOHZjSFZ5YkM1dmNtY3ZaR012Wld4bGJXVnVkSE12TVM0eEx5SWdlRzFzYm5NNmNHaHZkRzl6YUc5d1BTSm9kSFJ3T2k4dmJuTXVZV1J2WW1VdVkyOXRMM0JvYjNSdmMyaHZjQzh4TGpBdklpQjRiV3h1Y3pwNGJYQk5UVDBpYUhSMGNEb3ZMMjV6TG1Ga2IySmxMbU52YlM5NFlYQXZNUzR3TDIxdEx5SWdlRzFzYm5NNmMzUkZkblE5SW1oMGRIQTZMeTl1Y3k1aFpHOWlaUzVqYjIwdmVHRndMekV1TUM5elZIbHdaUzlTWlhOdmRYSmpaVVYyWlc1MEl5SWdlRzF3T2tOeVpXRjBiM0pVYjI5c1BTSkJaRzlpWlNCUWFHOTBiM05vYjNBZ01qRXVNaUFvVFdGamFXNTBiM05vS1NJZ2VHMXdPa055WldGMFpVUmhkR1U5SWpJd01qRXRNRGd0TVRCVU1UQTZOVFU2TlRNck1ETTZNREFpSUhodGNEcE5iMlJwWm5sRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUI0YlhBNlRXVjBZV1JoZEdGRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUJrWXpwbWIzSnRZWFE5SW1sdFlXZGxMM0J1WnlJZ2NHaHZkRzl6YUc5d09rTnZiRzl5VFc5a1pUMGlNeUlnY0dodmRHOXphRzl3T2tsRFExQnliMlpwYkdVOUluTlNSMElnU1VWRE5qRTVOall0TWk0eElpQjRiWEJOVFRwSmJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdlRzF3VFUwNlJHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlJSGh0Y0UxTk9rOXlhV2RwYm1Gc1JHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlQaUE4ZUcxd1RVMDZTR2x6ZEc5eWVUNGdQSEprWmpwVFpYRStJRHh5WkdZNmJHa2djM1JGZG5RNllXTjBhVzl1UFNKamNtVmhkR1ZrSWlCemRFVjJkRHBwYm5OMFlXNWpaVWxFUFNKNGJYQXVhV2xrT21GbE9USmlZakptTFRGa09UTXRORFprTkMxaU9XUTVMV0U1WldReU16SXhaRGhtWmlJZ2MzUkZkblE2ZDJobGJqMGlNakF5TVMwd09DMHhNRlF4TURvMU5UbzFNeXN3TXpvd01DSWdjM1JGZG5RNmMyOW1kSGRoY21WQloyVnVkRDBpUVdSdlltVWdVR2h2ZEc5emFHOXdJREl4TGpJZ0tFMWhZMmx1ZEc5emFDa2lMejRnUEM5eVpHWTZVMlZ4UGlBOEwzaHRjRTFOT2tocGMzUnZjbmsrSUR3dmNtUm1Pa1JsYzJOeWFYQjBhVzl1UGlBOEwzSmtaanBTUkVZK0lEd3ZlRHA0YlhCdFpYUmhQaUE4UDNod1lXTnJaWFFnWlc1a1BTSnlJajgramxiSzBnQUFBVWhKUkVGVU9FK2xrckZLdzJBVWhXOSt0VlNrb0ZCZE9sa0ZSOGxveVZCOEFVR2NmWUhhWFhBVzNCeWlnNnV6Q0w1QTdWQmNvK0JTcEc1ZEpOS2lGcXFVeG56WDNsQmNleURjLytTY2MzTVM0ajBmWENVeUE3emVmVHZwWGpZbFh5NU83b2hzbk8xTEVBUi9mSUpXcXlXZDQxdVJ5ZU9HcjdHVWFsVnhQMitmMlkzdjlKTGNuUEtiMnJuNHZxOUJwaUxWOE9BRlpGMi8wVlpDZzZXZGRTbFV5c3BQSDY0bERFT3AxK3M2QVJvZWEwdldsWTZxU3RpYWpCTVo5NGJLZ1lXWkFBMlBOU0RyNHJzbkpXeGQzRndWdDVKWGZsSTUxR2xoZ0liSEdwQjFla3JCMXRIN0lHdGdyd0Jzb3VHeEJzQVY5N2Ixd0ZhMzRHVU5wbUV0MFBCWUE3S3VlOUZVd3RiQll6ZHI4UDhEQWpRODFvQ3NXOTdkVXNKV0x6Y3ZvLzZYOHVrUGFFdlE4RmdEc2k2M1ZsREMxbUVubG8vR2kvSW9pdlJuc2duUThGZ0RzalAreWlLL0dWQ3dxRnVUaDl3QUFBQUFTVVZPUks1Q1lJST0iCm1hcmtfYmx1ZT0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVR4SlJFRlVPRStsa3I5S3cyQVV4VysrS2tJR3JRNWFFQlFYZGNtUVJSejZCRG83K3dUQjNRY29ycElYMExtejRnTmtFQWNEWm5MeUR4WkVpQ2pTUUcwaCtydm1odURhQStIbWZPZWN5OGxIdkpPcjIxS21nSmNOOHZJaWU1TE9nbDhkaVJ6dWJrbTMyNjNZSDVJa2tmUHIrNHFKdkg0V3NoK3NpL3NvUnZVQlQ4dnpsUGZPK2hLR29RYVpBTTE4Z0t6TEJ1OUthTEM1MHBidHpxTHkvbWxQNGppV0tJcDBBalE4MXBhczJ3dldsTEMxTEVzcHhoUGx3TUpNZ0liSEdwQjFOdzl2U3RqYW1mZkZuNTFSZm5CMHJOUENBQTJQTlNEcjlPMFhiQjErVCtvRzlnbkFKaG9lYXdEY3pzYXl2ckMxNWJ5NlFSUFdBZzJQTlNEckxyTm5KV3g5ekwvcUJ2OHZFS0Roc1Faa1hiQzZwTVFhREVkajVjMEx0Q1ZvelFaa1hkdWZVOEpXbnJ1WFhIbWFwdm96MlFSbzVnTmtwL3lWUlg0QTZQdXdyalh5NkZJQUFBQUFTVVZPUks1Q1lJST0iCg=="
            },
            {
                "file_path": "D:/projects/simple UI/keep/sui_keep_0_1_0_8_1\\sm_adr_docs.py",
                "PyFileKey": "sm_adr_docs",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QKCmltcG9ydCBkYl9zZXJ2aWNlcwppbXBvcnQgd2lkZ2V0cwppbXBvcnQgdWlfbW9kZWxzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKZnJvbSBiYXJjb2RlX3dvcmtlcnMgaW1wb3J0IEJhcmNvZGVBZHJXb3JrZXIKCgpjbGFzcyBBZHJEb2NzTGlzdFNjcmVlbih1aV9tb2RlbHMuRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CQ0LTRgNC10YHQvdC+0LUg0YXRgNCw0L3QtdC90LjQtScKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzPU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5kb2NfdHlwZXMgPSAoJ9CS0YHQtScsICfQntGC0LHQvtGAJywgJ9Cg0LDQt9C80LXRidC10L3QuNC1JywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnKQogICAgICAgIHNlbGYuZG9jX3N0YXR1c2VzID0gKCfQktGB0LUnLCAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nLCAn0JLRi9Cz0YDRg9C20LXQvScsICfQmiDQstGL0LPRgNGD0LfQutC1JykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICgn0KPQtNCw0LvQuNGC0YwnLCAn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJywgJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JykKICAgICAgICBzZWxmLmN1cnJlbnRfc3RhdHVzID0gJ9CS0YHQtScKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSAn0JLRgdC1JwogICAgICAgIHNlbGYubGlzdF9kYXRhX2tleSA9ICdkb2N1bWVudHNfbGlzdCcKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX2Fkcl90eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oc2VsZi5kb2NfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3N0YXR1c19zZWxlY3QnXSA9ICc7Jy5qb2luKHNlbGYuZG9jX3N0YXR1c2VzKQogICAgICAgIHNlbGYuX2ZpbGxfdGFibGVfZGF0YSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5fZmlsbF90YWJsZV9kYXRhKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2ssCiAgICAgICAgICAgICdkb2NfYWRyX3R5cGVfY2xpY2snOiBzZWxmLl9kb2NfdHlwZV9zZWxlY3QsCiAgICAgICAgICAgICdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YSc6IGxhbWJkYTogc2VsZi5fY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYuZ2V0X2lkX2RvYygpKSwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShzZWxmLmxpc3RfZGF0YV9rZXkpCiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIEFkckRvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgaWRfZG9jPWlkX2RvYykuc2hvdygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX2RvY190eXBlX3NlbGVjdChzZWxmKToKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfYWRyX3R5cGVfY2xpY2snXQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKSAtPiBOb25lOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xheW91dF9saXN0ZW5lciddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDQtNC+0LrRg9C80LXQvdGCINGBINGD0YHRgtGA0L7QudGB0YLQstCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX3Jlc2VuZF9kb2MnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4/JwogICAgICAgICAgICApCgogICAgZGVmIF9maWxsX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5fZ2V0X2RvY19saXN0X2RhdGEoc2VsZi5jdXJyZW50X2RvY190eXBlLCBzZWxmLmN1cnJlbnRfc3RhdHVzKQogICAgICAgIHByZXBhcmVkX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEobGlzdF9kYXRhKQogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldygKICAgICAgICAgICAgcHJlcGFyZWRfZGF0YSwKICAgICAgICAgICAgcG9wdXBfbWVudV9kYXRhPSc7Jy5qb2luKHNlbGYucG9wdXBfbWVudV9kYXRhKQogICAgICAgICkKICAgICAgICBzZWxmLmhhc2hfbWFwW3NlbGYubGlzdF9kYXRhX2tleV0gPSBkb2NfY2FyZHMudG9fanNvbigpCgogICAgZGVmIF9nZXRfZG9jX2xpc3RfZGF0YShzZWxmLCBkb2NfdHlwZSwgZG9jX3N0YXR1cykgLT4gbGlzdDoKICAgICAgICBkb2NfdHlwZSA9ICcnIGlmIGRvY190eXBlID09ICLQktGB0LUiIGVsc2UgZG9jX3R5cGUKICAgICAgICBkb2Nfc3RhdHVzID0gJycgaWYgZG9jX3N0YXR1cyA9PSAn0JLRgdC1JyBlbHNlIGRvY19zdGF0dXMKCiAgICAgICAgZG9jc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfdmlld19kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQogICAgICAgIHJldHVybiBkb2NzX2RhdGEKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBsaXN0X2RhdGEpIC0+IGxpc3Q6CiAgICAgICAgdGFibGVfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBsaXN0X2RhdGE6CiAgICAgICAgICAgIGRvY19zdGF0dXMgPSAnJwoKICAgICAgICAgICAgaWYgcmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0JLRi9Cz0YDRg9C20LXQvScKICAgICAgICAgICAgZWxpZiByZWNvcmRbJ3ZlcmlmaWVkJ106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQs9GA0YPQt9C60LUnCiAgICAgICAgICAgIGVsaWYgbm90IChyZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddKToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nCgogICAgICAgICAgICBkb2NfdGl0bGUgPSAne30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgcmVjb3JkWydkb2NfbiddLCBzZWxmLl9mb3JtYXRfZGF0ZShyZWNvcmRbJ2RvY19kYXRlJ10pKQoKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAnZG9jX3R5cGUnOiByZWNvcmRbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICAgICAnZG9jX3RpdGxlJzogZG9jX3RpdGxlLAogICAgICAgICAgICAgICAgJ2RvY19uJzogcmVjb3JkWydkb2NfbiddLAogICAgICAgICAgICAgICAgJ2RvY19kYXRlJzogc2VsZi5fZm9ybWF0X2RhdGUocmVjb3JkWydkb2NfZGF0ZSddKSwKICAgICAgICAgICAgICAgICd3YXJlaG91c2UnOiByZWNvcmRbJ3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IHJlY29yZFsnYWRkX21hcmtfc2VsZWN0aW9uJ10sCiAgICAgICAgICAgICAgICAnc3RhdHVzJzogZG9jX3N0YXR1cwogICAgICAgICAgICB9KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGEsIHBvcHVwX21lbnVfZGF0YSk6CiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc3RhdHVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY190eXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfZGVsZXRlIiwKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jX24nLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B3YXJlaG91c2UnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9kb2NfZGVsZXRlKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmVzdWx0ID0gVHJ1ZQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRlbGV0ZV9hZHJfZG9jKGlkX2RvYykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGUuYXJnc1swXSkKICAgICAgICAgICAgcmVzdWx0ID0gRmFsc2UKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoc2VsZiwgcHV0X2RhdGE9Tm9uZSk6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCgogICAgICAgIHRhYmxlX3R5cGUgPSAnb3V0JyBpZiBjYXJkX2RhdGFbJ2RvY190eXBlJ10gaW4gWyfQntGC0LHQvtGAJywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnXSBlbHNlICdpbicKCiAgICAgICAgcHV0X2RhdGEgPSBwdXRfZGF0YSBvciB7fQogICAgICAgIHB1dF9kYXRhWydpZF9kb2MnXSA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICBwdXRfZGF0YVsnZG9jX3R5cGUnXSA9IGNhcmRfZGF0YVsnZG9jX3R5cGUnXQogICAgICAgIHB1dF9kYXRhWyd0YWJsZV90eXBlJ10gPSB0YWJsZV90eXBlCiAgICAgICAgcHV0X2RhdGFbJ2RvY19uJ10gPSBjYXJkX2RhdGFbJ2RvY19uJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX2RhdGUnXSA9IGNhcmRfZGF0YVsnZG9jX2RhdGUnXQogICAgICAgIHB1dF9kYXRhWydkb2NfdGl0bGUnXSA9IGNhcmRfZGF0YVsnZG9jX3RpdGxlJ10KICAgICAgICBwdXRfZGF0YVsnd2FyZWhvdXNlJ10gPSBjYXJkX2RhdGFbJ3dhcmVob3VzZSddCgogICAgICAgIHJldHVybiBwdXRfZGF0YQoKICAgIGRlZiBjb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikKICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCgogICAgICAgIGlmIHNlbGYuZG9jX2RlbGV0ZShpZF9kb2MpOgogICAgICAgICAgICBkb2NzX2NvdW50ID0gc2VsZi5nZXRfZG9jc19jb3VudChkb2NfdHlwZT1kb2NfdHlwZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDRg9GB0L/QtdGI0L3QviDRg9C00LDQu9GR0L0nKQogICAgICAgICAgICBpZiBkb2NzX2NvdW50OgogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGD0LTQsNC70LXQvdC40Y8g0LTQvtC60YPQvNC10L3RgtCwJykKCiAgICBkZWYgX2NsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ2NhcmRfZGF0YScpLmdldCgna2V5JykgaWYgc2VsZi5oYXNoX21hcFsnY2FyZF9kYXRhJ10gZWxzZSAnJwogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKCiAgICBkZWYgZ2V0X2lkX2RvYyhzZWxmKToKICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKCmNsYXNzIEFkckRvY0RldGFpbHNTY3JlZW4odWlfbW9kZWxzLkRvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JDQtNGA0LXRgdC90L7QtSDRhdGA0LDQvdC10L3QuNC1JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgaWRfZG9jLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwPWhhc2hfbWFwKQogICAgICAgIHNlbGYudGFibGVzX3R5cGVzID0gJ9Ce0YLQsdC+0YA70KDQsNC30LzQtdGJ0LXQvdC40LUnCiAgICAgICAgc2VsZi5pZF9kb2MgPSBpZF9kb2MKICAgICAgICBzZWxmLnNlcnZpY2UgPSBOb25lCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSAnJwogICAgICAgIHNlbGYuY3VycmVudF9jZWxsX2lkID0gJycKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3RpdGxlID0gJycKICAgICAgICBzZWxmLmRvY19kYXRhID0ge30KICAgICAgICBzZWxmLmxpc3RfZGF0YV9rZXkgPSAnZG9jX2dvb2RzX3RhYmxlJwogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuaGFzaF9tYXBfa2V5cyA9IFtdCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoaWRfZG9jPXNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuZG9jX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kYXRhX2J5X2lkKCkKCiAgICAgICAgc2VsZi5kb2NfdHlwZSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5kb2NfdHlwZSkKICAgICAgICBzZWxmLnNlcnZpY2UudGFibGVfdHlwZSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfZGF0ZSddID0gc2VsZi5fZm9ybWF0X2RhdGUoc2VsZi5kb2NfZGF0YVsnZG9jX2RhdGUnXSkKICAgICAgICBzZWxmLmRvY190aXRsZSA9ICd7ZG9jX3R5cGV9IOKEliB7ZG9jX259INC+0YIge2RvY19kYXRlfScuZm9ybWF0KAogICAgICAgICAgICAqKnNlbGYuZG9jX2RhdGEKICAgICAgICApCgogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlc190eXBlJ10gPSBzZWxmLnRhYmxlc190eXBlcwogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlX3R5cGUnXSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfdGl0bGUnXSA9IHNlbGYuZG9jX3RpdGxlCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoc2VsZi5kb2NfZGF0YSwgZmlsbF9ub25lPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljaywKICAgICAgICAgICAgJ2J0bl9iYXJjb2Rlcyc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZyhsaXN0ZW5lcj0i0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpLAogICAgICAgICAgICAnYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKSksCiAgICAgICAgICAgICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOiBzZWxmLl9kb2NfbWFya192ZXJpZmllZCwKICAgICAgICAgICAgJ2J0bl9zZWxlY3RfY2VsbCc6IHNlbGYuX3NlbGVjdF9jZWxsLAogICAgICAgICAgICAnY2VsbF9zZWxlY3Rfc3VjY2Vzcyc6IHNlbGYuX3NlbGVjdF9jZWxsX3Jlc3VsdCwKICAgICAgICAgICAgJ2J0bl9jbGVhcl9jZWxsJzogc2VsZi5fY2xlYXJfY2VsbCwKICAgICAgICAgICAgJ3RhYmxlX3R5cGUnOiBzZWxmLl90YWJsZV90eXBlX3NlbGVjdGVkLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdCQUNLX0JVVFRPTic6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9CS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQnKToKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwWydmbGRfYmFyY29kZSddKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkX2NhcmRfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKHNlbGYubGlzdF9kYXRhX2tleSkKICAgICAgICBpZiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gJzEnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9vcGVuX3NlbGVjdF9nb29kc19zY3JlZW4oZGF0YT1zZWxlY3RlZF9jYXJkX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9iYXJjb2RlX2xpc3RlbmVyKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIHNlbGYuX3VwZGF0ZV9jdXJyZW50X2NlbGwoYmFyY29kZSk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zID0gc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKQogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ2lzX2Fkcl9kb2MnXSA9IFRydWUKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zWydpZF9jZWxsJ10gPSBzZWxmLmN1cnJlbnRfY2VsbF9pZAogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ3RhYmxlX3R5cGUnXSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gQmFyY29kZUFkcldvcmtlcigKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAqKmJhcmNvZGVfcHJvY2Vzc19wYXJhbXMsCiAgICAgICAgICAgIHVzZV9zY2FubmluZ19xdWV1ZT1GYWxzZQogICAgICAgICkKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX3VwZGF0ZV9jdXJyZW50X2NlbGwoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgY3VycmVudF9jZWxsID0gc2VsZi5jdXJyZW50X2NlbGxfaWQKICAgICAgICBkb2NfY2VsbCA9IHNlbGYuc2VydmljZS5maW5kX2NlbGwoYmFyY29kZSkKCiAgICAgICAgaWYgZG9jX2NlbGwgYW5kIGN1cnJlbnRfY2VsbCAhPSBkb2NfY2VsbDoKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbChkb2NfY2VsbFsnbmFtZSddLCBkb2NfY2VsbFsnaWQnXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnd2FybmluZycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsICfQndC1INC90LDQudC00LXQvdCwINGP0YfQtdC50LrQsCcpCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShzZWxmLCBzY2FuX3Jlc3VsdCk6CiAgICAgICAgaWYgc2Nhbl9yZXN1bHQuZXJyb3IgPT0gJ3VzZV9zZXJpZXMnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2Nhbl9yZXN1bHQucm93X2tleSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3dhcm5pbmcnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgogICAgZGVmIF9kb2NfbWFya192ZXJpZmllZChzZWxmKToKICAgICAgICBzZWxmLnNlcnZpY2UubWFya192ZXJpZmllZCgpCiAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIEFkckRvY3NMaXN0U2NyZWVuKHNlbGYuaGFzaF9tYXApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGwoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIHNlbGYuX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKCkKCiAgICBkZWYgX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKHNlbGYpOgogICAgICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RJdGVtU2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICB0YWJsZV9uYW1lPSdSU19jZWxscycsCiAgICAgICAgICAgIHJlc3VsdF9saXN0ZW5lcj0nY2VsbF9zZWxlY3Rfc3VjY2VzcycKICAgICAgICApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGxfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGVjdGVkX2NlbGwgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKHNlbGVjdGVkX2NlbGwuZ2V0KCduYW1lJyksIHNlbGVjdGVkX2NlbGwuZ2V0KCdpZCcpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCgogICAgZGVmIF9jbGVhcl9jZWxsKHNlbGYpOgogICAgICAgIHNlbGYuX3NldF9jdXJyZW50X2NlbGwoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfdGFibGVfdHlwZV9zZWxlY3RlZChzZWxmKToKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5oYXNoX21hcFsndGFibGVfdHlwZSddKQogICAgICAgIHNlbGYuc2VydmljZS50YWJsZV90eXBlID0gc2VsZi50YWJsZV90eXBlCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCgogICAgICAgIGlmIHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICAgICAgQWRyRG9jc0xpc3RTY3JlZW4oc2VsZi5oYXNoX21hcCkuc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VzZV9hZHJfZG9jc190YWJsZXMnXSA9IFRydWUKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgfQoKICAgICAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX3ZhbHVlcykKCiAgICBkZWYgX29wZW5fc2VsZWN0X2dvb2RzX3NjcmVlbihzZWxmLCBkYXRhKToKICAgICAgICBkb2Nfcm93X2lkID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIHNjcmVlbiA9IEFkckdvb2RzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXAsIGRvY19yb3dfaWQ9ZG9jX3Jvd19pZCkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHN1cGVyKCkuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCgogICAgICAgIGRhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX2RhdGEoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgY2VsbD1zZWxmLmN1cnJlbnRfY2VsbF9pZCwKICAgICAgICAgICAgZmlyc3RfZWxlbT0wIGlmIGxhc3Rfc2Nhbm5lZCBlbHNlIGZpcnN0X2VsZW1lbnQsCiAgICAgICAgICAgIGl0ZW1zX29uX3BhZ2U9MSBpZiBsYXN0X3NjYW5uZWQgZWxzZSBzZWxmLml0ZW1zX29uX3BhZ2UsCiAgICAgICAgICAgIHJvd19maWx0ZXJzPXJvd19maWx0ZXJzLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPXNlYXJjaF9zdHJpbmcKICAgICAgICApCiAgICAgICAgc2VsZi5kb2Nfcm93cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfcm93c19jb3VudCgKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQoKICAgICAgICBpZiBub3QgbGFzdF9zY2FubmVkOgogICAgICAgICAgICBzdXBlcigpLl9jaGVja19uZXh0X3BhZ2UobGVuKGRhdGEpKQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RhYmxlX3R5cGVfZnJvbV9uYW1lKF92YWwpOgogICAgICAgIHJldHVybiAnaW4nIGlmIF92YWwgPT0gJ9Cg0LDQt9C80LXRidC10L3QuNC1JyBlbHNlICdvdXQnCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgZG9jX2RldGFpbHMpOgogICAgICAgICMgVE9ETyDQtNC+0LHQsNCy0LjRgtGMINCz0YDRg9C/0L/QuNGA0L7QstC60YMg0L/QviDRj9GH0LXQudC60LDQvAogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgcm93X2ZpbHRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3Jvd3NfZmlsdGVyJykKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgaWYgcm93X2ZpbHRlciBhbmQgcmVjb3JkWydxdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gPT0gMCBhbmQgcmVjb3JkWydxdHR5X3BsYW4nXSA9PSAwOgogICAgICAgICAgICAgICAgcGljID0gJycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2lkJ10pLAogICAgICAgICAgICAgICAgJ2NlbGwnOiBzdHIocmVjb3JkWydjZWxsX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfY2VsbCc6IHN0cihyZWNvcmRbJ2lkX2NlbGwnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5Jzogc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFsnaWRfc2VyaWVzJ10pLAogICAgICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFsnc2VyaWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAndW5pdHNfbmFtZSc6IHN0cihyZWNvcmRbJ3VuaXRzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnY29kZV9hcnQnOiAn0JrQvtC0OiAnICsgc3RyKHJlY29yZFsnY29kZSddKSwKICAgICAgICAgICAgICAgICdhcnQnOiBzdHIocmVjb3JkWydhcnQnXSksCiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICd1c2Vfc2VyaWVzJzogc3RyKHJlY29yZFsndXNlX3NlcmllcyddKQogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm9wcyA9IFsKICAgICAgICAgICAgICAgICd7fSAnLmZvcm1hdChwcm9kdWN0X3Jvd1snYXJ0J10pIGlmIHByb2R1Y3Rfcm93WydhcnQnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJyh7fSkgJy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICd7fScuZm9ybWF0KHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJywge30nLmZvcm1hdChwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ2dvb2RfaW5mbyddID0gJycuam9pbihwcm9wcykKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gc3RyKGludChyZWNvcmRbJ3F0dHknXSkgaWYgcmVjb3JkWydxdHR5J10uaXNfaW50ZWdlcigpIGVsc2UgcmVjb3JkWydxdHR5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gIjAiCiAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eV9wbGFuJ10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10gPSBzdHIoaW50KHJlY29yZFsncXR0eV9wbGFuJ10pIGlmIHJlY29yZFsncXR0eV9wbGFuJ10uaXNfaW50ZWdlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSByZWNvcmRbJ3F0dHlfcGxhbiddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddID0gIjAiCgogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpCiAgICAgICAgICAgIHNlbGYuX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihwcm9kdWN0X3JvdykKCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAoKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMob3ZlcnJpZGVfc2VhcmNoPVRydWUpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmLCB1c2Vfc2VyaWVzPUZhbHNlLCB1c2VfbWFyaz1GYWxzZSk6CgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNlbGwnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihzZWxmLCBwcm9kdWN0X3Jvdyk6CiAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgIHF0dHksIHF0dHlfcGxhbiA9IGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5J10pLCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10pCiAgICAgICAgaWYgcXR0eV9wbGFuID4gcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkJFOUU3IgoKICAgICAgICBlbGlmIHF0dHlfcGxhbiA8IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRjlDNCIKCiAgICAgICAgc2V0YXR0cihwcm9kdWN0X3Jvd1snX2xheW91dCddLCAnQmFja2dyb3VuZENvbG9yJywgYmFja2dyb3VuZF9jb2xvcikKCiAgICBkZWYgX3NldF9jdXJyZW50X2NlbGwoc2VsZiwgY3VycmVudF9jZWxsPSctINC90LUg0LLRi9Cx0YDQsNC90L4gLScsIGN1cnJlbnRfY2VsbF9pZD0nJyk6CiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwsIHNlbGYuY3VycmVudF9jZWxsX2lkID0gY3VycmVudF9jZWxsLCBjdXJyZW50X2NlbGxfaWQKICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2NlbGwnXSA9IGN1cnJlbnRfY2VsbAogICAgICAgIGlmIGN1cnJlbnRfY2VsbF9pZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnU2hvd19idG5fY2xlYXJfY2VsbCddID0gMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX2NsZWFyX2NlbGwnXSA9IC0xCgoKY2xhc3MgQWRyR29vZHNTZWxlY3RTY3JlZW4odWlfbW9kZWxzLkJhc2VHb29kU2VsZWN0KToKICAgIHNjcmVlbl9uYW1lID0gJ9Ci0L7QstCw0YAg0LLRi9Cx0L7RgCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQkNC00YDQtdGB0L3QvtC1INGF0YDQsNC90LXQvdC40LUnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCBkb2Nfcm93X2lkLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuZG9jX3Jvd19pZCA9IGRvY19yb3dfaWQKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3Jvd19kYXRhKHNlbGYuZG9jX3Jvd19pZCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSh7CiAgICAgICAgICAgIGtleTogc2VsZi5fZm9ybWF0X3F1YW50aXR5KHNlbGYuc2NyZWVuX2RhdGEuZ2V0KGtleSwgMCkpCiAgICAgICAgICAgIGlmIGtleSBpbiBbJ3F0dHlfcGxhbicsICdxdHR5J10gZWxzZSBzZWxmLnNjcmVlbl9kYXRhLmdldChrZXksICcnKQogICAgICAgICAgICBmb3Iga2V5IGluIHNlbGYuaGFzaF9tYXBfa2V5cwogICAgICAgIH0pCiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHkoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX3Nlcmllc19zaG93JzogbGFtYmRhOiBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oKSwKICAgICAgICAgICAgJ2J0bl9kb2NfZ29vZF9iYXJjb2RlJzogc2VsZi5fb3Blbl9iYXJjb2RlX3JlZ2lzdGVyX3NjcmVlbiwKICAgICAgICAgICAgJ2J0bl9wcmludCc6IHNlbGYuX3ByaW50X3RpY2tldAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzY3JlZW4gPSBBZHJEb2NEZXRhaWxzU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYuc2NyZWVuX2RhdGFbJ2lkX2RvYyddKQogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLCBkb2Nfcm93X2lkPScnKToKICAgICAgICBzZWxmLmhhc2hfbWFwWyd1c2VfYWRyX2RvY3NfdGFibGVzJ10gPSBUcnVlCiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2RvY19yb3dfaWQnOiBzZWxmLmRvY19yb3dfaWQsCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlcmllc1NlbGVjdFNjcmVlbihzZWxmLmhhc2hfbWFwKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93X3Byb2Nlc3NfcmVzdWx0KHNjcmVlbl92YWx1ZXMpCgogICAgZGVmIF9vcGVuX2JhcmNvZGVfcmVnaXN0ZXJfc2NyZWVuKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLnNjcmVlbl9kYXRhWydpdGVtX2lkJ10sCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6IHNlbGYuc2NyZWVuX2RhdGFbJ3Byb3BlcnR5X2lkJ10sCiAgICAgICAgICAgICd1bml0X2lkJzogc2VsZi5zY3JlZW5fZGF0YVsndW5pdF9pZCddCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoaW5pdF9kYXRhKQoKICAgICAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93X3Byb2Nlc3NfcmVzdWx0KCkKCiAgICBkZWYgX3ByaW50X3RpY2tldChzZWxmKToKICAgICAgICBiYXJjb2RlID0gZGJfc2VydmljZXMuQmFyY29kZVNlcnZpY2UoKS5nZXRfYmFyY29kZV9mcm9tX2RvY190YWJsZShzZWxmLmhhc2hfbWFwLmdldCgna2V5JykpCgogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiAnaXRlbV9uYW1lJywKICAgICAgICAgICAgJ9CQ0YDRgtC40LrRg9C7JzogJ2FydGljbGUnLAogICAgICAgICAgICAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6ICdwcm9wZXJ0eScsCiAgICAgICAgICAgICfQldC00JjQt9C8JzogJ3VuaXQnLAogICAgICAgIH0KCiAgICAgICAgZm9yIGtleSBpbiBkYXRhOgogICAgICAgICAgICBkYXRhW2tleV0gPSBzZWxmLmhhc2hfbWFwLmdldChkYXRhW2tleV0pCgogICAgICAgIGRhdGFbJ2JhcmNvZGUnXSA9IGJhcmNvZGUgaWYgYmFyY29kZSBlbHNlICcwMDAwMDAwMDAwMDAwJwogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkPScnKToKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAncXR0eSc6IGZsb2F0KGRhdGFbJ3F0dHknXSksCiAgICAgICAgfQoKICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXNlbGYuZG9jX3Jvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuc2NyZWVuX2RhdGFbJ2lkX2RvYyddKQoKICAgIGRlZiBfaGFuZGxlX2ZvdW5kX2JhcmNvZGUoc2VsZiwgcmVzLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgaXNfY3VycmVudF9wb3NpdGlvbiA9IGFsbCgoCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2l0ZW1faWQnXSA9PSByZXNbJ2lkX2dvb2QnXSwKICAgICAgICAgICAgc2VsZi5zY3JlZW5fZGF0YVsncHJvcGVydHlfaWQnXSA9PSByZXNbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ3VuaXRfaWQnXSA9PSByZXNbJ2lkX3VuaXQnXQogICAgICAgICkpCgogICAgICAgIGlmIGlzX2N1cnJlbnRfcG9zaXRpb246CiAgICAgICAgICAgIGlmIHNlbGYuc2NyZWVuX2RhdGFbJ3VzZV9zZXJpZXMnXSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzWydyYXRpbyddKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBzZWxmLmN1cnJlbnRfdG9hc3RfbWVzc2FnZSA9ICfQqNGC0YDQuNGF0LrQvtC0INC90LUg0YHQvtC+0YLQstC10YLRgdGC0LLRg9C10YIg0YLQtdC60YPRidC10Lkg0L/QvtC30LjRhtC40LgnCgogICAgICAgIHJldHVybiBGYWxzZQ=="
            }
        ],
        "StyleTemplates": [],
        "arch2": true,
        "CommonHandlers": [
            {
                "event": "onLaunch",
                "listener": "",
                "action": "run",
                "type": "pythonreload",
                "method": "app_on_start",
                "postExecute": "",
                "alias": "on_start"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "event_service",
                "postExecute": "",
                "alias": "event_service"
            },
            {
                "event": "onBackgroundCommand",
                "listener": "menu_2",
                "action": "run",
                "type": "set",
                "method": "UpdateConfigurations",
                "postExecute": ""
            },
            {
                "event": "onSQLError",
                "listener": "",
                "action": "run",
                "type": "set",
                "method": "beep",
                "postExecute": ""
            },
            {
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "timer_update",
                "postExecute": "",
                "alias": "timer_update"
            }
        ]
    }
}