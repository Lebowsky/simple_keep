{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.0.14.6",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Найдено по артикулам",
                                                "Variable": "finded_by_article",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "20",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f031",
                                "Variable": "btn_goods_ocr"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "6",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "btn_previous_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "@Good",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "btn_next_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Маркировка",
                                "Variable": "btn_marks_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good",
                                        "Variable": "id_good",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@code_art",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@unit_name",
                                        "Variable": "id_unit",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Групповая обработка",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "runprogress",
                                "type": "python",
                                "method": "gs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "CButtons"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Cинхронизировать данные с 1С",
                                "Variable": "sync_doc"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить все сканы на 1С",
                                "Variable": "send_all_scan_lines"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "7",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "@Good",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#7A005C",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Подтвердите действие",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@group_scan_message",
                                        "Variable": "group_scan_message",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Адресное хранение",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_adr_type_select",
                                                "Variable": "doc_adr_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@documents_list",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_title",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "16",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "12",
                                                        "Elements": [
                                                            {
                                                                "Value": "",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "2",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "Elements": [
                                                            {
                                                                "Value": "Текущая ячейка: ",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@current_cell",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextSize": "20",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "10",
                                                "Elements": [
                                                    {
                                                        "Value": "х",
                                                        "Variable": "btn_clear_cell",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextSize": "18",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Табл.",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@tables_type",
                                                "Variable": "table_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выбрать ячейку",
                                "Variable": "btn_select_cell"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@article",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@item_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Сбор ШК",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Шаблон распознавания",
                                "Variable": "btn_ocr_serial_template_settings"
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_find_serial_cv"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "ШаблонРаспознавания",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Количество цифр",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_num_amount",
                                        "Variable": "ocr_serial_template_num_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Префикс",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_prefix",
                                        "Variable": "ocr_serial_template_prefix",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "@current_ocr_serial_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Товары",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Товары список",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Категория:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_txt",
                                        "Variable": "error_txt",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Карточка товара",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "buttons",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Цены",
                                                "Variable": "to_prices",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Остатки",
                                                "Variable": "to_balances",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "name",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_name",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextSize": "22",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@item_key",
                                                "Variable": "item_key",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "good_info",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_type",
                                                "Variable": "good_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "art",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_art",
                                                        "Variable": "good_art",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "code",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Код:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_code",
                                                        "Variable": "good_code",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "descr",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Описание:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "CardsLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@load_info",
                                        "Variable": "load_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_item_good_barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_post_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор категории товаров ",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@goods_types_cards",
                                        "Variable": "goods_types_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Остатки",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверить остатки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Выбор склада:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "art",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул товара:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@item_art_input",
                                                                "Variable": "item_art_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "cell",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "info_block",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@error_msg",
                                        "Variable": "error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Запросить остатки",
                                        "Variable": "get_balance_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextSize": "15",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@balances_table",
                                        "Variable": "balances_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Цены",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверка цен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул товара:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "TextItalic": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "EditTextText"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "price_type",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Тип цены:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "properties",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Характеристики:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@property_select",
                                                                "Variable": "property_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "units",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Упаковка:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_object_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_price_type_name",
                                        "Variable": "selected_price_type_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_property_name",
                                        "Variable": "selected_property_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_unit_name",
                                        "Variable": "selected_unit_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@prices_error_msg",
                                        "Variable": "prices_error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_table",
                                        "Variable": "prices_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Параметры",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки и обмен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Разрешить ввод факт товара",
                                        "Variable": "allow_fact_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Оффлайн режим",
                                        "Variable": "offline_mode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Настройки HTTP подключения",
                                        "Variable": "btn_http_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки шрифтов",
                                        "Variable": "btn_size",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки звука",
                                        "Variable": "btn_sound_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки документов",
                                        "Variable": "btn_documents_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Тест сканера",
                                        "Variable": "btn_test_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Лог ошибок",
                                        "Variable": "btn_err_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить данные на  HTTP сервер",
                                        "Variable": "btn_upload_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Обмен с HTTP 1c сервером",
                                        "Variable": "btn_timer",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки печати",
                                        "Variable": "btn_print_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "СписокФайлов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@files_list",
                                        "Variable": "files_list",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "MultilineText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки Шрифтов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Размеры",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@TitleTextSize",
                                        "Variable": "TitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTitleTextSize",
                                        "Variable": "CardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardDateTextSize",
                                        "Variable": "CardDateTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTextSize",
                                        "Variable": "CardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@GoodsCardTitleTextSize",
                                        "Variable": "GoodsCardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@goodsTextSize",
                                        "Variable": "goodsTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@SeriesPropertiesTextSize",
                                        "Variable": "SeriesPropertiesTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@DocTypeCardTextSize",
                                        "Variable": "DocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@titleDocTypeCardTextSize",
                                        "Variable": "titleDocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_on_save",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_sizes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_size_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Тест сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_1",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_2",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_3",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_4",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_5",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_6",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_7",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "test_barcode_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Очистить",
                                                "Variable": "btn_clear_err",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "@date_sort_select",
                                                "Variable": "date_sort_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_log_table",
                                        "Variable": "error_log_table",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки http соединения",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@url",
                                        "Variable": "url",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user",
                                        "Variable": "user",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@pass",
                                        "Variable": "pass",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user_name",
                                        "Variable": "user_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@btn_test_connection",
                                        "Variable": "btn_test_connection",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@ANDROID_ID",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera2"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройка звука",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@event_cards",
                                        "Variable": "event_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки документов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Время хранения",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Укажите сколько дней документы будут храниться на устройстве.",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_delete_settings_days",
                                        "Variable": "doc_delete_settings_days",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Удалять устаревшие документы",
                                        "Variable": "doc_settings_confirm_delete_old_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Отладка",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Отладочный экран",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить лог",
                                        "Variable": "btn_unload_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Создать таблицы БД",
                                        "Variable": "btn_init",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Заполнить Ratio",
                                        "Variable": "btn_fill_ratio",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_listener",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Печать",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки печати",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройка Bluetooth принтера",
                                        "Variable": "btn_bluetooth_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка WiFi принтера",
                                        "Variable": "btn_wifi_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка шаблонов печати",
                                        "Variable": "btn_label_templates_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Печать через Bluetooth",
                                        "Variable": "check_box_bluetooth_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Печать через WiFi",
                                        "Variable": "check_box_wifi_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Список шаблонов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@templates_cards",
                                        "Variable": "templates_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Результат",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Шаблон:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@html",
                                        "Variable": "html",
                                        "height": "300",
                                        "width": "match_parent",
                                        "orientation": "vertical",
                                        "weight": "3",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "html"
                                    },
                                    {
                                        "Value": "@matching_table",
                                        "Variable": "matching_table_values",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Параметры штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Ширина",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_width",
                                                "Variable": "barcode_width",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Высота",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_height",
                                                "Variable": "barcode_height",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Тип:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_types",
                                                "Variable": "barcode_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Влево",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_left",
                                                "Variable": "barcode_left",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вправо",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_right",
                                                "Variable": "barcode_right",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вверх",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_up",
                                                "Variable": "barcode_up",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вниз",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_down",
                                                "Variable": "barcode_down",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "НастройкаСоответствияДиалог",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "layout",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@list_field",
                                        "Variable": "select_field",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "SpinnerLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Bluetooth",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки принтера Bluetooth",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать присоединенные",
                                        "Variable": "btn_show_connected",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Начать сканирование",
                                        "Variable": "btn_start_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Остановить сканирование",
                                        "Variable": "btn_stop_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_print",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Сбросить подключение",
                                        "Variable": "btn_bt_disconnect",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Подключенный принтер:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@default_printer",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "set",
                                "method": "BTGetBounded",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати WiFi",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Укажите ip устройства",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_ip",
                                        "Variable": "wi_fi_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Сохранить IP",
                                        "Variable": "btn_wifi_save_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить IP",
                                        "Variable": "btn_wifi_delete_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@info_wifi_current_ip",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_wi_fi",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Код ZPL для печати:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_zpl_input",
                                        "Variable": "wi_fi_zpl_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Напечатать zpl",
                                        "Variable": "btn_wi_fi_print_zpl",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Шаблоны",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки шаблонов ценников и этикеток",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Получить шаблоны с сервера",
                                        "Variable": "btn_get_labels",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@current_label_template_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Выбрать из списка",
                                        "Variable": "btn_select_label_template",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить настройки шаблонов печати",
                                        "Variable": "btn_delete_template_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка размеров шаблона",
                                        "Variable": "btn_label_template_size_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@preview_label_template_image",
                                        "Variable": "",
                                        "height": "300",
                                        "width": "match_parent",
                                        "weight": "3",
                                        "type": "Picture"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Размеры",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "label Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@width_print_template",
                                                        "Variable": "width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Label Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@height_print_template",
                                                        "Variable": "height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Img Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_width_print_template",
                                                        "Variable": "image_width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Img Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_height_print_template",
                                                        "Variable": "image_height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "LL",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_ll_print_template",
                                                        "Variable": "image_ll_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "PW",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_pw_print_template",
                                                        "Variable": "image_pw_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сдвиг вправо",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_x_print_template",
                                                        "Variable": "image_x_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Сдвиг вниз",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_y_print_template",
                                                        "Variable": "image_y_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "dpmm",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "6;8;12;24",
                                                        "Variable": "dpmm_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            }
                                        ],
                                        "StrokeWidth": "5"
                                    },
                                    {
                                        "Value": "@image_print",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Picture"
                                    }
                                ],
                                "StrokeWidth": "5"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить на печать",
                                "Variable": "btn_sent_to_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Сохранить шаблон",
                                "Variable": "btn_save_template_sizes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Удалить шаблон",
                                "Variable": "btn_delete_print_template"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Проводник",
                "DefineOnBackPressed": false,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проводник файлов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Вверх",
                                        "Variable": "btn_get_up",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@file_browser_cards",
                                        "Variable": "file_browser_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SeriesProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SeriesSelectScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@properties_name",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@series_cards",
                                        "Variable": "series_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_series_ocr_serial_number"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Настройки шаблона",
                                "Variable": "btn_ocr_serial_template_settings"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "FillingSeriesScreen",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "1",
                                "Elements": [
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Имя серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@name",
                                                "Variable": "name",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Номер серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@number",
                                                "Variable": "number",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Дата производства:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@production_date",
                                                "Variable": "production_date",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Годен до: ",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@best_before",
                                                "Variable": "best_before",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Количество:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@FillingSeriesScreen_qtty",
                                                "Variable": "FillingSeriesScreen_qtty",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "orientation": "horizontal",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "CVOperationName": "Распознавание артикулов",
                "type": "CVOperation",
                "hidden": true,
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "OCR",
                        "CVResolution": "VGA",
                        "CVMode": "list_and_grey",
                        "CVActionButtons": "Обработать",
                        "CVAction": "Поиск по артикулу",
                        "CVInfo": "@art_info",
                        "CVCameraDevice": "Back",
                        "Handlers": [
                            {
                                "event": "OnObjectDetected",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_object_detected",
                                "postExecute": ""
                            },
                            {
                                "event": "OnInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "OnCreate",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SelectItemProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SelectItemScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@SelectItemScreen_items_cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowItemsScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowMarksScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_marks_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_marks_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "BarcodeRegistration",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "BarcodeRegistration",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод товара",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "22",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good_name_barcode",
                                        "Variable": "good_name_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Штрихкод:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@scanned_barcode",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "properties",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Характеристика:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@property_select",
                                                "Variable": "property_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "units",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Упаковка:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@unit_select",
                                                "Variable": "unit_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_ok",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@barcodes_data",
                                        "Variable": "barcodes_data",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_click",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "OcrTextRecognition",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SerialNumberOCRSettings",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Количество цифр",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_num_amount",
                                                "Variable": "ocr_serial_template_num_amount",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Префикс",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_prefix",
                                                "Variable": "ocr_serial_template_prefix",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@ocr_serial_current_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_save_ocr_settings",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "TestProcess",
                "DefineOnBackPressed": false,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "TestScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Открыть экран маркировки",
                                        "Variable": "btn_show_marks",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "btn_show_marks_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple",
            "vendor_url": "",
            "vendor_auth": "",
            "handler_split_mode": false,
            "handler_code": "",
            "handler_url": "",
            "handler_auth": "",
            "dictionaries": ""
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "FaceRecognitionURL": "",
        "ForegroundService": false,
        "StopForegroundServiceOnExit": false,
        "RunPython": true,
        "LaunchProcess": "",
        "MainMenu": [
            {
                "MenuId": "01",
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuTop": false
            },
            {
                "MenuId": "02",
                "MenuItem": "update_conf",
                "MenuTitle": "Обновить конфигурацию",
                "MenuTop": false
            }
        ],
        "Mediafile": [],
        "PyHandlers": "aW1wb3J0IHNtX2Fkcl9kb2NzCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKaW1wb3J0IHVpX21vZGVscwpmcm9tIHVpX21vZGVscyBpbXBvcnQgY3JlYXRlX3NjcmVlbgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgojID09PT09PT09PT09PT09PSBNYWluIGV2ZW50cyA9PT09PT09PT09PT09PT09PQoKCkBIYXNoTWFwKCkKZGVmIGFwcF9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J7QsdGA0LDQsdC+0YLRh9C40Log0L/RgNC4INGB0YLQsNGA0YLQtSDQv9GA0LjQu9C+0LbQtdC90LjRjyAiIiIKCiAgICBtb2RlbCA9IHVpX21vZGVscy5NYWluRXZlbnRzKGhhc2hfbWFwKQogICAgbW9kZWwuYXBwX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0aW1lcl91cGRhdGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRhNC+0L3QvtCy0L7Qs9C+INC+0LHQvNC10L3QsCAiIiIKCiAgICB0aW1lciA9IHVpX21vZGVscy5UaW1lcihoYXNoX21hcCkKICAgIHRpbWVyLnRpbWVyX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBldmVudF9zZXJ2aWNlKGhhc2hfbWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0YDQsNCx0L7RgtGLINCc0J8g0LIg0YDQtdC20LjQvNC1INGB0LXRgNCy0LXRgNCwLgogICAgINCSIHdzX2JvZHkg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0LvQtdC20LjRgiDRgtC10LrRgdGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCAiIiIKCiAgICB1aV9tb2RlbHMuV2ViU2VydmljZVN5bmNDb21tYW5kKGhhc2hfbWFwKS5vbl9zZXJ2aWNlX3JlcXVlc3QoKQoKCgpASGFzaE1hcCgpCmRlZiBvbl9zcWxfZXJyb3IoaGFzaF9tYXApOgogICAgbW9kZWwgPSB1aV9tb2RlbHMuTWFpbkV2ZW50cyhoYXNoX21hcCkKICAgIG1vZGVsLm9uX3NxbF9lcnJvcigpCgoKQEhhc2hNYXAoKQpkZWYgb25fY2xvc2VfYXBwKGhhc2hfbWFwKToKICAgICMg0J/QvtC/0YvRgtC60LAg0L7Rh9C40YHRgtC60Lgg0LrRjdGI0LAg0L/RgNC4INCy0YvRhdC+0LTQtSDRgSDQv9GA0LjQu9C+0LbQtdC90LjRjwogICAgc3VDbGFzcy5kZWxldGVDYWNoZSgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBNYWluIGV2ZW50cyBeXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09IERvY3VtZW50cyA9PT09PT09PT09PT09PT09PQpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCe0YLQtNC10LvRjNC90YvQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC/0LvQuNGC0L7QuiDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDQv9GA0L7RhtC10YHRgdCwIGhhc2hfbWFwJ9C+0LwiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5GbG93RG9jU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd1RpbGVzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dUaWxlc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfZmxvd19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0KHQsdC+0YAg0KjQmi4g0K3QutGA0LDQvTog0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd0RvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX2Zsb3dfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCh0LHQvtGAINCo0JouINCt0LrRgNCw0L06INCf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgYXJ0aWNsZV9jdl9vbl9vYmplY3RfZGV0ZWN0ZWQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7Qsi4g0KjQsNCzOiDQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVi4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5BY3RpdmVDVkFydGljbGVSZWNvZ25pdGlvbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fb2JqZWN0X2RldGVjdGVkKCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpYWxfbnVtYmVyX29jcl9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTogT2NyVGV4dFJlY29nbml0aW9uLiDQrdC60YDQsNC9OiBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmlhbF9udW1iZXJfb2NyX3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiBPY3JUZXh0UmVjb2duaXRpb24uINCt0LrRgNCw0L06IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlcmlhbE51bWJlck9DUlNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6IE9jclRleHRSZWNvZ25pdGlvbi4g0K3QutGA0LDQvTogU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MuIiIiCiAgICB1aV9tb2RlbHMuU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Muc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgZG9jc190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyA9IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdzX3RpbGVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5UaWxlcykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgdGlsZXNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuRG9jdW1lbnRzRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Eb2N1bWVudHNEb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5Eb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKCiMgQEhhc2hNYXAoKQojIGRlZiBkb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiMgICAgIHNjcmVlbjogdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQojICAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2xpc3RlbmVyKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2JlZm9yZV9wcm9jZXNzX2JhcmNvZGUoaGFzaF9tYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRgdC40L3RhdGA0L7QvdC90L7Qs9C+INC30LDQv9GA0L7RgdCwINC4INC+0LHQvdC+0LLQu9C10L3QuNGPINC00LDQvdC90YvRhSDQv9C+0YHQu9C1INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyDQuCDQv9C10YDQtdC0INC+0LHRgNCw0LHQvtGC0LrQvtC5INCo0JoiIiIKCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uYmVmb3JlX3Byb2Nlc3NfYmFyY29kZSgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZChoYXNoX21hcCk6CiAgICAiIiIg0J7RgtC/0YDQsNCy0LrQsCDQtNCw0L3QvdGL0YUg0L/QvtGB0LvQtSDQvtCx0YDQsNCx0L7RgtC60Lgg0KjQmiIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5oYXNoX21hcC5yZW1vdmUoJ3RvYXN0JykKICAgIHNjcmVlbi5wb3N0X2JhcmNvZGVfc2Nhbm5lZCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3NjYW5fZXJyb3Jfc291bmQoaGFzaF9tYXApOgogICAgIiIiINCX0LLRg9C60L7QstGL0LUg0YHQuNCz0L3QsNC70Ysg0L7RiNC40LHQvtC6INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zY2FuX2Vycm9yX3NvdW5kKCkKCgpASGFzaE1hcCgpCmRlZiBoaWdobGlnaHRfc2Nhbm5lZF9pdGVtKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0L7RgtC80LXQvdGLINGA0LDRgdC60YDQsNGB0LrQuCDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAgIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uZGlzYWJsZV9oaWdobGlnaHQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfcG9zdF9saW5lc19kYXRhKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntGC0L/RgNCw0LLQutCwINC90LAgMdChINCy0YvQsdGA0LDQvdC90YvRhSDQsiBub3NxbCDRgdGC0YDQvtC6IHBvc3Qt0LfQsNC/0YDQvtGB0L7QvCAiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3KGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zZW5kX3Vuc2VudF9saW5lc19ydW4oKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfYWxsX3NjYW5fbGluZXMoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0YLQv9GA0LDQstC60LAg0L3QsCAx0KEg0LLRgdC10YUgbm9zcWwg0YHRgtGA0L7QuiDRgtC+0LLQsNGA0LAgcG9zdC3Qt9Cw0L/RgNC+0YHQvtC8ICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLnNlbmRfYWxsX3NjYW5fbGluZXNfcnVuKCkKCgpASGFzaE1hcCgpCmRlZiBhZnRlcl9zZW5kX3Bvc3RfbGluZXNfZGF0YShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J/QvtGB0LvQtSDQvtGC0L/RgNCw0LLQutC4LdC+0LHRgNCw0LHQvtGC0LrQuCBwb3N0LdC30LDQv9GA0L7RgdCwICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLmFmdGVyX3NlbmRfZGF0YSgpCgoKQEhhc2hNYXAoKQpkZWYgYWRyX2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbigKICAgICAgICBoYXNoX21hcD1oYXNoX21hcCwKICAgICAgICBzY3JlZW5fY2xhc3M9c21fYWRyX2RvY3MuQWRyRG9jc0xpc3RTY3JlZW4KICAgICkKICAgIHNjcmVlbi5pbml0X3NjcmVlbigpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgaGFzaF9tYXA9aGFzaF9tYXAsCiAgICAgICAgc2NyZWVuX2NsYXNzPXNtX2Fkcl9kb2NzLkFkckRvY3NMaXN0U2NyZWVuCiAgICApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCBzbV9hZHJfZG9jcy5BZHJEb2NEZXRhaWxzU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZG9jX2RldGFpbHNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyRG9jRGV0YWlsc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vZmZsaW5lX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Eb2NzT2ZmbGluZUxpc3RTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBlbGVtX3ZpZXZfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdvb2RzU2VsZWN0U2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZWxlbV92aWV2X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc1NlbGVjdFNjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9lbGVtX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyR29vZHNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9lbGVtX3ZpZXdfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyR29vZHNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9yZWdpc3Rlcl9kb2Nfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9yZWdpc3Rlcl9kb2Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBncm91cF9lbGVtX3ZpZXdfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2Nhbkl0ZW1TY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2VsZW1fdmlld19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuSXRlbVNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX2Vycm9yX3NjcmVlbl9saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBpZiBoYXNoX21hcFsnbGlzdGVuZXInXSBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdidG5fY29udGludWVfc2NhbiddOgogICAgICAgIGhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBEb2N1bWVudHMgXl5eXl5eXl5eXl5eXl5eXl4KCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF9pdGVtX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZWxlY3RJdGVtU2NyZWVuKS5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfaXRlbV9vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VsZWN0SXRlbVNjcmVlbikub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF9pdGVtX3Jlc3VsdChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBoYXNoX21hcC50b2FzdCgnc2VsZWN0X2l0ZW1fcmVzdWx0JykKCkBIYXNoTWFwKCkKZGVmIHNob3dfaXRlbXNfc2NyZWVuX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TaG93SXRlbXNTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgc2hvd19pdGVtc19zY3JlZW5fb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNob3dJdGVtc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgpASGFzaE1hcCgpCmRlZiBzaG93X21hcmtzX3NjcmVlbl9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2hvd01hcmtzU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCmRlZiBzaG93X21hcmtzX3NjcmVlbl9vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2hvd01hcmtzU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCkBIYXNoTWFwKCkKZGVmIGJ0bl9zaG93X21hcmtzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5UZXN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgoKIyA9PT09PT09PT09PT09PT0gR29vZHMgPT09PT09PT09PT09PT09PT0KCgpASGFzaE1hcCgpCmRlZiBnb29kc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR29vZHNMaXN0U2NyZWVuKQogICAgc2NyZWVuLmluaXRfc2NyZWVuKCkub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hb29kc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF90eXBlX2dvb2RzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RHb29kc1R5cGUoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfdHlwZV9nb29kc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VsZWN0R29vZHNUeXBlKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5JdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX3Bvc3Rfc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkl0ZW1DYXJkKQogICAgc2NyZWVuLm9uX3Bvc3Rfc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RfY2FyZF9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuSXRlbUNhcmQpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIG9mZmxpbmVfZ29vZF9jYXJkX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5JdGVtQ2FyZE9mZmxpbmVTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzIF5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzQmFsYW5jZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIGJhbGFuY2VzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkdvb2RzQmFsYW5jZXNJdGVtQ2FyZCA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhbGFuY2VzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc0JhbGFuY2VzSXRlbUNhcmQoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc0JhbGFuY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzUHJpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpASGFzaE1hcCgpCmRlZiBwcmljZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzUHJpY2VzSXRlbUNhcmQpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaWNlc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR29vZHNQcmljZXNJdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHNQcmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PSBTZXR0aW5ncyA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX29uX2NsaWNrKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkZvbnRTaXplU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVfc2V0dGluZ3NfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRm9udFNpemVTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlc3RfYmFyY29kZV9saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5CYXJjb2RlVGVzdFNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9jbGljayhoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0dHBfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuSHR0cFNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgaHR0cF9zZXR0aW5nc19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5IdHRwU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzb3VuZF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU291bmRTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNvdW5kX3NldHRpbmdzX2xpc3RlbmVyKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Tb3VuZFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jdW1lbnRzX3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9Cw0YDQsNC80LXRgtGA0YsuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkRvY3VtZW50c1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jdW1lbnRzX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9Cw0YDQsNC80LXRgtGA0YsuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkRvY3VtZW50c1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBTZXR0aW5ncyBeXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT0gUHJpbnQgPT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIHByaW50X3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50U2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0ZW1wbGF0ZV9saXN0X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCh0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyIiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5UZW1wbGF0ZXNMaXN0ID0gdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0ZW1wbGF0ZV9saXN0X29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCh0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyIiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5UZW1wbGF0ZXNMaXN0ID0gdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBodG1sX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KDQtdC30YPQu9GM0YLQsNGCIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuSHRtbFZpZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBodG1sX3ZpZXdfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KDQtdC30YPQu9GM0YLQsNGCIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuSHRtbFZpZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9ibHVldG9vdGhfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludEJsdWV0b290aFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfYmx1ZXRvb3RoX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggQmx1ZXRvb3RoIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRCbHVldG9vdGhTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGJsdWV0b290aF9lcnJvcihoYXNoX21hcCk6CiAgICAiIiLQntCx0YnQuNC5INC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YjQuNCx0LrQuCDQv9GA0Lgg0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgQmx1ZXRvb3RoIiIiCiAgICBQcmludFNlcnZpY2UuYmx1ZXRvb3RoX2Vycm9yKGhhc2hfbWFwKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X3dpZmlfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRXaUZpU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF93aWZpX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggV2lGaSIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50V2lGaVNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfd2lmaShoYXNoX21hcCk6CiAgICAiIiLQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgV2lGaS4g0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQt9Cy0LDQvSDQsNGB0LjQvdGF0YDQvtC90L3QviIiIgogICAgUHJpbnRTZXJ2aWNlLnByaW50X3dpZmkoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgd2lmaV9lcnJvcihoYXNoX21hcCk6CiAgICAiIiLQntCx0YnQuNC5INC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YjQuNCx0LrQuCDQv9GA0Lgg0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgV2lGaSIiIgogICAgUHJpbnRTZXJ2aWNlLndpZmlfZXJyb3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfbGFiZWxfdGVtcGxhdGVzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludExhYmVsVGVtcGxhdGVzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZXNfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50TGFiZWxUZW1wbGF0ZXNTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlX3NpemVfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50VGVtcGxhdGVTaXplU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZV9zaXplX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KDQsNC30LzQtdGA0YsiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFRlbXBsYXRlU2l6ZVNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfcG9zdF9leGVjdXRlKGhhc2hfbWFwKToKICAgICIiItCh0YDQsNCx0LDRgtGL0LLQsNC10YIg0L/QvtGB0LvQtSDQstGL0LfQvtCy0LAgUHJpbnRTZXJ2aWNlLnByaW50INC4INC/0LXRh9Cw0YLQsNC10YIg0YbQtdC90L3QuNC6IiIiCiAgICBQcmludFNlcnZpY2UucHJpbnRfcG9zdF9leGVjdXRlKGhhc2hfbWFwKQoKIyBeXl5eXl5eXl5eXl5eXl5eXiBQcmludCBeXl5eXl5eXl5eXl5eXl5eXgoKCkBIYXNoTWFwKCkKZGVmIGZpbGVfYnJvd3Nlcl9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2ltcGxlRmlsZUJyb3dzZXIoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmaWxlX2Jyb3dzZXJfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNpbXBsZUZpbGVCcm93c2VyKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyA9PT09PT09PT09PT09PT0gRGVidWcgPT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIGRlYnVnX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkRlYnVnU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBkZWJ1Z19saXN0ZW5lcihoYXNoX21hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRGVidWdTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKIyBeXl5eXl5eXl5eXl5eXl5eXiBEZWJ1ZyBeXl5eXl5eXl5eXl5eXl5eXgoKCg==",
        "pyHandlersPath": "C:/Work/simple_keep/simple_keep\\main.py",
        "PyTimerTask": [
            {
                "PyTimerTaskKey": "timer_update",
                "PyTimerTaskDef": "timer_update",
                "PyTimerTaskPeriod": "15000",
                "PyTimerTaskBuilIn": false
            }
        ],
        "PyFiles": [
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\database_init_queryes.py",
                "PyFileKey": "database_init_queryes",
                "PyFileData": "I2ltcG9ydCB1aV9nbG9iYWwKZGVmIGRhdGFiYXNlX3NoZW1hKCk6CiAgICBScyA9IFtdCgoKICAgICPQmtC+0L3RgdGC0LDQvdGC0Ysg0Lgg0YXRgNCw0L3QuNC80YvQtSDQvdCw0YHRgtGA0L7QudC60LggUlNfY29uc3RhbnRzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19jb25zdGFudHMgKAogICAgICAgIGlkICAgICAgICAgICAgIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICB1c2Vfc2VyaWVzICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgdXNlX3Byb3BlcnRpZXMgVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHVzZV9tYXJrICAgICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBhZGRfaWZfbm90X2luX3BsYW4gICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBwYXRoICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUZBVUxUICIvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvIiwKICAgICAgICBkZWxldGVfZmlsZXMgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgcmVzZXJ2ZWQgICAgICAgVEVYVCAgICBOT1QgTlVMTCwKICAgICAgICBtYXhfaWRfZG9jICAgICAgICAgSU5URUdFUiBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMSksCiAgICAgICAgYWxsb3dfb3ZlcnNjYW4gVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHJlbGVhc2UgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCgogICAgIyDQmtC70LDRgdGB0LjRhNC40LrQsNGC0L7RgCDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPIFJTX2NsYXNzaWZpZXJfdW5pdHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NsYXNzaWZpZXJfdW5pdHMgKAogICAgICAgIGlkIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgY29kZSAgICBURVhUIE5PVCBOVUxMLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICMg0JLQuNC00Ysg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3R5cGVzX2dvb2RzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU190eXBlc19nb29kcyAoCiAgICBpZCAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgbmFtZSAgICAgVEVYVCBOT1QgTlVMTCwKICAgIHVzZV9tYXJrIElOVCAgREVGQVVMVCAoMCkgCiAgICApCiAgICAnJycpCgogICAgIyDQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAgUlNfZ29vZHMKICAgIFJzLmFwcGVuZCgnJycKICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19nb29kcyAoCiAgICAgICAgICAgIGlkICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgICAgIGNvZGUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIG5hbWUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIGFydCAgICAgICAgIFRFWFQsCiAgICAgICAgICAgIHVuaXQgICAgICAgIFRFWFQgIFJFRkVSRU5DRVMgUlNfY2xhc3NpZmllcl91bml0cyAoaWQpLAogICAgICAgICAgICB0eXBlX2dvb2QgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU190eXBlc19nb29kcyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVRDSCBbRlVMTF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQKICAgICAgICApCiAgICAgICAgJycnKQoKCiAgICAjINCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3Byb3BlcnRpZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3Byb3BlcnRpZXMgKAogICAgaWQgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBPTiBDT05GTElDVCBSRVBMQUNFLAogICAgaWRfb3duZXIgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCkgT04gREVMRVRFIE5PIEFDVElPTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gVVBEQVRFIE5PIEFDVElPTiwKICAgIG5hbWUgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCgogICAgIyDQo9C/0LDQutC+0LLQutC4INCV0LTQuNC90LjRhtGLINC40LfQvNC10YDQtdC90LjRjyBSU191bml0cwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfdW5pdHMgKAogICAgICAgIGlkICAgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgaWRfb3duZXIgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBjb2RlICAgICAgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgbmFtZSAgICAgICAgICBURVhUICAgIE5PVCBOVUxMLAogICAgICAgIG5vbWluYXRvciAgICAgSU5URUdFUiBOT1QgTlVMTCwKICAgICAgICBkZW5vbWluYXRvciAgIElOVEVHRVIgTk9UIE5VTEwsCiAgICAgICAgaW50X3JlZHVjdGlvbiBURVhUICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgoKCiAgICAjINCh0LXRgNC40Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3NlcmllcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfc2VyaWVzICgKICAgICAgICBpZCAgICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBiZXN0X2JlZm9yZSAgICAgVEVYVCwKICAgICAgICB0eXBlX2dvb2RzICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBwcm9kdWN0aW9uX2RhdGUgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICPQmNC90LTQtdC60YHRiyBSU19zZXJpZXMKICAgIFJzLmFwcGVuZCgnJydDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyAgU2VyaWVzX25hbWUgT04gUlNfc2VyaWVzICgKICAgIG5hbWUgQVNDICkKICAgICcnJykKCiAgICAjINCo0YLRgNC40YXQutC+0LTRiyBSU19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCAnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNvZGVzICgKICAgIGJhcmNvZGUgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBpZF9nb29kICAgICBURVhUIE5PVCBOVUxMLAogICAgaWRfcHJvcGVydHkgVEVYVCwKICAgIGlkX3NlcmllcyAgIFRFWFQsCiAgICBpZF91bml0ICAgICBURVhULAogICAgcmF0aW8gICAgICAgSU5UICBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgogICAgI9Ca0L7QtNGLINC80LDRgNC60LjRgNC+0LLQutC4IFJTX21hcmtpbmdfY29kZXMKICAgIFJzLmFwcGVuZCggJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19tYXJraW5nX2NvZGVzICgKICAgICAgICBpZCAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBtYXJrX2NvZGUgICBURVhUIE5PVCBOVUxMLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9wcm9wZXJ0eSBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSAKICAgICkKICAgICcnJykKCgoKICAgICMg0JrQvtC90YLRgNCw0LPQtdC90YLRiyBSU19jb3VudHJhZ2VudHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NvdW50cmFnZW50cyAoCiAgICAgICAgaWQgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgbmFtZSAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgZnVsbF9uYW1lIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgaW5uICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAga3BwICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCh0LrQu9Cw0LTRiyBSU193YXJlaG91c2VzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU193YXJlaG91c2VzICgKICAgICAgICBpZCBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NlbGxzICgKICAgIGlkICAgVEVYVCBQUklNQVJZIEtFWQogICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgbmFtZSBURVhUIE5PVCBOVUxMLAogICAgYmFyY29kZSBURVhUCiAgICApJycnKQoKICAgICMg0JLQuNC00Ysg0YbQtdC9INC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZV90eXBlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfcHJpY2VfdHlwZXMgKAogICAgICAgIGlkICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCm0LXQvdGLINC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3ByaWNlcyAoCiAgICAgICAgaWQgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX3ByaWNlX3R5cGVzIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBpZF9nb29kcyAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICAgICAgaWRfcHJvcGVydGllcyAgVEVYVCAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgcHJpY2UgICAgICAgICAgUkVBTCwKICAgICAgICBpZF91bml0ICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3VuaXRzIChpZCkgCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jX3R5cGVzICgKICAgIGRvY190eXBlIFRFWFQgUFJJTUFSWSBLRVkgT04gQ09ORkxJQ1QgUkVQTEFDRQogICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICBpc19hZHJfc3RvcmFnZSBJTlQgIERFRkFVTFQgKDApIAogICAgKQogICAgJycnKQoKICAgICMg0JLRgdC1INC00L7QutGD0LzQtdC90YLRiyDRgdC/0LjRgdC60L7QvCBSU19kb2NzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfY291bnRyYWdlbnRzICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfY291bnRyYWdlbnRzIChpZCksCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUIERFRkFVTFQgMCwKICAgICAgICBpc19ncm91cF9zY2FuICAgICAgVEVYVCBERUZBVUxUIDAsCiAgICAgICAgaXNfYmFyY19mbG93ICAgICAgIFRFWFQgREVGQVVMVCAwLAogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgICBURVhUIERFRkFVTFQgMAogICAgICAgIAogICAgKQogICAgJycnKQoKCiAgICAjINCi0LDQsdC70LjRh9C90LDRjyDRh9Cw0YHRgtGMINC00L7QutGD0LzQtdC90YLQvtCyIFJTX2RvY3NfdGFibGUKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfdGFibGUgKAogICAgICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICBpZF9kb2MgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICAgICAgaWRfZ29vZCAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgICAgIGlkX3Byb3BlcnRpZXMgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgaWRfc2VyaWVzICAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSwKICAgICAgICBxdHR5ICAgICAgICAgIFJFQUwsCiAgICAgICAgZF9xdHR5ICAgICAgICBSRUFMLCAgCiAgICAgICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgICAgIHByaWNlICAgICAgICAgUkVBTCwKICAgICAgICBpZF9wcmljZSAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBzZW50ICAgICAgICAgIElOVEVHRVIsCiAgICAgICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGlzX3BsYW4gICAgICAgVEVYVCBERUZBVUxUICJUcnVlIiwKICAgICAgICBpZF9jZWxsICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgSU5URUdFUiBERUZBVUxUIDAgCiAgICApCiAgICAnJycpCgoKICAgICMg0JrQvtC00Ysg0LzQsNGA0LrQuNGA0L7QstC60Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1IFJTX2RvY3NfYmFyY29kZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfYmFyY29kZXMgKAogICAgaWQgICAgICAgICAgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgaWRfZG9jICAgICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUsCiAgICBpZF9nb29kICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydHkgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJvcGVydGllcyAoaWQpLAogICAgaWRfc2VyaWVzICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfc2VyaWVzIChpZCksCiAgICBpZF91bml0ICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpICwKICAgIG1hcmtfY29kZSAgICAgICAgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICBiYXJjb2RlX2Zyb21fc2Nhbm5lciAgICBURVhULAogICAgaXNfcGxhbiAgICAgICAgICAgICAgICAgSU5URUdFUiBERUZBVUxUIDAgTk9UIE5VTEwsCiAgICBhcHByb3ZlZCAgICAgICAgICAgICAgICBJTlRFR0VSIERFRkFVTFQgMCwKICAgIEdUSU4gICAgICAgICAgICAgICAgICAgIFRFWFQsCiAgICBTZXJpZXMgICAgICAgICAgICAgICAgICBURVhUCiAgICApCiAgICAnJycpCgogICAgI9Cf0L7RgtC+0Log0L/RgNC+0LjQt9Cy0L7Qu9GM0L3Ri9GFINGI0YLRgNC40YXQutC+0LTQvtCyCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19iYXJjX2Zsb3cgKAogICAgaWRfZG9jICBURVhUIFJFRkVSRU5DRVMgUlNfZG9jcyAoaWRfZG9jKSwKICAgIGJhcmNvZGUgVEVYVAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzICgKICAgIGlkX2RvYyAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX24gICAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX2RhdGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICB2ZXJpZmllZCAgICAgICAgICAgSU5URUdFUiwKICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgYWRkX21hcmtfc2VsZWN0aW9uIElOVEVHRVIsCiAgICBjcmVhdGVkX2F0ICAgICAgICAgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwKICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICBERUZBVUxUIDAsCiAgICBhbGxvd19mYWN0X2lucHV0ICAgVEVYVCBERUZBVUxUIDAKICAgIAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzX3RhYmxlICgKICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19hZHJfZG9jcyAoaWRfZG9jKSBPTiBERUxFVEUgQ0FTQ0FERQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBTRVQgREVGQVVMVCwKICAgIGlkX2dvb2QgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydGllcyBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpLAogICAgcXR0eSAgICAgICAgICBSRUFMLAogICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgc2VudCAgICAgICAgICBJTlRFR0VSLAogICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiAgICAgICBURVhUICAgICBERUZBVUxUIFRydWUsCiAgICBpZF9jZWxsICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwgCiAgICB0YWJsZV90eXBlICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFQgJ291dCcsCiAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkKICAgICkKICAgICcnJykKCiAgICBScy5hcHBlbmQoJycnCiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRXJyb3JfbG9nICgKICAgICAgICBsb2cgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoJycpLAogICAgICAgIHRpbWVzdGFtcCBEQVRFVElNRSBERUZBVUxUIChDVVJSRU5UX1RJTUVTVEFNUCkpIAogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgbmFtZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX2JhcmNvZGUgT04gUlNfY2VsbHMgKAogICAgYmFyY29kZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3Nfc2VyaWVzICgKICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsCiAgICBpZF9kb2MgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICBpZF9nb29kICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICBpZF9wcm9wZXJ0aWVzICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3dhcmVob3VzZSAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3dhcmVob3VzZXMgKGlkKSwKICAgIHF0dHkgICAgICAgICAgICBSRUFMLAogICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgYmVzdF9iZWZvcmUgICAgIERBVEVUSU1FLAogICAgbnVtYmVyICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgY2VsbCAgICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSBPTiBERUxFVEUgTk8gQUNUSU9OCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICknJycpCgoKCiMgUlNfY29uc3RhbnRzICsgUlNfY2xhc3NpZmllcl91bml0cyArIFJTX3R5cGVzX2dvb2RzCiMgICAgIFJzID0gKyBSU19nb29kcyArIFJTX3Byb3BlcnRpZXNcCiMgICAgICAgICAgKyBSU19zZXJpZXMgKyBSU191bml0cyArIFJTX2JhcmNvZGVzICsgUlNfbWFya2luZ19jb2RlcyArIFJTX2RvY3MgKyBSU19kb2NzX2JhcmNvZGVzXAojICAgICAgICAgICsgUlNfZG9jc190YWJsZSArIFJTX3ByaWNlX3R5cGVzICsgUlNfcHJpY2VzICsgUlNfY291bnRyYWdlbnRzICsgUlNfd2FyZWhvdXNlcwoKICAgIHJldHVybiBScwojcHJpbnQoZGF0YWJhc2Vfc2hlbWEoKSkKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2NvbnN0YW50cykKICAgICMgUnMuYXBwZW5kKFJTX2NsYXNzaWZpZXJfdW5pdHMpCiAgICAjIFJzLmFwcGVuZChSU190eXBlc19nb29kcykKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2dvb2RzKQogICAgIyBScy5hcHBlbmQoUlNfcHJvcGVydGllcykKICAgICMgUnMuYXBwZW5kKFJTX3NlcmllcykKICAgICMgUnMuYXBwZW5kKFJTX3VuaXRzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19tYXJraW5nX2NvZGVzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfZG9jcykKICAgICMgUnMuYXBwZW5kKFJTX2RvY3NfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19kb2NzX3RhYmxlKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfcHJpY2VfdHlwZXMpCiAgICAjIFJzLmFwcGVuZChSU19wcmljZXMpCiAgICAjCiAgICAjIFJzLmFwcGVuZChSU19jb3VudHJhZ2VudHMpCiAgICAjIFJzLmFwcGVuZChSU193YXJlaG91c2VzKQogICAgI3VpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KFJzKQoK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\db_services.py",
                "PyFileKey": "db_services",
                "PyFileData": "aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YSwgdGltZXpvbmUKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIExpdGVyYWwsIE9wdGlvbmFsCgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVTUUxQcm92aWRlciBhcyBzcWxDbGFzcwpmcm9tIHVpX2dsb2JhbCBpbXBvcnQgZ2V0X3F1ZXJ5X3Jlc3VsdCwgYnVsa19xdWVyeQpmcm9tIHRpbnlfZGJfc2VydmljZXMgaW1wb3J0IFRpbnlOb1NRTFByb3ZpZGVyLCBTY2FubmluZ1F1ZXVlU2VydmljZQoKCmNsYXNzIERiU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc3FsX2NsYXNzPXNxbENsYXNzKCkpCgogICAgZGVmIF93cml0ZV9lcnJvcl9vbl9sb2coc2VsZiwgZXJyb3JfdGV4dDogc3RyKToKICAgICAgICBpZiBlcnJvcl90ZXh0OgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnRXJyb3JfbG9nJwogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZSh7J2xvZyc6IGVycm9yX3RleHR9KQogICAgICAgICAgICBzZWxmLnNxbF90ZXh0ID0gc2VsZi5wcm92aWRlci5zcWxfdGV4dAogICAgICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9wYXJhbXMKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtczogc3RyID0gJycsIHRhYmxlX25hbWU9JycpOgoKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCgpjbGFzcyBUaW1lclNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2ludF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQoKICAgIGRlZiBzYXZlX2xvYWRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX3ByZXBhcmVfZGF0YV90b19zYXZlKGRhdGEpCgogICAgICAgIGNsZWFyX3RhYmxlcyA9IFsnUlNfZG9jc190YWJsZScsICdSU19hZHJfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfZG9jc19zZXJpZXMnXQoKICAgICAgICBmb3IgdGFibGVfbmFtZSwgdmFsdWVzIGluIGRhdGEuaXRlbXMoKToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiBjbGVhcl90YWJsZXMgYW5kIHZhbHVlczoKICAgICAgICAgICAgICAgIGlkX2RvYyA9IHZhbHVlc1swXVsnaWRfZG9jJ10KICAgICAgICAgICAgICAgIF9maWx0ZXIgPSB7J2lkX2RvYyc6IGlkX2RvY30KCiAgICAgICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyKQogICAgICAgICAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKHZhbHVlcykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucHJvdmlkZXIucmVwbGFjZSh2YWx1ZXMpCgogICAgZGVmIF9wcmVwYXJlX2RhdGFfdG9fc2F2ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiAnUlNfZG9jc19iYXJjb2RlcycgaW4gZGF0YToKICAgICAgICAgICAgZG9jc19iYXJjb2RlcyA9IFtdCiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXToKICAgICAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYucGFyc2VfYmFyY29kZShpdGVtWydtYXJrX2NvZGUnXSkKICAgICAgICAgICAgICAgIGRvY3NfYmFyY29kZXMuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGl0ZW1bJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGl0ZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogaXRlbVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IGl0ZW1bJ2lkX3NlcmllcyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGl0ZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmtfY29kZSc6IGl0ZW1bJ21hcmtfY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZV9mcm9tX3NjYW5uZXInOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2lzX3BsYW4nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcHJvdmVkJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdHVElOJzogYmFyY29kZV9kYXRhWydHVElOJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdTZXJpZXMnOiBiYXJjb2RlX2RhdGFbJ1NlcmllcyddCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBkYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NzX2JhcmNvZGVzCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsID0gdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKS5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBndGluID0gdmFsWzI6MTZdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZ3RpbiA9IHZhbFs6MTRdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBndGluLCAnU2VyaWVzJzogc2VyaWVzfQoKICAgIGRlZiBnZXRfbmV3X2xvYWRfZG9jcyhzZWxmLCBkYXRhOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGxvYWRlZF9kb2N1bWVudHMgPSB7fQoKICAgICAgICBmb3IgZG9jX3R5cGUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ106CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGEuZ2V0KGRvY190eXBlLCBbXSk6CiAgICAgICAgICAgICAgICBsb2FkZWRfZG9jdW1lbnRzW2l0ZW1bJ2lkX2RvYyddXSA9IGl0ZW0KCiAgICAgICAgaWYgbm90IGxvYWRlZF9kb2N1bWVudHM6CiAgICAgICAgICAgIHJldHVybiBsb2FkZWRfZG9jdW1lbnRzCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MKICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzCiAgICAgICAgJycnCgogICAgICAgIGRiX2RvY3MgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQogICAgICAgIGZvciBkb2MgaW4gZGJfZG9jczoKICAgICAgICAgICAgaWYgZG9jWydpZF9kb2MnXSBpbiBsb2FkZWRfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbG9hZGVkX2RvY3VtZW50cy5wb3AoZG9jWydpZF9kb2MnXSkKCiAgICAgICAgcmV0dXJuIGxvYWRlZF9kb2N1bWVudHMKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICBkYXRhID0gRG9jU2VydmljZSgpLmdldF9kYXRhX3RvX3NlbmQoKSArIEFkckRvY1NlcnZpY2UoKS5nZXRfZGF0YV90b19zZW5kKCkKICAgICAgICByZXR1cm4gZGF0YQoKCmNsYXNzIEJhcmNvZGVTZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUnNfYmFyY29kZXMnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKCiAgICBkZWYgYWRkX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZShiYXJjb2RlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2RlX2RhdGEoc2VsZiwgYmFyY29kZV9pbmZvLCBpZF9kb2MsIGlzX2Fkcl9kb2M9RmFsc2UsIGlkX2NlbGw9JycsIHRhYmxlX3R5cGU9JycpOgogICAgICAgIGlmIGJhcmNvZGVfaW5mby5zY2hlbWUgPT0gJ0dTMSc6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5ndGluWzE6XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5iYXJjb2RlCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCBpZF9jZWxsOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdpZF9jZWxsIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCB0YWJsZV90eXBlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd0YWJsZV90eXBlIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgJ3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLnByaWNlJywKICAgICAgICAgICAgJ2lkX3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLmlkX3ByaWNlJywKICAgICAgICAgICAgJ2RfcXR0eV9maWVsZCc6ICdkb2NfdGFibGUucXR0eScgaWYgaXNfYWRyX2RvYyBlbHNlICdkb2NfdGFibGUuZF9xdHR5JywKICAgICAgICAgICAgJ3VzZV9tYXJrX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZ29vZHMudXNlX21hcmsnLAogICAgICAgICAgICAnZG9jc190YWJsZSc6ICdSU19hZHJfZG9jc190YWJsZScgaWYgaXNfYWRyX2RvYyBlbHNlICdSU19kb2NzX3RhYmxlJywKICAgICAgICAgICAgJ2NlbGxfY29uZGl0aW9uJzogZidBTkQgZG9jX3RhYmxlLmlkX2NlbGwgPSAie2lkX2NlbGx9IicgaWYgaXNfYWRyX2RvYyBlbHNlICcnLAogICAgICAgICAgICAndGFibGVfdHlwZV9jb25kaXRpb24nOiBmJ0FORCBkb2NfdGFibGUudGFibGVfdHlwZSA9ICJ7dGFibGVfdHlwZX0iJyBpZiBpc19hZHJfZG9jIGVsc2UgJycsCiAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgICdndGluJzogYmFyY29kZV9pbmZvLmd0aW4sCiAgICAgICAgICAgICdzZXJpZXMnOiBiYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlYXJjaF92YWx1ZSwKICAgICAgICB9CgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfZ29vZCBBUyBpZF9nb29kLCAKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3Byb3BlcnR5IEFTIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfc2VyaWVzIEFTIGlkX3NlcmllcywKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3VuaXQgQVMgaWRfdW5pdCwKICAgICAgICAgICAgICAgIGJhcmNvZGVzLnJhdGlvIEFTIHJhdGlvLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY19iYXJjb2Rlcy5hcHByb3ZlZCwgMCkgQVMgYXBwcm92ZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jX2JhcmNvZGVzLmlkLCAwKSBBUyBtYXJrX2lkLAogICAgICAgICAgICAgICAgSUZOVUxMKHt1c2VfbWFya19maWVsZH0sIGZhbHNlKSBBUyB1c2VfbWFyaywKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUuaWQsICcnKSBBUyByb3dfa2V5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS51c2Vfc2VyaWVzLCAwKSBBUyB1c2Vfc2VyaWVzLAogICAgICAgICAgICAgICAgSUZOVUxMKHtkX3F0dHlfZmllbGR9LCAwLjApIEFTIGRfcXR0eSwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUucXR0eSwgMC4wKSBBUyBxdHR5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuLAogICAgICAgICAgICAgICAgSUZOVUxMKHtwcmljZV9maWVsZH0sIDAuMCkgQVMgcHJpY2UsCiAgICAgICAgICAgICAgICBJRk5VTEwoe2lkX3ByaWNlX2ZpZWxkfSwgJycpIEFTIGlkX3ByaWNlLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuCgogICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzIEFTIGJhcmNvZGVzCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgICAgICAgICAoU0VMRUNUIAogICAgICAgICAgICAgICAgICAgICAgICBnb29kcy5pZCBBUyBpZF9nb29kcywgCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzX2dvb2RzLnVzZV9tYXJrIAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBGUk9NICBSU19nb29kcyBBUyBnb29kcwogICAgICAgICAgICAgICAgICAgIEpPSU4gUlNfdHlwZXNfZ29vZHMgQVMgdHlwZXNfZ29vZHMgT04gZ29vZHMudHlwZV9nb29kID0gdHlwZXNfZ29vZHMuaWQpIEFTIGdvb2RzCiAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF9nb29kID0gZ29vZHMuaWRfZ29vZHMKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiB7ZG9jc190YWJsZX0gQVMgZG9jX3RhYmxlIAogICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfZ29vZCA9IGRvY190YWJsZS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF9wcm9wZXJ0eSA9IGRvY190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF91bml0ID0gZG9jX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgICAgICAgICAgQU5EIGRvY190YWJsZS5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgICAgICAgICAgICAgIHtjZWxsX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgICAgICAge3RhYmxlX3R5cGVfY29uZGl0aW9ufQogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2RvY3NfYmFyY29kZXMgYXMgZG9jX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBPTiBkb2NfYmFyY29kZXMuaWRfZG9jID0gIntpZF9kb2N9IgogICAgICAgICAgICAgICAgICAgIEFORCBkb2NfYmFyY29kZXMuR1RJTiA9ICJ7Z3Rpbn0iCiAgICAgICAgICAgICAgICAgICAgQU5EIGRvY19iYXJjb2Rlcy5TZXJpZXMgPSAie3Nlcmllc30iCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgYmFyY29kZXMuYmFyY29kZSA9ICJ7YmFyY29kZX0iJycnLmZvcm1hdCgqKnBhcmFtcykKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKICAgICAgICBpZiByZXN1bHQ6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF0KCiAgICBkZWYgZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZiwgaWRfZG9jX3RhYmxlOiBzdHIpIC0+IHN0cjoKICAgICAgICBxID0gJycnCiAgICAgICAgU0VMRUNUIGJhcmNvZGUKICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgCiAgICAgICAgTEVGVCBKT0lOICAgUlNfZG9jc190YWJsZSBPTiAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19iYXJjb2Rlcy5pZF9nb29kIEFORCAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMgPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBBTkQgCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfYmFyY29kZXMuaWRfdW5pdCAgCiAgICAgICAgCiAgICAgICAgV0hFUkUgUlNfZG9jc190YWJsZS5pZCA9ID8KICAgICAgICAKICAgICAgICBMSU1JVCAxICcnJwoKICAgICAgICByZXN1bHQgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2NfdGFibGUpCiAgICAgICAgaWYgcmVzdWx0OgogICAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdWydiYXJjb2RlJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJzAwMDAwMDAwMDAwMTEnCgoKICAgIGRlZiByZXBsYWNlX29yX2NyZWF0ZV90YWJsZShzZWxmLCB0YWJsZV9uYW1lLCBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKGRvY3NfdGFibGVfdXBkYXRlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2Rlc19ieV9nb29kc19pZChzZWxmLCBnb29kc19pZCkgLT4gbGlzdDoKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBiYXJjb2Rlcy5iYXJjb2RlLAogICAgICAgICAgICAgICAgSUZOVUxMKHByb3BzLm5hbWUsICcnKSBBUyBwcm9wZXJ0eSwKICAgICAgICAgICAgICAgIElGTlVMTCh1bml0cy5uYW1lLCAnJykgQVMgdW5pdAoKICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgQVMgYmFyY29kZXMKICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIEFTIHByb3BzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfcHJvcGVydHkgPSBwcm9wcy5pZAogICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzIEFTIHVuaXRzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfdW5pdCA9IHVuaXRzLmlkCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdIRVJFIGJhcmNvZGVzLmlkX2dvb2QgPSAne2dvb2RzX2lkfScKICAgICAgICAnJycKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbnNlcnRfbm9fc3FsKHF1ZXVlX3VwZGF0ZV9kYXRhKToKICAgICAgICBwcm92aWRlciA9IFNjYW5uaW5nUXVldWVTZXJ2aWNlKCkKICAgICAgICBwcm92aWRlci5zYXZlX3NjYW5uZWRfcm93X2RhdGEocXVldWVfdXBkYXRlX2RhdGEpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF90YWJsZV9saW5lKHRhYmxlX25hbWUsIGZpbHRlcnM6IGRpY3QgPSBOb25lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT10YWJsZV9uYW1lKQogICAgICAgIHNlbGVjdF9wYXJ0ID0gZiIiIlNFTEVDVCAqIEZST00ge3RhYmxlX25hbWV9IiIiCiAgICAgICAgcXVlcnkgPSBzZWxlY3RfcGFydAogICAgICAgIGlmIGZpbHRlcnM6CiAgICAgICAgICAgIGZpbHRlcnNfcGFydCA9ICIiIiBXSEVSRSAiIiIKICAgICAgICAgICAgZm9yIGNvdW50LCBmaWVsZF9uYW1lIGluIGVudW1lcmF0ZShsaXN0KGZpbHRlcnMpKToKICAgICAgICAgICAgICAgIGZpbHRlcnNfcGFydCArPSBmIiIie2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiIGlmIGNvdW50ID09IDAgZWxzZSBcCiAgICAgICAgICAgICAgICAgICAgZiIiIiBBTkQge2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiCiAgICAgICAgICAgIHF1ZXJ5ID0gZiIiIntzZWxlY3RfcGFydH0ge2ZpbHRlcnNfcGFydH0iIiIKCiAgICAgICAgcmVzdWx0ID0gcHJvdmlkZXIuc3FsX3F1ZXJ5KHF1ZXJ5LCAnJykKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIE5vbmUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdXBkYXRlX2xpbmVfcXR0eSh0YWJsZV9saW5lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUlNfZG9jc190YWJsZScpCiAgICAgICAgcHJvdmlkZXIudXBkYXRlKGRhdGE9dGFibGVfbGluZSkKCiAgICBkZWYgbG9nX2Vycm9yKHNlbGYsIGVycm9yX21zZyk6CiAgICAgICAgZXJyb3JfdGV4dCA9IGYiIiLQoNCw0LHQvtGC0LAg0YEg0YjRgtGA0LjRhdC60L7QtNCw0LzQuDoKICAgICAgICAgICAge2Vycm9yX21zZ30iIiIKICAgICAgICBzdXBlcigpLl93cml0ZV9lcnJvcl9vbl9sb2coZXJyb3JfdGV4dCkKCgpjbGFzcyBEb2NTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRvY19pZD0nJywgaXNfZ3JvdXBfc2Nhbj1GYWxzZSwgaXNfYmFyY19mbG93PUZhbHNlKToKICAgICAgICBzZWxmLmRvY19pZCA9IGRvY19pZAogICAgICAgIHNlbGYuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgICAgICBzZWxmLmlzQWRyID0gRmFsc2UKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gaXNfZ3JvdXBfc2NhbgogICAgICAgIHNlbGYuaXNfYmFyY19mbG93ID0gaXNfYmFyY19mbG93CiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc2VsZi5kb2NzX3RhYmxlX25hbWUsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQoKICAgIGRlZiBnZXRfbGFzdF9lZGl0ZWRfZ29vZHMoc2VsZiwgdG9fanNvbj1GYWxzZSk6CiAgICAgICAgcXVlcnlfZG9jcyA9IGYnU0VMRUNUICogRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFdIRVJFIGlkX2RvYyA9ID8gYW5kIHZlcmlmaWVkID0gMScKCiAgICAgICAgcXVlcnlfZ29vZHMgPSBmJycnCiAgICAgICAgU0VMRUNUICogRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9X3RhYmxlCiAgICAgICAgV0hFUkUgaWRfZG9jID0gPyBhbmQgc2VudCA9IDAKICAgICAgICAnJycKCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNfZG9jcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jcywgKHNlbGYuZG9jX2lkLCksIFRydWUpCiAgICAgICAgICAgIHJlc19nb29kcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZ29vZHMsIChzZWxmLmRvY19pZCwpLCBUcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgICAgICAjIHJldHVybiB7J0Vycm9yJzogZS5hcmdzWzBdfQoKICAgICAgICBpZiBub3QgcmVzX2dvb2RzOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICByZXR1cm4gc2VsZi5mb3JtX2RhdGFfZm9yX3JlcXVlc3QocmVzX2RvY3MsIHJlc19nb29kcywgdG9fanNvbikKCiAgICBkZWYgZm9ybV9kYXRhX2Zvcl9yZXF1ZXN0KHNlbGYsIHJlc19kb2NzLCByZXNfZ29vZHMsIHRvX2pzb24pOgogICAgICAgIGZvciBpdGVtIGluIHJlc19kb2NzOgogICAgICAgICAgICBmaWx0ZXJlZF9saXN0ID0gW2QgZm9yIGQgaW4gcmVzX2dvb2RzIGlmIGRbJ2lkX2RvYyddID09IGl0ZW1bJ2lkX2RvYyddXQogICAgICAgICAgICBnb29kc190YWJsZSA9IGYne3NlbGYuZG9jc190YWJsZV9uYW1lfV90YWJsZScKICAgICAgICAgICAgaXRlbVtnb29kc190YWJsZV0gPSBmaWx0ZXJlZF9saXN0CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmlzQWRyOgogICAgICAgICAgICAgICAgaXRlbVsnUlNfZG9jc19iYXJjb2RlcyddID0gW10KICAgICAgICAgICAgICAgIGl0ZW1bJ1JTX2JhcmNfZmxvdyddID0gW10KCiAgICAgICAgaWYgdG9fanNvbjoKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMocmVzX2RvY3MpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHJlc19kb2NzCgogICAgZGVmIHVwZGF0ZV9kYXRhX2Zyb21fanNvbihzZWxmLCBqc29uX2RhdGEpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IGpzb24ubG9hZHMoanNvbl9kYXRhKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZGF0YSA9IGpzb25fZGF0YQoKICAgICAgICBpZiBkYXRhLmdldChzZWxmLmRvY3NfdGFibGVfbmFtZSk6CiAgICAgICAgICAgIHNlbGYudXBkYXRlX2RvY3MoZGF0YSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnVwZGF0ZV9uc2koZGF0YSkKCiAgICBkZWYgdXBkYXRlX2RvY3Moc2VsZiwgZGF0YSk6CiAgICAgICAgZG9jX2lkcyA9ICcsJy5qb2luKFtmJyJ7aXRlbS5nZXQoImlkX2RvYyIpfSInIGZvciBpdGVtIGluIGRhdGFbc2VsZi5kb2NzX3RhYmxlX25hbWVdXSkKCiAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCBpZF9kb2MsIHZlcmlmaWVkCiAgICAgICAgICAgIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBXSEVSRSBpZF9kb2MgSU4gKHtkb2NfaWRzfSkKICAgICAgICAnJycKICAgICAgICBkb2NzID0ge2l0ZW1bJ2lkX2RvYyddOiBpdGVtWyd2ZXJpZmllZCddIG9yIEZhbHNlIGZvciBpdGVtIGluCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQ9cXVlcnksIHJldHVybl9kaWN0PVRydWUpfQoKICAgICAgICBxdWVyaWVzID0gc2VsZi5qc29uX3RvX3NxbGl0ZV9xdWVyeShkYXRhLCBkb2NzKQoKICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcmllczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmFpc2UgZQoKICAgICAgICByZXR1cm4gZG9jcwoKICAgIGRlZiB1cGRhdGVfbnNpKHNlbGYsIGRhdGEpOgogICAgICAgIHF1ZXJpZXMgPSBzZWxmLmpzb25fdG9fc3FsaXRlX3F1ZXJ5KGRhdGEpCgogICAgICAgIGZvciBxdWVyeSBpbiBxdWVyaWVzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICByYWlzZSBlCgogICAgZGVmIHVwZGF0ZV9zZW50X2RhdGEoc2VsZiwgZGF0YSk6CiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgZm9yIGRvYyBpbiBkYXRhOgogICAgICAgICAgICAgICAgaWRfZG9jID0gZG9jWydpZF9kb2MnXQogICAgICAgICAgICAgICAgaWRfZ29vZHMgPSAnLCcuam9pbihbZicie2l0ZW0uZ2V0KCJpZF9nb29kIil9IicgZm9yIGl0ZW0gaW4gZG9jLmdldCgnUlNfZG9jc190YWJsZScsIFtdKV0pCgogICAgICAgICAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgICAgICAgICAgICAgVVBEQVRFIHtzZWxmLmRldGFpbHNfdGFibGVfbmFtZX0KICAgICAgICAgICAgICAgICAgICBTRVQgc2VudCA9IDEKICAgICAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSAne2lkX2RvY30nIEFORCBpZF9nb29kIElOICh7aWRfZ29vZHN9KQogICAgICAgICAgICAgICAgICAgICcnJwoKICAgICAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCgogICAgICAgICAgICBxdWVyeSA9IGYnVVBEQVRFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gU0VUIHNlbnQ9MSBXSEVSRSBpZF9kb2MgPSAie3NlbGYuZG9jX2lkfSInCiAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCgogICAgZGVmIGpzb25fdG9fc3FsaXRlX3F1ZXJ5KHNlbGYsIGRhdGE6IGRpY3QsIGRvY3M9Tm9uZSk6CiAgICAgICAgaWYgZG9jcyBpcyBOb25lOgogICAgICAgICAgICBkb2NzID0ge30KCiAgICAgICAgcWxpc3QgPSBbXQogICAgICAgICMg0KbQuNC60Lsg0L/QviDQuNC80LXQvdCw0Lwg0YLQsNCx0LvQuNGGCiAgICAgICAgdGFibGVfbGlzdCA9ICgKICAgICAgICAgICAgJ1JTX2RvY190eXBlcycsICdSU19nb29kcycsICdSU19wcm9wZXJ0aWVzJywgJ1JTX3VuaXRzJywgJ1JTX3R5cGVzX2dvb2RzJywgJ1JTX3NlcmllcycsICdSU19jb3VudHJhZ2VudHMnLAogICAgICAgICAgICAnUlNfd2FyZWhvdXNlcycsICdSU19wcmljZV90eXBlcycsICdSU19jZWxscycsICdSU19iYXJjb2RlcycsICdSU19wcmljZXMnLCAnUlNfZG9jX3R5cGVzJywgJ1JTX2RvY3MnLAogICAgICAgICAgICAnUlNfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzJywgJ1JTX2Fkcl9kb2NzJywgJ1JTX2Fkcl9kb2NzX3RhYmxlJykgICMgLCwgJ1JTX2JhcmNfZmxvdycKICAgICAgICB0YWJsZV9mb3JfZGVsZXRlID0gKCdSU19kb2NzX3RhYmxlJywgJ1JTX2RvY3NfYmFyY29kZXMsIFJTX2JhcmNfZmxvdycsICdSU19hZHJfZG9jc190YWJsZScpICAjICwgJ1JTX2JhcmNfZmxvdycKICAgICAgICBkb2NfaWRfbGlzdCA9IFtdCiAgICAgICAgZm9yIHRhYmxlX25hbWUgaW4gdGFibGVfbGlzdDoKICAgICAgICAgICAgaWYgbm90IGRhdGEuZ2V0KHRhYmxlX25hbWUpOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICMg0JTQvtCx0LDQstC40Lwg0LIg0LfQsNC/0YDQvtGB0Ysg0YPQtNCw0LvQtdC90LjQtSDQuNC3INCx0LDQt9GLINGB0YLRgNC+0Log0YLQtdGFINC00L7QutGD0LzQtdC90YLQvtCyLCDRh9GC0L4g0LzRiyDQt9Cw0LPRgNGD0LbQsNC10LwKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiB0YWJsZV9mb3JfZGVsZXRlOgogICAgICAgICAgICAgICAgcXVlcnkgPSBmIkRFTEVURSBGUk9NIHt0YWJsZV9uYW1lfSBXSEVSRSBpZF9kb2MgaW4gKHsnLCAnLmpvaW4oZG9jX2lkX2xpc3QpfSkgIgogICAgICAgICAgICAgICAgcWxpc3QuYXBwZW5kKHF1ZXJ5KQoKICAgICAgICAgICAgY29sdW1uX25hbWVzID0gZGF0YVt0YWJsZV9uYW1lXVswXS5rZXlzKCkKICAgICAgICAgICAgaWYgJ21hcmtfY29kZScgaW4gY29sdW1uX25hbWVzOgogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzID0gbGlzdChjb2x1bW5fbmFtZXMpCiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMuYXBwZW5kKCdHVElOJykKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcy5hcHBlbmQoJ1NlcmllcycpCiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMucmVtb3ZlKCdtYXJrX2NvZGUnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzID0gbGlzdChjb2x1bW5fbmFtZXMpCgogICAgICAgICAgICBpZiB0YWJsZV9uYW1lIGluICgnUlNfZG9jcycsICdSU19hZHJfZG9jcycpOiAgIwogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLmFwcGVuZCgndmVyaWZpZWQnKQoKICAgICAgICAgICAgcXVlcnkgPSBmIlJFUExBQ0UgSU5UTyB7dGFibGVfbmFtZX0gKHsnLCAnLmpvaW4ocXVlcnlfY29sX25hbWVzKX0pIFZBTFVFUyAiCiAgICAgICAgICAgIHZhbHVlcyA9IFtdCgogICAgICAgICAgICBmb3Igcm93IGluIGRhdGFbdGFibGVfbmFtZV06CiAgICAgICAgICAgICAgICByb3dfdmFsdWVzID0gW10KICAgICAgICAgICAgICAgIGxpc3RfcXVvdGVkX2ZpZWxkcyA9ICgnbmFtZScsICdmdWxsX25hbWUnLCAibWFya19jb2RlIikKICAgICAgICAgICAgICAgIGZvciBjb2wgaW4gcXVlcnlfY29sX25hbWVzOgogICAgICAgICAgICAgICAgICAgIGlmIGNvbCBpbiBsaXN0X3F1b3RlZF9maWVsZHMgYW5kICJcIiIgaW4gcm93W2NvbF06CiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tjb2xdID0gcm93W2NvbF0ucmVwbGFjZSgiXCIiLCAiXCJcIiIpCgogICAgICAgICAgICAgICAgICAgICMg0JfQtNC10YHRjCDRg9GB0YLQsNC90LDQstC70LjQstCw0LXQvCDRhNC70LDQsyB2ZXJpZmllZCEhIQogICAgICAgICAgICAgICAgICAgIGlmIGNvbCA9PSAndmVyaWZpZWQnIGFuZCAodGFibGVfbmFtZSBpbiBbJ1JTX2RvY3MnLCAnUlNfYWRyX2RvY3MnXSk6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tjb2xdID0gZG9jcy5nZXQocm93WydpZF9kb2MnXSwgMCkKCiAgICAgICAgICAgICAgICAgICAgaWYgcm93LmdldChjb2wpIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tjb2xdID0gJycKCiAgICAgICAgICAgICAgICAgICAgaWYgY29sID09ICdtYXJrX2NvZGUnOiAgIyDQl9Cw0LzQtdC90Y/QtdC8INGN0YLQviDQv9C+0LvQtSDQvdCwINC/0L7Qu9GPIEdUSU4g0LggU2VyaWVzCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNfc3RydWN0ID0gc2VsZi5wYXJzZV9iYXJjb2RlKHJvd1tjb2xdKQogICAgICAgICAgICAgICAgICAgICAgICByb3dfdmFsdWVzLmFwcGVuZChiYXJjX3N0cnVjdFsnR1RJTiddKQogICAgICAgICAgICAgICAgICAgICAgICByb3dfdmFsdWVzLmFwcGVuZChiYXJjX3N0cnVjdFsnU2VyaWVzJ10pCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQocm93W2NvbF0pICAjIChmJyJ7cm93W2NvbF19IicpCgogICAgICAgICAgICAgICAgICAgIGlmIGNvbCA9PSAnaWRfZG9jJyBhbmQgKHRhYmxlX25hbWUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ10pOgogICAgICAgICAgICAgICAgICAgICAgICBkb2NfaWRfbGlzdC5hcHBlbmQoJyInICsgcm93W2NvbF0gKyAnIicpCgogICAgICAgICAgICAgICAgZm9ybWF0dGVkX3ZhbCA9IFtmJyJ7eH0iJyBpZiBpc2luc3RhbmNlKHgsIHN0cikgZWxzZSBzdHIoeCkgZm9yIHggaW4gcm93X3ZhbHVlc10KICAgICAgICAgICAgICAgIHZhbHVlcy5hcHBlbmQoZiIoeycsICcuam9pbihmb3JtYXR0ZWRfdmFsKX0pIikKICAgICAgICAgICAgcXVlcnkgKz0gIiwgIi5qb2luKHZhbHVlcykKICAgICAgICAgICAgcWxpc3QuYXBwZW5kKHF1ZXJ5KQoKICAgICAgICByZXR1cm4gcWxpc3QKCiAgICBkZWYgZ2V0X2FsbF9hcnRpY2xlc19pbl9kb2N1bWVudChzZWxmKSAtPiBMaXN0W3N0cl06CiAgICAgICAgcXVlcnkgPSAoJ1NFTEVDVCBESVNUSU5DVCBSU19nb29kcy5hcnQgYXMgYXJ0JwogICAgICAgICAgICAgICAgICcgRlJPTSBSU19kb2NzX3RhYmxlJwogICAgICAgICAgICAgICAgICcgTEVGVCBKT0lOIFJTX2dvb2RzIE9OIFJTX2RvY3NfdGFibGUuaWRfZ29vZCA9IFJTX2dvb2RzLmlkJwogICAgICAgICAgICAgICAgICcgV0hFUkUgUlNfZG9jc190YWJsZS5pZF9kb2MgPSA/JykKICAgICAgICBnb29kcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHF1ZXJ5LCBzZWxmLmRvY19pZCkKICAgICAgICByZXR1cm4gW2dvb2RbJ2FydCddIGZvciBnb29kIGluIGdvb2RzXSBpZiBnb29kcyBpcyBub3QgTm9uZSBlbHNlIFtdCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3M9Tm9uZSwgcmV0dXJuX2RpY3Q9RmFsc2UpOgogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3M9YXJncywgcmV0dXJuX2RpY3Q9cmV0dXJuX2RpY3QpCgogICAgZGVmIHNldF9kb2NfdmFsdWUoc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgICAgIFVQREFURSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9CiAgICAgICAgICAgIFNFVCB7a2V5fSA9IHt2YWx1ZX0KICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gIntzZWxmLmRvY19pZH0iCiAgICAgICAgICAgICcnJwoKICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgIGRlZiBzZXRfZG9jX3ZhbHVlcyhzZWxmLCAqKnZhbHVlcyk6CiAgICAgICAgaWYgbm90IHZhbHVlczoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNldF9maWVsZHMgPVtmJ3trfT17dn0nZm9yIGssIHYgaW4gdmFsdWVzLml0ZW1zKCldCiAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgICAgIFVQREFURSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9CiAgICAgICAgICAgIFNFVCB7JywnLmpvaW4oc2V0X2ZpZWxkcyl9CiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ICJ7c2VsZi5kb2NfaWR9IgogICAgICAgICAgICAnJycKCiAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKCiAgICBkZWYgZ2V0X2RvY192YWx1ZShzZWxmLCBrZXksIGlkX2RvYyk6CiAgICAgICAgcXVlcnkgPSBmJ1NFTEVDVCB7a2V5fSBmcm9tIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGlkX2RvYywpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXVtrZXldCgogICAgZGVmIGdldF9kb2NfdHlwZXMoc2VsZikgLT4gbGlzdDoKICAgICAgICB3aGVyZV9ncm91cF9zY2FuID0gZidpc19ncm91cF9zY2FuID0gIjAiJyBpZiBzZWxmLmlzX2dyb3VwX3NjYW4gaXMgRmFsc2UgZWxzZSBUcnVlCgogICAgICAgIHdoZXJlX2VtcHR5ID0gKCJSU19kb2NzLmlkX2RvYyBub3QgaW4gIgogICAgICAgICAgICAgICAgICAgICAgICIoU0VMRUNUIGRpc3RpbmN0IGlkX2RvYyBGcm9tIFJTX2RvY3NfdGFibGUpIikKICAgICAgICB3aGVyZV9iYXJjX2Zsb3cgPSBmJyhpc19iYXJjX2Zsb3cgPSAiMSIgT1Ige3doZXJlX2VtcHR5fSknIFwKICAgICAgICAgICAgaWYgc2VsZi5pc19iYXJjX2Zsb3cgZWxzZSBmJ2lzX2JhcmNfZmxvdyA9ICIwIicKCiAgICAgICAgd2hlcmUgPSBmInt3aGVyZV9ncm91cF9zY2FufSBBTkQge3doZXJlX2JhcmNfZmxvd30iCgogICAgICAgIHF1ZXJ5X3RleHQgPSBmJ1NFTEVDVCBESVNUSU5DVCBkb2NfdHlwZSBmcm9tIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0nCiAgICAgICAgcXVlcnkgPSBmIntxdWVyeV90ZXh0fSBXSEVSRSB7d2hlcmV9IgoKICAgICAgICBkb2NfdHlwZXMgPSBbcmVjWzBdIGZvciByZWMgaW4gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSldCiAgICAgICAgcmV0dXJuIGRvY190eXBlcwoKICAgIGRlZiBnZXRfZG9jX3ZpZXdfZGF0YShzZWxmLCBkb2NfdHlwZT0nJywgZG9jX3N0YXR1cz0nJykgLT4gbGlzdDoKICAgICAgICBmaWVsZHMgPSBbCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9kb2MnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX3R5cGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX24nLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCIiKSBhcyBSU193YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbChSU193YXJlaG91c2VzLm5hbWUsIiIpIGFzIHdhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0udmVyaWZpZWQsIDApIGFzIHZlcmlmaWVkJywKICAgICAgICAgICAgZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5zZW50LCAwKSBhcyBzZW50JywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmFkZF9tYXJrX3NlbGVjdGlvbicsCiAgICAgICAgXQoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2NvdW50cmFnZW50cycpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19ncm91cF9zY2FuLCAwKSBhcyBpc19ncm91cF9zY2FuJykKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ2lmbnVsbChSU19jb3VudHJhZ2VudHMuZnVsbF9uYW1lLCAiIikgYXMgUlNfY291bnRyYWdlbnQnKQoKICAgICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCAnICsgJyxcbicuam9pbihmaWVsZHMpCgogICAgICAgIGpvaW5zID0gZicnJ0ZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgICAgICAgICAgICBPTiBSU193YXJlaG91c2VzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF93YXJlaG91c2UKICAgICAgICAnJycKCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBqb2lucyArPSBmJycnCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jb3VudHJhZ2VudHMgYXMgUlNfY291bnRyYWdlbnRzCiAgICAgICAgICAgICAgICBPTiBSU19jb3VudHJhZ2VudHMuaWQgPSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgJycnCiAgICAgICAgd2hlcmUgPSAnJwoKICAgICAgICBpZiBkb2Nfc3RhdHVzOgogICAgICAgICAgICBpZiBkb2Nfc3RhdHVzID09ICLQktGL0LPRgNGD0LbQtdC9IjoKICAgICAgICAgICAgICAgIHdoZXJlID0gIldIRVJFIHNlbnQ9MSBBTkQgdmVyaWZpZWQ9MSIKICAgICAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0LPRgNGD0LfQutC1IjoKICAgICAgICAgICAgICAgIHdoZXJlID0gIldIRVJFIGlmbnVsbCh2ZXJpZmllZCwwKT0xIEFORCBpZm51bGwoc2VudCwwKT0wIgogICAgICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQv9C+0LvQvdC10L3QuNGOIjoKICAgICAgICAgICAgICAgIHdoZXJlID0gIldIRVJFIGlmbnVsbCh2ZXJpZmllZCwwKT0wIEFORCBpZm51bGwoc2VudCwwKT0wIgoKICAgICAgICBpZiBub3QgZG9jX3R5cGUgb3IgZG9jX3R5cGUgPT0gItCS0YHQtSI6CiAgICAgICAgICAgIGFyZ3NfdHVwbGUgPSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXJnc190dXBsZSA9IChkb2NfdHlwZSwpCiAgICAgICAgICAgIGlmIG5vdCBkb2Nfc3RhdHVzIG9yIGRvY19zdGF0dXMgPT0gItCS0YHQtSI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICdXSEVSRSBkb2NfdHlwZT0/JwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gJyBBTkQgZG9jX3R5cGU9PycKCiAgICAgICAgaWYgc2VsZi5pc19ncm91cF9zY2FuIGlzIEZhbHNlIGFuZCBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gZicgQU5EIGlzX2dyb3VwX3NjYW49e2ludChzZWxmLmlzX2dyb3VwX3NjYW4pfScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdoZXJlID0gZicgV0hFUkUgaXNfZ3JvdXBfc2Nhbj17aW50KHNlbGYuaXNfZ3JvdXBfc2Nhbil9JwogICAgICAgIAogICAgICAgIGlmIHNlbGYuaXNfYmFyY19mbG93IGlzIEZhbHNlIGFuZCBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gZicgQU5EIGlzX2JhcmNfZmxvdz17aW50KHNlbGYuaXNfYmFyY19mbG93KX0nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aGVyZSA9IGYnIFdIRVJFIGlzX2JhcmNfZmxvdz17aW50KHNlbGYuaXNfYmFyY19mbG93KX0nCiAgICAgICAgCiAgICAgICAgcXVlcnlfdGV4dCA9IGYnJycKICAgICAgICAgICAge3F1ZXJ5X3RleHR9CiAgICAgICAgICAgIHtqb2luc30KICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICBPUkRFUiBCWSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19kYXRlCiAgICAgICAgJycnCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzX3R1cGxlLCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZGVsZXRlX2RvYyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5ZXMgPSAoCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2JhcmNfZmxvdyBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICAnREVMRVRFIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICAnREVMRVRFIEZST00gUlNfZG9jc19zZXJpZXMgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2RvY3NfYmFyY29kZXMgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgZidERUxFVEUgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICkKICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcnllczoKICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGlkX2RvYywpKQoKICAgIGRlZiBkZWxldGVfYWRyX2RvYyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5ZXMgPSAoCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICdERUxFVEUgRlJPTSBSU19hZHJfZG9jcyBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICApCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJ5ZXM6CiAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIChpZF9kb2MsKSkKCiAgICBkZWYgZGVsZXRlX29sZF9kb2NzKHNlbGYsIGRheXM6IGludCkgLT4gbGlzdDoKICAgICAgICBvbGRfZG9jc19pZHMgPSBzZWxmLl9maW5kX29sZF9kb2NzKGRheXMpCiAgICAgICAgb2xkX2Fkcl9kb2NzX2lkcyA9IHNlbGYuX2ZpbmRfb2xkX2RvY3MoZGF5cywgJ1JTX2Fkcl9kb2NzJykKICAgICAgICBmb3IgaWRfZG9jIGluIG9sZF9kb2NzX2lkczoKICAgICAgICAgICAgc2VsZi5kZWxldGVfZG9jKGlkX2RvYykKICAgICAgICBmb3IgaWRfZG9jIGluIG9sZF9hZHJfZG9jc19pZHM6CiAgICAgICAgICAgIHNlbGYuZGVsZXRlX2Fkcl9kb2MoaWRfZG9jKQogICAgICAgIHJldHVybiBvbGRfZG9jc19pZHMgKyBvbGRfYWRyX2RvY3NfaWRzCgogICAgZGVmIF9maW5kX29sZF9kb2NzKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBkYXlzOiBpbnQsCiAgICAgICAgICAgIHRhYmxlOiBMaXRlcmFsWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ10gPSAnUlNfZG9jcycKICAgICkgLT4gTGlzdFtzdHJdOgogICAgICAgICIiItCS0L7Qt9Cy0YDQsNGJ0LDQtdGCINGB0L/QuNGB0L7QuiBpZCDQstGB0LXRhSDRg9GB0YLQsNGA0LXQstGI0LjRhSDQtNC+0LrRg9C80LXQvdGC0L7QsiIiIgogICAgICAgIHF1ZXJ5ID0gZicnJ1NFTEVDVCBpZF9kb2MgRlJPTSB7dGFibGV9IFdIRVJFIGNyZWF0ZWRfYXQgPCA/JycnCiAgICAgICAgY3VycmVudF9kYXRldGltZSA9IGRhdGV0aW1lLm5vdyh0ej10aW1lem9uZS51dGMpCiAgICAgICAgdGFyZ2V0X3RpbWUgPSBjdXJyZW50X2RhdGV0aW1lIC0gdGltZWRlbHRhKGRheXM9ZGF5cykKICAgICAgICBkb2NzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKHRhcmdldF90aW1lLCApKQogICAgICAgIHJldHVybiBbZG9jWzBdIGZvciBkb2MgaW4gZG9jc10KCiAgICBkZWYgZ2V0X2RvY3Nfc3RhdChzZWxmKToKICAgICAgICB3aGVyZV9ncm91cF9zY2FuID0gZidpc19ncm91cF9zY2FuID0gIjAiJyBpZiBzZWxmLmlzX2dyb3VwX3NjYW4gaXMgRmFsc2UgZWxzZSBUcnVlCiAgICAgICAgd2hlcmVfYmFyY19mbG93ID0gZidpc19iYXJjX2Zsb3cgPSAiMCInIGlmIHNlbGYuaXNfYmFyY19mbG93IGlzIEZhbHNlIGVsc2UgVHJ1ZQogICAgICAgIHdoZXJlID0gZiJ7d2hlcmVfZ3JvdXBfc2Nhbn0gQU5EIHt3aGVyZV9iYXJjX2Zsb3d9IgoKICAgICAgICBxdWVyeV9zZWxlY3QgPSBmJycnCiAgICAgICAgV0lUSCB0bXAgQVMgKAogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBkb2NfdHlwZSwKICAgICAgICAgICAgICAgIGRvY3NfdGFibGUuaWRfZG9jLAogICAgICAgICAgICAgICAgMSBhcyBkb2NfQ291bnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jc190YWJsZS5zZW50LDApIGFzIHNlbnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jc190YWJsZS52ZXJpZmllZCwwKSBhcyB2ZXJpZmllZCwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NzX3RhYmxlLmlzX2dyb3VwX3NjYW4sIDApIGFzIGlzX2dyb3VwX3NjYW4sCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jc190YWJsZS5pc19iYXJjX2Zsb3csIDApIGFzIGlzX2JhcmNfZmxvdywKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MCBUSEVOIAogICAgICAgICAgICAgICAgICAgIENPVU5UKGRvY3NfZGV0YWlscy5pZCkKICAgICAgICAgICAgICAgIEVMU0UgCiAgICAgICAgICAgICAgICAgICAgMCAKICAgICAgICAgICAgICAgIEVORCBhcyBjb3VudF92ZXJpZmllZCwKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MSBUSEVOIAogICAgICAgICAgICAgICAgICAgIGNvdW50KGRvY3NfZGV0YWlscy5pZCkKICAgICAgICAgICAgICAgIEVMU0UgCiAgICAgICAgICAgICAgICAgICAgMCAKICAgICAgICAgICAgICAgIEVORCBhcyBjb3VudF91bnZlcmlmaWVkLAogICAgICAgICAgICAgICAgQ0FTRSBXSEVOIElGTlVMTCh2ZXJpZmllZCwwKT0wIFRIRU4KICAgICAgICAgICAgICAgICAgICAgU1VNKGRvY3NfZGV0YWlscy5xdHR5X3BsYW4pCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgcXR0eV9wbGFuX3ZlcmlmaWVkLAogICAgICAgICAgICAgICAgQ0FTRSBXSEVOIElGTlVMTCh2ZXJpZmllZCwwKT0xIFRIRU4gCiAgICAgICAgICAgICAgICAgICAgU1VNKGRvY3NfZGV0YWlscy5xdHR5X3BsYW4pCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgcXR0eV9wbGFuX3VudmVyaWZpZWQKICAgICAgICAgICAgRlJPTSBSU19kb2NzIEFTIGRvY3NfdGFibGUKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2RvY3NfdGFibGUgQVMgZG9jc19kZXRhaWxzCiAgICAgICAgICAgICAgICBPTiBkb2NzX2RldGFpbHMuaWRfZG9jID0gZG9jc190YWJsZS5pZF9kb2MKICAgICAgICAgICAgR1JPVVAgQlkgZG9jc190YWJsZS5pZF9kb2MKICAgICAgICApCiAgICAgICAgU0VMRUNUIAogICAgICAgICAgICBkb2NfdHlwZSBhcyBkb2NUeXBlLCAKICAgICAgICAgICAgQ09VTlQoaWRfZG9jKSwKICAgICAgICAgICAgU1VNKGRvY19Db3VudCkgYXMgY291bnQsIAogICAgICAgICAgICBTVU0oc2VudCkgYXMgc2VudCwgCiAgICAgICAgICAgIFNVTSh2ZXJpZmllZCkgYXMgdmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShjb3VudF92ZXJpZmllZCkgYXMgY291bnRfdmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShjb3VudF91bnZlcmlmaWVkKSBhcyBjb3VudF91bnZlcmlmaWVkLAogICAgICAgICAgICBTVU0ocXR0eV9wbGFuX3ZlcmlmaWVkKSBhcyBxdHR5X3BsYW5fdmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShxdHR5X3BsYW5fdW52ZXJpZmllZCkgYXMgcXR0eV9wbGFuX3VudmVyaWZpZWQKICAgICAgICBGUk9NIHRtcAogICAgICAgIFdIRVJFIHt3aGVyZX0KICAgICAgICBHUk9VUCBCWSBkb2NfdHlwZQogICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfc2VsZWN0LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgZ2V0X2RvY19mbG93X3N0YXQoc2VsZik6CiAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgV0lUSCB0bXAgQVMgKAogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBkb2NfdHlwZSwKICAgICAgICAgICAgICAgIFJTX2RvY3MuaWRfZG9jLAogICAgICAgICAgICAgICAgMSBhcyBkb2NfQ291bnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5zZW50LDApIGFzIHNlbnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy52ZXJpZmllZCwwKSBhcyB2ZXJpZmllZCwKCiAgICAgICAgICAgICAgICBjb3VudChSU19iYXJjX2Zsb3cuYmFyY29kZSkgYXMgYmFyY19jb3VudAoKICAgICAgICAgICAgRlJPTSBSU19kb2NzCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY19mbG93IAogICAgICAgICAgICAgICAgT04gUlNfZG9jcy5pZF9kb2MgPSBSU19iYXJjX2Zsb3cuaWRfZG9jCiAgICAgICAgICAgICAgICAKICAgICAgICAgICBXSEVSRSAgUlNfZG9jcy5pZF9kb2Mgbm90IGluIChTRUxFQ1QgZGlzdGluY3QKICAgICAgICAgICAgICAgIGlkX2RvYwogICAgICAgICAgICAgICAgRnJvbSAKICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUKICAgICAgICAgICAgICAgICkKICAgICAgICAgICBBTkQgaXNfZ3JvdXBfc2NhbiA9IDAKICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAKICAgICAgICAgICBHUk9VUCBCWSBSU19kb2NzLmlkX2RvYwogICAgICAgICkKICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgIGRvY190eXBlIGFzIGRvY1R5cGUsIAogICAgICAgICAgICBDT1VOVChpZF9kb2MpIGFzIGlkX2NvdW50LAogICAgICAgICAgICBTVU0oZG9jX0NvdW50KSBhcyBjb3VudCwgCiAgICAgICAgICAgIFNVTShzZW50KSBhcyBzZW50LCAKICAgICAgICAgICAgU1VNKHZlcmlmaWVkKSBhcyB2ZXJpZmllZCwKICAgICAgICAgICAgU1VNKGJhcmNfY291bnQpIGFzIGJhcmNfY291bnQKICAgICAgICBGUk9NIHRtcAogICAgICAgIEdST1VQIEJZIGRvY190eXBlCiAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBpZF9kb2M6IHN0ciwKICAgICAgICAgICAgZmlyc3RfZWxlbTogaW50LAogICAgICAgICAgICBpdGVtc19vbl9wYWdlOiBpbnQsCiAgICAgICAgICAgIGFydGljbGVzX2xpc3Q6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgICAgICAgICByb3dfZmlsdGVyczogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgIHNlYXJjaF9zdHJpbmc6IE9wdGlvbmFsW3N0cl0gPSBOb25lCiAgICApIC0+IGxpc3Q6CiAgICAgICAgc2VsZWN0X3F1ZXJ5ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIFJTX2dvb2RzLmNvZGUsCiAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3NlcmllcywKICAgICAgICAgICAgUlNfc2VyaWVzLm5hbWUgYXMgc2VyaWVzX25hbWUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfdW5pdHMubmFtZSBhcyB1bml0c19uYW1lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmRfcXR0eSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5wcmljZSwKICAgICAgICAgICAgUlNfcHJpY2VfdHlwZXMubmFtZSBhcyBwcmljZV9uYW1lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiAtUlNfZG9jc190YWJsZS5xdHR5IGFzIElzRG9uZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5sYXN0X3VwZGF0ZWQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUudXNlX3NlcmllcwogICAgICAgICAgICAKICAgICAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlIAoKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzIAogICAgICAgICAgICBPTiBSU19nb29kcy5pZD1SU19kb2NzX3RhYmxlLmlkX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9UlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgICAgICAgICAgT04gUlNfc2VyaWVzLmlkID1SU19kb2NzX3RhYmxlLmlkX3NlcmllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSBSU19kb2NzX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3ByaWNlX3R5cGVzCiAgICAgICAgICAgIE9OIFJTX3ByaWNlX3R5cGVzLmlkID1SU19kb2NzX3RhYmxlLmlkX3ByaWNlCiAgICAgICAgICAgICIiIgoKICAgICAgICB3aGVyZSA9IGYiIiJXSEVSRSBpZF9kb2MgPSAne3N0cihpZF9kb2MpfSciIiIKICAgICAgICByb3dfZmlsdGVyc19jb25kaXRpb24gPSAiIiJBTkQgcXR0eSAhPSBDT0FMRVNDRShxdHR5X3BsYW4sICcwJykgIiIiIGlmIHJvd19maWx0ZXJzIGVsc2UgJycKICAgICAgICBzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbiA9IGYiIiJBTkQgZ29vZF9uYW1lIExJS0UgJyV7c2VhcmNoX3N0cmluZ30lJyIiIiBpZiBzZWFyY2hfc3RyaW5nIGVsc2UgJycKCiAgICAgICAgd2hlcmVfcXVlcnkgPSBmIiIiCiAgICAgICAge3doZXJlfQogICAgICAgIHtyb3dfZmlsdGVyc19jb25kaXRpb259CiAgICAgICAge3NlYXJjaF9zdHJpbmdfY29uZGl0aW9ufQogICAgICAgICIiIgogICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGlmIGFydGljbGVzX2xpc3Q6CiAgICAgICAgICAgIHdoZXJlX3F1ZXJ5ICs9IGYiIiJBTkQgYXJ0IElOICh7JywnLmpvaW4oJz8nIGZvciBfIGluIGFydGljbGVzX2xpc3QpfSkiIiIKICAgICAgICAgICAgYXJncyArPSB0dXBsZShhcnRpY2xlc19saXN0KQogICAgICAgIG9yZGVyX2J5ID0gIiIiT1JERVIgQlkgbGFzdF91cGRhdGVkIERFU0MiIiIKICAgICAgICBsaW1pdCA9IGYnTElNSVQge2l0ZW1zX29uX3BhZ2V9IE9GRlNFVCB7Zmlyc3RfZWxlbX0nCiAgICAgICAgcXVlcnkgPSBmIntzZWxlY3RfcXVlcnl9IHt3aGVyZV9xdWVyeX0ge29yZGVyX2J5fSB7bGltaXR9IgoKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCBhcmdzLCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgICMgcmVzID0gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5LCAnJykKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGdldF9kb2NfZGV0YWlsc19yb3dzX2NvdW50KHNlbGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFydGljbGVzX2xpc3Q6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd19maWx0ZXJzOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hfc3RyaW5nOiBPcHRpb25hbFtzdHJdID0gTm9uZQopOgogICAgICAgIHNlbGVjdF9xdWVyeSA9IGYiIiJTRUxFQ1QgQ09VTlQoKikgYXMgcm93c19xdHR5IEZST00ge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfSBBUyBkb2NzX3RhYmxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTiBkb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZCIiIgogICAgICAgIHdoZXJlID0gZiIiIldIRVJFIGlkX2RvYyA9ICd7c3RyKGlkX2RvYyl9JyIiIgogICAgICAgIHJvd19maWx0ZXJzX2NvbmRpdGlvbiA9ICIiIkFORCBxdHR5ICE9IENPQUxFU0NFKHF0dHlfcGxhbiwgJzAnKSAiIiIgaWYgcm93X2ZpbHRlcnMgZWxzZSAnJwogICAgICAgIHNlYXJjaF9zdHJpbmdfY29uZGl0aW9uID0gZiIiIkFORCBuYW1lIExJS0UgJyV7c2VhcmNoX3N0cmluZ30lJyIiIiBpZiBzZWFyY2hfc3RyaW5nIGVsc2UgJycKCiAgICAgICAgd2hlcmVfcXVlcnkgPSBmIiIiCiAgICAgICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgICAgICB7cm93X2ZpbHRlcnNfY29uZGl0aW9ufQogICAgICAgICAgICAgICAge3NlYXJjaF9zdHJpbmdfY29uZGl0aW9ufQogICAgICAgICAgICAgICAgIiIiCiAgICAgICAgYXJncyA9ICgpCiAgICAgICAgaWYgYXJ0aWNsZXNfbGlzdDoKICAgICAgICAgICAgd2hlcmVfcXVlcnkgKz0gZiIiIkFORCBhcnQgSU4gKHsnLCcuam9pbignPycgZm9yIF8gaW4gYXJ0aWNsZXNfbGlzdCl9KSIiIgogICAgICAgICAgICBhcmdzICs9IHR1cGxlKGFydGljbGVzX2xpc3QpCiAgICAgICAgcXVlcnkgPSBmIntzZWxlY3RfcXVlcnl9IHt3aGVyZV9xdWVyeX0iCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgYXJncywgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzWzBdWydyb3dzX3F0dHknXQoKCiAgICBkZWYgcGFyc2VfYmFyY29kZShzZWxmLCB2YWwpOgogICAgICAgIGlmIGxlbih2YWwpIDwgMjE6CiAgICAgICAgICAgIHJldHVybiB7J0dUSU4nOiAnJywgJ1Nlcmllcyc6ICcnfQoKICAgICAgICB2YWwucmVwbGFjZSgnKDAxKScsICcwMScpCiAgICAgICAgdmFsLnJlcGxhY2UoJygyMSknLCAnMjEnKQoKICAgICAgICBpZiB2YWxbOjJdID09ICcwMSc6CiAgICAgICAgICAgIEdUSU4gPSB2YWxbMjoxNl0KICAgICAgICAgICAgU2VyaWVzID0gdmFsWzE4Ol0KICAgICAgICBlbHNlOgogICAgICAgICAgICBHVElOID0gdmFsWzoxNF0KICAgICAgICAgICAgU2VyaWVzID0gdmFsWzE0Ol0KCiAgICAgICAgcmV0dXJuIHsnR1RJTic6IEdUSU4sICdTZXJpZXMnOiBTZXJpZXN9CgogICAgZGVmIGNsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAoJ1VwZGF0ZSBSU19kb2NzX2JhcmNvZGVzIFNldCBhcHByb3ZlZCA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ0RlbGV0ZSBGcm9tIFJTX2RvY3NfYmFyY29kZXMgV2hlcmUgIGlkX2RvYz06aWRfZG9jIEFuZCBpc19wbGFuID0gMCcsCiAgICAgICAgICAgICAgICAgICAgICAnVXBkYXRlIFJTX2RvY3NfdGFibGUgU2V0IHF0dHkgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdVcGRhdGUgUlNfZG9jc190YWJsZSBTZXQgZF9xdHR5ID0gMCBXaGVyZSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICAgICAgICAgICAnVXBkYXRlIFJTX2RvY3MgU2V0IGlzX2dyb3VwX3NjYW4gPSAiMCIgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ1VwZGF0ZSBSU19kb2NzIFNldCBpc19iYXJjX2Zsb3cgPSAiMCIgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ0RlbGV0ZSBGcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jPTppZF9kb2MgYW5kIGlzX3BsYW4gPSAiRmFsc2UiJywKICAgICAgICAgICAgICAgICAgICAgICdEZWxldGUgRnJvbSBSU19iYXJjX2Zsb3cgV2hlcmUgaWRfZG9jID0gOmlkX2RvYycpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmb3IgZWwgaW4gcXVlcnlfdGV4dDoKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQoZWwsICh7J2lkX2RvYyc6IGlkX2RvY30pKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogRmFsc2UsICdlcnJvcic6IGUuYXJnc1swXX0KCiAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogVHJ1ZSwgJ2Vycm9yJzogJyd9CgogICAgZGVmIGdldF9tYXJrc19kYXRhKHNlbGYsIGlkX2RvYywgZG9jX3Jvd19pZCk6CiAgICAgICAgcXVlcnkgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIGIubWFya19jb2RlLAogICAgICAgICAgICAgICAgYi5hcHByb3ZlZCAKICAgICAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzIEFTIGIKICAgICAgICAgICAgSk9JTiBSU19kb2NzX3RhYmxlIGFzIHQKICAgICAgICAgICAgICAgIE9OIGIuaWRfZG9jPXQuaWRfZG9jIEFORAogICAgICAgICAgICAgICAgICAgIGIuaWRfZ29vZCA9IHQuaWRfZ29vZCBBTkQKICAgICAgICAgICAgICAgICAgICBiLmlkX3Byb3BlcnR5ID0gdC5pZF9wcm9wZXJ0aWVzIEFORAogICAgICAgICAgICAgICAgICAgIGIuaWRfc2VyaWVzID0gdC5pZF9zZXJpZXMgQU5ECiAgICAgICAgICAgICAgICAgICAgdC5pZCA9ICJ7ZG9jX3Jvd19pZH0iCiAgICAgICAgICAgIAogICAgICAgICAgICBXSEVSRSBiLmlkX2RvYyA9ICJ7aWRfZG9jfSIKICAgICAgICAnJycKCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGdldF9kb2NzX2NvdW50KHNlbGYsIGRvY190eXBlPScnKToKICAgICAgICBxdWVyeSA9IGYnU0VMRUNUIENPVU5UKCopIEFTIGRvY3NfY291bnQgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9JwogICAgICAgIGFyZ3MgPSBOb25lCgogICAgICAgIGlmIGRvY190eXBlOgogICAgICAgICAgICBxdWVyeSA9ICdcbicuam9pbihbcXVlcnksICdXSEVSRSBkb2NfdHlwZSA9ID8nXSkKICAgICAgICAgICAgYXJncyA9IChkb2NfdHlwZSwpCgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIGFyZ3MsIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdLmdldCgnZG9jc19jb3VudCcsIDApCiAgICAgICAgcmV0dXJuIDAKCiAgICBkZWYgZ2V0X2V4aXN0aW5nX2RvY3Moc2VsZik6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiU0VMRUNUIGRvY19uLGRvY190eXBlIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB3cml0ZV9lcnJvcl9vbl9sb2coRXJyX3ZhbHVlKToKICAgICAgICBpZiBFcnJfdmFsdWU6CiAgICAgICAgICAgIHF0ZXh0ID0gJ0luc2VydCBpbnRvIEVycm9yX2xvZyhsb2cpIFZhbHVlcyg/KScKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKEVycl92YWx1ZSwpKQoKICAgIGRlZiBnZXRfZG9jc19hbmRfZ29vZHNfZm9yX3VwbG9hZChzZWxmKToKCiAgICAgICAgcXVlcnlfZG9jcyA9IGYnJydTRUxFQ1QgKiBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gV0hFUkUgdmVyaWZpZWQgPSAxICBhbmQgKHNlbnQgPD4gMSBvciBzZW50IGlzIG51bGwpJycnCiAgICAgICAgcXVlcnlfZ29vZHMgPSBmJycnU0VMRUNUICogRlJPTSB7c2VsZi5kZXRhaWxzX3RhYmxlX25hbWV9IFdIRVJFIChzZW50ID0gMCBPUiBzZW50IGlzIE51bGwpJycnCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNfZG9jcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jcywgTm9uZSwgVHJ1ZSkKICAgICAgICAgICAgcmVzX2dvb2RzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9nb29kcywgTm9uZSwgVHJ1ZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJhaXNlIGUKICAgICAgICBpZiBub3QgcmVzX2dvb2RzOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHJldHVybiBzZWxmLmZvcm1fZGF0YV9mb3JfcmVxdWVzdChyZXNfZG9jcywgcmVzX2dvb2RzLCBGYWxzZSkKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmLCBpZF9kb2M9JycpOgogICAgICAgIGRhdGEgPSBbXQoKICAgICAgICBkb2NfaWRfY29uZGl0aW9uID0gZidpZF9kb2M9IntpZF9kb2N9IicgaWYgaWRfZG9jIGVsc2UgJ3ZlcmlmaWVkID0gMSBBTkQgSUZOVUxMKHNlbnQsIDApID0gMCcKCiAgICAgICAgcSA9IGYnJydTRUxFQ1QgaWRfZG9jCiAgICAgICAgICAgICAgICBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gCiAgICAgICAgICAgICAgICBXSEVSRSB7ZG9jX2lkX2NvbmRpdGlvbn0KICAgICAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKCiAgICAgICAgZm9yIHJvdyBpbiByZXM6CiAgICAgICAgICAgIGlkX2RvYyA9IHJvd1snaWRfZG9jJ10KCiAgICAgICAgICAgIGRvY19kYXRhID0gewogICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGlkX2RvYywKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnaWRfZ29vZCcsICdpZF9wcm9wZXJ0aWVzJywgJ2lkX3NlcmllcycsICdpZF91bml0JywgJ3F0dHknLCAncXR0eV9wbGFuJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gQU5EIChzZW50ID0gMCBPUiBzZW50IElTIE5VTEwpCiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIGdvb2RzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfZG9jc190YWJsZSddID0gZ29vZHMKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydHknLCAnaWRfc2VyaWVzJywgJ2JhcmNvZGVfZnJvbV9zY2FubmVyJywgJ0dUSU4nLCAnU2VyaWVzJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gQU5EIElGTlVMTChiYXJjb2RlX2Zyb21fc2Nhbm5lciwgJycpIDw+ICcnCiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIGRvY19iYXJjb2RlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXSA9IGRvY19iYXJjb2RlcwoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnYmFyY29kZSddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjX2Zsb3cKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8KICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQoKICAgICAgICAgICAgYmFyY19mbG93ID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfYmFyY19mbG93J10gPSBiYXJjX2Zsb3cKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfc2VyaWVzJywgJ2lkX3dhcmVob3VzZScsICdxdHR5JywgJ25hbWUnLCAnYmVzdF9iZWZvcmUnLCAnbnVtYmVyJywKICAgICAgICAgICAgICAgICAgICAgICdwcm9kdWN0aW9uX2RhdGUnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8KICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQoKICAgICAgICAgICAgc2VyaWVzX3RhYmxlID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfZG9jc19zZXJpZXMnXSA9IHNlcmllc190YWJsZQogICAgICAgICAgICBkYXRhLmFwcGVuZChkb2NfZGF0YSkKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZF9ieV9kb2NfaWQoc2VsZiwgaWRfZG9jKToKICAgICAgICByZXR1cm4gc2VsZi5nZXRfZGF0YV90b19zZW5kKGlkX2RvYz1pZF9kb2MpCgogICAgZGVmIGdldF9jb3VudF9tYXJrX2NvZGVzKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcSA9ICcnJwogICAgICAgICAgICBTRUxFQ1QgRElTVElOQ1QgQ09VTlQoaWQpIGFzIGNvbF9zdHIgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcyBXSEVSRSBpZF9kb2MgPSA/IEFORCBpc19wbGFuID0gMQogICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYuX3NxbF9xdWVyeSgKICAgICAgICAgICAgcT1xLAogICAgICAgICAgICBwYXJhbXM9aWRfZG9jLAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJlc1swXVsnY29sX3N0ciddCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHVwZGF0ZV91cGxvYWRlZF9kb2NzX3N0YXR1cyhkb2NfaW5fc3RyKToKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3MgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgIHF0ZXh0ID0gZidVUERBVEUgUlNfYWRyX2RvY3MgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgIHF0ZXh0ID0gZidVUERBVEUgUlNfZG9jc190YWJsZSBTRVQgc2VudCA9IDEgIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19pbl9zdHJ9KSAnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdXBkYXRlX3JzX2RvY3NfdGFibGVfc2VudF9zdGF0dXModGFibGVfc3RyaW5nX2lkOiBzdHIpOgogICAgICAgIHF0ZXh0ID0gZidVUERBVEUgUlNfZG9jc190YWJsZSBTRVQgc2VudCA9IDAgIFdIRVJFIGlkIGluICh7dGFibGVfc3RyaW5nX2lkfSkgJwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgZGVmIHNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLCBkb2NfaWQpOgogICAgICAgIHF0ZXh0ID0gZiJVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfSBTRVQgc2VudCA9IDAsIHZlcmlmaWVkID0gMCAgV0hFUkUgaWRfZG9jID0gJ3tkb2NfaWR9JyIKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgIGRlZiB1cGRhdGVfZG9jX3RhYmxlX3JvdyhzZWxmLCByb3dfaWQsIGRhdGEpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHNlbGYuZGV0YWlsc190YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci51cGRhdGUoZGF0YT1kYXRhLCBfZmlsdGVyPXsnaWQnOiByb3dfaWR9KQoKICAgIGRlZiBfc3FsX2V4ZWMoc2VsZiwgcSwgcGFyYW1zLCB0YWJsZV9uYW1lPScnKToKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgaWYgaXNpbnN0YW5jZShwYXJhbXMsIHN0cik6CiAgICAgICAgICAgIHNlbGYucHJvdmlkZXIuc3FsX2V4ZWMocSwgcGFyYW1zKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYucHJvdmlkZXIuc3FsX2V4ZWNfbWFueShxLCBwYXJhbXMpCgogICAgZGVmIF9zcWxfcXVlcnkoc2VsZiwgcSwgcGFyYW1zLCB0YWJsZV9uYW1lPScnKToKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKICAgIAogICAgZGVmIGdldF9kb2Nfcm93c19jb3VudChzZWxmLCBpZF9kb2MpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0ge30gIAogICAgICAgIAogICAgICAgIGlmIGlkX2RvYzogIAogICAgICAgICAgICBxID0gJ1NFTEVDVCBjb3VudChpZF9kb2MpIGFzIGRvY19yb3dzIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZF9kb2M9PycKICAgICAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgc3RyKGlkX2RvYykpICAKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlcyBhbmQgJ2RvY19yb3dzJyBpbiByZXNbMF06IAogICAgICAgICAgICAgICAgcmVzdWx0ID0geydkb2Nfcm93cyc6IHJlc1swXVsnZG9jX3Jvd3MnXX0KICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQgIAoKICAgIGRlZiBnZXRfYmFyY29kZShzZWxmLCBiYXJjb2RlKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9ICAKCiAgICAgICAgaWYgYmFyY29kZTogIAogICAgICAgICAgICBxID0gJ1NFTEVDVCAqIEZST00gUlNfYmFyY29kZXMgV0hFUkUgYmFyY29kZT0/JwogICAgICAgICAgICByZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBzdHIoYmFyY29kZSkpIAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzOiAgCiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNbMF0gaWYgcmVzIGVsc2Uge30KCiAgICAgICAgcmV0dXJuIHJlc3VsdCAgICAKCiAgICBkZWYgbWFya192ZXJpZmllZChzZWxmLCB2YWx1ZT0xKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSBzZWxmLmRvY3NfdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIudXBkYXRlKHsndmVyaWZpZWQnOiB2YWx1ZX0sIHsnaWRfZG9jJzogc2VsZi5kb2NfaWR9KQoKICAgIGRlZiByZXNldF9kb2NfdGFibGVzX3F0dHkoc2VsZik6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZSh7J3F0dHknOiAwfSwgeydpZF9kb2MnOiBzZWxmLmRvY19pZH0pCgoKY2xhc3MgU2VyaWVzU2VydmljZShEYlNlcnZpY2UpOgogICAgZG9jX2Jhc2ljX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgIGRvY19iYXNpY19oYW5kbGVyX25hbWUgPSAnUlNfZG9jcycKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAjaWYgcGFyYW1zIGFuZCBpc2luc3RhbmNlKHBhcmFtcywgZGljdCk6CiAgICAgICAgIyAgICBzZWxmLnBhcmFtcyA9IHBhcmFtcwogICAgICAgICNlbHNlOgogICAgICAgIHNlbGYucGFyYW1zID0ge30KCiAgICBkZWYgZ2V0X3Nlcmllc19ieV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUsIHBhcmFtczogZGljdCk6CgogICAgICAgIHBhcmFtcyA9IFsKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksCiAgICAgICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfcHJvcGVydGllcycpLAogICAgICAgICAgICBiYXJjb2RlLAogICAgICAgICAgICBiYXJjb2RlCiAgICAgICAgXSAgIyBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpLAogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgaWRfcHJvcGVydGllcywKICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgIHF0dHksCiAgICAgICAgICAgbmFtZSwKICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgIGNlbGwKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcyA9ID8gCiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9hZHJfc2VyaWVzX2J5X2JhcmNvZGUoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgcGFyYW1zID0gW3NlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2NlbGwnKSwKICAgICAgICAgICAgICAgICAgYmFyY29kZSwgIGJhcmNvZGVdICAjIHNlbGYucGFyYW1zLmdldCgnaWRfd2FyZWhvdXNlJyksCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCBpZCwKICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICBpZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICBpZF93YXJlaG91c2UsCiAgICAgICAgICAgcXR0eSwKICAgICAgICAgICBuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciwKICAgICAgICAgICBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgY2VsbAogICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIFJTX2RvY3Nfc2VyaWVzLmNlbGwgPSA/CiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9zZXJpZXNfYnlfZG9jX2FuZF9nb29kcyhzZWxmKToKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJykpICAjICwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKQoKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkIGFzIGtleSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyBhcyBpZF9kb2MsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLnF0dHksCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsICcnKSBBUyBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX24sICcnKSBBUyBkb2NfbiwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3dhcmVob3VzZXMubmFtZSAsICcnKSBBUyB3YXJlaG91c2VfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZG9jcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9IFJTX2RvY3MuaWRfZG9jCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIAogICAgICAgICAgICAgICAgT04gUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gUlNfd2FyZWhvdXNlcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gPyAKICAgICAgICAgICAgCiAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBnZXRfc2VyaWVzX2J5X2Fkcl9kb2NfYW5kX2dvb2RzKHNlbGYpOgogICAgICAgIGN1cnJfY2VsbCA9IHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGlmIHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGVsc2Ugc2VsZi5wYXJhbXMuZ2V0KCdpZF9jZWxsJykKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksIGN1cnJfY2VsbCkgICMgLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWQgYXMga2V5LAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MgYXMgaWRfZG9jLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9zZXJpZXMsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMubmFtZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsLAogICAgICAgICAgICBSU19kb2NzLmRvY190eXBlLAogICAgICAgICAgICBSU19kb2NzLmRvY19uLCAKICAgICAgICAgICAgUlNfZG9jcy5kb2NfZGF0ZSwKICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcy5uYW1lIGFzIHdhcmVob3VzZV9uYW1lLAogICAgICAgICAgICBSU19jZWxscy5uYW1lIGFzIGNlbGxfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gCiAgICAgICAgICAgIFJTX2RvY3MgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9ICBSU19kb2NzLmlkX2RvYwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19nb29kcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ICBSU19nb29kcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19wcm9wZXJ0aWVzIE9OIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzID0gIFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gIFJTX3dhcmVob3VzZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jZWxscyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsID0gPwogICAgICAgICAgICAnJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGFkZF9xdHR5X3RvX3RhYmxlX3N0cihzZWxmLCBpdGVtX2lkKToKICAgICAgICBwYXJhbXMgPSAoaXRlbV9pZCwpCiAgICAgICAgcSA9ICcnJ1VQREFURSBSU19kb2NzX3NlcmllcwogICAgICAgICAgICBTRVQgcXR0eSA9IHF0dHkgKyAxCiAgICAgICAgICAgIFdIRVJFIGlkID0gPycnJwoKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCgoKICAgIGRlZiBhZGRfbmV3X3Nlcmllc19pbl9kb2Nfc2VyaWVzX3RhYmxlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHFfcGFyYW1zID0gKAogICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3Byb3BlcnRpZXMnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKSwgMSwKICAgICAgICAgICAgICAgIGJhcmNvZGUsIGJhcmNvZGUsIHNlbGYucGFyYW1zLmdldCgnaWRfY2VsbCcpKQogICAgICAgIHEgPSAnSU5TRVJUIElOVE8gUlNfZG9jc19zZXJpZXMgKGlkX2RvYywgaWRfZ29vZCwgaWRfcHJvcGVydGllcywgaWRfd2FyZWhvdXNlLCBxdHR5LCBuYW1lLCBudW1iZXIsIGNlbGwpIFZBTFVFUyg/LD8sPyw/LD8sPyw/LD8pJwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIHFfcGFyYW1zKQoKICAgIGRlZiBnZXRfaXRlbV9ieV9uYW1lKHNlbGYsIGl0ZW1fbmFtZSwgdGFibGVfbmFtZSk6CiAgICAgICAgcSA9IGYnU0VMRUNUIGlkIEZST00ge3RhYmxlX25hbWV9IFdIRVJFIHt0YWJsZV9uYW1lfS5uYW1lID0gPycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIChpdGVtX25hbWUsKSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1bMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBkZWxldGVfY3VycmVudF9zdChzZWxmLCBpZCk6CiAgICAgICAgcSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3NlcmllcyAgV0hFUkUgaWQgPSA/JwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIChpZCwpKQoKCiAgICBkZWYgZ2V0X3Nlcmllc19wcm9wX2J5X2lkKHNlbGYsIGlkKToKICAgICAgICB0YWJsZV9uYW1lID0gc2VsZi5kb2NfYmFzaWNfdGFibGVfbmFtZQogICAgICAgIGlzX2FkciA9IEZhbHNlIGlmIHRhYmxlX25hbWUgPT0gJ1JTX2RvY3NfdGFibGUnIGVsc2UgVHJ1ZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZCwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfZG9jLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9nb29kLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9zZXJpZXMsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX3VuaXQsCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHksCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHlfcGxhbiwKICAgICAgICAgICAgICAgICAgICAgJycnCiAgICAgICAgcSA9IHEgKyBmJycnIHt0YWJsZV9uYW1lfS5pZF9jZWxsLCAKICAgICAgICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfY2VsbCBhcyBjZWxsLCAKICAgICAgICAgICAgICAgIFJTX2NlbGxzLm5hbWUgYXMgY2VsbF9uYW1lLCAKICAgICAgICAgICAgICAgIDAgYXMgcHJpY2UsCiAgICAgICAgICAgICAgICBOdWxsIGFzIGlkX3ByaWNlLCcnJyBpZiBpc19hZHIgZWxzZSBxICsgIGYnJycKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5wcmljZSwKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcmljZSwnJycKCiAgICAgICAgcSA9IHEgKyBmJycnCiAgICAgICAgICAge3RhYmxlX25hbWV9LnVzZV9zZXJpZXMsCiAgICAgICAgICAgUlNfZ29vZHMuYXJ0IGFzIGNvZGVfYXJ0LCAKICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZQogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0gCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX2dvb2RzCiAgICAgICAgICAgIE9OIHt0YWJsZV9uYW1lfS5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04ge3RhYmxlX25hbWV9LmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gICBSU191bml0cwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfdW5pdCA9IFJTX3VuaXRzLmlkCiAgICAgICAgICAgICcnJwogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gICBSU19jZWxscwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgICcnJyBpZiBpc19hZHIgZWxzZSBxCgogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWQgPSA/CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKGlkLCksIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHt9CgoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2VyaWVzX3RhYmxlX3N0cihpZCk6CiAgICAgICAgcSA9ICcnJwogICAgICAgU0VMRUNUIAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF93YXJlaG91c2UsCiAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLmJlc3RfYmVmb3JlLCAnJykgQVMgYmVzdF9iZWZvcmUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMubnVtYmVyLAogICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCwKICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwgCiAgICAgICAgUlNfY2VsbHMubmFtZSBhcyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgT04gUlNfZ29vZHMuaWQgPSBSU19kb2NzX3Nlcmllcy5pZF9nb29kCiAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgT04gUlNfY2VsbHMuaWQgPSBSU19kb2NzX3Nlcmllcy5jZWxsCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWQgPSA/CiAgICAgICAgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCAoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKCiAgICBkZWYgZ2V0X2RvY19wcm9wX2J5X2lkKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgdGFibGVfbmFtZSA9IHNlbGYuZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZF9kb2MsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmRvY19uLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5kb2NfZGF0ZSwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlIGFzIGlkX3dhcmVob3VzZSwKICAgICAgICAgICBSU193YXJlaG91c2VzLm5hbWUgYXMgd2FyZWhvdXNlCiAgICAgICAgICAgCiAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0KICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBPTgogICAgICAgIHt0YWJsZV9uYW1lfS5pZF93YXJlaG91c2UgPSBSU193YXJlaG91c2VzLmlkCiAgICAgICAgICAKICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWRfZG9jID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWRfZG9jLCksVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCiAgICBkZWYgZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKHNlbGYsIGlkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5wcmljZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfbiwgJycpIEFTIGRvY19uLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfZGF0ZSwgJycpIEFTIGRvY19kYXRlLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMubmFtZSwgJycpIEFTIGdvb2RfbmFtZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmFydCwgJycpIEFTIGdvb2RfYXJ0LAogICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCAnJykgQVMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwgJycpIEFTIGdvb2RfdW5pdCAKICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgQVMgUlNfZG9jc190YWJsZQogICAgICAgIAogICAgICAgIExFRlQgSk9JTiBSU19kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBzYXZlX3RhYmxlX3N0cihzZWxmLCBwYXJhbXMpOgogICAgICAgIHEgPSAnJycKICAgICAgICBVUERBVEUgUlNfZG9jc19zZXJpZXMKICAgICAgICBTRVQgCiAgICAgICAgICAgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcyA9IDppZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlID0gOmlkX3dhcmVob3VzZSwKICAgICAgICAgICBxdHR5ID0gOnF0dHksCiAgICAgICAgICAgbmFtZSA9IDpuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlID0gOmJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciA9IDpudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlID0gOnByb2R1Y3Rpb25fZGF0ZSwKICAgICAgICAgICBjZWxsICA9IDpjZWxsCiAgICAgICAgV0hFUkUgaWQgPSA6aWQgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0X3RvdGFsX3F0dHkoc2VsZik6CgogICAgICAgIHBhcmFtcyA9IChzZWxmLnBhcmFtcy5nZXQoJ2lkX2RvYycpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2dvb2QnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9wcm9wZXJ0aWVzJykpCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCAKICAgICAgICBzdW0ocXR0eSkgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBpZF9nb29kID0gPyBBTkQgaWRfcHJvcGVydGllcyA9ID8nJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIHBhcmFtcykKICAgICAgICBpZiByZXMgYW5kIHJlc1swXVswXSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHJlc1swXVswXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAwCgogICAgZGVmIHVwZGF0ZV90b3RhbF9xdHkoc2VsZiwgcXR5LCByb3dfaWQpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFVQREFURSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgIFNFVCBkX3F0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgQWRyU2VyaWVzU2VydmljZShTZXJpZXNTZXJ2aWNlKToKICAgIGRlZiBnZXRfdmFsdWVzX2Zvcl9zY3JlZW5fYnlfaWQoc2VsZiwgX2lkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2NlbGwsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY190eXBlLCAnJykgQVMgZG9jX3R5cGUsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19uLCAnJykgQVMgZG9jX24sCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5uYW1lLCAnJykgQVMgZ29vZF9uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgZ29vZF9hcnQsCiAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsICcnKSBBUyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCAnJykgQVMgZ29vZF91bml0LCAKICAgICAgICAgICAgSUZOVUxMKFJTX2NlbGxzLm5hbWUsICcnKSBBUyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIEFTIFJTX2RvY3NfdGFibGUKCiAgICAgICAgTEVGVCBKT0lOIFJTX2Fkcl9kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9jZWxsID0gUlNfY2VsbHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKF9pZCwpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiB1cGRhdGVfdG90YWxfcXR5KHNlbGYsIHF0eSwgcm93X2lkKToKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUKICAgICAgICAgICAgU0VUIHF0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgU2VsZWN0SXRlbVNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCgogICAgZGVmIGdldF9zZWxlY3RfZGF0YShzZWxmLCAqKmNvbmQpIC0+IGxpc3Q6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi50YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc2VsZWN0KGNvbmQpCgoKY2xhc3MgQWRyRG9jU2VydmljZShEb2NTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2M9JycsIGN1cl9jZWxsPScnLCB0YWJsZV90eXBlPSdpbicpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX25hbWUgPSAnUlNfQWRyX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfYWRyX2RvY3NfdGFibGUnCiAgICAgICAgc2VsZi5pc0FkciA9IFRydWUKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IEZhbHNlCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSBjdXJfY2VsbAogICAgICAgIHNlbGYudGFibGVfdHlwZSA9IHRhYmxlX3R5cGUKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzZWxmLmRvY3NfdGFibGVfbmFtZSwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gRmFsc2UKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IEZhbHNlCgogICAgZGVmIGdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBmaXJzdF9lbGVtLAogICAgICAgICAgICBpdGVtc19vbl9wYWdlLAogICAgICAgICAgICByb3dfZmlsdGVycz1Ob25lLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPU5vbmUsCiAgICAgICAgICAgIGlkX2RvYz0nJywKICAgICAgICAgICAgY2VsbD0nJwogICAgKSAtPiBsaXN0OgoKICAgICAgICBzZWxlY3RfcXVlcnkgPSAnJydTRUxFQ1QKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLm5hbWUsIDpOdWxsVmFsdWUpIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLmNvZGUsIDpFbXB0eVN0cmluZykgYXMgY29kZSwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLmFydCwgOkVtcHR5U3RyaW5nKSBhcyBhcnQsCiAgICAgICAgICAgIGlmbnVsbChSU19hZHJfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLCA6RW1wdHlTdHJpbmcpIGFzIGlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIGlmbnVsbChSU19wcm9wZXJ0aWVzLm5hbWUsIDpFbXB0eVN0cmluZykgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfc2VyaWVzLCA6RW1wdHlTdHJpbmcpIGFzIGlkX3NlcmllcywKICAgICAgICAgICAgaWZudWxsKFJTX3Nlcmllcy5uYW1lLCA6RW1wdHlTdHJpbmcpIGFzIHNlcmllc19uYW1lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfdW5pdCwgOkVtcHR5U3RyaW5nKSBhcyBpZF91bml0LAogICAgICAgICAgICBpZm51bGwoUlNfdW5pdHMubmFtZSwgOkVtcHR5U3RyaW5nKSBhcyB1bml0c19uYW1lLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5IGFzIHF0dHksCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHlfcGxhbiBhcyBxdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHlfcGxhbiAtIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHkgYXMgSXNEb25lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfY2VsbCwgOkVtcHR5U3RyaW5nKSBhcyBpZF9jZWxsLAogICAgICAgICAgICBpZm51bGwoUlNfY2VsbHMubmFtZSwgOk51bGxWYWx1ZSkgYXMgY2VsbF9uYW1lLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS51c2Vfc2VyaWVzCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jc190YWJsZSAKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gUlNfYWRyX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiAgICAgICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9IFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3NlcmllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfdW5pdAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMKICAgICAgICAgICAgT04gUlNfY2VsbHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfY2VsbAogICAgICAgICAgICAnJycKCiAgICAgICAgYmFzaWNfd2hlcmUgPSBmIiIiV0hFUkUgaWRfZG9jID0gOmlkX2RvYyBhbmQgdGFibGVfdHlwZSA9IDp0YWJsZV90eXBlIiIiCgogICAgICAgIGN1cl9jZWxsX2NvbmRpdGlvbiA9ICcnJ2FuZCAoaWRfY2VsbD06Y3VycmVudF9jZWxsIE9SIGlkX2NlbGw9IiIgT1IgaWRfY2VsbCBpcyBOdWxsKScnJyBpZiBjZWxsIGVsc2UgJycKICAgICAgICByb3dfZmlsdGVyc19jb25kaXRpb24gPSAiIiJBTkQgcXR0eSAhPSBDT0FMRVNDRShxdHR5X3BsYW4sICcwJykgIiIiIGlmIHJvd19maWx0ZXJzIGVsc2UgJycKICAgICAgICBzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbiA9IGYiIiJBTkQgZ29vZF9uYW1lIExJS0UgJyV7c2VhcmNoX3N0cmluZ30lJyIiIiBpZiBzZWFyY2hfc3RyaW5nIGVsc2UgJycKCiAgICAgICAgd2hlcmVfZnVsbCA9IGYiIiIKICAgICAgICAgICAgICAgIHtiYXNpY193aGVyZX0KICAgICAgICAgICAgICAgIHtjdXJfY2VsbF9jb25kaXRpb259CiAgICAgICAgICAgICAgICB7cm93X2ZpbHRlcnNfY29uZGl0aW9ufQogICAgICAgICAgICAgICAge3NlYXJjaF9zdHJpbmdfY29uZGl0aW9ufQogICAgICAgICIiIgoKICAgICAgICBvcmRlcl9ieSA9IGYiIiJPUkRFUiBCWSBSU19jZWxscy5uYW1lLCBSU19hZHJfZG9jc190YWJsZS5sYXN0X3VwZGF0ZWQgREVTQyIiIgogICAgICAgIGxpbWl0ID0gZidMSU1JVCB7aXRlbXNfb25fcGFnZX0gT0ZGU0VUIHtmaXJzdF9lbGVtfScKICAgICAgICBxdWVyeV90ZXh0ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfZnVsbH0ge29yZGVyX2J5fSB7bGltaXR9IgoKICAgICAgICBwYXJhbXNfZGljdCA9IHsnaWRfZG9jJzogaWRfZG9jLCAnTnVsbFZhbHVlJzogTm9uZSwgJ0VtcHR5U3RyaW5nJzogJycsICd0YWJsZV90eXBlJzogc2VsZi50YWJsZV90eXBlfQogICAgICAgIGlmIGNlbGw6CiAgICAgICAgICAgIHBhcmFtc19kaWN0WydjdXJyZW50X2NlbGwnXSA9IGNlbGwKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIHBhcmFtc19kaWN0LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgX2ZpbHRlciA9IHsnaWRfZG9jJzogaWRfZG9jfQogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9ICdSU19kb2NzX3NlcmllcycKICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyPV9maWx0ZXIpCgogICAgICAgIHF1ZXJ5X3RleHQgPSAoCiAgICAgICAgICAgICdVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUgc2V0IHF0dHkgPSAwIFdIRVJFIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgJ1VQREFURSBSU19hZHJfZG9jcyBzZXQgdmVyaWZpZWQgPSAwLCBzZW50ID0gMCBXSEVSRSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICdERUxFVEUgRlJPTSBSU19hZHJfZG9jc190YWJsZSBXSEVSRSBpZF9kb2M9OmlkX2RvYyBBTkQgaXNfcGxhbiA9ICJGYWxzZSInCiAgICAgICAgKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvciBlbCBpbiBxdWVyeV90ZXh0OgogICAgICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChlbCwgKHsnaWRfZG9jJzogaWRfZG9jfSkpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLndyaXRlX2Vycm9yX29uX2xvZyhlLmFyZ3NbMF0pCiAgICAgICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IEZhbHNlLCAnZXJyb3InOiBlLmFyZ3NbMF19CgogICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IFRydWUsICdlcnJvcic6ICcnfQoKICAgIGRlZiBnZXRfZGF0YV90b19zZW5kKHNlbGYsIGlkX2RvYz0nJyk6CiAgICAgICAgZGF0YSA9IFtdCgogICAgICAgIGRvY19pZF9jb25kaXRpb24gPSBmJ2lkX2RvYz0ie2lkX2RvY30iJyBpZiBpZF9kb2MgZWxzZSAndmVyaWZpZWQgPSAxIEFORCBJRk5VTEwoc2VudCwgMCkgPSAwJwoKICAgICAgICBxID0gZicnJ1NFTEVDVCBpZF9kb2MKICAgICAgICAgICAgICAgIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSAKICAgICAgICAgICAgICAgIFdIRVJFIHtkb2NfaWRfY29uZGl0aW9ufQogICAgICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQoKICAgICAgICBmb3Igcm93IGluIHJlczoKICAgICAgICAgICAgaWRfZG9jID0gcm93WydpZF9kb2MnXQoKICAgICAgICAgICAgZG9jX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAnaWRfZG9jJzogaWRfZG9jLAogICAgICAgICAgICB9CgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3Byb3BlcnRpZXMnLCAnaWRfc2VyaWVzJywgJ2lkX3VuaXQnLCAncXR0eScsICdxdHR5X3BsYW4nLCAndGFibGVfdHlwZScsCiAgICAgICAgICAgICAgICAgICAgICAnaWRfY2VsbCddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jc190YWJsZSAKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gQU5EIChzZW50ID0gMCBPUiBzZW50IElTIE5VTEwpCiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKICAgICAgICAgICAgZ29vZHMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2MpCiAgICAgICAgICAgIGRvY19kYXRhWydSU19hZHJfZG9jc190YWJsZSddID0gZ29vZHMKCgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3NlcmllcycsICdpZF93YXJlaG91c2UnLCAnY2VsbCcsICdxdHR5JywgJ25hbWUnLCAnYmVzdF9iZWZvcmUnLCAnbnVtYmVyJywKICAgICAgICAgICAgICAgICAgICAgICdwcm9kdWN0aW9uX2RhdGUnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8KICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQoKICAgICAgICAgICAgc2VyaWVzX3RhYmxlID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfZG9jc19zZXJpZXMnXSA9IHNlcmllc190YWJsZQoKICAgICAgICAgICAgZGF0YS5hcHBlbmQoZG9jX2RhdGEpCgoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBmaW5kX2NlbGwoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgIyBUT0RPINC90LUg0YPRh9C40YLRi9Cy0LDQtdGC0YHRjyDQstCw0YDQuNCw0L3RgiDRgSDQvtC00LjQvdCw0LrQvtCy0YvQvNC4INCo0Jog0YHQtdGA0LjQuQogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9ICdSU19jZWxscycKICAgICAgICByZXMgPSBzZWxmLnByb3ZpZGVyLnNlbGVjdCh7J2JhcmNvZGUnOiBiYXJjb2RlfSkKCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdCgogICAgZGVmIGdldF9kb2NfZGF0YV9ieV9pZChzZWxmKToKICAgICAgICBpZiBzZWxmLmRvY19pZDoKICAgICAgICAgICAgcSA9IGYnJycKICAgICAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgICAgICBkLiosIAogICAgICAgICAgICAgICAgICAgIHcubmFtZSBBUyB3YXJlaG91c2UgCiAgICAgICAgICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzIGFzIGQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgdyAKICAgICAgICAgICAgICAgICAgICBPTiBkLmlkX3dhcmVob3VzZSA9IHcuaWQKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdIRVJFIGQuaWRfZG9jID0gIntzZWxmLmRvY19pZH0iCiAgICAgICAgICAgICcnJwogICAgICAgICAgICBkb2NfZGF0YSA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICAgICAgcmV0dXJuIGRvY19kYXRhWzBdIGlmIGRvY19kYXRhIGVsc2UgTm9uZQoKICAgIGRlZiBnZXRfZG9jX3ZpZXdfZGF0YSgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgZG9jX3R5cGU9JycsCiAgICAgICAgICAgIGRvY19zdGF0dXM6IExpdGVyYWxbJ9CS0YvQs9GA0YPQttC10L0nLCAn0Jog0LLRi9Cz0YDRg9C30LrQtScsICfQmiDQstGL0L/QvtC70L3QtdC90LjRjiddID0gJycKICAgICkgLT4gbGlzdDoKICAgICAgICBmaWVsZHMgPSBbCiAgICAgICAgICAgICdkb2MuaWRfZG9jJywKICAgICAgICAgICAgJ2RvYy5kb2NfdHlwZScsCiAgICAgICAgICAgICdkb2MuZG9jX24nLAogICAgICAgICAgICAnZG9jLmRvY19kYXRlJywKICAgICAgICAgICAgJ2RvYy5pZF93YXJlaG91c2UnLAogICAgICAgICAgICAnZG9jLmFkZF9tYXJrX3NlbGVjdGlvbicsCiAgICAgICAgICAgICdJRk5VTEwoZG9jLnZlcmlmaWVkLCAwKSBBUyB2ZXJpZmllZCcsCiAgICAgICAgICAgICdJRk5VTEwoZG9jLnNlbnQsIDApIEFTIHNlbnQnLAogICAgICAgICAgICAnSUZOVUxMKFJTX3dhcmVob3VzZXMubmFtZSwgIicnIikgQVMgd2FyZWhvdXNlJywKICAgICAgICBdCgogICAgICAgIHF1ZXJ5X3RleHQgPSAnU0VMRUNUICcgKyAnLFxuJy5qb2luKGZpZWxkcykKCiAgICAgICAgam9pbnMgPSBmJycnRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IEFTIGRvYwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgICAgICAgICAgICBPTiBSU193YXJlaG91c2VzLmlkID0gZG9jLmlkX3dhcmVob3VzZQogICAgICAgICcnJwoKICAgICAgICB3aGVyZSA9ICcnCiAgICAgICAgY29uZGl0aW9uID0gW10KCiAgICAgICAgaWYgZG9jX3N0YXR1cyA9PSAi0JLRi9Cz0YDRg9C20LXQvSI6CiAgICAgICAgICAgIGNvbmRpdGlvbi5hcHBlbmQoInNlbnQgPSAxIEFORCB2ZXJpZmllZCA9IDEiKQogICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9Cz0YDRg9C30LrQtSI6CiAgICAgICAgICAgIGNvbmRpdGlvbi5hcHBlbmQoIklGTlVMTCh2ZXJpZmllZCwgMCkgPSAxIEFORCBJRk5VTEwoc2VudCwgMCkgPSAwIikKICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQv9C+0LvQvdC10L3QuNGOIjoKICAgICAgICAgICAgY29uZGl0aW9uLmFwcGVuZCgiSUZOVUxMKHZlcmlmaWVkLCAwKSA9IDAgQU5EIElGTlVMTChzZW50LCAwKSA9IDAiKQoKICAgICAgICBpZiBkb2NfdHlwZToKICAgICAgICAgICAgY29uZGl0aW9uLmFwcGVuZChmJ2RvY190eXBlPSJ7ZG9jX3R5cGV9IicpCgogICAgICAgIGlmIGNvbmRpdGlvbjoKICAgICAgICAgICAgd2hlcmUgPSAnV0hFUkUgJyArICcgQU5EXG4nLiBqb2luKGNvbmRpdGlvbikKCiAgICAgICAgcXVlcnlfdGV4dCA9IGYnJycKICAgICAgICAgICAge3F1ZXJ5X3RleHR9CiAgICAgICAgICAgIHtqb2luc30KICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICBPUkRFUiBCWSBkb2MuZG9jX2RhdGUKICAgICAgICAnJycKICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBnZXRfZG9jX3Jvd19kYXRhKHNlbGYsIHJvd19pZCk6CiAgICAgICAgcSA9IGYnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgdC5pZF9kb2MgQVMgaWRfZG9jLAogICAgICAgICAgICAgICAgdC5pZF9nb29kIEFTIGl0ZW1faWQsCiAgICAgICAgICAgICAgICB0LmlkX3Byb3BlcnRpZXMgYXMgcHJvcGVydHlfaWQsCiAgICAgICAgICAgICAgICB0LmlkX3VuaXQgYXMgdW5pdF9pZCwKICAgICAgICAgICAgICAgIHQucXR0eV9wbGFuLAogICAgICAgICAgICAgICAgdC5xdHR5LAogICAgICAgICAgICAgICAgdC51c2Vfc2VyaWVzLAogICAgICAgICAgICAgICAgSUZOVUxMKGcubmFtZSwgJycpIEFTIGl0ZW1fbmFtZSwKICAgICAgICAgICAgICAgIElGTlVMTChnLmFydCwgJycpIEFTIGFydGljbGUsCiAgICAgICAgICAgICAgICBJRk5VTEwocC5uYW1lLCAnJykgQVMgcHJvcGVydHksCiAgICAgICAgICAgICAgICBJRk5VTEwodS5uYW1lLCAnJykgQVMgdW5pdAogICAgICAgICAgICAKICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jc190YWJsZSBBUyB0CiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgIEFTIGcKICAgICAgICAgICAgT04gdC5pZF9nb29kPSBnLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyAgQVMgcAogICAgICAgICAgICBPTiB0LmlkX3Byb3BlcnRpZXMgPSBwLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgIEFTIHUKICAgICAgICAgICAgT04gdC5pZF91bml0ID0gdS5pZAogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgdC5pZCA9ICJ7cm93X2lkfSIKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHEsIHJldHVybl9kaWN0PVRydWUpCgogICAgICAgIHJldHVybiByZXNbMF0gaWYgcmVzIGVsc2Uge30KCgpjbGFzcyBGbG93RG9jU2VydmljZShEb2NTZXJ2aWNlKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZG9jX2lkPScnKToKICAgICAgICBzZWxmLmRvY19pZCA9IGRvY19pZAogICAgICAgIHNlbGYuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgICAgICBzZWxmLmlzQWRyID0gRmFsc2UKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc2VsZi5kb2NzX3RhYmxlX25hbWUsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQogICAgICAgIHNlbGYuaXNfZ3JvdXBfc2NhbiA9IEZhbHNlCiAgICAgICAgc2VsZi5pc19iYXJjX2Zsb3cgPSBUcnVlCgogICAgZGVmIGdldF9kb2Nfdmlld19kYXRhKHNlbGYsIGRvY190eXBlPScnLCBkb2Nfc3RhdHVzPScnKSAtPiBsaXN0OgogICAgICAgIGZpZWxkcyA9IFsKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2RvYycsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfdHlwZScsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfbicsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfZGF0ZScsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF93YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbChSU193YXJlaG91c2VzLm5hbWUsIiIpIGFzIFJTX3dhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0udmVyaWZpZWQsIDApIGFzIHZlcmlmaWVkJywKICAgICAgICAgICAgZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5zZW50LCAwKSBhcyBzZW50JywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmFkZF9tYXJrX3NlbGVjdGlvbicsCiAgICAgICAgXQoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2NvdW50cmFnZW50cycpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19ncm91cF9zY2FuLCAwKSBhcyBpc19ncm91cF9zY2FuJykKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlzX2JhcmNfZmxvdywgMCkgYXMgaXNfYmFyY19mbG93JykKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ2lmbnVsbChSU19jb3VudHJhZ2VudHMuZnVsbF9uYW1lLCAiIikgYXMgUlNfY291bnRyYWdlbnQnKQoKICAgICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCAnICsgJyxcbicuam9pbihmaWVsZHMpCgogICAgICAgIGpvaW5zID0gZicnJ0ZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgICAgICAgICAgICBPTiBSU193YXJlaG91c2VzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF93YXJlaG91c2UKICAgICAgICAnJycKCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBqb2lucyArPSBmJycnCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jb3VudHJhZ2VudHMgYXMgUlNfY291bnRyYWdlbnRzCiAgICAgICAgICAgICAgICBPTiBSU19jb3VudHJhZ2VudHMuaWQgPSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgJycnCgogICAgICAgIHdoZXJlX25vdF9ncm91cF9zY2FuID0gZidXSEVSRSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlzX2dyb3VwX3NjYW4gPSAwJwogICAgICAgIHdoZXJlX2JhcmNfZmxvdyA9IGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19iYXJjX2Zsb3cgPSAxJwogICAgICAgIHdoZXJlX2VtcHR5ID0gKCJSU19kb2NzLmlkX2RvYyBub3QgaW4gIgogICAgICAgICAgICAgICAgICAgICAgICIoU0VMRUNUIGRpc3RpbmN0IGlkX2RvYyBGcm9tIFJTX2RvY3NfdGFibGUpIikKICAgICAgICB3aGVyZSA9IGYie3doZXJlX25vdF9ncm91cF9zY2FufSBBTkQgKHt3aGVyZV9iYXJjX2Zsb3d9IE9SIHt3aGVyZV9lbXB0eX0pIgoKICAgICAgICBpZiBkb2Nfc3RhdHVzOgogICAgICAgICAgICBpZiBkb2Nfc3RhdHVzID09ICLQktGL0LPRgNGD0LbQtdC9IjoKICAgICAgICAgICAgICAgIHdoZXJlICs9ICJBTkQgc2VudD0xIEFORCB2ZXJpZmllZD0xIgogICAgICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQs9GA0YPQt9C60LUiOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gIkFORCBpZm51bGwodmVyaWZpZWQsMCk9MSBBTkQgaWZudWxsKHNlbnQsMCk9MCIKICAgICAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0L/QvtC70L3QtdC90LjRjiI6CiAgICAgICAgICAgICAgICB3aGVyZSArPSAiQU5EIGlmbnVsbCh2ZXJpZmllZCwwKT0wIEFORCBpZm51bGwoc2VudCwwKT0wIgoKICAgICAgICBpZiBub3QgZG9jX3R5cGUgb3IgZG9jX3R5cGUgPT0gItCS0YHQtSI6CiAgICAgICAgICAgIGFyZ3NfdHVwbGUgPSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXJnc190dXBsZSA9IChkb2NfdHlwZSwpCiAgICAgICAgICAgIHdoZXJlICs9ICcgQU5EIGRvY190eXBlPT8nCiAgICAgICAgcXVlcnlfdGV4dCA9IGYnJycKICAgICAgICAgICAge3F1ZXJ5X3RleHR9CiAgICAgICAgICAgIHtqb2luc30KICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICBPUkRFUiBCWSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19kYXRlCiAgICAgICAgJycnCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzX3R1cGxlLCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2Zsb3dfdGFibGVfZGF0YShzZWxmKToKICAgICAgICBxdWVyeV90ZXh0ID0gJycnV0lUSCB0ZW1wX3EgYXMgKFNFTEVDVAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjX2Zsb3cuYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCBhcyBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBhcyBpZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICAgICAgMSBhcyBxdHR5CgogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNfZmxvdwogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY29kZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX2JhcmNvZGVzLmJhcmNvZGUgPSBSU19iYXJjX2Zsb3cuYmFyY29kZQogICAgICAgICAgICAgICAgICAgICAgICBXSEVSRSBSU19iYXJjX2Zsb3cuaWRfZG9jID0gPykKCiAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCB0ZW1wX3EuYmFyY29kZSwgdGVtcF9xLmlkX2dvb2QsIHRlbXBfcS5pZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgc3VtKHF0dHkpIGFzIHF0dHkKICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSB0ZW1wX3EKICAgICAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQgPSB0ZW1wX3EuaWRfZ29vZAogICAgICAgICAgICAgICAgICAgICAgICBHUk9VUCBCWSB0ZW1wX3EuYmFyY29kZScnJwoKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoc2VsZi5kb2NfaWQsKSwgVHJ1ZSkKCiAgICBkZWYgZ2V0X2RhdGFfZm9yX3RpY2tldF9wcmludGluZyhzZWxmLCBiYXJjb2RlKToKICAgICAgICBxdWVyeV90ZXh0ID0gJycnV0lUSCB0ZW1wX3EgYXMgKFNFTEVDVAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjX2Zsb3cuYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCBhcyBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBhcyBpZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICAgICAgMSBhcyBxdHR5CgogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNfZmxvdwogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY29kZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX2JhcmNvZGVzLmJhcmNvZGUgPSBSU19iYXJjX2Zsb3cuYmFyY29kZQogICAgICAgICAgICAgICAgICAgICAgICBXSEVSRSBSU19iYXJjX2Zsb3cuaWRfZG9jPT8gQU5EIFJTX2JhcmNfZmxvdy5iYXJjb2RlID0gPykKCiAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCB0ZW1wX3EuYmFyY29kZSwgdGVtcF9xLmlkX2dvb2QsIHRlbXBfcS5pZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBuYW1lLCAKICAgICAgICAgICAgICAgICAgICAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIFByb3BfbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgc3VtKHF0dHkpIGFzIHF0dHkKICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSB0ZW1wX3EKICAgICAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQgPSB0ZW1wX3EuaWRfZ29vZAogICAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPSB0ZW1wX3EuaWRfcHJvcGVydHkgICAgCiAgICAgICAgICAgICAgICAgICAgICBHUk9VUCBCWSB0ZW1wX3EuYmFyY29kZQogICAgICAgICAgICAgICAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKHNlbGYuZG9jX2lkLCBiYXJjb2RlKSwgVHJ1ZSkKCiAgICBkZWYgYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2Uoc2VsZiwgYmFyY29kZTogc3RyKToKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcXRleHQgPSAnJydJTlNFUlQgSU5UTyBSU19iYXJjX2Zsb3cgKGlkX2RvYywgYmFyY29kZSkgVkFMVUVTICg/LD8pJycnCiAgICAgICAgc2VsZi5wcm92aWRlci5zcWxfZXhlYyhxdGV4dCwgJywnLmpvaW4oW3NlbGYuZG9jX2lkLCBiYXJjb2RlXSkpCiAgICAgICAgc2VsZi5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5kb2NfaWQpCgogICAgZGVmIHNldF9iYXJjX2Zsb3dfc3RhdHVzKHNlbGYpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHNlbGYuZG9jc190YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci51cGRhdGUoeydpc19iYXJjX2Zsb3cnOiAnMSd9LCB7J2lkX2RvYyc6IHNlbGYuZG9jX2lkfSkKCgpjbGFzcyBHb29kc1NlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpdGVtX2lkPScnKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLml0ZW1faWQgPSBpdGVtX2lkCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0iUlNfZ29vZHMiLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKCiAgICBkZWYgZ2V0X3R5cGVfbmFtZV9ieV9pZChzZWxmLCBpZCk6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiU0VMRUNUIG5hbWUgRlJPTSBSU190eXBlc19nb29kcyBXSEVSRSBpZCA9J3tpZH0nIgogICAgICAgIHJldHVybiBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIHJldHVybl9kaWN0PVRydWUpCgogICAgZGVmIGdldF9nb29kc19saXN0X2RhdGEoc2VsZiwgZ29vZHNfdHlwZT0nJywgaXRlbV9pZD0nJykgLT4gbGlzdDoKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmlkLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmNvZGUsICfigJQnKSBBUyBjb2RlLAogICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCfigJQnKSBBUyB1bml0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3R5cGVzX2dvb2RzLm5hbWUsICfigJQnKSBBUyB0eXBlX2dvb2QsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuZGVzY3JpcHRpb24sJ+KAlCcpIEFTIGRlc2NyaXB0aW9uCiAgICAgICAgICAgIEZST00gUlNfZ29vZHMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3R5cGVzX2dvb2RzCiAgICAgICAgICAgICAgICBPTiBSU190eXBlc19nb29kcy5pZCA9IFJTX2dvb2RzLnR5cGVfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfZ29vZHMudW5pdAogICAgICAgICAgICAiIiIKICAgICAgICB3aGVyZSA9ICcnIGlmIG5vdCBnb29kc190eXBlIGVsc2UgJ1dIRVJFIFJTX2dvb2RzLnR5cGVfZ29vZD0/JwogICAgICAgIGlmIHdoZXJlID09ICcnIGFuZCBpdGVtX2lkOgogICAgICAgICAgICB3aGVyZSArPSAnV0hFUkUgUlNfZ29vZHMuaWQ9PycKCiAgICAgICAgcXVlcnlfdGV4dCA9IGYnJycKICAgICAgICAgICAgICAgICAgICB7cXVlcnlfdGV4dH0KICAgICAgICAgICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgICAgICAgICAgT1JERVIgQlkgUlNfZ29vZHMuaWQKICAgICAgICAgICAgICAgICcnJwoKICAgICAgICBpZiBnb29kc190eXBlOgogICAgICAgICAgICBhcmdzID0gZ29vZHNfdHlwZQogICAgICAgIGVsaWYgaXRlbV9pZDoKICAgICAgICAgICAgYXJncyA9IGl0ZW1faWQKICAgICAgICBlbHNlOgogICAgICAgICAgICBhcmdzID0gTm9uZQoKICAgICAgICByZXN1bHQgPSBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgYXJncykKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGdldF9pdGVtX2RhdGFfYnlfaWQoc2VsZiwgaXRlbV9pZCk6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBSU19nb29kcy5pZCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5jb2RlLCAn4oCUJykgQVMgY29kZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwn4oCUJykgQVMgdW5pdCwKICAgICAgICAgICAgICAgIElGTlVMTChSU190eXBlc19nb29kcy5uYW1lLCAn4oCUJykgQVMgdHlwZV9nb29kLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmRlc2NyaXB0aW9uLCfigJQnKSBBUyBkZXNjcmlwdGlvbgogICAgICAgICAgICBGUk9NIFJTX2dvb2RzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU190eXBlc19nb29kcwogICAgICAgICAgICAgICAgT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBSU19nb29kcy50eXBlX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgICAgICBPTiBSU191bml0cy5pZCA9IFJTX2dvb2RzLnVuaXQKICAgICAgICAgICAgV0hFUkUgUlNfZ29vZHMuaWQgPSAie2l0ZW1faWR9IgogICAgICAgICAgICAKICAgICAgICAgICAgTElNSVQgMQogICAgICAgICAgICAiIiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCkKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIHt9CgogICAgZGVmIGdldF9pdGVtX2RhdGFfYnlfY29uZGl0aW9uKHNlbGYsIGl0ZW1faWQsIHByb3BlcnR5X2lkPScnLCB1bml0X2lkPScnKSAtPiBkaWN0OgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgUlNfZ29vZHMuaWQgQVMgaWQsCiAgICAgICAgICAgICAgICBSU19nb29kcy5jb2RlIEFTIGNvZGUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lIEFTIG5hbWUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5hcnQgYXMgYXJ0LAogICAgICAgICAgICAgICAgUlNfZ29vZHMuZGVzY3JpcHRpb24gQVMgZGVzY3JpcHRpb24sCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwn4oCUJykgQVMgdW5pdCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsJ+KAlCcpIEFTIHByb3BlcnR5CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgRlJPTSBSU19nb29kcwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgICAgICBPTiBSU191bml0cy5pZCA9ICJ7dW5pdF9pZH0iCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gIntwcm9wZXJ0eV9pZH0iCiAgICAgICAgICAgIFdIRVJFIFJTX2dvb2RzLmlkID0gIntpdGVtX2lkfSIKCiAgICAgICAgICAgIExJTUlUIDEKICAgICAgICAgICAgIiIiCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQpCiAgICAgICAgcmV0dXJuIHJlc3VsdFswXSBpZiByZXN1bHQgZWxzZSB7fQoKICAgIGRlZiBnZXRfYWxsX2dvb2RzX3R5cGVzX2RhdGEoc2VsZik6CiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgaWQsbmFtZSBGUk9NIFJTX3R5cGVzX2dvb2RzJwogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9ICdSU190eXBlc19nb29kcycKICAgICAgICByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsICcnKQoKICAgIGRlZiBnZXRfdmFsdWVzX2Zyb21fYmFyY29kZShzZWxmLCBpZGVudGlmeV9maWVsZDogc3RyLCBpZGVudGlmeV92YWx1ZTogc3RyKSAtPiBsaXN0OgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiCiAgICAgICAgICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kLAogICAgICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5uYW1lLCAnJykgQVMgbmFtZSwKICAgICAgICAgICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCAnJykgQVMgcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX3Nlcmllcy5uYW1lLCAnJykgQVMgc2VyaWVzLAogICAgICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCAnJykgQVMgdW5pdAoKICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzCiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkID0gUlNfYmFyY29kZXMuaWRfZ29vZAogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eQogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICAgICAgICAgICAgICBPTiBSU191bml0cy5pZCA9IFJTX2JhcmNvZGVzLmlkX3VuaXQKICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9IFJTX2JhcmNvZGVzLmlkX3NlcmllcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIFdIRVJFIHtpZGVudGlmeV9maWVsZH0gPSAne2lkZW50aWZ5X3ZhbHVlfScKICAgICAgICAgICAgICAgICAgICAiIiIKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCAnJykKCiAgICBkZWYgZ2V0X3ZhbHVlc19ieV9maWVsZChzZWxmLCB0YWJsZV9uYW1lLCBmaWVsZCwgZmllbGRfdmFsdWUpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5zZWxlY3Qoe2ZpZWxkOiBmaWVsZF92YWx1ZX0pCgogICAgZGVmIGdldF9xdWVyeV93aXRoX2FyZ19saXN0KHNlbGYsIHRhYmxlX25hbWUsIHZhbHVlLCBmaWVsZCwgdGFibGVfc3RyaW5nX2lkKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIlNFTEVDVCBpZm51bGwoe3ZhbHVlfSwgJy0nKSBhcyB7dmFsdWV9IEZST00ge3RhYmxlX25hbWV9IFdIRVJFIHtmaWVsZH0gaW4gKHt0YWJsZV9zdHJpbmdfaWR9KSIiIgogICAgICAgICMgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgICMgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCB0YWJsZV9uYW1lPXRhYmxlX25hbWUsIHBhcmFtcz0nJykKICAgICAgICByZXR1cm4gcXVlcnlfdGV4dAoKICAgIGRlZiBnZXRfc2VsZWN0X2RhdGEoc2VsZiwgdGFibGVfbmFtZSk6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYnU0VMRUNUICogRlJPTSB7dGFibGVfbmFtZX0nCiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgJycpCgoKY2xhc3MgRGJDcmVhdG9yKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCgogICAgZGVmIGNyZWF0ZV90YWJsZXMoc2VsZik6CiAgICAgICAgaW1wb3J0IGRhdGFiYXNlX2luaXRfcXVlcnllcwogICAgICAgICMg0KHQvtC30LTQsNC10Lwg0YLQsNCx0LvQuNGG0Ysg0LXRgdC70Lgg0LjRhSDQvdC10YIKICAgICAgICBzY2hlbWEgPSBkYXRhYmFzZV9pbml0X3F1ZXJ5ZXMuZGF0YWJhc2Vfc2hlbWEoKQogICAgICAgIGZvciBlbCBpbiBzY2hlbWE6CiAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQoZWwpCgogICAgZGVmIGRyb3BfYWxsX3RhYmxlcyhzZWxmKToKICAgICAgICB0YWJsZXMgPSBzZWxmLmdldF9hbGxfdGFibGVzKCkKCiAgICAgICAgZm9yIHRhYmxlIGluIHRhYmxlczoKICAgICAgICAgICAgc2VsZi5fc3FsX3F1ZXJ5KGYnRFJPUCBUQUJMRSB7dGFibGV9JykKCiAgICBkZWYgZ2V0X2FsbF90YWJsZXMoc2VsZik6CiAgICAgICAgcSA9ICcnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBuYW1lIAogICAgICAgICAgICBGUk9NIAogICAgICAgICAgICAgICAgc3FsaXRlX21hc3RlcgogICAgICAgICAgICBXSEVSRSAKICAgICAgICAgICAgICAgIHR5cGU9J3RhYmxlJyBBTkQgCiAgICAgICAgICAgICAgICBuYW1lIE5PVCBMSUtFICdzcWxpdGVfJScKICAgICAgICAnJycKICAgICAgICB0YWJsZXMgPSBzZWxmLl9zcWxfcXVlcnkocSkKCiAgICAgICAgcmV0dXJuIFt0YWJsZVsnbmFtZSddIGZvciB0YWJsZSBpbiB0YWJsZXNdCgoKY2xhc3MgRXJyb3JTZXJ2aWNlOgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF9hbGxfZXJyb3JzKGRhdGVfc29ydCk6CiAgICAgICAgc29ydCA9ICJERVNDIiBpZiBub3QgZGF0ZV9zb3J0IG9yIGRhdGVfc29ydCA9PSAi0J3QvtCy0YvQtSIgZWxzZSAiQVNDIgogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KGYiU0VMRUNUICogRlJPTSBFcnJvcl9sb2cgT1JERVIgQlkgdGltZXN0YW1wIHtzb3J0fSIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNsZWFyKCk6CiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQoIkRFTEVURSBGUk9NIEVycm9yX2xvZyIpCgpjbGFzcyBVbml2ZXJzYWxDYXJkc1NlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnRhYmxlX25hbWU6IHN0cgogICAgICAgIHNlbGYuZmlsdGVyX2ZpZWxkcyA9IFtdCiAgICAgICAgc2VsZi5maWx0ZXJfdmFsdWUgPSAnJwogICAgICAgIHNlbGYuZXhjbHVkZV9saXN0ID0gW10KICAgICAgICBzZWxmLm5vX2xhYmVsID0gRmFsc2UKICAgICAgICBzZWxmLnRhYmxlX25hbWVzID0gc2VsZi5fdGFibGVfbmFtZXNfZGljdCgpCgogICAgZGVmIGdldF92aWV3c19kYXRhKHNlbGYsIHRhYmxlX25hbWU6IHN0cik6CiAgICAgICAgZmllbGRzID0gc2VsZi5fZ2V0X2ZpZWxkcyh0YWJsZV9uYW1lKQogICAgICAgIGZpZWxkc19saW5rcyA9IHt9CiAgICAgICAgcV9maWVsZHMgPSBbXQogICAgICAgIHFfam9pbnMgPSBbXQogICAgICAgIHFfY29uZGl0aW9ucyA9IFsndHJ1ZSddCgogICAgICAgIGZvciBmaWVsZCBpbiBmaWVsZHM6CiAgICAgICAgICAgIGlmIGZpZWxkIGluIHNlbGYuZXhjbHVkZV9saXN0OgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHFfZmllbGRzLmFwcGVuZCgne30ue30gQVMge30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWUsIGZpZWxkLCAna2V5JyBpZiBmaWVsZCA9PSAnaWQnIGVsc2UgZmllbGQpKQoKICAgICAgICAgICAgbGlua190YWJsZV9uYW1lID0gc2VsZi50YWJsZV9uYW1lcy5nZXQoZmllbGQpCiAgICAgICAgICAgIGlmIGxpbmtfdGFibGVfbmFtZToKICAgICAgICAgICAgICAgIHFfZmllbGRzLmFwcGVuZChmJ3tsaW5rX3RhYmxlX25hbWV9Lm5hbWUgYXMge2xpbmtfdGFibGVfbmFtZX1fbmFtZScpCiAgICAgICAgICAgICAgICBxX2pvaW5zLmFwcGVuZCgnTEVGVCBKT0lOIHt9IE9OIHt9LmlkID0ge30ue30nLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBsaW5rX3RhYmxlX25hbWUsIGxpbmtfdGFibGVfbmFtZSwgdGFibGVfbmFtZSwgZmllbGQKICAgICAgICAgICAgICAgICkpCgogICAgICAgICAgICAgICAgZmllbGRzX2xpbmtzW2ZpZWxkXSA9IGYne2xpbmtfdGFibGVfbmFtZX1fbmFtZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZpZWxkc19saW5rc1tmaWVsZF0gPSAna2V5JyBpZiBmaWVsZCA9PSAnaWQnIGVsc2UgZmllbGQKCiAgICAgICAgaWYgc2VsZi5maWx0ZXJfdmFsdWU6CiAgICAgICAgICAgIHFfY29uZGl0aW9ucyA9IFtmInt0YWJsZV9uYW1lfS57ZmllbGR9IExJS0UgJyV7c2VsZi5maWx0ZXJfdmFsdWV9JSciIGZvciBmaWVsZCBpbiBzZWxmLmZpbHRlcl9maWVsZHNdCgogICAgICAgIHEgPSAnJydTRUxFQ1Qge30gCiAgICAgICAgICAgICAgICBGUk9NIHt9CiAgICAgICAgICAgICAgICB7fQogICAgICAgICAgICAgICAgV0hFUkUge30KICAgICAgICAnJycuIGZvcm1hdCgnLCcuam9pbihxX2ZpZWxkcyksIHRhYmxlX25hbWUsICcgJy5qb2luKHFfam9pbnMpLCAnIE9SICcuam9pbihxX2NvbmRpdGlvbnMpKQoKICAgICAgICByZXR1cm4gZmllbGRzX2xpbmtzLCBzZWxmLl9zcWxfcXVlcnkocSkKCiAgICBkZWYgX2dldF9maWVsZHMoc2VsZiwgdGFibGVfbmFtZSkgLT4gTGlzdFtzdHJdOgogICAgICAgICIiIgogICAgICAgIDpwYXJhbSB0YWJsZV9uYW1lOgogICAgICAgIDpyZXR1cm4gbGlzdCBjb2x1bW4gbmFtZXM6CiAgICAgICAgIiIiCiAgICAgICAgcSA9IGYnUFJBR01BIHRhYmxlX2luZm8oe3RhYmxlX25hbWV9KScKICAgICAgICByZXMgPSBzZWxmLl9zcWxfcXVlcnkocSwgdGFibGVfbmFtZT10YWJsZV9uYW1lKQoKICAgICAgICByZXR1cm4gW3Jvd1snbmFtZSddIGZvciByb3cgaW4gcmVzXQoKICAgIGRlZiBfdGFibGVfbmFtZXNfZGljdChzZWxmKToKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnaWRfZ29vZCc6ICdSU19nb29kcycsCiAgICAgICAgICAgICd0eXBlX2dvb2QnOiAnUlNfdHlwZXNfZ29vZHMnLAogICAgICAgICAgICAndW5pdCc6ICdSU191bml0cycsCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6ICdSU19wcm9wZXJ0aWVzJywKICAgICAgICAgICAgJ2lkX3Nlcmllcyc6ICdSU19zZXJpZXMnLAogICAgICAgICAgICAnaWRfdW5pdCc6ICdSU191bml0cycsCiAgICAgICAgICAgICdpZF9jb3VudHJhZ2VudHMnOiAnUlNfY291bnRyYWdlbnRzJywKICAgICAgICAgICAgJ2lkX3dhcmVob3VzZSc6ICdSU193YXJlaG91c2VzJywKICAgICAgICAgICAgJ2lkX2RvYyc6ICdSU19kb2NzJywKICAgICAgICAgICAgJ2lkX2NlbGwnOiAnUlNfY2VsbHMnLAogICAgICAgICAgICAnaWRfb3duZXInOiAnUlNfZ29vZHMnLAogICAgICAgICAgICAnaWRfcHJpY2VfdHlwZXMnOiAnUlNfcHJpY2VfdHlwZXMnCiAgICAgICAgfQoKY2xhc3MgU3FsUXVlcnlQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lPScnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSwgZGVidWc9RmFsc2UpOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICAjIHNlbGYuc3FsID0gc3FsX2NsYXNzCiAgICAgICAgc2VsZi5zcWwgPSBzZWxmCiAgICAgICAgc2VsZi5zcWxfdGV4dCA9ICcnCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gTm9uZQogICAgICAgIHNlbGYuZGVidWcgPSBkZWJ1ZwoKICAgIEBwcm9wZXJ0eQogICAgZGVmIHRhYmxlX25hbWUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fdGFibGVfbmFtZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3RhYmxlX25hbWUKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYne3NlbGZ9OiB0YWJsZV9uYW1lIG11c3QgYmUgc3BlY2lmaWVkJykKCiAgICBkZWYgX19yZXByX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYnU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPXtzZWxmLl90YWJsZV9uYW1lfSknCgogICAgQHRhYmxlX25hbWUuc2V0dGVyCiAgICBkZWYgdGFibGVfbmFtZShzZWxmLCB2KToKICAgICAgICBzZWxmLl90YWJsZV9uYW1lID0gdgoKICAgIGRlZiBjcmVhdGUoc2VsZiwgZGF0YSk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKGRhdGEpCgogICAgICAgIHJldHVybiBzZWxmLl9leGVjX2NyZWF0ZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXQogICAgICAgICkKCiAgICBkZWYgcmVwbGFjZShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfcmVwbGFjZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXQogICAgICAgICkKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGRhdGEsIF9maWx0ZXI9Tm9uZSk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB3aGVyZSA9IE5vbmUKICAgICAgICBmaWx0ZXJfZGF0YSA9IFtdCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gbGlzdChfZmlsdGVyLnZhbHVlcygpKQoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKGRhdGEsIGZpbHRlcl9kYXRhPWZpbHRlcl9kYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY191cGRhdGUoCiAgICAgICAgICAgIGNvbHVtbnM9cXVlcnlfZGF0YVsnY29sdW1ucyddLAogICAgICAgICAgICBwYXJhbXM9cXVlcnlfZGF0YVsncGFyYW1zJ10sCiAgICAgICAgICAgIHdoZXJlPXdoZXJlCiAgICAgICAgKQoKICAgIGRlZiBkZWxldGUoc2VsZiwgX2ZpbHRlcj1Ob25lKToKICAgICAgICB3aGVyZSA9IE5vbmUKICAgICAgICBmaWx0ZXJfZGF0YSA9IFtdCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gbGlzdChfZmlsdGVyLnZhbHVlcygpKQoKICAgICAgICBxdWVyeV9kYXRhID0gc2VsZi5fY29udmVydF9xdWVyeV9kYXRhKHt9LCBmaWx0ZXJfZGF0YT1maWx0ZXJfZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfZGVsZXRlKAogICAgICAgICAgICBwYXJhbXM9cXVlcnlfZGF0YVsncGFyYW1zJ10sCiAgICAgICAgICAgIHdoZXJlPXdoZXJlCiAgICAgICAgKQoKICAgIGRlZiBzZWxlY3Qoc2VsZiwgX2ZpbHRlcj1Ob25lKSAtPiBsaXN0OgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIHBhcmFtcyA9ICcnCiAgICAgICAgaWYgX2ZpbHRlcjoKICAgICAgICAgICAgd2hlcmUgPSBsaXN0KF9maWx0ZXIpCiAgICAgICAgICAgIHBhcmFtcyA9IFtzdHIodikgZm9yIHYgaW4gX2ZpbHRlci52YWx1ZXMoKV0KCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfc2VsZWN0KAogICAgICAgICAgICBwYXJhbXM9cGFyYW1zLAogICAgICAgICAgICB3aGVyZT13aGVyZSwKICAgICAgICApCgogICAgZGVmIF9leGVjX2NyZWF0ZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMpOgogICAgICAgIHN0cl92YWx1ZXMgPSAnLCcuam9pbignPycgKiBsZW4oY29sdW1ucykpCiAgICAgICAgc3RyX2tleXMgPSAnLCAnLmpvaW4oW2Yne25hbWV9JyBmb3IgbmFtZSBpbiBjb2x1bW5zXSkKCiAgICAgICAgcSA9IGYnSU5TRVJUIElOVE8ge3NlbGYudGFibGVfbmFtZX0gKHtzdHJfa2V5c30pIFZBTFVFUyAoe3N0cl92YWx1ZXN9KScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfcmVwbGFjZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMpOgogICAgICAgIHN0cl9jb2x1bW5zID0gJywgJy5qb2luKGNvbHVtbnMpCiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsJy5qb2luKCc/JyAqIGxlbihjb2x1bW5zKSkKCiAgICAgICAgcSA9IGYnUkVQTEFDRSBJTlRPIHtzZWxmLnRhYmxlX25hbWV9ICh7c3RyX2NvbHVtbnN9KSBWQUxVRVMgKHtzdHJfdmFsdWVzfSknCgogICAgICAgIHBhcmFtcyA9IGpzb24uZHVtcHMocGFyYW1zLCBlbnN1cmVfYXNjaWk9RmFsc2UpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX2V4ZWNfbWFueShxLCBwYXJhbXMpCgogICAgZGVmIF9leGVjX3VwZGF0ZShzZWxmLCBjb2x1bW5zLCBwYXJhbXMsIHdoZXJlPU5vbmUpOgogICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAnIGFuZCAnLmpvaW4oW2Yne2tleX09PycgZm9yIGtleSBpbiB3aGVyZV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJ3RydWUnCgogICAgICAgIHN0cl92YWx1ZXMgPSAnLCAnLmpvaW4oW2Yne25hbWV9PT8nIGZvciBuYW1lIGluIGNvbHVtbnNdKQoKICAgICAgICBxID0gZidVUERBVEUge3NlbGYudGFibGVfbmFtZX0gU0VUIHtzdHJfdmFsdWVzfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfZGVsZXRlKHNlbGYsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgcSA9IGYnREVMRVRFIEZST00ge3NlbGYudGFibGVfbmFtZX0gV0hFUkUge3N0cl93aGVyZX0nCgogICAgICAgIHBhcmFtcyA9IGpzb24uZHVtcHMocGFyYW1zLCBlbnN1cmVfYXNjaWk9RmFsc2UpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX2V4ZWNfbWFueShxLCBwYXJhbXMpCgogICAgZGVmIF9leGVjX3NlbGVjdChzZWxmLCBwYXJhbXMsIHdoZXJlPU5vbmUpOgogICAgICAgIGlmIHdoZXJlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAnIGFuZCAnLmpvaW4oW2Yne2tleX09PycgZm9yIGtleSBpbiB3aGVyZV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJ3RydWUnCgogICAgICAgIHEgPSBmJ1NFTEVDVCAqIEZST00ge3NlbGYudGFibGVfbmFtZX0gV0hFUkUge3N0cl93aGVyZX0nCgogICAgICAgIHBhcmFtcyA9ICcsICcuam9pbihwYXJhbXMpCiAgICAgICAgcmV0dXJuIHNlbGYuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCiAgICBkZWYgc3FsX2V4ZWNfbWFueShzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zcWwuU1FMRXhlY01hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfZXhlYyhzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXR1cm4gc2VsZi5zcWwuU1FMRXhlYyhxLCBwYXJhbXM9cGFyYW1zKQoKICAgIGRlZiBzcWxfcXVlcnkoc2VsZiwgcSwgcGFyYW1zOiBzdHIgPSAnJykgLT4gTGlzdFtkaWN0XToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gcQogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IHBhcmFtcwoKICAgICAgICBpZiBub3Qgc2VsZi5kZWJ1ZzoKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5zcWwuU1FMUXVlcnkocSwgcGFyYW1zKQogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhyZXN1bHQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSwgZmlsdGVyX2RhdGE9Tm9uZSk6CiAgICAgICAgY29sdW1ucyA9IFtdCiAgICAgICAgcGFyYW1zID0gW10KICAgICAgICBpZiBub3QgZmlsdGVyX2RhdGE6CiAgICAgICAgICAgIGZpbHRlcl9kYXRhID0gW10KCiAgICAgICAgaWYgaXNpbnN0YW5jZShkYXRhLCBsaXN0KToKICAgICAgICAgICAgY29sdW1ucyA9IGxpc3QoZGF0YVswXSkKICAgICAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZChbdiBmb3IgdiBpbiByb3cudmFsdWVzKCldICsgZmlsdGVyX2RhdGEpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKGRhdGEsIGRpY3QpOgogICAgICAgICAgICBjb2x1bW5zID0gbGlzdChkYXRhKQogICAgICAgICAgICBwYXJhbXMgPSBbW3YgZm9yIHYgaW4gZGF0YS52YWx1ZXMoKV0gKyBmaWx0ZXJfZGF0YV0KICAgICAgICBlbHNlOgogICAgICAgICAgICBWYWx1ZUVycm9yKGYnZGF0YSBtdXN0IGJlIGxpc3Qgb3IgZGljdCwgbm90IHt0eXBlKGRhdGEpfScpCgogICAgICAgIHJldHVybiB7J2NvbHVtbnMnOiBjb2x1bW5zLCAncGFyYW1zJzogcGFyYW1zfQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjb252ZXJ0X3NxbF9wYXJhbXMoc3FsX3F1ZXJ5LCBwYXJhbXNfZGljdCk6CiAgICAgICAgaW1wb3J0IHJlCiAgICAgICAgcGFyYW1fdmFsdWVzID0gW10KCiAgICAgICAgZGVmIHJlcGxhY2VfbmFtZWRfcGFyYW0obWF0Y2gpOgogICAgICAgICAgICBwYXJhbV9uYW1lID0gbWF0Y2guZ3JvdXAoMSkKCiAgICAgICAgICAgIHBhcmFtX3ZhbHVlcy5hcHBlbmQocGFyYW1zX2RpY3RbcGFyYW1fbmFtZV0pCgogICAgICAgICAgICByZXR1cm4gIj8iCgogICAgICAgIG5ld19xdWVyeSA9IHJlLnN1YihyJzooXHcrKScsIHJlcGxhY2VfbmFtZWRfcGFyYW0sIHNxbF9xdWVyeSkKCiAgICAgICAgcmV0dXJuIG5ld19xdWVyeSwgcGFyYW1fdmFsdWVzCgogICAgIyDQvNC10YLQvtC00Ysg0L3QuNC20LUg0LTQvtCx0LDQstC70LXQvdGLINC00LvRjyDQstGA0LXQvNC10L3QvdC+0LPQviDRgNC10YjQtdC90LjRjyDQv9GA0L7QsdC70LXQvNGLIFNRTFByb3ZpZGVyINC90LAgOSDQsNC90LTRgNC+0LjQtNC1CiAgICBkZWYgU1FMRXhlYyhzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIHBhcmFtczoKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCB0dXBsZShwYXJhbXMuc3BsaXQoJywnKSkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKGdldF9xdWVyeV9yZXN1bHQocSkpCgogICAgZGVmIFNRTEV4ZWNNYW55KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgcmV0dXJuIGJ1bGtfcXVlcnkocSwganNvbi5sb2FkcyhwYXJhbXMpKQoKICAgIGRlZiBTUUxRdWVyeShzZWxmLCBxLCBwYXJhbXMpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIHBhcmFtczoKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCB0dXBsZShwYXJhbXMuc3BsaXQoJywnKSksIHJldHVybl9kaWN0PVRydWUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKGdldF9xdWVyeV9yZXN1bHQocSwgcmV0dXJuX2RpY3Q9VHJ1ZSkpCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\hs_services.py",
                "PyFileKey": "hs_services",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBDYWxsYWJsZSwgVW5pb24KZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGpzb24KZnJvbSByZXF1ZXN0cy5hdXRoIGltcG9ydCBIVFRQQmFzaWNBdXRoCgoKY2xhc3MgSHNTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGh0dHBfcGFyYW1zKToKICAgICAgICBzZWxmLnVybCA9IGh0dHBfcGFyYW1zWyd1cmwnXQogICAgICAgIHNlbGYudXNlcm5hbWUgPSBodHRwX3BhcmFtc1sndXNlciddCiAgICAgICAgc2VsZi5wYXNzd29yZCA9IGh0dHBfcGFyYW1zWydwYXNzJ10KICAgICAgICBzZWxmLmFuZHJvaWRfaWQgPSBodHRwX3BhcmFtc1snYW5kcm9pZF9pZCddCiAgICAgICAgc2VsZi5kZXZpY2VfbW9kZWwgPSBodHRwX3BhcmFtc1snZGV2aWNlX21vZGVsJ10KICAgICAgICBzZWxmLnVzZXJfbmFtZSA9IGh0dHBfcGFyYW1zWyd1c2VyX25hbWUnXQogICAgICAgIHNlbGYucGFyYW1zID0geyd1c2VyX25hbWUnOiBzZWxmLnVzZXJfbmFtZSwgJ2RldmljZV9tb2RlbCc6IHNlbGYuZGV2aWNlX21vZGVsfQogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBzZWxmLmF1dGggPSBIVFRQQmFzaWNBdXRoKHNlbGYudXNlcm5hbWUsIHNlbGYucGFzc3dvcmQpCiAgICAgICAgc2VsZi5oZWFkZXJzID0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04J30KICAgICAgICBzZWxmLmh0dHBfYW5zd2VyOiBPcHRpb25hbFtIc1NlcnZpY2UuSHR0cEFuc3dlcl0gPSBOb25lCgogICAgZGVmIGdldF90ZW1wbGF0ZXMoc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX2hzID0gJ2xhYmVsX3RlbXBsYXRlcycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CgogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgICNyZXR1cm4ganNvbl9kYXRhCiAgICAgICAgZWxpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICBwcmludChhbnN3ZXIpCiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyWydyZWFzb24nXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyLmdldCgndGV4dCcpCgogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2RhdGEoc2VsZiwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgc2VsZi5faHMgPSAnZGF0YScKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlclsndGV4dCddKQogICAgICAgICAgICBmb3JtYXRfZGF0YSA9IGpzb25fZGF0YS5nZXQoJ2Zvcm1hdCcpCgogICAgICAgICAgICBpZiBmb3JtYXRfZGF0YToKICAgICAgICAgICAgICAgIGFuc3dlclsnZm9ybWF0J10gPSBmb3JtYXRfZGF0YQogICAgICAgICAgICAgICAgaWYgJ2lzX29rJyA9PSBmb3JtYXRfZGF0YSBhbmQganNvbl9kYXRhLmdldCgnYmF0Y2gnKToKICAgICAgICAgICAgICAgICAgICAjINCd0LDRiCDQt9Cw0L/RgNC+0YEg0L/RgNC40L3Rj9GCLCDQvdC+INCy0LXRgNC90YPRgtGMINC/0L7QutCwINC90LXRh9C10LPQvi4g0JTQsNC90L3Ri9C1INC40LvQuCDQs9C+0YLQvtCy0Y/RgtGB0Y8g0LjQu9C4INC40YUg0L3QtdGCCiAgICAgICAgICAgICAgICAgICAgYW5zd2VyWydiYXRjaCddID0ganNvbl9kYXRhLmdldCgnYmF0Y2gnKQoKICAgICAgICAgICAgICAgIGVsaWYgZm9ybWF0X2RhdGEgPT0gJ2lzX2RhdGEnOgogICAgICAgICAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhWydkYXRhJ10KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGFuc3dlclsnZm9ybWF0J10gPSBOb25lCiAgICAgICAgZWxpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICBwcmludChhbnN3ZXIpCiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyWydyZWFzb24nXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyLmdldCgndGV4dCcpCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYzogc3RyLCAqKmt3YXJncykgLT4gJ0h0dHBBbnN3ZXInOgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBzZW5kX2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYywgZGF0YSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKICAgICAgICBzZWxmLnBhcmFtc1snaWRfZG9jJ10gPSBpZF9kb2MKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCgogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfYWxsX2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYywgZGF0YSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzX3Jld3JpdGUnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgcmVzZXRfZXhjaGFuZ2Uoc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX2hzID0gJ3Jlc2V0X2V4Y2hhbmdlJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgY3JlYXRlX21lc3NhZ2VzKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgY29tbXVuaWNhdGlvbl90ZXN0KHNlbGYsICoqa3dhcmdzKSAtPiBkaWN0OgogICAgICAgIHNlbGYuX2hzID0gJ2NvbW11bmljYXRpb25fdGVzdCcKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2JhbGFuY2VzX2dvb2RzKHNlbGYsIGlkX3dhcmVob3VzZT1GYWxzZSwgaWRfY2VsbD1GYWxzZSwgaWRfZ29vZD1GYWxzZSwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHBhcmFtcyA9IHt9CiAgICAgICAgaWYgaWRfZ29vZDoKICAgICAgICAgICAgcGFyYW1zWydpZF9nb29kJ10gPSBpZF9nb29kCiAgICAgICAgaWYgaWRfY2VsbDoKICAgICAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9iYWxhbmNlcy9jZWxscycKICAgICAgICAgICAgcGFyYW1zWydpZF9jZWxsJ10gPSBpZF9jZWxsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9iYWxhbmNlcy93YXJlaG91c2VzJwogICAgICAgICAgICBpZiBpZF93YXJlaG91c2U6CiAgICAgICAgICAgICAgICBwYXJhbXNbJ2lkX3dhcmVob3VzZSddID0gaWRfd2FyZWhvdXNlCiAgICAgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgZ2V0X3ByaWNlc19nb29kcyhzZWxmLCBpZF9nb29kLCBpZF9wcm9wZXJ0eT1GYWxzZSwgaWRfdW5pdD1GYWxzZSwgaWRfcHJpY2VfdHlwZT1GYWxzZSwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHNlbGYuX2hzID0gJ2dvb2RfcHJpY2VzJwogICAgICAgIHBhcmFtcyA9IHsnaWRfZ29vZCc6IGlkX2dvb2R9CiAgICAgICAgaWYgaWRfcHJvcGVydHk6CiAgICAgICAgICAgIHBhcmFtc1snaWRfcHJvcGVydHknXSA9IGlkX3Byb3BlcnR5CiAgICAgICAgaWYgaWRfdW5pdDoKICAgICAgICAgICAgcGFyYW1zWydpZF91bml0J10gPSBpZF91bml0CiAgICAgICAgaWYgaWRfcHJpY2VfdHlwZToKICAgICAgICAgICAgcGFyYW1zWydpZF9wcmljZV90eXBlJ10gPSBpZF9wcmljZV90eXBlCgogICAgICAgIHNlbGYucGFyYW1zID0gcGFyYW1zCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfZG9jdW1lbnRzKHNlbGYsIGRhdGEsICoqa3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gYW5zd2VyCgogICAgZGVmIHNlbmRfZGF0YShzZWxmLCBkYXRhLCAqKmt3YXJncykgLT4gJ0h0dHBBbnN3ZXInOgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBzZW5kX2JhcmNvZGVzKHNlbGYsIGRhdGE6IGxpc3QsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAgIiIiCiAgICAgICAgOnBhcmFtIGRhdGE6IGRpY3QgKCdiYXJjb2RlJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydHknLCAnaWRfdW5pdCcpCiAgICAgICAgOnBhcmFtIGt3YXJnczogcmVxdWVzdHMgcG9zdCBwYXJhbXMKICAgICAgICA6cmV0dXJuOiBIdHRwQW5zd2VyCiAgICAgICAgIiIiCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdiYXJjb2RlcycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgX3NlbmRfcmVxdWVzdChzZWxmLCBrd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWV9CiAgICAgICAgdHJ5OgogICAgICAgICAgICByID0gc2VsZi5fbWV0aG9kKGYne3NlbGYudXJsfS9zaW1wbGVfYWNjb3VudGluZy97c2VsZi5faHN9P2FuZHJvaWRfaWQ9e3NlbGYuYW5kcm9pZF9pZH0nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGg9c2VsZi5hdXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9c2VsZi5oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz1zZWxmLnBhcmFtcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJncykKCiAgICAgICAgICAgIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9IHIuc3RhdHVzX2NvZGUKICAgICAgICAgICAgYW5zd2VyWyd1cmwnXSA9IHIudXJsCiAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFuc3dlclsnanNvbiddID0gci5qc29uKCkKICAgICAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuSlNPTkRlY29kZUVycm9yOgogICAgICAgICAgICAgICAgYW5zd2VyWydqc29uJ10gPSB7fQoKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ2VtcHR5J10gPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci5yZWFzb24KICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgICAgICAjIGFuc3dlclsnRXJyb3InXSA9IGUuYXJnc1swXQoKICAgICAgICByZXR1cm4gYW5zd2VyCgogICAgZGVmIF9jcmVhdGVfaHR0cF9hbnN3ZXIoc2VsZiwgYW5zd2VyOiBkaWN0KToKICAgICAgICBhbnN3ZXJfZGF0YSA9IHsKICAgICAgICAgICAgJ3N0YXR1c19jb2RlJzogYW5zd2VyLmdldCgnc3RhdHVzX2NvZGUnKSwKICAgICAgICAgICAgJ3VybCc6IGFuc3dlci5nZXQoJ3VybCcpLAogICAgICAgICAgICAnanNvbic6IGFuc3dlci5nZXQoJ2pzb24nKQogICAgICAgIH0KCiAgICAgICAgaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBhbnN3ZXJfZGF0YVsnZGF0YSddID0gYW5zd2VyLmdldCgnZGF0YScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yJ10gPSBUcnVlCiAgICAgICAgICAgIGFuc3dlcl9kYXRhWydlcnJvcl90ZXh0J10gPSBhbnN3ZXIuZ2V0KCdFcnJvcicpIG9yIGFuc3dlci5nZXQoJ2Vycm9yJykKICAgICAgICAgICAgaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ3VuYXV0aG9yaXplZCddID0gVHJ1ZQogICAgICAgICAgICBlbGlmIGFuc3dlcl9kYXRhWydzdGF0dXNfY29kZSddID09IDQwMzoKICAgICAgICAgICAgICAgIGFuc3dlcl9kYXRhWydmb3JiaWRkZW4nXSA9IFRydWUKCiAgICAgICAgICAgIGlmIGFuc3dlci5nZXQoJ3RleHQnKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBqc29uX3Jlc3VsdCA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dCA9IGpzb25fcmVzdWx0LmdldCgnZXJyb3InKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGVycm9yX3RleHQgPSBhbnN3ZXJbJ3RleHQnXS5kZWNvZGUoKQoKICAgICAgICAgICAgICAgIGFuc3dlcl9kYXRhWydlcnJvcl90ZXh0J10gPSBlcnJvcl90ZXh0CgogICAgICAgIHJldHVybiBzZWxmLkh0dHBBbnN3ZXIoKiphbnN3ZXJfZGF0YSkKCiAgICBkZWYgZ2V0X21ldGhvZF9ieV9wYXRoKHNlbGYsIHBhdGgpIC0+IFVuaW9uW0NhbGxhYmxlLCBOb25lXToKICAgICAgICBtZXRob2RzID0gewogICAgICAgICAgICAnYmFyY29kZXMnOiBzZWxmLnNlbmRfYmFyY29kZXMsCiAgICAgICAgICAgICdkb2N1bWVudHMnOiBzZWxmLnNlbmRfZG9jdW1lbnRzCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXQocGF0aCkKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBIdHRwQW5zd2VyOgogICAgICAgIHVybDogc3RyCiAgICAgICAgc3RhdHVzX2NvZGU6IGludAogICAgICAgIGpzb246IE9wdGlvbmFsID0gTm9uZQogICAgICAgIGVycm9yX3RleHQ6IE9wdGlvbmFsW3N0cl0gPSAnJwogICAgICAgIGRhdGE6IE9wdGlvbmFsID0gTm9uZQogICAgICAgIHVuYXV0aG9yaXplZDogYm9vbCA9IEZhbHNlCiAgICAgICAgZm9yYmlkZGVuOiBib29sID0gRmFsc2UKICAgICAgICBlcnJvcjogYm9vbCA9IEZhbHNlCgoKY2xhc3MgRGVidWdTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlwX2hvc3QsIHBvcnQ9MjQ0NCk6CiAgICAgICAgc2VsZi5pcF9ob3N0ID0gaXBfaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAgICBzZWxmLnVybCA9IGYnaHR0cDovL3tzZWxmLmlwX2hvc3R9OntzZWxmLnBvcnR9JwogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgZGVmIGV4cG9ydF9kYXRhYmFzZShzZWxmLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHsnU2ltcGxlS2VlcC5kYic6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2ZpbGUoc2VsZiwgZmlsZV9uYW1lLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHtmaWxlX25hbWU6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2xvZyhzZWxmLCBkYXRhKToKICAgICAgICBzZWxmLl9ocyA9ICd1bmxvYWRfbG9nJwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3Qoeydqc29uJzoganNvbi5kdW1wcyhkYXRhKX0pCgogICAgZGVmIF9zZW5kX3JlcXVlc3Qoc2VsZiwga3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGFuc3dlciA9IHsnZW1wdHknOiBUcnVlfQogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHNlbGYuX21ldGhvZChmJ3tzZWxmLnVybH0ve3NlbGYuX2hzfScsICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci50ZXh0CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCgogICAgICAgIHJldHVybiBhbnN3ZXIK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_global.py",
                "PyFileKey": "ui_global",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKaW1wb3J0IHNxbGl0ZTMKZnJvbSBzcWxpdGUzIGltcG9ydCBFcnJvcgppbXBvcnQgb3MKaW1wb3J0IHF1ZXVlCgoKCnF1ZXJ5X2xpc3QgPSBxdWV1ZS5RdWV1ZSgpCiMg0JLQvtGCINGC0LDQutC40Lwg0L3QtdC30LDRgtC10LnQu9C40LLRi9C8INC80LXRgtC+0LTQvtC8INC+0L/RgNC10LTQtdC70Y/QtdC8LCDQvNGLINC30LDQv9GD0YHRgtC40LvQuNGB0Ywg0L3QsCDQutC+0LzQv9C1INC40LvQuCDQvdCwINCi0KHQlCAqKgojINCd0YMg0Lgg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCLCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQsdCw0LfRgyAqKioqCmlmIG9zLnBhdGguZXhpc3RzKCcvL2RhdGEvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS9kYXRhYmFzZXMvJyk6ICPQu9C+0LrQsNC70YzQvdC+CiAgICBkYl9wYXRoID0gJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy9TaW1wbGVLZWVwJyAgIyByaWdodHNjYW4nCmVsc2U6CiAgICBkYl9wYXRoID0gZmlsZV9hYnNfcGF0aCA9IG9zLnBhdGguYWJzcGF0aCgnLi9TaW1wbGVLZWVwLmRiJykgICMgRDpcUHl0aG9uUHJvamVjdHNcUmlnaHRTY2FuXFNVSV9ub1BvbnlcCgpjb25uID0gTm9uZQoKCgpkZWYgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0OiBzdHIsIGFyZ3MgPSAiIiwgcmV0dXJuX2RpY3Q9RmFsc2UpIC0+IGxpc3Q6CiAgICAjICoqKioqKioqKioqKioqKioqKioqKioKCiAgICAjIGdsb2JhbCBjb25uCiAgICAjIGdldF9kYXRhYmFzZV9jb25uZWN0aW9uKCkKICAgIHRyeToKICAgICAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KGRiX3BhdGgpCgogICAgZXhjZXB0IEVycm9yOgoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBpZiBhcmdzOgogICAgICAgICAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5X3RleHQpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgZQoKICAgICMg0JXRgdC70Lgg0L3QsNC00L4gLSDQstC+0LfQstGA0LDRidCw0LXQvCDQvdC1INGA0LXQt9GD0LvRjNGC0LDRgiDQt9Cw0L/RgNC+0YHQsCwg0LAg0YHQu9C+0LLQsNGA0Ywg0YEg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNC90L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtC+0LwKICAgIGlmIHJldHVybl9kaWN0OgogICAgICAgIHJlcyA9IFtkaWN0KGxpbmUpIGZvciBsaW5lIGluCiAgICAgICAgICAgICAgIFt6aXAoW2NvbHVtblswXSBmb3IgY29sdW1uIGluIGN1cnNvci5kZXNjcmlwdGlvbl0sIHJvdykgZm9yIHJvdyBpbiBjdXJzb3IuZmV0Y2hhbGwoKV1dCiAgICBlbHNlOgogICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjb25uLmNvbW1pdCgpCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCmRlZiBidWxrX3F1ZXJ5KHE6IHN0ciwgYXJnczogTGlzdFt0dXBsZV0pOgogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ05vIGNvbm5lY3Rpb24gd2l0aCBkYXRhYmFzZScpCgogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQoKICAgIHRyeToKICAgICAgICBjdXJzb3IuZXhlY3V0ZW1hbnkocSwgYXJncykKICAgICAgICBjb25uLmNvbW1pdCgpCiAgICBleGNlcHQgc3FsaXRlMy5FcnJvciBhcyBlcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGVyKQoKICAgIGNvbm4uY2xvc2UoKQoKCgoKCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_models.py",
                "PyFileKey": "ui_models",
                "PyFileData": "aW1wb3J0IHJlCmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kCmltcG9ydCBqc29uCmZyb20ganNvbi5kZWNvZGVyIGltcG9ydCBKU09ORGVjb2RlRXJyb3IKaW1wb3J0IG9zCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgVHVwbGUsIENhbGxhYmxlCmltcG9ydCBzaHV0aWwKaW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCBoc19zZXJ2aWNlcwpmcm9tIHByaW50aW5nX2ZhY3RvcnkgaW1wb3J0IEhUTUxEb2N1bWVudCwgUHJpbnRTZXJ2aWNlLCBidApmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwLCBCYXJjb2RlV29ya2VyLCBnZXRfaXBfYWRkcmVzcwpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBEb2NTZXJ2aWNlLCBFcnJvclNlcnZpY2UsIEdvb2RzU2VydmljZSwgQmFyY29kZVNlcnZpY2UsIFRpbWVyU2VydmljZQpmcm9tIHRpbnlfZGJfc2VydmljZXMgaW1wb3J0IFNjYW5uaW5nUXVldWVTZXJ2aWNlLCBFeGNoYW5nZVF1ZXVlQnVmZmVyCmZyb20gaHNfc2VydmljZXMgaW1wb3J0IEhzU2VydmljZQppbXBvcnQgc3RhdGljX2RhdGEKZnJvbSBydS50cmF2ZWxmb29kLnNpbXBsZV91aSBpbXBvcnQgU2ltcGxlVXRpbGl0ZXMgYXMgc3VDbGFzcwoKaW1wb3J0IHdpZGdldHMKaW1wb3J0IHVpX2dsb2JhbAppbXBvcnQgYmFzZTY0CmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgpub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCmN1cnJlbnRfc2NyZWVuOiAnU2NyZWVuJyA9IE5vbmUKbmV4dF9zY3JlZW46ICdTY3JlZW4nID0gTm9uZQpfcnNfc2V0dGluZ3MgPSBub0NsYXNzKCJyc19zZXR0aW5ncyIpCgpjbGFzcyBTY3JlZW4oQUJDKToKICAgIHNjcmVlbl9uYW1lOiBzdHIKICAgIHByb2Nlc3NfbmFtZTogc3RyCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncz1fcnNfc2V0dGluZ3MpOgogICAgICAgIHNlbGYuaGFzaF9tYXA6IEhhc2hNYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IHJzX3NldHRpbmdzCiAgICAgICAgc2VsZi5ldmVudDogc3RyID0gc2VsZi5oYXNoX21hcFsnZXZlbnQnXQogICAgICAgIHNlbGYuaXNfZmluaXNoX3Byb2Nlc3MgPSBGYWxzZQogICAgICAgIHNlbGYucGFyZW50X3NjcmVlbiA9IE5vbmUKICAgICAgICBzZWxmLm9uX3N0YXJ0X2hhbmRsZXJzOiBMaXN0W0NhbGxhYmxlXT1bXQogICAgICAgIHNlbGYuaW5pdF9wYXJhbXMgPSB7fQoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGYne3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffV9pbml0JykKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNldF9uZXh0X3NjcmVlbihzZWxmKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoYXJncykKICAgICAgICBzZWxmLl9pbml0X3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaW5pdF9zY3JlZW4oKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSkKCiAgICBkZWYgc2hvd19wcm9jZXNzX3Jlc3VsdChzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNldF9uZXh0X3NjcmVlbihzZWxmKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoYXJncykKICAgICAgICBzZWxmLl9pbml0X3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaW5pdF9zY3JlZW4oKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19wcm9jZXNzX3Jlc3VsdChzZWxmLnByb2Nlc3NfbmFtZSwgc2VsZi5zY3JlZW5fbmFtZSkKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoZid7c2VsZi5fX2NsYXNzX18uX19uYW1lX199X2luaXQnKQogICAgICAgIHJldHVybiBzZWxmCgogICAgZGVmIHJlZnJlc2hfc2NyZWVuKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBoYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgQHByb3BlcnR5CiAgICBkZWYgbGlzdGVuZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAubGlzdGVuZXIKCiAgICBAbGlzdGVuZXIuc2V0dGVyCiAgICBkZWYgbGlzdGVuZXIoc2VsZiwgdik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfY2xlYXJfc2NyZWVuX3ZhbHVlcyhzZWxmKToKICAgICAgICBmb3Iga2V5IGluIHNlbGYuc2NyZWVuX3ZhbHVlczoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoa2V5KQoKICAgIGRlZiB0b2FzdChzZWxmLCB0ZXh0KToKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHRleHQpCgogICAgZGVmIF9pc19yZXN1bHRfcG9zaXRpdmUoc2VsZiwgbGlzdGVuZXIpIC0+IGJvb2w6CiAgICAgICAgcmV0dXJuIHNlbGYubGlzdGVuZXIgPT0gbGlzdGVuZXIgYW5kIHNlbGYuZXZlbnQgPT0gJ29uUmVzdWx0UG9zaXRpdmUnCgogICAgZGVmIF9pc19yZXN1bHRfbmVnYXRpdmUoc2VsZiwgbGlzdGVuZXIpIC0+IGJvb2w6CiAgICAgICAgcmV0dXJuIHNlbGYubGlzdGVuZXIgPT0gbGlzdGVuZXIgYW5kIHNlbGYuZXZlbnQgPT0gJ29uUmVzdWx0TmVnYXRpdmUnCgogICAgZGVmIF9fc3RyX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGYne3NlbGYucHJvY2Vzc19uYW1lfSAvIHtzZWxmLnNjcmVlbl9uYW1lfScKCiAgICBkZWYgX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gc2VsZi5zY3JlZW5fdmFsdWVzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHZhbHVlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYnUHJvY2Vzczoge3NlbGYucHJvY2Vzc19uYW1lfSwgc2NyZWVuOiB7c2VsZi5zY3JlZW5fbmFtZX0uJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ0ZvciBrZXkge2tleX0gbXVzdCBiZSBzZXQgdmFsdWUgbm90IE5vbmUnKQoKICAgIGRlZiBnZXRfaHR0cF9zZXR0aW5ncyhzZWxmKToKICAgICAgICBodHRwX3NldHRpbmdzID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgICAgICAgICAndXNlcic6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICAgICAgICAgJ2RldmljZV9tb2RlbCc6IHNlbGYuaGFzaF9tYXBbJ0RFVklDRV9NT0RFTCddLAogICAgICAgICAgICAnYW5kcm9pZF9pZCc6IHNlbGYuaGFzaF9tYXBbJ0FORFJPSURfSUQnXSwKICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgICAgICByZXR1cm4gaHR0cF9zZXR0aW5ncwoKICAgIGRlZiBwdXRfbm90aWZpY2F0aW9uKHNlbGYsIHRleHQsIHRpdGxlPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKHRleHQsIHRpdGxlKQoKICAgIGRlZiBjYW5fbGF1bmNoX3RpbWVyKHNlbGYpOgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9saXN0ZW5lcl9ub3RfaW1wbGVtZW50ZWQoc2VsZik6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvciAoZidsaXN0ZW5lciB7c2VsZi5saXN0ZW5lcn0gbm90IGltcGxlbWVudGVkJykKCiAgICBkZWYgX2lzX2luaXRfaGFuZGxlcihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5jb250YWluc0tleShmJ3tzZWxmLl9fY2xhc3NfXy5fX25hbWVfX31faW5pdCcpCgogICAgZGVmIF9pbml0X3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIGsgaW4gc2VsZi5zY3JlZW5fdmFsdWVzOgogICAgICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXNba10gPSBzZWxmLmhhc2hfbWFwW2tdCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzZWxmLmlzX2ZpbmlzaF9wcm9jZXNzID0gVHJ1ZQogICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3NfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGYuaXNfZmluaXNoX3Byb2Nlc3MgPSBUcnVlCiAgICAgICAgaWYgc2VsZi5wYXJlbnRfc2NyZWVuOgogICAgICAgICAgICBzZWxmLnBhcmVudF9zY3JlZW4uaGFzaF9tYXAgPSBzZWxmLmhhc2hfbWFwCiAgICAgICAgICAgIHNldF9uZXh0X3NjcmVlbihzZWxmLnBhcmVudF9zY3JlZW4pCiAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgaWYgc2VsZi5wYXJlbnRfc2NyZWVuOgogICAgICAgICAgICBzZWxmLnBhcmVudF9zY3JlZW4uaGFzaF9tYXAgPSBzZWxmLmhhc2hfbWFwCiAgICAgICAgICAgIHNldF9uZXh0X3NjcmVlbihzZWxmLnBhcmVudF9zY3JlZW4pCiAgICAgICAgc2VsZi5oYXNoX21hcC5iYWNrX3NjcmVlbigpCgogICAgZGVmIF9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKHNlbGYsIHJlbW92ZT1UcnVlKToKICAgICAgICBzZWxlY3RlZF9jYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgIGlmIHJlbW92ZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3NlbGVjdGVkX2NhcmRfZGF0YScpCgogICAgICAgIHJldHVybiBzZWxlY3RlZF9jYXJkX2RhdGEKCiAgICBkZWYgX3J1bl9vbl9zdGFydF9oYW5kbGVycyhzZWxmKToKICAgICAgICBmb3IgaGFuZGxlciBpbiBzZWxmLm9uX3N0YXJ0X2hhbmRsZXJzOgogICAgICAgICAgICBoYW5kbGVyKCkKICAgICAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVycy5yZW1vdmUoaGFuZGxlcikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZm9ybWF0X2RhdGUoZGF0ZV9zdHI6IHN0cik6CiAgICAgICAgcmV0dXJuIGRhdGV0aW1lLmZyb21pc29mb3JtYXQoZGF0ZV9zdHIpLnN0cmZ0aW1lKCclbS0lZC0lWSAlSDolTTolUycpCgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlLCByc19zZXR0aW5ncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gcnNfc2V0dGluZ3MuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJykKICAgICAgICAgICAgc2VsZi5UZXh0Q29sb3IgPSAnIzMzMzMzMycKICAgICAgICAgICAgc2VsZi5CYWNrZ3JvdW5kQ29sb3IgPSAnRkZDQzk5JwogICAgICAgICAgICBzZWxmLndlaWdodCA9IDAKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiMgPT09PT09PT09PT09PT09PT09PT0gUHJpbnRpbmcgc2NyZWVucyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIEh0bWxWaWV3KFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQoNC10LfRg9C70YzRgtCw0YInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgbGFibGVfZnVsbF9wYXRoID0gc2VsZi5wcmludF9uY2wuZ2V0KCdsYWJsZV9mdWxsX3BhdGgnKQogICAgICAgIGJhcmNvZGVfd2lkdGggPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV93aWR0aCcpCiAgICAgICAgYmFyY29kZV93aWR0aCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV93aWR0aCkpKSBpZiBiYXJjb2RlX3dpZHRoIGVsc2UgJzIwJwogICAgICAgIGJhcmNvZGVfaGVpZ2h0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfaGVpZ2h0JykKICAgICAgICBiYXJjb2RlX2hlaWdodCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9oZWlnaHQpKSkgaWYgYmFyY29kZV9oZWlnaHQgZWxzZSAnMjAnCiAgICAgICAgYmFyY29kZV9sZWZ0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfbGVmdCcpCiAgICAgICAgYmFyY29kZV9sZWZ0ID0gc3RyKGludChmbG9hdChiYXJjb2RlX2xlZnQpKSkgaWYgYmFyY29kZV9sZWZ0IGVsc2UgJzAnCiAgICAgICAgYmFyY29kZV9yaWdodCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3JpZ2h0JykKICAgICAgICBiYXJjb2RlX3JpZ2h0ID0gc3RyKGludChmbG9hdChiYXJjb2RlX3JpZ2h0KSkpIGlmIGJhcmNvZGVfcmlnaHQgZWxzZSAnMCcKICAgICAgICBiYXJjb2RlX3VwID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdXAnKQogICAgICAgIGJhcmNvZGVfdXAgPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfdXApKSkgaWYgYmFyY29kZV91cCBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfZG93biA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2Rvd24nKQogICAgICAgIGJhcmNvZGVfZG93biA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9kb3duKSkpIGlmIGJhcmNvZGVfZG93biBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfdHlwZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3R5cGVfY2xpY2snKSBvciAnZWFuMTMnCgogICAgICAgIGJhcmNvZGVfdHlwZXMgPSBbJ2VhbjEzJywgJ2NvZGUzOScsICdjb2RlMTI4JywgJ3FyLWNvZGUnXQoKICAgICAgICB0ZW1wbGF0ZV9kaXIsIHRlbXBsYXRlX2ZpbGUgPSBvcy5wYXRoLnNwbGl0KGxhYmxlX2Z1bGxfcGF0aCkKICAgICAgICBodG1sX2RvY19wYXJhbXMgPSBIVE1MRG9jdW1lbnQuZmluZF90ZW1wbGF0ZV92YXJpYWJsZXModGVtcGxhdGVfZGlyLCB0ZW1wbGF0ZV9maWxlKQogICAgICAgIGRvY19kZXRhaWxzID0gc2VsZi5nZXRfZGV0YWlsc19kYXRhKGh0bWxfZG9jX3BhcmFtcykKCiAgICAgICAgZGF0YV9mb3JfcHJpbnRpbmcgPSB7ZWxlbVsna2V5J106IGVsZW1bJ3ZhbHVlJ10gZm9yIGVsZW0gaW4gZG9jX2RldGFpbHN9CiAgICAgICAgZGF0YV9mb3JfcHJpbnRpbmcudXBkYXRlKGJhcmNvZGU9JzEyMzEyMzEyMzEyMycpCiAgICAgICAgbGlzdF9mb3JfY2hvb3NlID0gJzsnLmpvaW4oZGF0YV9mb3JfcHJpbnRpbmcua2V5cygpKQoKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBodG1sID0gSFRNTERvY3VtZW50KHRlbXBsYXRlX2RpciwgdGVtcGxhdGVfZmlsZSkuY3JlYXRlX2h0bWwoCiAgICAgICAgICAgIGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9YmFyY29kZV90eXBlKQoKICAgICAgICBodG1sID0gSFRNTERvY3VtZW50LmluamVjdF9jc3Nfc3R5bGUoCiAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgIHdpZHRoPWJhcmNvZGVfd2lkdGgsCiAgICAgICAgICAgIGhlaWdodD1iYXJjb2RlX2hlaWdodCwKICAgICAgICAgICAgeD1zdHIoaW50KGJhcmNvZGVfcmlnaHQpIC0gaW50KGJhcmNvZGVfbGVmdCkpLAogICAgICAgICAgICB5PXN0cihpbnQoYmFyY29kZV9kb3duKSAtIGludChiYXJjb2RlX3VwKSksCiAgICAgICAgKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3dpZHRoJywgYmFyY29kZV93aWR0aCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9oZWlnaHQnLCBiYXJjb2RlX2hlaWdodCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9sZWZ0JywgYmFyY29kZV9sZWZ0KQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3JpZ2h0JywgYmFyY29kZV9yaWdodCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV91cCcsIGJhcmNvZGVfdXApCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfZG93bicsIGJhcmNvZGVfZG93bikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV90eXBlcycsICc7Jy5qb2luKGJhcmNvZGVfdHlwZXMpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdodG1sJywgaHRtbCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGF0YV9mb3JfcHJpbnRpbmdfa2V5cycsIGxpc3RfZm9yX2Nob29zZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbWF0Y2hpbmdfdGFibGUnLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBnZXRfZGV0YWlsc19kYXRhKHNlbGYsIGh0bWxfZG9jX3BhcmFtczogc2V0KSAtPiBMaXN0W0RpY3RdOgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0gc2VsZi5oYXNoX21hcC5nZXQoJ21hdGNoaW5nX3RhYmxlJykKICAgICAgICBpZiBub3QgbWF0Y2hpbmdfdGFibGU6CiAgICAgICAgICAgIHJldHVybiBbeydrZXknOiBlbGVtLCAndmFsdWUnOiBlbGVtfSBmb3IgZWxlbSBpbiBodG1sX2RvY19wYXJhbXNdCiAgICAgICAgbWF0Y2hpbmdfdGFibGUgPSBqc29uLmxvYWRzKG1hdGNoaW5nX3RhYmxlKQogICAgICAgIG1hdGNoaW5nX3RhYmxlX2RhdGEgPSBtYXRjaGluZ190YWJsZVsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ10KICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGZvciBlbGVtIGluIGh0bWxfZG9jX3BhcmFtczoKICAgICAgICAgICAgdmFsdWUgPSBlbGVtCiAgICAgICAgICAgIGZvciBkYXRhIGluIG1hdGNoaW5nX3RhYmxlX2RhdGE6CiAgICAgICAgICAgICAgICBpZiBkYXRhLmdldCgna2V5JykgPT0gZWxlbToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFbJ3ZhbHVlJ10KICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh7J2tleSc6IGVsZW0sICd2YWx1ZSc6IHZhbHVlfSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIGlmIHNlbGYucHJpbnRfbmNsLmdldCgnZnJvbV9maWxlX2Jyb3dzZXInKToKICAgICAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnZnJvbV9maWxlX2Jyb3dzZXInKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fc2F2ZSc6CiAgICAgICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgibWF0Y2hpbmdfdGFibGUiKSkKICAgICAgICAgICAgY3VycmVudF90YWJsZSA9IG1hdGNoaW5nX3RhYmxlWydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXQogICAgICAgICAgICBjdXJyZW50X3RhYmxlLnBvcCgwKQogICAgICAgICAgICBmb3IgZWwgaW4gY3VycmVudF90YWJsZToKICAgICAgICAgICAgICAgIGlmIGVsLmdldCgna2V5Jyk6CiAgICAgICAgICAgICAgICAgICAgZWwucG9wKCdfbGF5b3V0JykKCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV93aWR0aCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3dpZHRoJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX2hlaWdodCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2hlaWdodCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9sZWZ0Jywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfbGVmdCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9yaWdodCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3JpZ2h0JyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3VwJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdXAnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfZG93bicsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2Rvd24nKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ21hdGNoaW5nX3RhYmxlJywganNvbi5kdW1wcyhjdXJyZW50X3RhYmxlKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3R5cGUnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV90eXBlX2NsaWNrJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX25hbWUnLCBzZWxmLnByaW50X25jbC5nZXQoJ2xhYmxlX2ZpbGVfbmFtZScpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfcGF0aCcsIHNlbGYucHJpbnRfbmNsLmdldCgnbGFibGVfZnVsbF9wYXRoJyksIFRydWUpCiAgICAgICAgICAgIGh0bWwgPSBzZWxmLmhhc2hfbWFwLmdldCgnaHRtbCcpCgogICAgICAgICAgICBvbGRfcHJldmlld190bXAgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCiAgICAgICAgICAgIGlmIG9sZF9wcmV2aWV3X3RtcCBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXdfdG1wKToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlld190bXApCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKCiAgICAgICAgICAgIG9sZF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICAgICAgaWYgb2xkX3ByZXZpZXcgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3KToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlldykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1ByaW50UHJldmlldycsIGh0bWwpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdQcmludFRvQml0bWFwJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdQcmludEJpdG1hcCc6CiAgICAgICAgICAgIHBhdGhfdG9fcG5nID0gc2VsZi5oYXNoX21hcC5nZXQoJ1ByaW50Qml0bWFwUGF0aCcpCiAgICAgICAgICAgICMg0J/QtdGA0LXQvdC+0YEg0YjQsNCx0LvQvtC90L7QsiDQsiDQvtGC0LTQtdC70YzQvdGD0Y4g0L/QsNC/0LrRgy4KICAgICAgICAgICAgZGlyZWN0b3J5LCBuYW1lID0gb3MucGF0aC5zcGxpdChwYXRoX3RvX3BuZykKICAgICAgICAgICAgbmV3X3BhdGggPSBvcy5wYXRoLmpvaW4oZGlyZWN0b3J5LCAnc2F2ZWRfbGFiZWxfdGVtcGxhdGVzJywgbmFtZSkKICAgICAgICAgICAgb3MubWFrZWRpcnMob3MucGF0aC5qb2luKGRpcmVjdG9yeSwgJ3NhdmVkX2xhYmVsX3RlbXBsYXRlcycpLCBleGlzdF9vaz1UcnVlKQogICAgICAgICAgICBzaHV0aWwuY29weShwYXRoX3RvX3BuZywgbmV3X3BhdGgpCiAgICAgICAgICAgIG9zLnJlbW92ZShwYXRoX3RvX3BuZykKCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScsIG5ld19wYXRoLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L0g0YHQvtGF0YDQsNC90ZHQvScpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnZnJvbV9maWxlX2Jyb3dzZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgY2FyZF9kYXRhID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJykpCiAgICAgICAgICAgIGlmIG5vdCBjYXJkX2RhdGE6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2xpc3RfZmllbGQnLCBzZWxmLmhhc2hfbWFwLmdldCgnZGF0YV9mb3JfcHJpbnRpbmdfa2V5cycpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCfQndCw0YHRgtGA0L7QudC60LDQodC+0L7RgtCy0LXRgtGB0YLQstC40Y/QlNC40LDQu9C+0LMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPWNhcmRfZGF0YVsna2V5J10sIGJ1dHRvbnM9WyfQlNCwJywgJ9Cd0LXRgiddKQoKICAgICAgICBlbGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCJldmVudCIpID09ICdvblJlc3VsdFBvc2l0aXZlJzoKICAgICAgICAgICAgY2FyZF9wb3NpdGlvbiA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQogICAgICAgICAgICBtYXRjaGluZ190YWJsZSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoIm1hdGNoaW5nX3RhYmxlIikpCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IG1hdGNoaW5nX3RhYmxlWydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXVtjYXJkX3Bvc2l0aW9uXQogICAgICAgICAgICBjdXJyZW50X2VsZW1bJ3ZhbHVlJ10gPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0X2ZpZWxkJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIm1hdGNoaW5nX3RhYmxlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbi5kdW1wcyhtYXRjaGluZ190YWJsZSwgZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXRmOCcpLmRlY29kZSgpKQogICAgICAgICAgICBzZWxmLm9uX3N0YXJ0KCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRldGFpbHM6IExpc3RbZGljdF0pOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgZm9yIHJlY29yZCBpbiBkZXRhaWxzOgogICAgICAgICAgICByZWNvcmQudXBkYXRlKF9sYXlvdXQ9c2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpKQogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gIiNGRkZGRkYiIGlmIHJlY29yZFsndmFsdWUnXSBlbHNlICcjRkJFOUU3JwogICAgICAgICAgICByZWNvcmRbJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kX2NvbG9yCiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHJlY29yZCkKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ca0LvRjtGHJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQl9C90LDRh9C10L3QuNC1Jywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BrZXknLCBzZWxmLnJzX3NldHRpbmdzKSwKCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B2YWx1ZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgoKY2xhc3MgVGVtcGxhdGVzTGlzdChTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5nZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goKQogICAgICAgIGlmIG5vdCBsaXN0X2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyINC/0YPRgdGCJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldyhsaXN0X2RhdGEpCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCd0ZW1wbGF0ZXNfY2FyZHMnLCBkb2NfY2FyZHMudG9fanNvbigpLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0ZW1wbGF0ZXNfY2FyZHMnLCBkb2NfY2FyZHMudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ21hdGNoaW5nX3RhYmxlJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScpKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmxlX2ZpbGVfbmFtZScsIGNhcmRfZGF0YS5nZXQoJ2ZpbGVfbmFtZScpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmxlX2Z1bGxfcGF0aCcsIGNhcmRfZGF0YS5nZXQoJ2Z1bGxfcGF0aCcpLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQoNC10LfRg9C70YzRgtCw0YInKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF9kYXRlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykKCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0iaG9yaXpvbnRhbCIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfc2l6ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY3JlYXRpb25fdGltZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBnZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goc2VsZik6CiAgICAgICAgdGVtcGxhdGVzX2RpciA9IHNlbGYucHJpbnRfbmNsLmdldCgnbGFiZWxfdGVtcGxhdGVzX2RpcicpCiAgICAgICAgZm9sZGVyX3BhdGggPSB0ZW1wbGF0ZXNfZGlyIG9yIG9zLnBhdGguam9pbihzdUNsYXNzLmdldF90ZW1wX2RpcigpLCAnbGFiZWxzJykKICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmVsX3RlbXBsYXRlc19kaXInLCBmb2xkZXJfcGF0aCwgVHJ1ZSkKICAgICAgICBodG1sX2ZpbGVzX2luZm8gPSBbXQoKICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayhmb2xkZXJfcGF0aCk6CiAgICAgICAgICAgIGZvciBmaWxlIGluIGZpbGVzOgogICAgICAgICAgICAgICAgaWYgZmlsZS5sb3dlcigpLmVuZHN3aXRoKCcuaHRtJyk6ICAjIGFuZCBtYXNrIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHJvb3QsIGZpbGUpCiAgICAgICAgICAgICAgICAgICAgZmlsZV9zaXplX2J5dGVzID0gb3MucGF0aC5nZXRzaXplKGZpbGVfcGF0aCkKICAgICAgICAgICAgICAgICAgICBmaWxlX3NpemVfa2IgPSBmaWxlX3NpemVfYnl0ZXMgLyAxMDI0ICAjIENvbnZlcnQgYnl0ZXMgdG8ga2lsb2J5dGVzCiAgICAgICAgICAgICAgICAgICAgY3JlYXRpb25fdGltZSA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAob3MucGF0aC5nZXRjdGltZShmaWxlX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lID0gY3JlYXRpb25fdGltZS5zdHJmdGltZSgKICAgICAgICAgICAgICAgICAgICAgICAgJyVZLSVtLSVkICVIOiVNOiVTJykgICMgRm9ybWF0IGRhdGV0aW1lIGZvciB1c2VyIGV5ZXMgKSkKCiAgICAgICAgICAgICAgICAgICAgZmlsZV9pbmZvID0gewogICAgICAgICAgICAgICAgICAgICAgICAnZnVsbF9wYXRoJzogZmlsZV9wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAnZmlsZV9uYW1lJzogZmlsZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbGVfc2l6ZSc6IGYne2ZpbGVfc2l6ZV9rYjouMmZ9IEtCJywKICAgICAgICAgICAgICAgICAgICAgICAgIyBGb3JtYXQgZmlsZSBzaXplIHdpdGggMiBkZWNpbWFsIHBsYWNlcwogICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRpb25fdGltZSc6IGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxfZmlsZXNfaW5mby5hcHBlbmQoZmlsZV9pbmZvKQogICAgICAgIHJldHVybiBodG1sX2ZpbGVzX2luZm8KCgpjbGFzcyBQcmludFNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoJ3ByaW50X25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHByaW50X3Rocm91Z2ggPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByaW50X3Rocm91Z2gnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjaGVja19ib3hfYmx1ZXRvb3RoX3ByaW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIocHJpbnRfdGhyb3VnaCA9PSAnQlQnKS5sb3dlcigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjaGVja19ib3hfd2lmaV9wcmludCcsIHN0cihwcmludF90aHJvdWdoID09ICdXaUZpJykubG93ZXIoKSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9ibHVldG9vdGhfcHJpbnRlcl9zZXR0aW5ncyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggQmx1ZXRvb3RoJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fd2lmaV9wcmludGVyX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fbGFiZWxfdGVtcGxhdGVzX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnY2hlY2tfYm94X2JsdWV0b290aF9wcmludCc6CiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJpbnRfdGhyb3VnaCcsICdCVCcsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cf0LXRh9Cw0YLRjCDRh9C10YDQtdC3IEJsdWV0b290aCcpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnY2hlY2tfYm94X3dpZmlfcHJpbnQnOgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByaW50X3Rocm91Z2gnLCAnV2lGaScsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cf0LXRh9Cw0YLRjCDRh9C10YDQtdC3IFdpRmknKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBQcmludEJsdWV0b290aFNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IEJsdWV0b290aCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5idF9uY2wgPSBub0NsYXNzKCJidF9zZXR0aW5ncyIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHByaW50ZXIgPSBzZWxmLmJ0X25jbC5nZXQoImRlZmF1bHRfcHJpbnRlciIpIG9yICfQndC1INCy0YvQsdGA0LDQvScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGVmYXVsdF9wcmludGVyJywgcHJpbnRlcikKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9zaG93X2Nvbm5lY3RlZCc6CiAgICAgICAgICAgIGRldmljZXMgPSBzZWxmLmhhc2hfbWFwLmdldCgiQlRSZXN1bHQiKQogICAgICAgICAgICBkZXZpY2VzID0ganNvbi5sb2FkcyhkZXZpY2VzKSBpZiBkZXZpY2VzIGVsc2UgW10KICAgICAgICAgICAgamNhcmRzID0geyJjYXJkcyI6IFtdfQoKICAgICAgICAgICAgZm9yIGRldmljZSBpbiBkZXZpY2VzOgogICAgICAgICAgICAgICAgY2FyZCA9IHsia2V5IjogZGV2aWNlLmdldCgiYWRkcmVzcyIpLAogICAgICAgICAgICAgICAgICAgICAgICAiaXRlbXMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ICLQo9GB0YLRgNC+0LnRgdGC0LLQviIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZGV2aWNlLmdldCgibmFtZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAiIzFiMzFjMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fc2l6ZSI6ICIxMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fY29sb3IiOiAiIzFiMzFjMiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ICJNQUMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGRldmljZS5nZXQoImFkZHJlc3MiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogIiMxMzFlNjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX3NpemUiOiAiMTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX2NvbG9yIjogIiMxYjMxYzIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJrZXkiOiAic3RhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGRldmljZS5nZXQoInN0YXRlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6ICIjMTMxZTYxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9zaXplIjogIjEyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9jb2xvciI6ICIjMWIzMWMyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdfQoKICAgICAgICAgICAgICAgIGpjYXJkc1siY2FyZHMiXS5hcHBlbmQoY2FyZCkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJjYXJkcyIsIGpzb24uZHVtcHMoamNhcmRzKSkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3N0b3Bfc2Nhbic6CiAgICAgICAgICAgIGlmIHNlbGYuYnRfbmNsLmdldCgnc2Nhbm5pbmcnKToKICAgICAgICAgICAgICAgIHNlbGYuYnRfbmNsLnB1dCgnc2Nhbm5pbmcnLCBGYWxzZSwgVHJ1ZSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdCVFN0b3BTY2FuJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQodC60LDQvdC40YDQvtCy0LDQvdC40LUg0L7RgdGC0LDQvdC+0LLQu9C10L3QvicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9idF9kaXNjb25uZWN0JzoKICAgICAgICAgICAgaWYgc2VsZi5idF9uY2wuZ2V0KCdkZWZhdWx0X3ByaW50ZXInKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBidC5jbG9zZV9zb2NrZXQoKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdkZWZhdWx0X3ByaW50ZXInKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYnRfbmNsLmRlbGV0ZSgnZGVmYXVsdF9wcmludGVyJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGVmYXVsdF9wcmludGVyJywgJ9Cd0LUg0LLRi9Cx0YDQsNC9JykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQn9GA0LjQvdGC0LXRgCDQvtGC0LrQu9GO0YfQtdC9JykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3Ri9GFINC/0YDQuNC90YLQtdGA0L7QsicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3Ri9GFINC/0YDQuNC90YLQtdGA0L7QsicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zdGFydF9zY2FuJzoKICAgICAgICAgICAgYnRfZGlzY292ZXJfaGFuZGxlcnMgPSBbewogICAgICAgICAgICAgICAgImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJzZXQiLAogICAgICAgICAgICAgICAgIm1ldGhvZCI6ICJiZWVwO3RvYXN0PUBCVERpc2NvdmVyUmVzdWx0IiwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6ICIiCiAgICAgICAgICAgIH1dCiAgICAgICAgICAgIHNlbGYuYnRfbmNsLnB1dCgnc2Nhbm5pbmcnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiQlRTdGFydFNjYW4iLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkJURGlzY292ZXJIYW5kbGVycyIsIGpzb24uZHVtcHMoYnRfZGlzY292ZXJfaGFuZGxlcnMpKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQutCw0L3QuNGA0L7QstCw0L3QuNC1JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGJ0X2hhbmRsZXJzID0gWwogICAgICAgICAgICAgICAgeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJibHVldG9vdGhfZXJyb3IifQogICAgICAgICAgICBdCgogICAgICAgICAgICBtYWMgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKG1hYykKICAgICAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCLQndC1INC/0L7Qu9GD0YfQuNC70L7RgdGMINC/0L7QtNC60LvRjtGH0LjRgtGM0YHRjyDQuiDRg9GB0YLRgNC+0LnRgdGC0LLRgyIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0YLQtdGB0YInKQogICAgICAgICAgICBjb25uZWN0ZWQgPSBidC5jb25uZWN0X3RvX2NsaWVudChkZXZpY2UsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICBpZiBub3QgY29ubmVjdGVkOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgi0KPRgdGC0YDQvtC50YHRgtCy0L4g0L3QtSDRj9Cy0LvRj9C10YLRgdGPINC/0YDQuNC90YLQtdGA0L7QvCIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5idF9uY2wucHV0KCJkZWZhdWx0X3ByaW50ZXIiLCBtYWMsIEZhbHNlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiZGVmYXVsdF9wcmludGVyIiwgbWFjKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQo9GB0L/QtdGI0L3QvicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl90ZXN0X3ByaW50JzoKICAgICAgICAgICAgaWYgc2VsZi5idF9uY2wuZ2V0KCdkZWZhdWx0X3ByaW50ZXInKToKICAgICAgICAgICAgICAgIHpwbCA9ICdeWEFeQ0ZBLDMwXkZPMTAsNTBeRkRUZXN0XkZTXkJZMywyLDEyMF5GTzEwLDE1MF5CQ15GRDEyMzQ1Njc4XkZTXlhaJwogICAgICAgICAgICAgICAgc2VudCwgcmVzdWx0ID0gUHJpbnRTZXJ2aWNlLnByaW50X2J0KHpwbCkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QocmVzdWx0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90YvRhSDQv9GA0LjQvdGC0LXRgNC+0LInKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBQcmludFdpRmlTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGltcG9ydCByZQogICAgICAgIGlwID0gc2VsZi5wcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBpcDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3dpX2ZpX2lwJywgaXApCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbmZvX3dpZmlfY3VycmVudF9pcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYnSVAg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsDoge2lwfScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaXAgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lfZmlfaXAnKQogICAgICAgICAgICBpZiBpcDoKICAgICAgICAgICAgICAgIHBhdHRlcm4gPSByJ14oXGR7MSwzfVwuKXszfVxkezEsM30kJwogICAgICAgICAgICAgICAgaWYgbm90IHJlLm1hdGNoKHBhdHRlcm4sIGlwKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnd2lfZmlfaXAnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXQstC10YDQvdGL0Lkg0YTQvtGA0LzQsNGCIElQJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90L7Qs9C+INC/0YDQuNC90YLQtdGA0LAnKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2luZm9fd2lmaV9jdXJyZW50X2lwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYnSVAg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsDoge2lwfScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLCBmJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdC+0LPQviDQv9GA0LjQvdGC0LXRgNCwJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl93aWZpX3NhdmVfaXAnOgogICAgICAgICAgICBzZWxmLl93aWZpX3NhdmVfaXAoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl93aWZpX2RlbGV0ZV9pcCc6CiAgICAgICAgICAgIHNlbGYuX3dpZmlfZGVsZXRlX2lwKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGVzdF93aV9maSc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ci0LXRgdGCINC/0LXRh9Cw0YLQuCcpCiAgICAgICAgICAgIHNlbGYuX3Rlc3Rfd2lfZmkoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl93aV9maV9wcmludF96cGwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQotC10YHRgiB6cGwnKQogICAgICAgICAgICBzZWxmLl9wcmludF96cGwoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3dpZmlfc2F2ZV9pcChzZWxmKToKICAgICAgICBpbXBvcnQgcmUKICAgICAgICBpcCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd3aV9maV9pcCcpCiAgICAgICAgaWYgbm90IGlwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHBhdHRlcm4gPSByJ14oXGR7MSwzfVwuKXszfVxkezEsM30kJwogICAgICAgIGlmIG5vdCByZS5tYXRjaChwYXR0ZXJuLCBpcCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCd3aV9maV9pcCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXQstC10YDQvdGL0Lkg0YTQvtGA0LzQsNGCIElQJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdjdXJyZW50X2lwJywgaXAsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCdJUCDQv9GA0LjQvdGC0LXRgNCwINC30LDQv9C40YHQsNC9JykKCiAgICBkZWYgX3dpZmlfZGVsZXRlX2lwKHNlbGYpOgogICAgICAgIGlwID0gc2VsZi5wcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LUg0YPQutCw0LfQsNC9IGlwJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ3dpX2ZpX2lwJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2N1cnJlbnRfaXAnKQogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ0lQINC/0YDQuNC90YLQtdGA0LAg0YPQtNCw0LvRkdC9JykKCiAgICBkZWYgX3ByaW50X3pwbChzZWxmKToKICAgICAgICB6cGwgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lfZmlfenBsX2lucHV0JykKICAgICAgICBpZiBub3QgenBsOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIgenBsINC60L7QtNCwINC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3dpZmlfZGF0YV90b19wcmludCcsIHpwbCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygncHJpbnRfd2lmaScpCgogICAgZGVmIF90ZXN0X3dpX2ZpKHNlbGYpOgogICAgICAgIHpwbCA9ICdeWEFeQ0ZBLDMwXkZPMTAsNTBeRkRUZXN0XkZTXkJZMywyLDEyMF5GTzEwLDE1MF5CQ15GRDEyMzQ1Njc4XkZTXlhaJwogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnd2lmaV9kYXRhX3RvX3ByaW50JywgenBsLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCgpjbGFzcyBQcmludExhYmVsVGVtcGxhdGVzU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBIc1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICB0ZW1wbGF0ZSA9IHNlbGYucHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJykgb3IgJ9Cd0LXRgicKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJywgZifQotC10LrRg9GJ0LjQuSDRiNCw0LHQu9C+0L06IHt0ZW1wbGF0ZX0nKQogICAgICAgIHBhdGhfdG9fbGFiZWxfcHJldmlld19pbWFnZSA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgaWYgbm90IHBhdGhfdG9fbGFiZWxfcHJldmlld19pbWFnZToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdGVtcF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgIHBhdGggPSB0ZW1wX3ByZXZpZXcgaWYgdGVtcF9wcmV2aWV3IGVsc2UgcGF0aF90b19sYWJlbF9wcmV2aWV3X2ltYWdlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnLCAnficgKyBwYXRoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX2dldF9sYWJlbHMnOgogICAgICAgICAgICBzZWxmLl9nZXRfbGFiZWxzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2VsZWN0X2xhYmVsX3RlbXBsYXRlJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kZWxldGVfdGVtcGxhdGVfc2V0dGluZ3MnOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV90ZW1wbGF0ZV9zZXR0aW5ncygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2xhYmVsX3RlbXBsYXRlX3NpemVfc2V0dGluZ3MnOgogICAgICAgICAgICBwYXRoX3RvX2xhYmVsID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICAgICAgaWYgbm90IHBhdGhfdG9fbGFiZWwgb3Igbm90IG9zLnBhdGguaXNmaWxlKHBhdGhfdG9fbGFiZWwpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQvdCw0YfQsNC70LAg0L3Rg9C20L3QviDQstGL0LHRgNCw0YLRjCDRiNCw0LHQu9C+0L0nKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KDQsNC30LzQtdGA0YsnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9sYWJlbHMoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuZ2V0X3RlbXBsYXRlcygpCiAgICAgICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSAhPSAyMDA6CiAgICAgICAgICAgICAgICByZWFzb24gPSBhbnN3ZXJbJ2Vycm9yX3Bvb2wnXQogICAgICAgICAgICAgICAgcmFpc2UgZifQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvDoge3JlYXNvbn0nCgogICAgICAgICAgICBvdXRwdXRfZm9sZGVyID0gb3MucGF0aC5qb2luKHN1Q2xhc3MuZ2V0X3RlbXBfZGlyKCksICdsYWJlbHMnKQoKICAgICAgICAgICAgb3MubWFrZWRpcnMob3V0cHV0X2ZvbGRlciwgZXhpc3Rfb2s9VHJ1ZSkKCiAgICAgICAgICAgIGRhdGFfbGlzdCA9IGFuc3dlclsnZGF0YSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZidkYXRhX2xpc3Q6e3R5cGUoZGF0YV9saXN0KX0sIHtkYXRhX2xpc3R9JykKCiAgICAgICAgICAgIGZvciBkYXRhX2RpY3QgaW4gZGF0YV9saXN0OgogICAgICAgICAgICAgICAgZmlsZV9uYW1lID0gc2VsZi5fY29ycmVjdF9maWxlbmFtZShkYXRhX2RpY3RbJ25hbWUnXSkgKyAnLmh0bScKICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbihvdXRwdXRfZm9sZGVyLCBmaWxlX25hbWUpCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICd3JywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS53cml0ZShiYXNlNjQuYjY0ZGVjb2RlKGRhdGFfZGljdFsnaHRtbCddKS5kZWNvZGUoJ3V0Zi04JykpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgKICAgICAgICAgICAgICAgICAgICAgICAgZifQntGI0LjQsdC60LAg0YHQvtGF0YDQsNC90LXQvdC40Y8g0YTQsNC50LvQsCB7ZmlsZV9wYXRofToge3N0cihlKX0nKQogICAgICAgICAgICAgICAgICAgIHJhaXNlIGYn0J7RiNC40LHQutCwINGB0L7RhdGA0LDQvdC10L3QuNGPINGE0LDQudC70LAge2ZpbGVfcGF0aH06IHtzdHIoZSl9JwogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmVsX3RlbXBsYXRlc19kaXInLCBvdXRwdXRfZm9sZGVyLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L3RiyDQt9Cw0LPRgNGD0LbQtdC90YsnKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzdHIoZSkpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9jb3JyZWN0X2ZpbGVuYW1lKGZpbGVuYW1lKToKICAgICAgICBpbGxlZ2FsX2NoYXJzID0gWyc8JywgJz4nLCAnOicsICciJywgIiciLCAnLycsICdcXCcsICd8JywgJz8nLCAnKicsICI8IiwgIj4iLAogICAgICAgICAgICAgICAgICAgICAgICAgJ1x4MDAnXQogICAgICAgIGZvciBjaGFyIGluIGlsbGVnYWxfY2hhcnM6CiAgICAgICAgICAgIGZpbGVuYW1lID0gZmlsZW5hbWUucmVwbGFjZShjaGFyLCAnJykKICAgICAgICByZXR1cm4gZmlsZW5hbWUKCiAgICBkZWYgZGVsZXRlX3RlbXBsYXRlX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV93aWR0aCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX2hlaWdodCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX2xlZnQnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV9yaWdodCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3VwJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfZG93bicpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdtYXRjaGluZ190YWJsZScpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3R5cGUnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfcGF0aCcpCgogICAgICAgIG9sZF9wcmV2aWV3X3RtcCA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKICAgICAgICBpZiBvbGRfcHJldmlld190bXAgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3X3RtcCk6CiAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlld190bXApCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgIG9sZF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICBpZiBvbGRfcHJldmlldyBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXcpOgogICAgICAgICAgICBvcy5yZW1vdmUob2xkX3ByZXZpZXcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKCgpjbGFzcyBQcmludFRlbXBsYXRlU2l6ZVNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCg0LDQt9C80LXRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHdpZHRoX3RlbXBsYXRlID0gc2VsZi5oYXNoX21hcC5nZXQoJ3dpZHRoX3ByaW50X3RlbXBsYXRlJykKICAgICAgICB3aWR0aF90ZW1wbGF0ZSA9IGludChmbG9hdCh3aWR0aF90ZW1wbGF0ZSkpIGlmIHdpZHRoX3RlbXBsYXRlIGVsc2UgNTAKICAgICAgICBoZWlnaHRfdGVtcGxhdGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnaGVpZ2h0X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBoZWlnaHRfdGVtcGxhdGUgPSBpbnQoZmxvYXQoaGVpZ2h0X3RlbXBsYXRlKSkgaWYgaGVpZ2h0X3RlbXBsYXRlIGVsc2UgNTAKICAgICAgICBkcG1tID0gc2VsZi5oYXNoX21hcC5nZXQoJ2RwbW1fcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGRwbW0gPSBpbnQoZHBtbSkgaWYgZHBtbSBlbHNlIDgKICAgICAgICBpbWFnZV9oZWlnaHQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBpbWFnZV9oZWlnaHQgPSBpbnQoZmxvYXQoaW1hZ2VfaGVpZ2h0KSkgaWYgaW1hZ2VfaGVpZ2h0IGVsc2UgNTAKICAgICAgICBpbWFnZV93aWR0aCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgaW1hZ2Vfd2lkdGggPSBpbnQoZmxvYXQoaW1hZ2Vfd2lkdGgpKSBpZiBpbWFnZV93aWR0aCBlbHNlIDUwCiAgICAgICAgbGwgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGxsID0gaW50KGZsb2F0KGxsKSkgaWYgbGwgZWxzZSAxNQogICAgICAgIHB3ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBwdyA9IGludChmbG9hdChwdykpIGlmIHB3IGVsc2UgMTAwMAogICAgICAgIHkgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfeV9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgeSA9IGludChmbG9hdCh5KSkgaWYgeSBlbHNlIDAKICAgICAgICB4ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3hfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIHggPSBpbnQoZmxvYXQoeCkpIGlmIHggZWxzZSAwCgogICAgICAgIHBhdGhfdG9faW1nID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICB6cGxkYXRhID0gUHJpbnRTZXJ2aWNlLm1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlPWltYWdlX3dpZHRoLAogICAgICAgICAgICBpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGU9aW1hZ2VfaGVpZ2h0LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlPWRwbW0sCiAgICAgICAgICAgIGltYWdlX2xsX3ByaW50X3RlbXBsYXRlPWxsLAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZT1wdywKICAgICAgICAgICAgaW1hZ2VfeF9wcmludF90ZW1wbGF0ZT14LAogICAgICAgICAgICBpbWFnZV95X3ByaW50X3RlbXBsYXRlPXksCiAgICAgICAgICAgIHBhdGhfdG9faW1nPXBhdGhfdG9faW1nCiAgICAgICAgKQogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnenBsZGF0YScsIHpwbGRhdGEsIFRydWUpCiAgICAgICAgc3VjY2VzcywgYW5zd2VyID0gUHJpbnRTZXJ2aWNlLnpwbF90b19wbmdfZnJvbV9hcGkoCiAgICAgICAgICAgIHpwbGRhdGEsIGRwbW0sIHdpZHRoX3RlbXBsYXRlLCBoZWlnaHRfdGVtcGxhdGUpCiAgICAgICAgaWYgbm90IHN1Y2Nlc3M6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBwYXRoLCBleHQgPSBvcy5wYXRoLnNwbGl0ZXh0KHBhdGhfdG9faW1nKQogICAgICAgIHByZXZpZXdfcGF0aCA9IHBhdGggKyAnX3ByZXZpZXcnICsgZXh0CiAgICAgICAgd2l0aCBvcGVuKHByZXZpZXdfcGF0aCwgJ3diJykgYXMgb3V0X2ZpbGU6CiAgICAgICAgICAgIHNodXRpbC5jb3B5ZmlsZW9iaihhbnN3ZXIsIG91dF9maWxlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3X3BhdGgsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3ByaW50JywgJ34nICsgcHJldmlld19wYXRoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3aWR0aF9wcmludF90ZW1wbGF0ZScsIHN0cih3aWR0aF90ZW1wbGF0ZSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hlaWdodF9wcmludF90ZW1wbGF0ZScsIHN0cihoZWlnaHRfdGVtcGxhdGUpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZScsIHN0cihpbWFnZV93aWR0aCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZScsIHN0cihpbWFnZV9oZWlnaHQpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkcG1tX3ByaW50X3RlbXBsYXRlJywgc3RyKGRwbW0pKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV9sbF9wcmludF90ZW1wbGF0ZScsIHN0cihsbCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJywgc3RyKHB3KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfeF9wcmludF90ZW1wbGF0ZScsIHN0cih4KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfeV9wcmludF90ZW1wbGF0ZScsIHN0cih5KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGlzdGVuZXInKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zYXZlX3RlbXBsYXRlX3NpemVzJzoKICAgICAgICAgICAgdGVtcGxhdGUgPSBkaWN0KAogICAgICAgICAgICAgICAgaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnZHBtbV9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2VfeF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3hfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX3lfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV95X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX2xsX3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdzYXZlZF9wcmludF90ZW1wbGF0ZScsIGpzb24uZHVtcHModGVtcGxhdGUpLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L0g0YHQvtGF0YDQsNC90ZHQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kZWxldGVfcHJpbnRfdGVtcGxhdGUnOgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ3NhdmVkX3ByaW50X3RlbXBsYXRlJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC9INGD0LTQsNC70ZHQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZW50X3RvX3ByaW50JzoKICAgICAgICAgICAgenBsZGF0YSA9IHNlbGYucHJpbnRfbmNsLmdldCgnenBsZGF0YScpCiAgICAgICAgICAgIFByaW50U2VydmljZS5wcmludF96cGwoenBsZGF0YSwgc2VsZi5oYXNoX21hcCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBQcmludGluZyBzY3JlZW5zIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTaW1wbGVGaWxlQnJvd3NlcihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KHQv9C40YHQvtC6INGE0LDQudC70L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9GA0L7QstC+0LTQvdC40LonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kZWJ1Z19ob3N0X2lwID0gcnNfc2V0dGluZ3MuZ2V0KCdkZWJ1Z19ob3N0X2lwJykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5EZWJ1Z1NlcnZpY2UoaXBfaG9zdD1zZWxmLmhhc2hfbWFwLmdldCgnaXBfaG9zdCcpIG9yIHNlbGYuZGVidWdfaG9zdF9pcCkgICMgJzE5Mi4xNjguMS43NycKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgY3VycmVudF9kaXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9kaXInKSBvciBzdUNsYXNzLmdldF90ZW1wX2RpcigpCiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5nZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goY3VycmVudF9kaXIpCiAgICAgICAgZG9jX2NhcmRzID0gc2VsZi5fZ2V0X2RvY19jYXJkc192aWV3KGxpc3RfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9kaXInLCBjdXJyZW50X2RpcikKICAgICAgICBzZWxmLmhhc2hfbWFwWydmaWxlX2Jyb3dzZXJfY2FyZHMnXSA9IGRvY19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBjdXJyZW50X2RpcmVjdG9yeSA9IFBhdGgoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZGlyJykpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX2dldF91cCc6CiAgICAgICAgICAgIGlmIG5vdCBvcy5hY2Nlc3MoY3VycmVudF9kaXJlY3RvcnkucGFyZW50LCBvcy5SX09LKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CU0L7RgdGC0YPQvyDQt9Cw0L/RgNC10YnRkdC9JykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2RpciddID0gY3VycmVudF9kaXJlY3RvcnkucGFyZW50CgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfZGF0YSIpKQogICAgICAgICAgICBpZiBjdXJyZW50X2VsZW1bJ2ZpbGVfdHlwZSddID09ICdGb2xkZXInOgogICAgICAgICAgICAgICAgbmV3X2RpciA9IFBhdGgoY3VycmVudF9kaXJlY3RvcnksIGN1cnJlbnRfZWxlbVsnZmlsZV9uYW1lJ10pCiAgICAgICAgICAgICAgICBpZiBvcy5hY2Nlc3MobmV3X2Rpciwgb3MuUl9PSyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9kaXInXSA9IG5ld19kaXIKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgICAgICBzZWxmLl9sYXlvdXRfYWN0aW9uKCkKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhOiBMaXN0W0RpY3RdKToKICAgICAgICBmb3Igcm93IGluIHRhYmxlX2RhdGE6CiAgICAgICAgICAgIGlmIHJvd1snZmlsZV90eXBlJ10gIT0gJ0ZpbGUnOgogICAgICAgICAgICAgICAgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfbGF5b3V0KGlzX2ZpbGU9RmFsc2UpCiAgICAgICAgICAgIGVsaWYgcm93WydleHRlbnNpb24nXSA9PSAnLmh0bSc6CiAgICAgICAgICAgICAgICByb3dbJ19sYXlvdXQnXSA9IHNlbGYuX2dldF9sYXlvdXQoaXNfaHRtPVRydWUpCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgc2VsZi5fZ2V0X2xheW91dCgpLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhLAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfZ2V0X2xheW91dChzZWxmLCBpc19maWxlOiBib29sID0gVHJ1ZSwgaXNfaHRtOiBib29sID0gRmFsc2UpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgIHBvcHVwX3ZhbHVlcyA9IFsn0JjQvdGE0L4nXQogICAgICAgIGlmIGlzX2ZpbGU6CiAgICAgICAgICAgIHBvcHVwX3ZhbHVlcy5hcHBlbmQoJ9Cf0LXRgNC10LTQsNGC0Ywg0L3QsCDQkdCRJykKICAgICAgICAgICAgaWYgaXNfaHRtOgogICAgICAgICAgICAgICAgcG9wdXBfdmFsdWVzLmFwcGVuZCgn0KjQsNCx0LvQvtC9INC/0LXRh9Cw0YLQuCcpCiAgICAgICAgbGF5b3V0ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHBpY3R1cmUnLAogICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPUZhbHNlLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSc7Jy5qb2luKHBvcHVwX3ZhbHVlcyksCiAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9InNlbnQiLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249Imhvcml6b250YWwiLAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BmaWxlX3NpemUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY3JlYXRpb25fdGltZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICApLAoKICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICApCiAgICAgICAgcmV0dXJuIGxheW91dAoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goZGlyZWN0b3J5OiBzdHIpIC0+IExpc3RbRGljdF06CiAgICAgICAgZmlsZXNfaW5mbyA9IFtdCiAgICAgICAgIyBXYWxrIHRocm91Z2ggdGhlIGZvbGRlciBhbmQgaXRzIHN1YmRpcmVjdG9yaWVzCiAgICAgICAgZGlyZWN0b3J5X3BhdGggPSBQYXRoKGRpcmVjdG9yeSkKICAgICAgICBmb3IgZmlsZSBpbiBkaXJlY3RvcnlfcGF0aC5pdGVyZGlyKCk6CiAgICAgICAgICAgIHBpYyA9ICgnI2YxNWInIGlmIGZpbGUuaXNfZmlsZSgpIGVsc2UKICAgICAgICAgICAgICAgICAgICcjZjBjMScgaWYgZmlsZS5pc19zeW1saW5rKCkgZWxzZSAnI2YwN2InKQogICAgICAgICAgICBmaWxlX3R5cGUgPSAoIkZpbGUiIGlmIGZpbGUuaXNfZmlsZSgpIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICJTeW1MaW5rIiBpZiBmaWxlLmlzX3N5bWxpbmsoKSBlbHNlICJGb2xkZXIiKQogICAgICAgICAgICBmb3JtYXR0ZWRfY3JlYXRpb25fdGltZSA9IHRpbWUuc3RyZnRpbWUoCiAgICAgICAgICAgICAgICAnJVktJW0tJWQgJUg6JU06JVMnLAogICAgICAgICAgICAgICAgdGltZS5sb2NhbHRpbWUoaW50KGZpbGUuc3RhdCgpLnN0X2N0aW1lKSkKICAgICAgICAgICAgKQogICAgICAgICAgICBmaWxlX2luZm8gPSB7CiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICdmaWxlX3R5cGUnOiBmaWxlX3R5cGUsCiAgICAgICAgICAgICAgICAnZmlsZV9uYW1lJzogZmlsZS5uYW1lLAogICAgICAgICAgICAgICAgJ2Z1bGxfcGF0aCc6IHN0cihkaXJlY3RvcnlfcGF0aC5qb2lucGF0aChmaWxlLm5hbWUpKSwKICAgICAgICAgICAgICAgICdmaWxlX3NpemUnOiBmJ3tmaWxlLnN0YXQoKS5zdF9zaXplIC8gMTAyNDouMmZ9IEtCJywKICAgICAgICAgICAgICAgICdjcmVhdGlvbl90aW1lJzogZm9ybWF0dGVkX2NyZWF0aW9uX3RpbWUsCiAgICAgICAgICAgICAgICAnZXh0ZW5zaW9uJzogZmlsZS5zdWZmaXgKICAgICAgICAgICAgfQogICAgICAgICAgICBmaWxlc19pbmZvLmFwcGVuZChmaWxlX2luZm8pCgogICAgICAgIHJldHVybiBmaWxlc19pbmZvCgogICAgZGVmIF9sYXlvdXRfYWN0aW9uKHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgc2VsZWN0ZWRfY2FyZDogZGljdCA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ2NhcmRfZGF0YScpKQogICAgICAgIGlmIGxpc3RlbmVyID09ICfQn9C10YDQtdC00LDRgtGMINC90LAg0JHQkSc6CiAgICAgICAgICAgIHNlbGYuX2NvcHlfZmlsZShQYXRoKHNlbGVjdGVkX2NhcmRbJ2Z1bGxfcGF0aCddKSkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICfQmNC90YTQvic6CiAgICAgICAgICAgIHNlbGVjdGVkX2NhcmQucG9wKCdfbGF5b3V0JywgTm9uZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzdHIoc2VsZWN0ZWRfY2FyZCkpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAn0KjQsNCx0LvQvtC9INC/0LXRh9Cw0YLQuCc6CiAgICAgICAgICAgIHByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCiAgICAgICAgICAgIHByaW50X25jbC5wdXQoJ2xhYmxlX2ZpbGVfbmFtZScsIHNlbGVjdGVkX2NhcmQuZ2V0KCdmaWxlX25hbWUnKSwgVHJ1ZSkKICAgICAgICAgICAgcHJpbnRfbmNsLnB1dCgnbGFibGVfZnVsbF9wYXRoJywgc2VsZWN0ZWRfY2FyZC5nZXQoJ2Z1bGxfcGF0aCcpLCBUcnVlKQogICAgICAgICAgICBwcmludF9uY2wucHV0KCdmcm9tX2ZpbGVfYnJvd3NlcicsIFRydWUsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19wcm9jZXNzX3Jlc3VsdCgn0J/QtdGH0LDRgtGMJywgJ9Cg0LXQt9GD0LvRjNGC0LDRgicpCgogICAgZGVmIF9jb3B5X2ZpbGUoc2VsZiwgZmlsZTogUGF0aCk6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpcF9ob3N0Jykgb3Igc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlYnVnX2hvc3RfaXAnKSAjICcxOTIuMTY4LjEuNzcnCiAgICAgICAgd2l0aCBvcGVuKGZpbGUsICdyYicpIGFzIGY6CiAgICAgICAgICAgICMgc2VuZF9zZXJ2aWNlID0gc2VsZi5oc19zZXJ2aWNlKGlwX2hvc3QpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuaHNfc2VydmljZS5leHBvcnRfZmlsZShmaWxlLm5hbWUsIGYpCgogICAgICAgICAgICBpZiByZXNbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChmJ9Ck0LDQudC7IHtmaWxlLm5hbWV9INGD0YHQv9C10YjQvdC+INCy0YvQs9GA0YPQttC10L0nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJykKCgojID09PT09PT09PT09PT09PT09PT09IFRpbGVzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBUaWxlcyhTY3JlZW4pOgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF90aWxlX3JvdyhzZWxmLCBsYXlvdXQsIHRpbGVfZWxlbWVudCwgc3RhcnRfc2NyZWVuPSfQlNC+0LrRg9C80LXQvdGC0YsnKToKICAgICAgICB0aWxlID0gewogICAgICAgICAgICAibGF5b3V0IjogbGF5b3V0LAogICAgICAgICAgICAiZGF0YSI6IHNlbGYuX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KSwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAiY29sb3IiOiAnI0ZGRkZGRicsCiAgICAgICAgICAgICJzdGFydF9zY3JlZW4iOiBmIntzdGFydF9zY3JlZW59IiwKICAgICAgICAgICAgInN0YXJ0X3Byb2Nlc3MiOiAiIiwKICAgICAgICAgICAgJ2tleSc6IHRpbGVfZWxlbWVudFsnZG9jVHlwZSddCiAgICAgICAgfQogICAgICAgIHJldHVybiB0aWxlCgogICAgZGVmIF9nZXRfbWVzc2FnZV90aWxlKHNlbGYsIG1lc3NhZ2UsIHRleHRfY29sb3I9JyMwMDAwMDAnKToKICAgICAgICB0aWxlX3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPSdAbm9fZGF0YScsCiAgICAgICAgICAgICAgICBUZXh0U2l6ZT1zZWxmLnJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICBUZXh0Q29sb3I9dGV4dF9jb2xvciwKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTAsCiAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9ImNlbnRlciIsCiAgICAgICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MCwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0iI2ZmZmZmZiIsCiAgICAgICAgICAgICAgICBQYWRkaW5nPTAKCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBhdXRvU2l6ZVRleHRUeXBlPSd1bmlmb3JtJywKICAgICAgICAgICAgd2VpZ2h0PTAsCiAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSJjZW50ZXIiLAogICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICBTdHJva2VXaWR0aD0zLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9IiNmZmZmZmYiLAogICAgICAgICAgICBQYWRkaW5nPTAKICAgICAgICApCgogICAgICAgIGxheW91dCA9IGpzb24ubG9hZHModGlsZV92aWV3LnRvX2pzb24oKSkKCiAgICAgICAgdGlsZXNfbGlzdCA9IFt7CiAgICAgICAgICAgICJsYXlvdXQiOiBsYXlvdXQsCiAgICAgICAgICAgICJkYXRhIjogeyJub19kYXRhIjogbWVzc2FnZX0sCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgImNvbG9yIjogJyNmZmZmZmYnLAogICAgICAgICAgICAic3RhcnRfc2NyZWVuIjogIiIsCiAgICAgICAgICAgICJzdGFydF9wcm9jZXNzIjogIiIsCiAgICAgICAgICAgICdTdHJva2VXaWR0aCc6ICcnLAogICAgICAgIH1dCgogICAgICAgIGNvdW50X3Jvd19lbGVtZW50cyA9IDEKICAgICAgICB0aWxlcyA9IHsKICAgICAgICAgICAgJ3RpbGVzJzogW3RpbGVzX2xpc3RdLAogICAgICAgICAgICAnYmFja2dyb3VuZF9jb2xvcic6ICcjZmZmZmZmJywKICAgICAgICAgICAgJ1N0cm9rZVdpZHRoJzogJycsCiAgICAgICAgICAgICdoZWlnaHQnOiAnJwoKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aWxlcwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpOgogICAgICAgIGNvdW50X3ZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF92ZXJpZmllZCddIG9yIDAKICAgICAgICBjb3VudF91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF91bnZlcmlmaWVkJ10gb3IgMAogICAgICAgIHF0dHlfcGxhbl92ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsncXR0eV9wbGFuX3ZlcmlmaWVkJ10gb3IgMAogICAgICAgIHF0dHlfcGxhbl91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50WydxdHR5X3BsYW5fdW52ZXJpZmllZCddIG9yIDAKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImRvY05hbWUiOiB0aWxlX2VsZW1lbnRbJ2RvY1R5cGUnXSwKICAgICAgICAgICAgJ1F0dHlPZkRvY3MnOiAne30ve30nLmZvcm1hdCh0aWxlX2VsZW1lbnRbJ2NvdW50J10sIHRpbGVfZWxlbWVudFsndmVyaWZpZWQnXSksCiAgICAgICAgICAgICdjb3VudF92ZXJpZmllZCc6ICd7fS97fScuZm9ybWF0KAogICAgICAgICAgICAgICAgY291bnRfdmVyaWZpZWQgKyBjb3VudF91bnZlcmlmaWVkLAogICAgICAgICAgICAgICAgY291bnRfdW52ZXJpZmllZCksCiAgICAgICAgICAgICdxdHR5X3BsYW5fdmVyaWZpZWQnOiAne30ve30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHF0dHlfcGxhbl92ZXJpZmllZCArIHF0dHlfcGxhbl91bnZlcmlmaWVkLAogICAgICAgICAgICAgICAgcXR0eV9wbGFuX3VudmVyaWZpZWQpCiAgICAgICAgfQoKICAgIGRlZiBfZ2V0X3RpbGVfdmlldyhzZWxmKSAtPiB3aWRnZXRzLkxpbmVhckxheW91dDoKICAgICAgICB0aWxlc192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY05hbWUnLAogICAgICAgICAgICAgICAgVGV4dFNpemU9c2VsZi5yc19zZXR0aW5ncy5nZXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAUXR0eU9mRG9jcycsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0YLRgNC+0Lo6ICcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGNvdW50X3ZlcmlmaWVkJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KLQvtCy0LDRgNC+0LI6ICcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQHF0dHlfcGxhbl92ZXJpZmllZCcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgYXV0b1NpemVUZXh0VHlwZT0ndW5pZm9ybScsCiAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGlsZXNfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSwgcnNfc2V0dGluZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9IHJzX3NldHRpbmdzLmdldCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgIHNlbGYuVGV4dENvbG9yID0gJyMzMzMzMzMnCiAgICAgICAgICAgIHNlbGYuQmFja2dyb3VuZENvbG9yID0gJ0ZGQ0M5OScKICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAwCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKCmNsYXNzIEZsb3dUaWxlc1NjcmVlbihUaWxlcyk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C70LjRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0KHQsdC+0YAg0KjQmicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKGlzX2JhcmNfZmxvdz1UcnVlKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgoKICAgICAgICBkYXRhID0gc2VsZi5kYl9zZXJ2aWNlLmdldF9kb2NfZmxvd19zdGF0KCkKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICAjIGxheW91dCA9IHNlbGYuX2dldF90aWxlX3ZpZXcoKQogICAgICAgICAgICBsYXlvdXQgPSBqc29uLmxvYWRzKHNlbGYuX2dldF90aWxlX3ZpZXcoKS50b19qc29uKCkpCgogICAgICAgICAgICB0aWxlc19saXN0ID0gW3NlbGYuX2dldF90aWxlX3JvdyhsYXlvdXQsIGl0ZW0pIGZvciBpdGVtIGluIGRhdGFdCgogICAgICAgICAgICAjIHNwbGl0IGxpc3QgYnkgdHdvIGVsZW1lbnQgaW4gcm93CiAgICAgICAgICAgIGNvdW50X3Jvd19lbGVtZW50cyA9IDIKICAgICAgICAgICAgdGlsZXMgPSB7CiAgICAgICAgICAgICAgICAndGlsZXMnOiBbCiAgICAgICAgICAgICAgICAgICAgdGlsZXNfbGlzdFtpOmkgKyBjb3VudF9yb3dfZWxlbWVudHNdCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHRpbGVzX2xpc3QpLCBjb3VudF9yb3dfZWxlbWVudHMpCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgJ2JhY2tncm91bmRfY29sb3InOiAnI2Y1ZjVmNScKCiAgICAgICAgICAgIH0KICAgICAgICBlbHNlOgogICAgICAgICAgICB0aWxlcyA9IHNlbGYuX2dldF9tZXNzYWdlX3RpbGUoItCd0LXRgiDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC00L7QutGD0LzQtdC90YLQvtCyIikKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RpbGVzJywgdGlsZXMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBfZ2V0X3RpbGVfdmlldyhzZWxmKSAtPiB3aWRnZXRzLkxpbmVhckxheW91dDoKICAgICAgICB0aWxlc192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY05hbWUnLAogICAgICAgICAgICAgICAgVGV4dFNpemU9c2VsZi5yc19zZXR0aW5ncy5nZXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAUXR0eU9mRG9jcycsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0YLRgNC+0Lo6ICcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGJhcmNfY291bnQnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBhdXRvU2l6ZVRleHRUeXBlPSd1bmlmb3JtJywKICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICApCgogICAgICAgIHJldHVybiB0aWxlc192aWV3CgogICAgZGVmIF9nZXRfdGlsZV9yb3coc2VsZiwgbGF5b3V0LCB0aWxlX2VsZW1lbnQsIHN0YXJ0X3NjcmVlbj0n0JTQvtC60YPQvNC10L3RgtGLJyk6CiAgICAgICAgdGlsZSA9IHsKICAgICAgICAgICAgImxheW91dCI6IGxheW91dCwKICAgICAgICAgICAgImRhdGEiOiBzZWxmLl9nZXRfdGlsZV9kYXRhKHRpbGVfZWxlbWVudCksCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgImNvbG9yIjogJyNGRkZGRkYnLAogICAgICAgICAgICAic3RhcnRfc2NyZWVuIjogZiJ7c3RhcnRfc2NyZWVufSIsCiAgICAgICAgICAgICJzdGFydF9wcm9jZXNzIjogIiIsCiAgICAgICAgICAgICdrZXknOiB0aWxlX2VsZW1lbnRbJ2RvY1R5cGUnXQogICAgICAgIH0KICAgICAgICByZXR1cm4gdGlsZQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpOgogICAgICAgIGNvdW50X3ZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wyd2ZXJpZmllZCddIG9yIDAKICAgICAgICAjIGNvdW50X3VudmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ2NvdW50X3VudmVyaWZpZWQnXSBvciAwCiAgICAgICAgYmFyY19jb3VudCA9IHRpbGVfZWxlbWVudFsnYmFyY19jb3VudCddIG9yIDAKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImRvY05hbWUiOiB0aWxlX2VsZW1lbnRbJ2RvY1R5cGUnXSwKICAgICAgICAgICAgJ1F0dHlPZkRvY3MnOiAne30ve30nLmZvcm1hdCh0aWxlX2VsZW1lbnRbJ2NvdW50J10sIHRpbGVfZWxlbWVudFsndmVyaWZpZWQnXSksCiAgICAgICAgICAgICdjb3VudF92ZXJpZmllZCc6IHN0cihjb3VudF92ZXJpZmllZCksCiAgICAgICAgICAgICdiYXJjX2NvdW50Jzogc3RyKGJhcmNfY291bnQpCiAgICAgICAgfQoKCmNsYXNzIEdyb3VwU2NhblRpbGVzKFRpbGVzKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0LvQuNGC0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQk9GA0YPQv9C/0L7QstCw0Y8g0L7QsdGA0LDQsdC+0YLQutCwJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IERvY1NlcnZpY2UoaXNfZ3JvdXBfc2Nhbj1UcnVlKQogICAgICAgIHNlbGYuc2NyZWVuX25hbWUgPSBzZWxmLmhhc2hfbWFwLmdldF9jdXJyZW50X3NjcmVlbigpCiAgICAgICAgc2VsZi5wcm9jZXNzX25hbWUgPSBzZWxmLmhhc2hfbWFwLmdldF9jdXJyZW50X3Byb2Nlc3MoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIGlmIG5vdCBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHRpbGVzID0gc2VsZi5fZ2V0X21lc3NhZ2VfdGlsZSgi0J7RgtGB0YPRgtGB0YLQstGD0LXRgiDRgdC+0LXQtNC40L3QtdC90LjQtSDRgSDRgdC10YDQstC10YDQvtC8IiwgdGV4dF9jb2xvcj0iI2ZmMDAwMCIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0aWxlcycsIHRpbGVzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydjaGVja19jb25uZWN0aW9uJ10gPSBGYWxzZQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5oYXNoX21hcFsnY2hlY2tfY29ubmVjdGlvbiddID0gVHJ1ZQoKICAgICAgICBkYXRhID0gc2VsZi5fZ2V0X2RvY3Nfc3RhdCgpCgogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgIGxheW91dCA9IGpzb24ubG9hZHMoc2VsZi5fZ2V0X3RpbGVfdmlldygpLnRvX2pzb24oKSkKCiAgICAgICAgICAgIHRpbGVzX2xpc3QgPSBbc2VsZi5fZ2V0X3RpbGVfcm93KGxheW91dCwgaXRlbSkgZm9yIGl0ZW0gaW4gZGF0YV0KCiAgICAgICAgICAgICMgc3BsaXQgbGlzdCBieSB0d28gZWxlbWVudCBpbiByb3cKICAgICAgICAgICAgY291bnRfcm93X2VsZW1lbnRzID0gMgogICAgICAgICAgICB0aWxlcyA9IHsKICAgICAgICAgICAgICAgICd0aWxlcyc6IFsKICAgICAgICAgICAgICAgICAgICB0aWxlc19saXN0W2k6aSArIGNvdW50X3Jvd19lbGVtZW50c10KICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4odGlsZXNfbGlzdCksIGNvdW50X3Jvd19lbGVtZW50cykKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAnYmFja2dyb3VuZF9jb2xvcic6ICcjZjVmNWY1JwoKICAgICAgICAgICAgfQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRpbGVzID0gc2VsZi5fZ2V0X21lc3NhZ2VfdGlsZSgi0J3QtdGCINC30LDQs9GA0YPQttC10L3QvdGL0YUg0LTQvtC60YPQvNC10L3RgtC+0LIiKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndGlsZXMnLCB0aWxlcywgdG9fanNvbj1UcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLnNjcmVlbl9uYW1lLCBhcmdzKQoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICBpZiAoc2VsZi5yc19zZXR0aW5ncy5nZXQoJ29mZmxpbmVfbW9kZScpIG9yCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmNvbnRhaW5zS2V5KCdjaGVja19jb25uZWN0aW9uJykpOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBoc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5IdHRwQW5zd2VyKAogICAgICAgICAgICAgICAgZXJyb3I9VHJ1ZSwKICAgICAgICAgICAgICAgIGVycm9yX3RleHQ9c3RyKGUuYXJnc1swXSksCiAgICAgICAgICAgICAgICBzdGF0dXNfY29kZT00MDQsCiAgICAgICAgICAgICAgICB1cmw9aHNfc2VydmljZS51cmwpCiAgICAgICAgcmV0dXJuIG5vdCBhbnN3ZXIuZXJyb3IKCiAgICBkZWYgX2dldF9kb2NzX3N0YXQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuZGJfc2VydmljZS5nZXRfZG9jc19zdGF0KCkKCgpjbGFzcyBEb2N1bWVudHNUaWxlcyhHcm91cFNjYW5UaWxlcyk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C70LjRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IERvY1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX2dldF9kb2NzX3N0YXQoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuZGJfc2VydmljZS5nZXRfZG9jc19zdGF0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBUaWxlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IERvY3NMaXN0ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgRG9jc0xpc3RTY3JlZW4oU2NyZWVuKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLnNlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQogICAgICAgIHNlbGYucG9wdXBfbWVudV9kYXRhID0gJycKICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UgPSBTY2FubmluZ1F1ZXVlU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgZG9jX3R5cGVzID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfdHlwZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oWyfQktGB0LUnXSArIGRvY190eXBlcykKICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2Nfc3RhdHVzX3NlbGVjdCddID0gJ9CS0YHQtTvQmiDQstGL0L/QvtC70L3QtdC90LjRjjvQktGL0LPRgNGD0LbQtdC9O9CaINCy0YvQs9GA0YPQt9C60LUnCgogICAgICAgIGRvY190eXBlID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfdGlsZV9rZXknXSBvciBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCiAgICAgICAgZG9jX3N0YXR1cyA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RvY19zdGF0dXMnXQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX2NsaWNrJ10gPSBkb2NfdHlwZQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3RpbGVfa2V5J10gPSAnJwogICAgICAgIGxpc3RfZGF0YSA9IHNlbGYuX2dldF9kb2NfbGlzdF9kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQoKICAgICAgICBwcmVwYXJlZF9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGxpc3RfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gJycKICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcocHJlcGFyZWRfZGF0YSwgc2VsZi5wb3B1cF9tZW51X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jQ2FyZHMnXSA9IGRvY19jYXJkcy50b19qc29uKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJkb2Nfc3RhdHVzX2NsaWNrIjoKICAgICAgICAgICAgIyBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9kb2Nfc3RhdHVzJ10gPSBzZWxmLmhhc2hfbWFwWyJkb2Nfc3RhdHVzX2NsaWNrIl0KICAgICAgICAgICAgc2VsZi5fZG9jX3N0YXR1c19jbGljaygpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2RlbGV0ZScpOgogICAgICAgICAgICBzZWxmLmNvbmZpcm1fZGVsZXRlX2RvY19saXN0ZW5lcigpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV9yZXNlbmRfZG9jJyk6CiAgICAgICAgICAgIHNlbGYuX3Jlc2VuZF9kb2MoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZikgLT4gTm9uZToKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwWydsYXlvdXRfbGlzdGVuZXInXQoKICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Cj0LTQsNC70LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX2RlbGV0ZScsCiAgICAgICAgICAgICAgICB0aXRsZT0n0KPQtNCw0LvQuNGC0Ywg0LTQvtC60YPQvNC10L3RgiDRgSDRg9GB0YLRgNC+0LnRgdGC0LLQsD8nCiAgICAgICAgICAgICkKICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScsCiAgICAgICAgICAgICAgICB0aXRsZT0n0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGC0L/RgNCw0LLQuNGC0Ywg0L/QvtCy0YLQvtGA0L3Qvic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coCiAgICAgICAgICAgICAgICBsaXN0ZW5lcj0nY29uZmlybV9yZXNlbmRfZG9jJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGC0L/RgNCw0LLQuNGC0Ywg0LTQvtC60YPQvNC10L3RgiDQv9C+0LLRgtC+0YDQvdC+PycKICAgICAgICAgICAgKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/Qu9C40YLQutC4JykKCiAgICBkZWYgX2RvY19zdGF0dXNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZG9jX3N0YXR1cyddID0gc2VsZi5oYXNoX21hcFsiZG9jX3N0YXR1c19jbGljayJdCiAgICAgICAgc2VsZi5jdXJyZW50X3N0YXR1cyA9IHNlbGYuaGFzaF9tYXBbImRvY19zdGF0dXNfY2xpY2siXQoKICAgIGRlZiBfcmVzZW5kX2RvYyhzZWxmKToKICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RlYnVnX2lkX2RvYyddID0gaWRfZG9jCiAgICAgICAgZG9jX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZF9ieV9kb2NfaWQoaWRfZG9jKQoKICAgICAgICBpZiBkb2NfZGF0YToKICAgICAgICAgICAgaHR0cF9zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKGh0dHBfcGFyYW1zPXNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zd2VyID0gaHR0cF9zZXJ2aWNlLnNlbmRfZGF0YShkb2NfZGF0YSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhmJ9Ce0YjQuNCx0LrQsCDQstGL0LPRgNGD0LfQutC4INC00L7QutGD0LzQtdC90YLQsDoge2V9JykKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhmJ9Ce0YjQuNCx0LrQsCDQstGL0LPRgNGD0LfQutC4INC00L7QutGD0LzQtdC90YLQsDoge2Fuc3dlci5lcnJvcl90ZXh0fScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZXModmVyaWZpZWQ9MSwgc2VudD0xKQogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDQvtGC0L/RgNCw0LLQu9C10L0g0L/QvtCy0YLQvtGA0L3QvicpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L7RgtC/0YDQsNCy0LrQuCcpCiAgICAgICAgICAgIHJldHVybgoKICAgIGRlZiBfZ2V0X2RvY19saXN0X2RhdGEoc2VsZiwgZG9jX3R5cGUsIGRvY19zdGF0dXMpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZpZXdfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKICAgICAgICByZXR1cm4gcmVzdWx0cwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGxpc3RfZGF0YSk6CiAgICAgICAgdGFibGVfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBsaXN0X2RhdGE6CiAgICAgICAgICAgIGRvY19zdGF0dXMgPSAnJwoKICAgICAgICAgICAgaWYgcmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0JLRi9Cz0YDRg9C20LXQvScKICAgICAgICAgICAgZWxpZiByZWNvcmRbJ3ZlcmlmaWVkJ106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQs9GA0YPQt9C60LUnCiAgICAgICAgICAgIGVsaWYgbm90IChyZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddKToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nCgogICAgICAgICAgICBkb2NfdGl0bGUgPSAne30g4oSWIHt9INC+0YIge30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10pCgogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZF9kb2MnXSwKICAgICAgICAgICAgICAgICd0eXBlJzogcmVjb3JkWydkb2NfdHlwZSddLAogICAgICAgICAgICAgICAgJ251bWJlcic6IHJlY29yZFsnZG9jX24nXSwKICAgICAgICAgICAgICAgICdkb2NfdGl0bGUnOiBkb2NfdGl0bGUsCiAgICAgICAgICAgICAgICAnZGF0YSc6IHNlbGYuX2Zvcm1hdF9kYXRlKHJlY29yZFsnZG9jX2RhdGUnXSksCiAgICAgICAgICAgICAgICAnd2FyZWhvdXNlJzogcmVjb3JkWydSU193YXJlaG91c2UnXSwKICAgICAgICAgICAgICAgICdjb3VudHJhZ2VudCc6IHJlY29yZFsnUlNfY291bnRyYWdlbnQnXSwKICAgICAgICAgICAgICAgICdhZGRfbWFya19zZWxlY3Rpb24nOiByZWNvcmRbJ2FkZF9tYXJrX3NlbGVjdGlvbiddLAogICAgICAgICAgICAgICAgJ3N0YXR1cyc6IGRvY19zdGF0dXMsCiAgICAgICAgICAgICAgICAnaXNfZ3JvdXBfc2Nhbic6IHJlY29yZFsnaXNfZ3JvdXBfc2NhbiddCiAgICAgICAgICAgIH0pCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX2NhcmRzX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSwgcG9wdXBfbWVudV9kYXRhKToKICAgICAgICB0aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgiVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfZGF0ZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCgogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzdGF0dXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdHlwZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT1wb3B1cF9tZW51X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhcmlhYmxlPSJtZW51X2RlbGV0ZSIsCiAgICAgICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAoKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG51bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY291bnRyYWdlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHdhcmVob3VzZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoc2VsZiwgcHV0X2RhdGE9Tm9uZSk6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfZGF0YSIsIGZyb21fanNvbj1UcnVlKQoKICAgICAgICBwdXRfZGF0YSA9IHB1dF9kYXRhIG9yIHt9CiAgICAgICAgcHV0X2RhdGFbJ2lkX2RvYyddID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgIHB1dF9kYXRhWydkb2NfdHlwZSddID0gY2FyZF9kYXRhWyd0eXBlJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX24nXSA9IGNhcmRfZGF0YVsnbnVtYmVyJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX2RhdGUnXSA9IGNhcmRfZGF0YVsnZGF0YSddCiAgICAgICAgcHV0X2RhdGFbJ3dhcmVob3VzZSddID0gY2FyZF9kYXRhWyd3YXJlaG91c2UnXQogICAgICAgIHB1dF9kYXRhWydjb3VudHJhZ2VudCddID0gY2FyZF9kYXRhWydjb3VudHJhZ2VudCddCgogICAgICAgIHJldHVybiBwdXRfZGF0YQoKICAgIGRlZiBfc2V0X2RvY192ZXJpZmllZChzZWxmLCBpZF9kb2MsIHZhbHVlPVRydWUpOgogICAgICAgICMgc2VydmljZSA9IERvY1NlcnZpY2UoaWRfZG9jKQogICAgICAgIHZhbHVlID0gc3RyKGludCh2YWx1ZSkpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2NfdmFsdWUoJ3ZlcmlmaWVkJywgdmFsdWUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhlLmFyZ3NbMF0pCgogICAgZGVmIGRvY19kZWxldGUoc2VsZiwgaWRfZG9jKToKCiAgICAgICAgcmVzdWx0ID0gVHJ1ZQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS5kZWxldGVfZG9jKGlkX2RvYykKICAgICAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlLnJlbW92ZV9kb2NfbGluZXMoaWRfZG9jKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5lcnJvcl9sb2coZS5hcmdzWzBdKQogICAgICAgICAgICByZXN1bHQgPSBGYWxzZQoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGdldF9kb2NzX2NvdW50KHNlbGYsIGRvY190eXBlPScnKToKICAgICAgICBkb2NfdHlwZSA9ICcnIGlmIG5vdCBkb2NfdHlwZSBvciBkb2NfdHlwZSA9PSAn0JLRgdC1JyBlbHNlIGRvY190eXBlCiAgICAgICAgcmV0dXJuIHNlbGYuc2VydmljZS5nZXRfZG9jc19jb3VudChkb2NfdHlwZSkKCiAgICBkZWYgX2NsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKCiAgICBkZWYgY29uZmlybV9kZWxldGVfZG9jX2xpc3RlbmVyKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpCiAgICAgICAgaWRfZG9jID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgIGRvY190eXBlID0gc2VsZi5oYXNoX21hcFsnZG9jX3R5cGVfY2xpY2snXQoKICAgICAgICBpZiBzZWxmLmRvY19kZWxldGUoaWRfZG9jKToKICAgICAgICAgICAgZG9jc19jb3VudCA9IHNlbGYuZ2V0X2RvY3NfY291bnQoZG9jX3R5cGU9ZG9jX3R5cGUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CU0L7QutGD0LzQtdC90YIg0YPRgdC/0LXRiNC90L4g0YPQtNCw0LvRkdC9JykKICAgICAgICAgICAgaWYgZG9jc19jb3VudDoKICAgICAgICAgICAgICAgIHNlbGYub25fc3RhcnQoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/Qu9C40YLQutC4JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YPQtNCw0LvQtdC90LjRjyDQtNC+0LrRg9C80LXQvdGC0LAnKQoKICAgIGRlZiBfZm9ybWF0X2RhdGUoc2VsZiwgZGF0ZV9zdHI6IHN0cik6CiAgICAgICAgcmV0dXJuIGRhdGV0aW1lLmZyb21pc29mb3JtYXQoZGF0ZV9zdHIpLnN0cmZ0aW1lKCclbS0lZC0lWSAlSDolTTolUycpCgogICAgZGVmIGdldF9pZF9kb2Moc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikgb3Ige30KICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGEuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKICAgIGRlZiBnZXRfZG9jX251bWJlcihzZWxmKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKSBvciB7fQogICAgICAgIGRvY19udW1iZXIgPSBjYXJkX2RhdGEuZ2V0KCdudW1iZXInKQogICAgICAgIHJldHVybiBkb2NfbnVtYmVyCgoKY2xhc3MgR3JvdXBTY2FuRG9jc0xpc3RTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlLmlzX2dyb3VwX3NjYW4gPSBUcnVlCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnOycuam9pbigKICAgICAgICAgICAgWyfQo9C00LDQu9C40YLRjCcsIF0pICAjJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCcKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X21vZGUgPSAi0L7RhNGE0LvQsNC50L0iIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBlbHNlICLQvtC90LvQsNC50L0iCiAgICAgICAgICAgIHdhcm5pbmdfbXNnID0gIiDQlNC+0LrRg9C80LXQvdGCINC90LUg0LHRg9C00LXRgiDQtNC+0YHRgtGD0L/QtdC9INCyINC00YDRg9Cz0LjRhSDQv9GA0L7RhtC10YHRgdCw0YUuIgogICAgICAgICAgICBtc2cgPSAoZiLQktGLINC+0YLQutGA0YvQstCw0LXRgtC1INC00L7QutGD0LzQtdC90YIg0LPRgNGD0L/Qv9C+0LLRg9GOINC+0LHRgNCw0LHQvtGC0LrRgyDQtNC+0LrRg9C80LXQvdGC0LAgIgogICAgICAgICAgICAgICAgICAgZiLQsiB7Y3VycmVudF9tb2RlLnVwcGVyKCl9INGA0LXQttC40LzQtS4iKQogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKVsnaXNfZ3JvdXBfc2NhbiddID09ICcwJzoKICAgICAgICAgICAgICAgIG1zZyArPSB3YXJuaW5nX21zZwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZ3JvdXBfc2Nhbl9tZXNzYWdlJywgbXNnKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygn0J/QvtC00YLQstC10YDQtNC40YLQtSDQtNC10LnRgdGC0LLQuNC1JykKICAgICAgICAgICAgc2VsZWN0ZWRfY2FyZF9rZXkgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddID0gc2VsZWN0ZWRfY2FyZF9rZXkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0LTQtdC50YHRgtCy0LjQtScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpWydpc19ncm91cF9zY2FuJ10gPT0gJzAnOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnJlc2V0X2RvY190YWJsZXNfcXR0eSgpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCd2ZXJpZmllZCcsIDEpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCdpc19ncm91cF9zY2FuJywgJzEnKQoKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICAgICAgICAgIHNjcmVlbiA9IFNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgICAgICBzY3JlZW5fbmFtZT1zY3JlZW5fbmFtZSwKICAgICAgICAgICAgICAgIHByb2Nlc3M9c2VsZi5wcm9jZXNzX25hbWUsCiAgICAgICAgICAgICAgICBoYXNoX21hcD1zZWxmLmhhc2hfbWFwLAogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3M9c2VsZi5yc19zZXR0aW5ncykKCiAgICAgICAgICAgIHNjcmVlbi5zaG93KGFyZ3M9c2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoKSkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2NsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCiAgICAgICAgICAgIHNlbGYucXVldWVfc2VydmljZS5yZW1vdmVfZG9jX2xpbmVzKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQlNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwINC4INC80LDRgNC60LjRgNC+0LLQutC4INC+0YfQuNGJ0LXQvdGLJykKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoaWRfZG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J/RgNC4INC+0YfQuNGB0YLQutC1INC00LDQvdC90YvRhSDQv9C10YDQtdGB0YfQtdGC0LAg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gRmFsc2UKCgpjbGFzcyBEb2N1bWVudHNEb2NzTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZS5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCcsICfQntGC0L/RgNCw0LLQuNGC0Ywg0L/QvtCy0YLQvtGA0L3QviddKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXSA9IGlkX2RvYwogICAgICAgICAgICAjIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J10KICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRvY19pZCA9IGlkX2RvYwoKICAgICAgICAgICAgbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICAgICAgICAgIHNjcmVlbiA9IFNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgICAgICBzY3JlZW5fbmFtZT1zY3JlZW5fbmFtZSwKICAgICAgICAgICAgICAgIHByb2Nlc3M9c2VsZi5wcm9jZXNzX25hbWUsCiAgICAgICAgICAgICAgICBoYXNoX21hcD1zZWxmLmhhc2hfbWFwLAogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3M9c2VsZi5yc19zZXR0aW5ncykKCiAgICAgICAgICAgIHNjcmVlbi5zaG93KGFyZ3M9c2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoKSkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2NsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCiAgICAgICAgICAgIHNlbGYucXVldWVfc2VydmljZS5yZW1vdmVfZG9jX2xpbmVzKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQlNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwINC4INC80LDRgNC60LjRgNC+0LLQutC4INC+0YfQuNGJ0LXQvdGLJykKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoaWRfZG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J/RgNC4INC+0YfQuNGB0YLQutC1INC00LDQvdC90YvRhSDQv9C10YDQtdGB0YfQtdGC0LAg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCgogICAgZGVmIGdldF9pZF9kb2Moc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikgb3Ige30KICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGEuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKICAgIGRlZiBfZ2V0X2RvY19saXN0X2RhdGEoc2VsZiwgZG9jX3R5cGUsIGRvY19zdGF0dXMpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZpZXdfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKICAgICAgICByZXR1cm4gcmVzdWx0cwoKCmNsYXNzIERvY3NPZmZsaW5lTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCddKQoKCmNsYXNzIEZsb3dEb2NTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Ch0LHQvtGAINCo0JonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2VydmljZS5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICfQo9C00LDQu9C40YLRjDvQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgYXJncyA9IHNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwJywgYXJncykKICAgICAgICAgICAgIyBzY3JlZW46IEZsb3dEb2NEZXRhaWxzU2NyZWVuID0gRmxvd0RvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICAgICAgIyBzY3JlZW4uc2hvdyhhcmdzPWFyZ3MpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKSAgIyBmaW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdkb2NfdHlwZV9jbGljayc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICByZXMgPSBzZWxmLl9jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQktGB0LUg0YjRgtGA0LjRhdC60L7QtNGLINGD0LTQsNC70LXQvdGLINC40Lcg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cf0YDQuCDQvtGH0LjRgdGC0LrQtSDQtNCw0L3QvdGL0YUg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERvY3NMaXN0IF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gRG9jRGV0YWlscyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERvY0RldGFpbHNTY3JlZW4oU2NyZWVuKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gTm9uZQogICAgICAgIHNlbGYuaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICBzZWxmLnNlcnZpY2UgPSBEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuaXRlbXNfb25fcGFnZSA9IDIwCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQogICAgICAgIHNlbGYuZG9jX3Jvd3MgPSBOb25lCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIm5leHRfcGFnZSI6CiAgICAgICAgICAgIHNlbGYuX25leHRfcGFnZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJldmlvdXNfcGFnZSc6CiAgICAgICAgICAgIHNlbGYuX3ByZXZpb3VzX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdpdGVtc19vbl9wYWdlX2NsaWNrJzoKICAgICAgICAgICAgc2VsZi5fc2V0X2l0ZW1zX29uX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsICcxJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Jvd3NfZmlsdGVyJywgJzEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29mZic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTZWFyY2hTdHJpbmcnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIlNlYXJjaCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgJzEnKQogICAgICAgICAgICBzZWxmLl9vbl9zdGFydCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9iYXJjb2Rlcyc6CiAgICAgICAgICAgIHNlbGYuX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2V0VGl0bGUnLCBzZWxmLmhhc2hfbWFwWyJkb2NfdHlwZSJdKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgbGFzdF9zY2FubmVkX2RldGFpbHMgPSBzZWxmLl9nZXRfZG9jX2RldGFpbHNfZGF0YShsYXN0X3NjYW5uZWQ9VHJ1ZSkKICAgICAgICBsYXN0X3NjYW5uZWRfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShsYXN0X3NjYW5uZWRfZGV0YWlscykKICAgICAgICBsYXN0X3NjYW5uZWRfaXRlbSA9IGxhc3Rfc2Nhbm5lZF9kYXRhWzFdIGlmIGxlbihsYXN0X3NjYW5uZWRfZGF0YSkgPj0gMiBlbHNlIE5vbmUKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX2dldF9kb2NfZGV0YWlsc19kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIGlmIHRhYmxlX2RhdGEgYW5kIGxhc3Rfc2Nhbm5lZF9pdGVtOgogICAgICAgICAgICB0YWJsZV9kYXRhLmluc2VydCgxLCBsYXN0X3NjYW5uZWRfaXRlbSkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpID09ICcxJzoKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEucG9wKDEpCiAgICAgICAgICAgIHRhYmxlX2RhdGFbMV0gPSBsYXN0X3NjYW5uZWRfaXRlbQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtc19vbl9wYWdlX3NlbGVjdCddID0gJzIwOzQwOzYwJwogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hpZ2hsaWdodCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGlnaGxpZ2h0JywgRmFsc2UpCiAgICAgICAgICAgICMgc2VsZi5lbmFibGVfaGlnaGxpZ2h0KHRhYmxlX3ZpZXcuY3VzdG9tdGFibGUpCiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ2hpZ2hsaWdodF9zY2FubmVkX2l0ZW0nKQoKICAgICAgICBpZiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsndGFibGVfbGluZXNfcXR0eSddID0gbGVuKGRvY19kZXRhaWxzKQogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHN1bSgKICAgICAgICAgICAgICAgIFtzZWxmLl9mb3JtYXRfdG9fZmxvYXQoc3RyKGl0ZW1bJ3F0dHlfcGxhbiddKSkgZm9yIGl0ZW0gaW4gZG9jX2RldGFpbHMgaWYgaXRlbVsncXR0eV9wbGFuJ11dKSA+IDAKICAgICAgICAgICAgIyBoYXZlX3plcm9fcGxhbiA9IG5vdCBoYXZlX3F0dHlfcGxhbgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IFRydWUKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBzZWxmLl9nZXRfaGF2ZV9tYXJrX3BsYW4oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3F0dHlfcGxhbiddID0gaGF2ZV9xdHR5X3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3plcm9fcGxhbiddID0gaGF2ZV96ZXJvX3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX21hcmtfcGxhbiddID0gaGF2ZV9tYXJrX3BsYW4KCiAgICAgICAgY29udHJvbCA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZhbHVlKCdjb250cm9sJywgc2VsZi5pZF9kb2MpIG5vdCBpbiAoMCwgJzAnLCAnZmFsc2UnLCAnRmFsc2UnLCBOb25lKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NvbnRyb2wnXSA9IGNvbnRyb2wKCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICcnCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRvY19nb29kc190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQoKICAgIGRlZiBfaXRlbV9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQoKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKnNlbGYuX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlX3NjYW5uaW5nX3F1ZXVlPVRydWUpCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdoYXZlX3F0dHlfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfcXR0eV9wbGFuJyksCiAgICAgICAgICAgICdoYXZlX3plcm9fcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfemVyb19wbGFuJyksCiAgICAgICAgICAgICdoYXZlX21hcmtfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfbWFya19wbGFuJyksCiAgICAgICAgICAgICdjb250cm9sJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgfQoKICAgIGRlZiBfcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUoc2VsZiwgc2Nhbl9yZXN1bHQpOgogICAgICAgIGlmIHNjYW5fcmVzdWx0LmVycm9yID09ICd1c2Vfc2VyaWVzJzoKICAgICAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVycy5hcHBlbmQoCiAgICAgICAgICAgICAgICBsYW1iZGE6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzY2FuX3Jlc3VsdC5yb3dfa2V5KQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzY2FuX3Jlc3VsdC5kZXNjcmlwdGlvbikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIF92YXJzID0gWyd3YXJlaG91c2UnLCAnY291bnRyYWdlbnQnXQoKICAgICAgICBmb3IgdiBpbiBfdmFyczoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdhbGxvd19mYWN0X2lucHV0JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfaW5wdXQiLCAnMScgaWYgYWxsb3dfZmFjdF9pbnB1dCBlbHNlICctMScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X25vdGUiLCAnLTEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnMScpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHNlbGYuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCiAgICAgICAgZmluZGVkX2FydGljbGVzID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICBkYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGZpcnN0X2VsZW09MCBpZiBsYXN0X3NjYW5uZWQgZWxzZSBmaXJzdF9lbGVtZW50LAogICAgICAgICAgICBpdGVtc19vbl9wYWdlPTEgaWYgbGFzdF9zY2FubmVkIGVsc2Ugc2VsZi5pdGVtc19vbl9wYWdlLAogICAgICAgICAgICBhcnRpY2xlc19saXN0PWpzb24ubG9hZHMoZmluZGVkX2FydGljbGVzKSBpZiBmaW5kZWRfYXJ0aWNsZXMgZWxzZSBOb25lLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQogICAgICAgIHNlbGYuZG9jX3Jvd3MgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX3Jvd3NfY291bnQoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgYXJ0aWNsZXNfbGlzdD1qc29uLmxvYWRzKGZpbmRlZF9hcnRpY2xlcykgaWYgZmluZGVkX2FydGljbGVzIGVsc2UgTm9uZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM9cm93X2ZpbHRlcnMsCiAgICAgICAgICAgIHNlYXJjaF9zdHJpbmc9c2VhcmNoX3N0cmluZwogICAgICAgICkKCiAgICAgICAgaWYgbm90IGxhc3Rfc2Nhbm5lZDoKICAgICAgICAgICAgc2VsZi5fY2hlY2tfbmV4dF9wYWdlKGxlbihkYXRhKSkKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfbmV4dF9wYWdlKHNlbGYpOgogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkgKyBzZWxmLml0ZW1zX29uX3BhZ2UKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsIHN0cihmaXJzdF9lbGVtZW50KSkKICAgICAgICBjdXJyZW50X3BhZ2UgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpKSArIDEgb3IgMQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCBzdHIoY3VycmVudF9wYWdlKSkKCiAgICBkZWYgX3ByZXZpb3VzX3BhZ2Uoc2VsZik6CiAgICAgICAgZmlyc3RfZWxlbWVudCA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKSAtIHNlbGYuaXRlbXNfb25fcGFnZQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgc3RyKGZpcnN0X2VsZW1lbnQpKQogICAgICAgIGN1cnJlbnRfcGFnZSA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9wYWdlJykpIC0gMSBvciAxCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsIHN0cihjdXJyZW50X3BhZ2UpKQoKICAgIGRlZiBfY2hlY2tfcHJldmlvdXNfcGFnZShzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpOgogICAgICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpCiAgICAgICAgICAgIGlmIGZpcnN0X2VsZW1lbnQgPiAwOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcHJldmlvdXNfcGFnZSIsICIxIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCAnMScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcHJldmlvdXNfcGFnZSIsICIwIikKCiAgICBkZWYgX2NoZWNrX25leHRfcGFnZShzZWxmLCBlbGVtc19jb3VudCk6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCAnMCcpCiAgICAgICAgcGFnZV9lbGVtc19zdW0gPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkgKyBzZWxmLml0ZW1zX29uX3BhZ2UKICAgICAgICBpZiBwYWdlX2VsZW1zX3N1bSA8IHNlbGYuZG9jX3Jvd3M6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X25leHRfcGFnZSIsICIxIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19uZXh0X3BhZ2UiLCAiMCIpCgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdTaG93X3ByZXZpb3VzX3BhZ2UnKSA9PSAnMCcgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdTaG93X25leHRfcGFnZScpID09ICcwJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcGFnaW5hdGlvbl9jb250cm9scyIsICItMSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcGFnaW5hdGlvbl9jb250cm9scyIsICIxIikKCiAgICBkZWYgX3NldF9pdGVtc19vbl9wYWdlKHNlbGYpOgogICAgICAgIHZhbHVlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1zX29uX3BhZ2VfY2xpY2snKQogICAgICAgIHNlbGYuaXRlbXNfb25fcGFnZSA9IGludCh2YWx1ZSkKICAgICAgICBuZXdfcGFnZSA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKS8vc2VsZi5pdGVtc19vbl9wYWdlICsgMQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCBuZXdfcGFnZSkKICAgICAgICBuZXdfY3VycmVudF9maXJzdCA9IHNlbGYuaXRlbXNfb25fcGFnZSAqIChuZXdfcGFnZSAtIDEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCBzdHIobmV3X2N1cnJlbnRfZmlyc3QpKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRvY19kZXRhaWxzKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIHJvd19maWx0ZXIgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdyb3dzX2ZpbHRlcicpCgogICAgICAgIGZvciByZWNvcmQgaW4gZG9jX2RldGFpbHM6CiAgICAgICAgICAgIGlmIHJvd19maWx0ZXIgYW5kIHJlY29yZFsnZF9xdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gPT0gMCBhbmQgcmVjb3JkWydxdHR5X3BsYW4nXSA9PSAwOgogICAgICAgICAgICAgICAgcGljID0gJycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2lkJ10pLAogICAgICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHN0cihyZWNvcmRbJ2dvb2RfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF9nb29kJzogc3RyKHJlY29yZFsnaWRfZ29vZCddKSwKICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFsnaWRfc2VyaWVzJ10pLAogICAgICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFsnc2VyaWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAndW5pdHNfbmFtZSc6IHN0cihyZWNvcmRbJ3VuaXRzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnY29kZV9hcnQnOiAn0JrQvtC0OiAnICsgc3RyKHJlY29yZFsnY29kZSddKSwKICAgICAgICAgICAgICAgICdhcnQnOiBzdHIocmVjb3JkWydhcnQnXSksCiAgICAgICAgICAgICAgICAncHJpY2UnOiBzdHIocmVjb3JkWydwcmljZSddIGlmIHJlY29yZFsncHJpY2UnXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3ByaWNlX25hbWUnOiBzdHIocmVjb3JkWydwcmljZV9uYW1lJ10gb3IgJycpLAogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMsCiAgICAgICAgICAgICAgICAndXNlX3Nlcmllcyc6IHN0cihyZWNvcmRbJ3VzZV9zZXJpZXMnXSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvcHMgPSBbCiAgICAgICAgICAgICAgICAne30gJy5mb3JtYXQocHJvZHVjdF9yb3dbJ2FydCddKSBpZiBwcm9kdWN0X3Jvd1snYXJ0J10gZWxzZSAnJywKICAgICAgICAgICAgICAgICcoe30pICcuZm9ybWF0KHByb2R1Y3Rfcm93Wydwcm9wZXJ0aWVzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAne30nLmZvcm1hdChwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3Nlcmllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICcsIHt9Jy5mb3JtYXQocHJvZHVjdF9yb3dbJ3VuaXRzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3VuaXRzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICBdCiAgICAgICAgICAgIHByb2R1Y3Rfcm93Wydnb29kX2luZm8nXSA9ICcnLmpvaW4ocHJvcHMpCgogICAgICAgICAgICBmb3Iga2V5IGluIFsncXR0eScsICdkX3F0dHknLCAncXR0eV9wbGFuJ106CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuX2Zvcm1hdF90b19mbG9hdChzdHIocmVjb3JkLmdldChrZXksIDAuMCkgb3IgMC4wKSkKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93W2tleV0gPSBzdHIoaW50KHZhbHVlKSkgaWYgdmFsdWUuaXNfaW50ZWdlcigpIGVsc2UgdmFsdWUKCiAgICAgICAgICAgIHVzZV9zZXJpZXMgPSBib29sKGludChwcm9kdWN0X3Jvdy5nZXQoJ3VzZV9zZXJpZXMnLCAwKSkpCiAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkKICAgICAgICAgICAgc2VsZi5fc2V0X2JhY2tncm91bmRfcm93X2NvbG9yKHByb2R1Y3Rfcm93KQoKICAgICAgICAgICAgaWYgc2VsZi5fYWRkZWRfZ29vZHNfaGFzX2tleShwcm9kdWN0X3Jvd1sna2V5J10pOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5pbnNlcnQoMSwgcHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTMKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucyhvdmVycmlkZV9zZWFyY2g9VHJ1ZSkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYsIHVzZV9zZXJpZXM9RmFsc2UsIHVzZV9tYXJrPUZhbHNlKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUGljdHVyZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9c3RhdGljX2RhdGEuc25faWNvbl9ncmVlbiBpZiB1c2Vfc2VyaWVzIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9MTYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD0xMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUGljdHVyZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9c3RhdGljX2RhdGEubWFya19ncmVlbiBpZiB1c2VfbWFyayBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPTE2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9MTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFkZGluZyA9IDE2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGdvb2RfbmFtZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCgogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bnb29kX2luZm8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MywKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eV9wbGFuJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BkX3F0dHknLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgZGVmIF9zZXRfYmFja2dyb3VuZF9yb3dfY29sb3Ioc2VsZiwgcHJvZHVjdF9yb3cpOgogICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAnI0ZGRkZGRicKICAgICAgICBxdHR5LCBxdHR5X3BsYW4gPSBmbG9hdChwcm9kdWN0X3Jvd1snZF9xdHR5J10pLCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10pCiAgICAgICAgaWYgcXR0eV9wbGFuID4gcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkJFOUU3IgoKICAgICAgICBlbGlmIHF0dHlfcGxhbiA8IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRjlDNCIKCiAgICAgICAgcHJvZHVjdF9yb3dbJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kX2NvbG9yCgogICAgZGVmIF9hZGRlZF9nb29kc19oYXNfa2V5KHNlbGYsIGtleSk6CiAgICAgICAgYWRkZWRfZ29vZHMgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdhZGRlZF9nb29kcycpCiAgICAgICAgcmVzdWx0ID0gRmFsc2UKCiAgICAgICAgaWYgYWRkZWRfZ29vZHM6CiAgICAgICAgICAgIGFkZGVkX2dvb2RzX2RvYyA9IGFkZGVkX2dvb2RzLmdldChzZWxmLmlkX2RvYywgW10pCiAgICAgICAgICAgIHJlc3VsdCA9IHN0cihrZXkpIGluIFtzdHIoaXRlbSkgZm9yIGl0ZW0gaW4gYWRkZWRfZ29vZHNfZG9jXQogICAgICAgICAgICBzZWxmLnRvYXN0KHJlc3VsdCkKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBlbmFibGVfaGlnaGxpZ2h0KGN1c3RvbXRhYmxlKToKICAgICAgICBjdXN0b210YWJsZVsndGFibGVkYXRhJ11bMV1bJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSAnI0YwRjhGRicKCiAgICBkZWYgZGlzYWJsZV9oaWdobGlnaHQoc2VsZik6CiAgICAgICAgc2VsZi5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfZmlsbF9ub25lX3ZhbHVlcyhzZWxmLCBkYXRhLCBrZXlzLCBkZWZhdWx0PScnKToKICAgICAgICBub25lX2xpc3QgPSBbTm9uZSwgJ05vbmUnXQogICAgICAgIGZvciBrZXkgaW4ga2V5czoKICAgICAgICAgICAgZGF0YVtrZXldID0gZGVmYXVsdCBpZiBkYXRhW2tleV0gaW4gbm9uZV9saXN0IGVsc2UgZGF0YVtrZXldCgogICAgZGVmIHNjYW5fZXJyb3Jfc291bmQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3NjYW5fZXJyb3InKSBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ3NjYW5fZXJyb3InKSAhPSAiTm9uZSI6CiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdzY2FuX2Vycm9yJykgaW4gWydRdWFudGl0eVBsYW5SZWFjaGVkJywgJ0FscmVhZHlTY2FubmVkJywgJ1plcm9fcGxhbl9lcnJvciddOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3dhcm5pbmcnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX2Zvcm1hdF90b19mbG9hdChzZWxmLCB2YWx1ZTogc3RyKToKICAgICAgICByZXR1cm4gZmxvYXQodmFsdWUucmVwbGFjZSh1J1x4YTAnLCB1JycpLnJlcGxhY2UoJywnLCAnLicpIG9yICcwLjAnKQoKICAgIGRlZiBfZ2V0X2hhdmVfbWFya19wbGFuKHNlbGYpOgogICAgICAgIGNvdW50ID0gc2VsZi5zZXJ2aWNlLmdldF9jb3VudF9tYXJrX2NvZGVzKGlkX2RvYz1zZWxmLmlkX2RvYykKICAgICAgICByZXR1cm4gY291bnQgPiAwCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CgogICAgICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIFNlcmllc1NlbGVjdFNjcmVlbiwKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcz1zY3JlZW5fdmFsdWVzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoc2VsZik6CiAgICAgICAgbG95YXV0ID0gJycnewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBmbGRfYmFyY29kZSIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogImZsZF9iYXJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJFZGl0VGV4dE51bWVyaWMiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9JycnCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnLCB0aXRsZT0i0JLQstC10LTQuNGC0LUg0YjRgtGA0LjRhdC60L7QtCDRgtC+0LLQsNGA0LAiLCBkaWFsb2dfbGF5b3V0PWxveWF1dCkKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgoKY2xhc3MgR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBoYXNoX21hcFsnaWRfZG9jJ10sCiAgICAgICAgICAgICdkb2NfdHlwZSc6IGhhc2hfbWFwWydkb2NfdHlwZSddLAogICAgICAgICAgICAnZG9jX24nOiBoYXNoX21hcFsnZG9jX24nXSwKICAgICAgICAgICAgJ2RvY19kYXRlJzogaGFzaF9tYXBbJ2RvY19kYXRlJ10sCiAgICAgICAgICAgICd3YXJlaG91c2UnOiBoYXNoX21hcFsnd2FyZWhvdXNlJ10sCiAgICAgICAgICAgICdjb3VudHJhZ2VudCc6IGhhc2hfbWFwWydjb3VudHJhZ2VudCddLAogICAgICAgIH0KCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLl9vbl9zdGFydCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3N0b3BfdGltZXJfdXBkYXRlJywgJ3RydWUnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcFsnbGlzdGVuZXInXQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICAgICAgc2VsZi5fcnVuX3Byb2dyZXNzX2JhcmNvZGVfc2Nhbm5pbmcoKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnKToKICAgICAgICAgICAgc2VsZi5fcnVuX3Byb2dyZXNzX2JhcmNvZGVfc2Nhbm5pbmcoKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnUmV0cnlDb25uZWN0aW9uJyk6CiAgICAgICAgICAgIHNlbGYuX3J1bl9wcm9ncmVzc19iYXJjb2RlX3NjYW5uaW5nKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfbmVnYXRpdmUoJ1JldHJ5Q29ubmVjdGlvbicpOgogICAgICAgICAgICBzZWxmLnNldF9zY2FubmVyX2xvY2soRmFsc2UpCiAgICAgICAgZWxpZiBsaXN0ZW5lciBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdCQUNLX0JVVFRPTiddOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICdmYWxzZScpCgogICAgZGVmIF9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9wcm9ncmVzcygnZG9jX2RldGFpbHNfYmVmb3JlX3Byb2Nlc3NfYmFyY29kZScpCgogICAgZGVmIGJlZm9yZV9wcm9jZXNzX2JhcmNvZGUoc2VsZik6CiAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKFRydWUpCiAgICAgICAgaWYgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICBzZWxmLl91cGRhdGVfZG9jdW1lbnRfZGF0YSgpCiAgICAgICAgICAgIHNjYW5fcmVzdWx0ID0gc2VsZi5fYmFyY29kZV9zY2FubmVkKCkKCiAgICAgICAgICAgIGlmIHNjYW5fcmVzdWx0LmdldCgnRXJyb3InKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50KCdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygnZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0X2V4ZWN1dGVfbWV0aG9kPSdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhGYWxzZSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCc3MCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9IlJldHJ5Q29ubmVjdGlvbiIsIHRpdGxlPSfQntGC0YHRg9GC0YHRgtCy0YPQtdGCINGB0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyLQn9C+0LLRgtC+0YDQuNGC0YwiLCAi0J7RgtC80LXQvdCwIl0pCgogICAgZGVmIF91cGRhdGVfZG9jdW1lbnRfZGF0YShzZWxmKToKICAgICAgICBkb2NzX2RhdGEgPSBzZWxmLl9nZXRfdXBkYXRlX2N1cnJlbnRfZG9jX2RhdGEoKQogICAgICAgIGlmIGRvY3NfZGF0YToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kYXRhX2Zyb21fanNvbihkb2NzX2RhdGEpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS53cml0ZV9lcnJvcl9vbl9sb2coZifQntGI0LjQsdC60LAg0LfQsNC/0LjRgdC4INC00L7QutGD0LzQtdC90YLQsDogIHtlfScpCgogICAgZGVmIF9nZXRfdXBkYXRlX2N1cnJlbnRfZG9jX2RhdGEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKCiAgICAgICAgICAgIGlmIGFuc3dlci51bmF1dGhvcml6ZWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0LDQstGC0L7RgNC40LfQsNGG0LjQuCDRgdC10YDQstC10YDQsCAx0KEnKQogICAgICAgICAgICBlbGlmIGFuc3dlci5mb3JiaWRkZW46CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbihhbnN3ZXIuZXJyb3JfdGV4dCwgdGl0bGU9J9Ce0YjQuNCx0LrQsCDQvtCx0LzQtdC90LAnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChhbnN3ZXIuZXJyb3JfdGV4dCkKICAgICAgICAgICAgZWxpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtCwOiAge2Fuc3dlci5lcnJvcl90ZXh0fScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gYW5zd2VyLmRhdGEKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhGYWxzZSkKCiAgICBkZWYgcG9zdF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnYmFyY29kZV9zY2FubmVkJyk6CiAgICAgICAgICAgIGFuc3dlciA9IE5vbmUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5fcG9zdF9nb29kc190b19zZXJ2ZXIoKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICAgICAgICAgIGlmIGFuc3dlciBhbmQgYW5zd2VyLmdldCgnRXJyb3InKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGFuc3dlci5nZXQoJ0Vycm9yJykpCgogICAgICAgICAgICBzZWxmLm9uX3N0YXJ0KCkKCiAgICBkZWYgX3Bvc3RfZ29vZHNfdG9fc2VydmVyKHNlbGYpOgogICAgICAgIHJlcyA9IHNlbGYuc2VydmljZS5nZXRfbGFzdF9lZGl0ZWRfZ29vZHModG9fanNvbj1GYWxzZSkKICAgICAgICBoc19zZXJ2aWNlID0gSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKCiAgICAgICAgaWYgaXNpbnN0YW5jZShyZXMsIGRpY3QpIGFuZCByZXMuZ2V0KCdFcnJvcicpOgogICAgICAgICAgICBhbnN3ZXIgPSB7J2VtcHR5JzogVHJ1ZSwgJ0Vycm9yJzogcmVzLmdldCgnRXJyb3InKX0KICAgICAgICAgICAgcmV0dXJuIGFuc3dlcgogICAgICAgIGVsaWYgcmVzOgogICAgICAgICAgICBoc19zZXJ2aWNlLnNlbmRfZG9jdW1lbnRzKHJlcykKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgICAgICBpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGFuc3dlci5lcnJvcl90ZXh0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfc2VudF9kYXRhKHJlcykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICAgICAgIyDQv9C+0LrQsCDRh9GC0L4g0L7RgtC60LvRjtGH0LjQuyDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9C5IGdldC3Qt9Cw0L/RgNC+0YEsINC/0YDQvtCy0LXRgNGP0LXQvCDQv9GA0L7QuNC30LLQvtC00LjRgtC10LvRjNC90L7RgdGC0YwKCiAgICAgICAgIyBkb2NzX2RhdGEgPSBoc19zZXJ2aWNlLmdldF9kYXRhKCkKICAgICAgICAjCiAgICAgICAgIyBpZiBkb2NzX2RhdGEuZ2V0KCdkYXRhJyk6CiAgICAgICAgIyAgICAgdHJ5OgogICAgICAgICMgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RhdGFfZnJvbV9qc29uKGRvY3NfZGF0YVsnZGF0YSddKQogICAgICAgICMgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAjICAgICAgICAgc2VsZi5zZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhlLmFyZ3NbMF0pCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLkh0dHBBbnN3ZXIoCiAgICAgICAgICAgICAgICBlcnJvcj1UcnVlLAogICAgICAgICAgICAgICAgZXJyb3JfdGV4dD1zdHIoZS5hcmdzWzBdKSwKICAgICAgICAgICAgICAgIHN0YXR1c19jb2RlPTQwNCwKICAgICAgICAgICAgICAgIHVybD1zZWxmLmhzX3NlcnZpY2UudXJsKQoKICAgICAgICByZXR1cm4gbm90IGFuc3dlci5lcnJvcgoKICAgIGRlZiBzZXRfc2Nhbm5lcl9sb2NrKHNlbGYsIHZhbHVlOiBib29sKToKICAgICAgICBpZiAndXJvdm8nIGluIHNlbGYuaGFzaF9tYXAuZ2V0KCdERVZJQ0VfTU9ERUwnKS5sb3dlcigpOgogICAgICAgICAgICBzdUNsYXNzLnVyb3ZvX3NldF9sb2NrX3RyaWdnZXIodmFsdWUpCgogICAgZGVmIGNhbl9sYXVuY2hfdGltZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKY2xhc3MgR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyhEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkuX29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF90aW1lcl91cGRhdGUnLCAndHJ1ZScpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdzdG9wX3N5bmNfZG9jJykgYW5kIFwKICAgICAgICAgICAgICAgIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnb2ZmbGluZV9tb2RlJyk6CiAgICAgICAgICAgIHNlbGYuX3N5bmNfZG9jKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF9zeW5jX2RvYycsICd0cnVlJykKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2RlJzogbGFtYmRhOiBzZWxmLl9ncm91cF9iYXJjb2RlX3NjYW5uZWQoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykpLAogICAgICAgICAgICAnYnRuX2JhcmNvZGVzJzogbGFtYmRhOiBzZWxmLl9zaG93X2RpYWxvZ19pbnB1dF9iYXJjb2RlKCksCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLmdvX2JhY2ssCiAgICAgICAgICAgICdzeW5jX2RvYyc6IHNlbGYuX3N5bmNfZG9jLAogICAgICAgICAgICAnc2VuZF9hbGxfc2Nhbl9saW5lcyc6IHNlbGYuc2VuZF9hbGxfc2Nhbl9saW5lc19jYWxsX2hhbmRsZXIsCiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2sKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJyk6CiAgICAgICAgICAgIHNlbGYuX2dyb3VwX2JhcmNvZGVfc2Nhbm5lZChzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKSkKCiAgICBkZWYgX2dyb3VwX2JhcmNvZGVfc2Nhbm5lZChzZWxmLCBiYXJjb2RlKToKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKnNlbGYuX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlX3NjYW5uaW5nX3F1ZXVlPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfc2Nhbj1UcnVlKQogICAgICAgIHJlc3VsdCA9IHNlbGYuYmFyY29kZV93b3JrZXIucHJvY2Vzc190aGVfYmFyY29kZShiYXJjb2RlKQoKICAgICAgICBpZiByZXN1bHQuZXJyb3I6CiAgICAgICAgICAgIHNlbGYuX3Byb2Nlc3NfZXJyb3Jfc2Nhbl9iYXJjb2RlKHJlc3VsdCkKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5lcnJvcgoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnc2VuZF9kb2N1bWVudF9saW5lc19ydW5uaW5nJykgYW5kIFwKICAgICAgICAgICAgICAgIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnb2ZmbGluZV9tb2RlJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdzZW5kX3Bvc3RfbGluZXNfZGF0YScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RfZXhlY3V0ZV9tZXRob2Q9J2FmdGVyX3NlbmRfcG9zdF9saW5lc19kYXRhJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbmRfZG9jdW1lbnRfbGluZXNfcnVubmluZycsIFRydWUpCgogICAgZGVmIGdvX2JhY2soc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3N0b3Bfc3luY19kb2MnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICdmYWxzZScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0JTQvtC60YPQvNC10L3RgtGLJykKCiAgICBkZWYgc2VuZF9wb3N0X2xpbmVzX2RhdGEoc2VsZiwgc2VudD1Ob25lKToKICAgICAgICBzZW5kX2RhdGEgPSBzZWxmLnF1ZXVlX3NlcnZpY2UuZ2V0X2RvY3VtZW50X2xpbmVzKHNlbGYuaWRfZG9jLCBzZW50PXNlbnQpCiAgICAgICAgdmFsaWRhdGVkX3NlbmRfZGF0YSA9IGxpc3QoKGRpY3QoKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIGQuaXRlbXMoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGtleSBub3QgaW4gWydyb3dfa2V5JywgJ3NlbnQnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGQgaW4gc2VuZF9kYXRhKSkKICAgICAgICBpZiBub3QgdmFsaWRhdGVkX3NlbmRfZGF0YToKICAgICAgICAgICAgdmFsaWRhdGVkX3NlbmRfZGF0YSA9IFt7fV0KCiAgICAgICAgaWYgc2VudCBpcyBGYWxzZToKICAgICAgICAgICAgaHR0cF9yZXN1bHQgPSBzZWxmLmhzX3NlcnZpY2Uuc2VuZF9kb2N1bWVudF9saW5lcyhzZWxmLmlkX2RvYywgdmFsaWRhdGVkX3NlbmRfZGF0YSwgdGltZW91dD04KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGh0dHBfcmVzdWx0ID0gc2VsZi5oc19zZXJ2aWNlLnNlbmRfYWxsX2RvY3VtZW50X2xpbmVzKHNlbGYuaWRfZG9jLCB2YWxpZGF0ZWRfc2VuZF9kYXRhLCB0aW1lb3V0PTgpCgogICAgICAgIGlmIGh0dHBfcmVzdWx0LnN0YXR1c19jb2RlICE9IDIwMDoKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLmxvZ19lcnJvcigi0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINC/0YDQuCDQvtGC0L/RgNCw0LLQutC1ICIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi0LTQsNC90L3Ri9GFINCz0YDRg9C/0L/QvtCy0L7Qs9C+INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyDRgtC+0LLQsNGA0LAuIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgbm90IGh0dHBfcmVzdWx0LmRhdGEuZ2V0KCdkYXRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBmb3IgZWxlbWVudCBpbiBodHRwX3Jlc3VsdC5kYXRhWydkYXRhJ106CiAgICAgICAgICAgIHRhYmxlX2xpbmUgPSBzZWxmLmRiX3NlcnZpY2UuZ2V0X3RhYmxlX2xpbmUoJ1JTX2RvY3NfdGFibGUnLCBmaWx0ZXJzPXsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBlbGVtZW50WydpZF9kb2MnXSwKICAgICAgICAgICAgICAgICdpZF9nb29kJzogZWxlbWVudFsnaWRfZ29vZCddLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBlbGVtZW50WydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGVsZW1lbnRbJ2lkX3VuaXQnXX0pCiAgICAgICAgICAgIGlmIHRhYmxlX2xpbmU6CiAgICAgICAgICAgICAgICB0YWJsZV9saW5lWydxdHR5J10gPSBlbGVtZW50WydxdHR5J10KICAgICAgICAgICAgICAgIHRhYmxlX2xpbmVbJ3NlbnQnXSA9IDEKICAgICAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5yZXBsYWNlX29yX2NyZWF0ZV90YWJsZSgnUlNfZG9jc190YWJsZScsIHRhYmxlX2xpbmUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuZXdfdGFibGVfbGluZSA9IHNlbGYuY3JlYXRlX25ld190YWJsZV9saW5lKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUoJ1JTX2RvY3NfdGFibGUnLCBuZXdfdGFibGVfbGluZSkKCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlLnVwZGF0ZV9zZW50X2xpbmVzKHNlbmRfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VuZF9kb2N1bWVudF9saW5lc19ydW5uaW5nJywgRmFsc2UpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgc2VsZi5vbl9zdGFydCgpCgogICAgZGVmIGFmdGVyX3NlbmRfZGF0YShzZWxmKToKICAgICAgICBpZiBzZWxmLnF1ZXVlX3NlcnZpY2UuaGFzX3Vuc2VudF9saW5lcyhzZWxmLmlkX2RvYykgYW5kIHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3NlbmRfcG9zdF9saW5lc19kYXRhJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdF9leGVjdXRlX21ldGhvZD0nYWZ0ZXJfc2VuZF9wb3N0X2xpbmVzX2RhdGEnKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBjcmVhdGVfbmV3X3RhYmxlX2xpbmUoZWxlbWVudCk6CiAgICAgICAgbmV3X3RhYmxlX2xpbmUgPSBlbGVtZW50CiAgICAgICAgZGVsIG5ld190YWJsZV9saW5lWyd0YWJsZV90eXBlJ10KICAgICAgICBuZXdfdGFibGVfbGluZS51cGRhdGUoeydkX3F0dHknOiBuZXdfdGFibGVfbGluZVsncXR0eSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6ICcnLCAnaWRfcHJpY2UnOiAnJywgJ3NlbnQnOiAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3F0dHlfcGxhbic6IE5vbmV9KQogICAgICAgIHJldHVybiBuZXdfdGFibGVfbGluZQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoc2VsZik6CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgJ2hhdmVfcXR0eV9wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV9xdHR5X3BsYW4nKSwKICAgICAgICAgICAgJ2hhdmVfemVyb19wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV96ZXJvX3BsYW4nKSwKICAgICAgICAgICAgJ2hhdmVfbWFya19wbGFuJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnaGF2ZV9tYXJrX3BsYW4nKSwKICAgICAgICAgICAgJ2NvbnRyb2wnOiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJykKICAgICAgICB9CgogICAgZGVmIF9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShzZWxmLCBzY2FuX3Jlc3VsdCk6CiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzY2FuX3Jlc3VsdC5kZXNjcmlwdGlvbikKICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9NAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpNCw0LrRgiDRg9GB0YLRgNC+0LnRgdGC0LLQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0J7QsdGJ0LjQuSDRhNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTQsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MiwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZF9xdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0yLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS5jb21tdW5pY2F0aW9uX3Rlc3QodGltZW91dD0xKQogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5IdHRwQW5zd2VyKAogICAgICAgICAgICAgICAgZXJyb3I9VHJ1ZSwKICAgICAgICAgICAgICAgIGVycm9yX3RleHQ9c3RyKGUuYXJnc1swXSksCiAgICAgICAgICAgICAgICBzdGF0dXNfY29kZT00MDQsCiAgICAgICAgICAgICAgICB1cmw9c2VsZi5oc19zZXJ2aWNlLnVybCkKCiAgICAgICAgcmV0dXJuIG5vdCBhbnN3ZXIuZXJyb3IKCiAgICBkZWYgX3N5bmNfZG9jKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfcHJvZ3Jlc3MoJ3NlbmRfcG9zdF9saW5lc19kYXRhJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC10YIg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCAx0KEnKQoKICAgIGRlZiBzZW5kX2FsbF9zY2FuX2xpbmVzX2NhbGxfaGFuZGxlcihzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X3Byb2dyZXNzKCdzZW5kX2FsbF9zY2FuX2xpbmVzJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC10YIg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCAx0KEnKQoKICAgIGRlZiBzZW5kX2FsbF9zY2FuX2xpbmVzX3J1bihzZWxmKToKICAgICAgICBzZWxmLnNlbmRfcG9zdF9saW5lc19kYXRhKCkKCiAgICBkZWYgc2VuZF91bnNlbnRfbGluZXNfcnVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VuZF9wb3N0X2xpbmVzX2RhdGEoc2VudD1GYWxzZSkKCiAgICBkZWYgX2NhcmRzX2NsaWNrKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAKCiAgICAgICAgY3VycmVudF9lbGVtID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJykpCiAgICAgICAgIyDQv9GA0Lgg0LrQu9C40LrQtSDQv9C+INGI0LDQv9C60LUg0YLQsNCx0LvQuNGG0Ysg0L/RgNC40LvQtdGC0LDQtdGCINC/0YPRgdGC0L7QuSDRgdC70L7QstCw0YDRjAogICAgICAgIGlmIG5vdCBjdXJyZW50X2VsZW06CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjdXJyZW50X3N0ciA9IHNlbGYuaGFzaF9tYXBbInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iXQogICAgICAgIHRhYmxlX2xpbmVzX3F0dHkgPSBzZWxmLmhhc2hfbWFwWyd0YWJsZV9saW5lc19xdHR5J10KICAgICAgICB0aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10pCiAgICAgICAgcHV0X2RhdGFfZGljdCA9IHsKICAgICAgICAgICAgJ0RvY19kYXRhJzogdGl0bGUsCiAgICAgICAgICAgICdHb29kJzogY3VycmVudF9lbGVtWydnb29kX25hbWUnXSwKICAgICAgICAgICAgJ2lkX2dvb2QnOiBjdXJyZW50X2VsZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBjdXJyZW50X2VsZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogY3VycmVudF9lbGVtWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICdnb29kX2FydCc6IGN1cnJlbnRfZWxlbVsnYXJ0J10sCiAgICAgICAgICAgICdnb29kX3NuJzogY3VycmVudF9lbGVtWydzZXJpZXNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9wcm9wZXJ0eSc6IGN1cnJlbnRfZWxlbVsncHJvcGVydGllc19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3ByaWNlJzogY3VycmVudF9lbGVtWydwcmljZSddLAogICAgICAgICAgICAnZ29vZF91bml0JzogY3VycmVudF9lbGVtWyd1bml0c19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3N0cic6IGYne2N1cnJlbnRfc3RyfSAvIHt0YWJsZV9saW5lc19xdHR5fScsCiAgICAgICAgICAgICdxdHR5X3BsYW4nOiBjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddLAogICAgICAgICAgICAnZ29vZF9wbGFuJzogY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2tleSc6IGN1cnJlbnRfZWxlbVsna2V5J10sCiAgICAgICAgICAgICdwcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSwKICAgICAgICAgICAgJ3ByaWNlX3R5cGUnOiBjdXJyZW50X2VsZW1bJ3ByaWNlX25hbWUnXSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoY3VycmVudF9lbGVtWydkX3F0dHknXSksCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IEdyb3VwU2Nhbkl0ZW1TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4uc2hvdyhhcmdzPXB1dF9kYXRhX2RpY3QpCgoKY2xhc3MgRG9jdW1lbnRzRG9jRGV0YWlsU2NyZWVuKERvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLl9vbl9zdGFydCgpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcFsnbGlzdGVuZXInXQogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGVjdGVkX2NhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgICAgIGlmIG5vdCBzZWxlY3RlZF9jYXJkX2RhdGE6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgKHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgICAgICAgICAgYW5kIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpKToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZG9jX3RhYmxlX3JvdygKICAgICAgICAgICAgICAgICAgICBkYXRhPXsnc2VudCc6IDAsICdkX3F0dHknOiBmbG9hdChzZWxlY3RlZF9jYXJkX2RhdGFbJ2RfcXR0eSddKSArIDEuMH0sCiAgICAgICAgICAgICAgICAgICAgcm93X2lkPWludChzZWxlY3RlZF9jYXJkX2RhdGFbJ2tleSddKSkKICAgICAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KAogICAgICAgICAgICAgICAgICAgIGYn0JDRgNGC0LjQutGD0Ls6IHtzZWxlY3RlZF9jYXJkX2RhdGFbImFydCJdfVxuJwogICAgICAgICAgICAgICAgICAgIGYne3NlbGVjdGVkX2NhcmRfZGF0YVsiZ29vZF9uYW1lIl19XG4nCiAgICAgICAgICAgICAgICAgICAgZid7c2VsZWN0ZWRfY2FyZF9kYXRhWyJwcm9wZXJ0aWVzX25hbWUiXX1cbicKICAgICAgICAgICAgICAgICAgICBmJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INGD0LLQtdC70LjRh9C10L3QviDQvdCwIDEnKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdkb2NfZ29vZHNfdGFibGUnKQogICAgICAgICAgICBpZiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gJzEnOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGVjdGVkX2NhcmRfZGF0YVsna2V5J10pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3YXNfY2xpY2tlZCcsICcxJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCi0L7QstCw0YAg0LLRi9Cx0L7RgCIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnIG9yIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnKToKICAgICAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgcmVzID0gc2VsZi5faXRlbV9iYXJjb2RlX3NjYW5uZWQoKQogICAgICAgICAgICAjIFRPRE8g0YEg0YDQtdC30YPQu9GM0YLQsNGC0L7QvCDQvtCx0YDQsNCx0L7RgtC60YMKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2dvb2RzX29jcic6CiAgICAgICAgICAgIGFydGljbGVzID0gc2VsZi5zZXJ2aWNlLmdldF9hbGxfYXJ0aWNsZXNfaW5fZG9jdW1lbnQoKQogICAgICAgICAgICBpZiBub3QgYXJ0aWNsZXM6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkiDQtNC+0LrRg9C80LXQvdGC0LUg0L7RgtGB0YLRg9GC0YHRgtCy0YPRjtGCINCw0YDRgtC40LrRg9C70YsnKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuX3NldF92aXNpb25fc2V0dGluZ3MoYXJ0aWNsZXM9YXJ0aWNsZXMpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdSdW5DVicsICfQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LInKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdBY3RpdmVDVic6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdidXR0b25fbWFuYWdlX2FydGljbGVzJyk6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmRlbGV0ZSgnYnV0dG9uX21hbmFnZV9hcnRpY2xlcycpCiAgICAgICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgIGlmIGZpbmRlZF9hcnRpY2xlcyBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JDRgNGC0LjQutGD0LvRiyDQvdC1INC90LDQudC00LXQvdGLJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsaWYgbGlzdGVuZXIgaW4gWydPTl9CQUNLX1BSRVNTRUQnLCAnQkFDS19CVVRUT04nXToKICAgICAgICAgICAgaWYgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJyk6CiAgICAgICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbXNfb25fcGFnZV9jbGljaycsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX3ZlcmlmaWVkJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5tYXJrX3ZlcmlmaWVkKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdjb25maXJtX3ZlcmlmaWVkJywgJ9CX0LDQstC10YDRiNC40YLRjCDQtNC+0LrRg9C80LXQvdGCPycsIFsn0JTQsCcsICfQndC10YInXSkKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZiwgYXJ0aWNsZXM6IExpc3Rbc3RyXSk6CiAgICAgICAgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICJ2YWx1ZXNfbGlzdCI6ICc7Jy5qb2luKGFydGljbGVzKSwKICAgICAgICAgICAgIm1pbl9sZW5ndGgiOiBsZW4obWluKGFydGljbGVzLCBrZXk9bGVuKSksCiAgICAgICAgICAgICJtYXhfbGVuZ3RoIjogbGVuKG1heChhcnRpY2xlcywga2V5PWxlbikpLAogICAgICAgIH0KICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wucHV0KCdhcnRpY2xlc19vY3Jfc2V0dGluZ3MnLCBqc29uLmR1bXBzKHNldHRpbmdzKSwgVHJ1ZSkKCiAgICBkZWYgX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLCBkb2Nfcm93X2tleSk6CiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2RvY19yb3dfaWQnOiBkb2Nfcm93X2tleSwKICAgICAgICAgICAgJ3RpdGxlJzogJ9Ch0LXRgNC40LgnLAogICAgICAgICAgICAndXNlX2Fkcl9kb2NzX3RhYmxlcyc6ICcwJwogICAgICAgIH0KCiAgICAgICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgU2VyaWVzU2VsZWN0U2NyZWVuLAogICAgICAgICAgICBzY3JlZW5fdmFsdWVzPXNjcmVlbl92YWx1ZXMKICAgICAgICApCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoc2VsZik6CiAgICAgICAgZmluZGVkX2FydGljbGVzID0gJy0xJyBpZiBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKSBlbHNlICcxJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2J0bl9kb2NfbWFya192ZXJpZmllZCcsIGZpbmRlZF9hcnRpY2xlcykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd19kb2NfZGF0ZScsIGZpbmRlZF9hcnRpY2xlcykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd193YXJlaG91c2UnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfY291bnRyYWdlbnQnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfZmluZGVkX2J5X2FydGljbGUnLCBzdHIoLWludChmaW5kZWRfYXJ0aWNsZXMpKSkKCgpjbGFzcyBGbG93RG9jRGV0YWlsc1NjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQodCx0L7RgCDQqNCaJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkZsb3dEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLnNjcmVlbl9uYW1lLCBhcmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl9iYXJjb2RlX2Zsb3dfb25fc3RhcnQoKQogICAgICAgIHNlbGYuX3NldF92aXNpb25fc2V0dGluZ3MoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X3N0ciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICAgICAgamxpc3QgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCJkb2NfYmFyY19mbG93IikpCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgICAgICBkYXRhID0geydiYXJjb2RlJzogY3VycmVudF9lbGVtWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6IGN1cnJlbnRfZWxlbVsnbmFtZSddLAogICAgICAgICAgICAgICAgICAgICdxdHR5JzogY3VycmVudF9lbGVtWydxdHR5J10sICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJzogJyd9CgogICAgICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYmFyY29kZXMnOgogICAgICAgICAgICBzZWxmLl9zaG93X2RpYWxvZ19pbnB1dF9iYXJjb2RlKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2UoYmFyY29kZSkKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmlkX2RvYykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9iYXJjX2Zsb3dfc3RhdHVzKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJyk6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2UoYmFyY29kZSkKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmlkX2RvYykKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fdmVyaWZpZWQnKToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLm1hcmtfdmVyaWZpZWQoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdjb25maXJtX3ZlcmlmaWVkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JfQsNCy0LXRgNGI0LjRgtGMINC00L7QutGD0LzQtdC90YI/JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbJ9CU0LAnLCAn0J3QtdGCJ10pCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbl9jYW5jZWwnOgogICAgICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWxfY291bnRlci5kZXN0cm95KCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndmlzaW9uJzoKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ9Cf0LXRh9Cw0YLRjNCf0YDQtdCy0YzRjic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdSZWZyZXNoU2NyZWVuJywgJycpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9vY3Jfc2VyaWFsX3RlbXBsYXRlX3NldHRpbmdzJzoKICAgICAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ09jclRleHRSZWNvZ25pdGlvbicsICdTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncycpCgogICAgZGVmIF9iYXJjb2RlX2Zsb3dfb25fc3RhcnQoc2VsZik6CgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGZhbHNlVmFsdWVMaXN0ID0gKDAsICcwJywgJ2ZhbHNlJywgJ0ZhbHNlJywgTm9uZSkKICAgICAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgtCw0LHQu9C40YbRgyDQutCw0YDRgtC+0YfQtdC6INC4INC30LDQv9GA0L7RgSDQuiDQsdCw0LfQtQoKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuc2VydmljZS5nZXRfZmxvd190YWJsZV9kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBpZiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgIyBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKCiAgICAgICAgICAgICMg0J/RgNC40LfQvdCw0LosIGhhdmVfcXR0eV9wbGFuINCV0YHRgtGM0J/Qu9Cw0L3Qn9Ce0JrQntC70LjRh9C10YHRgtCy0YMgIC0gINCY0YHRgtC40L3QsCDQutC+0LPQtNCwINGB0YPQvNC80LAg0LrQvtC70L7QvdC60LggUXR0eV9wbGFuID4gMAogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6ICBoYXZlX21hcmtfcGxhbiAi0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDigJMg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNC+0Log0YLQsNCx0LsuIFJTX2RvY3NfYmFyY29kZXMg0YEg0LfQsNC00LDQvdC90YvQvCBpZF9kb2Mg0LggaXNfcGxhbiAg0LHQvtC70YzRiNC1INC90YPQu9GPLgogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6IGhhdmVfemVyb19wbGFuICLQldGB0YLRjCDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSIg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC10YHRgtGMINC30LDQv9C+0LvQvdC10L3QvdGL0LUg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQvtCyINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6ICLQmtC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMIiAgLSDQv9GA0LjQt9C90LDQuiDQtNC70Y8g0LTQvtC60YPQvNC10L3RgtCwLCDQvdCw0LTQviDQu9C4INC60L7QvdGC0YDQvtC70LjRgNC+0LLQsNGC0YwKCiAgICAgICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIsCiAgICAgICAgICAgICAgICBzdW0oaWZudWxsKHF0dHlfcGxhbiwwKSkgYXMgcXR0eV9wbGFuCiAgICAgICAgICAgICAgICBmcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jID0gOmlkX2RvYycnJwogICAgICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgeydpZF9kb2MnOiBpZF9kb2N9KQogICAgICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSByZXNbMF1bMF0gPiAwICAjINCSINC00L7QutGD0LzQtdC90YLQtSDQtdGB0YLRjCDRgdGC0YDQvtC60LgKICAgICAgICAgICAgICAgIGlmIGhhdmVfemVyb19wbGFuOgogICAgICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gcmVzWzBdWzFdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0LrQvtC70LLQviDQv9C70LDQvQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgICAgICMg0JXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0L/QviDQutC+0LTQsNC8INC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIKICAgICAgICAgICAgICAgIGZyb20gUlNfZG9jc19iYXJjb2RlcyBXaGVyZSBpZF9kb2MgPSA6aWRfZG9jIEFORCBpc19wbGFuID0gOmlzX3BsYW4nJycKICAgICAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jLCAnaXNfcGxhbic6ICcxJ30pCiAgICAgICAgICAgIGlmIG5vdCByZXM6CiAgICAgICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSByZXNbMF1bMF0gPiAwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hhdmVfcXR0eV9wbGFuJywgc3RyKGhhdmVfcXR0eV9wbGFuKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGF2ZV96ZXJvX3BsYW4nLCBzdHIoaGF2ZV96ZXJvX3BsYW4pKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdoYXZlX21hcmtfcGxhbicsIHN0cihoYXZlX21hcmtfcGxhbikpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ1NFTEVDVCBjb250cm9sIGZyb20gUlNfZG9jcyAgV0hFUkUgaWRfZG9jID0gPycsIChpZF9kb2MsKSkKICAgICAgICAjINCV0YHRgtGMINC70Lgg0LrQvtC90YLRgNC+0LvRjCDQv9C70LDQvdCwINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgaWYgcmVzWzBdWzBdOgogICAgICAgICAgICAgICAgaWYgcmVzWzBdWzBdIGluIGZhbHNlVmFsdWVMaXN0OgogICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnVHJ1ZScKCiAgICAgICAgICAgICAgICAjIGNvbnRyb2wgPSByZXNbMF1bMF0gIydUcnVlJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY29udHJvbCcsIGNvbnRyb2wpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRvY19iYXJjX2Zsb3ciLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKCiAgICAgICAgaWYgVHJ1ZSBpbiAoaGF2ZV9xdHR5X3BsYW4sIGhhdmVfemVyb19wbGFuLCBoYXZlX21hcmtfcGxhbiwgY29udHJvbCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICfQlNCw0L3QvdGL0Lkg0LTQvtC60YPQvNC10L3RgiDRgdC+0LTQtdGA0LbQuNGCINC/0LvQsNC90L7QstGL0LUg0YHRgtGA0L7QutC4LiDQodC/0LjRgdC+0Log0YjRgtGA0LjRhdC60L7QtNC+0LIg0LIg0L3QtdCz0L4g0L/QvtC80LXRgdGC0LjRgtGMINC90LXQu9GM0LfRjycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoc2VsZik6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGJhcmNvZGUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0zLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRvY19kZXRhaWxzKToKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgICAgICBiYXJjb2RlID0gc3RyKHNlbGYuaGFzaF9tYXAuZ2V0KCdmbGRfYmFyY29kZScpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzdHIoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykpCgogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIGRvY19kZXRhaWxzID0gc2VsZi5fc29ydF90YWJsZV9ieV9iYXJjb2RlKGRvY19kZXRhaWxzLCBiYXJjb2RlKQoKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgICMgc2VsZi5oYXNoX21hcC50b2FzdChzZWxmLmhhc2hfbWFwLmdldCgnYWRkZWRfZ29vZHMnKSkKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0geydrZXknOiBzdHIocmVjb3JkWydiYXJjb2RlJ10pLCAnYmFyY29kZSc6IHN0cihyZWNvcmRbJ2JhcmNvZGUnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICduYW1lJzogcmVjb3JkWyduYW1lJ10gaWYgcmVjb3JkWyduYW1lJ10gaXMgbm90IE5vbmUgZWxzZSAnLdC90LXRgiDQtNCw0L3QvdGL0YUtJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIocmVjb3JkWydxdHR5J10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoKX0KCiAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gJyNGRkZGRkYnIGlmIHJlY29yZFsnbmFtZSddIGlzIG5vdCBOb25lIGVsc2UgIiNGQkU5RTciCgogICAgICAgICAgICAjINGN0YLQviDQvdC1INGA0LDQsdC+0YLQsNC10YIg0YHRg9C00Y8g0L/QviDQstGB0LXQvNGDINC/0L7RgtC+0LzRgyDRh9GC0L4g0L3QtdGCINCyIGhhc2hfbWFwINC60LvRjtGH0LAgYWRkZWRfZ29vZHMKICAgICAgICAgICAgaWYgc2VsZi5fYWRkZWRfZ29vZHNfaGFzX2tleShwcm9kdWN0X3Jvd1sna2V5J10pOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5pbnNlcnQoMSwgcHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX3NvcnRfdGFibGVfYnlfYmFyY29kZShzZWxmLCB0YWJsZSwgYmFyY29kZSk6CgogICAgICAgIGZvciBpLCByb3cgaW4gZW51bWVyYXRlKHRhYmxlKToKICAgICAgICAgICAgaWYgc3RyKHJvdy5nZXQoJ2JhcmNvZGUnKSkgPT0gYmFyY29kZToKICAgICAgICAgICAgICAgIGRlbCB0YWJsZVtpXQogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KDAsIHJvdykKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIHJldHVybiB0YWJsZQoKICAgIGRlZiBfc2V0X3Zpc2lvbl9zZXR0aW5ncyhzZWxmKSAtPiBOb25lOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBvY3Jfbm9zcWwuZ2V0KCdzZXJpYWxfb2NyX3NldHRpbmdzJykKICAgICAgICBpZiBzZXJpYWxfb2NyX3NldHRpbmdzOgogICAgICAgICAgICBzZXJpYWxfb2NyX3NldHRpbmdzID0ganNvbi5sb2FkcyhzZXJpYWxfb2NyX3NldHRpbmdzKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF92aXNpb25fc2V0dGluZ3MoKipzZXJpYWxfb2NyX3NldHRpbmdzKQogICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdmcm9tX3NjcmVlbicsICdGbG93RG9jRGV0YWlsc1NjcmVlbicsIFRydWUpCgoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERvY0RldGFpbHMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kcyBzZWxlY3QgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBCYXNlR29vZFNlbGVjdChTY3JlZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCBfcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaWRfZG9jJzogJycKICAgICAgICB9CiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCiAgICAgICAgc2VsZi5jdXJyZW50X3RvYXN0X21lc3NhZ2UgPSAnJwoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmlkX2RvYyA9IHNlbGYuc2NyZWVuX3ZhbHVlc1snaWRfZG9jJ10KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgIyDQoNC10LbQuNC8INGA0LDQsdC+0YLRiyDRgSDQvNGD0LvRjNGC0LjQvNC10LTQuNCwINC4INGE0LDQudC70LDQvNC4INC/0L4g0YHRgdGL0LvQutCw0LwgKNGE0LvQsNCzIG1tX2xvY2FsKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ21tX2xvY2FsJ10gPSAnJwoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3F0dHknLCAnMCcpCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnbmV3X3F0dHknKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19xdHR5Jywgc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSkKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiYnRuX29rIjoKICAgICAgICAgICAgc2VsZi5faGFuZGxlX2J0bl9vaygpCiAgICAgICAgZWxpZiAnb3BzJyBpbiBsaXN0ZW5lcjoKICAgICAgICAgICAgIiIi0J/RgNC10YTQuNC60YEg0LrQvdC+0L/QvtC6ICsvLSwg0LfQvdCw0YfQtdC90LjQtSDQsiDQvdCw0LfQstCw0L3QuNGP0YUg0LrQvdC+0L/QvtC6IiIiCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKGludChsaXN0ZW5lcls0Ol0pKQogICAgICAgIGVsaWYgbGlzdGVuZXIgaW4gWyJidG5fY2FuY2VsIiwgJ0JBQ0tfQlVUVE9OJywgJ09OX0JBQ0tfUFJFU1NFRCddOgogICAgICAgICAgIHNlbGYuX2hhbmRsZV9idG5fb2soKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9wcmludCc6CiAgICAgICAgICAgIHNlbGYucHJpbnRfdGlja2V0KCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5fcHJvY2Vzc190aGVfYmFyY29kZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGYucHJpbnRfdGlja2V0KCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX2dvb2RfYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9kb2NfZ29vZF9iYXJjb2RlKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2VyaWVzX3Nob3cnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2lucHV0X3F0dHknOgogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgndXNlX3NlcmllcycpID09ICIxIjoKICAgICAgICAgICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLmhhc2hfbWFwWydrZXknXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX3Nob3dfZGlhbG9nX3F0dHkoKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdtb2RhbF9kaWFsb2dfaW5wdXRfcXR0eScpOgogICAgICAgICAgICBpZiBzZWxmLl92YWxpZGF0ZV9kZWx0YV9pbnB1dCgpOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKDApCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX21hcmtzX3Nob3cnOgogICAgICAgICAgICBzZWxmLl9vcGVuX21hcmtzX3NjcmVlbihzZWxmLmhhc2hfbWFwWydrZXknXSkKCiAgICBkZWYgX2hhbmRsZV9idG5fb2soc2VsZik6CiAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5fZ2V0X2N1cnJlbnRfZWxlbSgpCgogICAgICAgIG5ld19xdHR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcFsnbmV3X3F0dHknXSBvciAwKQogICAgICAgIHF0dHlfcGxhbiA9IGZsb2F0KHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5X3BsYW4nKSBvciAwKQogICAgICAgIHF0dHkgPSBmbG9hdChjdXJyZW50X2VsZW0uZ2V0KCdkX3F0dHknKSBvciAwKQoKICAgICAgICBpZiBuZXdfcXR0eSA8IDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CY0YLQvtCz0L7QstC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LzQtdC90YzRiNC1IDAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbnRyb2wgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJykKICAgICAgICBpZiBjb250cm9sIGFuZCAobWF4KG5ld19xdHR5LCBxdHR5KSA+IHF0dHlfcGxhbik6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC/0LvQsNC9INCyINC00L7QutGD0LzQtdC90YLQtSDQv9GA0LXQstGL0YjQtdC90L4nKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgcXR0eSA9IG5ld19xdHR5CgogICAgICAgIHNlbGYuX2hhbmRsZV9jaG9pY2UoY3VycmVudF9lbGVtLCBxdHR5KQoKICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCAnJykKCiAgICBkZWYgX2hhbmRsZV9jaG9pY2Uoc2VsZiwgY3VycmVudF9lbGVtLCBxdHR5KToKICAgICAgICByb3dfaWQgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkgaWYgY3VycmVudF9lbGVtIGVsc2Ugc2VsZi5zY3JlZW5fdmFsdWVzLmdldCgna2V5Jykgb3Igc2VsZi5oYXNoX21hcC5nZXQoJ2tleScpCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMCwKICAgICAgICB9CiAgICAgICAgc2VsZi5fdXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXJvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSkKICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCgogICAgZGVmIF9oYW5kbGVfZG9jX2dvb2RfYmFyY29kZShzZWxmKToKICAgICAgICBzZWxlY3RlZF9jYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCdpZF9nb29kJywgJycpLAogICAgICAgICAgICAncHJvcGVydHlfaWQnOiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCdpZF9wcm9wZXJ0aWVzJywgJycpLAogICAgICAgICAgICAndW5pdF9pZCc6IHNlbGVjdGVkX2NhcmRfZGF0YS5nZXQoJ2lkX3VuaXQnLCAnJykKICAgICAgICB9CiAgICAgICAgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93X3Byb2Nlc3NfcmVzdWx0KGluaXRfZGF0YSkKCiAgICBkZWYgX3ZhbGlkYXRlX2RlbHRhX2lucHV0KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJykpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQktCy0LXQtNC10L3QvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQvdC1INGP0LLQu9GP0LXRgtGB0Y8g0LLQsNC70LjQtNC90YvQvCDRh9C40YHQu9C+0LwnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKCiAgICBkZWYgX2ZpbGxfbm9uZV92YWx1ZXMoc2VsZiwgZGF0YSwga2V5cywgZGVmYXVsdD0nJyk6CiAgICAgICAgbm9uZV9saXN0ID0gW05vbmUsICdOb25lJ10KICAgICAgICBmb3Iga2V5IGluIGtleXM6CiAgICAgICAgICAgIGRhdGFba2V5XSA9IGRlZmF1bHQgaWYgZGF0YVtrZXldIGluIG5vbmVfbGlzdCBlbHNlIGRhdGFba2V5XQoKICAgIGRlZiBfbWF0Y2hfcmVjb3JkKHNlbGYsIHJlY29yZCwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIHJldHVybiAocmVjb3JkWydpZF9nb29kJ10gPT0gaWRfZ29vZCBhbmQKICAgICAgICAgICAgICAgIHJlY29yZFsnaWRfcHJvcGVydGllcyddID09IGlkX3Byb3BlcnR5IGFuZAogICAgICAgICAgICAgICAgcmVjb3JkWydpZF91bml0J10gPT0gaWRfdW5pdCkKCiAgICBkZWYgX2ZpbmRfbWF0Y2hpbmdfZ29vZChzZWxmLCB0YWJsZV9kYXRhLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgZm9yIGksIHJlY29yZCBpbiBlbnVtZXJhdGUodGFibGVfZGF0YVsxOl0sIHN0YXJ0PTEpOgogICAgICAgICAgICBpZiBzZWxmLl9tYXRjaF9yZWNvcmQocmVjb3JkLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgICAgICAgICByZXR1cm4gaQogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIF9oYW5kbGVfZm91bmRfYmFyY29kZShzZWxmLCByZXMsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF91bml0KToKICAgICAgICBpZF9nb29kX2JyLCBpZF9wcm9wZXJ0eV9iciwgaWRfdW5pdF9iciwgcmF0aW8gPSByZXNbJ2lkX2dvb2QnXSwgcmVzWydpZF9wcm9wZXJ0eSddLCByZXNbJ2lkX3VuaXQnXSwgaW50KHJlc1sncmF0aW8nXSkKCiAgICAgICAgaWYgaWRfZ29vZCA9PSBpZF9nb29kX2JyIGFuZCBpZF9wcm9wZXJ0eSA9PSBpZF9wcm9wZXJ0eV9iciBhbmQgaWRfdW5pdCA9PSBpZF91bml0X2JyOgogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgndXNlX3NlcmllcycpID09ICIxIjoKICAgICAgICAgICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLmhhc2hfbWFwWydrZXknXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyYXRpbykKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9nZXRfY3VycmVudF9lbGVtKHNlbGYpOgogICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgcmV0dXJuIGN1cnJlbnRfZWxlbSBvciBzZWxmLnNjcmVlbl92YWx1ZXMKCiAgICBkZWYgX3NhdmVfbmV3X2RlbHRhKHNlbGYpOgogICAgICAgIG5ld19xdHR5ID0gc2VsZi5fZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYuaGFzaF9tYXAuZ2V0KCduZXdfcXR0eScpKQoKICAgICAgICBpZiBuZXdfcXR0eSA8IDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CY0YLQvtCz0L7QstC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LzQtdC90YzRiNC1IDAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGNvbnRyb2wgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJykKICAgICAgICBpZiBjb250cm9sOgogICAgICAgICAgICBpZiBuZXdfcXR0eSA+IHNlbGYuX2dldF9mbG9hdF92YWx1ZShzZWxmLmhhc2hfbWFwLmdldCgncXR0eV9wbGFuJykpOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0g0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0YDQtdCy0YvRiNC10L3QvicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5fZ2V0X2N1cnJlbnRfZWxlbSgpCiAgICAgICAgcXR0eSA9IG5ld19xdHR5CiAgICAgICAgb2xkX3F0dHkgPSBmbG9hdChjdXJyZW50X2VsZW0uZ2V0KCdxdHR5Jykgb3IgMCkKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncGFyZW50X3NjcmVlbicpID09ICfQktGL0LHQvtGA0KLQvtCy0LDRgNCw0JDRgNGC0LjQutGD0LsnOgogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgICAgICBpZiBxdHR5ID09IHNlbGYuX2dldF9mbG9hdF92YWx1ZShzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCS0YvQsdC+0YDQotC+0LLQsNGA0LDQkNGA0YLQuNC60YPQuyIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZmluZGVkX2dvb2RzX2NhcmRzID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ZpbmRlZF9nb29kc19jYXJkcycsIGZyb21fanNvbj1UcnVlKQogICAgICAgICAgICBjYXJkc2RhdGEgPSBmaW5kZWRfZ29vZHNfY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddCgogICAgICAgICAgICBjYXJkX2RhdGEgPSBuZXh0KGVsZW0gZm9yIGVsZW0gaW4gY2FyZHNkYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZWxlbVsna2V5J10gPT0gY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAgICAgY2FyZF9kYXRhWydxdHR5J10gPSBxdHR5CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdmaW5kZWRfZ29vZHNfY2FyZHMnLCBmaW5kZWRfZ29vZHNfY2FyZHMsIHRvX2pzb249VHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JLRi9Cx0L7RgNCi0L7QstCw0YDQsNCQ0YDRgtC40LrRg9C7IikKICAgICAgICBlbGlmIHF0dHkgIT0gb2xkX3F0dHk6CiAgICAgICAgICAgIHVwZGF0ZV9kYXRhID0gewogICAgICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAgICAgJ3F0dHknOiBxdHR5LAogICAgICAgICAgICB9CiAgICAgICAgICAgIHJvd19pZCA9IGludChjdXJyZW50X2VsZW1bJ2tleSddKQogICAgICAgICAgICBzZWxmLl91cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9cm93X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBzdHIocm91bmQocXR0eSwgMykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncXR0eScsIHN0cihxdHR5KSkKCiAgICBkZWYgX2dldF9mbG9hdF92YWx1ZShzZWxmLCB2YWx1ZSk6CiAgICAgICAgaWYgdmFsdWUgYW5kIHJlLm1hdGNoKCJeXGQrXC4/XGQqJCIsIHZhbHVlKToKICAgICAgICAgICAgcmV0dXJuIGZsb2F0KHZhbHVlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAwLjAKCiAgICBkZWYgX3Byb2Nlc3NfdGhlX2JhcmNvZGUoc2VsZik6CiAgICAgICAgYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2dvb2Rfc2VsZWN0JykKICAgICAgICBhbGxvd2VkX2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpCiAgICAgICAgaWYgbm90IChiYXJjb2RlIGFuZCBhbGxvd2VkX2ZhY3RfaW5wdXQpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNGC0YDQuNGF0LrQvtC0INC90LUg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtSEnKSAjINC/0L7QutCwINGC0L7RgdGCLCDQvNC+0LTQsNC70LrQsCDQvtGH0LjRidCw0LXRgiDQtNC10LvRjNGC0YMKICAgICAgICAgICAgIyBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKGxpc3RlbmVyPSdiYXJjb2RlX25vdF9mb3VuZCcsIHRpdGxlPSfQqNGC0YDQuNGF0LrQvtC0INC90LUg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtSEnKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWRfZ29vZCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9nb29kJykKICAgICAgICBpZF9wcm9wZXJ0eSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9wcm9wZXJ0eScpIG9yICcnCiAgICAgICAgaWRfdW5pdCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF91bml0Jykgb3IgJycKCiAgICAgICAgcmVzID0gc2VsZi5zZXJ2aWNlLmdldF9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzIGFuZCBzZWxmLl9oYW5kbGVfZm91bmRfYmFyY29kZShyZXMsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF91bml0KToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHNlbGYuY3VycmVudF90b2FzdF9tZXNzYWdlIG9yIGYn0KjRgtGA0LjRhdC60L7QtCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUhJykgIyDQv9C+0LrQsCDRgtC+0YHRgiwg0LzQvtC00LDQu9C60LAg0L7Rh9C40YnQsNC10YIg0LTQtdC70YzRgtGDCiAgICAgICAgI3NlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9J2JhcmNvZGVfbm90X2ZvdW5kJywgdGl0bGU9J9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1IScpCgogICAgZGVmIF9zZXRfZGVsdGEoc2VsZiwgdmFsdWU6IGludCA9IDAsIHJlc2V0OiBib29sID0gRmFsc2UpOgogICAgICAgICIiItCh0L7Qt9C00LDQtdC8ICjQvtCx0L3Rg9C70Y/QtdC8KSDQv9C+0LvQtSDQstCy0L7QtNCwIiIiCiAgICAgICAgaWYgcmVzZXQ6CiAgICAgICAgICAgIGRlbHRhID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19xdHR5Jywgc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkZWx0YSA9IGZsb2F0KHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpIG9yIDApICsgdmFsdWUgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJykgZWxzZSB2YWx1ZQogICAgICAgICAgICBkZWx0YSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShkZWx0YSkKICAgICAgICAgICAgc2VsZi5fc2V0X3Jlc3VsdF9xdHR5KGRlbHRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGVsdGEnLCBkZWx0YSkKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBfc2V0X3Jlc3VsdF9xdHR5KHNlbGYsIGRlbHRhKToKICAgICAgICBuZXdfcXR0eSA9IGZsb2F0KHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5Jykgb3IgMCkgKyBkZWx0YQogICAgICAgIG5ld19xdHR5ID0gc3RyKHNlbGYuX2Zvcm1hdF9xdWFudGl0eShuZXdfcXR0eSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19xdHR5JywgbmV3X3F0dHkpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZGVmIHByaW50X3RpY2tldChzZWxmKToKICAgICAgICAjINCf0L7Qu9GD0YfQuNC8INC/0LXRgNCy0YvQuSDQsdCw0YDQutC+0LQg0LTQvtC60YPQvNC10L3RgtCwCgogICAgICAgIGJhcmNvZGUgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpLmdldF9iYXJjb2RlX2Zyb21fZG9jX3RhYmxlKHNlbGYuaGFzaF9tYXAuZ2V0KCdrZXknKSkKCiAgICAgICAgZGF0YSA9IHsn0JTQsNGC0LBf0LTQvtC6JzogJ0RvY19kYXRhJywgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6ICdHb29kJywKICAgICAgICAgICAgICAgICfQkNGA0YLQuNC60YPQuyc6ICdnb29kX2FydCcsICfQodC10YDQuNC50L3Ri9C5INC90L7QvNC10YAnOiAnZ29vZF9zbicsCiAgICAgICAgICAgICAgICAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6ICdnb29kX3Byb3BlcnR5JywgJ9Cm0LXQvdCwJzogJ2dvb2RfcHJpY2UnLAogICAgICAgICAgICAgICAgJ9CV0LTQmNC30LwnOiAnZ29vZF91bml0JywgJ9Ca0LvRjtGHJzogJ2tleScsICfQktCw0LvRjtGC0LAnOiAncHJpY2VfdHlwZSd9CiAgICAgICAgZm9yIGtleSBpbiBkYXRhOgogICAgICAgICAgICBkYXRhW2tleV0gPSBzZWxmLmhhc2hfbWFwLmdldChkYXRhW2tleV0pCiAgICAgICAgZGF0YVsnYmFyY29kZSddID0gYmFyY29kZSBpZiBiYXJjb2RlIGVsc2UgJzAwMDAwMDAwMDAwMDAnCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNldF9jdXJyZW50X3NjcmVlbihOb25lKQogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gU2VyaWVzU2VsZWN0U2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5zaG93X3Byb2Nlc3NfcmVzdWx0KHNjcmVlbl92YWx1ZXMpCgogICAgZGVmIF9vcGVuX21hcmtzX3NjcmVlbihzZWxmLCBkb2Nfcm93X2lkKToKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fZ2V0X21hcmtzX2RhdGEoZG9jX3Jvd19pZCkKICAgICAgICBpZiBub3QgdGFibGVfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNjcmVlbl9hcmdzID0gewogICAgICAgICAgICAndGl0bGUnOiAn0JzQsNGA0LrQuCDRgtC+0LLQsNGA0LAnLAogICAgICAgICAgICAndGFibGVfZGF0YSc6IGpzb24uZHVtcHModGFibGVfZGF0YSksCiAgICAgICAgICAgICd0YWJsZV9oZWFkZXInOiBqc29uLmR1bXBzKHsnbWFya19jb2RlJzogJ9Cc0LDRgNC60LAnfSksCiAgICAgICAgICAgICdlbnVtZXJhdGUnOiBUcnVlCiAgICAgICAgfQogICAgICAgIFNob3dJdGVtc1NjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93X3Byb2Nlc3NfcmVzdWx0KHNjcmVlbl9hcmdzKQoKICAgIGRlZiBfZ2V0X21hcmtzX2RhdGEoc2VsZiwgZG9jX3Jvd19pZCk6CiAgICAgICAgcmV0dXJuIHNlbGYuc2VydmljZS5nZXRfbWFya3NfZGF0YShzZWxmLmlkX2RvYywgZG9jX3Jvd19pZCkKCiAgICBkZWYgX3VwZGF0ZV9kb2NfdGFibGVfcm93KHNlbGYsIGRhdGE6IERpY3QsIHJvd19pZCk6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ2RfcXR0eSc6IGZsb2F0KGRhdGFbJ3F0dHknXSksCiAgICAgICAgICAgICdxdHR5JzogZmxvYXQoZGF0YVsncXR0eSddKSwKICAgICAgICB9CgogICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpKQoKICAgICAgICBpbnNlcnRfdG9fcXVldWUgPSB7CiAgICAgICAgICAgICJpZF9kb2MiOiBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJyksCiAgICAgICAgICAgICJpZF9nb29kIjogc2VsZi5oYXNoX21hcC5nZXQoImlkX2dvb2QiKSwKICAgICAgICAgICAgImlkX3Byb3BlcnRpZXMiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfcHJvcGVydHkiKSwKICAgICAgICAgICAgImlkX3NlcmllcyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9zZXJpZXMiKSwKICAgICAgICAgICAgImlkX3VuaXQiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfdW5pdCIpLAogICAgICAgICAgICAiaWRfY2VsbCI6ICIiLAogICAgICAgICAgICAiZF9xdHR5IjogZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJykpLAogICAgICAgICAgICAic2VudCI6IEZhbHNlLAogICAgICAgICAgICAicHJpY2UiOiBzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9wcmljZSIpLAogICAgICAgICAgICAiaWRfcHJpY2UiOiAiIgogICAgICAgIH0KCiAgICAgICAgYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9kb2MiKSkKICAgICAgICBiYXJjb2RlX3dvcmtlci5xdWV1ZV91cGRhdGVfZGF0YSA9IGluc2VydF90b19xdWV1ZQogICAgICAgIGJhcmNvZGVfd29ya2VyLnVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoKQoKICAgIGRlZiBfc2hvd19kaWFsb2dfcXR0eShzZWxmKToKICAgICAgICBsb3lhdXQgPSAnJyd7CiAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGRlbHRhIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiZGVsdGEiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkVkaXRUZXh0TnVtZXJpYyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0nJycKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdtb2RhbF9kaWFsb2dfaW5wdXRfcXR0eScsIHRpdGxlPSLQktCy0L7QtCDQutC+0LvQuNGH0LXRgdGC0LLQsCDRgtC+0LLQsNGA0LAiLCBkaWFsb2dfbGF5b3V0PWxveWF1dCkKCgpjbGFzcyBHb29kc1NlbGVjdFNjcmVlbihCYXNlR29vZFNlbGVjdCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGAINCy0YvQsdC+0YAnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKICAgICAgICAj0JPQvtGC0L7QstC40Lwg0LTQsNC90L3Ri9C1INC00LvRjyDQv9C10YDQstC40YfQvdC+0LPQviDQvtGC0L7QsdGA0LDQttC10L3QuNGPINC/0YDQuCDQvtGC0LrRgNGL0YLQuNC4INC/0L4g0LrQu9C40LrRgwogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd3YXNfY2xpY2tlZCcpID09ICcxJzoKICAgICAgICAgICAgZG9jX3Jvd3MgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19yb3dzX2NvdW50KHNlbGYuaWRfZG9jKVsnZG9jX3Jvd3MnXQogICAgICAgICAgICBkb2NfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLmlkX2RvYywgMCwgZG9jX3Jvd3MpCiAgICAgICAgICAgIGRvY19kYXRhLmluc2VydCgwLCB7fSkKICAgICAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJykKCiAgICAgICAgICAgICMg0YLQtdC60YPRidC40Lkg0Y3Qu9C10LzQtdC90YIg0L3QtSDQvdCw0LnQtNC10L0g0LjQu9C4INGN0YLQviDQt9Cw0LPQvtC70L7QstC+0Log0YLQsNCx0LvQuNGG0YsKICAgICAgICAgICAgaWYgY3VycmVudF9lbGVtIGlzIE5vbmUgb3IgJ2dvb2RfbmFtZScgbm90IGluIGN1cnJlbnRfZWxlbToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgc2hvd19oaWRlID0gJzEnCiAgICAgICAgICAgICMg0JLQuNC00LjQvNC+0YHRgtGMINC60L3QvtC/0L7QuiAnPCcgJz4nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX25leHRfZ29vZCddID0gc2hvd19oaWRlCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX3ByZXZpb3VzX2dvb2QnXSA9IHNob3dfaGlkZQoKICAgICAgICAgICAgZG9jX3Bvc2l0aW9uID0gc2VsZi5fZmluZF9tYXRjaGluZ19nb29kKGRvY19kYXRhLCBjdXJyZW50X2VsZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9lbGVtWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbVsnaWRfdW5pdCddKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBkb2NfZGF0YSwgdG9fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3Jvd3MnLCBkb2Nfcm93cykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScsIGN1cnJlbnRfZWxlbSwgdG9fanNvbj1UcnVlKQoKICAgICAgICAgICAgaWYgZG9jX3Bvc2l0aW9uOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfcG9zaXRpb24nLCBzdHIoZG9jX3Bvc2l0aW9uKSkKICAgICAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKCdpbmRleCcsIGluZGV4PWRvY19wb3NpdGlvbikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3dhc19jbGlja2VkJywgJy0xJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fbmV4dF9nb29kJzoKICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoIm5leHQiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9wcmV2aW91c19nb29kJzoKICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoInByZXZpb3VzIikKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIGdldF9kb2Moc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2N1cnJlbnRfZWxlbShzZWxmKToKICAgICAgICBzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJykpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IHRhYmxlX2RhdGFbc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbl0KICAgICAgICBjdXJyZW50X2VsZW1bJ2tleSddID0gY3VycmVudF9lbGVtLmdldCgnaWQnKQogICAgICAgIHJldHVybiBjdXJyZW50X2VsZW0KCiAgICBkZWYgX2dvb2RzX3NlbGVjdG9yKHNlbGYsIGFjdGlvbiwgaW5kZXggPSBOb25lKToKICAgICAgICAKICAgICAgICBnbG9iYWxfcG9zaXRpb24gPSBpbmRleCBpZiBpbmRleCBlbHNlIGludChzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQoKICAgICAgICBkb2Nfcm93cyA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnZG9jX3Jvd3MnKSkKICAgICAgICBkb2NfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQoKICAgICAgICBpZiBpbmRleCBpcyBOb25lOgogICAgICAgICAgICAjINC/0LXRgNC10LQg0L/QtdGA0LXQu9C40YHRgtGL0LLQsNC90LjQtdC8INGB0L7RhdGA0LDQvdC40Lwg0LTQtdC70YzRgtGDINC4INC+0LHQvdC+0LLQuNC8INC60L7Quy3QstC+INCyINGB0LvQvtCy0LDRgNC1CiAgICAgICAgICAgIHNlbGYuX3NhdmVfbmV3X2RlbHRhKCkKICAgICAgICAgICAgZG9jX2RhdGFbZ2xvYmFsX3Bvc2l0aW9uXVsnZF9xdHR5J10gPSBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpCiAgICAgICAgICAgIGRvY19kYXRhW2dsb2JhbF9wb3NpdGlvbl1bJ25ld19xdHR5J10gPSBzZWxmLmhhc2hfbWFwLmdldCgnbmV3X3F0dHknKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBkb2NfZGF0YSwgdG9fanNvbj1UcnVlKQoKICAgICAgICBpZiBhY3Rpb24gPT0gJ25leHQnOgogICAgICAgICAgICBwb3MgPSBnbG9iYWxfcG9zaXRpb24gKyAxIGlmIGdsb2JhbF9wb3NpdGlvbiA8IGRvY19yb3dzIGVsc2UgMQogICAgICAgIGVsaWYgYWN0aW9uID09ICdwcmV2aW91cyc6CiAgICAgICAgICAgIHBvcyA9IGdsb2JhbF9wb3NpdGlvbiAtIDEgaWYgZ2xvYmFsX3Bvc2l0aW9uID4gMSBlbHNlIGRvY19yb3dzCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gJ2luZGV4JyBhbmQgaW5kZXg6CiAgICAgICAgICAgIHBvcyA9IGluZGV4CgogICAgICAgIGN1cnJlbnRfc3RyID0gcG9zCiAgICAgICAgY3VycmVudF9lbGVtID0gZG9jX2RhdGFbcG9zXQoKICAgICAgICAjINGC0LXQutGD0YnQuNC5INGN0LvQtdC80LXQvdGCINC90LUg0L3QsNC50LTQtdC9INC40LvQuCDRjdGC0L4g0LfQsNCz0L7Qu9C+0LLQvtC6INGC0LDQsdC70LjRhtGLCiAgICAgICAgaWYgY3VycmVudF9lbGVtIGlzIE5vbmUgb3IgJ2dvb2RfbmFtZScgbm90IGluIGN1cnJlbnRfZWxlbToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRpdGxlID0gJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoc2VsZi5oYXNoX21hcFsnZG9jX3R5cGUnXSwgc2VsZi5oYXNoX21hcFsnZG9jX24nXSwgc2VsZi5oYXNoX21hcFsnZG9jX2RhdGUnXSkKCiAgICAgICAgcXR0eSA9IGN1cnJlbnRfZWxlbVsnZF9xdHR5J10KICAgICAgICBxdHR5ID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KHNlbGYuX2dldF9mbG9hdF92YWx1ZShzdHIocXR0eSkpKQogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnRG9jX2RhdGEnOiB0aXRsZSwKICAgICAgICAgICAgJ0dvb2QnOiBjdXJyZW50X2VsZW1bJ2dvb2RfbmFtZSddLAogICAgICAgICAgICAnaWRfZ29vZCc6IGN1cnJlbnRfZWxlbVsnaWRfZ29vZCddLAogICAgICAgICAgICAnaWRfdW5pdCc6IGN1cnJlbnRfZWxlbVsnaWRfdW5pdCddLAogICAgICAgICAgICAnaWRfcHJvcGVydHknOiBjdXJyZW50X2VsZW1bJ2lkX3Byb3BlcnRpZXMnXSwKICAgICAgICAgICAgJ2dvb2RfYXJ0JzogY3VycmVudF9lbGVtWydhcnQnXSwKICAgICAgICAgICAgJ2dvb2Rfc24nOiBjdXJyZW50X2VsZW1bJ3Nlcmllc19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3Byb3BlcnR5JzogY3VycmVudF9lbGVtWydwcm9wZXJ0aWVzX25hbWUnXSwKICAgICAgICAgICAgJ2dvb2RfcHJpY2UnOiBjdXJyZW50X2VsZW1bJ3ByaWNlJ10gaWYgJ3ByaWNlJyBpbiBjdXJyZW50X2VsZW0gZWxzZSAnJywKICAgICAgICAgICAgJ2dvb2RfdW5pdCc6IGN1cnJlbnRfZWxlbVsndW5pdHNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9zdHInOiBmJ3tjdXJyZW50X3N0cn0gLyB7ZG9jX3Jvd3N9JywKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddKSBpZiBjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddIGVsc2UgMCwKICAgICAgICAgICAgJ2dvb2RfcGxhbic6IGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICdrZXknOiBjdXJyZW50X2VsZW1bJ2lkJ10sCiAgICAgICAgICAgICdwcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSBpZiAncHJpY2UnIGluIGN1cnJlbnRfZWxlbSBlbHNlICcnLAogICAgICAgICAgICAncHJpY2VfdHlwZSc6IGN1cnJlbnRfZWxlbVsncHJpY2VfbmFtZSddIGlmICdwcmljZV9uYW1lJyBpbiBjdXJyZW50X2VsZW0gZWxzZSAnJywKICAgICAgICAgICAgJ3F0dHknOiBxdHR5LAogICAgICAgICAgICAnbmV3X3F0dHknOiBxdHR5LAogICAgICAgICAgICAndXNlX3Nlcmllcyc6IGN1cnJlbnRfZWxlbVsndXNlX3NlcmllcyddCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9maWxsX25vbmVfdmFsdWVzKAogICAgICAgICAgICBwdXRfZGF0YSwKICAgICAgICAgICAgKCdnb29kX2FydCcsICdnb29kX3NuJywgJ2dvb2RfcHJvcGVydHknLCAnZ29vZF9wcmljZScsICdnb29kX3BsYW4nLCAncHJpY2UnLCAncHJpY2VfdHlwZScpLAogICAgICAgICAgICBkZWZhdWx0PSfQvtGC0YHRg9GC0YHRgtCy0YPQtdGCJykKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkdvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfcG9zaXRpb24iLCBjdXJyZW50X3N0cikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQogICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQoKICAgIGRlZiBfaGFuZGxlX2ZvdW5kX2JhcmNvZGUoc2VsZiwgcmVzLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgaWRfZ29vZF9iciwgaWRfcHJvcGVydHlfYnIsIGlkX3VuaXRfYnIsIHJhdGlvID0gcmVzWydpZF9nb29kJ10sIHJlc1snaWRfcHJvcGVydHknXSwgcmVzWydpZF91bml0J10sIGludChyZXNbJ3JhdGlvJ10pCgogICAgICAgIGlmIGlkX2dvb2QgPT0gaWRfZ29vZF9iciBhbmQgaWRfcHJvcGVydHkgPT0gaWRfcHJvcGVydHlfYnIgYW5kIGlkX3VuaXQgPT0gaWRfdW5pdF9icjoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmF0aW8pCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIGlmIGlkX2dvb2QgIT0gaWRfZ29vZF9icjoKICAgICAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQogICAgICAgICAgICBtYXRjaF9pbmRleCA9IHNlbGYuX2ZpbmRfbWF0Y2hpbmdfZ29vZCh0YWJsZV9kYXRhLCBpZF9nb29kX2JyLCBpZF9wcm9wZXJ0eV9iciwgaWRfdW5pdF9icikKCiAgICAgICAgICAgIGlmIG1hdGNoX2luZGV4IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgIyDRgdC+0YXRgNCw0L3QuNC8INC00LDQvdC90YvQtSDQuCDQvtCx0L3QvtCy0LjQvCDRgdC70L7QstCw0YDRjCDQv9C10YDQtdC0INC/0LXRgNC10YXQvtC00L7QvCDQvdCwINC90L7QstGD0Y4g0L/QvtC30LjRhtC40Y4KICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfbmV3X2RlbHRhKCkKICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hfcXR0eV9pbl90YWJsZSh0YWJsZV9kYXRhKQogICAgICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoImluZGV4IiwgaW5kZXg9bWF0Y2hfaW5kZXgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgndXNlX3NlcmllcycpID09ICIxIjoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyYXRpbykKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfcmVmcmVzaF9xdHR5X2luX3RhYmxlKHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIGluZGV4ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJykpCiAgICAgICAgdGFibGVfZGF0YVtpbmRleF1bJ2RfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKQogICAgICAgIHRhYmxlX2RhdGFbaW5kZXhdWyduZXdfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ25ld19xdHR5JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCB0YWJsZV9kYXRhLCB0b19qc29uPVRydWUpCgoKY2xhc3MgR3JvdXBTY2FuSXRlbVNjcmVlbihCYXNlR29vZFNlbGVjdCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGAINCy0YvQsdC+0YAnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3N5bmNfZG9jJywgJycpCiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF91cGRhdGVfZG9jX3RhYmxlX3JvdyhzZWxmLCBkYXRhOiBEaWN0LCByb3dfaWQpOgoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAnZF9xdHR5JzogZGF0YVsncXR0eSddLAogICAgICAgIH0KICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXJvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSkKCgpjbGFzcyBCYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICdCYXJjb2RlUmVnaXN0cmF0aW9uJwogICAgcHJvY2Vzc19uYW1lID0gJ0JhcmNvZGVSZWdpc3RyYXRpb24nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gQmFyY29kZVNlcnZpY2UoKQogICAgICAgIHNlbGYuZ29vZHNfc2VydmljZSA9IEdvb2RzU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXBbJ2l0ZW1faWQnXSwKICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogc2VsZi5oYXNoX21hcFsncHJvcGVydHlfaWQnXSBvciAnJywKICAgICAgICAgICAgJ3VuaXRfaWQnOiBzZWxmLmhhc2hfbWFwWyd1bml0X2lkJ10gb3IgJycsCiAgICAgICAgfQogICAgICAgIHNlbGYudGl0bGUgPSAn0KDQtdCz0LjRgdGC0YDQsNGG0LjRjyDRiNGC0YDQuNGF0LrQvtC00LAnCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHNlbGYuZ29vZHNfc2VydmljZS5nZXRfaXRlbV9kYXRhX2J5X2NvbmRpdGlvbigqKnNlbGYuc2NyZWVuX3ZhbHVlcykKICAgICAgICBpZiBpbml0X2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NjYW5uZWRfYmFyY29kZSddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnZ29vZF9uYW1lX2JhcmNvZGUnXSA9IGluaXRfZGF0YVsnbmFtZSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdCddID0gaW5pdF9kYXRhWydwcm9wZXJ0eSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0J10gPSBpbml0X2RhdGFbJ3VuaXQnXQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsncHJvcGVydHlfc2VsZWN0X2lkJ10gPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3Byb3BlcnR5X2lkJ10KICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsndW5pdF9zZWxlY3RfaWQnXSA9IHNlbGYuc2NyZWVuX3ZhbHVlc1sndW5pdF9pZCddCgogICAgICAgICAgICBzZWxmLl9maWxsX2JhcmNvZGVzX3RhYmxlKHNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLnRpdGxlKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3QnOiBzZWxmLl9zZWxlY3RfaXRlbSwKICAgICAgICAgICAgJ3VuaXRfc2VsZWN0Jzogc2VsZi5fc2VsZWN0X2l0ZW0sCiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3Rfc3VjY2Vzcyc6IGxhbWJkYSA6IHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgncHJvcGVydHlfc2VsZWN0JyksCiAgICAgICAgICAgICd1bml0X3NlbGVjdF9zdWNjZXNzJzogbGFtYmRhIDogc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCd1bml0X3NlbGVjdCcpLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCwKICAgICAgICAgICAgJ2J0bl9vayc6IHNlbGYuX2hhbmRsZV9vaywKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2ZpbmlzaF9wcm9jZXNzLAogICAgICAgICAgICAnQkFDS19CVVRUT04nOiBzZWxmLl9maW5pc2hfcHJvY2VzcywKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9zZWxlY3RfaXRlbShzZWxmKToKICAgICAgICBpdGVtX3RhYmxlcyA9IHsKICAgICAgICAgICAgJ3Byb3BlcnR5X3NlbGVjdCc6ICdSU19wcm9wZXJ0aWVzJywKICAgICAgICAgICAgJ3VuaXRfc2VsZWN0JzogJ1JTX3VuaXRzJywKICAgICAgICB9CgogICAgICAgIGl0ZW1fdHlwZSA9IHNlbGYubGlzdGVuZXIKICAgICAgICBzY3JlZW4gPSBTZWxlY3RJdGVtU2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICB0YWJsZV9uYW1lPWl0ZW1fdGFibGVzW2l0ZW1fdHlwZV0sCiAgICAgICAgICAgIHJlc3VsdF9saXN0ZW5lcj1mJ3tpdGVtX3R5cGV9X3N1Y2Nlc3MnCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX3NlbGVjdF9pdGVtX3Jlc3VsdChzZWxmLCBmaWVsZF9uYW1lKToKICAgICAgICBzZWxlY3RlZF9jYXJkID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgaWYgc2VsZWN0ZWRfY2FyZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9IHNlbGVjdGVkX2NhcmQuZ2V0KCduYW1lJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmJ3tmaWVsZF9uYW1lfV9pZCddID0gc2VsZWN0ZWRfY2FyZC5nZXQoJ2lkJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW2ZpZWxkX25hbWVdID0gJycKCiAgICBkZWYgX2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBzY2FubmVkX2JhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgiYmFyY29kZSIpCiAgICAgICAgc2VsZi5fY2hlY2tfYmFyY29kZShzY2FubmVkX2JhcmNvZGUpCgogICAgZGVmIF9oYW5kbGVfb2soc2VsZik6CiAgICAgICAgc2Nhbm5lZF9iYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoInNjYW5uZWRfYmFyY29kZSIpCiAgICAgICAgaWYgbm90IHNjYW5uZWRfYmFyY29kZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgi0KjRgtGA0LjRhdC60L7QtCDQvdC1INC+0YLRgdC60LDQvdC40YDQvtCy0LDQvSIpCiAgICAgICAgZWxpZiBzZWxmLl9jaGVja19iYXJjb2RlKHNjYW5uZWRfYmFyY29kZSk6CiAgICAgICAgICAgIGl0ZW1faWQgPSBzZWxmLmhhc2hfbWFwLmdldCgiaXRlbV9pZCIpCiAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICJpZF9nb29kIjogaXRlbV9pZCwKICAgICAgICAgICAgICAgICJiYXJjb2RlIjogc2Nhbm5lZF9iYXJjb2RlLAogICAgICAgICAgICAgICAgImlkX3Byb3BlcnR5Ijogc2VsZi5oYXNoX21hcC5nZXQoInByb3BlcnR5X3NlbGVjdF9pZCIpIG9yICcnLAogICAgICAgICAgICAgICAgImlkX3VuaXQiOiBzZWxmLmhhc2hfbWFwLmdldCgidW5pdF9zZWxlY3RfaWQiKSBvciAnJywKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VsZi5fc2F2ZV9iYXJjb2RlKGJhcmNvZGVfZGF0YSkKICAgICAgICAgICAgc2VsZi5fZmlsbF9iYXJjb2Rlc190YWJsZShpdGVtX2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX3NhdmVfYmFyY29kZShzZWxmLCBiYXJjb2RlX2RhdGEpOgogICAgICAgIHNlbGYuc2VydmljZS5hZGRfYmFyY29kZShiYXJjb2RlX2RhdGEpCgogICAgICAgIGJ1ZmZlciA9IEV4Y2hhbmdlUXVldWVCdWZmZXIoJ2JhcmNvZGVzJykKICAgICAgICBidWZmZXIuc2F2ZV9kYXRhX3RvX3NlbmQoYmFyY29kZV9kYXRhLCBwaz0nYmFyY29kZScpCgogICAgZGVmIF9jaGVja19iYXJjb2RlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuZ29vZHNfc2VydmljZS5nZXRfdmFsdWVzX2Zyb21fYmFyY29kZSgiYmFyY29kZSIsIGJhcmNvZGUpCgogICAgICAgIGlmIGJhcmNvZGVfZGF0YToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChmJ9Co0YLRgNC40YXQutC+0LQge2JhcmNvZGV9INC/0YDQuNGB0YPRgtGB0YLQstGD0LXRgiDQsiDQsdCw0LfQtSDQtNCw0L3QvdGL0YUnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9ICcnCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NjYW5uZWRfYmFyY29kZSddID0gYmFyY29kZQoKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfZmlsbF9iYXJjb2Rlc190YWJsZShzZWxmLCBpdGVtX2lkKToKICAgICAgICAjIGJhcmNvZGVzX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2JhcmNvZGVzX2J5X2dvb2RzX2lkKHNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQogICAgICAgIGJhcmNvZGVzX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2JhcmNvZGVzX2J5X2dvb2RzX2lkKGl0ZW1faWQpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShiYXJjb2Rlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2JhcmNvZGVzX2RhdGEnXSA9IHNlbGYuX2dldF9iYXJjb2Rlc190YWJsZV92aWV3KHRhYmxlX2RhdGEpLnRvX2pzb24oKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGJhcmNvZGVzX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbXQogICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHsnX2xheW91dCc6IHNlbGYuX2dldF90YWJsZV9oZWFkZXIoKX0pICMg0YjQsNC/0LrQsAogICAgICAgIGZvciByb3cgaW4gYmFyY29kZXNfZGF0YToKICAgICAgICAgICAgIyByb3dbJ19sYXlvdXQnXSA9IHNlbGYuX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoKSDQv9GA0L7QsdC70LXQvNCwINC/0YDQvtC40LfQstC+0LTQuNGC0LXQu9GM0L3QvtGB0YLQuAogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChyb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfdGFibGVfaGVhZGVyKHNlbGYpOgogICAgICAgIHJldHVybiB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Co0YLRgNC40YXQutC+0LQnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KPQv9Cw0LrQvtCy0LrQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICkKCiAgICBkZWYgX2dldF9iYXJjb2Rlc190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAYmFyY29kZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByb3BlcnR5JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHVuaXQnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHMgc2VsZWN0IF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzKFByb2Nlc3MpID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc0xpc3RTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ci0L7QstCw0YDRiyDRgdC/0LjRgdC+0LonCiAgICBwcm9jZXNzX25hbWUgPSAn0KLQvtCy0LDRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuX2dldF9nb29kc19saXN0X2RhdGEoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2dvb2RzX3R5cGUnKSkKICAgICAgICBnb29kc19jYXJkcyA9IHNlbGYuX2dldF9nb29kc19jYXJkc192aWV3KGNhcmRzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZ29vZHNfY2FyZHMnXSA9IGdvb2RzX2NhcmRzLnRvX2pzb24oKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3JldHVybl9zZWxlY3RlZF9kYXRhJ10gPSAiIgoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7J2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddfQogICAgICAgICAgICBJdGVtQ2FyZChzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93KGFyZ3M9c2NyZWVuX3ZhbHVlcykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJzZWxlY3RfZ29vZHNfdHlwZSI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCS0YvQsdC+0YAg0LrQsNGC0LXQs9C+0YDQuNC4INGC0L7QstCw0YDQvtCyIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9pZGVudGlmeV9iYXJjb2RlX2dvb2RzKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX2dldF9nb29kc19saXN0X2RhdGEoc2VsZiwgc2VsZWN0ZWRfZ29vZF90eXBlPU5vbmUpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGVjdGVkX2dvb2RfdHlwZSkKICAgICAgICBjYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgICAgIHNpbmdsZV9jYXJkX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZCddLAogICAgICAgICAgICAgICAgJ2NvZGUnOiByZWNvcmRbJ2NvZGUnXSwKICAgICAgICAgICAgICAgICduYW1lJzogcmVjb3JkWyduYW1lJ10sCiAgICAgICAgICAgICAgICAnYXJ0JzogcmVjb3JkWydhcnQnXSBpZiByZWNvcmRbJ2FydCddIGVsc2UgIuKAlCIsCiAgICAgICAgICAgICAgICAndW5pdCc6IHJlY29yZFsndW5pdCddIGlmIHJlY29yZFsndW5pdCddIGVsc2UgIuKAlCIsCiAgICAgICAgICAgICAgICAndHlwZV9nb29kJzogcmVjb3JkWyd0eXBlX2dvb2QnXSwKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHJlY29yZFsnZGVzY3JpcHRpb24nXSBpZiByZWNvcmRbJ2Rlc2NyaXB0aW9uJ10gZWxzZSAi4oCUIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzX2RhdGEuYXBwZW5kKHNpbmdsZV9jYXJkX2RhdGEpCgogICAgICAgIHJldHVybiBjYXJkc19kYXRhCgogICAgZGVmIF9nZXRfZ29vZHNfY2FyZHNfdmlldyhzZWxmLCBjYXJkc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykKCiAgICAgICAgZ29vZHNfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzdBMDA1QycKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY29kZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGFydCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHVuaXQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B0eXBlX2dvb2QnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0ndmVydGljYWwnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiBnb29kc19jYXJkcwoKICAgIGRlZiBfaWRlbnRpZnlfYmFyY29kZV9nb29kcyhzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKQogICAgICAgICAgICB2YWx1ZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19mcm9tX2JhcmNvZGUoImJhcmNvZGUiLCBiYXJjb2RlKQogICAgICAgICAgICBpZiB2YWx1ZXM6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtX2lkJ10gPSB2YWx1ZXNbMF1bJ2lkX2dvb2QnXQogICAgICAgICAgICAgICAgSXRlbUNhcmQoc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvdygpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQotC+0LLQsNGAINC90LUg0YDQsNGB0L/QvtC30L3QsNC9INC/0L4g0YjRgtGA0LjRhdC60L7QtNGDJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgoKY2xhc3MgU2VsZWN0R29vZHNUeXBlKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQktGL0LHQvtGAINC60LDRgtC10LPQvtGA0LjQuCDRgtC+0LLQsNGA0L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQotC+0LLQsNGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgZ29vZHNfdHlwZXNfZGF0YSA9IHNlbGYuX2dldF9nb29kc190eXBlc19kYXRhKCkKICAgICAgICBnb29kc190eXBlc19jYXJkcyA9IHNlbGYuX2dldF9nb29kc190eXBlc19jYXJkc192aWV3KGdvb2RzX3R5cGVzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZ29vZHNfdHlwZXNfY2FyZHMnXSA9IGdvb2RzX3R5cGVzX2NhcmRzLnRvX2pzb24oKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3JldHVybl9zZWxlY3RlZF9kYXRhJ10gPSAiIgoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2RhdGEiLCBmcm9tX2pzb249VHJ1ZSkKICAgICAgICAgICAgdHlwZV9pZCA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICAgICAgdHlwZV9uYW1lID0gY2FyZF9kYXRhWyduYW1lJ10KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdF9nb29kc190eXBlJywgdHlwZV9uYW1lKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfZ29vZHNfdHlwZScsIHR5cGVfaWQpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YDRiyDRgdC/0LjRgdC+0LoiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RfZ29vZHNfdHlwZScsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfZ29vZHNfdHlwZScsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiQmFja1NjcmVlbiIsICIiKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9nb29kc190eXBlc19kYXRhKHNlbGYpOgogICAgICAgIGdvb2RzX3R5cGVzX2RhdGFfcmVzdWx0ID0gc2VsZi5zZXJ2aWNlLmdldF9hbGxfZ29vZHNfdHlwZXNfZGF0YSgpCiAgICAgICAgZ29vZHNfdHlwZXNfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBnb29kc190eXBlc19kYXRhX3Jlc3VsdDoKICAgICAgICAgICAgc2luZ2xlX2NhcmRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdrZXknOiByZWNvcmRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZFsnbmFtZSddLAogICAgICAgICAgICB9CiAgICAgICAgICAgIGdvb2RzX3R5cGVzX2RhdGEuYXBwZW5kKHNpbmdsZV9jYXJkX2RhdGEpCiAgICAgICAgcmV0dXJuIGdvb2RzX3R5cGVzX2RhdGEKCiAgICBkZWYgX2dldF9nb29kc190eXBlc19jYXJkc192aWV3KHNlbGYsIGdvb2RzX3R5cGVzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKCiAgICAgICAgdHlwZV9jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0ndmVydGljYWwnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWdvb2RzX3R5cGVzX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0eXBlX2NhcmRzCgoKY2xhc3MgSXRlbUNhcmQoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ca0LDRgNGC0L7Rh9C60LAg0YLQvtCy0LDRgNCwJwogICAgcHJvY2Vzc19uYW1lID0gJ9Ci0L7QstCw0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdpdGVtX2lkJzogc2VsZi5oYXNoX21hcFsnaXRlbV9pZCddLAogICAgICAgIH0KICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fcHJpbnRfdGlja2V0LAogICAgICAgICAgICAnYnRuX3ByaW50Jzogc2VsZi5fcHJpbnRfdGlja2V0LAogICAgICAgICAgICAndG9fcHJpY2VzJzogc2VsZi5fdG9fcHJpY2VzLAogICAgICAgICAgICAndG9fYmFsYW5jZXMnOiBzZWxmLl90b19iYWxhbmNlcywKICAgICAgICAgICAgJ2J0bl9pdGVtX2dvb2RfYmFyY29kZSc6IHNlbGYuX2hhbmRsZV9iYXJjb2RlX3JlZ2lzdGVyLAoKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgaXRlbV9wcm9wZXJ0aWVzID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfZnJvbV9iYXJjb2RlKCJpZF9nb29kIiwgc2VsZi5zY3JlZW5fdmFsdWVzWydpdGVtX2lkJ10pCgogICAgICAgIGlmIGl0ZW1fcHJvcGVydGllczoKICAgICAgICAgICAgdmFyaWFudHNfY2FyZHNfZGF0YSA9IHNlbGYuX2dldF92YXJpYW50c19jYXJkc19kYXRhKGl0ZW1fcHJvcGVydGllcykKICAgICAgICAgICAgdmFyaWFudHNfY2FyZHMgPSBzZWxmLl9nZXRfdmFyaWFudHNfY2FyZHNfdmlldyh2YXJpYW50c19jYXJkc19kYXRhKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydiYXJjb2RlX2NhcmRzJ10gPSB2YXJpYW50c19jYXJkcy50b19qc29uKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImxvYWRfaW5mbyIsICIiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJsb2FkX2luZm8iLCAi0JTQsNC90L3Ri9C1INC+INGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LDRhSDQvtGC0YHRg9GC0YHRgtCy0YPRjtGCIikKCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHN1cGVyKCkuaW5pdF9zY3JlZW4oKQoKICAgICAgICBpdGVtX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2l0ZW1fZGF0YV9ieV9pZChpdGVtX2lkPXNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQogICAgICAgIGlmIGl0ZW1fZGF0YToKICAgICAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgICAgICAiZ29vZF9uYW1lIjogaXRlbV9kYXRhWyduYW1lJ10sCiAgICAgICAgICAgICAgICAiZ29vZF9hcnQiOiBpdGVtX2RhdGFbJ2FydCddIGlmIGl0ZW1fZGF0YVsnYXJ0J10gZWxzZSAi4oCUIiwKICAgICAgICAgICAgICAgICJnb29kX2NvZGUiOiBpdGVtX2RhdGFbJ2NvZGUnXSwKICAgICAgICAgICAgICAgICJnb29kX2Rlc2NyIjogaXRlbV9kYXRhWydkZXNjcmlwdGlvbiddIGlmIGl0ZW1fZGF0YVsnZGVzY3JpcHRpb24nXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgImdvb2RfdHlwZSI6IGl0ZW1fZGF0YVsndHlwZV9nb29kJ10sCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuX2NsZWFyX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdiYXJjb2RlX2NhcmRzJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ3BhcmVudF9zY3JlZW4nXSkKCiAgICBkZWYgX3RvX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIGRpY3RfZGF0YSA9IHsKICAgICAgICAgICAgJ2lucHV0X2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9pZCcpLAogICAgICAgICAgICAnaXRlbV9hcnRfaW5wdXQnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9hcnQnKSwKICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZid7c2VsZi5oYXNoX21hcC5nZXQoImdvb2RfbmFtZSIpfSwge3NlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX2NvZGUiKX0nLAogICAgICAgICAgICAnb2JqZWN0X25hbWUnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9uYW1lJyksCiAgICAgICAgICAgICJyZXR1cm5fdG9faXRlbV9jYXJkIjogInRydWUiLAogICAgICAgICAgICAnU2hvd1Byb2Nlc3NSZXN1bHQnOiAn0J7RgdGC0LDRgtC60Lh80J/RgNC+0LLQtdGA0LjRgtGMINC+0YHRgtCw0YLQutC4JywKICAgICAgICAgICAgIm5vUmVmcmVzaCI6ICcnCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoZGljdF9kYXRhKQoKICAgIGRlZiBfdG9fcHJpY2VzKHNlbGYpOgogICAgICAgIGRpY3RfZGF0YSA9IHsKICAgICAgICAgICAgJ2lucHV0X2dvb2RfaWQnOiBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9pZCcpLAogICAgICAgICAgICAnaW5wdXRfZ29vZF9hcnQnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9hcnQnKSwKICAgICAgICAgICAgJ3ByaWNlc19vYmplY3RfbmFtZSc6IGYne3NlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX25hbWUiKX0sIHtzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9jb2RlIil9JywKICAgICAgICAgICAgInJldHVybl90b19pdGVtX2NhcmQiOiAidHJ1ZSIsCiAgICAgICAgICAgICdvYmplY3RfbmFtZSc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgJ1Nob3dQcm9jZXNzUmVzdWx0JzogJ9Cm0LXQvdGLfNCf0YDQvtCy0LXRgNC60LAg0YbQtdC9JywKICAgICAgICAgICAgIm5vUmVmcmVzaCI6ICcnCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoZGljdF9kYXRhKQoKICAgIGRlZiBfaGFuZGxlX2JhcmNvZGVfcmVnaXN0ZXIoc2VsZik6CiAgICAgICAgaW5pdF9kYXRhID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2lkJyksCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICcnLAogICAgICAgICAgICAndW5pdF9pZCc6ICcnCiAgICAgICAgfQogICAgICAgIEJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvd19wcm9jZXNzX3Jlc3VsdChpbml0X2RhdGEpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfdmFyaWFudHNfY2FyZHNfZGF0YShpdGVtX3Byb3BlcnRpZXMpOgogICAgICAgIHZhcmlhbnRzX2NhcmRzX2RhdGEgPSBbXQogICAgICAgIGZvciBpLCBlbGVtZW50IGluIGVudW1lcmF0ZShpdGVtX3Byb3BlcnRpZXMpOgogICAgICAgICAgICB2YXJpYW50c19jYXJkc19kYXRhLmFwcGVuZCgKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAia2V5Ijogc3RyKGkpLAogICAgICAgICAgICAgICAgICAgICJiYXJjb2RlIjogZWxlbWVudFsnYmFyY29kZSddLAogICAgICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogZWxlbWVudFsncHJvcGVydHknXSBpZiBlbGVtZW50Wydwcm9wZXJ0eSddIGVsc2UgIiIsCiAgICAgICAgICAgICAgICAgICAgInVuaXQiOiBlbGVtZW50Wyd1bml0J10sCiAgICAgICAgICAgICAgICAgICAgInNlcmllcyI6IGVsZW1lbnRbJ3NlcmllcyddCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gdmFyaWFudHNfY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X3ZhcmlhbnRzX2NhcmRzX3ZpZXcoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKSBpZiBzZWxmLnJzX3NldHRpbmdzLmdldCgKICAgICAgICAgICAgJ0NhcmRUaXRsZVRleHRTaXplJykgZWxzZSAyMAogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKSBlbHNlIDE1CgogICAgICAgIHZhcmlhbnRzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByb3BlcnRpZXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdW5pdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAYmFyY29kZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHNlcmllcycsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQogICAgICAgIHJldHVybiB2YXJpYW50c19jYXJkcwoKICAgIGRlZiBfcHJpbnRfdGlja2V0KHNlbGYpOgogICAgICAgIGN1cnJlbnRfY2FyZCA9IHNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX2RhdGEoKQoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAnYmFyY29kZSc6IGN1cnJlbnRfY2FyZC5nZXQoJ2JhcmNvZGUnLCAnMDAwMDAwMDAwMDAwMCcpLAogICAgICAgICAgICAn0J3QvtC80LXQvdC60LvQsNGC0YPRgNCwJzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfbmFtZScpLAogICAgICAgICAgICAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6IGN1cnJlbnRfY2FyZC5nZXQoJ3Byb3BlcnRpZXMnLCAnJyksCiAgICAgICAgICAgICfQo9C/0LDQutC+0LLQutCwJzogY3VycmVudF9jYXJkLmdldCgndW5pdCcsICcnKQogICAgICAgIH0KCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgZGVmIF9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKHNlbGYpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0ge30KICAgICAgICBjYXJkX2tleSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgY2FyZHMgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJiYXJjb2RlX2NhcmRzIikKCiAgICAgICAgaWYgY2FyZF9rZXkgYW5kIGNhcmRzOgogICAgICAgICAgICByZXN1bHQgPSBjYXJkc1snY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGNhcmRfa2V5KV0KCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKY2xhc3MgSXRlbUNhcmRPZmZsaW5lU2NyZWVuKEl0ZW1DYXJkKToKCiAgICBkZWYgX3RvX3ByaWNlcyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdwcmljZXNfbm90X2F2YWlsYWJsZV9tb2RhbCcsIHRpdGxlPSfQkiDRjdGC0L7QvCDQv9GA0L7QtNGD0LrRgtC1INC30LDQv9GA0L7RgSDRhtC10L0g0L3QtdC00L7RgdGC0YPQv9C10L0nKQoKICAgIGRlZiBfdG9fYmFsYW5jZXMoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnYmFsYW5jZXNfbm90X2F2YWlsYWJsZV9tb2RhbCcsIHRpdGxlPSfQkiDRjdGC0L7QvCDQv9GA0L7QtNGD0LrRgtC1INC30LDQv9GA0L7RgSDQvtGB0YLQsNGC0LrQvtCyINC90LXQtNC+0YHRgtGD0L/QtdC9JykKCiAgICBkZWYgX3ByaW50X3RpY2tldChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdwcmludF90aWNrZXRfbm90X2F2YWlsYWJsZV9tb2RhbCcsIHRpdGxlPSfQkiDRjdGC0L7QvCDQv9GA0L7QtNGD0LrRgtC1INC/0LXRh9Cw0YLRjCDQvdC10LTQvtGB0YLRg9C/0L3QsCcpCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kcyhQcm9jZXNzKSBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzQmFsYW5jZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEdvb2RzQmFsYW5jZXNJdGVtQ2FyZChTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J/RgNC+0LLQtdGA0LjRgtGMINC+0YHRgtCw0YLQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9Ce0YHRgtCw0YLQutC4JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSAnd2FyZWhvdXNlcycKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoCiAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICdlcnJvcl9tc2cnLAogICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF9jZWxsX25hbWUnLAogICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3doX25hbWUnLAogICAgICAgICAgICAgICAgJ2l0ZW1fYmFyY29kZScKICAgICAgICAgICAgXQogICAgICAgICkKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2JhbGFuY2VzX3RhYmxlJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9iYWxhbmNlc19jb250cm9scyIsICIxIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfc2hvd19maWx0ZXJzIiwgIi0xIikKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnbmV3X2FydCcpOgogICAgICAgICAgICBzZWxmLl9jaGVja19pdGVtX3ZhcmlhbnRzKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICd3aF9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3Rfd2goKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3doX3NlbGVjdF9zdWNjZXNzJzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X3doX3Jlc3VsdCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnZ2V0X2JhbGFuY2VfYnRuJzoKICAgICAgICAgICAgc2VsZi5fZ2V0X2JhbGFuY2VzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5faWRlbnRpZnlfYmFyY29kZV9iYWxhbmNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fcmVzZXRfYmFsYW5jZXNfdGFibGVzKCkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3JldHVybl90b19pdGVtX2NhcmQnKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdub1JlZnJlc2gnLCAnJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJGaW5pc2hQcm9jZXNzUmVzdWx0IiwgIiIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdzaG93X2ZpbHRlcnMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfYmFsYW5jZXNfY29udHJvbHMiLCAiMSIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICItMSIpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2RhdGEnLCBmcm9tX2pzb249VHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSgKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfb2JqZWN0X25hbWUnOiBmIntjYXJkX2RhdGFbJ25hbWUnXX0sIHtjYXJkX2RhdGFbJ2NvZGUnXX0iLAogICAgICAgICAgICAgICAgICAgICJpbnB1dF9pdGVtX2lkIjogY2FyZF9kYXRhWydpZCddLCAnaXRlbV9jb2RlJzogY2FyZF9kYXRhWydjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgJ3ZhcmlhbnRfc2VsZWN0ZWQnOiBUcnVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ25ld19hcnQnKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCfQktGL0LHQtdGA0LjRgtC1INCy0LDRgNC40LDQvdGCINGC0L7QstCw0YDQsDonKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzIiwgIjEiKQoKICAgIGRlZiBfZ2V0X2JhbGFuY2VzKHNlbGYpOgogICAgICAgIGlmIChzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9hcnRfaW5wdXQnKSAhPSBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9hcnQnKQogICAgICAgICAgICBhbmQgbm90IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3ZhcmlhbnRfc2VsZWN0ZWQnKSk6CgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X2FydCcsIFRydWUpCiAgICAgICAgICAgIHNlbGYudmFsaWRhdGVfaW5wdXQoKQoKICAgICAgICByYXdfYmFsYW5jZXNfZGF0YSA9IHNlbGYuX2dldF9iYWxhbmNlc19kYXRhKCkKICAgICAgICBiYWxhbmNlc19kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKHJhd19iYWxhbmNlc19kYXRhKQogICAgICAgIGJhbGFuY2VzX3RhYmxlID0gc2VsZi5fZ2V0X2JhbGFuY2VzX3RhYmxlX3ZpZXcoYmFsYW5jZXNfZGF0YSkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSh7CiAgICAgICAgICAgICAgICAnYmFsYW5jZXNfdGFibGUnOiBiYWxhbmNlc190YWJsZS50b19qc29uKCksCiAgICAgICAgICAgICAgICAnU2hvd19nZXRfYmFsYW5jZXNfY29udHJvbHMnOiAnLTEnLAogICAgICAgICAgICAgICAgJ1Nob3dfc2hvd19maWx0ZXJzJzogJzEnLAogICAgICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogJycsCiAgICAgICAgICAgICAgICAnZnJvbV9iYXJjb2RlJzogRmFsc2UsCiAgICAgICAgICAgICAgICAnaXRlbV9jb2RlJzogJycsCiAgICAgICAgICAgICAgICAndmFyaWFudF9zZWxlY3RlZCc6IEZhbHNlCiAgICAgICAgICAgIH0pCgogICAgZGVmIF9zZWxlY3Rfd2goc2VsZik6CiAgICAgICAgU2VsZWN0SXRlbVNjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfd2FyZWhvdXNlcycsCiAgICAgICAgICAgIHJlc3VsdF9saXN0ZW5lcj0nd2hfc2VsZWN0X3N1Y2Nlc3MnLAogICAgICAgICAgICB0aXRsZT0n0JLRi9Cx0LXRgNC40YLQtSDRgdC60LvQsNC0JwogICAgICAgICkuc2hvdygpCgogICAgZGVmIF9zZWxlY3Rfd2hfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGVjdGVkX3doID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgaWYgc2VsZWN0ZWRfd2g6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3doX3NlbGVjdCddID0gc2VsZWN0ZWRfd2guZ2V0KCduYW1lJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd3aF9zZWxlY3QnXSA9ICcnCgogICAgZGVmIHZhbGlkYXRlX2lucHV0KHNlbGYpOgogICAgICAgIHNlbGYuX3Byb2Nlc3NfaW5wdXRfaXRlbV9hcnQoKQogICAgICAgIHNlbGYuX3Byb2Nlc3NfaW5wdXRfY2VsbCgpCgogICAgICAgIGlmIG5vdCAoc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0Jykgb3Igc2VsZi5oYXNoX21hcC5nZXQoJ2NlbGxfaW5wdXQnKSBvciBzZWxmLmhhc2hfbWFwLmdldCgnd2hfc2VsZWN0JykKICAgICAgICAgICAgICAgIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jZWxsX2lkJykpOgoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSh7CiAgICAgICAgICAgICAgICAgICAgJ2JhbGFuY2VzX3RhYmxlcyc6ICcnLAogICAgICAgICAgICAgICAgICAgICdvYmplY3RfbmFtZSc6ICcnLAogICAgICAgICAgICAgICAgICAgICdjZWxsX25hbWUnOiAnJywKICAgICAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJzogItCU0L7Qu9C20LXQvSDQsdGL0YLRjCDQstGL0LHRgNCw0L0g0YHQutC70LDQtCwg0YLQvtCy0LDRgCDQuNC70Lgg0Y/Rh9C10LnQutCwIgogICAgICAgICAgICAgICAgfSkKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfaXRlbV9hcnQoc2VsZik6CiAgICAgICAgaXRlbV9hcnRfaW5wdXQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9hcnRfaW5wdXQnKQoKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9hcnRfaW5wdXQnKToKICAgICAgICAgICAgaXRlbV92YWx1ZXNfcmVzdWx0ID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICB0YWJsZV9uYW1lPSdSU19nb29kcycsIGZpZWxkPSdhcnQnLAogICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9aXRlbV9hcnRfaW5wdXQKICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBpdGVtX3ZhbHVlc19yZXN1bHQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdF9uYW1lJzogaXRlbV92YWx1ZXNfcmVzdWx0WzBdWyduYW1lJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdpbnB1dF9pdGVtX2lkJzogaXRlbV92YWx1ZXNfcmVzdWx0WzBdWydpZCddLAogICAgICAgICAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfb2JqZWN0X25hbWUnOiBmJ3tpdGVtX3ZhbHVlc19yZXN1bHRbMF1bIm5hbWUiXX0sIHtpdGVtX3ZhbHVlc19yZXN1bHRbMF1bImNvZGUiXX0nLAogICAgICAgICAgICAgICAgICAgICAgICAnaXRlbV9jb2RlJzogaXRlbV92YWx1ZXNfcmVzdWx0WzBdWydjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdlcnJvcl9tc2cnOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW1fYXJ0X2lucHV0Jzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JyksCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtX2JhcmNvZGUnOiAnJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBpdGVtX2FydF9pbnB1dCAhPSAn4oCUJyBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ3JldHVybl90b19pdGVtX2NhcmQnKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgZiIg0KLQvtCy0LDRgCDRgSDQsNGA0YLQuNC60YPQu9C+0LwgJ3tpdGVtX2FydF9pbnB1dH0nICDQvdC1INC90LDQudC00LXQvSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2lucHV0X2l0ZW1faWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ29iamVjdF9uYW1lJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9vYmplY3RfbmFtZScsICcnKQoKICAgIGRlZiBfcHJvY2Vzc19pbnB1dF9jZWxsKHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0Jyk6CiAgICAgICAgICAgIGNlbGxfdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfY2VsbHMnLAogICAgICAgICAgICAgICAgZmllbGQ9J25hbWUnLAogICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2NlbGxfaW5wdXQnKQogICAgICAgICAgICApCgogICAgICAgICAgICBpZiBjZWxsX3ZhbHVlc19yZXN1bHQ6CiAgICAgICAgICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSAnY2VsbHMnCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9pZCcsIGNlbGxfdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjZWxsX25hbWUnLCBzZWxmLmhhc2hfbWFwLmdldCgnY2VsbF9pbnB1dCcpKQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGN1cnJlbnRfZXJyb3IgPSBmIntzZWxmLmhhc2hfbWFwWydlcnJvcl9tc2cnXX1cbiIgaWYgc2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ10gZWxzZSAnJwogICAgICAgICAgICAgICAgZXJyb3JfdGV4dCA9ICd7fdCv0YfQtdC50LrQsCBjINC40LzQtdC90LXQvCB7fSDQvdC1INC90LDQudC00LXQvdCwJy5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgY3VycmVudF9lcnJvciwgc2VsZi5oYXNoX21hcFsnY2VsbF9pbnB1dCddCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydlcnJvcl9tc2cnXSA9IGVycm9yX3RleHQKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9pZCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2VsbF9uYW1lJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9jZWxsX25hbWUnLCAnJykKCiAgICBkZWYgX2lkZW50aWZ5X2JhcmNvZGVfYmFsYW5jZXMoc2VsZik6CiAgICAgICAgbm9fZGF0YSA9IEZhbHNlCiAgICAgICAgYmFyY29kZV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgIHRhYmxlX25hbWU9IlJTX2JhcmNvZGVzIiwKICAgICAgICAgICAgZmllbGQ9J2JhcmNvZGUnLAogICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpCiAgICAgICAgKQoKICAgICAgICBpZiBiYXJjb2RlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpdGVtX2JhcmNvZGUnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfcHJvcGVydHknKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcm9wZXJ0eV9pZCcsIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5JykpCgogICAgICAgICAgICBpZiBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9nb29kJyk6CiAgICAgICAgICAgICAgICBpdGVtX2lkID0gYmFyY29kZV9kYXRhWzBdWydpZF9nb29kJ10KCiAgICAgICAgICAgICAgICBpdGVtX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19nb29kcyIsCiAgICAgICAgICAgICAgICAgICAgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1pdGVtX2lkCiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9pdGVtX2lkJywgaXRlbV9pZCkKICAgICAgICAgICAgICAgICAgICBpZiBpdGVtX2RhdGFbMF1bJ2FydCddOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9hcnRfaW5wdXQnLCBpdGVtX2RhdGFbMF1bJ2FydCddKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpdGVtX2FydF9pbnB1dCcsICfigJQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9vYmplY3RfbmFtZScsIGYne2l0ZW1fZGF0YVswXVsibmFtZSJdfSwgIHtpdGVtX2RhdGFbMF1bImNvZGUiXX0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Zyb21fYmFyY29kZScsIFRydWUpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpdGVtX2JhcmNvZGUnLCAnJykKICAgICAgICAgICAgY2VsbF9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19jZWxscyIsIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJykKICAgICAgICAgICAgKQoKICAgICAgICAgICAgaWYgY2VsbF9kYXRhOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCBjZWxsX2RhdGFbMF1bJ2lkJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgY2VsbF9kYXRhWzBdWyduYW1lJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2VsbF9pbnB1dCcsIGNlbGxfZGF0YVswXVsnbmFtZSddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbm9fZGF0YSA9IFRydWUKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICLQqNGC0YDQuNGF0LrQvtC0INC90LUg0YDQsNGB0L/QvtC30L3QsNC9IikKICAgICAgICBpZiBub3Qgbm9fZGF0YToKICAgICAgICAgICAgc2VsZi5fZ2V0X2JhbGFuY2VzKCkKCiAgICBkZWYgX3Jlc2V0X2JhbGFuY2VzX3RhYmxlcyhzZWxmKToKICAgICAgICB2YXJzX2xpc3QgPSBbJ3doX3NlbGVjdCcsICdpbnB1dF9pdGVtX2lkJywgJ2NlbGxfaW5wdXQnLCAnY2VsbF9uYW1lJywgJ29iamVjdF9uYW1lJywgJ2Vycm9yX21zZycsCiAgICAgICAgICAgICAgICAgICAgICdiYWxhbmNlc190YWJsZScsICdiYXJjb2RlJywgJ3NlbGVjdGVkX2NlbGxfaWQnLCAncHJvcGVydHlfaWQnLCAnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLAogICAgICAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfd2hfaWQnLCAnaXRlbV9iYXJjb2RlJywgJ3NlbGVjdGVkX3doX25hbWUnLCAnc2VsZWN0ZWRfY2VsbF9uYW1lJ10KICAgICAgICBkaWN0X2RhdGEgPSB7dmFyOiAiIiBmb3IgdmFyIGluIHZhcnNfbGlzdH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYsIGVsZW1lbnRzKToKICAgICAgICBmb3IgdiBpbiBlbGVtZW50czoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICBkZWYgX2dldF9iYWxhbmNlc19kYXRhKHNlbGYpOgogICAgICAgIGRhdGEgPSBzZWxmLmhzX3NlcnZpY2UuZ2V0X2JhbGFuY2VzX2dvb2RzKAogICAgICAgICAgICBpZF9nb29kPXNlbGYuaGFzaF9tYXAuZ2V0KCdpbnB1dF9pdGVtX2lkJyksCiAgICAgICAgICAgIGlkX2NlbGw9c2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKSwKICAgICAgICAgICAgaWRfd2FyZWhvdXNlPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF93aF9pZCcpCiAgICAgICAgKS5kYXRhCgogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgcmF3X2JhbGFuY2VzX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgZm9yIGVsIGluIHJhd19iYWxhbmNlc19kYXRhOgogICAgICAgICAgICBzdG9yYWdlX25hbWUgPSBzdHIoZWxbJ25hbWVfd2FyZWhvdXNlJ10pIGlmIHNlbGYudGFibGVfdHlwZSA9PSAnd2FyZWhvdXNlcycgZWxzZSBzdHIoZWxbJ25hbWVfY2VsbCddKQoKICAgICAgICAgICAgaXRlbV9sYXlvdXQgPSBzZWxmLl9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyh7CiAgICAgICAgICAgICAgICAnc3RvcmFnZV9uYW1lX2xlbic6IGxlbihzdG9yYWdlX25hbWUpLAogICAgICAgICAgICAgICAgJ2l0ZW1fbmFtZV9sZW4nOiBsZW4oZWxbJ25hbWVfZ29vZCddKQogICAgICAgICAgICB9KQoKICAgICAgICAgICAgdGFibGVfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihlbFsnaWRfZ29vZCddKSwKICAgICAgICAgICAgICAgICdpdGVtX25hbWUnOiBzdHIoZWxbJ25hbWVfZ29vZCddKSwKICAgICAgICAgICAgICAgICdzdG9yYWdlX25hbWUnOiBzdG9yYWdlX25hbWUsCiAgICAgICAgICAgICAgICAncXR0eSc6IHN0cihlbFsncXR0eSddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzJzogc3RyKGVsWyduYW1lX3Byb3BlcnR5J10gb3IgJ+KAlCcpLAogICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBpdGVtX2xheW91dAogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfaWQnKToKICAgICAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpID09IHN0cihlbFsnaWRfcHJvcGVydHknXSk6CiAgICAgICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQodGFibGVfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQodGFibGVfcm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2JhbGFuY2VzX3RhYmxlX3ZpZXcoc2VsZiwgZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KHQutC70LDQtCcpIGlmIHNlbGYudGFibGVfdHlwZSA9PSAnd2FyZWhvdXNlcycgZWxzZSBzZWxmLlRleHRWaWV3KCfQr9GH0LXQudC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ci0L7QstCw0YAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ca0L7Qu9C40YfQtdGB0YLQstC+JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutC4JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0YwRjhGRicKICAgICAgICAgICAgKSwKCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPWRhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyhzZWxmLCByb3dfZGF0YSk6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc3RvcmFnZV9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD0nd3JhcF9jb250ZW50JwoKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnIGlmIHJvd19kYXRhWydzdG9yYWdlX25hbWVfbGVuJ10gPCByb3dfZGF0YVsnaXRlbV9uYW1lX2xlbiddIGVsc2UgJ3dyYXBfY29udGVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAaXRlbV9uYW1lJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JyBpZiByb3dfZGF0YVsnaXRlbV9uYW1lX2xlbiddIDwgcm93X2RhdGFbJ3N0b3JhZ2VfbmFtZV9sZW4nXSBlbHNlICd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvcGVydGllcycsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnLAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgZGVmIF9jaGVja19pdGVtX3ZhcmlhbnRzKHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykKICAgICAgICBpZiBpdGVtX2FydF9pbnB1dDoKICAgICAgICAgICAgaXRlbV92YWx1ZXNfcmVzdWx0ID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICB0YWJsZV9uYW1lPSdSU19nb29kcycsIGZpZWxkPSdhcnQnLAogICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9aXRlbV9hcnRfaW5wdXQKICAgICAgICAgICAgKQoKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgaWYgbGVuKGl0ZW1fdmFsdWVzX3Jlc3VsdCkgPiAxOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScsICcnKQogICAgICAgICAgICAgICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZScpIGVsc2UgMTgKCiAgICAgICAgICAgICAgICAgICAgdmFyaWFudHNfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKSwKICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICAgICAgICAgICAgICBjYXJkc2RhdGE9aXRlbV92YWx1ZXNfcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2l0ZW1fdmFyaWFudHMnXSA9IHZhcmlhbnRzX2NhcmRzLnRvX2pzb24oKQoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcj0n0JLRi9Cx0LXRgNC40YLQtSDQstCw0YDQuNCw0L3RgiDRgtC+0LLQsNGA0LA6JywKICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9ucz1bJ9CS0YvQsdGA0LDRgtGMJywgJ9Ce0YLQvNC10L3QsCddCiAgICAgICAgICAgICAgICAgICAgKQoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzQmFsYW5jZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNQcmljZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEdvb2RzUHJpY2VzSXRlbUNhcmQoR29vZHNCYWxhbmNlc0l0ZW1DYXJkKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cm0LXQvdGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydCgKICAgICAgICAgICAgWydwcmljZXNfZXJyb3JfbXNnJywgJ3ByaWNlc19vYmplY3RfbmFtZScsICdzZWxlY3RlZF9wcmljZV90eXBlX25hbWUnLAogICAgICAgICAgICAnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICdzZWxlY3RlZF91bml0X25hbWUnLCAnYmFyY29kZV9pbmZvJ10pCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgncHJpY2VzX3RhYmxlJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9wcmljZXNfY29udHJvbHMiLCAiMSIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICItMSIpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ3ByaWNlX3R5cGVfc2VsZWN0JzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X2l0ZW0oKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Byb3BlcnR5X3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd1bml0X3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdwcmljZV90eXBlX3NlbGVjdF9zdWNjZXNzJzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCdwcmljZV90eXBlX3NlbGVjdCcpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJvcGVydHlfc2VsZWN0X3N1Y2Nlc3MnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3Byb3BlcnR5X3NlbGVjdCcpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndW5pdF9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgndW5pdF9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2dldF9wcmljZXNfYnRuJzoKICAgICAgICAgICAgc2VsZi5fZ2V0X3ByaWNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2lkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLl9yZXNldF9wcmljZXNfdGFibGVzKCkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3JldHVybl90b19pdGVtX2NhcmQnKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdub1JlZnJlc2gnLCAnJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJGaW5pc2hQcm9jZXNzUmVzdWx0IiwgIiIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Nob3dfZmlsdGVycyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9wcmljZXNfY29udHJvbHMiLCAiMSIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICItMSIpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfc2VsZWN0X2l0ZW0oc2VsZik6CiAgICAgICAgaXRlbV90YWJsZXMgPSB7CiAgICAgICAgICAgICdwcmljZV90eXBlX3NlbGVjdCc6ICdSU19wcmljZV90eXBlcycsCiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3QnOiAnUlNfcHJvcGVydGllcycsCiAgICAgICAgICAgICd1bml0X3NlbGVjdCc6ICdSU191bml0cycsCiAgICAgICAgfQogICAgICAgIGl0ZW1fdHlwZSA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgU2VsZWN0SXRlbVNjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgdGFibGVfbmFtZT1pdGVtX3RhYmxlc1tpdGVtX3R5cGVdLAogICAgICAgICAgICByZXN1bHRfbGlzdGVuZXI9Zid7aXRlbV90eXBlfV9zdWNjZXNzJwogICAgICAgICkuc2hvdygpCgogICAgZGVmIF9zZWxlY3RfaXRlbV9yZXN1bHQoc2VsZiwgZmllbGRfbmFtZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX2NhcmQ6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSBzZWxlY3RlZF9jYXJkLmdldCgnbmFtZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9ICcnCgogICAgZGVmIF9nZXRfcHJpY2VzKHNlbGYpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX2lucHV0KCkKICAgICAgICByYXdfcHJpY2VzX2RhdGEgPSBzZWxmLl9nZXRfcHJpY2VzX2RhdGEoKQogICAgICAgIHByaWNlc19kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKHJhd19wcmljZXNfZGF0YSkKICAgICAgICBwcmljZXNfdGFibGUgPSBzZWxmLl9nZXRfcHJpY2VzX3RhYmxlX3ZpZXcocHJpY2VzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc190YWJsZScsIHByaWNlc190YWJsZS50b19qc29uKCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X3ByaWNlc19jb250cm9scyIsICItMSIpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfc2hvd19maWx0ZXJzIiwgIjEiKQoKICAgIGRlZiBfdmFsaWRhdGVfaW5wdXQoc2VsZik6CiAgICAgICAgc2VsZi5fcHJvY2Vzc19pbnB1dF9nb29kX2FydCgpCiAgICAgICAgaWYgbm90IChzZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfdGFibGVzJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQsdGA0LDQvSDRgtC+0LLQsNGAIikKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfZ29vZF9hcnQoc2VsZik6CiAgICAgICAgaXRlbV9hcnRfaW5wdXQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKQogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCc6ICcnLAogICAgICAgICAgICAncHJpY2VzX29iamVjdF9uYW1lJzogJycsCiAgICAgICAgICAgICdlcnJvcl9tc2cnOiAnJwogICAgICAgIH0KCiAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQ6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywgZmllbGRfdmFsdWU9aXRlbV9hcnRfaW5wdXQpCgogICAgICAgICAgICBpZiBpdGVtX3ZhbHVlc19yZXN1bHQ6CiAgICAgICAgICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSwKICAgICAgICAgICAgICAgICAgICAnZ29vZF9jb2RlJzogaXRlbV92YWx1ZXNfcmVzdWx0WzBdWydjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgJ3ByaWNlc19vYmplY3RfbmFtZSc6IGYne2l0ZW1fdmFsdWVzX3Jlc3VsdFswXVsibmFtZSJdfSwgJ2Yne2l0ZW1fdmFsdWVzX3Jlc3VsdFswXVsiY29kZSJdfScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGl0ZW1fYXJ0X2lucHV0ICE9ICfigJQnIGFuZCBzZWxmLmhhc2hfbWFwLmdldCgncmV0dXJuX3RvX2l0ZW1fY2FyZCcpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCBmIiDQotC+0LLQsNGAINGBINCw0YDRgtC40LrRg9C70L7QvCAne2l0ZW1fYXJ0X2lucHV0fScg0L3QtSDQvdCw0LnQtNC10L0iKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBfaWRlbnRpZnlfYmFyY29kZV9wcmljZXMoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfaW5mbycsIHN0cihzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgJycpCiAgICAgICAgbm9fZGF0YSA9IEZhbHNlCgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9IlJTX2JhcmNvZGVzIiwgZmllbGQ9J2JhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJykpCiAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdOgogICAgICAgICAgICBpZiBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9wcm9wZXJ0eScpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfcHJvcGVydHknKSkKICAgICAgICAgICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU19wcm9wZXJ0aWVzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1iYXJjb2RlX2RhdGFbMF0uZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaWRfcHJvcGVydHknKSkKICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkX3Byb3BlcnR5X25hbWVbMF0uZ2V0KCduYW1lJyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdLmdldCgnbmFtZScpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICcnKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfZ29vZCcpOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IGJhcmNvZGVfZGF0YVswXVsnaWRfZ29vZCddCgogICAgICAgICAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0iUlNfZ29vZHMiLCBmaWVsZD0naWQnLCBmaWVsZF92YWx1ZT1pdGVtX2lkKQogICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9nb29kX2lkJywgaXRlbV9pZCkKICAgICAgICAgICAgICAgICAgICBpZiBpdGVtX2RhdGFbMF1bJ2FydCddOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9hcnQnLCBpdGVtX2RhdGFbMF1bJ2FydCddKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9nb29kX2FydCcsICfigJQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCBpdGVtX2RhdGFbMF1bJ25hbWUnXSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG5vX2RhdGEgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgItCo0YLRgNC40YXQutC+0LQg0L3QtSDRgNCw0YHQv9C+0LfQvdCw0L0iKQoKICAgICAgICBpZiBub3Qgbm9fZGF0YToKICAgICAgICAgICAgc2VsZi5fZ2V0X3ByaWNlcygpCgogICAgZGVmIF9yZXNldF9wcmljZXNfdGFibGVzKHNlbGYpOgogICAgICAgIHZhcnNfbGlzdCA9IFsnaW5wdXRfZ29vZF9hcnQnLCAncHJpY2VzX29iamVjdF9uYW1lJywgJ3NlbGVjdGVkX3ByaWNlX3R5cGVfaWQnLCAnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgJ3ByaWNlX3R5cGVfc2VsZWN0JywgJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAncHJvcGVydHlfc2VsZWN0JywKICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3VuaXRfaWQnLCAnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJ3VuaXRfc2VsZWN0JywgJ3ByaWNlc19jdXN0b21fdGFibGUnLCAnaW5wdXRfZ29vZF9pZCcsCiAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJywgJ2JhcmNvZGVfaW5mbycsICdwcmljZXNfdGFibGUnXQogICAgICAgIGRpY3RfZGF0YSA9IHt2YXI6ICIiIGZvciB2YXIgaW4gdmFyc19saXN0fQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoZGljdF9kYXRhKQoKICAgIGRlZiBfc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoc2VsZiwgZWxlbWVudHMpOgogICAgICAgIGZvciB2IGluIGVsZW1lbnRzOgogICAgICAgICAgICBuYW1lID0gZidTaG93X3t2fScKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtuYW1lXSA9ICcxJyBpZiBzZWxmLmhhc2hfbWFwW3ZdIGVsc2UgJy0xJwoKICAgIGRlZiBfZ2V0X3ByaWNlc19kYXRhKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfc2VsZWN0Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICcnKQoKICAgICAgICBkYXRhID0gc2VsZi5oc19zZXJ2aWNlLmdldF9wcmljZXNfZ29vZHMoaWRfZ29vZD1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9wcm9wZXJ0eT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfdW5pdD1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfdW5pdF9pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9wcmljZV90eXBlPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJykpLmRhdGEKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIHJhd19iYWxhbmNlc19kYXRhKToKCiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICBmb3IgZWwgaW4gcmF3X2JhbGFuY2VzX2RhdGE6CiAgICAgICAgICAgIHRhYmxlX3JvdyA9IHsna2V5Jzogc3RyKGVsWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3ByaWNlX3R5cGUnOiBzdHIoZWxbJ25hbWVfcHJpY2VfdHlwZSddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICdwcmljZSc6IHN0cihlbFsncHJpY2UnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAndW5pdCc6IHN0cihlbFsnbmFtZV91bml0J10pIG9yICfigJQnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXMnOiBzdHIoZWxbJ25hbWVfcHJvcGVydHknXSBvciAn4oCUJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9pdGVtX3RhYmxlX3Jvd192aWV3KGVsKX0KICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQodGFibGVfcm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3ByaWNlc190YWJsZV92aWV3KHNlbGYsIGRhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ci0LjQvyDRhtC10L3RiycpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQuCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KbQtdC90LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cj0L/QsNC60L7QstC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRjBGOEZGJwogICAgICAgICAgICApLAoKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9ZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9pdGVtX3RhYmxlX3Jvd192aWV3KHNlbGYsIHJvd19kYXRhKToKCiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJpY2VfdHlwZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0aWVzJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BwcmljZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0YwRjhGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCmNsYXNzIFNlbGVjdFByb3BlcnRpZXMoR29vZHNQcmljZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQktGL0LHQvtGAINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC6JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cm0LXQvdGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX2lucHV0KCkKICAgICAgICBjYXJkc19kYXRhID0gc2VsZi5fZ2V0X2RhdGEoKQogICAgICAgIHByb3BlcnRpZXNfY2FyZHMgPSBzZWxmLl9nZXRfY2FyZHMoY2FyZHNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJvcGVydHlfY2FyZHMnLCBwcm9wZXJ0aWVzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgX2dldF9kYXRhKHNlbGYpOgogICAgICAgIHRhYmxlX25hbWUgPSAiUlNfcHJvcGVydGllcyIKICAgICAgICByYXdfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWUsIGZpZWxkPSdpZF9vd25lcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpKQogICAgICAgIGNhcmRzX2RhdGEgPSBbXQogICAgICAgIGZvciBlbGVtZW50IGluIHJhd19kYXRhOgogICAgICAgICAgICBjYXJkX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAna2V5JzogZWxlbWVudFsnaWQnXSwKICAgICAgICAgICAgICAgICduYW1lJzogZWxlbWVudFsnbmFtZSddCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FyZHNfZGF0YS5hcHBlbmQoY2FyZF9kYXRhKQogICAgICAgIHJldHVybiBjYXJkc19kYXRhCgogICAgZGVmIF9nZXRfY2FyZHMoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpCgogICAgICAgIGNhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQogICAgICAgIHJldHVybiBjYXJkcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9pZCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU19wcm9wZXJ0aWVzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGVjdGVkX3Byb3BlcnR5X2lkKVswXVsnbmFtZSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIHNlbGVjdGVkX3Byb3BlcnR5X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9IHNlbGVjdGVkX3Byb3BlcnR5X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZSddID0gc2VsZWN0ZWRfcHJvcGVydHlfbmFtZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9GA0L7QstC10YDQutCwINGG0LXQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCIgb3IgJ2JhY2tfdG9fcHJpY2VzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfaWQnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdCddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZSddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKY2xhc3MgU2VsZWN0VW5pdChHb29kc1ByaWNlc0l0ZW1DYXJkKToKICAgIHNjcmVlbl9uYW1lID0gJ9CS0YvQsdC+0YAg0YPQv9Cw0LrQvtCy0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuX2dldF9kYXRhKCkKICAgICAgICBwcm9wZXJ0aWVzX2NhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VuaXRfY2FyZHMnLCBwcm9wZXJ0aWVzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgX2dldF9kYXRhKHNlbGYpOgogICAgICAgIHRhYmxlX25hbWUgPSAiUlNfdW5pdHMiCiAgICAgICAgcmF3X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lLCBmaWVsZD0naWRfb3duZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSkKICAgICAgICBjYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgZWxlbWVudCBpbiByYXdfZGF0YToKICAgICAgICAgICAgY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGVsZW1lbnRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IGVsZW1lbnRbJ25hbWUnXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzX2RhdGEuYXBwZW5kKGNhcmRfZGF0YSkKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgICwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gY2FyZHMKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgICAgIHNlbGVjdGVkX3VuaXRfbmFtZSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9J1JTX3VuaXRzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZWN0ZWRfdW5pdF9pZClbMF1bJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9pZCcsIHNlbGVjdGVkX3VuaXRfaWQpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0J10gPSBzZWxlY3RlZF91bml0X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfbmFtZScsIHNlbGVjdGVkX3VuaXRfbmFtZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiIG9yICdiYWNrX3RvX3ByaWNlcyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3VuaXRfaWQnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0J10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJycpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9GA0L7QstC10YDQutCwINGG0LXQvScpCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IFNlcmllcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU2VyaWVzU2VsZWN0U2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VyaWVzUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ1Nlcmllc1NlbGVjdFNjcmVlbicKICAgIGRvY19iYXNpY190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICBkb2NfYmFzaWNfaGFuZGxlcl9uYW1lID0gJ1JTX2RvY3MnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlcmllc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RpdGxlJzogJ9CS0YvQsdC+0YAg0YHQtdGA0LjQuCcsCiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogc2VsZi5oYXNoX21hcFsnZG9jX3Jvd19pZCddLAogICAgICAgIH0KICAgICAgICBzZWxmLnVzZV9hZHJfZG9jc190YWJsZXMgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCd1c2VfYWRyX2RvY3NfdGFibGVzJykKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgaWYgc2VsZi51c2VfYWRyX2RvY3NfdGFibGVzOgogICAgICAgICAgICBzZWxmLnNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5BZHJTZXJpZXNTZXJ2aWNlKCkKICAgICAgICBrZXkgPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ2RvY19yb3dfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKGtleSkKICAgICAgICAjICMg0J7QsdGA0LDQsdC+0YLQsNC10Lwg0YfQuNGB0LvQvtCy0YvQtSDQutC70Y7Rh9C4INCyINGB0LvQvtCy0LDRgNC1CiAgICAgICAgc2VsZi5faGFuZGxlX251bV9rZXlzKHNlbGYuc2NyZWVuX2RhdGEpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnBhcmFtcyA9IHNlbGYuc2NyZWVuX2RhdGEKICAgICAgICBzZWxmLl9yZWZyZXNoX3Nlcmllc19jYXJkcygpCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnZG9jX3RpdGxlJyk6CiAgICAgICAgICAgIHRpdGxlID0gJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWydkb2NfdHlwZSddLAogICAgICAgICAgICAgICAgc2VsZi5zY3JlZW5fZGF0YVsnZG9jX24nXSwKICAgICAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY19kYXRlJ10KICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3RpdGxlJywgdGl0bGUpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICBzZWxmLl9yZWZyZXNoX3RvdGFsX3F0dHkoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLnNjcmVlbl92YWx1ZXNbJ3RpdGxlJ10pCiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgIyBzZWxmLl9yZWZyZXNoX3Nlcmllc19jYXJkcygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09IkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxmLl9jYXJkc19jbGlja19oYW5kbGVyKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ImJ0bl9hZGRfc2VyaWVzIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoInNlbGVjdGVkX2NhcmRfa2V5IiwgJycpCiAgICAgICAgICAgIHNlbGYuX2NhcmRzX2NsaWNrX2hhbmRsZXIoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndmlzaW9uX2NhbmNlbCc6CiAgICAgICAgICAgIFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbF9jb3VudGVyLmRlc3Ryb3koKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbic6CiAgICAgICAgICAgIHNlbGYuX2JhcmNvZGVfbGlzdGVuZXIoKQogICAgICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWxfY291bnRlci5kZXN0cm95KCkKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIHNlbGYuX2xheW91dF9hY3Rpb24oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2RlbGV0ZScpOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV9zZXJpZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9vY3Jfc2VyaWFsX3RlbXBsYXRlX3NldHRpbmdzJzoKICAgICAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ09jclRleHRSZWNvZ25pdGlvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9wcmludCc6CiAgICAgICAgICAgIHNlbGYuX3ByaW50X3RpY2tldCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Nlcmllc19hZGRfYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2J0bl9hZGRfYmFyY29kZSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLnNob3dfcHJvY2Vzc19yZXN1bHQoYXJncykKCiAgICBkZWYgX2NhcmRzX2NsaWNrX2hhbmRsZXIoc2VsZik6CiAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfaXRlbV9zY3JlZW4oKQoKICAgIGRlZiBfb3Blbl9zZXJpZXNfaXRlbV9zY3JlZW4oc2VsZik6CiAgICAgICAgYXJncyA9IHsKICAgICAgICAgICAgJ3Nlcmllc19pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpLAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjRjycKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gU2VyaWVzSXRlbShzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93KGFyZ3MpCgogICAgZGVmIF9yZWZyZXNoX3RvdGFsX3F0dHkoc2VsZik6CiAgICAgICAgcmVhbF9xdHR5ID0gc2VsZi5zZXJ2aWNlLmdldF90b3RhbF9xdHR5KCkKICAgICAgICBvbGRfcXR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcFsncXR0eSddIG9yIDApCgogICAgICAgIGlmIG9sZF9xdHkgIT0gZmxvYXQocmVhbF9xdHR5IG9yIDApOgogICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX3RvdGFsX3F0eShxdHk9cmVhbF9xdHR5LCByb3dfaWQ9c2VsZi5zY3JlZW5fdmFsdWVzWydkb2Nfcm93X2lkJ10pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3F0dHknXSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShyZWFsX3F0dHkpCgogICAgZGVmIF9iYXJjb2RlX2xpc3RlbmVyKHNlbGYpOgogICAgICAgIHNlbGYuX2lkZW50aWZ5X2FkZF9iYXJjb2RlX3NlcmllcygpCiAgICAgICAgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQogICAgICAgIHNlbGYuX3JlZnJlc2hfdG90YWxfcXR0eSgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9jaGVja19xdHR5X2xpbWl0cyhzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJyk6CiAgICAgICAgICAgIHF0dHkgPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQogICAgICAgICAgICBxdHR5X3BsYW4gPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eV9wbGFuJykpCiAgICAgICAgICAgIGlmIHF0dHkgPiBxdHR5X3BsYW46CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCLQpNCw0LrRgiDQv9GA0LXQstGL0YjQsNC10YIg0L/Qu9Cw0L0iKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX3F0dHlfbGltaXRzKCk6CiAgICAgICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCgogICAgZGVmIF9yZWZyZXNoX3Nlcmllc19jYXJkcyhzZWxmKToKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc19ieV9kb2NfYW5kX2dvb2RzKCkKICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5faGFuZGxlX251bV9rZXlzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5fYWRkX3RleHRfaW5fdmFsdWVzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcobGlzdF9kYXRhKQogICAgICAgICMg0JTQvtCx0LDQstC40Lwg0L3QsNC00L/QuNGB0Ywg0LXRgdC70Lgg0L3QtdGCINGB0LXRgNC40Lkg0LIg0YHQv9C40YHQutC1CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2VtcHR5X3NlcmllcycsICgiIiwi0J7RgtGB0LrQsNC90LjRgNGD0LnRgtC1INGB0LXRgNC40LgiKVtsZW4obGlzdF9kYXRhKT09MF0pIAogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Nlcmllc19jYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBfaGFuZGxlX251bV9rZXlzKHNlbGYsIHZhbHVlczogZGljdCkgLT4gZGljdDoKICAgICAgICBudW1lcmljX2tleXMgPSAoJ3F0dHknLCAncXR0eV9wbGFuJywgJ2RfcXR0eScpCiAgICAgICAgZm9yIGtleSBpbiBudW1lcmljX2tleXM6CiAgICAgICAgICAgIGlmIGtleSBpbiB2YWx1ZXMgYW5kIHJlLm1hdGNoKCJeXGQrXC4/XGQqJCIsIHN0cih2YWx1ZXNba2V5XSkpOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoZmxvYXQodmFsdWVzW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSAnMCcKICAgICAgICByZXR1cm4gdmFsdWVzCgogICAgZGVmIF9hZGRfdGV4dF9pbl92YWx1ZXMoc2VsZiwgdmFsdWVzOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGZvciBrZXkgaW4gdmFsdWVzLmtleXMoKToKICAgICAgICAgICAgaWYga2V5ID09ICdiZXN0X2JlZm9yZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9Cz0L7QtNC10L0g0LTQvjoge3ZhbHVlc1trZXldfScKICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ3Byb2R1Y3Rpb25fZGF0ZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C00LDRgtCwINC/0YDQvtC40LfQsi46IHt2YWx1ZXNba2V5XX0nCiAgICAgICAgICAgIGVsaWYga2V5ID09ICdxdHR5JyBhbmQgdmFsdWVzW2tleV0gaXMgbm90IE5vbmUgYW5kIHZhbHVlc1trZXldICE9ICcnOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C60L7Quy3QstC+OiB7dmFsdWVzW2tleV19JwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKCiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BiZXN0X2JlZm9yZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0n0KPQtNCw0LvQuNGC0YwnLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMGYwM2ZjJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9JyAnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvZHVjdGlvbl9kYXRlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfaWRlbnRpZnlfYWRkX2JhcmNvZGVfc2VyaWVzKHNlbGYpOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpIG9yIG9jcl9ub3NxbC5nZXQoJ29jcl9yZXN1bHQnKQogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIG9jcl9ub3NxbC5kZWxldGUoJ29jcl9yZXN1bHQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnYmFyY29kZScpCiAgICAgICAgICAgIHZhbHVlcyA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX2J5X2JhcmNvZGUoYmFyY29kZSwgc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IHZhbHVlc1swXVsnaWQnXQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9xdHR5X3RvX3RhYmxlX3N0cihpdGVtX2lkKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9uZXdfc2VyaWVzX2luX2RvY19zZXJpZXNfdGFibGUoYmFyY29kZSkKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDRgdC10YDQuNGOPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQmNC30LzQtdC90LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9zZXJpZXNfaWQnXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLCBzZWxmLnBhcmFtcykKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBkZWxldGVfc2VyaWVzKHNlbGYpOgogICAgICAgIGlkID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICBzZWxmLnNlcnZpY2UuZGVsZXRlX2N1cnJlbnRfc3QoaWQpCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IG9jcl9ub3NxbC5nZXQoJ3NlcmlhbF9vY3Jfc2V0dGluZ3MnKQogICAgICAgIGlmIHNlcmlhbF9vY3Jfc2V0dGluZ3M6CiAgICAgICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBqc29uLmxvYWRzKHNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3Zpc2lvbl9zZXR0aW5ncygqKnNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ2Zyb21fc2NyZWVuJywgJ1Nlcmllc1NlbGVjdFNjcmVlbicsIFRydWUpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgIyDQn9C+0LvRg9GH0LjQvCDQv9C10YDQstGL0Lkg0LHQsNGA0LrQvtC0INC00L7QutGD0LzQtdC90YLQsAogICAgICAgIGJhcmNvZGUgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpLmdldF9iYXJjb2RlX2Zyb21fZG9jX3RhYmxlKHNlbGYuc2NyZWVuX3ZhbHVlc1snZG9jX3Jvd19pZCddKQogICAgICAgIGRhdGEgPSB7J9CU0LDRgtCwX9C00L7Quic6ICdEb2NfZGF0YScsICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiAnR29vZCcsCiAgICAgICAgICAgICAgICAn0JDRgNGC0LjQutGD0LsnOiAnZ29vZF9hcnQnLCAn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAJzogJ2dvb2Rfc24nLAogICAgICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiAnZ29vZF9wcm9wZXJ0eScsICfQptC10L3QsCc6ICdnb29kX3ByaWNlJywKICAgICAgICAgICAgICAgICfQldC00JjQt9C8JzogJ2dvb2RfdW5pdCcsICfQmtC70Y7Rhyc6ICdrZXknLCAn0JLQsNC70Y7RgtCwJzogJ3ByaWNlX3R5cGUnfQogICAgICAgIGZvciBrZXkgaW4gZGF0YToKICAgICAgICAgICAgZGF0YVtrZXldID0gc2VsZi5oYXNoX21hcC5nZXQoZGF0YVtrZXldKQogICAgICAgIGRhdGFbJ2JhcmNvZGUnXSA9IGJhcmNvZGUgaWYgYmFyY29kZSBlbHNlICcwMDAwMDAwMDAwMDAwJwogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfYnRuX2FkZF9iYXJjb2RlKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiAgc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2lkX2dvb2QnLCAnJyksCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICBzZWxmLnNjcmVlbl9kYXRhLmdldCgnaWRfcHJvcGVydGllcycsICcnKSwKICAgICAgICAgICAgJ3VuaXRfaWQnOiAgc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2lkX3VuaXQnLCAnJykKICAgICAgICB9CiAgICAgICAgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93X3Byb2Nlc3NfcmVzdWx0KGluaXRfZGF0YSkKCmNsYXNzIFNlcmllc0l0ZW0oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICdTZXJpZXNQcm9jZXNzJwogICAgc2NyZWVuX25hbWUgPSAnRmlsbGluZ1Nlcmllc1NjcmVlbicKICAgIGRvY19iYXNpY190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICBkb2NfYmFzaWNfaGFuZGxlcl9uYW1lID0gJ1JTX2RvY3MnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuU2VyaWVzU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHt9CiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAndGl0bGUnOiAn0JfQsNC/0L7Qu9C90LXQvdC40LUg0YHQtdGA0LjQuCcsCiAgICAgICAgICAgICdzZXJpZXNfaWQnOiBzZWxmLmhhc2hfbWFwWydzZXJpZXNfaWQnXSwKICAgICAgICB9CgoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZXJpZXNfaWQgPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3Nlcmllc19pZCddCiAgICAgICAgc2VsZi5zY3JlZW5fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX3RhYmxlX3N0cihzZXJpZXNfaWQpCgogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnZ29vZF9uYW1lJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ2dvb2RfbmFtZScpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgJ25hbWUnOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnbmFtZScsJycpLAogICAgICAgICAgICAnbnVtYmVyJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ251bWJlcicsJycpLAogICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJzogc2VsZi5zY3JlZW5fZGF0YS5nZXQoJ3Byb2R1Y3Rpb25fZGF0ZScsJycpLAogICAgICAgICAgICAnYmVzdF9iZWZvcmUnOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnYmVzdF9iZWZvcmUnLCcnKSwKICAgICAgICAgICAgJ0ZpbGxpbmdTZXJpZXNTY3JlZW5fcXR0eScgOiBzZWxmLnNjcmVlbl9kYXRhLmdldCgncXR0eScsJycpCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9oYW5kbGVfbnVtX2tleXMocHV0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQogICAgICAgICMgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJidG5fc2F2ZSI6CiAgICAgICAgICAgIHNlbGYuX2J0bl9zYXZlX2hhbmRsZXIoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fY2FuY2VsIjoKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX3VwZGF0ZV9zZXJpZXMnKToKICAgICAgICAgICAgcGFyYW1zID0gc2VsZi5fZ2V0X3BhcmFtcygpCiAgICAgICAgICAgIHBhcmFtcy51cGRhdGUoc2VsZi5fY2hlY2tfc2VyaWVzX251bWJlcigpKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2F2ZV90YWJsZV9zdHIocGFyYW1zKSAKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKSAgIAoKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX3NhdmVfZGF0YShzZWxmKToKICAgICAgICBwYXJhbXMgPSBzZWxmLl9nZXRfcGFyYW1zKCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2F2ZV90YWJsZV9zdHIocGFyYW1zKQoKICAgIGRlZiBfaXNfdmFsaWRfZGF0ZV9mb3JtYXQoc2VsZiwgZGF0ZV9zdHIpOgogICAgICAgIHBhdHRlcm4gPSByIl4oMFsxLTldfFsxMl1bMC05XXwzWzAxXSlcLigwWzEtOV18MVswLTJdKVwuXGR7NH0kIgogICAgICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIGRhdGVfc3RyKSkKCiAgICBkZWYgX2hhbmRsZV9udW1fa2V5cyhzZWxmLCB2YWx1ZXM6IGRpY3QpIC0+IGRpY3Q6CiAgICAgICAgbnVtZXJpY19rZXlzID0gKCdxdHR5JywgJ3F0dHlfcGxhbicsICdkX3F0dHknLCAnRmlsbGluZ1Nlcmllc1NjcmVlbl9xdHR5JykKICAgICAgICBmb3Iga2V5IGluIG51bWVyaWNfa2V5czoKICAgICAgICAgICAgaWYga2V5IGluIHZhbHVlcyBhbmQgcmUubWF0Y2goIl5cZCtcLj9cZCokIiwgc3RyKHZhbHVlc1trZXldKSk6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShmbG9hdCh2YWx1ZXNba2V5XSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9ICcwJwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBfYnRuX3NhdmVfaGFuZGxlcihzZWxmKToKICAgICAgICBpZiBzZWxmLnNjcmVlbl9kYXRhLmdldCgnaWQnKTogCiAgICAgICAgICAgIHNlbGYuX3NhdmVfZGF0YSgpCiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBzZWxmLl9jaGVja19zZXJpZXNfbnVtYmVyKCk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdjb25maXJtX3VwZGF0ZV9zZXJpZXMnLCAn0KHQtdGA0LjRjyDRgSDQtNCw0L3QvdGL0Lwg0L3QvtC80LXRgNC+0Lwg0YPQttC1INGB0YPRidC10YHRgtCy0YPQtdGCLiDQntCx0L3QvtCy0LjRgtGMINC00LDQvdC90YvQtT8nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcGFyYW1zID0gc2VsZi5fZ2V0X3BhcmFtcygpCiAgICAgICAgICAgICAgICBzZWxmLl9hZGRfbmV3X3NlcmllcyhwYXJhbXMpCiAgICAgICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCgogICAgZGVmIF9nZXRfcGFyYW1zKHNlbGYpOgogICAgICAgIGNvbW1vbl9wYXJhbXMgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJyksCiAgICAgICAgICAgICdpZF9nb29kJzogc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2dvb2QnKSwKICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzZWxmLmhhc2hfbWFwLmdldCgnaWRfcHJvcGVydGllcycpLAogICAgICAgICAgICAnaWRfd2FyZWhvdXNlJzogc2VsZi5oYXNoX21hcC5nZXQoJ2lkX3dhcmVob3VzZScpLAogICAgICAgICAgICAncXR0eSc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdGaWxsaW5nU2VyaWVzU2NyZWVuX3F0dHknKSwKICAgICAgICAgICAgJ25hbWUnOiBzZWxmLmhhc2hfbWFwLmdldCgnbmFtZScpLAogICAgICAgICAgICAnYmVzdF9iZWZvcmUnOiBzZWxmLmhhc2hfbWFwLmdldCgnYmVzdF9iZWZvcmUnKSBpZiBzZWxmLl9pc192YWxpZF9kYXRlX2Zvcm1hdChzZWxmLmhhc2hfbWFwLmdldCgnYmVzdF9iZWZvcmUnKSkgZWxzZSBOb25lLAogICAgICAgICAgICAnbnVtYmVyJzogc2VsZi5oYXNoX21hcC5nZXQoJ251bWJlcicpLAogICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJzogc2VsZi5oYXNoX21hcC5nZXQoJ3Byb2R1Y3Rpb25fZGF0ZScpIGlmIHNlbGYuX2lzX3ZhbGlkX2RhdGVfZm9ybWF0KHNlbGYuaGFzaF9tYXAuZ2V0KCdwcm9kdWN0aW9uX2RhdGUnKSkgZWxzZSBOb25lLAogICAgICAgICAgICAnaWRfY2VsbCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9jZWxsJyksCiAgICAgICAgICAgICdjZWxsJzogc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2NlbGwnKQogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5zY3JlZW5fZGF0YToKICAgICAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAgICAgJ2lkJzogaW50KHNlbGYuc2NyZWVuX2RhdGEuZ2V0KCdpZCcsIDApKSwgCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc2VsZi5oYXNoX21hcFsnaWRfc2VyaWVzJ10sIAogICAgICAgICAgICAgICAgKipjb21tb25fcGFyYW1zCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGFyYW1zWydjZWxsJ10gPSBjb21tb25fcGFyYW1zWydpZF9jZWxsJ10gIAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICdiYXJjb2RlJzogc2VsZi5oYXNoX21hcC5nZXQoJ251bWJlcicpLAogICAgICAgICAgICAgICAgKipjb21tb25fcGFyYW1zCiAgICAgICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcmFtcwoKICAgIGRlZiBfY2hlY2tfc2VyaWVzX251bWJlcihzZWxmKSAtPiBkaWN0OgogICAgICAgIHNlcmllc19udW1iZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbnVtYmVyJykKICAgICAgICBzZWxmLnNlcnZpY2UucGFyYW1zID0gc2VsZi5fZ2V0X3BhcmFtcygpCiAgICAgICAgaWYgc2VyaWVzX251bWJlcjoKICAgICAgICAgICAgdmFsdWVzID0gc2VsZi5zZXJ2aWNlLmdldF9zZXJpZXNfYnlfYmFyY29kZShzZXJpZXNfbnVtYmVyLCB7fSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgcmV0dXJuIHsnaWQnOiB2YWx1ZXNbMF1bJ2lkJ10sICdpZF9zZXJpZXMnOiB2YWx1ZXNbMF1bJ2lkX3NlcmllcyddfQogICAgICAgIHJldHVybiBOb25lCgogICAgZGVmIF9hZGRfbmV3X3NlcmllcyhzZWxmLCBwYXJhbXM6IGRpY3QpOgogICAgICAgIHNlcmllc19udW1iZXIgPSBwYXJhbXMuZ2V0KCdudW1iZXInKQogICAgICAgIHNlbGYuc2VydmljZS5hZGRfbmV3X3Nlcmllc19pbl9kb2Nfc2VyaWVzX3RhYmxlKHNlcmllc19udW1iZXIpICAgICAgICAgICAgICAgCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBTZXJpZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBTZWxlY3RJdGVtU2NyZWVuID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZWxlY3RJdGVtU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VsZWN0SXRlbVByb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZWxlY3RJdGVtU2NyZWVuJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgdGFibGVfbmFtZSwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLmZpZWxkczogTGlzdFtzdHJdID0ga3dhcmdzLmdldCgnZmllbGRzJywgWyduYW1lJ10pCiAgICAgICAgc2VsZi5yZXN1bHRfbGlzdGVuZXIgPSBrd2FyZ3MuZ2V0KCdyZXN1bHRfbGlzdGVuZXInLCAnc2VsZWN0X3N1Y2Nlc3MnKQogICAgICAgIHNlbGYucmV0dXJuX3ZhbHVlX2tleSA9IGt3YXJncy5nZXQoJ3JldHVybl92YWx1ZV9rZXknLCAnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgc2VsZi50aXRsZSA9IGt3YXJncy5nZXQoJ3RpdGxlJywgJ9CS0YvQsdC+0YAg0LfQvdCw0YfQtdC90LjRjycpCgogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlbGVjdEl0ZW1TZXJ2aWNlKHNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi50aXRsZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnQ2FyZHNDbGljayc6IHNlbGYuX2NhcmRzX2NsaWNrLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5TZWxlY3RJdGVtU2VydmljZShzZWxmLnRhYmxlX25hbWUpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfc2VsZWN0X2RhdGEoKQogICAgICAgIGNhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ1NlbGVjdEl0ZW1TY3JlZW5faXRlbXNfY2FyZHMnXSA9IGNhcmRzLnRvX2pzb24oKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwWydTZXRSZXN1bHRMaXN0ZW5lciddID0gc2VsZi5yZXN1bHRfbGlzdGVuZXIKICAgICAgICBzZWxmLnNob3dfcHJvY2Vzc19yZXN1bHQoKQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBmaWVsZHNfdmlld3MgPSBbXQogICAgICAgIGZvciBmaWVsZCBpbiBzZWxmLmZpZWxkczoKICAgICAgICAgICAgZmllbGRzX3ZpZXdzLmFwcGVuZCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPWYnQHtmaWVsZH0nLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgKmZpZWxkc192aWV3cywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQogICAgICAgIHJldHVybiBjYXJkcwoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoc2VsZi5yZXR1cm5fdmFsdWVfa2V5LCBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKCksIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShzZWxmLnJldHVybl92YWx1ZV9rZXkpCiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ1NlbGVjdEl0ZW1TY3JlZW5faXRlbXNfY2FyZHMnKQogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCgoKY2xhc3MgU2hvd0l0ZW1zU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VsZWN0SXRlbVByb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTaG93SXRlbXNTY3JlZW4nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pbml0X3BhcmFtcyA9IFsndGl0bGUnLCAndGFibGVfZGF0YScsICd0YWJsZV9oZWFkZXInLCAnZW51bWVyYXRlJ10KICAgICAgICBzZWxmLmVudW1lcmF0ZT1UcnVlCiAgICAgICAgc2VsZi50YWJsZV9kYXRhID0gW10KICAgICAgICBzZWxmLmZpZWxkcyA9IFtdCiAgICAgICAgc2VsZi50YWJsZV9oZWFkZXIgPSB7fQogICAgICAgIHNlbGYudGV4dF9zaXplID0gMTUKICAgICAgICBzZWxmLmhlYWRlcl90ZXh0X3NpemUgPSAxNQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLmhhc2hfbWFwWyd0aXRsZSddIG9yICfQodC/0LjRgdC+0LonKQogICAgICAgIHNlbGYuZW51bWVyYXRlID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnZW51bWVyYXRlJykKICAgICAgICBzZWxmLnRhYmxlX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCd0YWJsZV9kYXRhJykKICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3RhYmxlX2hlYWRlcicpCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2RhdGE6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IgKCd0YWJsZV9kYXRhIG5vdCBpbml0aWFsaXplZCcpCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2hlYWRlcjoKICAgICAgICAgICAgc2VsZi50YWJsZV9oZWFkZXIgPSB7a2V5OiBrZXkgZm9yIGtleSBpbiBuZXh0KGl0ZXIoc2VsZi50YWJsZV9kYXRhKSkua2V5cygpfQoKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtc190YWJsZSddID0gc2VsZi5fZ2V0X3RhYmxlX3ZpZXcodGFibGVfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmKToKICAgICAgICBzZWxmLmZpZWxkcyA9IGxpc3Qoc2VsZi50YWJsZV9oZWFkZXIua2V5cygpKQogICAgICAgIHRhYmxlX2hlYWRlcl9sYXlvdXQgPSB7J19sYXlvdXQnOiBzZWxmLl9nZXRfdGFibGVfaGVhZGVyX3ZpZXcoKX0KCiAgICAgICAgaWYgc2VsZi5lbnVtZXJhdGU6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnsncG9zJzogJ04nfSwgKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0KICAgICAgICAgICAgdGFibGVfZGF0YSArPSBbZGljdCgqKnsncG9zJzogcG9zfSwgKipyb3cpIGZvciBwb3MsIHJvdyBpbiBlbnVtZXJhdGUoc2VsZi50YWJsZV9kYXRhLCBzdGFydD0xKV0KICAgICAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKICAgICAgICBlbHNlOgogICAgICAgICAgICB0YWJsZV9kYXRhID0gW2RpY3QoKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0gKyBzZWxmLnRhYmxlX2RhdGEKICAgICAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF90YWJsZV9oZWFkZXJfdmlldyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X2ZpZWxkc19sYXlvdXQoaXNfaGVhZGVyPVRydWUpCgogICAgZGVmIF9nZXRfZmllbGRzX2xheW91dChzZWxmLCBpc19oZWFkZXI9RmFsc2UsIGJhY2tncm91bmRfY29sb3I9JyNGQkU5RTcnLCB3ZWlnaHQ9MSk6CiAgICAgICAgaWYgaXNfaGVhZGVyOgogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gJyNGRkZGRkYnCiAgICAgICAgICAgIHRleHRfc2l6ZSA9IHNlbGYuaGVhZGVyX3RleHRfc2l6ZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRleHRfc2l6ZSA9IHNlbGYudGV4dF9zaXplCgogICAgICAgIGlmIG5vdCBzZWxmLnRhYmxlX2RhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBmaWVsZHNfbGF5b3V0ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj1iYWNrZ3JvdW5kX2NvbG9yLAogICAgICAgICkKCiAgICAgICAgaWYgc2VsZi5lbnVtZXJhdGU6CiAgICAgICAgICAgIHBvc19sYXlvdXQgPSBzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9J3BvcycsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpCiAgICAgICAgICAgIGZpZWxkc19sYXlvdXQuYXBwZW5kKHBvc19sYXlvdXQpCgogICAgICAgIGZpZWxkc19sYXlvdXQuYXBwZW5kKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICpbc2VsZi5fZ2V0X2NvbHVtbl92aWV3KHZhbHVlPWZpZWxkLCB0ZXh0X3NpemU9dGV4dF9zaXplLCB3ZWlnaHQ9d2VpZ2h0KSBmb3IgZmllbGQgaW4gc2VsZi5maWVsZHNdLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9OAogICAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZmllbGRzX2xheW91dAoKICAgIGRlZiBfZ2V0X2NvbHVtbl92aWV3KHNlbGYsIHZhbHVlLCB0ZXh0X3NpemU9MjAsIHdlaWdodD0xKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT1mJ0B7dmFsdWV9JywKICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXRleHRfc2l6ZSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIHdlaWdodD13ZWlnaHQsCiAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEsCiAgICAgICAgKQoKICAgIGRlZiBfZ2V0X3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X2ZpZWxkc19sYXlvdXQoKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldy50b19qc29uKCkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCmNsYXNzIFNob3dNYXJrc1NjcmVlbihTaG93SXRlbXNTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1NlbGVjdEl0ZW1Qcm9jZXNzJwogICAgc2NyZWVuX25hbWUgPSAnU2hvd01hcmtzU2NyZWVuJyAjINCV0YHRgtGMINCx0LDQsywg0L3QtSDRgNCw0LHQvtGC0LDQtdGCINC60L3QvtC/0LrQsCDQvdCw0LfQsNC0CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCB0YWJsZV9uYW1lLCAqKmt3YXJncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgdGFibGVfbmFtZSwgKiprd2FyZ3MpCiAgICAKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgc2VsZi5maWVsZHMgPSBsaXN0KHNlbGYudGFibGVfaGVhZGVyLmtleXMoKSkKICAgICAgICB0YWJsZV9oZWFkZXJfbGF5b3V0ID0geydfbGF5b3V0Jzogc2VsZi5fZ2V0X3RhYmxlX2hlYWRlcl92aWV3KCl9CgogICAgICAgIGlmIHNlbGYuZW51bWVyYXRlOgogICAgICAgICAgICB0YWJsZV9kYXRhID0gW2RpY3QoKip7J3Bvcyc6ICdOJ30sICoqeydpbWcnOiBOb25lfSwgKipzZWxmLnRhYmxlX2hlYWRlciwgKip0YWJsZV9oZWFkZXJfbGF5b3V0KV0KICAgICAgICAgICAgdGFibGVfZGF0YSArPSBbZGljdCgqKnsncG9zJzogcG9zfSwgKip7J2ltZyc6IHNlbGYuX2dldF9pbWFnZV9mb3Jfcm93KHJvdyl9LCAqKnJvdykgZm9yIHBvcywgcm93IGluIGVudW1lcmF0ZShzZWxmLnRhYmxlX2RhdGEsIHN0YXJ0PTEpXQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXSArIHNlbGYudGFibGVfZGF0YQogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfaW1hZ2VfZm9yX3JvdyhzZWxmLCByb3dfZGF0YSk6CiAgICAgICAgaWYgcm93X2RhdGEuZ2V0KCJhcHByb3ZlZCIpID09ICIxIjoKICAgICAgICAgICAgcmV0dXJuIHN0YXRpY19kYXRhLm1hcmtfZ3JlZW4KICAgICAgICBlbGlmIHJvd19kYXRhLmdldCgiYXBwcm92ZWQiKSA9PSAiMCI6CiAgICAgICAgICAgIHJldHVybiBzdGF0aWNfZGF0YS5tYXJrX3BpbmsKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfZ2V0X2ZpZWxkc19sYXlvdXQoc2VsZiwgaXNfaGVhZGVyPUZhbHNlLCBiYWNrZ3JvdW5kX2NvbG9yPScjRkZGRkZGJywgd2VpZ2h0PTEpOgogICAgICAgIGlmIGlzX2hlYWRlcjoKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgICAgICB0ZXh0X3NpemUgPSBzZWxmLmhlYWRlcl90ZXh0X3NpemUKICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZXh0X3NpemUgPSBzZWxmLnRleHRfc2l6ZQoKICAgICAgICB0ZXh0X3NpemUgPSBzZWxmLnRleHRfc2l6ZQoKICAgICAgICBmaWVsZHNfbGF5b3V0ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj1iYWNrZ3JvdW5kX2NvbG9yLAogICAgICAgICkKCiAgICAgICAgaWYgc2VsZi5lbnVtZXJhdGU6CiAgICAgICAgICAgIHBvc19sYXlvdXQgPSBzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9J3BvcycsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpCiAgICAgICAgICAgIGZpZWxkc19sYXlvdXQuYXBwZW5kKHBvc19sYXlvdXQpCgogICAgICAgICMg0JLRgdGC0LDQstC70Y/QtdC8INC40LfQvtCx0YDQsNC20LXQvdC40LUg0L/QvtGB0LvQtSDQutC+0LvQvtC90LrQuCAncG9zJyDQuCDQv9C10YDQtdC0INC+0YHRgtCw0LvRjNC90YvQvNC4INC60L7Qu9C+0L3QutCw0LzQuAogICAgICAgIGlmIG5vdCBpc19oZWFkZXI6CiAgICAgICAgICAgIGltZyA9ICdAaW1nJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGltZyA9IE5vbmUKICAgICAgICBpbWdfbGF5b3V0ID0gc2VsZi5fZ2V0X2ltYWdlX2NvbHVtbl92aWV3KHZhbHVlPWltZywgd2lkdGg9MTYsIGhlaWdodD0xMiwgd2VpZ2h0PTEpCiAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQoaW1nX2xheW91dCkKCiAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgKltzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9ZmllbGQsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpIGZvciBmaWVsZCBpbiBzZWxmLmZpZWxkc10sCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdlaWdodD04CiAgICAgICAgICAgICkKICAgICAgICApCgogICAgICAgIHJldHVybiBmaWVsZHNfbGF5b3V0CgogICAgZGVmIF9nZXRfaW1hZ2VfY29sdW1uX3ZpZXcoc2VsZiwgdmFsdWUsIHdpZHRoLCBoZWlnaHQsIHdlaWdodCk6CiAgICAgICAgcmV0dXJuIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlBpY3R1cmUoCiAgICAgICAgICAgICAgICBWYWx1ZT12YWx1ZSwKICAgICAgICAgICAgICAgIHdpZHRoPXdpZHRoLAogICAgICAgICAgICAgICAgaGVpZ2h0PWhlaWdodCwKICAgICAgICAgICAgICAgIHdlaWdodD13ZWlnaHQKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgd2VpZ2h0PXdlaWdodCwKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MSwKICAgICAgICApICAgICAgIAoKY2xhc3MgVGVzdFNjcmVlbihTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1Rlc3RQcm9jZXNzJwogICAgc2NyZWVuX25hbWUgPSAnVGVzdFNjcmVlbicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIAogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9zaG93X21hcmtzJzoKICAgICAgICAgICAgdGFibGVfZGF0YSA9IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibWFya19jb2RlIjogInNkZnNramRmaHNramRmaGtzamRmaHNkamZoIiwKICAgICAgICAgICAgICAgICAgICAiYXBwcm92ZWQiOiAiMSIKICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtYXJrX2NvZGUiOiAic2Rmc2tqZGZoc2tqZGZoa3NqZGZoc2RqZmgiLAogICAgICAgICAgICAgICAgICAgICJhcHByb3ZlZCI6ICIwIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibWFya19jb2RlIjogInNkZnNramRmaHNramRmaGtzamRmaHNkamZoIiwKICAgICAgICAgICAgICAgICAgICAiYXBwcm92ZWQiOiAiMSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIm1hcmtfY29kZSI6ICJzZGZza2pkZmhza2pkZmhrc2pkZmhzZGpmaCIsCiAgICAgICAgICAgICAgICAgICAgImFwcHJvdmVkIjogIjEiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJtYXJrX2NvZGUiOiAic2Rmc2tqZGZoc2tqZGZoa3NqZGZoc2RqZmgiLAogICAgICAgICAgICAgICAgICAgICJhcHByb3ZlZCI6ICIwIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXQoKICAgICAgICAgICAgc2NyZWVuX2FyZ3MgPSB7CiAgICAgICAgICAgICAgICAndGl0bGUnOiAn0JzQsNGA0LrQuCDRgtC+0LLQsNGA0LAnLAogICAgICAgICAgICAgICAgJ3RhYmxlX2RhdGEnOiBqc29uLmR1bXBzKHRhYmxlX2RhdGEpLAogICAgICAgICAgICAgICAgJ3RhYmxlX2hlYWRlcic6IGpzb24uZHVtcHMoeydtYXJrX2NvZGUnOiAn0JzQsNGA0LrQsCd9KSwKICAgICAgICAgICAgICAgICdlbnVtZXJhdGUnOiBUcnVlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgU2hvd01hcmtzU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX2FyZ3MpCiAgICAKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gU2VsZWN0SXRlbVNjcmVlbiBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKCiMgPT09PT09PT09PT09PT09PT09PT0gU2V0dGluZ3MgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNldHRpbmdzU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gZGJfc2VydmljZXMuRG9jU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNldHRpbmdzX2tleXMgPSBbCiAgICAgICAgICAgICd1c2VfbWFyaycsCiAgICAgICAgICAgICdhbGxvd19mYWN0X2lucHV0JywKICAgICAgICAgICAgJ2FkZF9pZl9ub3RfaW5fcGxhbicsCiAgICAgICAgICAgICdwYXRoJywKICAgICAgICAgICAgJ2FsbG93X292ZXJzY2FuJywKICAgICAgICAgICAgJ29mZmxpbmVfbW9kZScKICAgICAgICBdCgogICAgICAgIHB1dF9kYXRhID0ge2tleTogc2VsZi5yc19zZXR0aW5ncy5nZXQoa2V5KSBmb3Iga2V5IGluIHNldHRpbmdzX2tleXN9CiAgICAgICAgcHV0X2RhdGFbJ2lwX2FkciddID0gc2VsZi5fZ2V0X2lwX2FkZHJlc3MoKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLl91cGRhdGVfcnNfc2V0dGluZ3MoKQoKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5faHR0cF9zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCBodHRwINGB0L7QtdC00LjQvdC10L3QuNGPJyksCiAgICAgICAgICAgICdidG5fc2l6ZSc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQqNGA0LjRhNGC0L7QsicpLAogICAgICAgICAgICAnYnRuX3NvdW5kX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutCwINC30LLRg9C60LAnKSwKICAgICAgICAgICAgJ2J0bl9kb2N1bWVudHNfc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0LTQvtC60YPQvNC10L3RgtC+0LInKSwKICAgICAgICAgICAgJ2J0bl9vY3JfcmVjb2duaXRpb25fc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuaGFzaF9tYXAucHV0KCdTdGFydFByb2Nlc3MnLCAnT2NyVGV4dFJlY29nbml0aW9uJyksCiAgICAgICAgICAgICdidG5fcHJpbnRfc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuaGFzaF9tYXAucHV0KCdTdGFydFByb2Nlc3MnLCAn0J/QtdGH0LDRgtGMJyksCiAgICAgICAgICAgICdidG5fdGVzdF9iYXJjb2RlJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0KLQtdGB0YIg0YHQutCw0L3QtdGA0LAnKSwKICAgICAgICAgICAgJ2J0bl9lcnJfbG9nJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J7RiNC40LHQutC4JyksCiAgICAgICAgICAgICdidG5fdXBsb2FkX2RvY3MnOiBzZWxmLl91cGxvYWRfZG9jcywKICAgICAgICAgICAgJ2J0bl90aW1lcic6IHNlbGYuX2xvYWRfZG9jcywKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJyksCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3VwbG9hZF9kb2NzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgdGltZXIgPSBUaW1lcihzZWxmLmhhc2hfbWFwKQogICAgICAgICAgICB0aW1lci51cGxvYWRfZGF0YSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtSDQt9Cw0LTQsNC90Ysg0L3QsNGB0YLRgNC+0LnQutC4INGB0L7QtdC00LjQvdC10L3QuNGPJykKCiAgICBkZWYgX2xvYWRfZG9jcyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHRpbWVyID0gVGltZXIoc2VsZi5oYXNoX21hcCkKICAgICAgICAgICAgdGltZXIudGltZXJfb25fc3RhcnQoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LUg0LfQsNC00LDQvdGLINC90LDRgdGC0YDQvtC50LrQuCDRgdC+0LXQtNC40L3QtdC90LjRjycpCgogICAgZGVmIF91cGRhdGVfcnNfc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICB1c2VfbWFyayA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2VfbWFyaycpIG9yICdmYWxzZScKICAgICAgICBwYXRoID0gc2VsZi5oYXNoX21hcC5nZXQoJ3BhdGgnKSBvciAnLy9zdG9yYWdlL2VtdWxhdGVkLzAvQW5kcm9pZC9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpLycKICAgICAgICBhbGxvd19mYWN0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnYWxsb3dfZmFjdF9pbnB1dCcpIG9yIEZhbHNlCiAgICAgICAgb2ZmbGluZV9tb2RlID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnb2ZmbGluZV9tb2RlJykgb3IgRmFsc2UKCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3VzZV9tYXJrJywgdXNlX21hcmssIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3BhdGgnLCBwYXRoLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdhbGxvd19mYWN0X2lucHV0JywgYWxsb3dfZmFjdF9pbnB1dCwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnb2ZmbGluZV9tb2RlJywgb2ZmbGluZV9tb2RlLCBUcnVlKQoKICAgIGRlZiBfc2hvd19zY3JlZW4oc2VsZiwgc2NyZWVuX25hbWUpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzY3JlZW5fbmFtZSkKCiAgICBkZWYgX2dldF9odHRwX3NldHRpbmdzKHNlbGYpIC0+IGRpY3Q6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF9pcF9hZGRyZXNzKCkgLT4gc3RyOgogICAgICAgIHJlcyA9IGdldF9pcF9hZGRyZXNzKCkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXMKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJ9C90LXRgiDRgdC10YLQuCcKCiAgICBkZWYgX2NoZWNrX2h0dHBfc2V0dGluZ3Moc2VsZikgLT4gYm9vbDoKICAgICAgICBodHRwID0gc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKQogICAgICAgIHJldHVybiBhbGwoW2h0dHAuZ2V0KCd1cmwnKSwgaHR0cC5nZXQoJ3VzZXInKSwgaHR0cC5nZXQoJ3Bhc3MnKV0pCgoKY2xhc3MgRm9udFNpemVTZXR0aW5nc1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INCo0YDQuNGE0YLQvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcHV0X2RhdGEgPSB7fQogICAgICAgIGZpZWxkc19kYXRhID0gewogICAgICAgICAgICAnVGl0bGVUZXh0U2l6ZSc6ICfQoNCw0LfQvNC10YAg0LfQsNCz0L7Qu9C+0LLQutCwJywKICAgICAgICAgICAgJ0NhcmRUaXRsZVRleHRTaXplJzogJ9Cg0LDQt9C80LXRgCDQt9Cw0LPQvtC70L7QstC60LAg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICAgICAgICAgICJDYXJkRGF0ZVRleHRTaXplIjogJ9CU0LDQvdC90YvQtSDQutCw0YDRgtC+0YfQutC4JywKICAgICAgICAgICAgJ0NhcmRUZXh0U2l6ZSc6ICfQoNCw0LfQvNC10YAg0YLQtdC60YHRgtCwINGN0LvQtdC80LXQvdGC0L7QsicsCiAgICAgICAgICAgICdHb29kc0NhcmRUaXRsZVRleHRTaXplJzogJ9CX0LDQs9C+0LvQvtCy0L7QuiDRgtC+0LLQsNGA0LAnLAogICAgICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6ICfQotC+0LLQsNGAJywKICAgICAgICAgICAgJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSc6ICfQodC10YDQuNC4INGB0LLQvtC50YHRgtCy0LAnLAogICAgICAgICAgICAnRG9jVHlwZUNhcmRUZXh0U2l6ZSc6ICfQotC40L8g0LTQvtC60YPQvNC10L3RgtCwJywKICAgICAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6ICfQndCw0LfQstCw0L3QuNC1INC00L7QutGD0LzQtdC90YLQsCDQsiDQutCw0YDRgtC+0YfQutC1JwogICAgICAgIH0KCiAgICAgICAgZm9yIGZpZWxkLCBoaW50IGluIGZpZWxkc19kYXRhLml0ZW1zKCk6CiAgICAgICAgICAgIHB1dF9kYXRhW2ZpZWxkXSA9IHdpZGdldHMuTW9kZXJuRmllbGQoCiAgICAgICAgICAgICAgICBoaW50PWhpbnQsCiAgICAgICAgICAgICAgICBkZWZhdWx0X3RleHQ9c2VsZi5yc19zZXR0aW5ncy5nZXQoZmllbGQpIG9yICcnCiAgICAgICAgICAgICkudG9fanNvbigpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9vbl9zYXZlJzoKICAgICAgICAgICAgc2F2ZV9kYXRhID0gewogICAgICAgICAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydUaXRsZVRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydDYXJkVGl0bGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0NhcmRUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ0NhcmRUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0NhcmREYXRlVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydDYXJkRGF0ZVRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdnb29kc1RleHRTaXplJzogc2VsZi5oYXNoX21hcFsnZ29vZHNUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydEb2NUeXBlQ2FyZFRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJzogc2VsZi5oYXNoX21hcFsndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJ10sCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvciBrLCB2IGluIHNhdmVfZGF0YS5pdGVtcygpOgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoaywgdiwgVHJ1ZSkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fb25fY2FuY2VsJyBvciBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnQmFja1NjcmVlbicsICcnKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydub1JlZnJlc2gnXSA9ICcnCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKCmNsYXNzIEJhcmNvZGVUZXN0U2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC10YHRgiDRgdC60LDQvdC10YDQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYmFyY29kZSc6IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgICAgICAnQkFDS19CVVRUT04nOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICB9CgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdCYWNrU2NyZWVuJywgJycpCgogICAgZGVmIF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCiAgICAgICAgaWYgbm90IGJhcmNvZGU6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBiYXJjb2RlX3BhcnNlciA9IEJhcmNvZGVXb3JrZXIoaWRfZG9jPScnKQogICAgICAgIHJlc3VsdCA9IGJhcmNvZGVfcGFyc2VyLnBhcnNlKGJhcmNvZGUpCiAgICAgICAgZmllbGRzX2NvdW50ID0gNwoKICAgICAgICBrZXlzX2xpc3QgPSBbJ0VSUk9SJywgJ0dUSU4nLCAnU0VSSUFMJywgJ0Z1bGxDb2RlJywgJ0JBUkNPREUnLCAnU0NIRU1FJywgJ0VYUElSWScsICdCQVRDSCcsICdOSFJOJywgJ0NIRUNLJywKICAgICAgICAgICAgICAgICAgICAgJ1dFSUdIVCcsICdQUE4nXQoKICAgICAgICB2YWx1ZXMgPSBbZid7a2V5fToge3Jlc3VsdFtrZXldfScgZm9yIGtleSBpbiBrZXlzX2xpc3QgaWYgcmVzdWx0LmdldChrZXkpIGlzIG5vdCBOb25lXQoKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgZidmbGRfe2kgKyAxfSc6IHZhbHVlc1tpXSBpZiBsZW4odmFsdWVzKSA+IGkgZWxzZSAnJwogICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBmaWVsZHNfY291bnQpCiAgICAgICAgfQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKCmNsYXNzIEh0dHBTZXR0aW5nc1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4IGh0dHAg0YHQvtC10LTQuNC90LXQvdC40Y8nCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IE5vbmUKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzZWxmLmhhc2hfbWFwWydidG5fdGVzdF9jb25uZWN0aW9uJ10gPSAn0KLQtdGB0YIg0YHQvtC10LTQuNC90LXQvdC40Y8nCiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKCiAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9CQ0LTRgNC10YEg0YHQtdGA0LLQtdGA0LAnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXJsJ10gb3IgJycpLAogICAgICAgICAgICAndXNlcic6IHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0n0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VzZXInXSBvciAnJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSfQn9Cw0YDQvtC70YwnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sncGFzcyddIG9yICcnLCBwYXNzd29yZD1UcnVlKSwKICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0n0JLQsNGI0LUg0LjQvNGPINC00LvRjyDQuNC00LXQvdGC0LjRhNC40LrQsNGG0LjQuCDQsiAx0KEnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXNlcl9uYW1lJ10gb3IgJycpLAogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2J0bl90ZXN0X2Nvbm5lY3Rpb24nOiBzZWxmLl90ZXN0X2Nvbm5lY3Rpb24sCiAgICAgICAgICAgICdidG5fc2F2ZSc6IHNlbGYuX3NhdmVfc2V0dGluZ3MsCiAgICAgICAgICAgICdiYXJjb2RlJzogc2VsZi5fYmFyY29kZV9zY2FubmVkLAogICAgICAgICAgICAnYnRuX2NhbmNlbCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3Rlc3RfY29ubmVjdGlvbihzZWxmKToKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKSkKCiAgICAgICAgaWYgc2VsZi5fY2hlY2tfaHR0cF9zZXR0aW5ncygpOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MykKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi5oc19zZXJ2aWNlLmh0dHBfYW5zd2VyCgogICAgICAgICAgICBpZiByZXN1bHQudW5hdXRob3JpemVkOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINCw0LLRgtC+0YDQuNC30LDRhtC40Lgg0YHQtdGA0LLQtdGA0LAgMdChJykKICAgICAgICAgICAgZWxpZiByZXN1bHQuZm9yYmlkZGVuOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JfQsNC/0YDQvtGBINC90LAg0LDQstGC0L7RgNC40LfQsNGG0LjRjiDQv9GA0LjQvdGP0YInKQogICAgICAgICAgICBlbGlmIHJlc3VsdC5lcnJvcjoKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0YPRgdGC0LDQvdC+0LLQuNGC0Ywg0YHQvtC10LTQuNC90LXQvdC40LUnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGD0YHRgtCw0L3QvtCy0LvQtdC90L4nKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3N1Y2Nlc3MnKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCLQndC1INGD0LrQsNC30LDQvdGLINC90LDRgdGC0YDQvtC50LrQuCBIVFRQINC/0L7QtNC60LvRjtGH0LXQvdC40Y8g0Log0YHQtdGA0LLQtdGA0YMiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQoKICAgIGRlZiBfc2F2ZV9zZXR0aW5ncyhzZWxmKToKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnVVJMJywgc2VsZi5oYXNoX21hcFsndXJsJ10sIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VTRVInLCBzZWxmLmhhc2hfbWFwWyd1c2VyJ10sIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1BBU1MnLCBzZWxmLmhhc2hfbWFwWydwYXNzJ10sIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3VzZXJfbmFtZScsIHNlbGYuaGFzaF9tYXBbJ3VzZXJfbmFtZSddLCBUcnVlKQoKICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCgogICAgZGVmIF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYTInKQogICAgICAgIHRyeToKICAgICAgICAgICAgYmFyY19zdHJ1Y3QgPSBqc29uLmxvYWRzKGJhcmNvZGUpCgogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnVVJMJywgYmFyY19zdHJ1Y3QuZ2V0KCd1cmwnKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VTRVInLCBiYXJjX3N0cnVjdC5nZXQoJ3VzZXInKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1BBU1MnLCBiYXJjX3N0cnVjdC5nZXQoJ3Bhc3MnKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3VzZXJfbmFtZScsIGJhcmNfc3RydWN0LmdldCgndXNlcl9uYW1lJyksIFRydWUpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndXJsJywgc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSd1cmwnLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCd1cmwnKSkpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd1c2VyJywgc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSd1c2VyJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgndXNlcicpKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Bhc3MnLCBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J3Bhc3MnLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCdwYXNzJykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndXNlcl9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSd1c2VyX25hbWUnLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCd1c2VyX25hbWUnKSkpCiAgICAgICAgZXhjZXB0IChKU09ORGVjb2RlRXJyb3IsIEF0dHJpYnV0ZUVycm9yKSBhcyBlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC10LLQtdGA0L3Ri9C5INGE0L7RgNC80LDRgiBRUi3QutC+0LTQsCcpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnQmFja1NjcmVlbicsICcnKQoKICAgIGRlZiBfZ2V0X21vZGVybl9maWVsZChzZWxmLCAqKmRhdGEpOgogICAgICAgIHJldHVybiB3aWRnZXRzLk1vZGVybkZpZWxkKCoqZGF0YSkudG9fanNvbigpCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKICAgIGRlZiBfZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCgpjbGFzcyBTb3VuZFNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60LAg0LfQstGD0LrQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5ldmVudHMgPSB7J3N1Y2Nlc3MnOiAn0KHQuNCz0L3QsNC7INGD0LTQsNGH0L3QvtCz0L4g0YHQvtCx0YvRgtC40Y8nLCAnd2FybmluZyc6ICfQodC40LPQvdCw0Lsg0L/RgNC10LTRg9C/0YDQtdC20LTQtdC90LjRjycsCiAgICAgICAgICAgICAgICAgICAgICAgJ2Vycm9yJzogJ9Ch0LjQs9C90LDQuyDQvtGI0LjQsdC60LgnfQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl9pbml0X3NvdW5kcygpCiAgICAgICAgZXZlbnRzX2RhdGEgPSBzZWxmLl9nZXRfZXZlbnRzX2RhdGEoKQogICAgICAgIGV2ZW50c19jYXJkcyA9IHNlbGYuX2dldF9ldmVudF9jYXJkc192aWV3KGV2ZW50c19kYXRhLCBwb3B1cF9tZW51X2RhdGE9JzE7MjszOzQ7NTs2Ozc7ODs5OzEwOzExOzEyOzEzOzE0OzE1JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXZlbnRfY2FyZHMnLCBldmVudHNfY2FyZHMudG9fanNvbigpKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdzYXZlX2J0bic6CiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdzdWNjZXNzX3NpZ25hbCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCJjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsIiksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd3YXJuaW5nX3NpZ25hbCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCJjdXJyZW50X3dhcm5pbmdfc2lnbmFsIiksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdlcnJvcl9zaWduYWwnLCBzZWxmLmhhc2hfbWFwLmdldCgiY3VycmVudF9lcnJvcl9zaWduYWwiKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgICAgICAgICAjIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9vbl9jYW5jZWwnIG9yIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3dhcm5pbmdfc2lnbmFsJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2Vycm9yX3NpZ25hbCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIHNlbGVjdGVkX2V2ZW50ID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoZXZlbnQ9c2VsZWN0ZWRfZXZlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdW5kX3ZhbD1zZWxmLmhhc2hfbWFwLmdldChmJ2N1cnJlbnRfe3NlbGVjdGVkX2V2ZW50fV9zaWduYWwnKSkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgICAgICBzZWxmLl9sYXlvdXRfYWN0aW9uKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9pbml0X3NvdW5kcyhzZWxmKToKICAgICAgICAjIGZvciBrZXksIHZhbCBpbiBzZWxmLmV2ZW50cy5pdGVtcygpOgogICAgICAgICMgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldChmJ2N1cnJlbnRfe2tleX1fc2lnbmFsJyk6CiAgICAgICAgIyAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYnY3VycmVudF97a2V5fV9zaWduYWwnLCBzZWxmLnJzX3NldHRpbmdzLmdldChmJ3tldmVudH1fc2lnbmFsJyBvciAiNiIpKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfc3VjY2Vzc19zaWduYWwnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfc3VjY2Vzc19zaWduYWwnLCBzZWxmLnJzX3NldHRpbmdzLmdldCgnc3VjY2Vzc19zaWduYWwnKSkKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfd2FybmluZ19zaWduYWwnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfd2FybmluZ19zaWduYWwnLCBzZWxmLnJzX3NldHRpbmdzLmdldCgnd2FybmluZ19zaWduYWwnKSkKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZXJyb3Jfc2lnbmFsJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2Vycm9yX3NpZ25hbCcsIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdlcnJvcl9zaWduYWwnKSkKCiAgICBkZWYgX2dldF9ldmVudHNfZGF0YShzZWxmKToKICAgICAgICBkYXRhID0gW10KICAgICAgICBmb3Iga2V5LCB2YWwgaW4gc2VsZi5ldmVudHMuaXRlbXMoKToKICAgICAgICAgICAgZXZlbnQgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzoga2V5LAogICAgICAgICAgICAgICAgJ2V2ZW50X25hbWUnOiB2YWwsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfdmFsdWUnOiBzZWxmLmhhc2hfbWFwLmdldChmJ2N1cnJlbnRfe2tleX1fc2lnbmFsJykKICAgICAgICAgICAgfQogICAgICAgICAgICBkYXRhLmFwcGVuZChldmVudCkKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfZ2V0X2V2ZW50X2NhcmRzX3ZpZXcoc2VsZiwgZXZlbnRzX2RhdGEsIHBvcHVwX21lbnVfZGF0YSk6CiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIkNhcmRUaXRsZVRleHRTaXplIikKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZXZlbnRfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHNlbGVjdGVkX3ZhbHVlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MjgsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlBvcHVwTWVudUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9cG9wdXBfbWVudV9kYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9zZWxlY3Rfc291bmQiLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0i0J/RgNC+0YHQu9GD0YjQsNGC0YwiLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgIGdyYXZpdHlfdmVydGljYWw9ImNlbnRlciIsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWV2ZW50c19kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9sYXlvdXRfYWN0aW9uKHNlbGYpOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgIGN1cnJlbnRfa2V5ID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIilbJ2tleSddCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoZidjdXJyZW50X3tjdXJyZW50X2tleX1fc2lnbmFsJywgbGF5b3V0X2xpc3RlbmVyKQoKCmNsYXNzIERvY3VtZW50c1NldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0LTQvtC60YPQvNC10L3RgtC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5jb250YWluc0tleSgnZG9jX3NldHRpbmdzX29uX3N0YXJ0Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkb2Nfc2V0dGluZ3Nfb25fc3RhcnQnLCAndHJ1ZScpCiAgICAgICAgICAgIHNlbGYuX2luaXRfb2xkX2RvY19kZWxldGVfc2V0dGluZ3MoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdzYXZlX2J0bic6CiAgICAgICAgICAgIGRlbF9kb2NzX2ZsYWcgPSBzZWxmLmhhc2hfbWFwLmdldCgnZG9jX3NldHRpbmdzX2NvbmZpcm1fZGVsZXRlX29sZF9kb2NzJykKICAgICAgICAgICAgZGVsX2RvY3NfZmxhZyA9IFRydWUgaWYgZGVsX2RvY3NfZmxhZyA9PSAndHJ1ZScgZWxzZSBGYWxzZQogICAgICAgICAgICBpZiBub3QgZGVsX2RvY3NfZmxhZzoKICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkZWxldGVfb2xkX2RvY3MnLCBGYWxzZSwgVHJ1ZSkKICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MuZGVsZXRlKCdkb2NfZGVsZXRlX3NldHRpbmdzX2RheXMnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZGF5cyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdkb2NfZGVsZXRlX3NldHRpbmdzX2RheXMnKQogICAgICAgICAgICAgICAgaWYgbm90IGRheXMgb3IgZGF5cyA9PSAnMCcgb3Igbm90IGRheXMuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KPQutCw0LbQuNGC0LUg0LrQvtGA0YDQtdC60YLQvdC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LTQvdC10LknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnINC00LvRjyDQvdCw0YHRgtGA0L7QudC60Lgg0YPQtNCw0LvQtdC90LjRjyDRgdGC0LDRgNGL0YUg0LTQvtC60YPQvNC10L3RgtC+0LInKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgaWYgZGF5cyA+PSAnOTk5OSc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQmtC+0LvQuNGH0LXRgdGC0LLQviDQtNC90LXQuSDQv9GA0LXQstGL0YjQsNC10YIgOTk5OScpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZGVsZXRlX29sZF9kb2NzJywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkb2NfZGVsZXRlX3NldHRpbmdzX2RheXMnLCBkYXlzLCBUcnVlKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QsNGB0YLRgNC+0LnQutC4INGB0L7RhdGA0LDQvdC10L3RiycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdkb2Nfc2V0dGluZ3Nfb25fc3RhcnQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ2RvY19zZXR0aW5nc19vbl9zdGFydCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9pbml0X29sZF9kb2NfZGVsZXRlX3NldHRpbmdzKHNlbGYpOgogICAgICAgIGN1cnJlbnRfZGF5c192YWx1ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkb2NfZGVsZXRlX3NldHRpbmdzX2RheXMnKQogICAgICAgIGluaXRfZGF5cyA9IHN0cihjdXJyZW50X2RheXNfdmFsdWUpIGlmIGN1cnJlbnRfZGF5c192YWx1ZSBpcyBub3QgTm9uZSBlbHNlICcxJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkb2NfZGVsZXRlX3NldHRpbmdzX2RheXMnLCBpbml0X2RheXMpCgogICAgICAgIGZsYWcgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnZGVsZXRlX29sZF9kb2NzJykKICAgICAgICBpbml0X2ZsYWcgPSBzdHIoZmxhZykubG93ZXIoKSBpZiBmbGFnIGlzIG5vdCBOb25lIGVsc2UgJ2ZhbHNlJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkb2Nfc2V0dGluZ3NfY29uZmlybV9kZWxldGVfb2xkX2RvY3MnLCBpbml0X2ZsYWcpCgoKY2xhc3MgRXJyb3JMb2dTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ce0YjQuNCx0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gRXJyb3JTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIGRhdGVfc29ydCA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RhdGVfc29ydCddCiAgICAgICAgZXJyb3JzX3RhYmxlX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9lcnJvcnMoZGF0ZV9zb3J0KQogICAgICAgIHRhYmxlX3Jhd3MgPSBzZWxmLl9nZXRfZXJyb3JzX3RhYmxlX3Jvd3MoZXJyb3JzX3RhYmxlX2RhdGEpCiAgICAgICAgdGFibGVfdmlldyA9IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfdmlldyh0YWJsZV9yYXdzKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJlcnJvcl9sb2dfdGFibGUiLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydkYXRlX3NvcnRfc2VsZWN0J10gPSAn0J3QvtCy0YvQtTtD0YLQsNGA0YvQtScKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAiYnRuX2NsZWFyX2VyciI6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS5jbGVhcigpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dTY3JlZW4iLCAi0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0iKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gImRhdGVfc29ydF9jbGljayI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RhdGVfc29ydCddID0gc2VsZi5oYXNoX21hcFsiZGF0ZV9zb3J0X2NsaWNrIl0KCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUsIGFyZ3MpCgogICAgZGVmIF9nZXRfZXJyb3JzX3RhYmxlX3Jvd3Moc2VsZiwgZXJyb3JzX3RhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgaSA9IDEKICAgICAgICBmb3IgcmVjb3JkIGluIGVycm9yc190YWJsZV9kYXRhOgogICAgICAgICAgICBlcnJvcl9yb3cgPSB7ImtleSI6IGksICJtZXNzYWdlIjogcmVjb3JkWzBdLCAidGltZSI6IHJlY29yZFsxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICdfbGF5b3V0Jzogc2VsZi5fZ2V0X2Vycm9yc190YWJsZV9yb3dfbGF5b3V0KCl9CiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKGVycm9yX3JvdykKICAgICAgICAgICAgaSArPSAxCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZXJyb3JzX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfcm93cyk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0JLRgNC10LzRjycpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KHQvtC+0LHRidC10L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTMKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfcm93cwogICAgICAgICkKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2Vycm9yc190YWJsZV9yb3dfbGF5b3V0KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHRpbWUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTAKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbWVzc2FnZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MywKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJywKICAgICAgICAgICAgaGVpZ2h0PSd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBjbGFzcyBMaW5lYXJMYXlvdXQod2lkZ2V0cy5MaW5lYXJMYXlvdXQpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCphcmdzLCAqKmt3YXJncykKICAgICAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICd2ZXJ0aWNhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IERlYnVnIHNldHRpbmdzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgRGVidWdTZXR0aW5nc1NjcmVlbihTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ9Ce0YLQu9Cw0LTQutCwJwogICAgc2NyZWVuX25hbWUgPSAn0J7RgtC70LDQtNC+0YfQvdGL0Lkg0Y3QutGA0LDQvScKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5EZWJ1Z1NlcnZpY2UKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgZGVidWdfaG9zdF9pcCA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZWJ1Z19ob3N0X2lwJykgb3Igc2VsZi5oYXNoX21hcFsnaXBfaG9zdCddCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICdpcF9ob3N0JywKICAgICAgICAgICAgeydoaW50JzogJ0lQLdCw0LTRgNC10YEg0LTQu9GPINCy0YvQs9GA0YPQt9C60Lgg0LHQsNC30Ysv0LvQvtCz0LAnLCAnZGVmYXVsdF90ZXh0JzogZGVidWdfaG9zdF9pcCBvciAnJ30sCiAgICAgICAgICAgIHRvX2pzb249VHJ1ZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX2ZpbGxfcmF0aW8nOiBzZWxmLl9maWxsX3JhdGlvLAogICAgICAgICAgICAnYnRuX2NvcHlfYmFzZSc6IHNlbGYuX2NvcHlfYmFzZSwKICAgICAgICAgICAgJ2J0bl91bmxvYWRfbG9nJzogc2VsZi5fdW5sb2FkX2xvZywKICAgICAgICAgICAgJ2J0bl90ZW1wbGF0ZXMnOiBzZWxmLm9wZW5fdGVtcGxhdGVzX3NjcmVlbiwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX29uX2JhY2tfcHJlc3NlZAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9maWxsX3JhdGlvKHNlbGYpOgogICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgVVBEQVRFIFJTX2JhcmNvZGVzCiAgICAgICAgU0VUIHJhdGlvID0gQ09BTEVTQ0UoKAogICAgICAgICAgICBTRUxFQ1QgUlNfdW5pdHMubm9taW5hdG9yIC8gUlNfdW5pdHMuZGVub21pbmF0b3IKICAgICAgICAgICAgRlJPTSBSU191bml0cwogICAgICAgICAgICBXSEVSRSBSU191bml0cy5pZCA9IFJTX2JhcmNvZGVzLmlkX3VuaXQKICAgICAgICApLCAxKScnJwoKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQotCw0LHQu9C40YbQsCDQsdCw0YDQutC+0LTQvtCyINC30LDQv9C+0LvQvdC10L3QsCDQt9C90LDRh9C10L3QuNGP0LzQuCDQuNC3INC10LTQuNC90LjRhiDQuNC30LzQtdGA0LXQvdC40Y8nKQoKICAgIGRlZiBfY29weV9iYXNlKHNlbGYpOgogICAgICAgIGlwX2hvc3QgPSBzZWxmLmhhc2hfbWFwWydpcF9ob3N0J10KICAgICAgICBwYXRoX3RvX2RhdGFiYXNlcyA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdwYXRoX3RvX2RhdGFiYXNlcycpCiAgICAgICAgYmFzZV9uYW1lID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3NxbGl0ZV9uYW1lJykKICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocGF0aF90b19kYXRhYmFzZXMsIGJhc2VfbmFtZSkKCiAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoZmlsZV9wYXRoKToKICAgICAgICAgICAgd2l0aCBvcGVuKGZpbGVfcGF0aCwgJ3JiJykgYXMgZjoKICAgICAgICAgICAgICAgIHJlcyA9IHNlbGYuaHNfc2VydmljZShpcF9ob3N0KS5leHBvcnRfZGF0YWJhc2UoZikKCiAgICAgICAgICAgICAgICBpZiByZXNbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CR0LDQt9CwIFNRTGl0ZSDRg9GB0L/QtdGI0L3QviDQstGL0LPRgNGD0LbQtdC90LAnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ck0LDQudC7INC90LUg0L3QsNC50LTQtdC9JykKCiAgICBkZWYgX3VubG9hZF9sb2coc2VsZik6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQoKICAgICAgICBwYXRoX3RvX2RhdGFiYXNlcyA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdwYXRoX3RvX2RhdGFiYXNlcycpCiAgICAgICAgYmFzZV9uYW1lID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2xvZ19uYW1lJykKICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocGF0aF90b19kYXRhYmFzZXMsIGJhc2VfbmFtZSkKCiAgICAgICAgIyBUT0RPINCX0LTQtdGB0Ywg0L3Rg9C20L3QviDQsdGD0LTQtdGCINCy0YvQt9GL0LLQsNGC0Ywg0LrQu9Cw0YHRgS3RgdC10YDQstC40YEg0LTQu9GPINCy0LfQsNC40LzQvtC00LXQudGB0YLQstC40Y8g0YEgVGlueURCCiAgICAgICAgZnJvbSB0aW55ZGIgaW1wb3J0IFRpbnlEQgoKICAgICAgICBkYiA9IFRpbnlEQihmaWxlX3BhdGgpCiAgICAgICAgZGF0YSA9IGRiLmFsbCgpCgogICAgICAgIHJlcyA9IHNlbGYuaHNfc2VydmljZShpcF9ob3N0KS5leHBvcnRfbG9nKGRhdGEpCiAgICAgICAgaWYgcmVzWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JvQvtCzINGD0YHQv9C10YjQvdC+INCy0YvQs9GA0YPQttC10L0nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjycpCiAgICBkZWYgX29uX2JhY2tfcHJlc3NlZChzZWxmKToKICAgICAgICBpcF9ob3N0ID0gc2VsZi5oYXNoX21hcFsnaXBfaG9zdCddCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RlYnVnX2hvc3RfaXAnLCBpcF9ob3N0LCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZGVmIG9wZW5fdGVtcGxhdGVzX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ9Cf0LXRh9Cw0YLRjCcsICfQodC/0LjRgdC+0Log0YjQsNCx0LvQvtC90L7QsicpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gRGVidWcgc2V0dGluZ3MgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBBY3RpdmVDViA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0L7QstGL0Lkg0YjQsNCzIEFjdGl2ZUNWJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7QsicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmlkX2RvYyA9IHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gRG9jU2VydmljZShzZWxmLmlkX2RvYykKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICBzZWxmLl9zZXRfdmlzaW9uX3NldHRpbmdzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYXJ0X2luZm8nLCAn0J3QsNC50LTQtdC90L3Ri9C1INCw0YDRgtC40LrRg9C70Ys6ICcpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ9Ce0LHRgNCw0LHQvtGC0LDRgtGMJzoKICAgICAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLnB1dCgnYnV0dG9uX21hbmFnZV9hcnRpY2xlcycsIFRydWUsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBvbl9vYmplY3RfZGV0ZWN0ZWQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCkKICAgICAgICBjdXJyZW50X29iamVjdCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X29iamVjdCcpCiAgICAgICAgZmluZGVkX2FydGljbGVzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICBmaW5kZWRfYXJ0aWNsZXMgPSBqc29uLmxvYWRzKGZpbmRlZF9hcnRpY2xlcykgaWYgZmluZGVkX2FydGljbGVzIGVsc2UgW10KICAgICAgICBpZiBjdXJyZW50X29iamVjdCBub3QgaW4gZmluZGVkX2FydGljbGVzOgogICAgICAgICAgICBmaW5kZWRfYXJ0aWNsZXMuYXBwZW5kKGN1cnJlbnRfb2JqZWN0KQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgKICAgICAgICAgICAgICAgICdhcnRfaW5mbycsICfQndCw0LnQtNC10L3QvdGL0LUg0LDRgNGC0LjQutGD0LvRizogJyArICc7Jy5qb2luKGZpbmRlZF9hcnRpY2xlcykpCiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5wdXQoJ2ZpbmRlZF9hcnRpY2xlcycsIGpzb24uZHVtcHMoZmluZGVkX2FydGljbGVzKSwgVHJ1ZSkKCiAgICAgICAgZ29vZF9uYW1lID0gc2VsZi5nZXRfZ29vZF9pbmZvKGN1cnJlbnRfb2JqZWN0KQogICAgICAgIHNlbGYuaGFzaF9tYXAuYWRkX3RvX2N2X2xpc3QoCiAgICAgICAgICAgIHsnb2JqZWN0Jzogc3RyKGN1cnJlbnRfb2JqZWN0KSwKICAgICAgICAgICAgICdpbmZvJzogZifQotC+0LLQsNGAOiA8YmlnPntnb29kX25hbWV9PC9iaWc+J30sCiAgICAgICAgICAgICdvYmplY3RfaW5mb19saXN0JywgX2RpY3Q9VHJ1ZSkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIGdldF9nb29kX2luZm8oc2VsZiwgYXJ0aWNsZTogc3RyKSAtPiBzdHI6CiAgICAgICAgcXVlcnkgPSAoJ1NFTEVDVCBSU19nb29kcy5uYW1lIGFzIG5hbWUnCiAgICAgICAgICAgICAgICAgJyBGUk9NIFJTX2RvY3NfdGFibGUnCiAgICAgICAgICAgICAgICAgJyBMRUZUIEpPSU4gUlNfZ29vZHMgT04gUlNfZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQnCiAgICAgICAgICAgICAgICAgJyBXSEVSRSBSU19kb2NzX3RhYmxlLmlkX2RvYyA9ID8gQU5EIFJTX2dvb2RzLmFydCA9ID8nKQogICAgICAgIGdvb2RzID0gc2VsZi5zZXJ2aWNlLnByb3ZpZGVyLnNxbF9xdWVyeShxdWVyeSwgZid7c2VsZi5pZF9kb2N9LHthcnRpY2xlfScpCiAgICAgICAgcmV0dXJuIGdvb2RzWzBdWyduYW1lJ10gaWYgZ29vZHMgZWxzZSAn0J3QtSDQvdCw0LnQtNC10L3QvicKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZik6CiAgICAgICAgc2V0dGluZ3MgPSBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdhcnRpY2xlc19vY3Jfc2V0dGluZ3MnKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3Zpc2lvbl9zZXR0aW5ncygqKmpzb24ubG9hZHMoc2V0dGluZ3MpKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gQWN0aXZlQ1YgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gT0NSID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MnCiAgICBwcm9jZXNzX25hbWUgPSAnT2NyVGV4dFJlY29nbml0aW9uJwogICAgb2NyX25vc3FsID0gbm9DbGFzcygib2NyX25vc3FsIikKICAgIG9jcl9ub3NxbF9jb3VudGVyID0gbm9DbGFzcygib2NyX25vc3FsX2NvdW50ZXIiKQoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbCA9IG5vQ2xhc3MoJ2FydGljbGVzX29jcl9uY2wnKQogICAgICAgIHNlbGYub2NyX25vc3FsID0gbm9DbGFzcygib2NyX25vc3FsIikKICAgICAgICBzZWxmLnNjcmVlbl90aXRsZSA9ICfQqNCw0LHQu9C+0L0g0YDQsNGB0L/QvtC30L3QsNCy0LDQvdC40Y8gUy9OJwogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfbWluX3JlY19hbW91bnQnOiAnNScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnOiAnMTAnLAogICAgICAgICAgICAnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnOiAnU04nLAogICAgICAgICAgICAnb2NyX3NlcmlhbF90ZW1wbGF0ZV9jb250aW51b3VzX3JlY29nbml0aW9uJzogJ2ZhbHNlJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfdXNlX3ByZWZpeCc6ICd0cnVlJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfY3VycmVudF90ZW1wbGF0ZSc6ICIiCiAgICAgICAgfQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLnNjcmVlbl90aXRsZSkKICAgICAgICBzZWxmLl9zZXRfc2NyZWVuX3ZhbHVlcygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9zYXZlX29jcl9zZXR0aW5ncyc6CiAgICAgICAgICAgIGlzX3ZhbGlkLCBlcnJvciA9IHNlbGYuX3ZhbGlkYXRlX29jcl9zZXR0aW5ncygpCiAgICAgICAgICAgIGlmIG5vdCBpc192YWxpZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZXJyb3IpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5fc2F2ZV90ZW1wbGF0ZV9wYXR0ZXJucygpCiAgICAgICAgICAgIHNlbGYuX3NhdmVfdGVtcGxhdGVfc2V0dGluZ3MoKQogICAgICAgICAgICBzZWxmLl9zZXRfdmlzaW9uX3NldHRpbmdzKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC9INGB0L7RhdGA0LDQvdGR0L0nKQogICAgICAgICAgICBpZiBzZWxmLm9jcl9ub3NxbC5nZXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKToKICAgICAgICAgICAgICAgIHNlbGYub2NyX25vc3FsLmRlbGV0ZSgnc2hvd19wcm9jZXNzX3Jlc3VsdCcpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBpZiBzZWxmLm9jcl9ub3NxbC5nZXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKToKICAgICAgICAgICAgICAgIHNlbGYub2NyX25vc3FsLmRlbGV0ZSgnc2hvd19wcm9jZXNzX3Jlc3VsdCcpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9zZXRfc2NyZWVuX3ZhbHVlcyhzZWxmKToKICAgICAgICBmb3IgdmFsdWVfbmFtZSwgdmFsdWUgaW4gc2VsZi5zY3JlZW5fdmFsdWVzLml0ZW1zKCk6CiAgICAgICAgICAgIG5ld192YWx1ZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KHZhbHVlX25hbWUpIG9yIHNlbGYub2NyX25vc3FsLmdldCh2YWx1ZV9uYW1lKSBvciB2YWx1ZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCh2YWx1ZV9uYW1lLCBuZXdfdmFsdWUpCgoKICAgIGRlZiBfc2F2ZV90ZW1wbGF0ZV9zZXR0aW5ncyhzZWxmKToKICAgICAgICBmb3IgdmFsdWVfbmFtZSBpbiBzZWxmLnNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgIHNlbGYub2NyX25vc3FsLnB1dCh2YWx1ZV9uYW1lLCBzZWxmLmhhc2hfbWFwLmdldCh2YWx1ZV9uYW1lKSwgVHJ1ZSkKCiAgICBkZWYgX3NhdmVfdGVtcGxhdGVfcGF0dGVybnMoc2VsZik6CiAgICAgICAgbnVtX2Ftb3VudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnKQogICAgICAgIHByZWZpeCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3ByZWZpeCcpCiAgICAgICAgdXNlX3ByZWZpeCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnKQogICAgICAgIGlmIHVzZV9wcmVmaXggPT0gJ3RydWUnOgogICAgICAgICAgICBwYXR0ZXJucyA9IFtyZidee3ByZWZpeH0nLCByZicoW15cZG9PXSkoXGR7e3tudW1fYW1vdW50fX19KSQnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhdHRlcm5zID0gW3JmJ1xke3t7bnVtX2Ftb3VudH19fSddCiAgICAgICAgY3VycmVudF90ZW1wbGF0ZSA9IChmJ9Ci0LXQutGD0YnQuNC5INGI0LDQsdC70L7QvToge3ByZWZpeCBpZiB1c2VfcHJlZml4ID09ICJ0cnVlIiBlbHNlICIifScKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYneyIqIiAqIGludChudW1fYW1vdW50KX0nKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvY3Jfc2VyaWFsX2N1cnJlbnRfdGVtcGxhdGUnLCBjdXJyZW50X3RlbXBsYXRlKQogICAgICAgIHNlbGYub2NyX25vc3FsLnB1dCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wYXR0ZXJucycsIGpzb24uZHVtcHMocGF0dGVybnMpLCBUcnVlKQoKICAgIGRlZiBfc2V0X3Zpc2lvbl9zZXR0aW5ncyhzZWxmKSAtPiBOb25lOgogICAgICAgICIiItCj0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdGCINC90LDRgdGC0YDQvtC50LrQuCDQtNC70Y8g0LrQvdC+0L/QutC4INGA0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPINGC0LXQutGB0YLQsCIiIgogICAgICAgIG51bV9hbW91bnQgPSBpbnQoc2VsZi5vY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnKSBvciAnMTAnKQogICAgICAgIHVzZV9wcmVmaXggPSBzZWxmLm9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfdXNlX3ByZWZpeCcpCiAgICAgICAgaWYgdXNlX3ByZWZpeCA9PSAndHJ1ZSc6CiAgICAgICAgICAgIHByZWZpeCA9IHNlbGYub2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnKQogICAgICAgICAgICBtaW5fbGVuZ3RoID0gbnVtX2Ftb3VudCArIGxlbihwcmVmaXgpCiAgICAgICAgICAgIG1heF9sZW5ndGggPSBtaW5fbGVuZ3RoICsgMgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1pbl9sZW5ndGgsIG1heF9sZW5ndGggPSBudW1fYW1vdW50LCBudW1fYW1vdW50CiAgICAgICAgdmFsdWVzX2xpc3QgPSAoIn5be1wiYWN0aW9uXCI6XCJydW5cIixcInR5cGVcIjpcInB5dGhvblwiLCIKICAgICAgICAgICAgICAgICAgICAgICAiXCJtZXRob2RcIjpcInNlcmlhbF9rZXlfcmVjb2duaXRpb25fb2NyXCJ9XSIpCiAgICAgICAgcmVjX3NldHRpbmdzID0gZGljdCgKICAgICAgICAgICAgdmFsdWVzX2xpc3Q9dmFsdWVzX2xpc3QsCiAgICAgICAgICAgIG1heF9sZW5ndGg9bWF4X2xlbmd0aCwKICAgICAgICAgICAgbWluX2xlbmd0aD1taW5fbGVuZ3RoLAogICAgICAgICkKICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWwucHV0KCdzZXJpYWxfb2NyX3NldHRpbmdzJywganNvbi5kdW1wcyhyZWNfc2V0dGluZ3MpLCBUcnVlKQoKICAgIGRlZiBfdmFsaWRhdGVfb2NyX3NldHRpbmdzKHNlbGYpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAgICAgIiIi0JLQsNC70LjQtNCw0YbQuNGPINC00LDQvdC90YvRhSDQstCy0LXQtNC10L3QvdGL0YUg0LIg0LTQuNCw0LvQvtCz0LUg0KjQsNCx0LvQvtC90KDQsNGB0L/QvtC30L3QsNCy0LDQvdC40Y8iIiIKICAgICAgICBtaW5fcmVjX2Ftb3VudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX21pbl9yZWNfYW1vdW50JykKICAgICAgICBudW1fYW1vdW50ID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbnVtX2Ftb3VudCcpCiAgICAgICAgcHJlZml4OiBzdHIgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnKQogICAgICAgIHVzZV9wcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBpZiBub3QgbWluX3JlY19hbW91bnQuaXNkaWdpdCgpIG9yIGludChtaW5fcmVjX2Ftb3VudCkgPT0gMDoKICAgICAgICAgICAgZXJyb3IgPSAoJ9Cj0LrQsNC20LjRgtC1INC60L7RgNGA0LXQutGC0L3QvtC1INC80LjQvdC40LzQsNC70YzQvdC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4nCiAgICAgICAgICAgICAgICAgICAgJyDQvtCx0L3QsNGA0YPQttC10L3QuNC5INGB0LXRgNC40LnQvdC+0LPQviDQvdC+0LzQtdGA0LAnKQogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgbm90IG51bV9hbW91bnQuaXNkaWdpdCgpOgogICAgICAgICAgICBlcnJvciA9ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDRhtC40YTRgCDQsiDRiNCw0LHQu9C+0L3QtSDQvdC1INC60L7RgNGA0LXQutGC0L3QvicKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIGlmIG5vdCAxIDwgaW50KG51bV9hbW91bnQpIDwgMjE6CiAgICAgICAgICAgIGVycm9yID0gJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INGG0LjRhNGAINCyINGI0LDQsdC70L7QvdC1INC00L7Qu9C20L3QviDQsdGL0YLRjCDQsiDQuNC90YLQtdGA0LLQsNC70LUg0L7RgiAyINC00L4gMjAnCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZXJyb3IKICAgICAgICBpZiBwcmVmaXguaXNzcGFjZSgpIGFuZCB1c2VfcHJlZml4ID09ICd0cnVlJzoKICAgICAgICAgICAgZXJyb3IgPSAn0J3QtSDRg9C60LDQt9Cw0L0g0L/RgNC10YTQuNC60YEnCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZXJyb3IKICAgICAgICBpZiBwcmVmaXggIT0gcHJlZml4LnN0cmlwKCk6CiAgICAgICAgICAgIGVycm9yID0gJ9Cf0YDQvtCx0LXQu9GLINCyINC90LDRh9Cw0LvQtSDQuNC70Lgg0LIg0LrQvtC90YbQtSDQv9GA0LXRhNC40LrRgdCwJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgcmV0dXJuIFRydWUsICcnCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHNlcmlhbF9rZXlfcmVjb2duaXRpb25fb2NyKGhhc2hfbWFwOiBIYXNoTWFwKSAtPiBOb25lOgogICAgICAgICIiItCd0LDRhdC+0LTQuNGCINCyINC/0LXRgNC10LTQsNC90L3QvtC5INC40LcgT0NSINGB0YLRgNC+0LrQtSDRgdC10YDQuNC50L3Ri9C5INC90L7QvNC10YAsINC/0L4g0LfQsNC00LDQvdC90L7QvNGDINGI0LDQsdC70L7QvdGDIiIiCiAgICAgICAgb2NyX25vc3FsID0gbm9DbGFzcygib2NyX25vc3FsIikKICAgICAgICBvY3Jfbm9zcWxfY291bnRlciA9IG5vQ2xhc3MoIm9jcl9ub3NxbF9jb3VudGVyIikKICAgICAgICBvY3JfdGV4dCA9IGhhc2hfbWFwLmdldCgib2NyX3RleHQiKQogICAgICAgIHVzZV9wcmVmaXggPSBvY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnKQogICAgICAgIG51bV9hbW91bnQgPSBpbnQob2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JykpIG9yIDEwCiAgICAgICAgcGF0dGVybnMgPSBvY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3BhdHRlcm5zJykKICAgICAgICBwYXR0ZXJucyA9IGpzb24ubG9hZHMocGF0dGVybnMpIGlmIHBhdHRlcm5zIGVsc2UgW3JmJ1xke3t7bnVtX2Ftb3VudH19fSddCiAgICAgICAgZm9yIHBhdHRlcm4gaW4gcGF0dGVybnM6CiAgICAgICAgICAgIG1hdGNoX251bSA9IHJlLnNlYXJjaChwYXR0ZXJuLCBvY3JfdGV4dCkKICAgICAgICAgICAgaWYgbm90IG1hdGNoX251bToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIHJlc3VsdCA9IG1hdGNoX251bS5ncm91cCgyKSBpZiB1c2VfcHJlZml4ID09ICd0cnVlJyBlbHNlIG1hdGNoX251bS5ncm91cCgpCiAgICAgICAgbWluX3JlY19hbW91bnQgPSBpbnQob2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9taW5fcmVjX2Ftb3VudCcpKQogICAgICAgIHJlc3VsdF9pbl9tZW1vcnkgPSBvY3Jfbm9zcWxfY291bnRlci5nZXQocmVzdWx0KQogICAgICAgIGlmIHJlc3VsdF9pbl9tZW1vcnkgaXMgTm9uZToKICAgICAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIucHV0KHJlc3VsdCwgMSwgVHJ1ZSkKICAgICAgICBlbGlmIHJlc3VsdF9pbl9tZW1vcnkgPCBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIucHV0KHJlc3VsdCwgcmVzdWx0X2luX21lbW9yeSArIDEsIFRydWUpCiAgICAgICAgZWxpZiByZXN1bHRfaW5fbWVtb3J5ID09IG1pbl9yZWNfYW1vdW50OgogICAgICAgICAgICBvY3Jfbm9zcWxfY291bnRlci5wdXQocmVzdWx0LCByZXN1bHRfaW5fbWVtb3J5ICsgMSwgVHJ1ZSkKICAgICAgICAgICAgZnJvbV9zY3JlZW4gPSBvY3Jfbm9zcWwuZ2V0KCdmcm9tX3NjcmVlbicpCiAgICAgICAgICAgIGlmIGZyb21fc2NyZWVuID09ICdGbG93RG9jRGV0YWlsc1NjcmVlbic6CiAgICAgICAgICAgICAgICBkYl9zZXJ2aWNlcy5GbG93RG9jU2VydmljZShoYXNoX21hcFsnaWRfZG9jJ10pLmFkZF9iYXJjb2RlX3RvX2RhdGFiYXNlKHJlc3VsdCkKICAgICAgICAgICAgZWxpZiBmcm9tX3NjcmVlbiA9PSAnU2VyaWVzU2VsZWN0U2NyZWVuJzoKICAgICAgICAgICAgICAgIGhhc2hfbWFwLnB1dCgib2NyX3Jlc3VsdCIsIHJlc3VsdCkKICAgICAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ29jcl9yZXN1bHQnLCByZXN1bHQsIFRydWUpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQodC10YDQuNC50L3Ri9C5INC90L7QvNC10YA6ICcgKyByZXN1bHQpCiAgICAgICAgICAgIGlmIG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfY29udGludW91c19yZWNvZ25pdGlvbicpID09ICdmYWxzZSc6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXQoIm9jcl9yZXN1bHQiLCByZXN1bHQpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZm9yIHNlcmlhbCBpbiBqc29uLmxvYWRzKG9jcl9ub3NxbF9jb3VudGVyLmdldGFsbGtleXMoKSk6CiAgICAgICAgICAgICAgICBpZiBvY3Jfbm9zcWxfY291bnRlci5nZXQoc2VyaWFsKSA8IG1pbl9yZWNfYW1vdW50OgogICAgICAgICAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChzZXJpYWwsIDAsIFRydWUpCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBPQ1IgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gU2VydmljZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBUaW1lcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hfbWFwCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IF9yc19zZXR0aW5ncwogICAgICAgIHNlbGYuaHR0cF9zZXR0aW5ncyA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLmh0dHBfc2VydmljZSA9IEhzU2VydmljZShzZWxmLmh0dHBfc2V0dGluZ3MpCgogICAgZGVmIHRpbWVyX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3N0b3BfdGltZXJfdXBkYXRlJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5fbG9hZF9kb2NzKCkKICAgICAgICBzZWxmLnVwbG9hZF9kYXRhKCkKICAgICAgICBzZWxmLl91cGxvYWRfYnVmZmVyX2RhdGEoKQoKICAgIGRlZiBfcHV0X25vdGlmaWNhdGlvbihzZWxmLCB0ZXh0LCB0aXRsZT1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbih0ZXh0LCB0aXRsZSkKCiAgICBkZWYgX2dldF9odHRwX3NldHRpbmdzKHNlbGYpOgogICAgICAgIGh0dHBfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgiVVJMIiksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1VTRVInKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnUEFTUycpLAogICAgICAgICAgICAnZGV2aWNlX21vZGVsJzogc2VsZi5oYXNoX21hcFsnREVWSUNFX01PREVMJ10sCiAgICAgICAgICAgICdhbmRyb2lkX2lkJzogc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgogICAgZGVmIF9sb2FkX2RvY3Moc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRyeToKICAgICAgICAgICAgZG9jc19kYXRhID0gc2VsZi5odHRwX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICAgICBkYXRhID0gZG9jc19kYXRhLmdldCgnZGF0YScpCiAgICAgICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuVGltZXJTZXJ2aWNlKCkKICAgICAgICAgICAgbmV3X2RvY3VtZW50cyA9IHNlcnZpY2UuZ2V0X25ld19sb2FkX2RvY3MoZGF0YSkKICAgICAgICAgICAgc2VydmljZS5zYXZlX2xvYWRfZGF0YShkYXRhKQogICAgICAgICAgICAjIHNlbGYuZGJfc2VydmljZS51cGRhdGVfZGF0YV9mcm9tX2pzb24oZG9jc19kYXRhWydkYXRhJ10pINCh0YLQsNGA0YvQuSDQstCw0YDQuNCw0L3RgiDQvtCx0LzQtdC90LAuCgogICAgICAgICAgICBpZiBuZXdfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbm90aWZ5X3RleHQgPSBzZWxmLl9nZXRfbm90aWZ5X3RleHQobmV3X2RvY3VtZW50cykKICAgICAgICAgICAgICAgIHNlbGYuX3B1dF9ub3RpZmljYXRpb24odGV4dD1ub3RpZnlfdGV4dCwgdGl0bGU9ItCX0LDQs9GA0YPQttC10L3RiyDQtNC+0LrRg9C80LXQvdGC0Ys6IikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LI6IHtlfScpCgogICAgZGVmIHVwbG9hZF9kYXRhKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZXJ2aWNlID0gVGltZXJTZXJ2aWNlKCkKICAgICAgICBkYXRhID0gc2VydmljZS5nZXRfZGF0YV90b19zZW5kKCkKCiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHR0cF9zZXJ2aWNlLnNlbmRfZGF0YShkYXRhKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhmJ9Ce0YjQuNCx0LrQsCDQstGL0LPRgNGD0LfQutC4INC00L7QutGD0LzQtdC90YLQvtCyOiB7ZX0nKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LI6IHthbnN3ZXIuZXJyb3JfdGV4dH0nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRvY3NfbGlzdF9zdHJpbmcgPSAnLCAnLmpvaW4oW2YiJ3tkWydpZF9kb2MnXX0nIiBmb3IgZCBpbiBkYXRhXSkKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnVwZGF0ZV91cGxvYWRlZF9kb2NzX3N0YXR1cyhkb2NzX2xpc3Rfc3RyaW5nKQoKICAgIGRlZiBfdXBsb2FkX2J1ZmZlcl9kYXRhKHNlbGYpOgogICAgICAgICMg0JjQvNGPINGC0LDQsdC70LjRhtGLINC+0YfQtdGA0LXQtNC4ICjQuNC80Y8g0LzQtdGC0L7QtNCwINCyIHVybCBodHRwLdGB0LXRgNCy0LjRgdCwKQogICAgICAgIGJ1ZmZlcl90YWJsZXMgPSBbCiAgICAgICAgICAgICdiYXJjb2RlcycsCiAgICAgICAgICAgICdkb2N1bWVudHMnCiAgICAgICAgXQoKICAgICAgICBmb3IgYnVmZmVyX3RhYmxlIGluIGJ1ZmZlcl90YWJsZXM6CiAgICAgICAgICAgIGJ1ZmZlcl9zZXJ2aWNlID0gRXhjaGFuZ2VRdWV1ZUJ1ZmZlcihidWZmZXJfdGFibGUpCiAgICAgICAgICAgIGRhdGFfdG9fc2VuZCA9IGJ1ZmZlcl9zZXJ2aWNlLmdldF9kYXRhX3RvX3NlbmQoKQoKICAgICAgICAgICAgbWV0aG9kID0gc2VsZi5odHRwX3NlcnZpY2UuZ2V0X21ldGhvZF9ieV9wYXRoKGJ1ZmZlcl90YWJsZSkKICAgICAgICAgICAgaWYgZGF0YV90b19zZW5kIGFuZCBtZXRob2Q6CiAgICAgICAgICAgICAgICByZXMgPSBtZXRob2QoZGF0YV90b19zZW5kKQoKICAgICAgICAgICAgICAgIGlmIG5vdCByZXMuZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgYnVmZmVyX3NlcnZpY2UucmVtb3ZlX3NlbnRfZGF0YShkYXRhX3RvX3NlbmQpCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X25vdGlmeV90ZXh0KG5ld19kb2N1bWVudHMpOgogICAgICAgIGRvY190aXRsZXMgPSBbCiAgICAgICAgICAgICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KGl0ZW1bJ2RvY190eXBlJ10sIGl0ZW1bJ2RvY19uJ10sIGl0ZW1bJ2RvY19kYXRlJ10pCiAgICAgICAgICAgIGZvciBpdGVtIGluIG5ld19kb2N1bWVudHMudmFsdWVzKCldCiAgICAgICAgcmV0dXJuICIsICIuam9pbihkb2NfdGl0bGVzKQoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICBoc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPWhzX3NlcnZpY2UudXJsKQogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgpjbGFzcyBXZWJTZXJ2aWNlU3luY0NvbW1hbmQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYubGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmxpc3RlbmVyCgogICAgZGVmIG9uX3NlcnZpY2VfcmVxdWVzdChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2Rlcyc6IHNlbGYuX2dldF9iYXJjb2Rlc19kYXRhLAogICAgICAgICAgICAnaGFzaF9tYXAnOiBzZWxmLl9nZXRfaGFzaF9tYXAsCiAgICAgICAgICAgICdoYXNoX21hcF9zaXplJzogc2VsZi5fZ2V0X2hhc2hfbWFwX3NpemUsCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVzX2RhdGEoc2VsZik6CiAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCiAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlSGVhZGVycycsIGhlYWRlcnMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZScsIGRhdGFfdG9fc2VuZCwgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBfZ2V0X2hhc2hfbWFwKHNlbGYpOgogICAgICAgIHByb2Nlc3NfbWFwID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigncHJvY2Vzc19tYXAnKQoKICAgICAgICBib2R5ID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignd3NfYm9keScpCiAgICAgICAgaWYgYm9keToKICAgICAgICAgICAgcmVzcG9uc2UgPSBwcm9jZXNzX21hcC5nZXQoYm9keVsnaXRlbSddKQoKICAgICAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlJywgcmVzcG9uc2UpCgogICAgZGVmIF9nZXRfaGFzaF9tYXBfc2l6ZShzZWxmKToKICAgICAgICBpbXBvcnQgc3lzCiAgICAgICAgcHJvY2Vzc19tYXAgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdwcm9jZXNzX21hcCcpIG9yIHt9CgogICAgICAgIGhlYWRlcnMgPSBbeydrZXknOiAnQ29udGVudC1UeXBlJywgJ3ZhbHVlJzogJ2FwcGxpY2F0aW9uL2pzb24nfV0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCgogICAgICAgIHJlc3AgPSB7a2V5OiByb3VuZChzeXMuZ2V0c2l6ZW9mKHYpIC8gMTAyNCwgMykgZm9yIGtleSwgdiAgaW4gcHJvY2Vzc19tYXAuaXRlbXMoKX0KICAgICAgICByZXNwWyd0b3RhbCddID0gcm91bmQoc3VtKHJlc3AudmFsdWVzKCkpLCAzKQoKICAgICAgICByZXNwX3NvcnRlZCA9IHtrOiB2IGZvciBrLCB2IGluIHNvcnRlZChyZXNwLml0ZW1zKCksIGtleT1sYW1iZGEgaXRlbTogaXRlbVsxXSwgcmV2ZXJzZT1UcnVlKX0KCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1dTUmVzcG9uc2UnLCByZXNwX3NvcnRlZCwgdG9fanNvbj1UcnVlKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlcnZpY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IE1haW4gZXZlbnRzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgTWFpbkV2ZW50czoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hfbWFwCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IF9yc19zZXR0aW5ncwoKICAgIGRlZiBhcHBfb25fc3RhcnQoc2VsZik6CgogICAgICAgICMgc2VsZi5oYXNoX21hcC5wdXQoJ1N0YWNrQWRkTW9kZScsICcnKSAgIyDQktC60LvRjtGH0LDQtdGCINGA0LXQttC40Lwg0L7QsdGK0LXQtNC40L3QtdC90LjRjyDQv9C10YDQtdC80LXQvdC90YvRhSBoYXNoX21hcCDQsiDRgtCw0LnQvNC10YDQsNGFCiAgICAgICAgICAgICAgICAKICAgICAgICAjIFRPRE8g0J7QsdGA0LDQsdC+0YLRh9C40LrQuCDQvtCx0L3QvtCy0LvQtdC90LjRjyEKICAgICAgICByZWxlYXNlID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1JlbGVhc2UnKSBvciAnJwogICAgICAgIHRvYXN0ID0gJ9CT0L7RgtC+0LIg0Log0YDQsNCx0L7RgtC1JwoKICAgICAgICBjdXJyZW50X3JlbGVhc2UgPSBzZWxmLmhhc2hfbWFwWydfY29uZmlndXJhdGlvblZlcnNpb24nXQoKICAgICAgICBzZWxmLl9jcmVhdGVfdGFibGVzKCkKCiAgICAgICAgaWYgY3VycmVudF9yZWxlYXNlIGlzIE5vbmU6CiAgICAgICAgICAgIHRvYXN0ID0gJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0L7Qv9GA0LXQtNC10LvQuNGC0Ywg0LLQtdGA0YHQuNGOINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCcKCiAgICAgICAgaWYgY3VycmVudF9yZWxlYXNlIGFuZCByZWxlYXNlICE9IGN1cnJlbnRfcmVsZWFzZToKICAgICAgICAgICAgIyBpbXBvcnQgdmVyc2lvbl9jb250cm9sCiAgICAgICAgICAgICMgcmVzdWx0X2xpc3QgPSB2ZXJzaW9uX2NvbnRyb2wucnVuX3JlbGVhc2VzKHJlbGVhc2UsIGN1cnJlbnRfcmVsZWFzZSkKICAgICAgICAgICAgIyBmb3IgZWxlbSBpbiByZXN1bHRfbGlzdDoKICAgICAgICAgICAgIyAgICAgaWYgbm90IGVsZW1bJ3Jlc3VsdCddOgogICAgICAgICAgICAjICAgICAgICAgcGFzcwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnSW5zdGFsbENvbmZpZ3VyYXRpb24nLCAnJykKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1JlbGVhc2UnLCBjdXJyZW50X3JlbGVhc2UsIFRydWUpCiAgICAgICAgICAgIHRvYXN0ID0gZifQktGL0L/QvtC70L3QtdC90L4g0L7QsdC90L7QstC70LXQvdC40LUg0L3QsCDQstC10YDRgdC40Y4ge2N1cnJlbnRfcmVsZWFzZX0nCgogICAgICAgIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZWxldGVfb2xkX2RvY3MnKSBpcyBUcnVlOgogICAgICAgICAgICBkZWxldGVkX2RvY3MgPSBzZWxmLl9kZWxldGVfb2xkX2RvY3MoKQogICAgICAgICAgICBpZiBkZWxldGVkX2RvY3M6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbigKICAgICAgICAgICAgICAgICAgICB0ZXh0PWYn0KPQtNCw0LvQtdC90Ysg0LTQvtC60YPQvNC10L3RgtGLOiAoe2xlbihkZWxldGVkX2RvY3MpfSknLAogICAgICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LrQsCDQvdC10LDQutGC0YPQsNC70YzQvdGL0YUg0LTQsNC90L3Ri9GFJykKCiAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiAxOCwKICAgICAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnOiAyMCwKICAgICAgICAgICAgJ0NhcmREYXRlVGV4dFNpemUnOiAxMCwKICAgICAgICAgICAgJ0NhcmRUZXh0U2l6ZSc6IDE1LAogICAgICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogMTYsCiAgICAgICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogMTUsCiAgICAgICAgICAgICdzaWduYWxfbnVtJzogNSwKICAgICAgICAgICAgJ3VzZV9tYXJrJzogJ2ZhbHNlJywKICAgICAgICAgICAgJ2FkZF9pZl9ub3RfaW5fcGxhbic6ICdmYWxzZScsCiAgICAgICAgICAgICdwYXRoJzogJycsCiAgICAgICAgICAgICdzdWNjZXNzX3NpZ25hbCc6IDcsCiAgICAgICAgICAgICd3YXJuaW5nX3NpZ25hbCc6IDgsCiAgICAgICAgICAgICdlcnJvcl9zaWduYWwnOiA1LAogICAgICAgICAgICAnYWxsb3dfb3ZlcnNjYW4nOiAnZmFsc2UnLAogICAgICAgICAgICAicGF0aF90b19kYXRhYmFzZXMiOiAiLi8iLAogICAgICAgICAgICAnc3FsaXRlX25hbWUnOiAnU2ltcGxlS2VlcCcsCiAgICAgICAgICAgICdsb2dfbmFtZSc6ICdsb2cuanNvbicsCiAgICAgICAgICAgICd0aW1lcl9pc19kaXNhYmxlZCc6IEZhbHNlLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCc6IEZhbHNlLAogICAgICAgICAgICAnb2ZmbGluZV9tb2RlJzogRmFsc2UsCiAgICAgICAgICAgICdkZWxldGVfb2xkX2RvY3MnOiBGYWxzZQogICAgICAgIH0KCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy8nKToKICAgICAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5nc1sncGF0aF90b19kYXRhYmFzZXMnXSA9ICcvL2RhdGEvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS9kYXRhYmFzZXMnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcnNfZGVmYXVsdF9zZXR0aW5nc1sncGF0aF90b19kYXRhYmFzZXMnXSA9ICIuLyIKCiAgICAgICAgZm9yIGssIHYgaW4gcnNfZGVmYXVsdF9zZXR0aW5ncy5pdGVtcygpOgogICAgICAgICAgICBpZiBzZWxmLnJzX3NldHRpbmdzLmdldChrKSBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoaywgdiwgVHJ1ZSkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsiU1FMQ29ubmVjdERhdGFiYXNlIl0gPSAiU2ltcGxlS2VlcCIKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHRvYXN0KQoKICAgIGRlZiBvbl9zcWxfZXJyb3Ioc2VsZik6CiAgICAgICAgc3FsX2Vycm9yID0gc2VsZi5oYXNoX21hcFsnU1FMRXJyb3InXQogICAgICAgIGlmIHNxbF9lcnJvcjoKICAgICAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgICAgICBzZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhmJ1NRTF9FcnJvcjoge3NxbF9lcnJvcn0nKQoKICAgIGRlZiBfY3JlYXRlX3RhYmxlcyhzZWxmKToKICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuRGJDcmVhdG9yKCkKICAgICAgICBzZXJ2aWNlLmNyZWF0ZV90YWJsZXMoKQoKICAgIGRlZiBfZGVsZXRlX29sZF9kb2NzKHNlbGYpIC0+IGxpc3Q6CiAgICAgICAgZGF5cyA9IGludChzZWxmLnJzX3NldHRpbmdzLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykpCiAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgIHJldHVybiBzZXJ2aWNlLmRlbGV0ZV9vbGRfZG9jcyhkYXlzKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIE1haW4gZXZlbnRzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTY3JlZW5zRmFjdG9yeToKICAgIHNjcmVlbnMgPSBbR29vZHNTZWxlY3RTY3JlZW4sCiAgICAgICAgSHRtbFZpZXcsCiAgICAgICAgVGVtcGxhdGVzTGlzdCwKICAgICAgICBGbG93VGlsZXNTY3JlZW4sCiAgICAgICAgRmxvd0RvY1NjcmVlbiwKICAgICAgICBGbG93RG9jRGV0YWlsc1NjcmVlbiwKICAgICAgICBHcm91cFNjYW5UaWxlcywKICAgICAgICBEb2N1bWVudHNUaWxlcywKICAgICAgICBHcm91cFNjYW5Eb2NzTGlzdFNjcmVlbiwKICAgICAgICBEb2N1bWVudHNEb2NzTGlzdFNjcmVlbiwKICAgICAgICBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3LAogICAgICAgIEdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4sCiAgICAgICAgRG9jdW1lbnRzRG9jRGV0YWlsU2NyZWVuLAogICAgICAgIEVycm9yTG9nU2NyZWVuLAogICAgICAgIERlYnVnU2V0dGluZ3NTY3JlZW4sCiAgICAgICAgSHR0cFNldHRpbmdzU2NyZWVuLAogICAgICAgIFNldHRpbmdzU2NyZWVuLAogICAgICAgIEdvb2RzTGlzdFNjcmVlbiwKICAgICAgICBTZWxlY3RHb29kc1R5cGUsCiAgICAgICAgSXRlbUNhcmQsCiAgICAgICAgRm9udFNpemVTZXR0aW5nc1NjcmVlbiwKICAgICAgICBCYXJjb2RlVGVzdFNjcmVlbiwKICAgICAgICBTb3VuZFNldHRpbmdzLAogICAgICAgIEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCwKICAgICAgICBHb29kc1ByaWNlc0l0ZW1DYXJkLAogICAgXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lPU5vbmUsIHByb2Nlc3M9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBzY3JlZW5fbmFtZToKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSBrd2FyZ3NbJ2hhc2hfbWFwJ10uZ2V0X2N1cnJlbnRfc2NyZWVuKCkKICAgICAgICBpZiBub3QgcHJvY2VzczoKICAgICAgICAgICAgcHJvY2VzcyA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9wcm9jZXNzKCkKCiAgICAgICAgZm9yIGl0ZW0gaW4gU2NyZWVuc0ZhY3Rvcnkuc2NyZWVuczoKICAgICAgICAgICAgaWYgZ2V0YXR0cihpdGVtLCAnc2NyZWVuX25hbWUnKSA9PSBzY3JlZW5fbmFtZSBhbmQgZ2V0YXR0cihpdGVtLCAncHJvY2Vzc19uYW1lJykgPT0gcHJvY2VzczoKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZV9zY3JlZW4oc2NyZWVuX25hbWU9Tm9uZSwgcHJvY2Vzcz1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IHNjcmVlbl9uYW1lOgogICAgICAgICAgICBzY3JlZW5fbmFtZSA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIGlmIG5vdCBwcm9jZXNzOgogICAgICAgICAgICBwcm9jZXNzID0ga3dhcmdzWydoYXNoX21hcCddLmdldF9jdXJyZW50X3Byb2Nlc3MoKQoKICAgICAgICBzY3JlZW5fY2xhc3MgPSBTY3JlZW5zRmFjdG9yeS5nZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lLCBwcm9jZXNzKQogICAgICAgIHJldHVybiBzY3JlZW5fY2xhc3MoKiprd2FyZ3MpCgoKY2xhc3MgTW9ja1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnTW9jaycKICAgIHByb2Nlc3NfbmFtZSA9ICdNb2NrJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKZGVmIHNldF9jdXJyZW50X3NjcmVlbihzY3JlZW4pOgogICAgZ2xvYmFsIGN1cnJlbnRfc2NyZWVuCiAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgpkZWYgc2V0X25leHRfc2NyZWVuKHNjcmVlbik6CiAgICBnbG9iYWwgbmV4dF9zY3JlZW4KICAgIG5leHRfc2NyZWVuID0gc2NyZWVuCiAgICByZXR1cm4gbmV4dF9zY3JlZW4KCmRlZiBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwOiBIYXNoTWFwLCBzY3JlZW5fY2xhc3M9Tm9uZSwgc2NyZWVuX3ZhbHVlcz1Ob25lKToKICAgICIiIgogICAg0JzQtdGC0L7QtCDQtNC70Y8g0L/QvtC70YPRh9C10L3QuNGPINC80L7QtNC10LvQuCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10Lkg0YLQtdC60YPRidC10LzRgyDQv9GA0L7RhtC10YHRgdGDINC4INGN0LrRgNCw0L3Rgy4KICAgINCV0YHQu9C4INC80L7QtNC10LvRjCDQvdC1INGA0LXQsNC70LjQt9C+0LLQsNC90LAg0LLQvtC30LLRgNCw0YnQsNC10YIg0LfQsNCz0LvRg9GI0LrRgwogICAg0KDQtdCw0LvQuNC30L7QstCw0L0g0YHQuNC90LPQu9GC0L7QvSDRh9C10YDQtdC3INCz0LvQvtCx0LDQu9GM0L3Rg9GOINC/0LXRgNC10LzQtdC90L3Rg9GOIGN1cnJlbnRfc2NyZWVuLCDQtNC70Y8g0YHQvtGF0YDQtdC90LXQvdC40Y8g0YHQvtGB0YLQvtGP0L3QuNGPINGC0LXQutGD0YnQtdCz0L4g0Y3QutGA0LDQvdCwCiAgICAiIiIKICAgIGdsb2JhbCBjdXJyZW50X3NjcmVlbiwgbmV4dF9zY3JlZW4KCiAgICBzY3JlZW5fcGFyYW1zID0gewogICAgICAgICdoYXNoX21hcCc6IGhhc2hfbWFwLAogICAgICAgICdyc19zZXR0aW5ncyc6IF9yc19zZXR0aW5ncwogICAgfQogICAgaWYgc2NyZWVuX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgc2NyZWVuX2NsYXNzID0gU2NyZWVuc0ZhY3RvcnkuZ2V0X3NjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCgogICAgaWYgbm90IHNjcmVlbl9jbGFzczoKICAgICAgICBjdXJyZW50X3NjcmVlbiA9IE1vY2tTY3JlZW4oKipzY3JlZW5fcGFyYW1zKQogICAgZWxpZiB0eXBlKGN1cnJlbnRfc2NyZWVuKSBpcyBub3Qgc2NyZWVuX2NsYXNzOgogICAgICAgIGlmIHR5cGUobmV4dF9zY3JlZW4pIGlzIHNjcmVlbl9jbGFzczoKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4gPSBuZXh0X3NjcmVlbgogICAgICAgICAgICBuZXh0X3NjcmVlbiA9IE5vbmUKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4uaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIHNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXRfZGF0YShzY3JlZW5fdmFsdWVzKQogICAgICAgICAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCiAgICBlbHNlOgogICAgICAgIGN1cnJlbnRfc2NyZWVuLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBjdXJyZW50X3NjcmVlbi5saXN0ZW5lciA9IGhhc2hfbWFwWydsaXN0ZW5lciddCiAgICAgICAgY3VycmVudF9zY3JlZW4uZXZlbnQgPSBoYXNoX21hcFsnZXZlbnQnXQoKICAgIGlmIGN1cnJlbnRfc2NyZWVuLmlzX2ZpbmlzaF9wcm9jZXNzOgogICAgICAgIGZpbmlzaF9zY3JlZW4gPSBjdXJyZW50X3NjcmVlbgogICAgICAgIGN1cnJlbnRfc2NyZWVuID0gTm9uZQogICAgICAgIHJldHVybiBmaW5pc2hfc2NyZWVuCgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_utils.py",
                "PyFileKey": "ui_utils",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzb2NrZXQKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzLCBhc2RpY3QKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBVbmlvbiwgTGlzdCwgRGljdCwgTGl0ZXJhbCwgT3B0aW9uYWwsIFR1cGxlCgpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBCYXJjb2RlU2VydmljZQpmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwoKCm5vQ2xhc3MgPSBqY2xhc3MoInJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpLk5vU1FMIikKcnNfc2V0dGluZ3MgPSBub0NsYXNzKCJyc19zZXR0aW5ncyIpCgoKY2xhc3MgSGFzaE1hcDoKICAgICIiIgogICAgICAgINCa0LvQsNGB0YEt0LTQtdC60L7RgNCw0YLQvtGAINC00LvRjyDRg9C00L7QsdC90L7QuSDRgNCw0LHQvtGC0Ysg0YEgaGFzaE1hcC4g0KLQsNC60LbQtSDQvNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0Ywg0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90YPRjiDQu9C+0LPQuNC60YMuCiAgICAiIiIKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA9Tm9uZSwgZGVidWc6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgc2VsZi5saXN0ZW5lciA9IE5vbmUKICAgICAgICBzZWxmLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBzZWxmLmRlYnVnX21vZGUgPSBkZWJ1ZwoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCBmdW5jOiBDYWxsYWJsZVsuLi4sIE5vbmVdKToKICAgICAgICBAd3JhcHMoZnVuYykKICAgICAgICBkZWYgd3JhcHBlcihoYXNoTWFwLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgICAgICBzZWxmLmluaXQoaGFzaE1hcCkKICAgICAgICAgICAgZnVuYyhzZWxmKQogICAgICAgICAgICByZXR1cm4gaGFzaE1hcAoKICAgICAgICByZXR1cm4gd3JhcHBlcgoKICAgIGRlZiBpbml0KHNlbGYsIGhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoTWFwCgogICAgZGVmIGZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZGVmIGZpbmlzaF9wcm9jZXNzX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2Vzc1Jlc3VsdCcsICcnKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGxpc3RlbmVyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmWydsaXN0ZW5lciddCgogICAgQGxpc3RlbmVyLnNldHRlcgogICAgZGVmIGxpc3RlbmVyKHNlbGYsIHYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2V0X3Jlc3VsdF9saXN0ZW5lcihzZWxmLCBsaXN0ZW5lcik6CiAgICAgICAgaWYgbGlzdGVuZXIgYW5kIGlzaW5zdGFuY2UobGlzdGVuZXIsIHN0cik6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsIGxpc3RlbmVyKQoKICAgIGRlZiB0b2FzdChzZWxmLCB0ZXh0LCBhZGRfdG9fbG9nPUZhbHNlKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndG9hc3QnLCBzdHIodGV4dCkpCiAgICAgICAgaWYgYWRkX3RvX2xvZzoKICAgICAgICAgICAgc2VsZi5lcnJvcl9sb2codGV4dCkKCiAgICBkZWYgbm90aWZpY2F0aW9uKHNlbGYsIHRleHQsIHRpdGxlPU5vbmUsIGFkZF90b19sb2c9RmFsc2UpOgogICAgICAgIG5vdGlmaWNhdGlvbl9pZCA9IHJzX3NldHRpbmdzLmdldCgibm90aWZpY2F0aW9uX2lkIikgKyAxIGlmIHJzX3NldHRpbmdzLmdldCgibm90aWZpY2F0aW9uX2lkIikgZWxzZSAxCiAgICAgICAgaWYgdGl0bGUgaXMgTm9uZToKICAgICAgICAgICAgdGl0bGUgPSBzZWxmLmdldF9jdXJyZW50X3NjcmVlbigpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KAogICAgICAgICAgICAiYmFzaWNfbm90aWZpY2F0aW9uIiwKICAgICAgICAgICAganNvbi5kdW1wcyhbeydudW1iZXInOiBub3RpZmljYXRpb25faWQsICd0aXRsZSc6IHN0cih0aXRsZSksICdtZXNzYWdlJzogdGV4dH1dKQogICAgICAgICkKCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJub3RpZmljYXRpb25faWQiLCBub3RpZmljYXRpb25faWQsIFRydWUpCiAgICAgICAgaWYgYWRkX3RvX2xvZzoKICAgICAgICAgICAgc2VsZi5lcnJvcl9sb2codGV4dCkKCiAgICBkZWYgZGVidWcoc2VsZiwgdGV4dCk6CiAgICAgICAgaWYgc2VsZi5kZWJ1Z19tb2RlOgogICAgICAgICAgICBzZWxmLnRvYXN0KHRleHQsIGFkZF90b19sb2c9VHJ1ZSkKCiAgICBkZWYgcmVmcmVzaF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1JlZnJlc2hTY3JlZW4nLCAnJykKCiAgICBkZWYgcnVuX2V2ZW50KHNlbGYsIG1ldGhvZF9uYW1lKToKICAgICAgICBzZWxmWydSdW5FdmVudCddID0ganNvbi5kdW1wcyhzZWxmLl9nZXRfZXZlbnQobWV0aG9kX25hbWUpKQoKICAgIGRlZiBydW5fZXZlbnRfYXN5bmMoc2VsZiwgbWV0aG9kX25hbWUsIHBvc3RfZXhlY3V0ZV9tZXRob2Q9Tm9uZSk6CiAgICAgICAgcnVuX2V2ZW50ID0gc2VsZi5fZ2V0X2V2ZW50KG1ldGhvZF9uYW1lLCAncnVuYXN5bmMnKQogICAgICAgIGlmIHBvc3RfZXhlY3V0ZV9tZXRob2Q6CiAgICAgICAgICAgIHJ1bl9ldmVudFswXVsncG9zdEV4ZWN1dGUnXSA9IGpzb24uZHVtcHMoc2VsZi5fZ2V0X2V2ZW50KHBvc3RfZXhlY3V0ZV9tZXRob2QpKQogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHJ1bl9ldmVudCkKCiAgICBkZWYgcnVuX2V2ZW50X3Byb2dyZXNzKHNlbGYsIG1ldGhvZF9uYW1lKToKICAgICAgICBzZWxmWydSdW5FdmVudCddID0ganNvbi5kdW1wcyhzZWxmLl9nZXRfZXZlbnQobWV0aG9kX25hbWUsICdydW5wcm9ncmVzcycpKQoKICAgIGRlZiBiZWVwKHNlbGYsIHRvbmU9JycpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiZWVwJywgc3RyKHRvbmUpKQoKICAgIGRlZiBwbGF5c291bmQoc2VsZiwgZXZlbnQ6IHN0ciwgc291bmRfdmFsOiBzdHIgPSAnJyk6CiAgICAgICAgaWYgbm90IHNvdW5kX3ZhbDoKICAgICAgICAgICAgc291bmQgPSByc19zZXR0aW5ncy5nZXQoZid7ZXZlbnR9X3NpZ25hbCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc291bmQgPSBzb3VuZF92YWwKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChmJ3BsYXlzb3VuZF97c291bmR9JywgIiIpCgogICAgZGVmIF9nZXRfZXZlbnQoc2VsZiwgbWV0aG9kX25hbWUsIGFjdGlvbj1Ob25lKToKICAgICAgICAiIiIKICAgICAgICA6cGFyYW0gbWV0aG9kX25hbWU6IGhhbmRsZXJzIG5hbWUKICAgICAgICA6cGFyYW0gYWN0aW9uOiBydW58cnVuYXN5bmN8cnVucHJvZ3Jlc3MKCiAgICAgICAgOnJldHVybjogZXZlbnQgZGljdAogICAgICAgICIiIgoKICAgICAgICBldnQgPSBbewogICAgICAgICAgICAnYWN0aW9uJzogYWN0aW9uIGlmIGFjdGlvbiBlbHNlICdydW4nLAogICAgICAgICAgICAndHlwZSc6ICdweXRob24nLAogICAgICAgICAgICAnbWV0aG9kJzogbWV0aG9kX25hbWUsCiAgICAgICAgfV0KCiAgICAgICAgcmV0dXJuIGV2dAoKICAgIGRlZiBlcnJvcl9sb2coc2VsZiwgZXJyX2RhdGEpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZXJyX2RhdGEgPSBqc29uLmR1bXBzKGVycl9kYXRhLCBlbnN1cmVfYXNjaWk9RmFsc2UsIGluZGVudD0yKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgZXJyX2RhdGEgPSBzdHIoZXJyX2RhdGEpCgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnZXJyb3JfbG9nJywgZXJyX2RhdGEsIFRydWUpCgogICAgZGVmIF9fZ2V0aXRlbV9fKHNlbGYsIGl0ZW0pOgogICAgICAgIHJldHVybiBzZWxmLmdldChpdGVtLCBGYWxzZSkKCiAgICBkZWYgX19zZXRpdGVtX18oc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgc2VsZi5wdXQoa2V5LCB2YWx1ZSwgRmFsc2UpCgogICAgZGVmIGdldChzZWxmLCBpdGVtLCBmcm9tX2pzb249RmFsc2UpOgogICAgICAgIGlmIGZyb21fanNvbjoKICAgICAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkpIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pIGVsc2UgTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmdldChpdGVtKQoKICAgIGRlZiBnZXRfanNvbihzZWxmLCBpdGVtKToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldChpdGVtKSkgaWYgc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkgZWxzZSBOb25lCgogICAgZGVmIGdldF9ib29sKHNlbGYsIGl0ZW0pOgogICAgICAgIHZhbHVlID0gc3RyKHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pKS5sb3dlcigpIG5vdCBpbiAoJzAnLCAnZmFsc2UnLCAnbm9uZScpCiAgICAgICAgcmV0dXJuIHZhbHVlCgogICAgZGVmIHB1dChzZWxmLCBrZXksIHZhbHVlOiBVbmlvbltzdHIsIExpc3QsIERpY3QsIGJvb2xdID0gJycsIHRvX2pzb249RmFsc2UpOgogICAgICAgIGlmIHRvX2pzb246CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGtleSwganNvbi5kdW1wcyh2YWx1ZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgYm9vbCk6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHN0cih2YWx1ZSkubG93ZXIoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChrZXksIHN0cih2YWx1ZSkpCgogICAgZGVmIHB1dF9kYXRhKHNlbGYsIGRhdGE6IGRpY3QsIGZpbGxfbm9uZT1GYWxzZSwgZGVmYXVsdD0nJyk6CiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gZGF0YS5pdGVtcygpOgogICAgICAgICAgICAgICAgaWYgdmFsdWUgaXMgTm9uZSBhbmQgZmlsbF9ub25lOgogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdAoKICAgICAgICAgICAgICAgIHNlbGZba2V5XSA9IHZhbHVlCgogICAgZGVmIGNvbnRhaW5zS2V5KHNlbGYsIGtleSk6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoa2V5KQoKICAgIGRlZiBrZXlfc2V0KHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5rZXlTZXQoKQoKICAgIGRlZiBrZXlzKHNlbGYpIC0+IExpc3Rbc3RyXToKICAgICAgICBrZXlzID0gc3RyKHNlbGYua2V5X3NldCgpKQogICAgICAgIHJldHVybiBrZXlzWzE6bGVuKGtleXMpLTFdLnNwbGl0KCcsICcpCgogICAgZGVmIGl0ZW1zKHNlbGYpIC0+IExpc3RbVHVwbGVbc3RyLCBPcHRpb25hbFtzdHJdXV06CiAgICAgICAgcmV0dXJuIFsoa2V5LCBzZWxmW2tleV0pIGZvciBrZXkgaW4gc2VsZi5rZXlzKCldCgogICAgZGVmIHNob3dfaXRlbXMoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIG9ubHk6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgICAgICAgICBleGNsdWRlOiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgaXNfdmFsdWVfZXhpc3RzOiBib29sID0gRmFsc2UsCiAgICApIC0+IE5vbmU6CiAgICAgICAgdGV4dCA9ICfQodC/0LjRgdC+0Log0Y3Qu9C10LzQtdC90YLQvtCyIEhhc2hNYXA6IFxuJwogICAgICAgIGlmIGlzX3ZhbHVlX2V4aXN0czoKICAgICAgICAgICAgdGV4dCArPSAnVHJ1ZSDQtdGB0LvQuCDQtdGB0YLRjCDQu9GO0LHQvtC1INC30L3QsNGH0LXQvdC40LUgXG4nCiAgICAgICAgaGFzaG1hcF9rZXlzID0gc2VsZi5rZXlzKCkKICAgICAgICBpdGVtcyA9IHNlbGYuaXRlbXMoKQogICAgICAgIGlmIG9ubHk6CiAgICAgICAgICAgIGl0ZW1zID0gW2l0ZW0gZm9yIGl0ZW0gaW4gaXRlbXMgaWYgaXRlbVswXSBpbiBvbmx5XQogICAgICAgICAgICBmb3Iga2V5IGluIG9ubHk6CiAgICAgICAgICAgICAgICBpZiBrZXkgbm90IGluIGhhc2htYXBfa2V5czoKICAgICAgICAgICAgICAgICAgICBpdGVtcy5hcHBlbmQoKGtleSwgJ9Cd0LXRgiDQutC70Y7Rh9CwJykpCiAgICAgICAgaWYgZXhjbHVkZToKICAgICAgICAgICAgaXRlbXMgPSBbaXRlbSBmb3IgaXRlbSBpbiBpdGVtcyBpZiBpdGVtWzBdIG5vdCBpbiBleGNsdWRlXQoKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBpdGVtczoKICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSBpZiBub3QgaXNfdmFsdWVfZXhpc3RzIGVsc2UgdmFsdWUgaXMgbm90IE5vbmUKICAgICAgICAgICAgdGV4dCArPSBmJ3trZXl9OiB7dmFsdWV9XG4nCiAgICAgICAgc2VsZi50b2FzdCh0ZXh0KQoKCiAgICBkZWYgcmVtb3ZlKHNlbGYsIGtleSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoa2V5KQoKICAgIGRlZiBkZWxldGUoc2VsZiwga2V5KToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShrZXkpCgogICAgZGVmIGFkZF90b19jdl9saXN0KAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBlbGVtZW50OiBVbmlvbltzdHIsIGRpY3RdLAogICAgICAgICAgICBjdl9saXN0OiBMaXRlcmFsWydncmVlbl9saXN0JywgJ3llbGxvd19saXN0JywgJ3JlZF9saXN0JywgJ2dyYXlfbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JsdWVfbGlzdCcsICdoaWRkZW5fbGlzdCcsICdvYmplY3RfaW5mb19saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3RvcF9saXN0ZW5lcl9saXN0JywgJ29iamVjdF9jYXB0aW9uX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvYmplY3RfZGV0ZWN0b3JfbW9kZSddLAogICAgICAgICAgICBfZGljdDogYm9vbCA9IEZhbHNlCiAgICApIC0+IE5vbmU6CiAgICAgICAgIiIiINCU0L7QsdCw0LLQu9GP0LXRgiDQsiBjdi3RgdC/0LjRgdC+0Log0Y3Qu9C10LzQtdC90YIsINC40LvQuCDRgdC+0LfQtNCw0LXRgiDQvdC+0LLRi9C5INGB0L/QuNGB0L7QuiDRgSDRjdGC0LjQvCDRjdC70LXQvNC10L3RgtC+0LwuCiAgICAgICAgICAgIG9iamVjdF9pbmZvX2xpc3QgLSDQmNC90YTQvtGA0LzQsNGG0LjRjyDQvtCxINC+0LHRitC10LrRgtC1ICjRgdC90LjQt9GDKS4gW3snb2JqZWN0Jzogb2JqZWN0X2lkOiBzdHIsICdpbmZvJzogdmFsdWV9XQogICAgICAgICAgICBvYmplY3RfZGV0ZWN0b3JfbW9kZSAtINCg0LXQttC40Lwg0LTQtdGC0LXQutGC0L7RgNCwLiBbeydvYmplY3RfaWQnOiBvYmplY3RfaWQ6IGludCwgJ21vZGUnOiBiYXJjb2RlfG9jcnxzdG9wfV0KICAgICAgICAgICAgb2JqZWN0X2NhcHRpb25fbGlzdCAtINCY0L3RhNC+0YDQvNCw0YbQuNGPINC+0LEg0L7QsdGK0LXQutGC0LUgKNGB0LLQtdGA0YXRgykuIFt7J29iamVjdCc6IG9iamVjdF9pZDogc3RyLCAnY2FwdGlvbic6IHZhbHVlfV0KICAgICAgICAgICAgc3RvcF9saXN0ZW5lcl9saXN0IC0g0JHQu9C+0LrQuNGA0YPQtdGCINCy0YvQv9C+0LvQvdC40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINC00LvRjyDQvtCx0YrQtdC60YLQvtCyINCyINGB0L/QuNGB0LrQtQogICAgICAgICIiIgoKICAgICAgICBpZiBfZGljdDoKICAgICAgICAgICAgbHN0ID0gc2VsZi5nZXQoY3ZfbGlzdCwgZnJvbV9qc29uPVRydWUpIG9yIFtdCiAgICAgICAgICAgIGlmIGVsZW1lbnQgbm90IGluIGxzdDoKICAgICAgICAgICAgICAgIGxzdC5hcHBlbmQoZWxlbWVudCkKICAgICAgICAgICAgICAgIHNlbGYucHV0KGN2X2xpc3QsIGpzb24uZHVtcHMobHN0LCBlbnN1cmVfYXNjaWk9RmFsc2UpKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0KQogICAgICAgICAgICBsc3QgPSBsc3Quc3BsaXQoJzsnKSBpZiBsc3QgZWxzZSBbXQogICAgICAgICAgICBpZiBlbGVtZW50IG5vdCBpbiBsc3Q6CiAgICAgICAgICAgICAgICBsc3QuYXBwZW5kKGVsZW1lbnQpCiAgICAgICAgICAgICAgICBzZWxmLnB1dChjdl9saXN0LCAnOycuam9pbihsc3QpKQoKICAgIGRlZiByZW1vdmVfZnJvbV9jdl9saXN0KAogICAgICAgIHNlbGYsCiAgICAgICAgZWxlbWVudDogVW5pb25bc3RyLCBkaWN0XSwKICAgICAgICBjdl9saXN0OiBMaXRlcmFsWydncmVlbl9saXN0JywgJ3llbGxvd19saXN0JywgJ3JlZF9saXN0JywgJ2dyYXlfbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAnYmx1ZV9saXN0JywgJ2hpZGRlbl9saXN0JywgJ29iamVjdF9pbmZvX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3N0b3BfbGlzdGVuZXJfbGlzdCcsICdvYmplY3RfY2FwdGlvbl9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICdvYmplY3RfZGV0ZWN0b3JfbW9kZSddLAogICAgICAgIF9kaWN0OiBib29sID0gRmFsc2UKICAgICk6CiAgICAgICAgIiIi0KPQtNCw0LvRj9C10YIg0LjQtyBjdi3RgdC/0LjRgdC60LAiIiIKICAgICAgICBpZiBfZGljdDoKICAgICAgICAgICAgbHN0ID0gc2VsZi5nZXQoY3ZfbGlzdCwgZnJvbV9qc29uPVRydWUpIG9yIFtdCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGxzdC5yZW1vdmUoZWxlbWVudCkKICAgICAgICAgICAgICAgIHNlbGYucHV0KGN2X2xpc3QsIGpzb24uZHVtcHMobHN0LCBlbnN1cmVfYXNjaWk9RmFsc2UpKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0KQogICAgICAgICAgICBsc3QgPSBsc3Quc3BsaXQoJzsnKSBpZiBsc3QgZWxzZSBbXQogICAgICAgICAgICBpZiBlbGVtZW50IGluIGxzdDoKICAgICAgICAgICAgICAgIGxzdC5yZW1vdmUoZWxlbWVudCkKICAgICAgICAgICAgICAgIHNlbGYucHV0KGN2X2xpc3QsICc7Jy5qb2luKGxzdCkpCgogICAgZGVmIHNldF92aXNpb25fc2V0dGluZ3MoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIHZhbHVlc19saXN0OiBzdHIsCiAgICAgICAgICAgIHR5cGVfcmVjOiBzdHIgPSAnVGV4dCcsCiAgICAgICAgICAgIE51bWJlclJlY29nbml0aW9uOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgIERhdGVSZWNvZ25pdGlvbjogYm9vbCA9IEZhbHNlLAogICAgICAgICAgICBQbGF0ZU51bWJlclJlY29nbml0aW9uOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgIG1pbl9sZW5ndGg6IGludCA9IDEsCiAgICAgICAgICAgIG1heF9sZW5ndGg6IGludCA9IDIwLAogICAgICAgICAgICByZXN1bHRfdmFyOiBzdHIgPSAnb2NyX3Jlc3VsdCcsCiAgICAgICAgICAgIG1lc3VyZV9xdHk6IGludCA9IDEsCiAgICAgICAgICAgIG1pbl9mcmVxOiBpbnQgPSAxLAogICAgICAgICAgICBxdWVyeTogc3RyID0gJycsCiAgICAgICAgICAgIGNvbnRyb2xfZmllbGQ6IHN0ciA9ICcnLAogICAgICAgICAgICBjdXJzb3I6IE9wdGlvbmFsW2xpc3RdID0gTm9uZSwKICAgICAgICAgICAgY291bnRfb2JqZWN0czogaW50ID0gMCwKICAgICAgICAgICAgUmVwbGFjZU86IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgVG9VcGNhc2U6IGJvb2wgPSBGYWxzZSwKICAgICk6CiAgICAgICAgIiIicXVlcnkgLSBTUUwg0LfQsNC/0YDQvtGBINC00LvRjyDQstCw0YDQuNCw0L3RgtCwINC/0L7QuNGB0LrQsCDQv9C+IFNRTC3RgtCw0LHQu9C40YbQtSDRgSDQvtC00LjQvdC8INC/0LDRgNCw0LzQtdGC0YDQvtC8KNCyINC60L7RgtC+0YDRi9C5INC/0LXRgNC10LTQsNC10YLRgdGPINGA0LDRgdC/0L7Qt9C90LDQvdC90YvQuSDRgtC10LrRgdGCICkKICAgICAgICAgICAgICAgINCd0LDQv9GA0LjQvNC10YA6IHNlbGVjdCAqIGZyb20gU1dfR29vZHMgd2hlcmUgcHJvZHVjdF9udW1iZXIgbGlrZSAgPwogICAgICAgICAgIGNvbnRyb2xfZmllbGQgLSDQv9C+0LvQtSDRgtCw0LHQu9C40YbRiyDQv9C+INC60L7RgtC+0YDQvtC80YMg0L/RgNC+0LLQtdGA0Y/QtdGC0YHRjyBPQ1IgLCDRg9GB0LvQvtCy0L3QviDQkNGA0YLQuNC60YPQuyAo0L3QtdGB0LzQvtGC0YDRjyDQvdCwINGC0L4sINGH0YLQviDQsiBxdWVyeSDQvtC90L4g0YHQutC+0YDQtdC1INCy0YHQtdCz0L4g0YLQsNC60LbQtSDRg9GH0LDRgdGC0LLRg9C10YIpCiAgICAgICAgICAgY3Vyc29yIC0g0JzQsNGB0YHQuNCyICDRgSDQvtCx0YrQtdC60YLQsNC80LggeyJmaWVsZCI6PNC/0L7Qu9C1INGC0LDQsdC70LjRhtGLPiwidmFyIjo80L/QtdGA0LXQvNC10L3QvdCw0Y8g0YDQtdC30YPQu9GM0YLQsNGCPn0KICAgICAgICAgICB2YWx1ZXNfbGlzdCAtINCg0LXQttC40Lwg0L/QvtC40YHQutCwINC/0L4g0YHQv9C40YHQutGDLCDQu9C40LHQviDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LwgKCJ+IikKICAgICAgICAgICBtZXN1cmVfcXR5IC0g0JrQvtC70LjRh9C10YHRgtCy0L4g0LjQt9C80LXRgNC10L3QuNC5INC/0LvQvtGC0L3QvtGB0YLQuCDQstC10YDQvtGP0YLQvdC+0YHRgtC4ICjQvdC+0YDQvC4g0YDQsNGB0L/RgNC10LTQtdC70LXQvdC40LUpCiAgICAgICAgICAgbWluX2ZyZXEgLSDQktC10YDQvtGP0YLQvdC+0YHRgtGMICjQsiDQv9GA0L7RhtC10L3RgtCw0YUg0L7RgiAwINC00L4gMTAwINC00LvRjyDRg9C00L7QsdGB0YLQstCwINCy0LLQvtC00LApCiAgICAgICAgICAgbWluX2xlbmd0aCAtINCc0LjQvdC40LzQsNC70YzQvdCw0Y8g0LTQu9C40L3QsCDRgtC10LrRgdGC0LAKICAgICAgICAgICBtYXhfbGVuZ3RoIC0g0JzQsNC60YHQuNC80LDQu9GM0L3QsNGPINC00LvQuNC90LAg0YLQtdC60YHRgtCwCiAgICAgICAgICAgY291bnRfb2JqZWN0cyAtINCU0LvRjyBOdW1iZXJSZWNvZ25pdGlvbiDQutC+0LvQuNGH0LXRgdGC0LLQviDRhtC40LrQu9C+0LIg0LjQt9C80LXRgNC10L3QuNC5INC00LvRjyDRgNC10YjQtdC90LjRjyDQutC+0LzQsdC40L3QsNGC0L7RgNC90L7QuSDQt9Cw0LTQsNGH0LguINCn0LXQvCDQsdC+0LvRjNGI0LUg0YbQuNC60LvQvtCyINGC0LXQvCDQsdC+0LvRjNGI0LUg0YLQvtGH0L3QvtGB0YLRjAogICAgICAgICAgIFJlcGxhY2VPIC0g0JfQsNC80LXQvdC40YLRjCDQsdGD0LrQstGLINCeINC90LAgMCAo0L3Rg9C70LgpCiAgICAgICAgICAgVG9VcGNhc2UgLSDQn9GA0LXQvtCx0YDQsNC30L7QstCw0L3QuNC1INCyINCy0LXRgNGF0L3QuNC5INGA0LXQs9C40YHRgtGACiAgICAgICAgICAgUGxhdGVOdW1iZXJSZWNvZ25pdGlvbiAtINCg0L7RgdGB0LjQudGB0LrQuNC1INC90L7QvNC10YDQsCAo0YLQvtC70YzQutC+INC00LvRjyBBY3RpdmVDVikKICAgICAgICAgICBOdW1iZXJSZWNvZ25pdGlvbiAtINCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INGH0LjRgdC10LsKICAgICAgICAgICBEYXRlUmVjb2duaXRpb24gLSDQoNCw0YHQv9C+0LfQvdCw0LLQvdC40LUg0LTQsNGCCiAgICAgICAgICAgcmVzdWx0X2ZpZWxkICDQtNC70Y8g0YDQsNGB0L/QvtC30L3QstCw0L3QuNGPINC00LDRgiDQuCDQvdC+0LzQtdGA0L7Qsiwg0YLRg9C00LAg0L/QvtC80LXRidCw0LXRgtGB0Y8g0YDQtdC30YPQu9GM0YLQsNGC0Ysg0L7RgdC+0LHRi9C8INC+0LHRgNCw0LfQvtC8ICjRgdC80L7RgtGA0Y8g0YfRgtC+INC40YnQtdC8KSIiIgogICAgICAgIGlmIGN1cnNvciBpcyBOb25lOgogICAgICAgICAgICBjdXJzb3IgPSBbXQogICAgICAgIHNldHRpbmdzID0gewogICAgICAgICAgICAiVHlwZVJlY29nbml0aW9uIjogdHlwZV9yZWMsCiAgICAgICAgICAgICJOdW1iZXJSZWNvZ25pdGlvbiI6IE51bWJlclJlY29nbml0aW9uLAogICAgICAgICAgICAiRGF0ZVJlY29nbml0aW9uIjogRGF0ZVJlY29nbml0aW9uLAogICAgICAgICAgICAiUGxhdGVOdW1iZXJSZWNvZ25pdGlvbiI6IFBsYXRlTnVtYmVyUmVjb2duaXRpb24sCiAgICAgICAgICAgICJtaW5fbGVuZ3RoIjogbWluX2xlbmd0aCwKICAgICAgICAgICAgIm1heF9sZW5ndGgiOiBtYXhfbGVuZ3RoLAogICAgICAgICAgICAidmFsdWVzX2xpc3QiOiB2YWx1ZXNfbGlzdCwKICAgICAgICAgICAgInJlc3VsdF92YXIiOiByZXN1bHRfdmFyLAogICAgICAgICAgICAibWVzdXJlX3F0eSI6IG1lc3VyZV9xdHksCiAgICAgICAgICAgICJtaW5fZnJlcSI6IG1pbl9mcmVxLAogICAgICAgICAgICAicXVlcnkiOiBxdWVyeSwKICAgICAgICAgICAgImNvbnRyb2xfZmllbGQiOiBjb250cm9sX2ZpZWxkLAogICAgICAgICAgICAiY3Vyc29yIjogY3Vyc29yLAogICAgICAgICAgICAiY291bnRfb2JqZWN0cyI6IGNvdW50X29iamVjdHMsCiAgICAgICAgICAgICJSZXBsYWNlTyI6IFJlcGxhY2VPLAogICAgICAgICAgICAiVG9VcGNhc2UiOiBUb1VwY2FzZQogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2V0VmlzaW9uU2V0dGluZ3MiLCBqc29uLmR1bXBzKHNldHRpbmdzKSkKCiAgICBkZWYgc2hvd19zY3JlZW4oc2VsZiwgbmFtZSwgZGF0YT1Ob25lKToKICAgICAgICBzZWxmLnB1dCgnU2hvd1NjcmVlbicsIG5hbWUpCiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgc2VsZi5wdXRfZGF0YShkYXRhKQoKICAgIGRlZiBzaG93X3Byb2Nlc3NfcmVzdWx0KHNlbGYsIHByb2Nlc3MsIHNjcmVlbiwgZGF0YTogZGljdCA9IE5vbmUpOgogICAgICAgIGlmIHByb2Nlc3MgYW5kIHNjcmVlbjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgZid7cHJvY2Vzc318e3NjcmVlbn0nKQoKICAgICAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgICAgIHNlbGYucHV0X2RhdGEoZGF0YSkKCiAgICBkZWYgc3dpdGNoX3Byb2Nlc3Nfc2NyZWVuKHNlbGYsIHByb2Nlc3M6IHN0ciwgc2NyZWVuOiBPcHRpb25hbFtzdHJdID0gTm9uZSk6CiAgICAgICAgcHJvY2Vzc19zY3JlZW4gPSBmJ3twcm9jZXNzfXx7c2NyZWVufScgaWYgc2NyZWVuIGVsc2UgcHJvY2VzcwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTd2l0Y2hQcm9jZXNzU2NyZWVuJywgcHJvY2Vzc19zY3JlZW4pCgogICAgZGVmIHNob3dfZGlhbG9nKHNlbGYsIGxpc3RlbmVyLCB0aXRsZT0nJywgYnV0dG9ucz1Ob25lLCBkaWFsb2dfbGF5b3V0PU5vbmUpOgogICAgICAgIHNlbGYucHV0KCJTaG93RGlhbG9nIiwgbGlzdGVuZXIpCiAgICAgICAgCiAgICAgICAgaWYgZGlhbG9nX2xheW91dDoKICAgICAgICAgICAgc2VsZi5wdXQoJ1Nob3dEaWFsb2dMYXlvdXQnLCBkaWFsb2dfbGF5b3V0KQoKICAgICAgICBpZiB0aXRsZSBvciBidXR0b25zOgogICAgICAgICAgICBkaWFsb2dfc3R5bGUgPSB7CiAgICAgICAgICAgICAgICAndGl0bGUnOiB0aXRsZSBvciBsaXN0ZW5lciwKICAgICAgICAgICAgICAgICd5ZXMnOiAn0J7QuicsCiAgICAgICAgICAgICAgICAnbm8nOiAn0J7RgtC80LXQvdCwJwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIGJ1dHRvbnMgYW5kIGxlbihidXR0b25zKSA+IDE6CiAgICAgICAgICAgICAgICBkaWFsb2dfc3R5bGVbJ3llcyddID0gYnV0dG9uc1swXQogICAgICAgICAgICAgICAgZGlhbG9nX3N0eWxlWydubyddID0gYnV0dG9uc1sxXQoKICAgICAgICAgICAgc2VsZi5wdXQoJ1Nob3dEaWFsb2dTdHlsZScsIGRpYWxvZ19zdHlsZSkKCiAgICBkZWYgZ2V0X2N1cnJlbnRfc2NyZWVuKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmWydjdXJyZW50X3NjcmVlbl9uYW1lJ10gaWYgc2VsZi5jb250YWluc0tleSgnY3VycmVudF9zY3JlZW5fbmFtZScpIGVsc2UgJycKCiAgICBkZWYgZ2V0X3BhcmVudF9zY3JlZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ3BhcmVudF9zY3JlZW4nXSBpZiBzZWxmLmNvbnRhaW5zS2V5KCdwYXJlbnRfc2NyZWVuJykgZWxzZSAnJwoKICAgIGRlZiBnZXRfY3VycmVudF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmWydjdXJyZW50X3Byb2Nlc3NfbmFtZSddCgogICAgZGVmIHNldF90aXRsZShzZWxmLCB0aXRsZSk6CiAgICAgICAgc2VsZlsnU2V0VGl0bGUnXSA9IHRpdGxlCgogICAgZGVmIHJ1bl9weV90aHJlYWRfcHJvZ3Jlc3Moc2VsZiwgaGFuZGxlcnNfbmFtZTogc3RyKToKICAgICAgICAiIiIKICAgICAgICDQl9Cw0L/Rg9GB0LrQsNC10YIg0LDRgdC40L3RhdGA0L7QvdC90L7QtSDRhNC+0L3QvtCy0L7QtSDQstGL0L/QvtC70L3QtdC90LjQtSDRgdC60YDQuNC/0YLQsCBjINCx0LvQvtC60LjRgNGD0Y7RidC40Lwg0L/RgNC+0LPRgNC10YHRgS3QsdCw0YDQvtC8LCDQutC+0YLQvtGA0YvQuSDQsdC70L7QutC40YDRg9C10YIgVUkt0L/QvtGC0L7Qui4KICAgICAgICDQkiDQutCw0YfQtdGB0YLQstC1INCw0YDQs9GD0LzQtdC90YLQsCAtINC40LzRjyDRhNGD0L3QutGG0LjQuC3RhdC10L3QtNC70LXRgNCwLgogICAgICAgICIiIgoKICAgICAgICBzZWxmWydSdW5QeVRocmVhZFByb2dyZXNzRGVmJ10gPSBoYW5kbGVyc19uYW1lCgogICAgZGVmIHNxbF9leGVjKHNlbGYsIHF1ZXJ5LCBwYXJhbXM9JycpOgogICAgICAgIHNlbGYuX3B1dF9zcWwoJ1NRTEV4ZWMnLCBxdWVyeSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfZXhlY19tYW55KHNlbGYsIHF1ZXJ5LCBwYXJhbXM9Tm9uZSk6CiAgICAgICAgcGFyYW1zID0gcGFyYW1zIG9yIFtdCiAgICAgICAgc2VsZi5fcHV0X3NxbCgnU1FMRXhlY01hbnknLCBxdWVyeSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfcXVlcnkoc2VsZiwgcXVlcnksIHBhcmFtcz0nJyk6CiAgICAgICAgc2VsZi5fcHV0X3NxbCgnU1FMUXVlcnknLCBxdWVyeSwgcGFyYW1zKQoKICAgIGRlZiBfcHV0X3NxbChzZWxmLCBzcWxfdHlwZSwgcXVlcnksIHBhcmFtcyk6CiAgICAgICAgc2VsZi5wdXQoCiAgICAgICAgICAgIHNxbF90eXBlLAogICAgICAgICAgICB7InF1ZXJ5IjogcXVlcnksICdwYXJhbXMnOiBwYXJhbXN9LAogICAgICAgICAgICB0b19qc29uPVRydWUKICAgICAgICApCgogICAgZGVmIGJhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGZbJ0JhY2tTY3JlZW4nXSA9ICcnCgogICAgZGVmIG5vX3JlZnJlc2goc2VsZik6CiAgICAgICAgc2VsZlsnTm9SZWZyZXNoJ10gPSAnJwoKY2xhc3MgQmFyY29kZVdvcmtlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2MsICoqa3dhcmdzKToKICAgICAgICBzZWxmLmlkX2RvYyA9IGlkX2RvYwogICAgICAgIHNlbGYuY29udHJvbCA9IGt3YXJncy5nZXQoJ2NvbnRyb2wnLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfbWFya19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9tYXJrX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfcXR0eV9wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9xdHR5X3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfemVyb19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV96ZXJvX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLnVzZV9zY2FubmluZ19xdWV1ZSA9IGt3YXJncy5nZXQoJ3VzZV9zY2FubmluZ19xdWV1ZScsIEZhbHNlKQogICAgICAgIHNlbGYuYmFyY29kZV9pbmZvID0gTm9uZQogICAgICAgIHNlbGYuZG9jdW1lbnRfcm93ID0gTm9uZQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IEJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLnByb2Nlc3NfcmVzdWx0ID0gc2VsZi5Qcm9jZXNzVGhlQmFyY29kZVJlc3VsdCgpCiAgICAgICAgc2VsZi51c2VyX3RteiA9IDAKICAgICAgICBzZWxmLmJhcmNvZGVfZGF0YSA9IHt9CiAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhID0ge30KICAgICAgICBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEgPSB7fQogICAgICAgIHNlbGYucXVldWVfdXBkYXRlX2RhdGEgPSB7fQogICAgICAgIHNlbGYuZ3JvdXBfc2NhbiA9IGt3YXJncy5nZXQoJ2dyb3VwX3NjYW4nLCBGYWxzZSkKCiAgICBkZWYgcHJvY2Vzc190aGVfYmFyY29kZShzZWxmLCBiYXJjb2RlKToKICAgICAgICBzZWxmLnByb2Nlc3NfcmVzdWx0LmJhcmNvZGUgPSBiYXJjb2RlCiAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8gPSBCYXJjb2RlUGFyc2VyKGJhcmNvZGUpLnBhcnNlKGFzX2RpY3Q9RmFsc2UpCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9pbmZvLmVycm9yOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnaW52YWxpZF9iYXJjb2RlJykKICAgICAgICAgICAgcmV0dXJuIHNlbGYucHJvY2Vzc19yZXN1bHQKCiAgICAgICAgc2VsZi5iYXJjb2RlX2RhdGEgPSBzZWxmLl9nZXRfYmFyY29kZV9kYXRhKCkKCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3VzZV9zZXJpZXMoKQogICAgICAgICAgICBzZWxmLmNoZWNrX2JhcmNvZGUoKQogICAgICAgICAgICBzZWxmLnVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdub3RfZm91bmQnKQoKICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzX3Jlc3VsdAoKICAgIGRlZiBfY2hlY2tfdXNlX3NlcmllcyhzZWxmKToKICAgICAgICBpZiBpbnQoc2VsZi5iYXJjb2RlX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJywgMCkpOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygndXNlX3NlcmllcycpCgogICAgZGVmIF9nZXRfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfYmFyY29kZV9kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGJhcmNvZGVfaW5mbz1zZWxmLmJhcmNvZGVfaW5mbwogICAgICAgICkKICAgICAgICByZXR1cm4gYmFyY29kZV9kYXRhIG9yIHt9CgogICAgZGVmIGNoZWNrX2JhcmNvZGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgc2VsZi5fdXNlX21hcmsoKToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfbWFya19pbl9kb2N1bWVudCgpCiAgICAgICAgc2VsZi5fY2hlY2tfYmFyY29kZV9pbl9kb2N1bWVudCgpCgogICAgZGVmIF9jaGVja19tYXJrX2luX2RvY3VtZW50KHNlbGYpOgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9PSAnR1MxJzoKICAgICAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXToKICAgICAgICAgICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydhcHByb3ZlZCddID09ICcxJzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbWFya19hbHJlYWR5X3NjYW5uZWQnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnNlcnRfbWFya19kYXRhKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHNlbGYuaGF2ZV9tYXJrX3BsYW4gYW5kIHNlbGYuY29udHJvbDoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbWFya19ub3RfZm91bmQnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnNlcnRfbWFya19kYXRhKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbm90X3ZhbGlkX2JhcmNvZGUnKQoKICAgIGRlZiBfY2hlY2tfYmFyY29kZV9pbl9kb2N1bWVudChzZWxmKToKICAgICAgICBpZiBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgbmV3X2RldmljZV9xdHR5ID0gc2VsZi5iYXJjb2RlX2RhdGFbJ2RfcXR0eSddICsgc2VsZi5iYXJjb2RlX2RhdGFbJ3JhdGlvJ10KICAgICAgICBuZXdfb3ZlcmFsbF9xdHR5ID0gc2VsZi5iYXJjb2RlX2RhdGFbJ3F0dHknXSArIHNlbGYuYmFyY29kZV9kYXRhWydyYXRpbyddCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J106CiAgICAgICAgICAgIGlmIHNlbGYuaGF2ZV9xdHR5X3BsYW4gYW5kIHNlbGYuY29udHJvbCBhbmQgc2VsZi5iYXJjb2RlX2RhdGFbJ3F0dHlfcGxhbiddIDwgXAogICAgICAgICAgICAgICAgICAgIG1heChuZXdfZGV2aWNlX3F0dHksIG5ld19vdmVyYWxsX3F0dHkpOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ3F1YW50aXR5X3BsYW5fcmVhY2hlZCcpCgogICAgICAgIGVsaWYgc2VsZi5oYXZlX3plcm9fcGxhbiBhbmQgc2VsZi5jb250cm9sOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnemVyb19wbGFuX2Vycm9yJykKCiAgICAgICAgaWYgbm90IHNlbGYucHJvY2Vzc19yZXN1bHQuZXJyb3I6CiAgICAgICAgICAgIGlmIHNlbGYudXNlX3NjYW5uaW5nX3F1ZXVlOgogICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X3F1ZXVlX2RhdGEoKQogICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X2RvY190YWJsZV9kYXRhKG5ld19kZXZpY2VfcXR0eSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX2luc2VydF9kb2NfdGFibGVfZGF0YShuZXdfZGV2aWNlX3F0dHkpCgogICAgZGVmIF9pbnNlcnRfbWFya19kYXRhKHNlbGYpOgogICAgICAgIHNlbGYubWFya191cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAnaWRfc2VyaWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAnaWRfdW5pdCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF91bml0J10sCiAgICAgICAgICAgICdiYXJjb2RlX2Zyb21fc2Nhbm5lcic6IHNlbGYuYmFyY29kZV9pbmZvLmJhcmNvZGUsCiAgICAgICAgICAgICdhcHByb3ZlZCc6ICcxJywKICAgICAgICAgICAgJ2d0aW4nOiBzZWxmLmJhcmNvZGVfaW5mby5ndGluLAogICAgICAgICAgICAnc2VyaWVzJzogc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnbWFya19jb2RlJzogc2VsZi5iYXJjb2RlX2luZm8uYmFyY29kZQogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXToKICAgICAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhWydpZCddID0gc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXQoKICAgIGRlZiBfaW5zZXJ0X2RvY190YWJsZV9kYXRhKHNlbGYsIHF0eSk6CgogICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICdpZF91bml0Jzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLmJhcmNvZGVfZGF0YVsncXR0eSddLAogICAgICAgICAgICAnZF9xdHR5JzogZmxvYXQocXR5KSwKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuYmFyY29kZV9kYXRhWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2xhc3RfdXBkYXRlZCc6IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz1zZWxmLnVzZXJfdG16KSkuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIiksCiAgICAgICAgICAgICdpZF9jZWxsJzogJycsCiAgICAgICAgICAgICdwcmljZSc6IHNlbGYuYmFyY29kZV9kYXRhWydwcmljZSddLAogICAgICAgICAgICAnaWRfcHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJpY2UnXQogICAgICAgIH0KCiAgICAgICAgaWYgbm90IHNlbGYuZ3JvdXBfc2NhbjoKICAgICAgICAgICAgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhWydxdHR5J10gPSBmbG9hdChxdHkpCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J106CiAgICAgICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YVsnaWQnXSA9IHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J10KCiAgICBkZWYgX2luc2VydF9xdWV1ZV9kYXRhKHNlbGYpOgogICAgICAgIHNlbGYucXVldWVfdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICJpZF9kb2MiOiBzZWxmLmlkX2RvYywKICAgICAgICAgICAgImlkX2dvb2QiOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfZ29vZCddLAogICAgICAgICAgICAiaWRfcHJvcGVydGllcyI6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAiaWRfc2VyaWVzIjogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAiaWRfdW5pdCI6IHNlbGYuYmFyY29kZV9kYXRhWydpZF91bml0J10sCiAgICAgICAgICAgICJpZF9jZWxsIjogJycsCiAgICAgICAgICAgICJkX3F0dHkiOiBzZWxmLmJhcmNvZGVfZGF0YVsncmF0aW8nXSwKICAgICAgICAgICAgJ3Jvd19rZXknOiBzZWxmLmJhcmNvZGVfZGF0YVsncm93X2tleSddLAogICAgICAgICAgICAnc2VudCc6IEZhbHNlLAogICAgICAgICAgICAncHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsncHJpY2UnXSwKICAgICAgICAgICAgJ2lkX3ByaWNlJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3ByaWNlJ10KICAgICAgICB9CgogICAgZGVmIHVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIHNlbGYubWFya191cGRhdGVfZGF0YToKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKHRhYmxlX25hbWU9IlJTX2RvY3NfYmFyY29kZXMiLCBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhPXNlbGYubWFya191cGRhdGVfZGF0YSkKCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUodGFibGVfbmFtZT0iUlNfZG9jc190YWJsZSIsIGRvY3NfdGFibGVfdXBkYXRlX2RhdGE9c2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKQoKICAgICAgICBpZiBzZWxmLnF1ZXVlX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UuaW5zZXJ0X25vX3NxbChzZWxmLnF1ZXVlX3VwZGF0ZV9kYXRhKQoKICAgICAgICBpZiBzZWxmLl91c2VfbWFyaygpOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnc3VjY2Vzc19tYXJrJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnc3VjY2Vzc19iYXJjb2RlJykKCiAgICBkZWYgX3VzZV9tYXJrKHNlbGYpOgogICAgICAgIHJldHVybiByc19zZXR0aW5ncy5nZXQoJ3VzZV9tYXJrJykgPT0gJ3RydWUnIGFuZCBzZWxmLmJhcmNvZGVfZGF0YVsndXNlX21hcmsnXQoKICAgIGRlZiBfc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oc2VsZiwgaW5mb19rZXkpOgogICAgICAgIHJhdGlvID0gZ2V0YXR0cihzZWxmLmJhcmNvZGVfZGF0YSwgJ3JhdGlvJywgMCkKCiAgICAgICAgaW5mb19kYXRhID0gewogICAgICAgICAgICAnaW52YWxpZF9iYXJjb2RlJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ0ludmFsaWQgYmFyY29kZScsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0J3QtdCy0LXRgNC90YvQuSDRiNGC0YDQuNGF0LrQvtC0JywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ25vdF9mb3VuZCc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdOb3QgZm91bmQnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LHQsNC30LUnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbWFya19ub3RfZm91bmQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnTm90IGZvdW5kJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQnNCw0YDQutCwINC90LUg0L3QsNC50LTQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1JywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ25vdF92YWxpZF9iYXJjb2RlJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ05vdCB2YWxpZCBiYXJjb2RlJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQotC+0LLQsNGAINC/0L7QtNC70LXQttC40YIg0LzQsNGA0LrQuNGA0L7QstC60LUsINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvSDQvdC10LLQtdGA0L3Ri9C5INGI0YLRgNC40YXQutC+0LQg0LzQsNGA0LrQuNGA0L7QstC60LgnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbWFya19hbHJlYWR5X3NjYW5uZWQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnQWxyZWFkeSBzY2FubmVkJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQotCw0LrQsNGPINC80LDRgNC60LAg0YPQttC1INCx0YvQu9CwINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvdCwJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3plcm9fcGxhbl9lcnJvcic6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdaZXJvIHBsYW4gZXJyb3InLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9CSINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC90LXQu9GM0LfRjyDQtNC+0LHQsNCy0LjRgtGMINGC0L7QstCw0YAg0L3QtSDQuNC3INGB0L/QuNGB0LrQsCcsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdxdWFudGl0eV9wbGFuX3JlYWNoZWQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnUXVhbnRpdHkgcGxhbiByZWFjaGVkJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsdGD0LTQtdGCINC/0YDQtdCy0YvRiNC10L3QviDQv9GA0Lgg0LTQvtCx0LDQstC70LXQvdC40Lgge30g0LXQtNC40L3QuNGGINGC0L7QstCw0YDQsCcuZm9ybWF0KHJhdGlvKSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3N1Y2Nlc3NfYmFyY29kZSc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICcnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Ci0L7QstCw0YAg0LTQvtCx0LDQstC70LXQvSDQsiDQtNC+0LrRg9C80LXQvdGCJwogICAgICAgICAgICB9LAogICAgICAgICAgICAnc3VjY2Vzc19tYXJrJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0JzQsNGA0LrQsCDQtNC+0LHQsNCy0LvQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3VzZV9zZXJpZXMnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAndXNlX3NlcmllcycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0JTQu9GPINGC0L7QstCw0YDQsCDQvdC10L7QsdGF0L7QtNC40LzQviDQvtGC0YHQutCw0L3QuNGA0L7QstCw0YLRjCDRgdC10YDQuNC4JywKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgaW5mb19kYXRhLmdldChpbmZvX2tleSk6CiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuZXJyb3IgPSBpbmZvX2RhdGFbaW5mb19rZXldWydlcnJvciddCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuZGVzY3JpcHRpb24gPSBpbmZvX2RhdGFbaW5mb19rZXldWydkZXNjcmlwdGlvbiddCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQucm93X2tleSA9IHNlbGYuYmFyY29kZV9kYXRhLmdldCgncm93X2tleScsIDApCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuYmFyY29kZV9kYXRhID0gc2VsZi5iYXJjb2RlX2RhdGEKCiAgICBkZWYgcGFyc2Uoc2VsZiwgYmFyY29kZTogc3RyKToKICAgICAgICByZXR1cm4gQmFyY29kZVBhcnNlcihiYXJjb2RlKS5wYXJzZSgpCgogICAgQGRhdGFjbGFzcwogICAgY2xhc3MgUHJvY2Vzc1RoZUJhcmNvZGVSZXN1bHQ6CiAgICAgICAgZXJyb3I6IHN0ciA9ICcnCiAgICAgICAgZGVzY3JpcHRpb246IHN0ciA9ICcnCiAgICAgICAgYmFyY29kZTogc3RyID0gJycKICAgICAgICByb3dfa2V5OiBzdHIgPSAnJwogICAgICAgIGJhcmNvZGVfZGF0YSA9IE5vbmUKCmNsYXNzIEJhcmNvZGVBZHJXb3JrZXIoQmFyY29kZVdvcmtlcik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaWRfZG9jLCAqKmt3YXJncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhpZF9kb2MsICoqa3dhcmdzKQogICAgICAgIHNlbGYuaXNfYWRyX2RvYyA9IFRydWUKICAgICAgICBzZWxmLmlkX2NlbGwgPSBrd2FyZ3MuZ2V0KCdpZF9jZWxsJywgJycpCiAgICAgICAgc2VsZi50YWJsZV90eXBlID0ga3dhcmdzLmdldCgndGFibGVfdHlwZScsICcnKQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVfZGF0YShzZWxmKToKICAgICAgICBiYXJjb2RlX2RhdGEgPSBzZWxmLmRiX3NlcnZpY2UuZ2V0X2JhcmNvZGVfZGF0YSgKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICBiYXJjb2RlX2luZm89c2VsZi5iYXJjb2RlX2luZm8sCiAgICAgICAgICAgIGlzX2Fkcl9kb2M9c2VsZi5pc19hZHJfZG9jLAogICAgICAgICAgICBpZF9jZWxsPXNlbGYuaWRfY2VsbCwKICAgICAgICAgICAgdGFibGVfdHlwZT1zZWxmLnRhYmxlX3R5cGUKICAgICAgICApCgogICAgICAgIHJldHVybiBiYXJjb2RlX2RhdGEgb3Ige30KCiAgICBkZWYgX2NoZWNrX21hcmtfaW5fZG9jdW1lbnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5zZXJ0X21hcmtfZGF0YShzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIF9pbnNlcnRfZG9jX3RhYmxlX2RhdGEoc2VsZiwgcXR5KToKCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhID0gewogICAgICAgICAgICAnaWRfZG9jJzogc2VsZi5pZF9kb2MsCiAgICAgICAgICAgICdpZF9nb29kJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX2dvb2QnXSwKICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfdW5pdCddLAogICAgICAgICAgICAncXR0eSc6IGZsb2F0KHF0eSksCiAgICAgICAgICAgICdxdHR5X3BsYW4nOiBzZWxmLmJhcmNvZGVfZGF0YVsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICdsYXN0X3VwZGF0ZWQnOiAoZGF0ZXRpbWUubm93KCkgLSB0aW1lZGVsdGEoaG91cnM9c2VsZi51c2VyX3RteikpLnN0cmZ0aW1lKCIlWS0lbS0lZCAlSDolTTolUyIpLAogICAgICAgICAgICAnaWRfY2VsbCc6IHNlbGYuaWRfY2VsbCwKICAgICAgICAgICAgJ3RhYmxlX3R5cGUnOiBzZWxmLnRhYmxlX3R5cGUsCiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmJhcmNvZGVfZGF0YVsncm93X2tleSddOgogICAgICAgICAgICBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGFbJ2lkJ10gPSBzZWxmLmJhcmNvZGVfZGF0YVsncm93X2tleSddCgogICAgZGVmIF9pbnNlcnRfcXVldWVfZGF0YShzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YToKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfYWRyX2RvY3NfdGFibGUiLAogICAgICAgICAgICAgICAgZG9jc190YWJsZV91cGRhdGVfZGF0YT1zZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEpCgogICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdzdWNjZXNzX2JhcmNvZGUnKQoKY2xhc3MgQmFyY29kZVBhcnNlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBiYXJjb2RlKToKICAgICAgICBzZWxmLmJhcmNvZGUgPSBiYXJjb2RlCiAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8gPSBCYXJjb2RlUGFyc2VyLkJhcmNvZGVJbmZvKGJhcmNvZGU9YmFyY29kZSkKICAgICAgICBzZWxmLm1hY3JvXzA1ID0gZidbKT57Y2hyKDMwKX0wNScKICAgICAgICBzZWxmLm1hY3JvXzA2ID0gZidbKT57Y2hyKDMwKX0wNicKICAgICAgICBzZWxmLmdzMV9zZXBhcmF0b3IgPSBjaHIoMjkpCiAgICAgICAgc2VsZi5pZGVudGlmaWVyID0gJ11kMicKCiAgICBkZWYgcGFyc2Uoc2VsZiwgYXNfZGljdD1UcnVlKToKICAgICAgICBpZiBzZWxmLmlzX3ZhbGlkX2VhbjEzKHNlbGYuYmFyY29kZSk6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdFQU4xMycKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IHNlbGYuYmFyY29kZQoKICAgICAgICBlbGlmIGxlbihzZWxmLmJhcmNvZGUpID09IDI5OgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPSAnR1MxJwogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gc2VsZi5iYXJjb2RlWzA6MTRdCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbCA9IHNlbGYuYmFyY29kZVsxNDoyMV0KICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubXJjID0gc2VsZi5iYXJjb2RlWzIxOjI1XQogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5jaGVjayA9IHNlbGYuYmFyY29kZVsyNToyOV0KCiAgICAgICAgZWxpZiBzZWxmLmdzMV9zZXBhcmF0b3IgaW4gc2VsZi5iYXJjb2RlIG9yICc8R1M+JyBpbiBzZWxmLmJhcmNvZGU6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdHUzEnCiAgICAgICAgICAgIHNlbGYuY2hlY2tfZGF0YW1hdHJpeChzZWxmLmJhcmNvZGUpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdVTktOT1dOJwogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gc2VsZi5iYXJjb2RlCgogICAgICAgIGlmIGFzX2RpY3Q6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmJhcmNvZGVfaW5mby5kaWN0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5iYXJjb2RlX2luZm8KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgaXNfdmFsaWRfZWFuMTMoY29kZSk6CiAgICAgICAgcGF0dGVybiA9IHInXlxkezEzfSQnCiAgICAgICAgaWYgbm90IHJlLm1hdGNoKHBhdHRlcm4sIGNvZGUpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgZmFjdG9ycyA9IFsxLCAzXSAqIDYKICAgICAgICBjaGVja3N1bSA9IHN1bShpbnQoY29kZVtpXSkgKiBmYWN0b3JzW2ldIGZvciBpIGluIHJhbmdlKDEyKSkKICAgICAgICBjaGVja3N1bSA9ICgxMCAtIChjaGVja3N1bSAlIDEwKSkgJSAxMAoKICAgICAgICByZXR1cm4gY2hlY2tzdW0gPT0gaW50KGNvZGVbLTFdKQoKICAgIGRlZiBjaGVja19kYXRhbWF0cml4KHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmNsZWFyX2lkZW50aWZpZXIoYmFyY29kZSkKICAgICAgICBzZWxmLmNoZWNrX2dzMV9ndGluKGJhcmNvZGUpCgogICAgZGVmIGNoZWNrX2dzMV9ndGluKHNlbGYsIGJhcmNvZGU6IHN0cik6CiAgICAgICAgaWYgc2VsZi5nczFfc2VwYXJhdG9yIGluIGJhcmNvZGU6CiAgICAgICAgICAgIHdoaWxlIGJhcmNvZGU6CiAgICAgICAgICAgICAgICBpZiBiYXJjb2RlWzoyXSA9PSAnMDEnOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBiYXJjb2RlWzI6MTZdCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gMTY6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzE2Ol0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6M10gPT0gY2hyKDI5KSArICcwMSc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IGJhcmNvZGVbMzoxN10KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYmFyY29kZSkgPiAxNzoKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTc6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMTcnOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmV4cGlyeSA9IGJhcmNvZGVbMjo4XQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDg6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzg6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMTAnOgogICAgICAgICAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmJhdGNoID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmJhdGNoID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICcyMSc6CiAgICAgICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGJhcmNvZGUuaW5kZXgoY2hyKDI5KSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbCA9IGJhcmNvZGVbMjpdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTEnOgogICAgICAgICAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5uaHJuID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLm5ocm4gPSBiYXJjb2RlWzI6Nl0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICc5Myc6ICAjINCc0L7Qu9C+0YfQutCwLCDQstC+0LTQsAogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmNoZWNrID0gYmFyY29kZVsyOjZdCiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbNzpdCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTInOiAgIyDQlNCw0LvQtdC1INGB0LvQtdC00YPQtdGCINC60L7QtCDQv9GA0L7QstC10YDQutC4LCA0NCDRgdC40LzQstC+0LvQsAogICAgICAgICAgICAgICAgICAgICMgaWYgbGVuKGJhcmNvZGVbMjpdKT09NDQ6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uY2hlY2sgPSBiYXJjb2RlWzI6XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzo0XSA9PSAnODAwNSc6ICAjINCi0LDQsdCw0LosINCR0LvQvtC6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubmhybiA9IGJhcmNvZGVbNDoxMF0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxMTpdCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzo0XSA9PSAnMzEwMyc6ICAjINCc0L7Qu9C+0YfQutCwINGBINCS0LXRgdC+0LwKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby53ZWlnaHQgPSBiYXJjb2RlWzQ6XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5lcnJvciA9ICdJTlZBTElEIEJBUkNPREUnCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZXJyb3IgPSAnTm8gR1MgU2VwYXJhdG9yJwoKICAgICAgICAjIGlmICgnR1RJTicgLCAnQkFUQ0gnICwgJ0VYUElSWScgLCAnU0VSSUFMJykgaW4gcmVzdWx0LmtleXMoKToKICAgICAgICAjICAgICBpZiBndGluX2NoZWNrKHJlc3VsdFsnR1RJTiddKSA9PSBGYWxzZSBhbmQgZXhwaXJ5X2RhdGVfY2hlY2socmVzdWx0WydFWFBJUlknXSkgPT0gRmFsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgR1RJTiAmIEVYUElSWSBEQVRFJywgJ0JBUkNPREUnOiByZXN1bHR9CiAgICAgICAgIyAgICAgZWxpZiBleHBpcnlfZGF0ZV9jaGVjayhyZXN1bHRbJ0VYUElSWSddKSA9PSBGYWxzZToKICAgICAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBFWFBJUlkgREFURScsICdCQVJDT0RFJzogcmVzdWx0fQogICAgICAgICMgICAgIGVsaWYgZ3Rpbl9jaGVjayhyZXN1bHRbJ0dUSU4nXSkgPT0gRmFsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgR1RJTicsICdCQVJDT0RFJzogcmVzdWx0fQogICAgICAgICMgICAgIGVsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5DT01QTEVURSBEQVRBJywgJ0JBUkNPREUnOiByZXN1bHR9CgogICAgZGVmIGNsZWFyX2lkZW50aWZpZXIoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgIiIiCiAgICAgICAgTW9zdCBiYXJjb2RlIHNjYW5uZXJzIHByZXBlbmQgJ11kMicgaWRlbnRpZmllciBmb3IgdGhlIEdTMSBkYXRhbWF0cml4LgogICAgICAgIFRoaXMgc2VjdGlvbiByZW1vdmVzIHRoZSBpZGVudGlmaWVyLgogICAgICAgICIiIgoKICAgICAgICBpZiBiYXJjb2RlWzozXSA9PSBzZWxmLmlkZW50aWZpZXI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzM6XQoKICAgICAgICByZXR1cm4gYmFyY29kZQoKICAgIEBkYXRhY2xhc3MKICAgIGNsYXNzIEJhcmNvZGVJbmZvOgogICAgICAgIGJhcmNvZGU6IHN0ciA9ICcnCiAgICAgICAgc2NoZW1lOiBzdHIgPSAnJwogICAgICAgIHNlcmlhbDogc3RyID0gJycKICAgICAgICBndGluOiBzdHIgPSAnJwogICAgICAgIGVycm9yOiBzdHIgPSAnJwogICAgICAgIG1yYzogc3RyID0gJycKICAgICAgICBjaGVjazogc3RyID0gJycKICAgICAgICBmdWxsX2NvZGU6IHN0ciA9ICcnCiAgICAgICAgZXhwaXJ5OiBzdHIgPSAnJwogICAgICAgIGJhdGNoOiBzdHIgPSAnJwogICAgICAgIG5ocm46IHN0ciA9ICcnCiAgICAgICAgd2VpZ2h0OiBzdHIgPSAnJwoKICAgICAgICBkZWYgZGljdChzZWxmKToKICAgICAgICAgICAgcmV0dXJuIHtrLnVwcGVyKCk6IHN0cih2KSBmb3IgaywgdiBpbiBhc2RpY3Qoc2VsZikuaXRlbXMoKSBpZiB2fQoKZGVmIGdldF9pcF9hZGRyZXNzKCk6CiAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICB0cnk6CiAgICAgICAgcy5jb25uZWN0KCgiOC44LjguOCIsIDgwKSkKICAgICAgICBpcF9hZGRyZXNzID0gcy5nZXRzb2NrbmFtZSgpWzBdCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgaXBfYWRkcmVzcyA9IE5vbmUKICAgIGZpbmFsbHk6CiAgICAgICAgcy5jbG9zZSgpCgogICAgcmV0dXJuIGlwX2FkZHJlc3MK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\widgets.py",
                "PyFileKey": "widgets",
                "PyFileData": "ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0CmltcG9ydCBqc29uCgp3cmFwX2NvbnRlbnQgPSAid3JhcF9jb250ZW50IgptYXRjaF9wYXJlbnQgPSAnbWF0Y2hfcGFyZW50JwoKCmNsYXNzIFdpZGdldChBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZTogc3RyCiAgICAgICAgc2VsZi5WYWx1ZTogc3RyCiAgICAgICAgc2VsZi53aWR0aCA9IHdyYXBfY29udGVudAogICAgICAgIHNlbGYuaGVpZ2h0ID0gd3JhcF9jb250ZW50CiAgICAgICAgc2VsZi53ZWlnaHQgPSAwCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4ga3dhcmdzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLl9fZGljdF9fW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidXaWRnZXQodHlwZT17c2VsZi50eXBlfSwgVmFsdWU9e3NlbGYuVmFsdWV9KScKCiAgICBkZWYgdG9fanNvbihzZWxmKToKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhzZWxmLCBkZWZhdWx0PWxhbWJkYSB4OiB2YXJzKHgpLCBpbmRlbnQ9NCkKCgpjbGFzcyBQaWN0dXJlKFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHBpYycKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQaWN0dXJlIgoKCmNsYXNzIFRleHRWaWV3KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHZhbHVlJwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gIlRleHRWaWV3IgoKCmNsYXNzIENoZWNrQm94KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gJ0NoZWNrQm94JwoKCmNsYXNzIFBvcHVwTWVudUJ1dHRvbihXaWRnZXQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICBzZWxmLlZhbHVlID0gJ0B2YWx1ZScKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQb3B1cE1lbnVCdXR0b24iCiAgICAgICAgc2VsZi5zaG93X2J5X2NvbmRpdGlvbiA9ICcnCiAgICAgICAgc2VsZi5Ob1JlZnJlc2ggPSBGYWxzZQogICAgICAgIHNlbGYuZG9jdW1lbnRfdHlwZSA9ICcnCiAgICAgICAgc2VsZi5tYXNrID0gJycKCgpjbGFzcyBMaW5lYXJMYXlvdXQoV2lkZ2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZSA9ICdMaW5lYXJMYXlvdXQnCiAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICJ2ZXJ0aWNhbCIKCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykKICAgICAgICBzZWxmLkVsZW1lbnRzID0gbGlzdChhcmdzKSBvciBbXQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgKndpZGdldHMpOgogICAgICAgIGZvciB3aWRnZXQgaW4gd2lkZ2V0czoKICAgICAgICAgICAgc2VsZi5FbGVtZW50cy5hcHBlbmQod2lkZ2V0KQoKCmNsYXNzIE9wdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2VhcmNoX2VuYWJsZWQ9VHJ1ZSwgc2F2ZV9wb3NpdGlvbj1UcnVlLCBvdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgICAgIHNlbGYub3B0aW9ucyA9IHsKICAgICAgICAgICAgJ3NlYXJjaF9lbmFibGVkJzogc2VhcmNoX2VuYWJsZWQsCiAgICAgICAgICAgICdzYXZlX3Bvc2l0aW9uJzogc2F2ZV9wb3NpdGlvbiwKICAgICAgICAgICAgJ292ZXJyaWRlX3NlYXJjaCc6IG92ZXJyaWRlX3NlYXJjaAogICAgICAgIH0KCgpjbGFzcyBDdXN0b21DYXJkczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgY2FyZHNkYXRhOiBMaXN0W2RpY3RdID0gW10pOgogICAgICAgIHNlbGYuY3VzdG9tY2FyZHMgPSB7CiAgICAgICAgICAgICdvcHRpb25zJzogb3B0aW9ucyBvciBPcHRpb25zKCksCiAgICAgICAgICAgICdsYXlvdXQnOiBsYXlvdXQsCiAgICAgICAgICAgICdjYXJkc2RhdGEnOiBjYXJkc2RhdGEKICAgICAgICB9CgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoc2VsZiwgZGVmYXVsdD1sYW1iZGEgeDogdmFycyh4KSwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkKCgpjbGFzcyBDdXN0b21UYWJsZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgdGFibGVkYXRhOiBMaXN0W2RpY3RdKToKICAgICAgICBzZWxmLmN1c3RvbXRhYmxlID0gewogICAgICAgICAgICAnb3B0aW9ucyc6IG9wdGlvbnMgb3IgT3B0aW9ucygpLAogICAgICAgICAgICAnbGF5b3V0JzogbGF5b3V0LAogICAgICAgICAgICAndGFibGVkYXRhJzogdGFibGVkYXRhCiAgICAgICAgfQoKICAgIGRlZiB0b19qc29uKHNlbGYpOgogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHNlbGYsIGRlZmF1bHQ9bGFtYmRhIHg6IHZhcnMoeCksIGluZGVudD00LCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpCgoKQGRhdGFjbGFzcwpjbGFzcyBNb2Rlcm5GaWVsZDoKICAgIGhpbnQ6IHN0ciA9ICcnCiAgICBkZWZhdWx0X3RleHQ6IHN0ciA9ICcnCiAgICBjb3VudGVyOiBib29sID0gRmFsc2UKICAgIGNvdW50ZXJfbWF4OiBpbnQgPSAwCiAgICBpbnB1dF90eXBlOiBpbnQgPSAwCiAgICBwYXNzd29yZDogYm9vbCA9IEZhbHNlCiAgICBldmVudHM6IGJvb2wgPSBGYWxzZQoKICAgICIiIgogICAgVFlQRV9OVUxMOiAwCiAgICAKICAgIFRZUEVfQ0xBU1NfTlVNQkVSOiAyCiAgICBUWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUw6IDgxOTIgCiAgICBUWVBFX05VTUJFUl9GTEFHX1NJR05FRDogNDA5NiAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9QQVNTV09SRDogMTYKICAgIAogICAgVFlQRV9DTEFTU19EQVRFVElNRSA6IDQKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX0RBVEU6IDE2CiAgICBUWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX1RJTUU6IDMyCiAgICAKICAgIFRZUEVfQ0xBU1NfUEhPTkU6IDMKICAgIAogICAgVFlQRV9NQVNLX0NMQVNTOiAxNQogICAgVFlQRV9NQVNLX0ZMQUdTOiAxNjc3MzEyMCAKICAgIFRZUEVfTUFTS19WQVJJQVRJT046IDQwODAgCgogICAgVFlQRV9DTEFTU19URVhUOiAxCiAgICBUWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFOiA2NTUzNiAKICAgIFRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDogMzI3NjggCiAgICBUWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUzogNDA5NiAKICAgIFRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM6IDE2Mzg0IAogICAgVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTOiA4MTkyICAKICAgIFRZUEVfVEVYVF9GTEFHX0VOQUJMRV9URVhUX0NPTlZFUlNJT05fU1VHR0VTVElPTlM6IDEwNDg1NzYgCiAgICBUWVBFX1RFWFRfRkxBR19JTUVfTVVMVElfTElORTogMjYyMTQ0IAogICAgVFlQRV9URVhUX0ZMQUdfTVVMVElfTElORTogMTMxMDcyIAogICAgVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM6IDUyNDI4OCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfQUREUkVTUzogMzIKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfU1VCSkVDVDogNDgKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRklMVEVSOiAxNzYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX0xPTkdfTUVTU0FHRTogODAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMOiAwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEOiAxMjggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BFUlNPTl9OQU1FOiAgOTYKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUEhPTkVUSUM6IDE5MiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUE9TVEFMX0FERFJFU1M6IDExMiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fU0hPUlRfTUVTU0FHRTogNjQgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1VSSTogMTYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1ZJU0lCTEVfUEFTU1dPUkQ6IDE0NCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fV0VCX0VESVRfVEVYVDogMTYwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9FTUFJTF9BRERSRVNTOiAyMDggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9QQVNTV09SRDogMjI0IAogICAgIiIiCgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRlZmF1bHQ9bGFtYmRhIHg6IHtrOiB2IGZvciBrLCB2IGluIHZhcnMoeCkuaXRlbXMoKSBpZiB2fSwKICAgICAgICAgICAgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZQogICAgICAgICkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\version_control.py",
                "PyFileKey": "version_control",
                "PyFileData": "aW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCAgcmUKI2Zyb20KZGVmIGlzX3ZhbGlkX3ZlcnNpb24odmVyc2lvbik6CiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBjaGVjayBpZiB0aGUgdmVyc2lvbiBoYXMgdGhlIGNvcnJlY3QgZm9ybWF0ICh4LngueC54KQogICAgaWYgbm90IGlzaW5zdGFuY2UodmVyc2lvbiwgc3RyKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBwYXR0ZXJuID0gcideXGR7MSwyfShcLlxkezEsMn0pezR9JwoKICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIHZlcnNpb24pKQoKCiPQn9C10YDQtdCx0LjRgNCw0LXQvCDRgNC10LvQuNC30Ysg0L/QviDQvtC00L3QvtC80YMuINCk0YPQvdC60YbQuNGPINC/0YvRgtCw0LXRgtGB0Y8g0L3QsNC50YLQuCDQsiDQvNC+0LTRg9C70LUg0YTRg9C90LrRhtC40Y4g0YEg0LjQvNC10L3QtdC8LAojINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQvCDQvdC+0LzQtdGA0YMg0YDQtdC70LjQt9CwINC4INC10YHQu9C4INC90LDRiNC70LAgLSDQstGL0L/QvtC70L3QuNGC0Ywg0LXRkQpkZWYgcnVuX3JlbGVhc2VzKF9zdGFydF92ZXJzaW9uOnN0ciwgX2VuZF92ZXJzaW9uOnN0cik6CiAgICByZXR1cm5fbGlzdCA9IFtdCiAgICBpZiBub3QgaXNfdmFsaWRfdmVyc2lvbihfc3RhcnRfdmVyc2lvbikgb3Igbm90IGlzX3ZhbGlkX3ZlcnNpb24oX2VuZF92ZXJzaW9uKToKICAgICAgICByZXR1cm5fbGlzdC5hcHBlbmQoeydyZXN1bHQnOiBGYWxzZSwgJ2RldGFpbHMnOiAn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIg0LLQtdGA0YHQuNC4INC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuC4g0KTQvtGA0LzQsNGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCDQtNC+0LvQttC10L0g0LHRi9GC0YwgeC54LngueCd9KQogICAgICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiAgICB2ZXJzaW9uID0gX3N0YXJ0X3ZlcnNpb24KICAgIHdoaWxlIGNvbXBhcmVfdmVyc2lvbnModmVyc2lvbiwgX2VuZF92ZXJzaW9uKSA8PSAwOgogICAgICAgIHJlbGVhc2VfZnVuY3Rpb25fbmFtZSA9ICdyJyArIHZlcnNpb24ucmVwbGFjZSgnLicsICdfJykKICAgICAgICByZWxlYXNlX2Z1bmN0aW9uID0gZ2xvYmFscygpLmdldChyZWxlYXNlX2Z1bmN0aW9uX25hbWUpCiAgICAgICAgaWYgcmVsZWFzZV9mdW5jdGlvbiBhbmQgY2FsbGFibGUocmVsZWFzZV9mdW5jdGlvbik6CgogICAgICAgICAgICByZXMgPSByZWxlYXNlX2Z1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuX2xpc3QuYXBwZW5kKHJlcykKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcHJpbnQoZiJSZWxlYXNlIGZ1bmN0aW9uICd7cmVsZWFzZV9mdW5jdGlvbl9uYW1lfScgbm90IGZvdW5kLiIpCgogICAgICAgIHZlcnNpb24gPSBpbmNyZW1lbnRfdmVyc2lvbih2ZXJzaW9uKQoKICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiPQodGA0LDQstC90LjQstCw0LXQvCDQvdC+0LzQtdGA0LAg0LLQtdGA0YHQuNC4LiDQktC+0LfQstGA0LDRidCw0LXRgiAtMSDQn9C+0YHQu9C10LTQvdGP0Y8g0LLQtdGA0YHQuNGPINCy0YHQtSDQtdGJ0ZEg0LHQvtC70YzRiNC1LAojIDAg0LXRgdC70Lgg0YDQsNCy0L3RiyDQuCAxINC10YHQu9C4INGC0LXQutGD0YnQsNGPINCy0LXRgNGB0LjRjyDQsdC+0LvRjNGI0LUg0L/QvtGB0LvQtdC00L3QtdC5CmRlZiBjb21wYXJlX3ZlcnNpb25zKHZlcnNpb24xLCB2ZXJzaW9uMik6CiAgICBwYXJ0czEgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24xLnNwbGl0KCcuJykpKQogICAgcGFydHMyID0gbGlzdChtYXAoaW50LCB2ZXJzaW9uMi5zcGxpdCgnLicpKSkKCiAgICBmb3IgcDEsIHAyIGluIHppcChwYXJ0czEsIHBhcnRzMik6CiAgICAgICAgaWYgcDEgPCBwMjoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgZWxpZiBwMSA+IHAyOgogICAgICAgICAgICByZXR1cm4gMQoKICAgIHJldHVybiAwCgoKI9Cf0YDQuNCx0LDQstC70Y/QtdC8IDEg0Log0L3QvtC80LXRgNGDINGC0LXQutGD0YnQtdC5INCy0LXRgNGB0LjQuCAo0L/QviDQs9GA0YPQv9C/0LDQvCwKIyDQvNCw0LrRgdC40LzRg9C8IDk5INCyINC+0LTQvdC+0Lkg0LPRgNGD0L/Qv9C1KSDQndCw0L/RgNC40LzQtdGAIDEuMS4xLjEuOTkgKyAxINC00LDRgdGCINC90LDQvCAxLjEuMS4yLjAKZGVmIGluY3JlbWVudF92ZXJzaW9uKHZlcnNpb24pOgogICAgcGFydHMgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24uc3BsaXQoJy4nKSkpCiAgICBwYXJ0c1stMV0gKz0gMQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHBhcnRzKSAtIDEsIDAsIC0xKToKICAgICAgICBpZiBwYXJ0c1tpXSA9PSAxMDA6CiAgICAgICAgICAgIHBhcnRzW2ldID0gMAogICAgICAgICAgICBwYXJ0c1tpIC0gMV0gKz0gMQogICAgcmV0dXJuICcuJy5qb2luKG1hcChzdHIsIHBhcnRzKSkKCgoKZGVmIHIwXzFfMF8xMl8zKGhhc2hfbWFwKToKICAgICMgQ29kZSBmb3IgcmVsZWFzZSAwLjEuMC4xMi4zCiAgICBxdGV4dCA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlIEFTIFNFTEVDVCAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzOwogICAgCiAgICBEUk9QIFRBQkxFIFJTX2JhcmNvZGVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfYmFyY29kZXMgKAogICAgICAgIGJhcmNvZGUgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfcHJvcGVydHkgVEVYVCwKICAgICAgICBpZF9zZXJpZXMgICBURVhULAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQsCiAgICAgICAgcmF0aW8gICAgICAgSU5URUdFUiBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19iYXJjb2RlcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgICAgICAKICAgIFVQREFURQogICAgUlNfYmFyY29kZXMKICAgIFNFVAogICAgcmF0aW8gPSBDT0FMRVNDRSgoCiAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvci9SU191bml0cy5kZW5vbWluYXRvcgogICAgRlJPTSBSU191bml0cwogICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICApLCAxKTsKICAgIAogICAgICAgIAogICAgRFJPUCBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZTsKICAgIAogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDE7CiAgICAnJycKCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocXRleHQsJycpCiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOlRydWV9CiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOkZhbHNlLCAnZGV0YWlscyc6ZifQntGI0LjQsdC60LAg0LIg0LfQsNC/0YDQvtGB0LU6IHtxdGV4dH0nfQoKCmRlZiByMF8xXzBfMTNfNyhoYXNoX21hcCk6CgogICAgcSA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFCiAgICBUQUJMRQogICAgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUKICAgIEFTCiAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3NfdGFibGU7CgogICAgRFJPUCBUQUJMRSBSU19kb2NzX3RhYmxlOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc190YWJsZSgKICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgUlNfZG9jcyhpZF9kb2MpCiAgICBPTiBERUxFVEUgQ0FTQ0FERSBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICBpZF9nb29kIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyBSU19nb29kcyhpZCksCiAgICBpZF9wcm9wZXJ0aWVzIFRFWFQgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzKGlkKSwKICAgIGlkX3NlcmllcyBURVhUIFJFRkVSRU5DRVMgUlNfc2VyaWVzKGlkKSwKICAgIGlkX3VuaXQgVEVYVCBOT1QgTlVMTCBSRUZFUkVOQ0VTIFJTX3VuaXRzKGlkKSwKICAgIHF0dHkgUkVBTCwgCiAgICBxdHR5X3BsYW4gUkVBTCwKICAgIHByaWNlIFJFQUwsCiAgICBpZF9wcmljZSBURVhUIFJFRkVSRU5DRVMgIFJTX3ByaWNlX3R5cGVzKGlkKSwKICAgIHNlbnQgSU5URUdFUiwKICAgIGxhc3RfdXBkYXRlZCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiBURVhUIERFRkFVTFQgVHJ1ZSwKICAgIGlkX2NlbGwgVEVYVCBSRUZFUkVOQ0VTIFJTX2NlbGxzKGlkKSwKICAgIHVzZV9zZXJpZXMgICAgSU5UICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMCkKICAgICk7CgogICAgSU5TRVJUIElOVE8gUlNfZG9jc190YWJsZSgKICAgICAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksCiAgICAgICAgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UsIHNlbnQsIGxhc3RfdXBkYXRlZCwgaXNfcGxhbiwgaWRfY2VsbAogICAgKQogICAgU0VMRUNUCiAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwKICAgIHByaWNlLCBpZF9wcmljZSwgc2VudCwgbGFzdF91cGRhdGVkLCBpc19wbGFuLCBpZF9jZWxsIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgIERST1AgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKCiAgICBDUkVBVEUgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUgQVMgU0VMRUNUICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllczsKCiAgICBEUk9QIFRBQkxFIFJTX2RvY3Nfc2VyaWVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc19zZXJpZXMgKAogICAgICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX2RvYyAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICAgICAgaWRfZ29vZCAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgICAgICBpZF93YXJlaG91c2UgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICAgICAgcXR0eSAgICAgICAgICAgIFJFQUwsCiAgICAgICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGJlc3RfYmVmb3JlICAgICBEQVRFVElNRSwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgICAgIGNlbGwgICAgICAgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19jZWxscyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICk7CiAgICAKICAgIElOU0VSVCBJTlRPIFJTX2RvY3Nfc2VyaWVzICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF0dHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdHR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICAKICAgIENSRUFURSBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZSBBUyBTRUxFQ1QgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jczsKICAgIAogICAgRFJPUCBUQUJMRSBSU19hZHJfZG9jczsKICAgIAogICAgQ1JFQVRFIFRBQkxFIFJTX2Fkcl9kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSAgICBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICAgICBERUZBVUxUIDAsCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCBURVhUICAgICBERUZBVUxUICgwKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkgCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19hZHJfZG9jcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19kYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmlmaWVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21hcmtfc2VsZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBQUkFHTUEgZm9yZWlnbl9rZXlzID0gMTsKCgogICAgJycnCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocSwnJykKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6VHJ1ZX0KICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6RmFsc2UsICdkZXRhaWxzJzpmJ9Ce0YjQuNCx0LrQsCDQsiDQt9Cw0L/RgNC+0YHQtToge3F9J30KCgojIGlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiMgICAgICMgUmVwbGFjZSB0aGVzZSB2ZXJzaW9ucyB3aXRoIHlvdXIgYWN0dWFsIHZlcnNpb24gbnVtYmVycwojICAgICBzdGFydF92ZXJzaW9uID0gIjAuMS4wLjExLjciCiMgICAgIHN0YXJ0X3ZlcnNpb24gPSAoInMiKQojICAgICBlbmRfdmVyc2lvbiA9ICIwLjEuMC4xMi4zIgojCiMgICAgIHByaW50KHJ1bl9yZWxlYXNlcyhzdGFydF92ZXJzaW9uLCBlbmRfdmVyc2lvbikpCiNwcmludChpc192YWxpZF92ZXJzaW9uKCIwMS4xLjAuMTEuMjYiKSk="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\printing_factory.py",
                "PyFileKey": "printing_factory",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBUdXBsZSwgQW55LCBVbmlvbgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVVdGlsaXRlcyBhcyBzdUNsYXNzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgenBsCmZyb20gUElMIGltcG9ydCBJbWFnZQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cAppbXBvcnQgYmFyY29kZQpmcm9tIGJhcmNvZGUud3JpdGVyIGltcG9ydCBJbWFnZVdyaXRlcgppbXBvcnQgcXJjb2RlCmZyb20gamluamEyIGltcG9ydCBFbnZpcm9ubWVudCwgRmlsZVN5c3RlbUxvYWRlciwgc2VsZWN0X2F1dG9lc2NhcGUsIG1ldGEKaW1wb3J0IGJhc2U2NApmcm9tIGlvIGltcG9ydCBCeXRlc0lPCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwpmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZUJsdWV0b290aApub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCmJ0ID0gU2ltcGxlQmx1ZXRvb3RoKCkKCgpjbGFzcyBIVE1MRG9jdW1lbnQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVtcGxhdGVfZGlyZWN0b3J5LCB0ZW1wbGF0ZV9maWxlKToKICAgICAgICBzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSA9IHRlbXBsYXRlX2RpcmVjdG9yeQogICAgICAgIHNlbGYudGVtcGxhdGVfZmlsZSA9IHRlbXBsYXRlX2ZpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2VuZXJhdGVfYmFyY29kZShkYXRhLCBiYXJjb2RlX3R5cGU9J2VhbjEzJyk6CiAgICAgICAgZWFuX2NsYXNzID0gYmFyY29kZS5nZXRfYmFyY29kZV9jbGFzcyhiYXJjb2RlX3R5cGUpCiAgICAgICAgd3JpdGVyID0gSW1hZ2VXcml0ZXIoKQogICAgICAgIGVhbiA9IGVhbl9jbGFzcyhkYXRhLCB3cml0ZXI9d3JpdGVyKQoKICAgICAgICBiYXJjb2RlX2ltYWdlID0gQnl0ZXNJTygpCiAgICAgICAgZWFuLndyaXRlKGJhcmNvZGVfaW1hZ2UpCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYmFyY29kZV9pbWFnZS5nZXR2YWx1ZSgpKS5kZWNvZGUoKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZW5lcmF0ZV9xcl9jb2RlKGJhcmNvZGVfZGF0YSk6CiAgICAgICAgcXIgPSBxcmNvZGUuUVJDb2RlKHZlcnNpb249MSwgYm94X3NpemU9MTAsIGJvcmRlcj01KQogICAgICAgIHFyLmFkZF9kYXRhKGJhcmNvZGVfZGF0YSkKICAgICAgICBxci5tYWtlKGZpdD1UcnVlKQogICAgICAgIGltZyA9IHFyLm1ha2VfaW1hZ2UoZmlsbF9jb2xvcj0iYmxhY2siLCBiYWNrX2NvbG9yPSJ3aGl0ZSIpCgogICAgICAgIGJ1ZmZlcmVkID0gQnl0ZXNJTygpCiAgICAgICAgaW1nLnNhdmUoYnVmZmVyZWQsIGZvcm1hdD0iUE5HIikKCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYnVmZmVyZWQuZ2V0dmFsdWUoKSkuZGVjb2RlKCkKCiAgICBkZWYgY3JlYXRlX2h0bWwoc2VsZiwgcGFyYW1ldGVycywgYmFyY29kZV90eXBlPSdlYW4xMycpOgogICAgICAgIGVudiA9IEVudmlyb25tZW50KAogICAgICAgICAgICBsb2FkZXI9RmlsZVN5c3RlbUxvYWRlcihzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSksCiAgICAgICAgICAgIGF1dG9lc2NhcGU9c2VsZWN0X2F1dG9lc2NhcGUoWydodG1sJywgJ3htbCddKSwKICAgICAgICAgICAgdmFyaWFibGVfc3RhcnRfc3RyaW5nPSdbJywKICAgICAgICAgICAgdmFyaWFibGVfZW5kX3N0cmluZz0nXScsCiAgICAgICAgKQogICAgICAgIGlmIGJhcmNvZGVfdHlwZSA9PSAncXItY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGVfaW1hZ2VfYmFzZTY0ID0gc2VsZi5nZW5lcmF0ZV9xcl9jb2RlKHBhcmFtZXRlcnNbJ2JhcmNvZGUnXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlX2ltYWdlX2Jhc2U2NCA9IHNlbGYuZ2VuZXJhdGVfYmFyY29kZShwYXJhbWV0ZXJzWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGVfdHlwZSkKCiAgICAgICAgdGVtcGxhdGUgPSBlbnYuZ2V0X3RlbXBsYXRlKHNlbGYudGVtcGxhdGVfZmlsZSkKCiAgICAgICAgYWEgPSB0ZW1wbGF0ZS5yZW5kZXIocGFyYW1ldGVycykKCiAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAoYWEsICdodG1sLnBhcnNlcicpCiAgICAgICAgZm9yIGltZ3RhZyBpbiBzb3VwLmZpbmRfYWxsKCJpbWciKToKICAgICAgICAgICAgaW1ndGFnWydzcmMnXSA9ICgiZGF0YTppbWFnZS9wbmc7IHdpZHRoOmF1dG87IGhlaWdodDphdXRvOyBiYXNlNjQsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYmFyY29kZV9pbWFnZV9iYXNlNjQpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZmluZF90ZW1wbGF0ZV92YXJpYWJsZXMoZGlyZWN0b3J5OiBzdHIsIGZpbGVfbmFtZTogc3RyKToKICAgICAgICBlbnYgPSBFbnZpcm9ubWVudCgKICAgICAgICAgICAgbG9hZGVyPUZpbGVTeXN0ZW1Mb2FkZXIoZGlyZWN0b3J5KSwKICAgICAgICAgICAgYXV0b2VzY2FwZT1zZWxlY3RfYXV0b2VzY2FwZShbJ2h0bWwnLCAneG1sJ10pLAogICAgICAgICAgICB2YXJpYWJsZV9zdGFydF9zdHJpbmc9J1snLAogICAgICAgICAgICB2YXJpYWJsZV9lbmRfc3RyaW5nPSddJywKICAgICAgICApCiAgICAgICAgdGVtcGxhdGVfc291cmNlID0gZW52LmxvYWRlci5nZXRfc291cmNlKGVudiwgZmlsZV9uYW1lKVswXQogICAgICAgIHBhcnNlZF9jb250ZW50ID0gZW52LnBhcnNlKHRlbXBsYXRlX3NvdXJjZSkKICAgICAgICBwYXJhbXMgPSBtZXRhLmZpbmRfdW5kZWNsYXJlZF92YXJpYWJsZXMocGFyc2VkX2NvbnRlbnQpCiAgICAgICAgaWYgJ2JhcmNvZGUnIG5vdCBpbiBwYXJhbXM6CiAgICAgICAgICAgIHBhcmFtcy5hZGQoJ2JhcmNvZGUnKQogICAgICAgIHJldHVybiBwYXJhbXMKCiAgICBkZWYgZ2V0X3RlbXBsYXRlKHNlbGYpOgoKICAgICAgICB3aXRoIG9wZW4oUGF0aChzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSkgLyBzZWxmLnRlbXBsYXRlX2ZpbGUsICJyIiwKICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9InV0Zi04IikgYXMgZmlsZToKICAgICAgICAgICAgaHRtbF9ib2R5ID0gZmlsZS5yZWFkKCkKCiAgICAgICAgcmV0dXJuIGh0bWxfYm9keQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbmplY3RfY3NzX3N0eWxlKGh0bWwsIHdpZHRoOiBzdHIsIGhlaWdodDogc3RyLCB4OiBzdHIsIHk6IHN0cik6CiAgICAgICAgY3NzX3RlbXBsYXRlMiA9ICcnJwogICAgICAgICAgQHBhZ2UgewogICAgICAgICAgICBtYXJnaW46IDFtbTsgLyogQWRqdXN0IGlmIG5lY2Vzc2FyeSAqLwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZmZmZjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsOwogICAgICAgICAgICBmb250LXNpemU6IDhwdDsKICAgICAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgICAgIH0KCiAgICAgICAgLmZ1bGwtdGVtcGxhdGUgewogICAgICAgICAgICB3aWR0aDogY2FsYygxMDB2dyAtIDJtbSk7ICAKICAgICAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMm1tKTsKICAgICAgICAgICAgbWluLXdpZHRoOiA0MG1tOyAgICAvKiBNaW5pbXVtIHdpZHRoICovCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQwbW07ICAgLyogTWluaW11bSBoZWlnaHQgKi8KICAgICAgICAgICAgYm9yZGVyOiAxcHQgc29saWQgYmxhY2s7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IC8qIGVuc3VyZXMgcGFkZGluZyBhbmQgYm9yZGVyIGFyZSBpbmNsdWRlZCBpbiB0aGUgdG90YWwgd2lkdGggYW5kIGhlaWdodCAqLwogICAgICAgICAgICBwYWdlLWJyZWFrLWluc2lkZTogYXZvaWQ7IC8qIEF2b2lkIGJyZWFraW5nIGluc2lkZSB0aGUgdGVtcGxhdGUgKi8KICAgICAgICB9CgogICAgICAgIGltZyB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKCcnJyArIHggKyAnJydweCwgJycnICsgeSArICcnJ3B4KTsKICAgICAgICAgICAgd2lkdGg6ICcnJyArIHdpZHRoICsgJycnbW07CiAgICAgICAgICAgIGhlaWdodDogJycnICsgaGVpZ2h0ICsgJycnbW07CiAgICAgICAgfQoKICAgICAgICB0YWJsZSB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7CiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgICAgICAgICAgIHBhZ2UtYnJlYWstaW5zaWRlOiBhdm9pZDsgLyogQXZvaWQgYnJlYWtpbmcgaW5zaWRlIHRoZSB0YWJsZSAqLwogICAgICAgIH0KCiAgICAgICAgdGQgewogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgfQogICAgICAgICcnJwoKICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cChodG1sLCAiaHRtbC5wYXJzZXIiKQogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INGB0LLQvtC4INGB0YLQuNC70Lgg0LIg0LTQvtC60YPQvNC10L3RggogICAgICAgIGhlYWRfdGFnID0gc291cC5oZWFkCiAgICAgICAgc3R5bGVfdGFnID0gc291cC5uZXdfdGFnKCJzdHlsZSIpCiAgICAgICAgc3R5bGVfdGFnLnN0cmluZyA9IGNzc190ZW1wbGF0ZTIKICAgICAgICBoZWFkX3RhZy5hcHBlbmQoc3R5bGVfdGFnKQogICAgICAgICMg0JfQsNC/0LjRhdGD0LXQvCDQstC10YHRjCDQtNC+0LrRg9C80LXQvdGCINCyINC60L7QvdGC0LXQudC90LXRgAogICAgICAgIHdyYXBwZXIgPSBzb3VwLm5ld190YWcoImRpdiIpCiAgICAgICAgd3JhcHBlclsnY2xhc3MnXSA9ICdmdWxsLXRlbXBsYXRlJwogICAgICAgIGJvZHlfY2hpbGRyZW4gPSBsaXN0KHNvdXAuYm9keS5jaGlsZHJlbikKICAgICAgICBzb3VwLmJvZHkuY2xlYXIoKQogICAgICAgIHNvdXAuYm9keS5hcHBlbmQod3JhcHBlcikKICAgICAgICBmb3IgY2hpbGQgaW4gYm9keV9jaGlsZHJlbjoKICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoY2hpbGQpCgogICAgICAgICMg0KPQtNCw0LvRj9C10Lwg0L/Rg9GB0YLRi9C1INGP0YfQtdC50LrQuCDQuNC3INGC0LDQsdC70LjRhtGLLCDQutC+0YLQvtGA0YvQtSDRgtCw0Log0LvRjtCx0LjRgiAx0YEKICAgICAgICBmb3IgdHIgaW4gc291cC5maW5kX2FsbCgndHInKToKCiAgICAgICAgICAgIGZvciB0ZCBpbiB0ci5maW5kX2FsbCgndGQnKToKICAgICAgICAgICAgICAgIGlmIG5vdCB0ZC5hdHRycy5nZXQoJ2NsYXNzJyk6CiAgICAgICAgICAgICAgICAgICAgdGQuZGVjb21wb3NlKCkKICAgICAgICAjINCb0LjRiNC90LjQtSDQutC+0LvQvtC90LrQuCDRgdC/0YDQsNCy0LAg0YPQtNCw0LvRj9C10Lwg0YLQvtC20LUKICAgICAgICBmb3IgY29sIGluIHNvdXAuZmluZF9hbGwoJ2NvbCcpOgogICAgICAgICAgICBpZiBub3QgY29sLmF0dHJzOgogICAgICAgICAgICAgICAgY29sLmRlY29tcG9zZSgpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCgpjbGFzcyBQcmludFNlcnZpY2U6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU6IGludCwKICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBwYXRoX3RvX2ltZzogc3RyCiAgICApIC0+IHN0cjoKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMgenBsINGBINC60LDRgNGC0LjQvdC60L7QuSDQstC90YPRgtGA0LgiIiIKICAgICAgICBsYWJlbCA9IHpwbC5MYWJlbCgKICAgICAgICAgICAgd2lkdGg9aW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUgKiAyLAogICAgICAgICAgICBoZWlnaHQ9aW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlICogMiwKICAgICAgICAgICAgZHBtbT1kcG1tX3ByaW50X3RlbXBsYXRlCiAgICAgICAgKQogICAgICAgIGxhYmVsLm9yaWdpbihpbWFnZV94X3ByaW50X3RlbXBsYXRlLCBpbWFnZV95X3ByaW50X3RlbXBsYXRlKQogICAgICAgIGxhYmVsLndyaXRlX2dyYXBoaWMoCiAgICAgICAgICAgIGltYWdlPUltYWdlLm9wZW4ocGF0aF90b19pbWcpLAogICAgICAgICAgICB3aWR0aD1pbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZSAqIDIsCiAgICAgICAgICAgIGhlaWdodD1pbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUgKiAyCiAgICAgICAgKQogICAgICAgIGxhYmVsLmVuZG9yaWdpbigpCiAgICAgICAgenBsX2RhdGEgPSBsYWJlbC5kdW1wWlBMKCkKICAgICAgICBsbCA9IGltYWdlX2xsX3ByaW50X3RlbXBsYXRlCiAgICAgICAgcHcgPSBpbWFnZV9wd19wcmludF90ZW1wbGF0ZQogICAgICAgIGlmIGxsIGFuZCBwdzoKICAgICAgICAgICAgenBsX2RhdGEgPSB6cGxfZGF0YS5yZXBsYWNlKCdeWEEnLCAnXlhBJyArIGYnXkxMe2xsfScgKyBmJ15QV3twd30nLCAxKQogICAgICAgIHJldHVybiB6cGxfZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB6cGxfdG9fcG5nX2Zyb21fYXBpKAogICAgICAgICAgICB6cGxfZGF0YTogc3RyLAogICAgICAgICAgICBkcG1tOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX3dpZHRoOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX2hlaWdodDogaW50LAogICAgKSAtPiBUdXBsZVtib29sLCBBbnldOgogICAgICAgICIiIgogICAgICAgINCU0LXQu9Cw0LXRgiDQt9Cw0L/RgNC+0YEg0LogQVBJLiDQntGC0L/RgNCw0LLQu9GP0Y7RgtGB0Y8genBsINC60L7QtCDQuCDRgNCw0LfQvNC10YDRiyDRjdGC0LjQutC10YLQutC4LgogICAgICAgICIiIgogICAgICAgIGZpbGVzID0geydmaWxlJzogenBsX2RhdGF9CgogICAgICAgIHVybCA9IChmJ2h0dHA6Ly9hcGkubGFiZWxhcnkuY29tL3YxL3ByaW50ZXJzL3tkcG1tfWRwbW0vJwogICAgICAgICAgICAgICBmJ2xhYmVscy97bW1fdG9faW5jaChsYWJlbF93aWR0aCAqIDIpfXh7bW1fdG9faW5jaChsYWJlbF9oZWlnaHQgKiAyKX0vMC8nKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIHN0cmVhbT1UcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgcmVzcG9uc2UudGV4dAoKICAgICAgICByZXNwb25zZS5yYXcuZGVjb2RlX2NvbnRlbnQgPSBUcnVlCiAgICAgICAgcmV0dXJuIFRydWUsIHJlc3BvbnNlLnJhdwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludChoYXNoX21hcCwgZGF0YTogZGljdCk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsYWJlbF9wYXRoID0gcHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJykKICAgICAgICBpZiBub3QgbGFiZWxfcGF0aDoKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRiNCw0LHQu9C+0L3QsCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhwcmludF9uY2wuZ2V0KCdtYXRjaGluZ190YWJsZScpKQogICAgICAgIHRlbXBsYXRlX2RpcmVjdG9yeSwgdGVtcGxhdGVfZmlsZSA9IG9zLnBhdGguc3BsaXQobGFiZWxfcGF0aCkKICAgICAgICBkYXRhX2Zvcl9wcmludGluZyA9IHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGEsIG1hdGNoaW5nX3RhYmxlKQoKICAgICAgICBodG1scmVzdWx0ID0gSFRNTERvY3VtZW50KAogICAgICAgICAgICB0ZW1wbGF0ZV9kaXJlY3RvcnksIHRlbXBsYXRlX2ZpbGUKICAgICAgICApLmNyZWF0ZV9odG1sKGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9cHJpbnRfbmNsLmdldCgnYmFyY29kZV90eXBlJykpCgogICAgICAgIGh0bWxyZXN1bHQgPSBIVE1MRG9jdW1lbnQuaW5qZWN0X2Nzc19zdHlsZSgKICAgICAgICAgICAgaHRtbHJlc3VsdCwKICAgICAgICAgICAgd2lkdGg9c3RyKGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX3dpZHRoJykpKSwKICAgICAgICAgICAgaGVpZ2h0PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9oZWlnaHQnKSkpLAogICAgICAgICAgICB4PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9yaWdodCcpKQogICAgICAgICAgICAgICAgICAtIGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX2xlZnQnKSkpLAogICAgICAgICAgICB5PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9kb3duJykpCiAgICAgICAgICAgICAgICAgIC0gaW50KHByaW50X25jbC5nZXQoJ2JhcmNvZGVfdXAnKSkpLAogICAgICAgICkKCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Ce0YLQv9GA0LDQstC70LXQvdC+INC90LAg0L/QtdGH0LDRgtGMJykKICAgICAgICBoYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJSdW5FdmVudCIsCiAgICAgICAgICAgIGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICJhY3Rpb24iOiAicnVuYXN5bmMiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiaHRtbDJpbWFnZSIsCiAgICAgICAgICAgICAgICAibWV0aG9kIjogaHRtbHJlc3VsdCwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6IGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uIjogInJ1biIsCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicHl0aG9uIiwKICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogInByaW50X3Bvc3RfZXhlY3V0ZSIKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9XSkKICAgICAgICApCgogICAgICAgIGZpbGVuYW1lID0gc3VDbGFzcy5nZXRfdGVtcF9maWxlKCJwbmciKQogICAgICAgIHByaW50X25jbC5wdXQoJ3BhdGhfdG9faHRtbDJpbWFnZV9maWxlJywgZmlsZW5hbWUsIFRydWUpCiAgICAgICAgaGFzaF9tYXAucHV0KCJodG1sMmltYWdlX1RvRmlsZSIsIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHBhdGhfdG9faW1nID0gcHJpbnRfbmNsLmdldCgncGF0aF90b19odG1sMmltYWdlX2ZpbGUnKQogICAgICAgIHNhdmVkX3RlbXBsYXRlID0gcHJpbnRfbmNsLmdldCgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGlmIG5vdCBzYXZlZF90ZW1wbGF0ZToKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRgdC+0YXRgNCw0L3QtdC90L3QvtCz0L4g0YjQsNCx0LvQvtC90LAg0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2F2ZWRfdGVtcGxhdGUgPSBqc29uLmxvYWRzKHNhdmVkX3RlbXBsYXRlKQogICAgICAgIHpwbGRhdGEgPSBQcmludFNlcnZpY2UubWFrZV96cGxfZnJvbV9sYWJlbCgKICAgICAgICAgICAgcGF0aF90b19pbWc9cGF0aF90b19pbWcsICoqc2F2ZWRfdGVtcGxhdGUpCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50X3pwbCh6cGxkYXRhLCBoYXNoX21hcCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfenBsKHpwbF9kYXRhOiBzdHIsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBwcmludF90aHJvdWdoID0gcHJpbnRfbmNsLmdldCgncHJpbnRfdGhyb3VnaCcpCiAgICAgICAgaWYgbm90IHByaW50X3Rocm91Z2g6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INCy0YvQsdGA0LDQvdC+INGD0YHRgtGA0L7QudGB0YLQstC+INC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgIGVsaWYgcHJpbnRfdGhyb3VnaCA9PSAnQlQnOgogICAgICAgICAgICBzZW50LCByZXN1bHQgPSBQcmludFNlcnZpY2UucHJpbnRfYnQoenBsX2RhdGEpCiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KHJlc3VsdCkKICAgICAgICBlbGlmIHByaW50X3Rocm91Z2ggPT0gJ1dpRmknOgogICAgICAgICAgICBwcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGxfZGF0YSwgVHJ1ZSkKICAgICAgICAgICAgaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfd2lmaShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaXAgPSBwcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRhdGEgPSBwcmludF9uY2wuZ2V0KCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L/QtdGH0LDRgtC4IHdpZmknKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBwcmludF9uY2wuZGVsZXRlKCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGZhaWxfaGFuZGxlcnMgPSBbeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJ3aWZpX2Vycm9yIn1dCiAgICAgICAgc2VuZGVkID0gc3VDbGFzcy53cml0ZV9zb2NrZXQoaXAsIDkxMDAsIGRhdGEsIGpzb24uZHVtcHMoZmFpbF9oYW5kbGVycykpCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cj0YHQv9C10YjQvdC+JyBpZiBzZW5kZWQgZWxzZSAn0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3QvicpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHByaW50X2J0KGRhdGE6IFVuaW9uW3N0ciwgaW50LCBieXRlc10pOgogICAgICAgIG5jbCA9IG5vQ2xhc3MoImJ0X3NldHRpbmdzIikKICAgICAgICBidF9oYW5kbGVycyA9IFt7ImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJweXRob24iLCAibWV0aG9kIjogImJsdWV0b290aF9lcnJvciJ9XQogICAgICAgIHByaW50ZXIgPSBuY2wuZ2V0KCJkZWZhdWx0X3ByaW50ZXIiKQogICAgICAgIGlmIHByaW50ZXIgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCAi0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3Qvi7QndC1INCy0YvQsdGA0LDQvSBCVC3Qv9GA0LjQvdGC0LXRgCIKICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKHByaW50ZXIpCiAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgItCd0LUg0L7RgtC/0YDQsNCy0LvQtdC90L4u0J3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8g0Log0YPRgdGC0YDQvtC50YHRgtCy0YMiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgKCLQntGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjC4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiDQn9C10YDQtdC/0L7QtNC60LvRjtGH0LjRgtC1INC/0YDQuNC90YLQtdGALCDQtdGB0LvQuCDQv9C10YfQsNGC0Ywg0L3QtSDQvdCw0YfQsNC70LDRgdGMIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJ0LmNvbm5lY3RfdG9fY2xpZW50KGRldmljZSwganNvbi5kdW1wcyhidF9oYW5kbGVycykpCiAgICAgICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUsICLQo9GB0L/QtdGI0L3QviDQvtGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjCIKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2htYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2htYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgaGFzaG1hcC5wdXQoInNwZWFrIiwgItCd0LUg0YPQtNCw0LvQvtGB0Ywg0L/QvtC00LrQu9GO0YfQuNGC0YzRgdGPIEJsdWV0b290aCIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHdpZmlfZXJyb3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIGhhc2hfbWFwLnB1dCgic3BlYWsiLCAi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8gV2lGaSIpCgoKZGVmIG1tX3RvX2luY2goc2l6ZV9tbTogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX21tIC8gMjUuNAoKCmRlZiBpbmNoX3RvX21tKHNpemVfaW5jaDogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX2luY2ggKiAyNS40CgoKZGVmIHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGFfZm9yX3ByaW50aW5nLCBwYXJhbXNfbWF0Y2gpOgogICAgbmV3X2RhdGEgPSB7fQogICAgZm9yIG1hdGNoIGluIHBhcmFtc19tYXRjaDoKICAgICAgICBpZiBtYXRjaFsndmFsdWUnXSBpbiBkYXRhX2Zvcl9wcmludGluZy5rZXlzKCk6CiAgICAgICAgICAgIG5ld19kYXRhW21hdGNoWydrZXknXV0gPSBkYXRhX2Zvcl9wcmludGluZ1ttYXRjaFsndmFsdWUnXV0KICAgIHJldHVybiBuZXdfZGF0YQo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\tiny_db_services.py",
                "PyFileKey": "tiny_db_services",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0LCBVbmlvbiwgRGljdCwgQW55LCBPcHRpb25hbCwgVHVwbGUKZnJvbSBmdW5jdG9vbHMgaW1wb3J0IHJlZHVjZQpmcm9tIHRpbnlkYiBpbXBvcnQgVGlueURCLCBRdWVyeSwgd2hlcmUKCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBUaW55Tm9TUUxQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lLCBiYXNlX25hbWU9J1NpbXBsZUtlZXAnLCBkYl9wYXRoPScnKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5iYXNlX25hbWUgPSBiYXNlX25hbWUgb3IgcnNfc2V0dGluZ3MuZ2V0KCdzcWxpdGVfbmFtZScpCiAgICAgICAgc2VsZi5kYl9wYXRoID0gZGJfcGF0aCBvciByc19zZXR0aW5ncy5nZXQoJ3BhdGhfdG9fZGF0YWJhc2VzJykKICAgICAgICBzZWxmLmRiID0gVGlueURCKG9zLnBhdGguam9pbihzZWxmLmRiX3BhdGgsIGYne3NlbGYuYmFzZV9uYW1lfS5qc29uJykpCiAgICAgICAgc2VsZi50YWJsZSA9IHNlbGYuZGIudGFibGUoc2VsZi50YWJsZV9uYW1lKQogICAgICAgIHNlbGYucXVlcnkgPSBRdWVyeSgpCgogICAgZGVmIGRyb3BfdGFibGUoc2VsZiwgdGFibGVfbmFtZSk6CiAgICAgICAgc2VsZi5kYi5kcm9wX3RhYmxlKHRhYmxlX25hbWUpCgogICAgZGVmIGdldF9hbGwoc2VsZikgLT4gbGlzdDoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5hbGwoKQoKICAgIGRlZiBnZXQoc2VsZiwgKipjb25kKSAtPiBVbmlvbltEaWN0LCBOb25lXToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5nZXQoY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHNlYXJjaChzZWxmLCAqKmNvbmQpIC0+IGxpc3Q6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuc2VhcmNoKGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBpbnNlcnQoc2VsZiwgZGF0YTogZGljdCkgLT4gaW50OgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmluc2VydChkYXRhKQoKICAgIGRlZiBpbnNlcnRfbXVsdGlwbGUoc2VsZiwgZGF0YTogTGlzdFtkaWN0XSkgLT4gTGlzdFtpbnRdOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmluc2VydF9tdWx0aXBsZShkYXRhKQoKICAgIGRlZiB1cGRhdGUoc2VsZiwgZGF0YTogZGljdCwgKipjb25kKSAtPiBMaXN0W2ludF06CiAgICAgICAgIiIiCiAgICAgICAgZGVsZXRlKGtleSk6IGRlbGV0ZSBhIGtleSBmcm9tIHRoZSBkb2N1bWVudAogICAgICAgIGluY3JlbWVudChrZXkpOiBpbmNyZW1lbnQgdGhlIHZhbHVlIG9mIGEga2V5CiAgICAgICAgZGVjcmVtZW50KGtleSk6IGRlY3JlbWVudCB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBhZGQoa2V5LCB2YWx1ZSk6IGFkZCB2YWx1ZSB0byB0aGUgdmFsdWUgb2YgYSBrZXkgKGFsc28gd29ya3MgZm9yIHN0cmluZ3MpCiAgICAgICAgc3VidHJhY3Qoa2V5LCB2YWx1ZSk6IHN1YnRyYWN0IHZhbHVlIGZyb20gdGhlIHZhbHVlIG9mIGEga2V5CiAgICAgICAgc2V0KGtleSwgdmFsdWUpOiBzZXQga2V5IHRvIHZhbHVlCiAgICAgICAgZGIudXBkYXRlKGRlbGV0ZSgna2V5MScpLCBVc2VyLm5hbWUgPT0gJ0pvaG4nKQogICAgICAgIGRiLnVwZGF0ZSh5b3VyX29wZXJhdGlvbihhcmd1bWVudHMpLCBxdWVyeSkKICAgICAgICAiIiIKCiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUudXBkYXRlKGRhdGEsIGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiB1cHNlcnQoc2VsZiwgZGF0YSwgKipjb25kKSAtPiBMaXN0W2ludF06CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUudXBzZXJ0KGRhdGEsIGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiByZW1vdmUoc2VsZiwgZG9jX2lkcz1Ob25lLCAqKmNvbmQpOgogICAgICAgIGlmIGRvY19pZHM6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnRhYmxlLnJlbW92ZShkb2NfaWRzPWRvY19pZHMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYudGFibGUucmVtb3ZlKGNvbmQ9c2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpLCBkb2NfaWRzPWRvY19pZHMpCgogICAgZGVmIGNvbnRhaW5zKHNlbGYsICoqY29uZCk6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuY29udGFpbnMoc2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBjb3VudChzZWxmLCAqKmNvbmQpOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmNvdW50KHNlbGYuX2NyZWF0ZV9jb25kaXRpb24oKipjb25kKSkKCiAgICBkZWYgY2xvc2Uoc2VsZik6CiAgICAgICAgc2VsZi5kYi5jbG9zZSgpCgogICAgZGVmIF9jcmVhdGVfY29uZGl0aW9uKHNlbGYsICoqY29uZCkgLT4gUXVlcnk6CiAgICAgICAgY29uZGl0aW9ucyA9IFsoc2VsZi5xdWVyeVtrZXldID09IHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBjb25kLml0ZW1zKCldCiAgICAgICAgcmV0dXJuIHJlZHVjZShsYW1iZGEgYSwgYjogYSAmIGIsIGNvbmRpdGlvbnMpCgoKY2xhc3MgU2Nhbm5pbmdRdWV1ZVNlcnZpY2U6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcHJvdmlkZXI9Tm9uZSk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gJ3NjYW5uaW5nX3F1ZXVlJwogICAgICAgIHNlbGYucHJvdmlkZXIgPSBwcm92aWRlciBvciBUaW55Tm9TUUxQcm92aWRlcih0YWJsZV9uYW1lPXNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgZ2V0X2RvY19zY2FubmluZ19xdWV1ZShzZWxmLCBpZF9kb2MpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0ge30KICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYykKCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhOgogICAgICAgICAgICByZXN1bHRbcm93Wydyb3dfa2V5J11dID0gcm93WydxdHR5J10jIyBOT1QgV09SSwoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIHNhdmVfc2Nhbm5lZF9yb3dfZGF0YShzZWxmLCBkYXRhLCBzZW50PUZhbHNlKTogICNUT0RPINCyINGC0LXRgdGC0Ysg0J7Qu9C10LMKICAgICAgICAjIGlkX2RvYywgcm93X2lkLCBxdHR5CiAgICAgICAgZGF0YVsnc2VudCddID0gc2VudAogICAgICAgIHNlbGYucHJvdmlkZXIuaW5zZXJ0KGRhdGE9ZGF0YSkKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5jb3VudChpZF9kb2M9ZGF0YVsnaWRfZG9jJ10pCgogICAgZGVmIGdldF9zY2FubmVkX3Jvd19xdHR5KHNlbGYsIGlkX2RvYywgcm93X2lkKToKICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYywgcm93X2lkPXJvd19pZCkKICAgICAgICByZXR1cm4gc3VtKFtyb3dbJ3F0dHknXSBmb3Igcm93IGluIGRhdGFdKSAgIyBvciAnZF9xdHR5JwoKICAgIGRlZiBnZXRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBzZW50PU5vbmUpIC0+IGxpc3Q6CiAgICAgICAgaWYgc2VudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgZGF0YSA9IHNlbGYucHJvdmlkZXIuc2VhcmNoKGlkX2RvYz1pZF9kb2MsIHNlbnQ9c2VudCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYykKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiB1cGRhdGVfc2VudF9saW5lcyhzZWxmLCBzZW50X2RhdGE6IGxpc3QsIHNlbnQ9VHJ1ZSk6CiAgICAgICAgZG9jX2lkX2xpc3QgPSBbeC5kb2NfaWQgZm9yIHggaW4gc2VudF9kYXRhXQogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGUudXBkYXRlKHsnc2VudCc6IHNlbnR9LCBkb2NfaWRzPWRvY19pZF9saXN0KQoKICAgIGRlZiBoYXNfdW5zZW50X2xpbmVzKHNlbGYsIGlkX2RvYykgLT4gYm9vbDoKICAgICAgICBxdHR5ID0gc2VsZi5wcm92aWRlci5jb3VudChpZF9kb2M9aWRfZG9jLCBzZW50PUZhbHNlKQogICAgICAgIHJldHVybiBUcnVlIGlmIHF0dHkgPiAwIGVsc2UgRmFsc2UKCiAgICBkZWYgcmVtb3ZlX2RvY19saW5lcyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHNlbGYucHJvdmlkZXIucmVtb3ZlKGlkX2RvYz1pZF9kb2MpCgoKY2xhc3MgRXhjaGFuZ2VRdWV1ZUJ1ZmZlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lLCApOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyID0gVGlueU5vU1FMUHJvdmlkZXIodGFibGVfbmFtZT1zZWxmLnRhYmxlX25hbWUpCgogICAgZGVmIHNhdmVfZGF0YV90b19zZW5kKHNlbGYsIGRhdGEsIHBrKToKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci51cHNlcnQoZGF0YT1kYXRhLCBwaz1waykKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5nZXRfYWxsKCkKCiAgICBkZWYgcmVtb3ZlX3NlbnRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBkb2NfaWRfbGlzdCA9IFt4LmRvY19pZCBmb3IgeCBpbiBkYXRhXQogICAgICAgIHNlbGYucHJvdmlkZXIucmVtb3ZlKGRvY19pZHM9ZG9jX2lkX2xpc3QpCgoKY2xhc3MgTm9TUUxQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lOiBzdHIpOgogICAgICAgIHNlbGYubm9zcWwgPSBub0NsYXNzKG5hbWUpCiAgICAgICAgc2VsZi5ub3NxbF9uYW1lID0gbmFtZQoKICAgIGRlZiBwdXQoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGtleTogc3RyLAogICAgICAgICAgICB2YWx1ZTogVW5pb25bc3RyLCBpbnQsIGJvb2wsIExpc3QsIERpY3QsIFR1cGxlXSwKICAgICAgICAgICAgcXVldWU6IGJvb2wgPSBUcnVlLAogICAgICAgICAgICB0b19qc29uOiBib29sID0gRmFsc2UKICAgICkgLT4gTm9uZToKICAgICAgICAiIiIKICAgICAgICDQn9C+0LzQtdGJ0LDQtdGCINC30L3QsNGH0LXQvdC40LUg0LIg0YPQutCw0LfQsNC90L3Ri9C5INC60LvRjtGHLgogICAgICAgIHN0ciwgaW50LCBib29sIC0g0L/QvtC80LXRidCw0LXQvCDQutCw0Log0LXRgdGC0YwKICAgICAgICBsaXN0LCBkaWN0LCB0dXBsZSAtINC/0YDQtdC+0LHRgNCw0LfQvtCy0YvQstCw0LXQvCDQsiDRgdGC0YDQvtC60YMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IGlzaW5zdGFuY2Uoa2V5LCBzdHIpOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ9Ca0LvRjtGHIE5vU1FMINC00L7Qu9C20LXQvSDQsdGL0YLRjCDRgdGC0YDQvtC60L7QuScpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgKHN0ciwgaW50LCBib29sKSk6CiAgICAgICAgICAgIHNlbGYubm9zcWwucHV0KGtleSwgdmFsdWUsIHF1ZXVlKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBub3QgdG9fanNvbjoKICAgICAgICAgICAgcmFpc2UgVHlwZUVycm9yKCfQodC/0LjRgdC+0Log0LTQvtC/0YPRgdGC0LjQvNGL0YUg0YLQuNC/0L7QsiBOb1NRTDogc3RyLCBpbnQsIGJvb2wnKQogICAgICAgIGlmIGlzaW5zdGFuY2UodmFsdWUsIChMaXN0LCBEaWN0LCBUdXBsZSkpOgogICAgICAgICAgICBzZWxmLm5vc3FsLnB1dChrZXksIGpzb24uZHVtcHModmFsdWUpLCBxdWV1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoZidOb1NRTC4g0J3QtdC70YzQt9GPINGB0LXRgNC40LDQu9C40LfQvtCy0LDRgtGMIHt0eXBlKHZhbHVlKX0nKQoKICAgIGRlZiBnZXQoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGtleTogc3RyLAogICAgICAgICAgICBkZWZhdWx0OiBPcHRpb25hbFtBbnldID0gTm9uZSwKICAgICAgICAgICAgZnJvbV9qc29uOiBib29sID0gRmFsc2UKICAgICkgLT4gQW55OgogICAgICAgICIiItCf0L7Qu9GD0YfQsNC10YIg0LfQvdCw0YfQtdC90LjQtSDQv9C+INC60LvRjtGH0YMiIiIKICAgICAgICByZXN1bHQgPSBzZWxmLm5vc3FsLmdldChrZXkpCiAgICAgICAgaWYgcmVzdWx0IGlzIG5vdCBOb25lOgogICAgICAgICAgICByZXR1cm4gcmVzdWx0IGlmIG5vdCBmcm9tX2pzb24gZWxzZSBqc29uLmxvYWRzKHJlc3VsdCkKICAgICAgICByZXR1cm4gcmVzdWx0IGlmIG5vdCBkZWZhdWx0IGVsc2UgZGVmYXVsdAoKICAgIGRlZiBkZWxldGUoc2VsZiwga2V5OiBzdHIpIC0+IE5vbmU6CiAgICAgICAgIiIi0KPQtNCw0LvRj9C10YIg0LrQu9GO0YciIiIKICAgICAgICBzZWxmLm5vc3FsLmRlbGV0ZShrZXkpCgogICAgZGVmIGRlc3Ryb3koc2VsZikgLT4gTm9uZToKICAgICAgICAiIiLQo9C90LjRh9GC0L7QttCw0LXRgiDQstGB0LUg0LrQu9GO0YfQuCDQsdCw0LfRiyIiIgogICAgICAgIHNlbGYubm9zcWwuZGVzdHJveSgpCgogICAgZGVmIGdldF9hbGxfa2V5cyhzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIi0J/QvtC70YPRh9C40YLRjCDRgdC/0LjRgdC+0Log0LLRgdC10YUg0LrQu9GO0YfQtdC5INCx0LDQt9GLINCyINCy0LjQtNC1INGB0YLRgNC+0LrQuCDRhNC+0YDQvNCw0YLQsCBKU09OLdC80LDRgdGB0LjQstCwINGB0YLRgNC+0LoiIiIKICAgICAgICByZXR1cm4gc2VsZi5ub3NxbC5nZXRhbGxrZXlzKCkKCiAgICBkZWYgZmluZF9qc29uKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBmaWVsZDogc3RyLAogICAgICAgICAgICB2YWx1ZTogQW55LAogICAgICAgICAgICBpbmRleF9uYW1lOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAg0JzQtdC00LvQtdC90L3Ri9C5INC/0L7QuNGB0Log0YHRgNC10LTQuCDQstGB0LXRhSDQvtCx0YrQtdC60YLQvtCyINCx0LDQt9GLINC60L7RgtC+0YDRi9C1INC40LzQtdGO0YIg0YLQuNC/IEpTT04KICAgICAgICDQuCDQsiDQv9C+0LvQtSDQutC+0YLQvtGA0YvRhSDQtdGB0YLRjCDQt9C90LDRh9C10L3QuNC1LiDQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMg0YEgSlNPTi3QvNCw0YHRgdC40LLQvtC8CiAgICAgICAg0L3QsNC50LTQtdC90L3Ri9GFINC+0LHRitC10LrRgtC+0LIuCiAgICAgICAg0JXRgdC70Lgg0LIg0LHQsNC30LUg0LzQvdC+0LPQviDQt9C90LDRh9C10L3QuNC5IC0g0LvRg9GH0YjQtSDQuNGB0L/QvtC70YzQt9C+0LLRgtCw0Ywg0L/QvtC40YHQuiDRgSDQuNC90LTQtdC60YHQvtC8LgogICAgICAgICIiIgogICAgICAgIGlmIGluZGV4X25hbWU6CiAgICAgICAgICAgIHJldHVybiBzZWxmLm5vc3FsLmZpbmRKU09OX2luZGV4KGluZGV4X25hbWUsIGZpZWxkLCB2YWx1ZSkKICAgICAgICByZXR1cm4gc2VsZi5ub3NxbC5maW5kSlNPTihmaWVsZCwgdmFsdWUpCgogICAgZGVmIHJ1bl9pbmRleChzZWxmLCBpbmRleDogc3RyLCBmaWVsZDogc3RyKSAtPiBOb25lOgogICAgICAgICIiIgogICAgICAgINCh0L7Qt9C00LDQvdC40LUg0LjQvdC00LXQutGB0LAg0L/QviBKU09OLdC+0LHRitC10LrRgtCw0Lwg0LTQu9GPINC00LDQu9GM0L3QtdC50YjQtdCz0L4g0LjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40Y8g0LTQu9GPINC/0L7QuNGB0LrQsC4KICAgICAgICDQodC+0LfQtNCw0LXRgiwg0LDRgdC40L3RhdGA0L7QvdC90L3QviDQuNC90LTQtdC60YEsINGB0L7RgdGC0L7Rj9GJ0LjQuSDQuNC3INC+0LHRitC10LrRgtC+0LIg0YEg0YPQutCw0LfQsNC90L3Ri9C8INC/0L7Qu9C10LwuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5ub3NxbC5ydW5faW5kZXgoaW5kZXgsIGZpZWxkKQoKICAgIGRlZiBrZXlzKHNlbGYpIC0+IExpc3Rbc3RyXToKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhzZWxmLm5vc3FsLmdldGFsbGtleXMoKSkKCiAgICBkZWYgaXRlbXMoc2VsZikgLT4gTGlzdFtUdXBsZVtzdHIsIE9wdGlvbmFsW3N0cl1dXToKICAgICAgICByZXR1cm4gWyhrZXksIHNlbGYubm9zcWwuZ2V0KGtleSkpIGZvciBrZXkgaW4gc2VsZi5rZXlzKCldCgoKCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\static_data.py",
                "PyFileKey": "static_data",
                "PyFileData": "c25faWNvbl9ncmVlbiA9ICdBQUFCQUFFQUdCZ0FBQUVBSUFBb0NRQUFGZ0FBQUNnQUFBQVlBQUFBTUFBQUFBRUFJQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy85Ly8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vLy8vLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vLzIvLy8vLy8vLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vLy8vLy84di8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1mLy8vOFQvLy8vKy8vLy8zdi8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbWYvLy8vUC8vLy90Ly8vL3IvLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWi8vLy93di8vLy8vLy8vKzAvLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaLy8vLzcvLy8vKzcvLy85YS8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaLy8vLzBmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUpuLy8vKzAvLy8vLy8vLy83d0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSm4vLy8vdS8vLy84Ly8vLzJvQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vNC8vLy81Z0NNQUprQWpBQ1pBSXdBbWYvLy8vNy8vLy9GQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbWYvLy83TC8vLy8rLy8vL3dnQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbWYvLy81ei8vLy8vQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vL2YvLy8vTlFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVi8vLy9VZi8vLytuLy8vLzAvLy8vYmdDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtZi8vLzV6Ly8vLy9BSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSm4vLy8vay8vLy9RZ0NNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WLy8vL3FmLy8vLzcvLy8vTEFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1mLy8vNXovLy8vL0FJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKbi8vLy9mLy8vL05RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL2UvLy8vNlAvLy8vZi8vLzk1QUl3QW1RQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKbi8vLy8yLy8vLzVnQ01BSmtBakFDWkFJd0FtZi8vLy83Ly8vL0ZBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vOS8vLy8vdi8vLzg0QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy8vLy8vLytmLy8vNElBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWi8vLy96Zi8vLy96Ly8vLysvLy8vN2YvLy80OEFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKaz0nCnNuX2ljb25fcmVkID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vLzkvLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vLy8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vMi8vLy8vLy8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9BQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1ovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1ovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDhBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNW4vLy8rMC8vLy8vLy8vLzd3QUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81bi8vLy91Ly8vLzgvLy8vMm9BQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy80Ly8vLzVnQUEvNWtBQVArWkFBRC9tZi8vLy83Ly8vL0ZBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tZi8vLzdMLy8vLysvLy8vd2dBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tZi8vLzV6Ly8vLy9BQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vZi8vLy9OUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9iZ0FBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21mLy8vNXovLy8vL0FBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81bi8vLy9rLy8vL1FnQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbWYvLy81ei8vLy8vQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVuLy8vL2YvLy8vTlFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVBQUQvbVFBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVuLy8vLzIvLy8vNWdBQS81a0FBUCtaQUFEL21mLy8vLzcvLy8vRkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODRBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80SUFBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrPScKc25faWNvbl9ncmF5ID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vLzkvLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vLy8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vMi8vLy8vLy8vLy8vLy8vKzhabVptbVdabVpwbi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9abVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDltWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acG4vLy8rMC8vLy8vLy8vLzd4bVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbi8vLy91Ly8vLzgvLy8vMnBtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbi8vLy80Ly8vLzVtWm1acGxtWm1hWlptWm1tZi8vLy83Ly8vL0ZabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tZi8vLzdMLy8vLysvLy8vd21abVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tZi8vLzV6Ly8vLy9abVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vZi8vLy9OV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9ibVptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1mLy8vNXovLy8vL1ptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbi8vLy9rLy8vL1FtWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbWYvLy81ei8vLy8vWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBuLy8vL2YvLy8vTldabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVabVptbVdabVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBuLy8vLzIvLy8vNW1abVpwbG1abWFaWm1abW1mLy8vLzcvLy8vRlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODVtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80Sm1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ5bVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBrPScKbWFya19ncmVlbj0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVY1SlJFRlVPRStsVWlGTXcxQVF2ZjYxV1Nab3dsQUVDSE1zeTRKREROVjZIRmtnd1NFSURzTU1RU0J3S053VWpnUThFNmpXUVRLTEtHNkNEZ0diNk5Ld01aYnkzNVhyRnV5ZXViNS85MTdldjM2ajluaWEwQnd3V21FN3VYeTVwN0s5bXA1b3U1dmFDUm1Ha2ZJL0pFbENoMC9YV3BIeUlIcWo4K29lcWZldmZuWVFSQ0hsbGNtOEdiVEljUndXb2dMb1lRYXpBTFE1dFZ1K2lIK0duR0RUTHRGMmNZTXFpK3ZVcUIrUjUzbmt1aTVYWVBnOW9rSXVUM25Ub3M5UlJGMXRvQkFEZ09za21WQnZQR0FPaUJnVlFBOHprb0N2Y052eG1TQkJ4VjZqSld1QitYNnp3VlhFQUhxWWtYMUJxL2hMQTY0Zk9wWWt1RHUreXFKTFJROHprZ0JRQjZWMFFYQzFsSlVsbUlXa1FBOHprZ0JhaFY4SXdQVzUvNW9sK0w5QUFEM01TQUpvMWM3S0ZoTzQ0amYxeGpIejJRVk9yeER6akNTQTFsd3VGSm1JYXpBSTZheGFKOS8zczhlRWl2ZncwRzFyTm4yNDBNNzVsSWwrQWJSR3NIdGM1a296QUFBQUFFbEZUa1N1UW1DQyIKbWFya19waW5rPSJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBTUNBWUFBQUJyNXoyQkFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFEc1FBQUE3RUFaVXJEaHNBQUFVYmFWUllkRmhOVERwamIyMHVZV1J2WW1VdWVHMXdBQUFBQUFBOFAzaHdZV05yWlhRZ1ltVm5hVzQ5SXUrN3Z5SWdhV1E5SWxjMVRUQk5jRU5sYUdsSWVuSmxVM3BPVkdONmEyTTVaQ0kvUGlBOGVEcDRiWEJ0WlhSaElIaHRiRzV6T25nOUltRmtiMkpsT201ek9tMWxkR0V2SWlCNE9uaHRjSFJyUFNKQlpHOWlaU0JZVFZBZ1EyOXlaU0EyTGpBdFl6QXdNaUF4TVRZdU1UWTBOelkyTENBeU1ESXhMekF5THpFNUxUSXpPakV3T2pBM0lDQWdJQ0FnSUNBaVBpQThjbVJtT2xKRVJpQjRiV3h1Y3pweVpHWTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1Rrdk1ESXZNakl0Y21SbUxYTjViblJoZUMxdWN5TWlQaUE4Y21SbU9rUmxjMk55YVhCMGFXOXVJSEprWmpwaFltOTFkRDBpSWlCNGJXeHVjenA0YlhBOUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOGlJSGh0Ykc1ek9tUmpQU0pvZEhSd09pOHZjSFZ5YkM1dmNtY3ZaR012Wld4bGJXVnVkSE12TVM0eEx5SWdlRzFzYm5NNmNHaHZkRzl6YUc5d1BTSm9kSFJ3T2k4dmJuTXVZV1J2WW1VdVkyOXRMM0JvYjNSdmMyaHZjQzh4TGpBdklpQjRiV3h1Y3pwNGJYQk5UVDBpYUhSMGNEb3ZMMjV6TG1Ga2IySmxMbU52YlM5NFlYQXZNUzR3TDIxdEx5SWdlRzFzYm5NNmMzUkZkblE5SW1oMGRIQTZMeTl1Y3k1aFpHOWlaUzVqYjIwdmVHRndMekV1TUM5elZIbHdaUzlTWlhOdmRYSmpaVVYyWlc1MEl5SWdlRzF3T2tOeVpXRjBiM0pVYjI5c1BTSkJaRzlpWlNCUWFHOTBiM05vYjNBZ01qRXVNaUFvVFdGamFXNTBiM05vS1NJZ2VHMXdPa055WldGMFpVUmhkR1U5SWpJd01qRXRNRGd0TVRCVU1UQTZOVFU2TlRNck1ETTZNREFpSUhodGNEcE5iMlJwWm5sRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUI0YlhBNlRXVjBZV1JoZEdGRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUJrWXpwbWIzSnRZWFE5SW1sdFlXZGxMM0J1WnlJZ2NHaHZkRzl6YUc5d09rTnZiRzl5VFc5a1pUMGlNeUlnY0dodmRHOXphRzl3T2tsRFExQnliMlpwYkdVOUluTlNSMElnU1VWRE5qRTVOall0TWk0eElpQjRiWEJOVFRwSmJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdlRzF3VFUwNlJHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlJSGh0Y0UxTk9rOXlhV2RwYm1Gc1JHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlQaUE4ZUcxd1RVMDZTR2x6ZEc5eWVUNGdQSEprWmpwVFpYRStJRHh5WkdZNmJHa2djM1JGZG5RNllXTjBhVzl1UFNKamNtVmhkR1ZrSWlCemRFVjJkRHBwYm5OMFlXNWpaVWxFUFNKNGJYQXVhV2xrT21GbE9USmlZakptTFRGa09UTXRORFprTkMxaU9XUTVMV0U1WldReU16SXhaRGhtWmlJZ2MzUkZkblE2ZDJobGJqMGlNakF5TVMwd09DMHhNRlF4TURvMU5UbzFNeXN3TXpvd01DSWdjM1JGZG5RNmMyOW1kSGRoY21WQloyVnVkRDBpUVdSdlltVWdVR2h2ZEc5emFHOXdJREl4TGpJZ0tFMWhZMmx1ZEc5emFDa2lMejRnUEM5eVpHWTZVMlZ4UGlBOEwzaHRjRTFOT2tocGMzUnZjbmsrSUR3dmNtUm1Pa1JsYzJOeWFYQjBhVzl1UGlBOEwzSmtaanBTUkVZK0lEd3ZlRHA0YlhCdFpYUmhQaUE4UDNod1lXTnJaWFFnWlc1a1BTSnlJajgramxiSzBnQUFBVWhKUkVGVU9FK2xrckZLdzJBVWhXOSt0VlNrb0ZCZE9sa0ZSOGxveVZCOEFVR2NmWUhhWFhBVzNCeWlnNnV6Q0w1QTdWQmNvK0JTcEc1ZEpOS2lGcXFVeG56WDNsQmNleURjLytTY2MzTVM0ajBmWENVeUE3emVmVHZwWGpZbFh5NU83b2hzbk8xTEVBUi9mSUpXcXlXZDQxdVJ5ZU9HcjdHVWFsVnhQMitmMlkzdjlKTGNuUEtiMnJuNHZxOUJwaUxWOE9BRlpGMi8wVlpDZzZXZGRTbFV5c3BQSDY0bERFT3AxK3M2QVJvZWEwdldsWTZxU3RpYWpCTVo5NGJLZ1lXWkFBMlBOU0RyNHJzbkpXeGQzRndWdDVKWGZsSTUxR2xoZ0liSEdwQjFla3JCMXRIN0lHdGdyd0Jzb3VHeEJzQVY5N2Ixd0ZhMzRHVU5wbUV0MFBCWUE3S3VlOUZVd3RiQll6ZHI4UDhEQWpRODFvQ3NXOTdkVXNKV0x6Y3ZvLzZYOHVrUGFFdlE4RmdEc2k2M1ZsREMxbUVubG8vR2kvSW9pdlJuc2duUThGZ0RzalAreWlLL0dWQ3dxRnVUaDl3QUFBQUFTVVZPUks1Q1lJST0iCm1hcmtfYmx1ZT0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVR4SlJFRlVPRStsa3I5S3cyQVV4VysrS2tJR3JRNWFFQlFYZGNtUVJSejZCRG83K3dUQjNRY29ycElYMExtejRnTmtFQWNEWm5MeUR4WkVpQ2pTUUcwaCtydm1odURhQStIbWZPZWN5OGxIdkpPcjIxS21nSmNOOHZJaWU1TE9nbDhkaVJ6dWJrbTMyNjNZSDVJa2tmUHIrNHFKdkg0V3NoK3NpL3NvUnZVQlQ4dnpsUGZPK2hLR29RYVpBTTE4Z0t6TEJ1OUthTEM1MHBidHpxTHkvbWxQNGppV0tJcDBBalE4MXBhczJ3dldsTEMxTEVzcHhoUGx3TUpNZ0liSEdwQjFOdzl2U3RqYW1mZkZuNTFSZm5CMHJOUENBQTJQTlNEcjlPMFhiQjErVCtvRzlnbkFKaG9lYXdEY3pzYXl2ckMxNWJ5NlFSUFdBZzJQTlNEckxyTm5KV3g5ekwvcUJ2OHZFS0Roc1Faa1hiQzZwTVFhREVkajVjMEx0Q1ZvelFaa1hkdWZVOEpXbnJ1WFhIbWFwdm96MlFSbzVnTmtwL3lWUlg0QTZQdXdyalh5NkZJQUFBQUFTVVZPUks1Q1lJST0iCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\sm_adr_docs.py",
                "PyFileKey": "sm_adr_docs",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QKCmltcG9ydCBkYl9zZXJ2aWNlcwppbXBvcnQgd2lkZ2V0cwppbXBvcnQgdWlfbW9kZWxzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAsIEJhcmNvZGVBZHJXb3JrZXIKCgpjbGFzcyBBZHJEb2NzTGlzdFNjcmVlbih1aV9tb2RlbHMuRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CQ0LTRgNC10YHQvdC+0LUg0YXRgNCw0L3QtdC90LjQtScKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzPU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5kb2NfdHlwZXMgPSAoJ9CS0YHQtScsICfQntGC0LHQvtGAJywgJ9Cg0LDQt9C80LXRidC10L3QuNC1JywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnKQogICAgICAgIHNlbGYuZG9jX3N0YXR1c2VzID0gKCfQktGB0LUnLCAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nLCAn0JLRi9Cz0YDRg9C20LXQvScsICfQmiDQstGL0LPRgNGD0LfQutC1JykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICgn0KPQtNCw0LvQuNGC0YwnLCAn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJywgJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JykKICAgICAgICBzZWxmLmN1cnJlbnRfc3RhdHVzID0gJ9CS0YHQtScKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSAn0JLRgdC1JwogICAgICAgIHNlbGYubGlzdF9kYXRhX2tleSA9ICdkb2N1bWVudHNfbGlzdCcKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX2Fkcl90eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oc2VsZi5kb2NfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3N0YXR1c19zZWxlY3QnXSA9ICc7Jy5qb2luKHNlbGYuZG9jX3N0YXR1c2VzKQogICAgICAgIHNlbGYuX2ZpbGxfdGFibGVfZGF0YSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5fZmlsbF90YWJsZV9kYXRhKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2ssCiAgICAgICAgICAgICdkb2NfYWRyX3R5cGVfY2xpY2snOiBzZWxmLl9kb2NfdHlwZV9zZWxlY3QsCiAgICAgICAgICAgICdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YSc6IGxhbWJkYTogc2VsZi5fY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYuZ2V0X2lkX2RvYygpKSwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShzZWxmLmxpc3RfZGF0YV9rZXkpCiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIEFkckRvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgaWRfZG9jPWlkX2RvYykuc2hvdygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX2RvY190eXBlX3NlbGVjdChzZWxmKToKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfYWRyX3R5cGVfY2xpY2snXQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKSAtPiBOb25lOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xheW91dF9saXN0ZW5lciddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDQtNC+0LrRg9C80LXQvdGCINGBINGD0YHRgtGA0L7QudGB0YLQstCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX3Jlc2VuZF9kb2MnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4/JwogICAgICAgICAgICApCgogICAgZGVmIF9maWxsX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5fZ2V0X2RvY19saXN0X2RhdGEoc2VsZi5jdXJyZW50X2RvY190eXBlLCBzZWxmLmN1cnJlbnRfc3RhdHVzKQogICAgICAgIHByZXBhcmVkX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEobGlzdF9kYXRhKQogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldygKICAgICAgICAgICAgcHJlcGFyZWRfZGF0YSwKICAgICAgICAgICAgcG9wdXBfbWVudV9kYXRhPSc7Jy5qb2luKHNlbGYucG9wdXBfbWVudV9kYXRhKQogICAgICAgICkKICAgICAgICBzZWxmLmhhc2hfbWFwW3NlbGYubGlzdF9kYXRhX2tleV0gPSBkb2NfY2FyZHMudG9fanNvbigpCgogICAgZGVmIF9nZXRfZG9jX2xpc3RfZGF0YShzZWxmLCBkb2NfdHlwZSwgZG9jX3N0YXR1cykgLT4gbGlzdDoKICAgICAgICBkb2NfdHlwZSA9ICcnIGlmIGRvY190eXBlID09ICLQktGB0LUiIGVsc2UgZG9jX3R5cGUKICAgICAgICBkb2Nfc3RhdHVzID0gJycgaWYgZG9jX3N0YXR1cyA9PSAn0JLRgdC1JyBlbHNlIGRvY19zdGF0dXMKCiAgICAgICAgZG9jc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfdmlld19kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQogICAgICAgIHJldHVybiBkb2NzX2RhdGEKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBsaXN0X2RhdGEpIC0+IGxpc3Q6CiAgICAgICAgdGFibGVfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBsaXN0X2RhdGE6CiAgICAgICAgICAgIGRvY19zdGF0dXMgPSAnJwoKICAgICAgICAgICAgaWYgcmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0JLRi9Cz0YDRg9C20LXQvScKICAgICAgICAgICAgZWxpZiByZWNvcmRbJ3ZlcmlmaWVkJ106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQs9GA0YPQt9C60LUnCiAgICAgICAgICAgIGVsaWYgbm90IChyZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddKToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nCgogICAgICAgICAgICBkb2NfdGl0bGUgPSAne30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgcmVjb3JkWydkb2NfbiddLCBzZWxmLl9mb3JtYXRfZGF0ZShyZWNvcmRbJ2RvY19kYXRlJ10pKQoKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAnZG9jX3R5cGUnOiByZWNvcmRbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICAgICAnZG9jX3RpdGxlJzogZG9jX3RpdGxlLAogICAgICAgICAgICAgICAgJ2RvY19uJzogcmVjb3JkWydkb2NfbiddLAogICAgICAgICAgICAgICAgJ2RvY19kYXRlJzogc2VsZi5fZm9ybWF0X2RhdGUocmVjb3JkWydkb2NfZGF0ZSddKSwKICAgICAgICAgICAgICAgICd3YXJlaG91c2UnOiByZWNvcmRbJ3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IHJlY29yZFsnYWRkX21hcmtfc2VsZWN0aW9uJ10sCiAgICAgICAgICAgICAgICAnc3RhdHVzJzogZG9jX3N0YXR1cwogICAgICAgICAgICB9KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGEsIHBvcHVwX21lbnVfZGF0YSk6CiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc3RhdHVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY190eXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfZGVsZXRlIiwKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jX24nLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B3YXJlaG91c2UnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9kb2NfZGVsZXRlKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmVzdWx0ID0gVHJ1ZQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRlbGV0ZV9hZHJfZG9jKGlkX2RvYykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGUuYXJnc1swXSkKICAgICAgICAgICAgcmVzdWx0ID0gRmFsc2UKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoc2VsZiwgcHV0X2RhdGE9Tm9uZSk6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCgogICAgICAgIHRhYmxlX3R5cGUgPSAnb3V0JyBpZiBjYXJkX2RhdGFbJ2RvY190eXBlJ10gaW4gWyfQntGC0LHQvtGAJywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnXSBlbHNlICdpbicKCiAgICAgICAgcHV0X2RhdGEgPSBwdXRfZGF0YSBvciB7fQogICAgICAgIHB1dF9kYXRhWydpZF9kb2MnXSA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICBwdXRfZGF0YVsnZG9jX3R5cGUnXSA9IGNhcmRfZGF0YVsnZG9jX3R5cGUnXQogICAgICAgIHB1dF9kYXRhWyd0YWJsZV90eXBlJ10gPSB0YWJsZV90eXBlCiAgICAgICAgcHV0X2RhdGFbJ2RvY19uJ10gPSBjYXJkX2RhdGFbJ2RvY19uJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX2RhdGUnXSA9IGNhcmRfZGF0YVsnZG9jX2RhdGUnXQogICAgICAgIHB1dF9kYXRhWydkb2NfdGl0bGUnXSA9IGNhcmRfZGF0YVsnZG9jX3RpdGxlJ10KICAgICAgICBwdXRfZGF0YVsnd2FyZWhvdXNlJ10gPSBjYXJkX2RhdGFbJ3dhcmVob3VzZSddCgogICAgICAgIHJldHVybiBwdXRfZGF0YQoKICAgIGRlZiBjb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikKICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCgogICAgICAgIGlmIHNlbGYuZG9jX2RlbGV0ZShpZF9kb2MpOgogICAgICAgICAgICBkb2NzX2NvdW50ID0gc2VsZi5nZXRfZG9jc19jb3VudChkb2NfdHlwZT1kb2NfdHlwZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDRg9GB0L/QtdGI0L3QviDRg9C00LDQu9GR0L0nKQogICAgICAgICAgICBpZiBkb2NzX2NvdW50OgogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGD0LTQsNC70LXQvdC40Y8g0LTQvtC60YPQvNC10L3RgtCwJykKCiAgICBkZWYgX2NsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ2NhcmRfZGF0YScpLmdldCgna2V5JykgaWYgc2VsZi5oYXNoX21hcFsnY2FyZF9kYXRhJ10gZWxzZSAnJwogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKCiAgICBkZWYgZ2V0X2lkX2RvYyhzZWxmKToKICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKCmNsYXNzIEFkckRvY0RldGFpbHNTY3JlZW4odWlfbW9kZWxzLkRvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JDQtNGA0LXRgdC90L7QtSDRhdGA0LDQvdC10L3QuNC1JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgaWRfZG9jLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwPWhhc2hfbWFwKQogICAgICAgIHNlbGYudGFibGVzX3R5cGVzID0gJ9Ce0YLQsdC+0YA70KDQsNC30LzQtdGJ0LXQvdC40LUnCiAgICAgICAgc2VsZi5pZF9kb2MgPSBpZF9kb2MKICAgICAgICBzZWxmLnNlcnZpY2UgPSBOb25lCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSAnJwogICAgICAgIHNlbGYuY3VycmVudF9jZWxsX2lkID0gJycKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3RpdGxlID0gJycKICAgICAgICBzZWxmLmRvY19kYXRhID0ge30KICAgICAgICBzZWxmLmxpc3RfZGF0YV9rZXkgPSAnZG9jX2dvb2RzX3RhYmxlJwogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuaGFzaF9tYXBfa2V5cyA9IFtdCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoaWRfZG9jPXNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuZG9jX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kYXRhX2J5X2lkKCkKCiAgICAgICAgc2VsZi5kb2NfdHlwZSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5kb2NfdHlwZSkKICAgICAgICBzZWxmLnNlcnZpY2UudGFibGVfdHlwZSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfZGF0ZSddID0gc2VsZi5fZm9ybWF0X2RhdGUoc2VsZi5kb2NfZGF0YVsnZG9jX2RhdGUnXSkKICAgICAgICBzZWxmLmRvY190aXRsZSA9ICd7ZG9jX3R5cGV9IOKEliB7ZG9jX259INC+0YIge2RvY19kYXRlfScuZm9ybWF0KAogICAgICAgICAgICAqKnNlbGYuZG9jX2RhdGEKICAgICAgICApCgogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlc190eXBlJ10gPSBzZWxmLnRhYmxlc190eXBlcwogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlX3R5cGUnXSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfdGl0bGUnXSA9IHNlbGYuZG9jX3RpdGxlCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoc2VsZi5kb2NfZGF0YSwgZmlsbF9ub25lPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljaywKICAgICAgICAgICAgJ2J0bl9iYXJjb2Rlcyc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZyhsaXN0ZW5lcj0i0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpLAogICAgICAgICAgICAnYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKSksCiAgICAgICAgICAgICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOiBzZWxmLl9kb2NfbWFya192ZXJpZmllZCwKICAgICAgICAgICAgJ2J0bl9zZWxlY3RfY2VsbCc6IHNlbGYuX3NlbGVjdF9jZWxsLAogICAgICAgICAgICAnY2VsbF9zZWxlY3Rfc3VjY2Vzcyc6IHNlbGYuX3NlbGVjdF9jZWxsX3Jlc3VsdCwKICAgICAgICAgICAgJ2J0bl9jbGVhcl9jZWxsJzogc2VsZi5fY2xlYXJfY2VsbCwKICAgICAgICAgICAgJ3RhYmxlX3R5cGUnOiBzZWxmLl90YWJsZV90eXBlX3NlbGVjdGVkLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdCQUNLX0JVVFRPTic6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9CS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQnKToKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwWydmbGRfYmFyY29kZSddKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkX2NhcmRfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKHNlbGYubGlzdF9kYXRhX2tleSkKICAgICAgICBpZiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gJzEnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9vcGVuX3NlbGVjdF9nb29kc19zY3JlZW4oZGF0YT1zZWxlY3RlZF9jYXJkX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9iYXJjb2RlX2xpc3RlbmVyKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIHNlbGYuX3VwZGF0ZV9jdXJyZW50X2NlbGwoYmFyY29kZSk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zID0gc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKQogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ2lzX2Fkcl9kb2MnXSA9IFRydWUKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zWydpZF9jZWxsJ10gPSBzZWxmLmN1cnJlbnRfY2VsbF9pZAogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ3RhYmxlX3R5cGUnXSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gQmFyY29kZUFkcldvcmtlcigKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAqKmJhcmNvZGVfcHJvY2Vzc19wYXJhbXMsCiAgICAgICAgICAgIHVzZV9zY2FubmluZ19xdWV1ZT1GYWxzZQogICAgICAgICkKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX3VwZGF0ZV9jdXJyZW50X2NlbGwoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgY3VycmVudF9jZWxsID0gc2VsZi5jdXJyZW50X2NlbGxfaWQKICAgICAgICBkb2NfY2VsbCA9IHNlbGYuc2VydmljZS5maW5kX2NlbGwoYmFyY29kZSkKCiAgICAgICAgaWYgZG9jX2NlbGwgYW5kIGN1cnJlbnRfY2VsbCAhPSBkb2NfY2VsbDoKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbChkb2NfY2VsbFsnbmFtZSddLCBkb2NfY2VsbFsnaWQnXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnd2FybmluZycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsICfQndC1INC90LDQudC00LXQvdCwINGP0YfQtdC50LrQsCcpCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShzZWxmLCBzY2FuX3Jlc3VsdCk6CiAgICAgICAgaWYgc2Nhbl9yZXN1bHQuZXJyb3IgPT0gJ3VzZV9zZXJpZXMnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2Nhbl9yZXN1bHQucm93X2tleSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3dhcm5pbmcnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgogICAgZGVmIF9kb2NfbWFya192ZXJpZmllZChzZWxmKToKICAgICAgICBzZWxmLnNlcnZpY2UubWFya192ZXJpZmllZCgpCiAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIEFkckRvY3NMaXN0U2NyZWVuKHNlbGYuaGFzaF9tYXApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGwoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIHNlbGYuX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKCkKCiAgICBkZWYgX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKHNlbGYpOgogICAgICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RJdGVtU2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICB0YWJsZV9uYW1lPSdSU19jZWxscycsCiAgICAgICAgICAgIHJlc3VsdF9saXN0ZW5lcj0nY2VsbF9zZWxlY3Rfc3VjY2VzcycKICAgICAgICApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGxfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGVjdGVkX2NlbGwgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKHNlbGVjdGVkX2NlbGwuZ2V0KCduYW1lJyksIHNlbGVjdGVkX2NlbGwuZ2V0KCdpZCcpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCgogICAgZGVmIF9jbGVhcl9jZWxsKHNlbGYpOgogICAgICAgIHNlbGYuX3NldF9jdXJyZW50X2NlbGwoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfdGFibGVfdHlwZV9zZWxlY3RlZChzZWxmKToKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5oYXNoX21hcFsndGFibGVfdHlwZSddKQogICAgICAgIHNlbGYuc2VydmljZS50YWJsZV90eXBlID0gc2VsZi50YWJsZV90eXBlCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCgogICAgICAgIGlmIHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICAgICAgQWRyRG9jc0xpc3RTY3JlZW4oc2VsZi5oYXNoX21hcCkuc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VzZV9hZHJfZG9jc190YWJsZXMnXSA9IFRydWUKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgfQoKICAgICAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX3ZhbHVlcykKCiAgICBkZWYgX29wZW5fc2VsZWN0X2dvb2RzX3NjcmVlbihzZWxmLCBkYXRhKToKICAgICAgICBkb2Nfcm93X2lkID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIHNjcmVlbiA9IEFkckdvb2RzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXAsIGRvY19yb3dfaWQ9ZG9jX3Jvd19pZCkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHN1cGVyKCkuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCgogICAgICAgIGRhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX2RhdGEoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgY2VsbD1zZWxmLmN1cnJlbnRfY2VsbF9pZCwKICAgICAgICAgICAgZmlyc3RfZWxlbT0wIGlmIGxhc3Rfc2Nhbm5lZCBlbHNlIGZpcnN0X2VsZW1lbnQsCiAgICAgICAgICAgIGl0ZW1zX29uX3BhZ2U9MSBpZiBsYXN0X3NjYW5uZWQgZWxzZSBzZWxmLml0ZW1zX29uX3BhZ2UsCiAgICAgICAgICAgIHJvd19maWx0ZXJzPXJvd19maWx0ZXJzLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPXNlYXJjaF9zdHJpbmcKICAgICAgICApCiAgICAgICAgc2VsZi5kb2Nfcm93cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfcm93c19jb3VudCgKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQoKICAgICAgICBpZiBub3QgbGFzdF9zY2FubmVkOgogICAgICAgICAgICBzdXBlcigpLl9jaGVja19uZXh0X3BhZ2UobGVuKGRhdGEpKQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RhYmxlX3R5cGVfZnJvbV9uYW1lKF92YWwpOgogICAgICAgIHJldHVybiAnaW4nIGlmIF92YWwgPT0gJ9Cg0LDQt9C80LXRidC10L3QuNC1JyBlbHNlICdvdXQnCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgZG9jX2RldGFpbHMpOgogICAgICAgICMgVE9ETyDQtNC+0LHQsNCy0LjRgtGMINCz0YDRg9C/0L/QuNGA0L7QstC60YMg0L/QviDRj9GH0LXQudC60LDQvAogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgcm93X2ZpbHRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3Jvd3NfZmlsdGVyJykKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgaWYgcm93X2ZpbHRlciBhbmQgcmVjb3JkWydxdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gPT0gMCBhbmQgcmVjb3JkWydxdHR5X3BsYW4nXSA9PSAwOgogICAgICAgICAgICAgICAgcGljID0gJycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2lkJ10pLAogICAgICAgICAgICAgICAgJ2NlbGwnOiBzdHIocmVjb3JkWydjZWxsX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfY2VsbCc6IHN0cihyZWNvcmRbJ2lkX2NlbGwnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5Jzogc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFsnaWRfc2VyaWVzJ10pLAogICAgICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFsnc2VyaWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAndW5pdHNfbmFtZSc6IHN0cihyZWNvcmRbJ3VuaXRzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnY29kZV9hcnQnOiAn0JrQvtC0OiAnICsgc3RyKHJlY29yZFsnY29kZSddKSwKICAgICAgICAgICAgICAgICdhcnQnOiBzdHIocmVjb3JkWydhcnQnXSksCiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICd1c2Vfc2VyaWVzJzogc3RyKHJlY29yZFsndXNlX3NlcmllcyddKQogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm9wcyA9IFsKICAgICAgICAgICAgICAgICd7fSAnLmZvcm1hdChwcm9kdWN0X3Jvd1snYXJ0J10pIGlmIHByb2R1Y3Rfcm93WydhcnQnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJyh7fSkgJy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICd7fScuZm9ybWF0KHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJywge30nLmZvcm1hdChwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ2dvb2RfaW5mbyddID0gJycuam9pbihwcm9wcykKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gc3RyKGludChyZWNvcmRbJ3F0dHknXSkgaWYgcmVjb3JkWydxdHR5J10uaXNfaW50ZWdlcigpIGVsc2UgcmVjb3JkWydxdHR5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gIjAiCiAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eV9wbGFuJ10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10gPSBzdHIoaW50KHJlY29yZFsncXR0eV9wbGFuJ10pIGlmIHJlY29yZFsncXR0eV9wbGFuJ10uaXNfaW50ZWdlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSByZWNvcmRbJ3F0dHlfcGxhbiddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddID0gIjAiCgogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpCiAgICAgICAgICAgIHNlbGYuX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihwcm9kdWN0X3JvdykKCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAoKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMob3ZlcnJpZGVfc2VhcmNoPVRydWUpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmLCB1c2Vfc2VyaWVzPUZhbHNlLCB1c2VfbWFyaz1GYWxzZSk6CgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNlbGwnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihzZWxmLCBwcm9kdWN0X3Jvdyk6CiAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgIHF0dHksIHF0dHlfcGxhbiA9IGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5J10pLCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10pCiAgICAgICAgaWYgcXR0eV9wbGFuID4gcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkJFOUU3IgoKICAgICAgICBlbGlmIHF0dHlfcGxhbiA8IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRjlDNCIKCiAgICAgICAgc2V0YXR0cihwcm9kdWN0X3Jvd1snX2xheW91dCddLCAnQmFja2dyb3VuZENvbG9yJywgYmFja2dyb3VuZF9jb2xvcikKCiAgICBkZWYgX3NldF9jdXJyZW50X2NlbGwoc2VsZiwgY3VycmVudF9jZWxsPSctINC90LUg0LLRi9Cx0YDQsNC90L4gLScsIGN1cnJlbnRfY2VsbF9pZD0nJyk6CiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwsIHNlbGYuY3VycmVudF9jZWxsX2lkID0gY3VycmVudF9jZWxsLCBjdXJyZW50X2NlbGxfaWQKICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2NlbGwnXSA9IGN1cnJlbnRfY2VsbAogICAgICAgIGlmIGN1cnJlbnRfY2VsbF9pZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnU2hvd19idG5fY2xlYXJfY2VsbCddID0gMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX2NsZWFyX2NlbGwnXSA9IC0xCgoKY2xhc3MgQWRyR29vZHNTZWxlY3RTY3JlZW4odWlfbW9kZWxzLkJhc2VHb29kU2VsZWN0KToKICAgIHNjcmVlbl9uYW1lID0gJ9Ci0L7QstCw0YAg0LLRi9Cx0L7RgCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQkNC00YDQtdGB0L3QvtC1INGF0YDQsNC90LXQvdC40LUnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCBkb2Nfcm93X2lkLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuZG9jX3Jvd19pZCA9IGRvY19yb3dfaWQKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0ge30KICAgICAgICBzZWxmLmhhc2hfbWFwX2tleXMgPSBbJ2l0ZW1fbmFtZScsICdhcnRpY2xlJywgJ3Byb3BlcnR5JywgJ3VuaXQnLCAncXR0eV9wbGFuJywgJ3F0dHknXQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfcm93X2RhdGEoc2VsZi5kb2Nfcm93X2lkKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHsKICAgICAgICAgICAga2V5OiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoc2VsZi5zY3JlZW5fZGF0YS5nZXQoa2V5LCAwKSkKICAgICAgICAgICAgaWYga2V5IGluIFsncXR0eV9wbGFuJywgJ3F0dHknXSBlbHNlIHNlbGYuc2NyZWVuX2RhdGEuZ2V0KGtleSwgJycpCiAgICAgICAgICAgIGZvciBrZXkgaW4gc2VsZi5oYXNoX21hcF9rZXlzCiAgICAgICAgfSkKICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fc2VyaWVzX3Nob3cnOiBsYW1iZGE6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbigpLAogICAgICAgICAgICAnYnRuX2RvY19nb29kX2JhcmNvZGUnOiBzZWxmLl9vcGVuX2JhcmNvZGVfcmVnaXN0ZXJfc2NyZWVuLAogICAgICAgICAgICAnYnRuX3ByaW50Jzogc2VsZi5fcHJpbnRfdGlja2V0CiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5KHNlbGYpOgogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpIG9yIEZhbHNlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X2lucHV0IiwgJzEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnLTEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9ub3RlIiwgJy0xJyBpZiBhbGxvd19mYWN0X2lucHV0IGVsc2UgJzEnKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2NyZWVuID0gQWRyRG9jRGV0YWlsc1NjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnNjcmVlbl9kYXRhWydpZF9kb2MnXSkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19pZD0nJyk6CiAgICAgICAgc2VsZi5oYXNoX21hcFsndXNlX2Fkcl9kb2NzX3RhYmxlcyddID0gVHJ1ZQogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogc2VsZi5kb2Nfcm93X2lkLAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4oc2VsZi5oYXNoX21hcCkKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdChzY3JlZW5fdmFsdWVzKQoKICAgIGRlZiBfb3Blbl9iYXJjb2RlX3JlZ2lzdGVyX3NjcmVlbihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSB7CiAgICAgICAgICAgICdpdGVtX2lkJzogc2VsZi5zY3JlZW5fZGF0YVsnaXRlbV9pZCddLAogICAgICAgICAgICAncHJvcGVydHlfaWQnOiBzZWxmLnNjcmVlbl9kYXRhWydwcm9wZXJ0eV9pZCddLAogICAgICAgICAgICAndW5pdF9pZCc6IHNlbGYuc2NyZWVuX2RhdGFbJ3VuaXRfaWQnXQogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGluaXRfZGF0YSkKCiAgICAgICAgc2NyZWVuID0gdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdCgpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgYmFyY29kZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkuZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZi5oYXNoX21hcC5nZXQoJ2tleScpKQoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAn0J3QvtC80LXQvdC60LvQsNGC0YPRgNCwJzogJ2l0ZW1fbmFtZScsCiAgICAgICAgICAgICfQkNGA0YLQuNC60YPQuyc6ICdhcnRpY2xlJywKICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiAncHJvcGVydHknLAogICAgICAgICAgICAn0JXQtNCY0LfQvCc6ICd1bml0JywKICAgICAgICB9CgogICAgICAgIGZvciBrZXkgaW4gZGF0YToKICAgICAgICAgICAgZGF0YVtrZXldID0gc2VsZi5oYXNoX21hcC5nZXQoZGF0YVtrZXldKQoKICAgICAgICBkYXRhWydiYXJjb2RlJ10gPSBiYXJjb2RlIGlmIGJhcmNvZGUgZWxzZSAnMDAwMDAwMDAwMDAwMCcKICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICBkZWYgX3VwZGF0ZV9kb2NfdGFibGVfcm93KHNlbGYsIGRhdGE6IERpY3QsIHJvd19pZD0nJyk6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChkYXRhWydxdHR5J10pLAogICAgICAgIH0KCiAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1zZWxmLmRvY19yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLnNjcmVlbl9kYXRhWydpZF9kb2MnXSkKCiAgICBkZWYgX2hhbmRsZV9mb3VuZF9iYXJjb2RlKHNlbGYsIHJlcywgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIGlzX2N1cnJlbnRfcG9zaXRpb24gPSBhbGwoKAogICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWydpdGVtX2lkJ10gPT0gcmVzWydpZF9nb29kJ10sCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ3Byb3BlcnR5X2lkJ10gPT0gcmVzWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWyd1bml0X2lkJ10gPT0gcmVzWydpZF91bml0J10KICAgICAgICApKQoKICAgICAgICBpZiBpc19jdXJyZW50X3Bvc2l0aW9uOgogICAgICAgICAgICBpZiBzZWxmLnNjcmVlbl9kYXRhWyd1c2Vfc2VyaWVzJ10gPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc1sncmF0aW8nXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgc2VsZi5jdXJyZW50X3RvYXN0X21lc3NhZ2UgPSAn0KjRgtGA0LjRhdC60L7QtCDQvdC1INGB0L7QvtGC0LLQtdGC0YHRgtCy0YPQtdGCINGC0LXQutGD0YnQtdC5INC/0L7Qt9C40YbQuNC4JwoKICAgICAgICByZXR1cm4gRmFsc2U="
            }
        ],
        "StyleTemplates": [],
        "arch2": true,
        "CommonHandlers": [
            {
                "event": "onLaunch",
                "listener": "",
                "action": "run",
                "type": "pythonreload",
                "method": "app_on_start",
                "postExecute": "",
                "alias": "on_start"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "event_service",
                "postExecute": "",
                "alias": "event_service"
            },
            {
                "event": "onBackgroundCommand",
                "listener": "menu_2",
                "action": "run",
                "type": "set",
                "method": "UpdateConfigurations",
                "postExecute": ""
            },
            {
                "event": "onSQLError",
                "listener": "",
                "action": "run",
                "type": "set",
                "method": "beep",
                "postExecute": ""
            },
            {
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "timer_update",
                "postExecute": "",
                "alias": "timer_update"
            }
        ]
    }
}