{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.11.0",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "hidden": false,
                "DefineOnBackPressed": true,
                "login_screen": false,
                "PlanFactHeader": "...",
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@gtin",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@series",
                                        "Variable": ""
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "type": "SpinnerLayout",
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "0"
                                            },
                                            {
                                                "TextBold": true,
                                                "height": "0",
                                                "width": "0",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "+",
                                                "Variable": "btn_add_doc"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@docCards",
                                        "Variable": "doc_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "Elements": [
                                                            {
                                                                "TextSize": "24",
                                                                "TextColor": "#7A005C",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@doc_n",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "TextBold": false,
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@doc_date",
                                                                "Variable": "doc_date"
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@warehouse",
                                                                "Variable": "warehouse"
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@countragent",
                                                                "Variable": "countragent"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "2",
                                                        "type": "TextView",
                                                        "Value": "",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextColor": "#7A005C",
                                                        "BackgroundColor": "#FFFFFF",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "1",
                                                        "type": "Button",
                                                        "Value": "|| ||| ||",
                                                        "Variable": "btn_barcodes"
                                                    },
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "2",
                                                        "type": "TextView",
                                                        "Value": "",
                                                        "Variable": ""
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards"
                                    },
                                    {
                                        "BackgroundColor": "#FFFFFF",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Отметить к отправке",
                                        "Variable": "btn_doc_mark_verified"
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "CButtons",
                                                "Value": "",
                                                "Variable": ""
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f067",
                                "Variable": "btn_add_string"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Вид таблиц",
                                "Variable": "table_view"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Вид карточек",
                                "Variable": "card_view"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отметить к отправке",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Good",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_good_select"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@properties",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_properties"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Series",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_series"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Unit",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_unit"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "Цена",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "EditTextNumeric",
                                                "Value": "@price",
                                                "Variable": "price"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            },
                            {
                                "type": "HorizontalGallery",
                                "Value": "@photoGallery",
                                "Variable": "photoGallery"
                            },
                            {
                                "type": "photo",
                                "Value": "",
                                "Variable": "photo"
                            },
                            {
                                "type": "photoGallery",
                                "Value": "",
                                "Variable": "photo"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "16",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "style_name": "",
                                        "drawable": "forward"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Value": "@Good_info",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "gravity_horizontal": "left",
                                                                "TextColor": "#000000",
                                                                "TextBold": true
                                                            },
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "gravity_horizontal": "left",
                                                                "TextColor": "#000000"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": ""
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "7",
                                                        "Value": "",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "Elements": [
                                                            {
                                                                "type": "TextView",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "gravity_horizontal": "right",
                                                                "TextColor": "#000000"
                                                            }
                                                        ],
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "gravity_horizontal": "right"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "gravity_horizontal": "left",
                                                        "TextColor": "#000000",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "gravity_horizontal": "left",
                                                        "TextColor": "#000000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "gravity_horizontal": "left",
                                                        "TextColor": "#000000",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "TextColor": "#000000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "gravity_horizontal": "left",
                                                        "TextColor": "#cc0000",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "TextColor": "#cc0000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Value": "",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "Elements": [
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "gravity_horizontal": "left",
                                                        "TextColor": "#000000",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "type": "TextView",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "TextColor": "#000000"
                                                    }
                                                ],
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": ""
                                            }
                                        ],
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": ""
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "TextBold": true,
                                        "BackgroundColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Good",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "TextColor": "",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "style_name": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "TextColor": "",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "style_name": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "TextColor": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty",
                                                        "Variable": "",
                                                        "style_name": ""
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "#FFFFFF",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Новый документ",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "type": "SpinnerLayout",
                                        "Value": "@doc_type_select",
                                        "Variable": "doc_type_click",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "50",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_number",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "DateField",
                                        "Value": "@doc_date",
                                        "Variable": "fld_data"
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@countragent",
                                                "Variable": "fld_countragent"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_countragent"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@warehouse",
                                                "Variable": "doc_warehouse"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_warehouse"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ штрихкоды",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barc_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@good",
                                        "Variable": "id_good"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@code_art",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@unit_name",
                                        "Variable": "id_unit"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1"
                                    },
                                    {
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode"
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "ОШИБКА",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Сканер отключен",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": false,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Введите значение штрихкода",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "18",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@doc_type",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_n",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_date",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@warehouse",
                                        "Variable": ""
                                    },
                                    {
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@countragent",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Отметить к отправке",
                                        "Variable": "btn_doc_mark_verified"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Групповая обработка",
                "hidden": false,
                "DefineOnBackPressed": true,
                "login_screen": false,
                "PlanFactHeader": "...",
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@gtin",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@series",
                                        "Variable": ""
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_start_group_scan",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input_group_scan",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "type": "SpinnerLayout",
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "0"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@docCards",
                                        "Variable": "doc_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start_group_scan",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select_group_scan",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "Elements": [
                                                            {
                                                                "TextSize": "24",
                                                                "TextColor": "#7A005C",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@doc_n",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "TextBold": false,
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@doc_date",
                                                                "Variable": "doc_date"
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@warehouse",
                                                                "Variable": "warehouse"
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "0",
                                                                "type": "TextView",
                                                                "Value": "@countragent",
                                                                "Variable": "countragent"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards"
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "CButtons",
                                                "Value": "",
                                                "Variable": ""
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Вид таблиц",
                                "Variable": "table_view"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Вид карточек",
                                "Variable": "card_view"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start_group_scan",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener_group_scan",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Good",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_good_select"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@properties",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_properties"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Series",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_series"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Unit",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_unit"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "Цена",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "EditTextNumeric",
                                                "Value": "@price",
                                                "Variable": "price"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            },
                            {
                                "type": "HorizontalGallery",
                                "Value": "@photoGallery",
                                "Variable": "photoGallery"
                            },
                            {
                                "type": "photo",
                                "Value": "",
                                "Variable": "photo"
                            },
                            {
                                "type": "photoGallery",
                                "Value": "",
                                "Variable": "photo"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "elem_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "TextBold": true,
                                        "BackgroundColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Good",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Good_info",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "Цена",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "EditTextNumeric",
                                                "Value": "@price",
                                                "Variable": "price"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "#FFFFFF",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Новый документ",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "type": "SpinnerLayout",
                                        "Value": "@doc_type_select",
                                        "Variable": "doc_type_click",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "50",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_number",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "DateField",
                                        "Value": "@doc_date",
                                        "Variable": "fld_data"
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@countragent",
                                                "Variable": "fld_countragent"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_countragent"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@warehouse",
                                                "Variable": "doc_warehouse"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_warehouse"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "new_doc_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ штрихкоды",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barc_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_barcodes_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@good",
                                        "Variable": "id_good"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@code_art",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@unit_name",
                                        "Variable": "id_unit"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1"
                                    },
                                    {
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode"
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "ОШИБКА",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Сканер отключен",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": false,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Введите значение штрихкода",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "18",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@doc_type",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_n",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_date",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@warehouse",
                                        "Variable": ""
                                    },
                                    {
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@countragent",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Отметить к отправке",
                                        "Variable": "btn_doc_mark_verified"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Подтвердите действие",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": false,
                        "hideToolBarScreen": false,
                        "noConfirmation": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Вы открываете документ для групповой работы. В этом режиме данные передаются в 1С при каждом сканировании, а ввод количества вручную недоступен. Хотите продолжить?",
                                        "Variable": "",
                                        "style_name": "",
                                        "drawable": "forward"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Адресное хранение",
                "hidden": true,
                "DefineOnBackPressed": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "type": "SpinnerLayout",
                                                "Value": "@doc_adr_type_select",
                                                "Variable": "doc_adr_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "0"
                                            },
                                            {
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "+",
                                                "Variable": "btn_add_doc"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@docAdrCards",
                                        "Variable": "doc_adr_cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "docs_adr_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "docs_adr_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "Текущая ячейка: ",
                                                "Variable": ""
                                            },
                                            {
                                                "TextSize": "20",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@current_cell",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_cell"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "x",
                                                "Variable": "btn_clear_cell"
                                            }
                                        ]
                                    },
                                    {
                                        "TextSize": "18",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@doc_type",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_n",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "0",
                                                "width": "0",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@doc_date",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "0",
                                                "width": "0",
                                                "gravity_horizontal": "right",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@warehouse",
                                        "Variable": ""
                                    },
                                    {
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@countragent",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@doc_goods",
                                        "Variable": "doc_goods"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Отметить к отправке",
                                        "Variable": "btn_doc_mark_verified"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f067",
                                "Variable": "btn_add_string"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отметить к отправке",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "doc_adr_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "doc_adr_details_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "20",
                                                "TextColor": "#7A005C",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@current_cell_name",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "30",
                                                "width": "30",
                                                "gravity_horizontal": "right",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_cell"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "TextBold": true,
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "left",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@Good",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_good_select"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@properties",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "30",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_properties"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards"
                                    }
                                ]
                            },
                            {
                                "type": "HorizontalGallery",
                                "Value": "@photoGallery",
                                "Variable": "photoGallery"
                            },
                            {
                                "type": "photo",
                                "Value": "",
                                "Variable": "photo"
                            },
                            {
                                "type": "photoGallery",
                                "Value": "",
                                "Variable": "photo"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Doc_data",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "TextBold": true,
                                        "BackgroundColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@Good",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "План",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@qtty_plan",
                                                        "Variable": ""
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Факт",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextSize": "24",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "EditTextNumeric",
                                                        "Value": "@qtty",
                                                        "Variable": "qtty"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "Цена",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "EditTextNumeric",
                                                "Value": "@price",
                                                "Variable": "price"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_viev_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode"
                                    },
                                    {
                                        "TextSize": "24",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "ОШИБКА",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Сканер отключен",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": false,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Введите значение штрихкода",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Новый документ",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "type": "SpinnerLayout",
                                        "Value": "@doc_adr_type_select",
                                        "Variable": "doc_type_click",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "50",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@fld_number",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "DateField",
                                        "Value": "@doc_date",
                                        "Variable": "fld_data"
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@warehouse",
                                                "Variable": "warehouse"
                                            },
                                            {
                                                "TextSize": "18",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "...",
                                                "Variable": "btn_select_warehouse"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Сохранить",
                                                "Variable": "btn_ok"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "Button",
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "new_adr_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "new_adr_doc_on_select",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "CVOperationName": "ActiveCV",
                "type": "CVOperation",
                "hidden": true,
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "Objects_Full",
                        "CVResolution": "HD720",
                        "CVMode": "green_and_grey",
                        "CVCameraDevice": "Back",
                        "CVDetectorMode": "train"
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Создание таблиц",
                "hidden": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Создать таблицы",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "Button",
                                        "Value": "Создать таблицы",
                                        "Variable": "btn_init"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "app_on_start",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Универсальный справочник",
                "hidden": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Справочник",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@cards",
                                        "Variable": "current_card"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "online",
                                "method": "universal_cards_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "online",
                                "method": "universal_cards_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Товары",
                "DefineOnBackPressed": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Товары список",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextItalic": false,
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "2",
                                                "type": "TextView",
                                                "Value": "Категория:",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "object",
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type"
                                            }
                                        ]
                                    },
                                    {
                                        "TextColor": "#ff0000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@error_txt",
                                        "Variable": "error_txt"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Цены товара",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextColor": "18",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@name",
                                        "Variable": ""
                                    },
                                    {
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "TextSize": "16",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@code",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@type_name",
                                                "Variable": ""
                                            }
                                        ]
                                    },
                                    {
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@good_prices",
                                        "Variable": "good_prices"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "price_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@cards",
                                        "Variable": "cards"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "good_types_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "good_types_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Карточка товара",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "buttons",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "ProgressButton",
                                                "Value": "Цены",
                                                "Variable": "to_prices"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "2",
                                                "type": "TextView",
                                                "Value": "",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "ProgressButton",
                                                "Value": "Остатки",
                                                "Variable": "to_remains"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "name",
                                        "Elements": [
                                            {
                                                "TextSize": "22",
                                                "TextColor": "#7A005C",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "TextView",
                                                "Value": "@good_name",
                                                "Variable": ""
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@item_key",
                                                "Variable": "item_key"
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "good_info",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@good_type",
                                                "Variable": "good_type",
                                                "TextBold": true
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "art",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "TextBold": false,
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@good_art",
                                                        "Variable": "good_art"
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "code",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Код:",
                                                        "Variable": "",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@good_code",
                                                        "Variable": "good_code"
                                                    }
                                                ]
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "descr",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "Описание:",
                                                        "Variable": "",
                                                        "TextBold": true
                                                    },
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr"
                                                    }
                                                ]
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "CardsLayout",
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards"
                                            }
                                        ]
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@load_info",
                                        "Variable": "load_info"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "action": "run",
                                "type": "python",
                                "method": "get_good_variants",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Параметры",
                "hidden": false,
                "DefineOnBackPressed": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки и обмен",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "25",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "drawable": "plus"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CheckBox",
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CheckBox",
                                        "Value": "Разрешить ввод факт товара",
                                        "Variable": "allow_fact_input"
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@path",
                                        "Variable": "path",
                                        "style_name": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Настройки HTTP подключения",
                                        "Variable": "btn_http_settings"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Настройки шрифтов",
                                        "Variable": "btn_size"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Настройки звука",
                                        "Variable": "btn_sound_settings"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Тест сканера",
                                        "Variable": "btn_test_barcode"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Лог ошибок",
                                        "Variable": "btn_err_log"
                                    },
                                    {
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Выгрузить данные на  HTTP сервер",
                                        "Variable": "btn_upload_docs"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Обмен с HTTP 1c сервером",
                                        "Variable": "btn_timer"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "СписокФайлов",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "MultilineText",
                                        "Value": "@files_list",
                                        "Variable": "files_list"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки Шрифтов",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Размеры",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@TitleTextSize",
                                        "Variable": "TitleTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@CardTitleTextSize",
                                        "Variable": "CardTitleTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@CardDateTextSize",
                                        "Variable": "CardDateTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@CardTextSize",
                                        "Variable": "CardTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@GoodsCardTitleTextSize",
                                        "Variable": "GoodsCardTitleTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@goodsTextSize",
                                        "Variable": "goodsTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@SeriesPropertiesTextSize",
                                        "Variable": "SeriesPropertiesTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@DocTypeCardTextSize",
                                        "Variable": "DocTypeCardTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@titleDocTypeCardTextSize",
                                        "Variable": "titleDocTypeCardTextSize"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Сохранить",
                                        "Variable": "btn_on_save"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "font_sizes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "font_size_settings_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Тест сканера",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "20",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Отсканируйте штрихкод",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_1",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_2",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_3",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_4",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_5",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_6",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "20",
                                        "TextColor": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@fld_7",
                                        "Variable": ""
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "test_barcode_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "MultilineText",
                                        "Value": "@error_log",
                                        "Variable": "error_log"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Очистить",
                                        "Variable": "btn_clear_err"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки http соединения",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextSize": "25",
                                        "TextBold": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Адрес сервера",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@url",
                                        "Variable": "url"
                                    },
                                    {
                                        "TextSize": "20",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Пользователь",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@user",
                                        "Variable": "user"
                                    },
                                    {
                                        "TextSize": "20",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Пароль",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@pass",
                                        "Variable": "pass"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Ваше имя для идентификации в 1С",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@user_name",
                                        "Variable": "user_name"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "@btn_test_connection",
                                        "Variable": "btn_test_connection"
                                    },
                                    {
                                        "TextSize": "20",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@ANDROID_ID",
                                        "Variable": ""
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "Elements": [
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "ProgressButton",
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel"
                                            },
                                            {
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "ProgressButton",
                                                "Value": "Сохранить",
                                                "Variable": "btn_save"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera2"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_click",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройка звука",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Номер мелодии",
                                        "Variable": ""
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@signal_num_card",
                                        "Variable": "signal_num_value",
                                        "style_name": ""
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ModernEditText",
                                        "Value": "@beep_duration_card",
                                        "Variable": "beep_duration_value",
                                        "style_name": ""
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Тест звука",
                                        "Variable": "btn_test_sound",
                                        "style_name": ""
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "btn_on_save",
                                        "style_name": ""
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_listener",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Остатки",
                "hidden": true,
                "DefineOnBackPressed": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверить остатки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "1",
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "Elements": [
                                                            {
                                                                "TextItalic": true,
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Выбор склада:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "object",
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "height": "4",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "",
                                                "Variable": ""
                                            },
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "2",
                                                        "type": "TextView",
                                                        "Value": "Выбор ячейки:",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "1",
                                                        "type": "object",
                                                        "Value": "@cell_select",
                                                        "Variable": "cell_select"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "art",
                                                        "Elements": [
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Артикул товара:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "EditTextText",
                                                                "Value": "@good_art_input",
                                                                "Variable": "good_art_input"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "TextColor": "#008000",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@selected_object_name",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "cell",
                                                        "Elements": [
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "EditTextText",
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "TextColor": "#008000",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@selected_cell_name",
                                                        "Variable": "selected_cell_name"
                                                    },
                                                    {
                                                        "TextColor": "#ff0000",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@error_msg",
                                                        "Variable": "error_msg"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "TextSize": "15",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Запросить остатки",
                                        "Variable": "get_remains_btn"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@goods_custom_table",
                                        "Variable": "goods_custom_table"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "runprogress",
                                "type": "python",
                                "method": "remains_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "remains_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор склада",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@wh_cards",
                                        "Variable": "wh_cards"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "backward",
                                "Variable": "back_to_remains"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "open_wh_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "warehouse_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Таблица остатков",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info"
                                    },
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name"
                                    },
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name"
                                    },
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name"
                                    },
                                    {
                                        "TextColor": "#ff0000",
                                        "TextItalic": true,
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@error_msg",
                                        "Variable": "error_msg"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@goods_custom_table",
                                        "Variable": "goods_custom_table"
                                    },
                                    {
                                        "TextSize": "",
                                        "TextColor": "",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "",
                                        "type": "TextView",
                                        "Value": "@no_data",
                                        "Variable": "no_data",
                                        "style_name": "",
                                        "drawable": "forward"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "remains_tables_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор ячейки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@cell_cards",
                                        "Variable": "cell_cards"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@cards_loading",
                                        "Variable": "cards_loading"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "backward",
                                "Variable": "back_to_remains"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "open_cell_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "cell_list_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "action": "run",
                                "type": "python",
                                "method": "get_good_cells",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Цены",
                "hidden": true,
                "DefineOnBackPressed": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверка цен",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "TextItalic": true,
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "2",
                                                        "type": "TextView",
                                                        "Value": "Артикул товара:",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "1",
                                                        "type": "EditTextText",
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art"
                                                    }
                                                ]
                                            },
                                            {
                                                "TextColor": "#008000",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "0",
                                                "type": "TextView",
                                                "Value": "@prices_object_name",
                                                "Variable": ""
                                            }
                                        ]
                                    },
                                    {
                                        "BackgroundColor": "",
                                        "StrokeWidth": "",
                                        "Padding": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "Elements": [
                                            {
                                                "BackgroundColor": "",
                                                "StrokeWidth": "",
                                                "Padding": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "gravity_horizontal": "center",
                                                "gravity_vertical": "center",
                                                "weight": "1",
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "Elements": [
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "price_type",
                                                        "Elements": [
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Тип цены:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "object",
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "properties",
                                                        "Elements": [
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Характеристики:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "object",
                                                                "Value": "@property_select",
                                                                "Variable": "property_select"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "BackgroundColor": "",
                                                        "StrokeWidth": "",
                                                        "Padding": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "LinearLayout",
                                                        "Variable": "units",
                                                        "Elements": [
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "2",
                                                                "type": "TextView",
                                                                "Value": "Упаковка:",
                                                                "Variable": ""
                                                            },
                                                            {
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "gravity_horizontal": "center",
                                                                "gravity_vertical": "center",
                                                                "weight": "1",
                                                                "type": "object",
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "",
                                                        "Variable": ""
                                                    },
                                                    {
                                                        "TextColor": "#ff0000",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "gravity_horizontal": "center",
                                                        "gravity_vertical": "center",
                                                        "weight": "0",
                                                        "type": "TextView",
                                                        "Value": "@prices_error_msg",
                                                        "Variable": "prices_error_msg"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "height": "1",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn"
                                    },
                                    {
                                        "height": "3",
                                        "width": "wrap_content",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "",
                                        "Variable": ""
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@prices_custom_table",
                                        "Variable": "prices_custom_table"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "runprogress",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор типа цены",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@price_type_cards",
                                        "Variable": "price_type_cards"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "backward",
                                "Variable": "back_to_prices"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_types_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "price_types_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор характеристик",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@property_cards",
                                        "Variable": "property_cards"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "backward",
                                "Variable": "back_to_prices"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "property_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "properties_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор упаковки",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CardsLayout",
                                        "Value": "@unit_cards",
                                        "Variable": "unit_cards"
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "backward",
                                "Variable": "back_to_prices"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "unit_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "units_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    },
                    {
                        "type": "Operation",
                        "Name": "Таблица цен",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": false,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info"
                                    },
                                    {
                                        "TextColor": "#008000",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@prices_object_name",
                                        "Variable": "prices_object_name"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TableLayout",
                                        "Value": "@prices_custom_table",
                                        "Variable": "prices_custom_table"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "@no_data",
                                        "Variable": ""
                                    }
                                ]
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "action": "run",
                                "type": "python",
                                "method": "price_tables_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "action": "run",
                                "type": "python",
                                "method": "prices_tables_on_input",
                                "postExecute": ""
                            }
                        ],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Отладка",
                "hidden": true,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Отладочный экран",
                        "Timer": false,
                        "noScroll": false,
                        "hideBottomBarScreen": true,
                        "hideToolBarScreen": true,
                        "noConfirmation": true,
                        "handleKeyUp": false,
                        "Elements": [
                            {
                                "BackgroundColor": "",
                                "StrokeWidth": "",
                                "Padding": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "LinearLayout",
                                "Variable": "",
                                "Elements": [
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "TextView",
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "drawable": "plus"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CheckBox",
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark"
                                    },
                                    {
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@ip_host",
                                        "Variable": "ip_host"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "left",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "EditTextText",
                                        "Value": "@path",
                                        "Variable": "path"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "CheckBox",
                                        "Value": "Удалять файлы после загрузки",
                                        "Variable": "delete_files"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Загрузить локальные csv файлы",
                                        "Variable": "btn_local_files"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Выгрузить изменения в csv ",
                                        "Variable": "btn_export"
                                    },
                                    {
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Создать таблицы БД",
                                        "Variable": "btn_init"
                                    },
                                    {
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list"
                                    },
                                    {
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version"
                                    },
                                    {
                                        "height": "0",
                                        "width": "0",
                                        "gravity_horizontal": "center",
                                        "gravity_vertical": "center",
                                        "weight": "0",
                                        "type": "ProgressButton",
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [],
                        "onlineOnStart": false,
                        "onlineOnAfterStart": false,
                        "onlineOnInput": false
                    }
                ]
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple",
            "vendor_url": "",
            "vendor_auth": "",
            "handler_split_mode": false,
            "handler_code": "",
            "handler_url": "",
            "handler_auth": "",
            "dictionaries": ""
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "FaceRecognitionURL": "",
        "ForegroundService": false,
        "StopForegroundServiceOnExit": false,
        "RunPython": true,
        "LaunchProcess": "",
        "MainMenu": [
            {
                "MenuId": "01",
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuTop": false
            }
        ],
        "Mediafile": [],
        "PyHandlers": "aW1wb3J0IGRiX3NlcnZpY2VzCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmltcG9ydCB1aV9iYXJjb2RlcwppbXBvcnQgdWlfY3N2CmltcG9ydCB1aV9nbG9iYWwKaW1wb3J0IHVpX2Zvcm1fZGF0YQppbXBvcnQgdWlfZm9ybV9kYXRhMiBhcyB1aV90YWJsZXNfc3RydWN0dXJlCmltcG9ydCB1aV9tb2RlbHMKaW1wb3J0IHNvY2tldAppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGRhdGFiYXNlX2luaXRfcXVlcnllcwppbXBvcnQgb3MKZnJvbSBQSUwgaW1wb3J0IEltYWdlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBpbXBvcnRsaWIKCmltcG9ydCB3aWRnZXRzCiMgZnJvbSByc19zZXR0aW5ncyBpbXBvcnQgUlNTZXR0aW5ncwpmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwppbXBvcnQgaHR0cF9leGNoYW5nZQpmcm9tIHJlcXVlc3RzLmF1dGggaW1wb3J0IEhUVFBCYXNpY0F1dGgKaW1wb3J0IHVpX3V0aWxzCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKZnJvbSBydS50cmF2ZWxmb29kLnNpbXBsZV91aSBpbXBvcnQgSW1wb3J0VXRpbHMgYXMgaXVDbGFzcwojIGZyb20gYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZSBpbXBvcnQgR3JhZGllbnREcmF3YWJsZSBhcyBHcmFkaWVudERyYXdhYmxlCiMgZnJvbSBhbmRyb2lkLmdyYXBoaWNzIGltcG9ydCBDb2xvcgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCmltcG9ydGxpYi5yZWxvYWQodWlfY3N2KQppbXBvcnRsaWIucmVsb2FkKHVpX2dsb2JhbCkKaW1wb3J0bGliLnJlbG9hZCh1aV9mb3JtX2RhdGEpCmltcG9ydGxpYi5yZWxvYWQodWlfdGFibGVzX3N0cnVjdHVyZSkKaW1wb3J0bGliLnJlbG9hZChkYXRhYmFzZV9pbml0X3F1ZXJ5ZXMpCmltcG9ydGxpYi5yZWxvYWQoaHR0cF9leGNoYW5nZSkKaW1wb3J0bGliLnJlbG9hZCh1aV91dGlscykKaW1wb3J0bGliLnJlbG9hZChkYl9zZXJ2aWNlcykKaW1wb3J0bGliLnJlbG9hZCh3aWRnZXRzKQppbXBvcnRsaWIucmVsb2FkKHVpX21vZGVscykKCiMgPT09PT09PT09PT09PT09IEdyb3VwIFNjYW4gPT09PT09PT09PT09PT09PT0KCgpkZWYgY3JlYXRlX3NjcmVlbihoYXNoX21hcCk6CiAgICBzY3JlZW5fcGFyYW1zID0gewogICAgICAgICdoYXNoX21hcCc6IGhhc2hfbWFwLAogICAgICAgICdyc19zZXR0aW5ncyc6IHJzX3NldHRpbmdzCiAgICB9CiAgICByZXR1cm4gdWlfbW9kZWxzLlNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oKipzY3JlZW5fcGFyYW1zKQoKCkBIYXNoTWFwKCkKZGVmIHRpbGVzX29uX3N0YXJ0X2dyb3VwX3NjYW4oaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgdGlsZXNfb25faW5wdXRfZ3JvdXBfc2NhbihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2NzX29uX3N0YXJ0X2dyb3VwX3NjYW4oaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vbl9zZWxlY3RfZ3JvdXBfc2NhbihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2NfZGV0YWlsc19vbl9zdGFydF9ncm91cF9zY2FuKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2xpc3RlbmVyX2dyb3VwX3NjYW4oaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfYmFyY29kZV9zY2FubmVkKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIGlmIGhhc2hfbWFwWydiYXJjb2RlX3NjYW5uZWQnXSA9PSAndHJ1ZSc6CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoX21hcC5nZXQoJ2lkX2RvYycpCgogICAgICAgIGFuc3dlciA9IGh0dHBfZXhjaGFuZ2UucG9zdF9nb29kc190b19zZXJ2ZXIoZG9jLmlkX2RvYywgZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaF9tYXApKQoKICAgICAgICBpZiBhbnN3ZXIgYW5kIGFuc3dlci5nZXQoJ0Vycm9yJykgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGhhc2hfbWFwLmRlYnVnKGFuc3dlci5nZXQoJ0Vycm9yJykpCgogICAgICAgIGRvY19kZXRhaWxzX29uX3N0YXJ0KGhhc2hfbWFwKQogICAgICAgIGhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiMgXl5eXl5eXl5eXl5eXl5eXl4gR3JvdXAgU2NhbiBeXl5eXl5eXl5eXl5eXl5eXgoKIyAtLS0tLQojIDAxMDA2MDg5NDA1NTM4ODYyMTUsaVBHU1FwQnQhJkIKZGVmIHNldHRpbmdzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICMgaGFzaE1hcC5wdXQoJ3RvYXN0Jywn0L7QsdC90L7QstC40LvQuNGB0YwnKQogICAgI2FwcF9vbl9zdGFydChoYXNoTWFwKQogICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgdHJ5OgogICAgICAgIHMuY29ubmVjdCgoIjguOC44LjgiLCA4MCkpCiAgICAgICAgYWEgPSAocy5nZXRzb2NrbmFtZSgpWzBdKQogICAgICAgICMgYWEgPSBoYXNoTWFwLmdldCgnaXBfYWRyJykKICAgICAgICBoYXNoTWFwLnB1dCgnaXBfYWRyJywgYWEpCiAgICAgICAgIyBoYXNoTWFwLnB1dCgndG9hc3QnLCBhYSkKICAgIGV4Y2VwdDoKICAgICAgICBoYXNoTWFwLnB1dCgnaXBfYWRyJywgJ9C90LXRgiDRgdC10YLQuCcpCiAgICAjIGFwcF9vbl9zdGFydChoYXNoTWFwKQogICAgIyDQl9C90LDRh9C10L3QuNGPINC60L7QvdGB0YLQsNC90YIg0Lgg0L3QsNGB0YLRgNC+0LXQugogICAgI3JlcyA9IHVpX2dsb2JhbC5nZXRfY29uc3RhbnRzKCkKICAgICNpZiByZXM6CiAgICAgICAgIyBoYXNoTWFwLnB1dCgndXNlX3NlcmllcycsIHN0cihyZXNbMV0pKQogICAgICAgICMgaGFzaE1hcC5wdXQoJ3VzZV9wcm9wZXJ0aWVzJywgc3RyKHJlc1syXSkpCiAgICBoYXNoTWFwLnB1dCgndXNlX21hcmsnLCByc19zZXR0aW5ncy5nZXQoJ3VzZV9tYXJrJykpICAjc3RyKHJlc1szXSkpCiAgICBoYXNoTWFwLnB1dCgnYWxsb3dfZmFjdF9pbnB1dCcsIHJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpKSAgI3N0cihyZXNbM10pKQogICAgaGFzaE1hcC5wdXQoJ2FkZF9pZl9ub3RfaW5fcGxhbicscnNfc2V0dGluZ3MuZ2V0KCdhZGRfaWZfbm90X2luX3BsYW4nKSkgICMgc3RyKHJlc1s0XSkpCiAgICBoYXNoTWFwLnB1dCgncGF0aCcscnNfc2V0dGluZ3MuZ2V0KCdwYXRoJykgKSAjIHN0cihyZXNbNV0pKQogICAgaGFzaE1hcC5wdXQoJ2RlbGV0ZV9maWxlcycscnNfc2V0dGluZ3MuZ2V0KCdkZWxldGVfZmlsZXMnKSkgICMgc3RyKHJlc1s2XSkpCiAgICBoYXNoTWFwLnB1dCgnYWxsb3dfb3ZlcnNjYW4nLHJzX3NldHRpbmdzLmdldCgnYWxsb3dfb3ZlcnNjYW4nKSkgICMgc3RyKHJlc1s5XSkpCgogICAgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoJ2lwX2hvc3QnKToKICAgICAgICBoYXNoTWFwLnB1dCgnaXBfaG9zdCcsICcxOTIuMTY4LjEuNzcnKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRlYnVnX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIG5vdCBoYXNoTWFwLmNvbnRhaW5zS2V5KCdpcF9ob3N0Jyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2lwX2hvc3QnLCAnMTkyLjE2OC4xLjc3JykKICAgIHJldHVybiBoYXNoTWFwCgoKICAgIGhhc2hNYXAucHV0KCd1c2VfbWFyaycsIHJzX3NldHRpbmdzLmdldCgndXNlX21hcmsnKSkgI3N0cihyZXNbM10pKQogICAgaGFzaE1hcC5wdXQoJ2FkZF9pZl9ub3RfaW5fcGxhbicsIHJzX3NldHRpbmdzLmdldCgnYWRkX2lmX25vdF9pbl9wbGFuJykpICNzdHIocmVzWzRdKSkKICAgIGhhc2hNYXAucHV0KCdwYXRoJywgcnNfc2V0dGluZ3MuZ2V0KCdwYXRoJykpICNzdHIocmVzWzVdKSkKICAgIGhhc2hNYXAucHV0KCdkZWxldGVfZmlsZXMnLCByc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9maWxlcycpKSAjc3RyKHJlc1s2XSkpCiAgICBoYXNoTWFwLnB1dCgnYWxsb3dfb3ZlcnNjYW4nLCByc19zZXR0aW5ncy5nZXQoJ2FsbG93X292ZXJzY2FuJykpICNzdHIocmVzWzldKSkKCmRlZiBkZWJ1Z19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBkZWxldGVfZmlsZXMgPSByc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9maWxlcycpCiAgICBpZiBkZWxldGVfZmlsZXMgaXMgTm9uZTogZGVsZXRlX2ZpbGVzID0gJ2ZhbHNlJwoKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKCiAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX2NvcHlfYmFzZSc6CiAgICAgICAgaXBfaG9zdCA9IGhhc2hNYXAuZ2V0KCdpcF9ob3N0JykKICAgICAgICAjIGlwX2hvc3QgPSAnMTAuMjQuMjQuMjAnCiAgICAgICAgaWYgb3MucGF0aC5pc2ZpbGUoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy9TaW1wbGVLZWVwJyk6ICNLZWVwJyk6CiAgICAgICAgICAgIHdpdGggb3BlbignLy9kYXRhL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvZGF0YWJhc2VzL1NpbXBsZUtlZXAnLCAncmInKSBhcyBmOiAgIyByaWdodHNjYW4KICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCdodHRwOi8vJyArIGlwX2hvc3QgKyAnOjI0NDQvcG9zdCcsIGZpbGVzPXsnUmlnaHRzY2FuJzogZn0pICAjIHJpZ2h0c2NhbgogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQkdCw0LfQsCBTUUxpdGUg0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvdCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fbG9jYWxfZmlsZXMnOgogICAgICAgICMgcGF0aCA9IGhhc2hNYXAuZ2V0KCdsb2NhbHBhdGgnKQogICAgICAgIHBhdGggPSBoYXNoTWFwLmdldCgncGF0aCcpCiAgICAgICAgZGVsZXRlX2ZpbGVzID0gaGFzaE1hcC5nZXQoJ2RlbGV0ZV9maWxlcycpCiAgICAgICAgaWYgbm90IGRlbGV0ZV9maWxlczoKICAgICAgICAgICAgZGVsZXRlX2ZpbGVzID0gJzAnCiAgICAgICAgaWYgbm90IHBhdGg6IHBhdGggPSAnLy9zdG9yYWdlL2VtdWxhdGVkLzAvZG93bmxvYWQvJwoKICAgICAgICByZXRfdGV4dCA9IHVpX2Nzdi5saXN0X2ZvbGRlcihwYXRoLCBkZWxldGVfZmlsZXMpCgogICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHJldF90ZXh0KQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgc2V0dGluZ3Nfb25fY2xpY2soaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgI9CY0YHQv9C+0LvRjNC30L7QstCw0YLRjCDQvNCw0YDQutC40YDQvtCy0LrRgwogICAgdXNlX21hcmsgPSBoYXNoTWFwLmdldCgndXNlX21hcmsnKQogICAgaWYgdXNlX21hcmsgaXMgTm9uZTogdXNlX21hcmsgPSAnZmFsc2UnCgogICAgcGF0aCA9IGhhc2hNYXAuZ2V0KCdwYXRoJykKICAgIGlmIHBhdGggaXMgTm9uZTogcGF0aCA9ICcvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvJyAgIyAnLy9zdG9yYWdlL2VtdWxhdGVkLzAvZG93bmxvYWQvJwoKICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBoYXNoTWFwLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpCiAgICBpZiBhbGxvd19mYWN0X2lucHV0IGlzIE5vbmU6IGFsbG93X2ZhY3RfaW5wdXQgPSAnZmFsc2UnCgogICAgIyB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgnVXBkYXRlIFJTX2RvY3MgU0VUIGNvbnRyb2wgPSA/JywoYWxsb3dfb3ZlcnNjYW4sKSkgICPQkiDRgtCw0LHQu9C40YbRiyDQtNC+0LrRg9C80LXQvdGC0L7QsiDQt9Cw0L/QuNGB0YvQstCw0LXQvCDQvdC+0LLQvtC1INC30L3QsNGH0LXQvdC40LUg0LrQvtC90YLRgNC+0LvRjwogICAgI3VpX2dsb2JhbC5wdXRfY29uc3RhbnRzKAogICAgcnNfc2V0dGluZ3MucHV0KCd1c2VfbWFyaycsdXNlX21hcmssIFRydWUpICMsIHBhdGgpKQogICAgcnNfc2V0dGluZ3MucHV0KCdwYXRoJywgcGF0aCwgVHJ1ZSkKICAgIHJzX3NldHRpbmdzLnB1dCgnYWxsb3dfZmFjdF9pbnB1dCcsIGFsbG93X2ZhY3RfaW5wdXQsIFRydWUpICAjICwgcGF0aCkpCgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgnbGlzdGVuZXInKQoKICAgIGlmIGxpc3RlbmVyID09ICdidG5fZXhwb3J0JzoKCiAgICAgICAgdWlfY3N2LmV4cG9ydF9jc3YocGF0aCwgaGFzaE1hcC5nZXQoJ2lwX2FkcicpLCBoYXNoTWFwLmdldCgnQU5EUk9JRF9JRCcpKQogICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQlNCw0L3QvdGL0LUg0LLRi9Cz0YDRg9C20LXQvdGLJykKCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgoKICAgICAgICBoYXNoTWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgICMgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2ZpbGVzX2xpc3QnOgogICAgIyAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0KHQv9C40YHQvtC60KTQsNC50LvQvtCyJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9jb25mX3ZlcnNpb24nOgogICAgICAgIGNvbmYgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCdfY29uZmlndXJhdGlvbiAnKSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2l6ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INCo0YDQuNGE0YLQvtCyJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl90ZXN0X2JhcmNvZGUnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Ci0LXRgdGCINGB0LrQsNC90LXRgNCwJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9lcnJfbG9nJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQntGI0LjQsdC60LgnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2h0dHBfc2V0dGluZ3MnOgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCBodHRwINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JudF9jbGVhcl90YWJsZXMnOgogICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgU0VMRUNUIG5hbWUgRlJPTSBzcWxpdGVfbWFzdGVyIFdIRVJFIHR5cGU9J3RhYmxlJwogICAgICAgICcnJwogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGRlbF90ZXh0ID0gJ0RFTEVURSBGUk9NICcgKyBlbFswXQogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChkZWxfdGV4dCkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl91cGxvYWRfZG9jcyc6CiAgICAgICAgdXJsID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICBxdGV4dCA9ICcnJ1NFTEVDVCBpZF9kb2MgRlJPTSBSU19kb2NzIFdIRVJFIHZlcmlmaWVkID0gJzEnCiAgICAgICAgICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWRfZG9jIEZST00gUlNfYWRyX2RvY3MgV0hFUkUgdmVyaWZpZWQgPSAnMScgJycnCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIE5vbmUsIFRydWUpCgogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgZG9jX2xpc3QgPSBbXQogICAgICAgICAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgICAgICAgICAgZG9jX2xpc3QuYXBwZW5kKCciJyArIGVsWydpZF9kb2MnXSArICciJykKICAgICAgICAgICAgZG9jX2luX3N0ciA9ICcsJy5qb2luKGRvY19saXN0KQogICAgICAgICAgICAjIGh0cHBhcmFtcyA9IHsndXNlcm5hbWUnOmhhc2hNYXAuZ2V0KCdvbmxpbmVVc2VyJyksICdwYXNzd29yZCc6aGFzaE1hcC5nZXQoJ29ubGluZVBhc3MnKSwgJ3VybCc6dXJsfQogICAgICAgICAgICBhbnN3ZXIgPSBodHRwX2V4Y2hhbmdlLnBvc3RfY2hhbmdlc190b19zZXJ2ZXIoZG9jX2luX3N0ciwgdXJsKQogICAgICAgICAgICBpZiBhbnN3ZXIuZ2V0KCdFcnJvcicpIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLndyaXRlX2Vycm9yX29uX2xvZyhzdHIoYW5zd2VyLmdldCgnRXJyb3InKSkpCgogICAgICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3MgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGRvY19pbl9zdHIsKSwgRmFsc2UpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGltZXInOgogICAgICAgIHRyeToKICAgICAgICAgICAgdGltZXJfdXBkYXRlKGhhc2hNYXApCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLHN0cihlKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zb3VuZF9zZXR0aW5ncyc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCfQndCw0YHRgtGA0L7QudC60LAg0LfQstGD0LrQsCcpCiAgICByZXR1cm4gaGFzaE1hcAoKCiMg0JfQsNC/0L7Qu9C90LXQvdC40LUg0YHQv9C40YHQutCwINC00L7QutGD0LzQtdC90YLQvtCyCmRlZiByZWZpbGxfZG9jc19saXN0KGZpbHRlcj0nJyk6CiAgICBkb2NfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2NhcmQocnNfc2V0dGluZ3MpCiAgICBkb2NfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY19xdWVyeShmaWx0ZXIpCgogICAgaWYgZmlsdGVyID09ICcnIG9yIGZpbHRlciA9PSAn0JLRgdC1JzoKICAgICAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChmaWx0ZXIsKSkKCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgaWYgcmVjb3JkWzhdID09IDE6CiAgICAgICAgICAgIGNvbXBsZXRlZCA9ICd0cnVlJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbXBsZXRlZCA9ICdmYWxzZScKICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgJ2NvbXBsZXRlZCc6IGNvbXBsZXRlZCwKICAgICAgICAgICAgJ3R5cGUnOiBzdHIocmVjb3JkWzFdKSwKICAgICAgICAgICAgJ251bWJlcic6IHN0cihyZWNvcmRbMl0pLAogICAgICAgICAgICAnZGF0YSc6IHN0cihyZWNvcmRbM10pLAogICAgICAgICAgICAna2V5JzogcmVjb3JkWzBdLAogICAgICAgICAgICAnd2FyZWhvdXNlJzogcmVjb3JkWzddLAogICAgICAgICAgICAnY291bnRyYWdlbnQnOiByZWNvcmRbNl0sCiAgICAgICAgICAgICdhZGRfbWFya19zZWxlY3Rpb24nOiByZWNvcmRbMTBdCiAgICAgICAgfQogICAgICAgIGRvY19saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgcmV0dXJuIGpzb24uZHVtcHMoZG9jX2xpc3QpCgoKZGVmIHJlZmlsbF9kb2NzX2xpc3RfbmV3KF9maWx0ZXI9JycpOgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3F1ZXJ5KF9maWx0ZXIpCgogICAgaWYgX2ZpbHRlciA9PSAnJyBvciBfZmlsdGVyID09ICfQktGB0LUnOgogICAgICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCByZXR1cm5fZGljdD1UcnVlKQogICAgZWxzZToKICAgICAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKF9maWx0ZXIsKSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKCiAgICB0YWJsZV9kYXRhID0gW10KCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoewogICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZF9kb2MnXSwKICAgICAgICAgICAgJ3R5cGUnOiByZWNvcmRbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICdudW1iZXInOiByZWNvcmRbJ2RvY19uJ10sCiAgICAgICAgICAgICdkYXRhJzogcmVjb3JkWydkb2NfZGF0ZSddLAogICAgICAgICAgICAnd2FyZWhvdXNlJzogcmVjb3JkWydSU193YXJlaG91c2UnXSwKICAgICAgICAgICAgJ2NvdW50cmFnZW50JzogcmVjb3JkWydSU19jb3VudHJhZ2VudCddLAogICAgICAgICAgICAnYWRkX21hcmtfc2VsZWN0aW9uJzogcmVjb3JkWydhZGRfbWFya19zZWxlY3Rpb24nXQogICAgICAgIH0pCgogICAgcmV0dXJuIHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2NhcmRfbmV3KHJzX3NldHRpbmdzLCB0YWJsZV9kYXRhKQoKCmRlZiBkb2NzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICMg0JfQsNC/0L7Qu9C90LjQvCDQv9C+0LvQtSDRhNC40LvRjNGC0YDQsCDQv9C+INCy0LjQtNGDINC00L7QutGD0LzQtdC90YLQvtCyCiAgICBoYXNoTWFwLnB1dCgiU2V0VGl0bGUiLCAi0JTQvtC60YPQvNC10L3RgtGLIikKICAgIHJlc3VsdCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3R5cGVfcXVlcnkoKSkKICAgIGlmIGhhc2hNYXAuZ2V0KCdkb2NfdHlwZV9zZWxlY3QnKSA9PSBOb25lOgogICAgICAgIGRvY190eXBlX2xpc3QgPSBbJ9CS0YHQtSddCiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHQ6CiAgICAgICAgICAgIGRvY190eXBlX2xpc3QuYXBwZW5kKHJlY29yZFswXSkKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX3R5cGVfc2VsZWN0JywgJzsnLmpvaW4oZG9jX3R5cGVfbGlzdCkpCgogICAgIyBoYXNoTWFwLnB1dCgnZG9jX3R5cGVfY2xpY2snLCAn0JLRgdC1JykKICAgICMg0JXRgdC70Lgg0JLRi9C30L7QsiDRjdC60YDQsNC90LAg0LjQtyDQvNC10L3RjiDQv9C70LjRgtC+0LogLSDQvtCx0YDQsNCx0L7RgtCw0LXQvAogICAgaWYgaGFzaE1hcC5jb250YWluc0tleSgnc2VsZWN0ZWRfdGlsZV9rZXknKToKICAgICAgICB0aWxlX2tleSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF90aWxlX2tleScpCiAgICAgICAgaWYgdGlsZV9rZXk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdkb2NfdHlwZV9jbGljaycsIHRpbGVfa2V5KQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdGlsZV9rZXknLCAnJykKICAgICMg0J/QtdGA0LXQt9Cw0L/QvtC70L3QuNC8INGB0L/QuNGB0L7QuiDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgaWYgaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykgPT0gTm9uZToKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoKQogICAgZWxzZToKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykpCiAgICBoYXNoTWFwLnB1dCgiZG9jQ2FyZHMiLCBscykKCiAgICByZXR1cm4gaGFzaE1hcAoKCgpkZWYgZG9jX2RldGFpbHNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlmIGhhc2hNYXAuZ2V0KCdkb2NfZ29vZHNfdGFibGUnKToKICAgICAgICBoYXNoTWFwLnB1dCgiZG9jX2dvb2RzX3RhYmxlIiwgTm9uZSkKCiAgICBpZiBoYXNoTWFwLmdldCgid2FyZWhvdXNlIik6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfd2FyZWhvdXNlIiwgIjEiKQogICAgZWxzZToKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd193YXJlaG91c2UiLCAiLTEiKQogICAgaWYgaGFzaE1hcC5nZXQoImNvdW50cmFnZW50Iik6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfY291bnRyYWdlbnQiLCAiMSIpCiAgICBlbHNlOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93X2NvdW50cmFnZW50IiwgIi0xIikKCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKSA9PSAndHJ1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfZmFjdF9xdHR5X2lucHV0IiwgIjEiKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9ub3RlIiwgIi0xIikKICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfZmFjdF9xdHR5X2lucHV0IiwgIi0xIikKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfbm90ZSIsICIxIikKCgogICAgaGFzaE1hcC5wdXQoJ1NldFRpdGxlJywgaGFzaE1hcC5nZXQoImRvY190eXBlIikpCgogICAgaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICBmYWxzZVZhbHVlTGlzdCA9ICgwLCcwJywnZmFsc2UnLCdGYWxzZScsTm9uZSkKICAgICMg0KTQvtGA0LzQuNGA0YPQtdC8INGC0LDQsdC70LjRhtGDINC60LDRgNGC0L7Rh9C10Log0Lgg0LfQsNC/0YDQvtGBINC6INCx0LDQt9C1CiAgICAjcmVzID0gdWlfZ2xvYmFsLmdldF9jb25zdGFudHMoKQogICAgdXNlX3NlcmllcyA9IHJzX3NldHRpbmdzLmdldCgndXNlX3NlcmllcycpICNyZXNbMV0KICAgIHVzZV9wcm9wZXJ0aWVzID0gcnNfc2V0dGluZ3MuZ2V0KCd1c2Vfc2VyaWVzJykgI3Jlc1syXQogICAgaGFzaE1hcC5wdXQoJ3VzZV9wcm9wZXJ0aWVzJywgcnNfc2V0dGluZ3MuZ2V0KCd1c2Vfc2VyaWVzJykpICNyZXNbMl0pCiAgICBkb2NfZGV0YWlsX2xpc3QgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY19kZXRhaWxfY2FyZHModXNlX3NlcmllcywgdXNlX3Byb3BlcnRpZXMscnNfc2V0dGluZ3MpCiAgICBkb2NfZGV0YWlsX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICBpZiBoYXNoTWFwLmdldCgndmlldycpID09ICJjYXJkcyI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfY2FyZF92aWV3JywgIi0xIikKICAgICAgICAjIGRvY19kZXRhaWxfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2RldGFpbF9jYXJkcyh1c2Vfc2VyaWVzLCB1c2VfcHJvcGVydGllcywgcnNfc2V0dGluZ3MpCiAgICAgICAgZG9jX2RldGFpbF9saXN0ID0gdWlfdGFibGVzX3N0cnVjdHVyZS5nZXRfZG9jX2RldGFpbF9jYXJkc19tb2QodXNlX3NlcmllcywgdXNlX3Byb3BlcnRpZXMsIHJzX3NldHRpbmdzKQoKICAgICAgICBkb2NfZGV0YWlsX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfdGFibGVfdmlldycsICItMSIpCiAgICAgICAgZG9jX2RldGFpbF9saXN0ID0gdWlfdGFibGVzX3N0cnVjdHVyZS5nZXRfZG9jX2RldGFpbF90YWJsZV9oZWFkKCkKICAgICAgICBkb2NfZGV0YWlsX2xpc3RbImN1c3RvbXRhYmxlIl1bInRhYmxlZGF0YSJdID0gW3t9XQoKICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnZG9jQ2FyZHMnKSkKCiAgICBlbGVtX24gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICBmb3IgZWwgaW4gZWxlbV9uOgogICAgICAgIGlmIGVsWydrZXknXSA9PSBpZF9kb2M6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdhZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgICAgICBzdHIoZWxbJ2FkZF9tYXJrX3NlbGVjdGlvbiddIGlmIGVsWydhZGRfbWFya19zZWxlY3Rpb24nXSBlbHNlICcwJykpCiAgICAjICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpLTFdCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2RldGFpbHNfcXVlcnkoKQoKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoaWRfZG9jLCksIFRydWUpCiAgICByb3dfZmlsdGVyID0gVHJ1ZSBpZiBoYXNoTWFwLmdldCgncm93c19maWx0ZXInKSA9PSAnMScgZWxzZSBGYWxzZQogICAgaWYgcmVzdWx0czoKICAgICAgICBoYXNoTWFwLnB1dCgnaWRfZG9jJywgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSkKICAgICAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgICAgIHBpYyA9ICcjZjAyYScgaWYgcmVjb3JkWydJc0RvbmUnXSAhPSAwIGVsc2UgJyNmMDBjJwogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSA9PSAwIGFuZCByZWNvcmRbJ3F0dHlfcGxhbiddID09IDA6CiAgICAgICAgICAgICAgICBwaWMgPSAnJwogICAgICAgICAgICBpZiByb3dfZmlsdGVyIGFuZCByZWNvcmRbJ3F0dHknXSA9PSByZWNvcmRbJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnaWQnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pLAogICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Byb3BlcnRpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzdHIocmVjb3JkWydpZF9zZXJpZXMnXSksCiAgICAgICAgICAgICAgICAnc2VyaWVzX25hbWUnOiBzdHIocmVjb3JkWydzZXJpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF91bml0Jzogc3RyKHJlY29yZFsnaWRfdW5pdCddKSwKICAgICAgICAgICAgICAgICd1bml0c19uYW1lJzogc3RyKHJlY29yZFsndW5pdHNfbmFtZSddKSwKICAgICAgICAgICAgICAgICdjb2RlX2FydCc6IHN0cihyZWNvcmRbJ2NvZGUnXSksCiAgICAgICAgICAgICAgICAnYXJ0Jzogc3RyKHJlY29yZFsnYXJ0J10pLAogICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIocmVjb3JkWydxdHR5J10gaWYgcmVjb3JkWydxdHR5J10gaXMgbm90IE5vbmUgZWxzZSAwKSwKICAgICAgICAgICAgICAgICdxdHR5X3BsYW4nOiBzdHIocmVjb3JkWydxdHR5X3BsYW4nXSBpZiByZWNvcmRbJ3F0dHlfcGxhbiddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAncHJpY2UnOiBzdHIocmVjb3JkWydwcmljZSddIGlmIHJlY29yZFsncHJpY2UnXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3ByaWNlX25hbWUnOiBzdHIocmVjb3JkWydwcmljZV9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ29vZF9pbmZvID0gIiIKICAgICAgICAgICAgaWYgcHJvZHVjdF9yb3dbJ2FydCddICE9ICJOb25lIjoKICAgICAgICAgICAgICAgIGdvb2RfaW5mbyArPSBwcm9kdWN0X3Jvd1snYXJ0J10KICAgICAgICAgICAgaWYgcHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddICE9ICJOb25lIjoKICAgICAgICAgICAgICAgIGdvb2RfaW5mbyArPSAiKCIgKyBwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10gKyAiKSIKICAgICAgICAgICAgaWYgcHJvZHVjdF9yb3dbJ3Nlcmllc19uYW1lJ10gIT0gIk5vbmUiOgogICAgICAgICAgICAgICAgZ29vZF9pbmZvICs9IHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddCiAgICAgICAgICAgIGlmIHByb2R1Y3Rfcm93Wyd1bml0c19uYW1lJ10gIT0gIk5vbmUiOgogICAgICAgICAgICAgICAgZ29vZF9pbmZvICs9ICIsICIgKyBwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddCiAgICAgICAgICAgIHByb2R1Y3Rfcm93Wydnb29kX2luZm8nXSA9IGdvb2RfaW5mbwoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3ZpZXcnKSA9PSAiY2FyZHMiOgogICAgICAgICAgICAgICAgZG9jX2RldGFpbF9saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddID0gdWlfdGFibGVzX3N0cnVjdHVyZS5nZXRfZG9jX2RldGFpbF90YWJsZV9ib2R5X2xheW91dCh1c2Vfc2VyaWVzLCB1c2VfcHJvcGVydGllcywgcnNfc2V0dGluZ3MpCgogICAgICAgICAgICAgICAgaWYgZmxvYXQocHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddKSA+IGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5J10pOgogICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J11bIkJhY2tncm91bmRDb2xvciJdID0gIiNGQkU5RTciCgogICAgICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoImFkZGVkX2dvb2RzIik6CiAgICAgICAgICAgICAgICAgICAgYWRkZWRfZ29vZHNfZGljdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImFkZGVkX2dvb2RzIikpCiAgICAgICAgICAgICAgICAgICAgaWYgc3RyKHJlc3VsdHNbMF1bJ2lkX2RvYyddKSBpbiBhZGRlZF9nb29kc19kaWN0LmtleXMoKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc3RyKHJlY29yZFsnaWRfZ29vZCddKSBpbiBhZGRlZF9nb29kc19kaWN0W3N0cihyZXN1bHRzWzBdWydpZF9kb2MnXSldWzBdOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSBpbiBhZGRlZF9nb29kc19kaWN0W3N0cihyZXN1bHRzWzBdWydpZF9kb2MnXSldWzFdIG9yIG5vdCBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J11bIkJhY2tncm91bmRDb2xvciJdID0gIiNGMEY4RkYiCgogICAgICAgICAgICAgICAgaWYgZmxvYXQocHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddKSA9PSBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eSddKToKICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddWyJCYWNrZ3JvdW5kQ29sb3IiXSA9ICIjRkZGRkZGIgoKICAgICAgICAgICAgICAgIGlmIGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5X3BsYW4nXSkgPCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eSddKToKICAgICAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddWyJCYWNrZ3JvdW5kQ29sb3IiXSA9ICIjRkZGOUM0IgoKICAgICAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgICAgICAjINCf0YDQuNC30L3QsNC6LCBoYXZlX3F0dHlfcGxhbiDQldGB0YLRjNCf0LvQsNC90J/QntCa0J7Qu9C40YfQtdGB0YLQstGDICAtICDQmNGB0YLQuNC90LAg0LrQvtCz0LTQsCDRgdGD0LzQvNCwINC60L7Qu9C+0L3QutC4IFF0dHlfcGxhbiA+IDAKICAgICAgICAjINCf0YDQuNC30L3QsNC6ICBoYXZlX21hcmtfcGxhbiAi0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDigJMg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNC+0Log0YLQsNCx0LsuIFJTX2RvY3NfYmFyY29kZXMg0YEg0LfQsNC00LDQvdC90YvQvCBpZF9kb2Mg0LggaXNfcGxhbiAg0LHQvtC70YzRiNC1INC90YPQu9GPLgogICAgICAgICMg0J/RgNC40LfQvdCw0LogaGF2ZV96ZXJvX3BsYW4gItCV0YHRgtGMINGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RgtC1IiDQmNGB0YLQuNC90LAsINC60L7Qs9C00LAg0LXRgdGC0Ywg0LfQsNC/0L7Qu9C90LXQvdC90YvQtSDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNC+0LIg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAi0JrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjCIgIC0g0L/RgNC40LfQvdCw0Log0LTQu9GPINC00L7QutGD0LzQtdC90YLQsCwg0L3QsNC00L4g0LvQuCDQutC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMCgogICAgICAgIHF0ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9xdHR5X3N0cmluZ19jb3VudF9xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jfSkKICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IHJlc1swXVswXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINGB0YLRgNC+0LrQuAogICAgICAgICAgICBpZiBoYXZlX3plcm9fcGxhbjoKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gcmVzWzBdWzFdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0LrQvtC70LLQviDQv9C70LDQvQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICMg0JXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0L/QviDQutC+0LTQsNC8INC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2hhdmVfbWFya19jb2Rlc19xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jLCAnaXNfcGxhbic6ICcxJ30pCiAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IHJlc1swXVswXSA+IDAKCiAgICAgICAgaGFzaE1hcC5wdXQoInRhYmxlX2xpbmVzX3F0dHkiLCBzdHIobGVuKHJlc3VsdHMpKSkKICAgIGVsc2U6CiAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgaGFzaE1hcC5wdXQoJ2hhdmVfcXR0eV9wbGFuJywgc3RyKGhhdmVfcXR0eV9wbGFuKSkKICAgIGhhc2hNYXAucHV0KCdoYXZlX3plcm9fcGxhbicsIHN0cihoYXZlX3plcm9fcGxhbikpCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV9tYXJrX3BsYW4nLCBzdHIoaGF2ZV9tYXJrX3BsYW4pKQogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ1NFTEVDVCBjb250cm9sIGZyb20gUlNfZG9jcyAgV0hFUkUgaWRfZG9jID0gPycsIChpZF9kb2MsKSkKICAgICMg0JXRgdGC0Ywg0LvQuCDQutC+0L3RgtGA0L7Qu9GMINC/0LvQsNC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICBpZiByZXM6CiAgICAgICAgaWYgcmVzWzBdWzBdOgogICAgICAgICAgICBpZiByZXNbMF1bMF0gaW4gZmFsc2VWYWx1ZUxpc3Q6CiAgICAgICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdUcnVlJwoKICAgICAgICAgICAgIyBjb250cm9sID0gcmVzWzBdWzBdICMnVHJ1ZScKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgZWxzZToKICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwoKICAgIGhhc2hNYXAucHV0KCdjb250cm9sJywgY29udHJvbCkKICAgIGlmIGhhc2hNYXAuZ2V0KCJ2aWV3IikgPT0gImNhcmRzIjoKICAgICAgICBoYXNoTWFwLnB1dCgiZG9jX2dvb2RzX2NhcmRzIiwganNvbi5kdW1wcyhkb2NfZGV0YWlsX2xpc3QpKQogICAgZWxzZToKICAgICAgICBoYXNoTWFwLnB1dCgiZG9jX2dvb2RzX3RhYmxlIiwganNvbi5kdW1wcyhkb2NfZGV0YWlsX2xpc3QpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGhpZ2hsaWdodF9hZGRlZF9nb29kKGhhc2hNYXAsIGJhcmNvZGUpOgoKICAgIGdvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkX2dvb2QsaWRfcHJvcGVydHkgRlJPTSBSU19iYXJjb2RlcyB3aGVyZSBiYXJjb2RlID0gJyIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgKyAiJyIpCiAgICBpZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKCiAgICBpZiBsZW4oZ29vZF9xdWVyeSkgPiAwOgogICAgICAgIGdvb2RfaWQgPSBnb29kX3F1ZXJ5WzBdWzBdCiAgICAgICAgZ29vZF9wcm9wZXJ0eV9pZCA9IGdvb2RfcXVlcnlbMF1bMV0KCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoImFkZGVkX2dvb2RzIik6CiAgICAgICAgICAgIGFkZGVkX2dvb2RzX2RpY3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJhZGRlZF9nb29kcyIpKQogICAgICAgICAgICBpZiBpZF9kb2MgaW4gYWRkZWRfZ29vZHNfZGljdC5rZXlzKCk6CiAgICAgICAgICAgICAgICBpZiBnb29kX2lkIG5vdCBpbiBhZGRlZF9nb29kc19kaWN0W2lkX2RvY11bMF06CiAgICAgICAgICAgICAgICAgICAgYWRkZWRfZ29vZHNfZGljdFtpZF9kb2NdWzBdLmFwcGVuZChnb29kX2lkKQogICAgICAgICAgICAgICAgaWYgZ29vZF9wcm9wZXJ0eV9pZDoKICAgICAgICAgICAgICAgICAgICBpZiBnb29kX3Byb3BlcnR5X2lkIG5vdCBpbiBhZGRlZF9nb29kc19kaWN0W2lkX2RvY11bMV06CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkX2dvb2RzX2RpY3RbaWRfZG9jXVsxXS5hcHBlbmQoZ29vZF9wcm9wZXJ0eV9pZCkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhZGRlZF9nb29kc19kaWN0W2lkX2RvY10gPSBbW2dvb2RfaWRdLCBbZ29vZF9wcm9wZXJ0eV9pZF1dCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFkZGVkX2dvb2RzX2RpY3QgPSB7aWRfZG9jOiBbW2dvb2RfaWRdLCBbZ29vZF9wcm9wZXJ0eV9pZF1dfQogICAgICAgIGhhc2hNYXAucHV0KCJhZGRlZF9nb29kcyIsIHN0cihhZGRlZF9nb29kc19kaWN0KS5yZXBsYWNlKCInIiwgJyInKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiByZW1vdmVfYWRkZWRfZ29vZF9oaWdobGlnaHQoaGFzaE1hcCwgZ29vZF9pZD1Ob25lLCBwcm9wZXJ0eV9pZD1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCJhZGRlZF9nb29kcyIpOgogICAgICAgIGlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGFkZGVkX2dvb2RzX2RpY3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJhZGRlZF9nb29kcyIpKQogICAgICAgIGlmIGlkX2RvYyBpbiBhZGRlZF9nb29kc19kaWN0LmtleXMoKToKICAgICAgICAgICAgaWYgZ29vZF9pZCBpbiBhZGRlZF9nb29kc19kaWN0W2lkX2RvY11bMF06CiAgICAgICAgICAgICAgICBhZGRlZF9nb29kc19kaWN0W2lkX2RvY11bMF0ucmVtb3ZlKGdvb2RfaWQpCiAgICAgICAgICAgICIiImlmIHByb3BlcnR5X2lkIGluIGFkZGVkX2dvb2RzX2RpY3RbZ29vZF9pZF1bMV06CiAgICAgICAgICAgICAgICBhZGRlZF9nb29kc19kaWN0W2dvb2RfaWRdWzFdLnJlbW92ZShwcm9wZXJ0eV9pZCkiIiIKICAgICAgICAgICAgaGFzaE1hcC5wdXQoImFkZGVkX2dvb2RzIiwgc3RyKGFkZGVkX2dvb2RzX2RpY3QpLnJlcGxhY2UoIiciLCAnIicpKQogICAgICAgICAgICBpZiBsZW4oYWRkZWRfZ29vZHNfZGljdFtpZF9kb2NdWzBdKSA9PSAwOgogICAgICAgICAgICAgICAgZGVsIGFkZGVkX2dvb2RzX2RpY3RbaWRfZG9jXQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZG9jX2RldGFpbHNfb25fbG9hZChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgYmFyY29kZV9idG4gPSBpdUNsYXNzLmdldFZpZXcoImJ0bl9iYXJjb2RlcyIpCiAgICBzaGFwZV8yID0gR3JhZGllbnREcmF3YWJsZSgpICAjINCh0L7Qt9C00LDQtdC8INGE0L7RgNC80YMKICAgIHNoYXBlXzIuc2V0U2hhcGUoR3JhZGllbnREcmF3YWJsZS5SRUNUQU5HTEUpCiAgICBzaGFwZV8yLnNldENvcm5lclJhZGl1cyg1MCkKICAgIHNoYXBlXzIuc2V0Q29sb3IoQ29sb3IuV0hJVEUpCiAgICBiYXJjb2RlX2J0bi5zZXRCYWNrZ3JvdW5kKHNoYXBlXzIpCiAgICBiYXJjb2RlX2J0bi5zZXRFbGV2YXRpb24oMTUpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBkb2NfYWRyX2RldGFpbHNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICBjdXJyZW50X2NlbGwgPSBoYXNoTWFwLmdldCgnY3VycmVudF9jZWxsX2lkJykKCiAgICBmYWxzZVZhbHVlTGlzdCA9ICgwLCcwJywnZmFsc2UnLCdGYWxzZScsTm9uZSkKICAgICMg0KTQvtGA0LzQuNGA0YPQtdC8INGC0LDQsdC70LjRhtGDINC60LDRgNGC0L7Rh9C10Log0Lgg0LfQsNC/0YDQvtGBINC6INCx0LDQt9C1CiAgICB1c2Vfc2VyaWVzID0gcnNfc2V0dGluZ3MuZ2V0KCd1c2Vfc2VyaWVzJykgICNyZXNbMV0KICAgIHVzZV9wcm9wZXJ0aWVzID0gcnNfc2V0dGluZ3MuZ2V0KCd1c2VfcHJvcGVydGllcycpI3Jlc1syXQogICAgaGFzaE1hcC5wdXQoJ3VzZV9wcm9wZXJ0aWVzJywgdXNlX3Byb3BlcnRpZXMpCiAgICAjZG9jX2RldGFpbF9saXN0ID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfZGV0YWlsX2NhcmRzKHVzZV9zZXJpZXMsIHVzZV9wcm9wZXJ0aWVzLHJzX3NldHRpbmdzLCBUcnVlKQoKICAgIGRvY19kZXRhaWxfbGlzdCA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCh3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSdAZ29vZF9uYW1lJywgVGV4dFNpemU9IHJzX3NldHRpbmdzLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLCBUZXh0Qm9sZCA9IFRydWUsIHdlaWdodCA9IDEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKFZhbHVlID0gItCj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRgyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFRleHRCb2xkID0gVHJ1ZSwgd2VpZ2h0ID0gMSwgVmFsdWU9J0Bjb2RlX2FydCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFRleHRCb2xkID0gRmFsc2UsIHdlaWdodCA9IDEsIFZhbHVlID0gJ0BhcnQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249Imhvcml6b250YWwiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlID0gJ9Cf0LvQsNC9JywgVGV4dFNpemUgPSByc19zZXR0aW5ncy5nZXQoJ2dvb2RzVGV4dFNpemUnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSdAcXR0eV9wbGFuJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSfQpNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhWYWx1ZT0nQHF0dHknKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICN3aWRnZXRzLlRleHRWaWV3KFZhbHVlID0gJ0AnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWUgPSAn0KbQtdC90LAnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWUgPSAnQHByaWNlJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlID0gJ0BwaWN0dXJlJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJob3Jpem9udGFsIiksb3JpZW50YXRpb249InZlcnRpY2FsIiksb3B0aW9ucyA9IHdpZGdldHMuT3B0aW9ucygpKQoKICAgICNkb2NfZGV0YWlsX2xpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICAjINCf0L7Qu9GD0YfQsNC10Lwg0YLQtdC10LrRg9GJ0LjQuSDQtNC+0LrRg9C80LXQvdGCCiAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnZG9jQWRyQ2FyZHMnKSkKCiAgICBlbGVtX24gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICBmb3IgZWwgaW4gZWxlbV9uOgogICAgICAgIGlmIGVsWydrZXknXSA9PSBpZF9kb2M6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdhZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgICAgICAgICBzdHIoZWxbJ2FkZF9tYXJrX3NlbGVjdGlvbiddIGlmIGVsWydhZGRfbWFya19zZWxlY3Rpb24nXSBlbHNlICcwJykpCiAgICAjICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpLTFdCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2RldGFpbHNfcXVlcnkoVHJ1ZSwgVHJ1ZSBpZiBjdXJyZW50X2NlbGwgZWxzZSBGYWxzZSkKICAgIHRhYmxlX3R5cGVfZmlsdGVyID0gaGFzaE1hcC5nZXQoJ3RhYmxlX3R5cGVfZmlsdGVyJykgaWYgaGFzaE1hcC5nZXQoJ3RhYmxlX3R5cGVfZmlsdGVyJykgZWxzZSAnb3V0JwogICAgaWYgY3VycmVudF9jZWxsOgogICAgICAgIHBhcmFtcyA9IChpZF9kb2MsIHRhYmxlX3R5cGVfZmlsdGVyLCBjdXJyZW50X2NlbGwpCiAgICBlbHNlOgogICAgICAgIHBhcmFtcyA9IHsnaWRfZG9jJzppZF9kb2MsICd0YWJsZV90eXBlJzp0YWJsZV90eXBlX2ZpbHRlciwgJ0VtcHR5U3RyaW5nJzonJywgJ051bGxWYWx1ZSc6JzzQv9GD0YHRgtC+0LUg0LfQvdCw0YfQtdC90LjQtT4nfQoKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBwYXJhbXMsIFRydWUpCiAgICByb3dfZmlsdGVyID0gVHJ1ZSBpZiBoYXNoTWFwLmdldCgncm93c19maWx0ZXInKSA9PSAnMScgZWxzZSBGYWxzZQoKICAgIGlmIHJlc3VsdHM6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIHN0cihyZXN1bHRzWzBdWydpZF9kb2MnXSkpCiAgICAgICAgY3VycmVudF9jZWxsID0nJwogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICAgICAgaWYgcm93X2ZpbHRlciBhbmQgcmVjb3JkWydxdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIHBpYyA9ICcjZjAyYScgaWYgcmVjb3JkWydJc0RvbmUnXSAhPSAwIGVsc2UgJyNmMDBjJwogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSA9PSAwIGFuZCByZWNvcmRbJ3F0dHlfcGxhbiddID09IDA6CiAgICAgICAgICAgICAgICBwaWMgPSAnJwoKICAgICAgICAgICAgaWYgY3VycmVudF9jZWxsICE9IHJlY29yZFsnY2VsbF9uYW1lJ106CiAgICAgICAgICAgICAgICBjID0geyJncm91cCI6IHJlY29yZFsnY2VsbF9uYW1lJ119CiAgICAgICAgICAgICAgICAjZG9jX2RldGFpbF9saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQoYykKICAgICAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdC5jdXN0b21jYXJkc1snY2FyZHNkYXRhJ10uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICBjdXJyZW50X2NlbGwgPSByZWNvcmRbJ2NlbGxfbmFtZSddCgogICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIocmVjb3JkWydpZCddKSwKICAgICAgICAgICAgICAgICdnb29kX25hbWUnOiBzdHIocmVjb3JkWydnb29kX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IHN0cihyZWNvcmRbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaWRfcHJvcGVydGllcyc6IHN0cihyZWNvcmRbJ2lkX3Byb3BlcnRpZXMnXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllc19uYW1lJzogc3RyKHJlY29yZFsncHJvcGVydGllc19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHN0cihyZWNvcmRbJ2lkX3NlcmllcyddKSwKICAgICAgICAgICAgICAgICdzZXJpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Nlcmllc19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX3VuaXQnOiBzdHIocmVjb3JkWydpZF91bml0J10pLAogICAgICAgICAgICAgICAgJ3VuaXRzX25hbWUnOiBzdHIocmVjb3JkWyd1bml0c19uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2NvZGVfYXJ0JzogJ9Ca0L7QtDogJyArIHN0cihyZWNvcmRbJ2NvZGUnXSksCiAgICAgICAgICAgICAgICAnY2VsbF9uYW1lJzogc3RyKHJlY29yZFsnY2VsbF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2NlbGwnOiBzdHIocmVjb3JkWydpZF9jZWxsJ10pLAoKICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddIGlmIHJlY29yZFsncXR0eSddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAncXR0eV9wbGFuJzogc3RyKHJlY29yZFsncXR0eV9wbGFuJ10gaWYgcmVjb3JkWydxdHR5X3BsYW4nXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMKICAgICAgICAgICAgfQoKIyAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQogICAgICAgICAgICBkb2NfZGV0YWlsX2xpc3QuY3VzdG9tY2FyZHNbJ2NhcmRzZGF0YSddLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiwgaGF2ZV9xdHR5X3BsYW4g0JXRgdGC0YzQn9C70LDQvdCf0J7QmtCe0LvQuNGH0LXRgdGC0LLRgyAgLSAg0JjRgdGC0LjQvdCwINC60L7Qs9C00LAg0YHRg9C80LzQsCDQutC+0LvQvtC90LrQuCBRdHR5X3BsYW4gPiAwCiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAgaGF2ZV9tYXJrX3BsYW4gItCV0YHRgtGM0J/Qu9Cw0L3QmtCe0LTQvtCy0JzQsNGA0LrQuNGA0L7QstC60Lgg4oCTINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQvtC6INGC0LDQsdC7LiBSU19kb2NzX2JhcmNvZGVzINGBINC30LDQtNCw0L3QvdGL0LwgaWRfZG9jINC4IGlzX3BsYW4gINCx0L7Qu9GM0YjQtSDQvdGD0LvRjy4KICAgICAgICAjINCf0YDQuNC30L3QsNC6IGhhdmVfemVyb19wbGFuICLQldGB0YLRjCDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSIg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC10YHRgtGMINC30LDQv9C+0LvQvdC10L3QvdGL0LUg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQvtCyINCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgICMg0J/RgNC40LfQvdCw0LogItCa0L7QvdGC0YDQvtC70LjRgNC+0LLQsNGC0YwiICAtINC/0YDQuNC30L3QsNC6INC00LvRjyDQtNC+0LrRg9C80LXQvdGC0LAsINC90LDQtNC+INC70Lgg0LrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjAoKICAgICAgICBxdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfcXR0eV9zdHJpbmdfY291bnRfcXVlcnkoKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvY30pCiAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSByZXNbMF1bMF0gPiAwICAjINCSINC00L7QutGD0LzQtdC90YLQtSDQtdGB0YLRjCDRgdGC0YDQvtC60LgKICAgICAgICAgICAgaWYgaGF2ZV96ZXJvX3BsYW46CiAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHJlc1swXVsxXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINC60L7Qu9Cy0L4g0L/Qu9Cw0L0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAjINCV0YHRgtGMINC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0LvQsNC9INC/0L4g0LrQvtC00LDQvCDQvNCw0YDQutC40YDQvtCy0LrQuAogICAgICAgIHF0ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9oYXZlX21hcmtfY29kZXNfcXVlcnkoKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvYywgJ2lzX3BsYW4nOiAnMSd9KQogICAgICAgIGlmIG5vdCByZXM6CiAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSByZXNbMF1bMF0gPiAwCiAgICBlbHNlOgogICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICBoYXZlX3plcm9fcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgIGhhc2hNYXAucHV0KCdoYXZlX3F0dHlfcGxhbicsIHN0cihoYXZlX3F0dHlfcGxhbikpCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV96ZXJvX3BsYW4nLCBzdHIoaGF2ZV96ZXJvX3BsYW4pKQogICAgaGFzaE1hcC5wdXQoJ2hhdmVfbWFya19wbGFuJywgc3RyKGhhdmVfbWFya19wbGFuKSkKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdTRUxFQ1QgY29udHJvbCBmcm9tIFJTX2RvY3MgIFdIRVJFIGlkX2RvYyA9ID8nLCAoaWRfZG9jLCkpCiAgICAjINCV0YHRgtGMINC70Lgg0LrQvtC90YLRgNC+0LvRjCDQv9C70LDQvdCwINCyINC00L7QutGD0LzQtdC90YLQtQogICAgaWYgcmVzOgogICAgICAgIGlmIHJlc1swXVswXToKICAgICAgICAgICAgaWYgcmVzWzBdWzBdIGluIGZhbHNlVmFsdWVMaXN0OgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnVHJ1ZScKCiAgICAgICAgICAgICMgY29udHJvbCA9IHJlc1swXVswXSAjJ1RydWUnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKICAgIGVsc2U6CiAgICAgICAgY29udHJvbCA9ICdGYWxzZScKCiAgICBoYXNoTWFwLnB1dCgnY29udHJvbCcsIGNvbnRyb2wpCiAgICAjICAgIGhhc2hNYXAucHV0KCJkb2NfZ29vZHMiLCBqc29uLmR1bXBzKGRvY19kZXRhaWxfbGlzdCkpCiAgICBoYXNoTWFwLnB1dCgiZG9jX2dvb2RzIiwgZG9jX2RldGFpbF9saXN0LnRvX2pzb24oKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBkb2NfYWRyX2RldGFpbHNfbGlzdGVuZXIoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICMgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAjIGN1cnJlbnRfY2FyZF9saXN0ID0gaGFzaE1hcC5nZXQoImRvY19nb29kcyIpCiAgICAjIGpsID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddCiAgICAjIGlmIG5vdCBjdXJyZW50X2NhcmRfbGlzdCA9PSBOb25lOgogICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGN1cnJlbnRfY2FyZF9saXN0KQogICAgIyAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0ciktMV0KICAgICMgZWxzZToKICAgICMgICAgIGN1cnJlbnRfZWxlbSA9IE5vbmUKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kcyIpKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgIGhhc2hNYXAucHV0KCJEb2NfZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2RvY190eXBlJykgKyAnIOKElicgKyBoYXNoTWFwLmdldCgnZG9jX24nKSArCiAgICAgICAgICAgICAgICAgICAgJyDQvtGCJyArIGhhc2hNYXAuZ2V0KCdkb2NfZGF0ZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJjdXJyZW50X2NlbGxfbmFtZSIsICfQr9GH0LXQudC60LA6ICcgKyAgY3VycmVudF9lbGVtWydjZWxsX25hbWUnXSkKICAgICAgICBoYXNoTWFwLnB1dCgnaWRfY2VsbCcsIGN1cnJlbnRfZWxlbVsnaWRfY2VsbCddKQogICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgY3VycmVudF9lbGVtWydnb29kX25hbWUnXSkKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eV9wbGFuIiwgc3RyKGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10pKQogICAgICAgIGlmIG5vdCBjdXJyZW50X2VsZW1bJ3F0dHknXTogICMgb3IgZmxvYXQoY3VycmVudF9lbGVtWydxdHR5J10pID09IDA6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJxdHR5IiwgJycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgZmxvYXQoY3VycmVudF9lbGVtWydxdHR5J10pID09IDA6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsICcnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCBzdHIoY3VycmVudF9lbGVtWydxdHR5J10pKQogICAgICAgIGhhc2hNYXAucHV0KCdrZXknLCBjdXJyZW50X2VsZW1bJ2tleSddKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGAINCy0YvQsdC+0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVzIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dEaWFsb2ciLCAi0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpCgogICAgIyBlbGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJyBvciBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgY3VycmVudF9jZWxsID0gaGFzaE1hcC5nZXQoJ2N1cnJlbnRfY2VsbCcpCgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19hZHJfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdmbGRfYmFyY29kZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCgogICAgICAgIGRvY19jZWxsID0gZG9jLmZpbmRfY2VsbChkb2MsIGJhcmNvZGUpCiAgICAgICAgaWYgbm90IGN1cnJlbnRfY2VsbCBhbmQgbm90IGRvY19jZWxsOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYmVlcF9kdXJhdGlvbiAnLCByc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoImJlZXAiLCByc19zZXR0aW5ncy5nZXQoJ3NpZ25hbF9udW0nKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Cd0LUg0L3QsNC50LTQtdC90LAg0Y/Rh9C10LnQutCwJykKICAgICAgICAgICAgcmV0dXJuIGhhc2hNYXAKCiAgICAgICAgaWYgZG9jX2NlbGw6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdjdXJyZW50X2NlbGwnLCBkb2NfY2VsbFsnbmFtZSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsX2lkJywgZG9jX2NlbGxbJ2lkJ10pCiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgogICAgICAgIGhhdmVfcXR0eV9wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfcXR0eV9wbGFuJykKICAgICAgICBoYXZlX3plcm9fcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3plcm9fcGxhbicpCiAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV9tYXJrX3BsYW4nKQogICAgICAgIGNvbnRyb2wgPSBoYXNoTWFwLmdldCgnY29udHJvbCcpCiAgICAgICAgcmVzID0gZG9jLnByb2Nlc3NfdGhlX2JhcmNvZGUoZG9jLCBiYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBldmFsKGhhdmVfcXR0eV9wbGFuKSwgZXZhbChoYXZlX3plcm9fcGxhbiksIGV2YWwoY29udHJvbCksICBoYXNoTWFwLmdldCgnY3VycmVudF9jZWxsX2lkJykpCiAgICAgICAgaWYgcmVzID09IE5vbmU6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzY2FubmVkX2JhcmNvZGUnLCBiYXJjb2RlKQogICAgICAgICAgICAjIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcihUcnVlKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQntGI0LjQsdC60LAg0YHQutCw0L3QtdGA0LAnKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCd0b2FzdCcsCiAgICAgICAgICAgICMgICAgICAgICAgICAgJ9Co0YLRgNC40YUg0LrQvtC0INC90LUg0LfQsNGA0LXQs9C40YHRgtGA0LjRgNC+0LLQsNC9INCyINCx0LDQt9C1INC00LDQvdC90YvRhS4g0J/RgNC+0LLQtdGA0YzRgtC1INGC0L7QstCw0YAg0LjQu9C4INCy0YvQv9C+0LvQvdC40YLQtSDQvtCx0LzQtdC9INC00LDQvdC90YvQvNC4JykKICAgICAgICBlbGlmIHJlc1snRXJyb3InXToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JlZXBfZHVyYXRpb24gJywgcnNfc2V0dGluZ3MuZ2V0KCdiZWVwX2R1cmF0aW9uJykpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJiZWVwIiwgcnNfc2V0dGluZ3MuZ2V0KCdzaWduYWxfbnVtJykpCiAgICAgICAgICAgIGlmIHJlc1snRXJyb3InXSA9PSAnQWxyZWFkeVNjYW5uZWQnOgoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywganNvbi5kdW1wcyh7J2JhcmNvZGUnOiByZXNbJ0JhcmNvZGUnXSwgJ2RvY19pbmZvJzogcmVzWydkb2NfaW5mbyddfSkpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQo9C00LDQu9C10L3QuNC1INGI0YLRgNC40YXQutC+0LTQsCcpCiAgICAgICAgICAgIGVsaWYgcmVzWydFcnJvciddID09ICdRdWFudGl0eVBsYW5SZWFjaGVkJzoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHJlc1snRGVzY3InXSkKICAgICAgICAgICAgZWxpZiByZXNbJ0Vycm9yJ10gPT0gJ1plcm9fcGxhbl9lcnJvcic6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXNbJ0Rlc2NyJ10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXNbJ0Rlc2NyJ10gKSAgIysgJyAnKyByZXNbJ0JhcmNvZGUnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQotC+0LLQsNGAINC00L7QsdCw0LLQu9C10L0g0LIg0LTQvtC60YPQvNC10L3RgicpCiAgICAgICAgICAgICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19hZHJfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMSkKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfY2VsbF9pZCcpOgogICAgICAgICAgICBoYXNoTWFwLnJlbW92ZSgnY3VycmVudF9jZWxsJykKICAgICAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbF9pZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fY2xlYXJfY2VsbCc6CiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbCcpCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbF9pZCcpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NlbGVjdF9jZWxsJzogI9Ca0L3QvtC/0LrQsCDQstGL0LHRgNCw0YLRjCDRj9GH0LXQudC60YMKCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbCcpCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ2N1cnJlbnRfY2VsbF9pZCcpCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ1NlYXJjaFN0cmluZycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfY2VsbHMnKSAj0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9jZWxsX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsJ25hbWU7YmFyY29kZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0Jywn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBpZiBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsX2lkJyxoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfbmFtZScpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0nTGF5b3V0QWN0aW9uJzoKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgnbGF5b3V0X2xpc3RlbmVyJykKICAgICAgICAjINCd0LDRhdC+0LTQuNC8IElEINGB0YLRgNC+0LrQuAogICAgICAgICMgY3VycmVudF9zdHIgPSBpbnQoaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKSkKICAgICAgICAjIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiZG9jX2dvb2RzIikpCiAgICAgICAgIyBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11bY3VycmVudF9zdHJdCiAgICAgICAgIyBpZiBjdXJyZW50X2VsZW0uZ2V0KCdncm91cCcpOgogICAgICAgICMgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtjdXJyZW50X3N0cisxXQogICAgICAgICMKICAgICAgICBjdXJyZW50X2tleSA9IGhhc2hNYXAuZ2V0KCJrZXkiKQogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0Ywg0YHRgtGA0L7QutGDJzoKCiAgICAgICAgICAgIGlmIGN1cnJlbnRfa2V5OiAjY3VycmVudF9lbGVtWydrZXknXToKICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdERUxFVEUgRlJPTSBSU19hZHJfZG9jc190YWJsZSBXSEVSRSBpZCA9ID8nLCAoY3VycmVudF9rZXksICkpICNjdXJyZW50X2VsZW1bJ2tleSddLCkpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9CY0LfQvNC10L3QuNGC0Ywg0Y/Rh9C10LnQutGDJzoKCiAgICAgICAgICAgIGhhc2hNYXAucmVtb3ZlKCdTZWFyY2hTdHJpbmcnKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19jZWxscycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X2NlbGxfdmFsdWVfZm9yX2NhcmQnKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lO2JhcmNvZGUnKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlX2Zvcl9jYXJkJzoKICAgICAgICBjdXJyZW50X2tleSA9IGhhc2hNYXAuZ2V0KCJrZXkiKQogICAgICAgIGlmIGN1cnJlbnRfa2V5OgogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgnVXBkYXRlIFJTX2Fkcl9kb2NzX3RhYmxlIFNFVCBpZF9jZWxsID0gPyBXaGVyZSBpZCA9ID8nLCAoaGFzaE1hcC5nZXQoJ2N1cnJlbnRfaWQnKSwgY3VycmVudF9rZXkpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2FkZF9zdHJpbmcnOgoKICAgICAgICBoYXNoTWFwLnB1dCgiRG9jX2RhdGEiLAogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAuZ2V0KCdkb2NfdHlwZScpICsgJyDihJYnICsgaGFzaE1hcC5nZXQoJ2RvY19uJykgKwogICAgICAgICAgICAgICAgICAgICcg0L7RgicgKyBoYXNoTWFwLmdldCgnZG9jX2RhdGUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgiR29vZCIsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCJwcm9wZXJ0aWVzIiwgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInF0dHlfcGxhbiIsICcnKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGAIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgIGhhc2hNYXAucHV0KCdyb3dzX2ZpbHRlcicsICcxJykKICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb2ZmJzoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnZXRfY3VycmVudF9lbGVtX2RvY19nb29kcyhoYXNoTWFwLCBjdXJyZW50X3N0cik6CgogICAgaWYgaGFzaE1hcC5nZXQoJ3ZpZXcnKSA9PSAiY2FyZHMiOgogICAgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiZG9jX2dvb2RzX2NhcmRzIikpCiAgICAgICAgY2FyZHNfZGF0YSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQogICAgZWxzZToKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY19nb29kc190YWJsZSIpKQogICAgICAgIGNhcmRzX2RhdGEgPSBqbGlzdFsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ10KICAgIGZvciBlbGVtZW50IGluIGNhcmRzX2RhdGE6CiAgICAgICAgaWYgImtleSIgaW4gZWxlbWVudDoKICAgICAgICAgICAgaWYgZWxlbWVudFsia2V5Il0gPT0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5Iik6CiAgICAgICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBlbGVtZW50CiAgICByZXR1cm4gY3VycmVudF9lbGVtCgoKZGVmIGRvY3Nfb25fc2VsZWN0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImRvY0NhcmRzIikpCiAgICAgICAgY2FyZHNfZGF0YSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQogICAgICAgIGZvciBlbGVtZW50IGluIGNhcmRzX2RhdGE6CiAgICAgICAgICAgIGlmICJrZXkiIGluIGVsZW1lbnQ6CiAgICAgICAgICAgICAgICBpZiBlbGVtZW50WyJrZXkiXSA9PSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKToKICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2RvYyA9IGVsZW1lbnQKICAgICAgICAjIGN1cnJlbnRfZG9jID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0cildCgogICAgICAgICMgaWRfZG9jID0gY3VycmVudF9kb2NbJ2tleSddCiAgICAgICAgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIGN1cnJlbnRfZG9jWydrZXknXSkKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX3R5cGUnLCBjdXJyZW50X2RvY1sndHlwZSddKQogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfbicsIGN1cnJlbnRfZG9jWydudW1iZXInXSkKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCB1aV91dGlscy5mb3JtYXRfZG9jX2RhdGUoY3VycmVudF9kb2NbJ2RhdGEnXSkpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsIGN1cnJlbnRfZG9jWyd3YXJlaG91c2UnXSkKICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCBjdXJyZW50X2RvY1snY291bnRyYWdlbnQnXSkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImRvY190eXBlX2NsaWNrIjoKICAgICAgICBscyA9IHJlZmlsbF9kb2NzX2xpc3QoaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY0NhcmRzJywgbHMpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X2RvYyA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRfZGF0YSIpKQogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MKICAgICAgICBkb2MuaWRfZG9jID0gY3VycmVudF9kb2NbJ2tleSddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAnQ2hlY2tCb3gxJzoKICAgICAgICAgICAgaWYgY3VycmVudF9kb2NbJ2NvbXBsZXRlZCddID09ICdmYWxzZSc6CiAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDEpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDApCgogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQn9C+0LTRgtCy0LXRgNC00LjRgtGMJzoKICAgICAgICAgICAgZG9jLm1hcmtfdmVyaWZpZWQoZG9jLCAxKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBkb2MuY2xlYXJfYmFyY29kZV9kYXRhKGRvYykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CU0LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAg0Lgg0LzQsNGA0LrQuNGA0L7QstC60Lgg0L7Rh9C40YnQtdC90YsnKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQo9C00LDQu9C40YLRjCc6CiAgICAgICAgICAgIGRvYy5kZWxldGVfZG9jKGRvYykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KHQutCw0L3QuNGA0L7QstCw0YLRjCDRiNGC0YDQuNGF0LrQvtC00Ysg0L/QvtGC0L7QutC+0LwnOgoKICAgICAgICAgICAgIyBpZF9kb2MgPSBjdXJyZW50X2RvY1sna2V5J10KICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIGN1cnJlbnRfZG9jWydrZXknXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY190eXBlJywgY3VycmVudF9kb2NbJ3R5cGUnXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19uJywgY3VycmVudF9kb2NbJ251bWJlciddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCBjdXJyZW50X2RvY1snZGF0YSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnd2FyZWhvdXNlJywgY3VycmVudF9kb2NbJ3dhcmVob3VzZSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCBjdXJyZW50X2RvY1snY291bnRyYWdlbnQnXSkKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywn0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9hZGRfZG9jIjoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndC+0LLRi9C5INC00L7QutGD0LzQtdC90YInKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J/Qu9C40YLQutC4JykKICAgICAgICAjIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgICAgICMgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QvtCy0YvQuSDQtNC+0LrRg9C80LXQvdGCJykKICAgIHJldHVybiBoYXNoTWFwCgoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfbGlzdGVuZXIoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICMgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAjIGN1cnJlbnRfY2FyZF9saXN0ID0gaGFzaE1hcC5nZXQoImRvY19nb29kcyIpCiAgICAjIGpsID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddCiAgICAjIGlmIG5vdCBjdXJyZW50X2NhcmRfbGlzdCA9PSBOb25lOgogICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGN1cnJlbnRfY2FyZF9saXN0KQogICAgIyAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0ciktMV0KICAgICMgZWxzZToKICAgICMgICAgIGN1cnJlbnRfZWxlbSA9IE5vbmUKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBjdXJyZW50X2VsZW0gPSBnZXRfY3VycmVudF9lbGVtX2RvY19nb29kcyhoYXNoTWFwLCBjdXJyZW50X3N0cikKCiAgICAgICAgaWYgJ2dvb2RfbmFtZScgaW4gY3VycmVudF9lbGVtOiAgIyDQsiDRgtCw0LHQu9C40YbQtSDQv9C10YDQstCw0Y8g0LrQsNGA0YLQvtGH0LrQsCAtINC30LDQs9C+0LvQvtCy0L7QuiDRgtCw0LHQu9C40YbRiyDQsdC10Lcg0L/QvtC70LXQuQoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkRvY19kYXRhIiwKICAgICAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2RvY190eXBlJykgKyAnIOKElicgKyBoYXNoTWFwLmdldCgnZG9jX24nKSArCiAgICAgICAgICAgICAgICAgICAgICAgICcg0L7RgiAnICsgaGFzaE1hcC5nZXQoJ2RvY19kYXRlJykpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgY3VycmVudF9lbGVtWydnb29kX25hbWUnXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0Jywgc3RyKGN1cnJlbnRfZWxlbVsnYXJ0J10pKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZF9zbicsIHN0cihjdXJyZW50X2VsZW1bJ3Nlcmllc19uYW1lJ10pKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZF9wcm9wZXJ0eScsIHN0cihjdXJyZW50X2VsZW1bJ3Byb3BlcnRpZXNfbmFtZSddKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfcHJpY2UnLCBzdHIoY3VycmVudF9lbGVtWydwcmljZSddKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfdW5pdCcsIHN0cihjdXJyZW50X2VsZW1bJ3VuaXRzX25hbWUnXSkpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX3N0cicsIHN0cihjdXJyZW50X3N0cikgKyAiLyIgKyBoYXNoTWFwLmdldCgndGFibGVfbGluZXNfcXR0eScpKQoKICAgICAgICAgICAgZmlsbF9lbXB0eV92YWx1ZXMoaGFzaE1hcCwgeydnb29kX2FydCc6IHN0cihjdXJyZW50X2VsZW1bJ2FydCddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdnb29kX3NuJzogc3RyKGN1cnJlbnRfZWxlbVsnc2VyaWVzX25hbWUnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZ29vZF9wcm9wZXJ0eSc6IHN0cihjdXJyZW50X2VsZW1bJ3Byb3BlcnRpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdnb29kX3ByaWNlJzogc3RyKGN1cnJlbnRfZWxlbVsncHJpY2UnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZ29vZF9wbGFuJzogc3RyKGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10pfSwgdmFsdWU9ItC+0YLRgdGD0YLRgdGC0LLRg9C10YIiKQoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoInF0dHlfcGxhbiIsIHN0cihjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddKSkKICAgICAgICAgICAgaWYgbm90IGN1cnJlbnRfZWxlbVsncXR0eSddOiAgIyBvciBmbG9hdChjdXJyZW50X2VsZW1bJ3F0dHknXSkgPT0gMDoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCJxdHR5IiwgJycpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBmbG9hdChjdXJyZW50X2VsZW1bJ3F0dHknXSkgPT0gMDoKICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsICcnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsIHN0cihjdXJyZW50X2VsZW1bJ3F0dHknXSkpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdrZXknLCBjdXJyZW50X2VsZW1bJ2tleSddKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJpY2UnLCBjdXJyZW50X2VsZW1bJ3ByaWNlJ10pCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZV90eXBlJywgY3VycmVudF9lbGVtWydwcmljZV9uYW1lJ10pCiAgICAgICAgICAgICMg0KTQvtGA0LzQuNGA0YPQtdC8INGC0LDQsdC70LjRhtGDIFFSINC60L7QtNC+0LItLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgICAgICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jX2JhcmNvZGVfcXVlcnkoKQogICAgICAgICAgICBhcmdzID0gZGljdChpZF9nb29kPWN1cnJlbnRfZWxlbVsnaWRfZ29vZCddLCBpZF9wcm9wZXJ0eT1jdXJyZW50X2VsZW1bJ2lkX3Byb3BlcnRpZXMnXSwKICAgICAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzPWN1cnJlbnRfZWxlbVsnaWRfc2VyaWVzJ10sIGlkX3VuaXQ9Y3VycmVudF9lbGVtWydpZF91bml0J10sIGlkX2RvYz1oYXNoTWFwLmdldCgnaWRfZG9jJykpCgogICAgICAgICAgICBjYXJkcyA9IHVpX2Zvcm1fZGF0YS5nZXRfYmFyY29kZV9jYXJkKHJzX3NldHRpbmdzKQogICAgICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzLCBUcnVlKQogICAgICAgICAgICAjINCk0L7RgNC80LjRgNGD0LXQvCDRgdC/0LjRgdC+0Log0LrQsNGA0YLQvtGH0LXQuiDQsdCw0YDQutC+0LTQvtCyCiAgICAgICAgICAgIGNhcmRzWydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXSA9IFtdCiAgICAgICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgICAgICAjIGJhcmNvZGVfZGF0YSA9IHVpX2JhcmNvZGVzLmdldF9ndGluX3NlcmlhbF9mcm9tX2RhdGFtYXRyaXgoZWxbJ2JhcmNvZGUnXSkKICAgICAgICAgICAgICAgIGlmIGVsWydhcHByb3ZlZCddID09ICdUcnVlJyBvciBlbFsnYXBwcm92ZWQnXSA9PSAnMScgb3IgZWxbJ2FwcHJvdmVkJ10gPT0gJ3RydWUnOgogICAgICAgICAgICAgICAgICAgIHBpY3R1cmUgPSAnI2YwMGMnCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHBpY3R1cmUgPSAnJwogICAgICAgICAgICAgICAgcm93ID0gewogICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogZWxbJ21hcmtfY29kZSddLAogICAgICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljdHVyZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddLmFwcGVuZChyb3cpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJiYXJjb2RlX2NhcmRzIiwganNvbi5kdW1wcyhjYXJkcykpCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGAINCy0YvQsdC+0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9hZGRfc3RyaW5nJzoKCiAgICAgICAgaGFzaE1hcC5wdXQoIkRvY19kYXRhIiwKICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnZG9jX3R5cGUnKSArICcg4oSWJyArIGhhc2hNYXAuZ2V0KCdkb2NfbicpICsKICAgICAgICAgICAgICAgICAgICAnINC+0YIgJyArIGhhc2hNYXAuZ2V0KCdkb2NfZGF0ZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJHb29kIiwgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnRpZXMiLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eV9wbGFuIiwgJycpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YAiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVzIjoKICAgICAgICBoYXNoTWFwLnNob3dfZGlhbG9nKCfQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0JykKCiAgICBlbGlmIGxpc3RlbmVyID09ICdjb25maXJtX3ZlcmlmaWVkJyBhbmQgaGFzaE1hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MoKQogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBkb2MubWFya192ZXJpZmllZCgxKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZScgb3IgKGxpc3RlbmVyID09ICfQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0JyBhbmQgaGFzaE1hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiKToKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdmbGRfYmFyY29kZScpCiAgICAgICAgICAgIGlmIG5vdCBiYXJjb2RlLnN0cmlwKCk6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd0RpYWxvZyIsICLQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0IikKICAgICAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCgogICAgICAgIGhhdmVfcXR0eV9wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfcXR0eV9wbGFuJykKICAgICAgICBoYXZlX3plcm9fcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3plcm9fcGxhbicpCiAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV9tYXJrX3BsYW4nKQogICAgICAgIGNvbnRyb2wgPSBoYXNoTWFwLmdldCgnY29udHJvbCcpCgogICAgICAgIHJlcyA9IGRvYy5wcm9jZXNzX3RoZV9iYXJjb2RlKAogICAgICAgICAgICBkb2MsCiAgICAgICAgICAgIGJhcmNvZGUsCiAgICAgICAgICAgIGV2YWwoaGF2ZV9xdHR5X3BsYW4pLAogICAgICAgICAgICBldmFsKGhhdmVfemVyb19wbGFuKSwKICAgICAgICAgICAgZXZhbChjb250cm9sKSwKICAgICAgICAgICAgZXZhbChoYXZlX21hcmtfcGxhbiksCiAgICAgICAgICAgIHJzX3NldHRpbmdzLmdldCgndXNlX21hcmsnKSwKICAgICAgICAgICAgdXNlcl90bXo9aW50KGhhc2hNYXAuZ2V0KCJUTVoiKSkKICAgICAgICApCiAgICAgICAgaWYgcmVzIGlzIE5vbmU6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzY2FubmVkX2JhcmNvZGUnLCBiYXJjb2RlKQogICAgICAgICAgICAjIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcihUcnVlKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQntGI0LjQsdC60LAg0YHQutCw0L3QtdGA0LAnKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCd0b2FzdCcsCiAgICAgICAgICAgICMgICAgICAgICAgICAgJ9Co0YLRgNC40YUg0LrQvtC0INC90LUg0LfQsNGA0LXQs9C40YHRgtGA0LjRgNC+0LLQsNC9INCyINCx0LDQt9C1INC00LDQvdC90YvRhS4g0J/RgNC+0LLQtdGA0YzRgtC1INGC0L7QstCw0YAg0LjQu9C4INCy0YvQv9C+0LvQvdC40YLQtSDQvtCx0LzQtdC9INC00LDQvdC90YvQvNC4JykKICAgICAgICBlbGlmIHJlc1snRXJyb3InXToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JlZXBfZHVyYXRpb24gJywgcnNfc2V0dGluZ3MuZ2V0KCdiZWVwX2R1cmF0aW9uJykpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJiZWVwIiwgcnNfc2V0dGluZ3MuZ2V0KCdzaWduYWxfbnVtJykpCiAgICAgICAgICAgIGlmIHJlc1snRXJyb3InXSA9PSAnQWxyZWFkeVNjYW5uZWQnOgoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywganNvbi5kdW1wcyh7J2JhcmNvZGUnOiByZXNbJ0JhcmNvZGUnXSwgJ2RvY19pbmZvJzogcmVzWydkb2NfaW5mbyddfSkpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQo9C00LDQu9C10L3QuNC1INGI0YLRgNC40YXQutC+0LTQsCcpCiAgICAgICAgICAgIGVsaWYgcmVzWydFcnJvciddID09ICdRdWFudGl0eVBsYW5SZWFjaGVkJzoKCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXNbJ0Rlc2NyJ10pCiAgICAgICAgICAgIGVsaWYgcmVzWydFcnJvciddID09ICdaZXJvX3BsYW5fZXJyb3InOgoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHJlc1snRGVzY3InXSkKICAgICAgICAgICAgZWxzZToKCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCByZXNbJ0Rlc2NyJ10gKSAgIysgJyAnKyByZXNbJ0JhcmNvZGUnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhpZ2hsaWdodF9hZGRlZF9nb29kKGhhc2hNYXAsIGJhcmNvZGUpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQotC+0LLQsNGAINC00L7QsdCw0LLQu9C10L0g0LIg0LTQvtC60YPQvNC10L3RgicpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlX3NjYW5uZWQnLCAndHJ1ZScpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICBoYXNoTWFwLnNob3dfZGlhbG9nKCdjb25maXJtX3ZlcmlmaWVkJywgJ9CX0LDQstC10YDRiNC40YLRjCDQtNC+0LrRg9C80LXQvdGCPycsIFsn0JTQsCcsICfQndC10YInXSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0Ywg0YHRgtGA0L7QutGDJzoKICAgICAgICAgICAgY3VycmVudF9lbGVtID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiY2FyZF9kYXRhIikpCiAgICAgICAgICAgIGlkX3N0ciA9IGN1cnJlbnRfZWxlbVsna2V5J10KICAgICAgICAgICAgcXRleHQgPSAnREVMRVRFIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZD0/JwogICAgICAgICAgICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGlkX3N0ciwpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29uJzoKICAgICAgICBoYXNoTWFwLnB1dCgncm93c19maWx0ZXInLCAnMScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1JlZnJlc2hTY3JlZW4nLCcnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29mZic6CiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ3Jvd3NfZmlsdGVyJykKICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdjYXJkX3ZpZXcnOgogICAgICAgIGhhc2hNYXAucHV0KCd2aWV3JywgJ2NhcmRzJykKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2dvb2RzX3RhYmxlJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfY2FyZF92aWV3IiwgIi0xIikKICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAndGFibGVfdmlldyc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3ZpZXcnLCAndGFibGUnKQogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfZ29vZHNfY2FyZHMnLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd190YWJsZV92aWV3IiwgIi0xIikKICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRlbGV0ZV9iYXJjb2RlX3NjcmVlbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAjINCd0LDRhdC+0LTQuNC8IElEINC00L7QutGD0LzQtdC90YLQsAogICAgYmFyY29kZV9kYXRhID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnYmFyY29kZScpKVsnYmFyY29kZSddCiAgICAjINCd0LDQudC00LXQvCDQvdGD0LbQvdGL0LUg0L/QvtC70Y8g0LfQsNC/0YDQvtGB0L7QvCDQuiDQsdCw0LfQtQogICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X21hcmtjb2RlX3F1ZXJ5KCkKICAgIGFyZ3MgPSB7J2lkX2RvYyc6IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgJ0dUSU4nOiBiYXJjb2RlX2RhdGFbJ0dUSU4nXSwgJ1Nlcmllcyc6IGJhcmNvZGVfZGF0YVsnU0VSSUFMJ119CgogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIGFyZ3MsIFRydWUpCgogICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRTdHInLCBqc29uLmR1bXBzKHJlc1swXSkpCiAgICBoYXNoTWFwLnB1dCgiQ3VyU3RyIiwgc3RyKHJlc1swXVsnQ3VyU3RyJ10pKQogICAgaGFzaE1hcC5wdXQoImdvb2QiLCByZXNbMF1bJ2dvb2RfbmFtZSddKQogICAgaGFzaE1hcC5wdXQoIidjb2RlX2FydCciLCByZXNbMF1bJ2dvb2RfY29kZSddKQogICAgaGFzaE1hcC5wdXQoInVuaXRfbmFtZSIsIHN0cihyZXNbMF1bJ3VuaXQnXSkpCiAgICBoYXNoTWFwLnB1dCgnYmFyY29kZV92YWx1ZScsICcwMScgKyBiYXJjb2RlX2RhdGFbJ0dUSU4nXSArICcyMScgKyBiYXJjb2RlX2RhdGFbJ1NFUklBTCddKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGRlbGV0ZV9iYXJjb2RlX3NjcmVlbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCiAgICBpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVfY2FuY2VsIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9iYXJjb2RlX2RlbGV0ZSI6CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICBjdXJyZW50X2JhcmNvZGVfc3RyID0gaW50KGhhc2hNYXAuZ2V0KCJDdXJTdHIiKSkKICAgICAgICBlbCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoJ2N1cnJlbnRTdHInKSkKCiAgICAgICAgIyBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyBkb2MucXR0eSA9IGZsb2F0KGhhc2hNYXAuZ2V0KCdxdHR5JykpCiAgICAgICAgIyBkb2MudXBkYXRlX2RvY19zdHIoZG9jLCBoYXNoTWFwLmdldCgncHJpY2UnKSkKICAgICAgICBxdWVyeV90ZXh0ID0gJ1VwZGF0ZSAgUlNfZG9jc19iYXJjb2RlcyBTRVQgYXBwcm92ZWQ9PyBXaGVyZSBpZD0/JwogICAgICAgIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsICgnMCcsIGN1cnJlbnRfYmFyY29kZV9zdHIpKQogICAgICAgIGRvYy51cGRhdGVfZG9jX3RhYmxlX2RhdGEoZG9jLCBlbCwgLTEpCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ21tX2xvY2FsJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKZGVmIGVsZW1fb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ21tX2xvY2FsJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBhZHJfZWxlbV9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgoKICAgIGlmIGxpc3RlbmVyID09ICJidG5fb2siOgogICAgICAgICMgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgIyBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfYWRyX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICAjIGlmIG5vdCBjdXJyZW50X3N0ciA9PSAnMCc6CiAgICAgICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKSkKICAgICAgICAjICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAjICAgICBrZXkgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjICAgICBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyAuLi4g0Lgg0LfQsNC/0LjRiNC10Lwg0LXQtSDQsiDQsdCw0LfRgwogICAgICAgIHF0dHkgPSBoYXNoTWFwLmdldCgncXR0eScpCiAgICAgICAgZG9jLnF0dHkgPSBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMAogICAgICAgIGVsZW1fZm9yX2FkZCA9eydpZF9nb29kJzpoYXNoTWFwLmdldCgnR29vZF9pZCcpLCAnaWRfcHJvcGVydHknOmhhc2hNYXAuZ2V0KCdwcm9wZXJ0aWVzX2lkJyksICdpZF9zZXJpZXMnOmhhc2hNYXAuZ2V0KCdzZXJpZXNfaWQnKSwgJ2lkX3VuaXQnOiBoYXNoTWFwLmdldCgndW5pdF9pZCcpfQoKICAgICAgICBkb2MudXBkYXRlX2RvY190YWJsZV9kYXRhKGRvYywgZWxlbV9mb3JfYWRkLCBxdHR5LCBoYXNoTWFwLmdldCgnY3VycmVudF9jZWxsX25hbWUnKSxoYXNoTWFwLmdldCgndGFibGVfdHlwZV9maWx0ZXInKSkgIyhkb2MsICkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9jYW5jZWwiOgoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiIjoKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsIHN0cihmbG9hdChoYXNoTWFwLmdldCgncXR0eScpKSkpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fZ29vZF9zZWxlY3QiOgogICAgICAgIGhhc2hNYXAucmVtb3ZlKCdTZWFyY2hTdHJpbmcnKQogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX2dvb2RzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9nb29kc192YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTthcnQnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAjLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gInNlbGVjdF9nb29kc192YWx1ZSI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2QnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2RfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgICAgICMg0J/RgNC4INCy0YvQsdC+0YDQtSDRgtC+0LLQsNGA0LAg0LfQsNC/0L7Qu9C90LjQvCDQtdC00LjQvdC40YbRgyDQuNC30LzQtdGA0LXQvdC40Y8g0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4KICAgICAgICBxdGV4dCA9ICcnJ1NlbGVjdCBSU19nb29kcy51bml0IGFzIHVuaXRfaWQsIAogICAgICAgICAgICAgICAgICAgIFJTX3VuaXRzLm5hbWUgCiAgICAgICAgICAgICAgICAgICAgRnJvbSBSU19nb29kcwogICAgICAgICAgICAgICAgICAgICAgTGVmdCBKb2luIFJTX3VuaXRzIG9uIFJTX3VuaXRzLmlkX293bmVyID0gUlNfZ29vZHMuaWQgYW5kIFJTX3VuaXRzLmlkID0gUlNfZ29vZHMudW5pdCAKICAgICAgICAgICAgICAgICAgICBXSEVSRSBSU19nb29kcy5pZCA9ID8nJycKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJyksKSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd1bml0X2lkJywgcmVzWzBdWzBdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgndW5pdCcsIHJlc1swXVsxXSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fcHJvcGVydGllcyI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1NlYXJjaFN0cmluZycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfcHJvcGVydGllcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfcHJvcGVydGllc192YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTtpZF9vd25lcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICMgLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9wcm9wZXJ0aWVzX3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydGllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydGllc19pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3NlcmllcyI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfc2VyaWVzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9zZXJpZXNfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7IGlkX293bmVyJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgICAgICNfXwogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Nlcmllc192YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlcmllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgnc2VyaWVzX2lkJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfaWQnKSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fdW5pdCI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1NlYXJjaFN0cmluZycsIGhhc2hNYXAuZ2V0KCdHb29kX2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfdW5pdHMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X3VuaXRfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7aWRfb3duZXInKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAgICAgI19fCiAgICBlbGlmIGxpc3RlbmVyID09ICdzZWxlY3RfdW5pdF92YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXRfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgI2J0bl9zZWxlY3RfY2VsbAogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3NlbGVjdF9jZWxsIjoKICAgICAgICBoYXNoTWFwLnB1dCgnU2VhcmNoU3RyaW5nJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfY2VsbHMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X2NlbGxfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7YmFyY29kZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICAgICAjX18KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9jZWxsX25hbWUnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfY2VsbF9pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAicGhvdG8iOgoKICAgICAgICAjINCc0L7QttC90L4g0LLQvtC+0LHRidC1INGN0YLQvtCz0L4g0L3QtSDQtNC10LvQsNGC0Ywt0L7RgdGC0LDQstC70Y/RgtGMINC60LDQuiDQtdGB0YLRjC4g0K3RgtC+INC00LvRjyDQv9GA0LjQvNC10YDQsC4KICAgICAgICBpbWFnZV9maWxlID0gc3RyKAogICAgICAgICAgICBoYXNoTWFwLmdldCgicGhvdG9fcGF0aCIpKSAgIyAi0L/QtdGA0LXQvNC10L3QvdCw0Y8iKyJfcGF0aCIgLSDRgdGO0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDQv9GD0YLRjCDQuiDQv9C+0LvRg9GH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuAoKICAgICAgICBpbWFnZSA9IEltYWdlLm9wZW4oaW1hZ2VfZmlsZSkKCiAgICAgICAgIyDRgdGA0LDQt9GDINGB0LTQtdC70LDQtdC8INGE0L7RgtC60YMgLSDQutCy0LDQtNGA0LDRgtC90L7QuSAtINGN0YLQviDQv9GA0L7RgdGC0L7QuSDQstCw0YDQuNCw0L3Rgi4g0JzQvtC20L3QviDRgdC00LXQu9Cw0YLRjCDQvdCw0L/RgNC40LzQtdGAINC+0YLQtNC10LvRjNC+INC80LjQvdC40LDRgtGO0YDRiyDQtNC70Y8g0YHQv9C40YHQutCwLCDRjdGC0L4g0L3QtdC80L3QvtCz0L4g0YHQu9C+0LbQvdC10LUKICAgICAgICBpbSA9IGltYWdlLnJlc2l6ZSgoNTAwLCA1MDApKQogICAgICAgIGltLnNhdmUoaW1hZ2VfZmlsZSkKCiAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsanNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImdhbGxlcnlfY2hhbmdlIjogICMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC80L7QttC10YIg0YPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuC4g0J3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0L3QsNC00L4g0L/QvtC80LXRgdGC0LjRgtGMINC6INC00L7QutGD0LzQtdC90YLRgwoKICAgICAgICBpZiBoYXNoTWFwLmNvbnRhaW5zS2V5KCJwaG90b0dhbGxlcnkiKTogICMg0Y3RgtC4IDIg0L7QsdGA0LDQsdC+0YLRh9C40LrQsCAtINCw0L3QsNC70L7Qs9C40YfQvdGL0LUsINC/0YDQvtGB0YLQviDQtNC70Y8g0YDQsNC30L3Ri9GFINGB0L7QsdGL0YLQuNC5CiAgICAgICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsIiMyIitqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZWxlbV9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgI9CV0YHQu9C4INGB0YLRgNC+0LrQsCDQvdC1INGB0YPRidC10YHRgtCy0YPQtdGCLCDRgdC+0LfQtNCw0LTQuNC8INC10LUKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgICMgaWYgY3VycmVudF9zdHIgPT0nMCc6CiAgICAgICAgIyAgICAgcGFzcwogICAgICAgICMgICAgICNqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgamxpc3QgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJkb2NfZ29vZHMiKSkKICAgICAgICAjICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAjICAgICBrZXkgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjICAgICBkb2MuaWRfc3RyID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgIyAuLi4g0Lgg0LfQsNC/0LjRiNC10Lwg0LXQtSDQsiDQsdCw0LfRgwoKICAgICAgICBxdHR5ID0gaGFzaE1hcC5nZXQoJ3F0dHknKQogICAgICAgIGRvYy5xdHR5ID0gZmxvYXQocXR0eSkgaWYgcXR0eSBlbHNlIDAKICAgICAgICBlbGVtX2Zvcl9hZGQgPSB7J2lkX2dvb2QnOiBoYXNoTWFwLmdldCgnR29vZF9pZCcpLCAnaWRfcHJvcGVydHknOiBoYXNoTWFwLmdldCgncHJvcGVydGllc19pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogaGFzaE1hcC5nZXQoJ3Nlcmllc19pZCcpLCdpZF91bml0JzogaGFzaE1hcC5nZXQoJ3VuaXRfaWQnKX0KICAgICAgICBkb2MudXBkYXRlX2RvY190YWJsZV9kYXRhKGRvYywgZWxlbV9mb3JfYWRkLCBxdHR5KSAgIyAoZG9jLCApCgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJidG5fY2FuY2VsIjoKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiQkFDS19CVVRUT04iOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0gIiI6CiAgICAgICAgaGFzaE1hcC5wdXQoInF0dHkiLCBzdHIoZmxvYXQoaGFzaE1hcC5nZXQoJ3F0dHknKSkpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2dvb2Rfc2VsZWN0IjoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgnU2VhcmNoU3RyaW5nJykKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19nb29kcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfZ29vZHNfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICAjLS0KICAgIGVsaWYgbGlzdGVuZXIgPT0gInNlbGVjdF9nb29kc192YWx1ZSI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2QnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ0dvb2RfaWQnLCBoYXNoTWFwLmdldCgnY3VycmVudF9pZCcpKQogICAgICAgICPQn9GA0Lgg0LLRi9Cx0L7RgNC1INGC0L7QstCw0YDQsCDQt9Cw0L/QvtC70L3QuNC8INC10LTQuNC90LjRhtGDINC40LfQvNC10YDQtdC90LjRjyDQv9C+INGD0LzQvtC70YfQsNC90LjRjgogICAgICAgIHF0ZXh0ID0gJycnU2VsZWN0IFJTX2dvb2RzLnVuaXQgYXMgdW5pdF9pZCwgCiAgICAgICAgICAgICAgICAgICAgUlNfdW5pdHMubmFtZSAKICAgICAgICAgICAgICAgICAgICBGcm9tIFJTX2dvb2RzCiAgICAgICAgICAgICAgICAgICAgICBMZWZ0IEpvaW4gUlNfdW5pdHMgb24gUlNfdW5pdHMuaWRfb3duZXIgPSBSU19nb29kcy5pZCBhbmQgUlNfdW5pdHMuaWQgPSBSU19nb29kcy51bml0IAogICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2dvb2RzLmlkID0gPycnJwogICAgICAgIHJlcyA9ICB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJyksKSkKICAgICAgICBpZiByZXM6CgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndW5pdF9pZCcsIHJlc1swXVswXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3VuaXQnLCByZXNbMF1bMV0pCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX3Byb3BlcnRpZXMiOgoKICAgICAgICBoYXNoTWFwLnB1dCgnU2VhcmNoU3RyaW5nJywgaGFzaE1hcC5nZXQoJ0dvb2RfaWQnKSkKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19wcm9wZXJ0aWVzJykgICMg0KLQsNCx0LvQuNGG0LAg0LTQu9GPINCy0YvQsdC+0YDQsCDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ3NlbGVjdF9wcm9wZXJ0aWVzX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lO2lkX293bmVyJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgIyAtLQogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Byb3BlcnRpZXNfdmFsdWUnOgogICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0aWVzJywgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfbmFtZScpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9zZXJpZXMiOgogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX3NlcmllcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3Rfc2VyaWVzX3ZhbHVlJykKICAgICAgICBoYXNoTWFwLnB1dCgnZmlsdGVyX2ZpZWxkcycsICduYW1lJykKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCAn0KPQvdC40LLQtdGA0YHQsNC70YzQvdGL0Lkg0YHQv9GA0LDQstC+0YfQvdC40Lp80KHQv9GA0LDQstC+0YfQvdC40LonKQogICAgICAgICNfXwogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X3Nlcmllc192YWx1ZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlcmllcycsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl91bml0IjoKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU191bml0cycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfdW5pdF92YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZTtpZF9vd25lcicpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgICAgICAjX18KICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF91bml0X3ZhbHVlJzoKICAgICAgICBoYXNoTWFwLnB1dCgndW5pdCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgndW5pdF9pZCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X2lkJykpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAicGhvdG8iOgoKICAgICAgICAjINCc0L7QttC90L4g0LLQvtC+0LHRidC1INGN0YLQvtCz0L4g0L3QtSDQtNC10LvQsNGC0Ywt0L7RgdGC0LDQstC70Y/RgtGMINC60LDQuiDQtdGB0YLRjC4g0K3RgtC+INC00LvRjyDQv9GA0LjQvNC10YDQsC4KICAgICAgICBpbWFnZV9maWxlID0gc3RyKAogICAgICAgICAgICBoYXNoTWFwLmdldCgicGhvdG9fcGF0aCIpKSAgIyAi0L/QtdGA0LXQvNC10L3QvdCw0Y8iKyJfcGF0aCIgLSDRgdGO0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDQv9GD0YLRjCDQuiDQv9C+0LvRg9GH0LXQvdC90L7QuSDRhNC+0YLQvtCz0YDQsNGE0LjQuAoKICAgICAgICBpbWFnZSA9IEltYWdlLm9wZW4oaW1hZ2VfZmlsZSkKCiAgICAgICAgIyDRgdGA0LDQt9GDINGB0LTQtdC70LDQtdC8INGE0L7RgtC60YMgLSDQutCy0LDQtNGA0LDRgtC90L7QuSAtINGN0YLQviDQv9GA0L7RgdGC0L7QuSDQstCw0YDQuNCw0L3Rgi4g0JzQvtC20L3QviDRgdC00LXQu9Cw0YLRjCDQvdCw0L/RgNC40LzQtdGAINC+0YLQtNC10LvRjNC+INC80LjQvdC40LDRgtGO0YDRiyDQtNC70Y8g0YHQv9C40YHQutCwLCDRjdGC0L4g0L3QtdC80L3QvtCz0L4g0YHQu9C+0LbQvdC10LUKICAgICAgICBpbSA9IGltYWdlLnJlc2l6ZSgoNTAwLCA1MDApKQogICAgICAgIGltLnNhdmUoaW1hZ2VfZmlsZSkKCiAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgaGFzaE1hcC5wdXQoInBob3RvR2FsbGVyeSIsIGpzb24uZHVtcHMoanBob3RvYXJyKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsanNvbi5kdW1wcyhqcGhvdG9hcnIpKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImdhbGxlcnlfY2hhbmdlIjogICMg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC80L7QttC10YIg0YPQtNCw0LvQuNGC0Ywg0YTQvtGC0L4g0LjQtyDQs9Cw0LvQtdGA0LXQuC4g0J3QvtCy0YvQuSDQvNCw0YHRgdC40LIg0L3QsNC00L4g0L/QvtC80LXRgdGC0LjRgtGMINC6INC00L7QutGD0LzQtdC90YLRgwoKICAgICAgICBpZiBoYXNoTWFwLmNvbnRhaW5zS2V5KCJwaG90b0dhbGxlcnkiKTogICMg0Y3RgtC4IDIg0L7QsdGA0LDQsdC+0YLRh9C40LrQsCAtINCw0L3QsNC70L7Qs9C40YfQvdGL0LUsINC/0YDQvtGB0YLQviDQtNC70Y8g0YDQsNC30L3Ri9GFINGB0L7QsdGL0YLQuNC5CiAgICAgICAgICAgIGpwaG90b2FyciA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoInBob3RvR2FsbGVyeSIpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCJ0b2FzdCIsIiMyIitqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fdmlldl9vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBoYXNoTWFwLnB1dCgnbW1fbG9jYWwnLCAnJykKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgZWxlbV92aWV2X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGhhc2hNYXAucHV0KCdtbV9sb2NhbCcsICcnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYWRyX2VsZW1fdmlldl9vbl9jbGljayhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgIyDQv9C+0LvRg9GH0LjQvCDRgtC10LrRg9GJ0YPRjiDRgdGC0YDQvtC60YMg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9zdHIgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2Fkcl9kb2MKICAgICAgICBpZiBub3QgY3VycmVudF9zdHIgPT0gJzAnOgogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBnZXRfY3VycmVudF9lbGVtX2RvY19nb29kcyhoYXNoTWFwLCBjdXJyZW50X3N0cikKICAgICAgICAgICAga2V5ID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgICAgIGRvYy5pZF9zdHIgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjIC4uLiDQuCDQt9Cw0L/QuNGI0LXQvCDQtdC1INCyINCx0LDQt9GDCiAgICAgICAgcXR0eSA9IGhhc2hNYXAuZ2V0KCdxdHR5JykKICAgICAgICBkb2MucXR0eSA9IGZsb2F0KHF0dHkpIGlmIHF0dHkgZWxzZSAwCgogICAgICAgIGRvYy51cGRhdGVfZG9jX3N0cihkb2MpICMoZG9jLCApCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9jYW5jZWwiOgoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiIjoKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsIHN0cihmbG9hdChoYXNoTWFwLmdldCgncXR0eScpKSkpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJwaG90byI6CgogICAgICAgICMg0JzQvtC20L3QviDQstC+0L7QsdGJ0LUg0Y3RgtC+0LPQviDQvdC1INC00LXQu9Cw0YLRjC3QvtGB0YLQsNCy0LvRj9GC0Ywg0LrQsNC6INC10YHRgtGMLiDQrdGC0L4g0LTQu9GPINC/0YDQuNC80LXRgNCwLgogICAgICAgIGltYWdlX2ZpbGUgPSBzdHIoCiAgICAgICAgICAgIGhhc2hNYXAuZ2V0KCJwaG90b19wYXRoIikpICAjICLQv9C10YDQtdC80LXQvdC90LDRjyIrIl9wYXRoIiAtINGB0Y7QtNCwINC/0L7QvNC10YnQsNC10YLRgdGPINC/0YPRgtGMINC6INC/0L7Qu9GD0YfQtdC90L3QvtC5INGE0L7RgtC+0LPRgNCw0YTQuNC4CgogICAgICAgIGltYWdlID0gSW1hZ2Uub3BlbihpbWFnZV9maWxlKQoKICAgICAgICAjINGB0YDQsNC30YMg0YHQtNC10LvQsNC10Lwg0YTQvtGC0LrRgyAtINC60LLQsNC00YDQsNGC0L3QvtC5IC0g0Y3RgtC+INC/0YDQvtGB0YLQvtC5INCy0LDRgNC40LDQvdGCLiDQnNC+0LbQvdC+INGB0LTQtdC70LDRgtGMINC90LDQv9GA0LjQvNC10YAg0L7RgtC00LXQu9GM0L4g0LzQuNC90LjQsNGC0Y7RgNGLINC00LvRjyDRgdC/0LjRgdC60LAsINGN0YLQviDQvdC10LzQvdC+0LPQviDRgdC70L7QttC90LXQtQogICAgICAgIGltID0gaW1hZ2UucmVzaXplKCg1MDAsIDUwMCkpCiAgICAgICAgaW0uc2F2ZShpbWFnZV9maWxlKQoKICAgICAgICBqcGhvdG9hcnIgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJwaG90b0dhbGxlcnkiKSkKICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICMgaGFzaE1hcC5wdXQoInRvYXN0Iixqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiZ2FsbGVyeV9jaGFuZ2UiOiAgIyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0LzQvtC20LXRgiDRg9C00LDQu9C40YLRjCDRhNC+0YLQviDQuNC3INCz0LDQu9C10YDQtdC4LiDQndC+0LLRi9C5INC80LDRgdGB0LjQsiDQvdCw0LTQviDQv9C+0LzQtdGB0YLQuNGC0Ywg0Log0LTQvtC60YPQvNC10L3RgtGDCgogICAgICAgIGlmIGhhc2hNYXAuY29udGFpbnNLZXkoInBob3RvR2FsbGVyeSIpOiAgIyDRjdGC0LggMiDQvtCx0YDQsNCx0L7RgtGH0LjQutCwIC0g0LDQvdCw0LvQvtCz0LjRh9C90YvQtSwg0L/RgNC+0YHRgtC+INC00LvRjyDRgNCw0LfQvdGL0YUg0YHQvtCx0YvRgtC40LkKICAgICAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJwaG90b0dhbGxlcnkiLCBqc29uLmR1bXBzKGpwaG90b2FycikpCiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoInRvYXN0IiwiIzIiK2pzb24uZHVtcHMoanBob3RvYXJyKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBlbGVtX3ZpZXZfb25fY2xpY2soaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgIGlmIGxpc3RlbmVyID09ICJidG5fb2siOgogICAgICAgICMg0L/QvtC70YPRh9C40Lwg0YLQtdC60YPRidGD0Y4g0YHRgtGA0L7QutGDINC00L7QutGD0LzQtdC90YLQsAogICAgICAgIGN1cnJlbnRfc3RyID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKQogICAgICAgICPQldGB0LvQuCDRgdGC0YDQvtC60LAg0L3QtSDRgdGD0YnQtdGB0YLQstGD0LXRgiwg0YHQvtC30LTQsNC00LjQvCDQtdC1CiAgICAgICAgZG9jID0gdWlfZ2xvYmFsLlJzX2RvYwogICAgICAgIGRvYy5pZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgICAgICAjIGlmIGN1cnJlbnRfc3RyID09JzAnOgogICAgICAgICMgICAgIHBhc3MKICAgICAgICAgICAgI2psaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQogICAgICAgICNlbHNlOgogICAgICAgIGN1cnJlbnRfZWxlbSA9IGdldF9jdXJyZW50X2VsZW1fZG9jX2dvb2RzKGhhc2hNYXAsIGN1cnJlbnRfc3RyKQogICAgICAgIGRvYy5pZF9zdHIgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjIC4uLiDQuCDQt9Cw0L/QuNGI0LXQvCDQtdC1INCyINCx0LDQt9GDCgogICAgICAgIHF0dHkgPSBoYXNoTWFwLmdldCgncXR0eScpCiAgICAgICAgZG9jLnF0dHkgPSBmbG9hdChxdHR5KSBpZiBxdHR5IGVsc2UgMAoKICAgICAgICBkb2MudXBkYXRlX2RvY19zdHIoZG9jLCBoYXNoTWFwLmdldCgncHJpY2UnKSkgICMgKGRvYywgKQoKICAgICAgICByZW1vdmVfYWRkZWRfZ29vZF9oaWdobGlnaHQoaGFzaE1hcCwgc3RyKGN1cnJlbnRfZWxlbVsnaWRfZ29vZCddKSwgc3RyKGN1cnJlbnRfZWxlbVsnaWRfcHJvcGVydGllcyddKSkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9jYW5jZWwiOgoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSAiIjoKICAgICAgICBoYXNoTWFwLnB1dCgicXR0eSIsIHN0cihmbG9hdChoYXNoTWFwLmdldCgncXR0eScpKSkpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBlbGlmIGxpc3RlbmVyID09ICJwaG90byI6CgogICAgICAgICMg0JzQvtC20L3QviDQstC+0L7QsdGJ0LUg0Y3RgtC+0LPQviDQvdC1INC00LXQu9Cw0YLRjC3QvtGB0YLQsNCy0LvRj9GC0Ywg0LrQsNC6INC10YHRgtGMLiDQrdGC0L4g0LTQu9GPINC/0YDQuNC80LXRgNCwLgogICAgICAgIGltYWdlX2ZpbGUgPSBzdHIoCiAgICAgICAgICAgIGhhc2hNYXAuZ2V0KCJwaG90b19wYXRoIikpICAjICLQv9C10YDQtdC80LXQvdC90LDRjyIrIl9wYXRoIiAtINGB0Y7QtNCwINC/0L7QvNC10YnQsNC10YLRgdGPINC/0YPRgtGMINC6INC/0L7Qu9GD0YfQtdC90L3QvtC5INGE0L7RgtC+0LPRgNCw0YTQuNC4CgogICAgICAgIGltYWdlID0gSW1hZ2Uub3BlbihpbWFnZV9maWxlKQoKICAgICAgICAjINGB0YDQsNC30YMg0YHQtNC10LvQsNC10Lwg0YTQvtGC0LrRgyAtINC60LLQsNC00YDQsNGC0L3QvtC5IC0g0Y3RgtC+INC/0YDQvtGB0YLQvtC5INCy0LDRgNC40LDQvdGCLiDQnNC+0LbQvdC+INGB0LTQtdC70LDRgtGMINC90LDQv9GA0LjQvNC10YAg0L7RgtC00LXQu9GM0L4g0LzQuNC90LjQsNGC0Y7RgNGLINC00LvRjyDRgdC/0LjRgdC60LAsINGN0YLQviDQvdC10LzQvdC+0LPQviDRgdC70L7QttC90LXQtQogICAgICAgIGltID0gaW1hZ2UucmVzaXplKCg1MDAsIDUwMCkpCiAgICAgICAgaW0uc2F2ZShpbWFnZV9maWxlKQoKICAgICAgICBqcGhvdG9hcnIgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJwaG90b0dhbGxlcnkiKSkKICAgICAgICBoYXNoTWFwLnB1dCgicGhvdG9HYWxsZXJ5IiwganNvbi5kdW1wcyhqcGhvdG9hcnIpKQogICAgICAgICMgaGFzaE1hcC5wdXQoInRvYXN0Iixqc29uLmR1bXBzKGpwaG90b2FycikpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiZ2FsbGVyeV9jaGFuZ2UiOiAgIyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0LzQvtC20LXRgiDRg9C00LDQu9C40YLRjCDRhNC+0YLQviDQuNC3INCz0LDQu9C10YDQtdC4LiDQndC+0LLRi9C5INC80LDRgdGB0LjQsiDQvdCw0LTQviDQv9C+0LzQtdGB0YLQuNGC0Ywg0Log0LTQvtC60YPQvNC10L3RgtGDCgogICAgICAgIGlmIGhhc2hNYXAuY29udGFpbnNLZXkoInBob3RvR2FsbGVyeSIpOiAgIyDRjdGC0LggMiDQvtCx0YDQsNCx0L7RgtGH0LjQutCwIC0g0LDQvdCw0LvQvtCz0LjRh9C90YvQtSwg0L/RgNC+0YHRgtC+INC00LvRjyDRgNCw0LfQvdGL0YUg0YHQvtCx0YvRgtC40LkKICAgICAgICAgICAganBob3RvYXJyID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgicGhvdG9HYWxsZXJ5IikpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJwaG90b0dhbGxlcnkiLCBqc29uLmR1bXBzKGpwaG90b2FycikpCiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoInRvYXN0IiwiIzIiK2pzb24uZHVtcHMoanBob3RvYXJyKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBwcmljZXNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWRfZ29vZCA9IGhhc2hNYXAuZ2V0KCdpZF9nb29kJykKICAgICMg0KTQvtGA0LzQuNGA0YPQtdC8INGC0LDQsdC70LjRhtGDINC60LDRgNGC0L7Rh9C10Log0Lgg0LfQsNC/0YDQvtGBINC6INCx0LDQt9C1CiAgICBnb29kc19wcmljZV9saXN0ID0gdWlfZm9ybV9kYXRhLmdldF9wcmljZV9jYXJkKHJzX3NldHRpbmdzKQogICAgZ29vZHNfcHJpY2VfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X3ByaWNlX3F1ZXJ5KCkKCiAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKGlkX2dvb2QsKSkKICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbMF0pLAogICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFszXSksCiAgICAgICAgICAgICMgJ2lkX3Byb3BlcnRpZXMnOiBzdHIocmVjb3JkWzNdKSwKICAgICAgICAgICAgJ3Byb3BlcnRpZXNfbmFtZSc6IHN0cihyZWNvcmRbNV0pLAogICAgICAgICAgICAjICdpZF9zZXJpZXMnOiBzdHIocmVjb3JkWzVdKSwKICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFs3XSl9CiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBwcmljZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gImdldF9wcmljZXNfYnRuIjoKICAgICAgICBnZXRfcHJpY2VzKGhhc2hNYXApCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAicHJpY2VfdHlwZV9zZWxlY3QiOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgJ9CS0YvQsdC+0YAg0YLQuNC/0LAg0YbQtdC90YsnKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gInByb3BlcnR5X3NlbGVjdCI6CiAgICAgICAgZ2V0X2dvb2RfYnlfYXJ0KGhhc2hNYXApCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAn0JLRi9Cx0L7RgCDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQuicpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAidW5pdF9zZWxlY3QiOgogICAgICAgIGdldF9nb29kX2J5X2FydChoYXNoTWFwKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgJ9CS0YvQsdC+0YAg0YPQv9Cw0LrQvtCy0LrQuCcpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAiYmFyY29kZSI6CiAgICAgICAgaWRlbnRpZnlfYmFyY29kZV9wcmljZXMoaGFzaE1hcCkKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgIGtpbGxfcHJpY2VfdGFibGVzKGhhc2hNYXApCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3JldHVybl90b19nb29kX2NhcmQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkZpbmlzaFByb2Nlc3NSZXN1bHQiLCAiIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcHJpY2VfdHlwZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdDYXJkc0NsaWNrJzoKICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IikKICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX25hbWUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIG5hbWUgRlJPTSBSU19wcmljZV90eXBlcyB3aGVyZSBpZCA9ICciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF9wcmljZV90eXBlX2lkICsgIiciKQogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgc3RyKHNlbGVjdGVkX3ByaWNlX3R5cGVfaWQpKQogICAgICAgIGhhc2hNYXAucHV0KCJwcmljZV90eXBlX3NlbGVjdCIsIHN0cihzZWxlY3RlZF9wcmljZV90eXBlX25hbWVbMF0pLnNwbGl0KCInIilbMV0pCiAgICAgICAgaGFzaE1hcC5wdXQoIkJhY2tTY3JlZW4iLCAiIikKICAgICAgICByZXR1cm4gaGFzaE1hcAoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByb3BlcnRpZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IikKICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfcHJvcGVydGllcyB3aGVyZSBpZCA9ICciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfcHJvcGVydHlfaWQgKyAiJyIpCgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIHN0cihzZWxlY3RlZF9wcm9wZXJ0eV9pZCkpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X3NlbGVjdCIsIHN0cihzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdKS5zcGxpdCgiJyIpWzFdKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB1bml0c19vbl9pbnB1dChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgc2VsZWN0ZWRfdW5pdF9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfdW5pdHMgd2hlcmUgaWQgPSAnIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCArICInIikKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9pZCcsIHN0cihzZWxlY3RlZF91bml0X2lkKSkKICAgICAgICBoYXNoTWFwLnB1dCgidW5pdF9zZWxlY3QiLCBzdHIoc2VsZWN0ZWRfdW5pdF9uYW1lWzBdKS5zcGxpdCgiJyIpWzFdKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3ByaWNlcycgb3IgJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgYmFja190b19wcmljZXMoaGFzaE1hcCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByaWNlc190YWJsZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3Nob3dfZmlsdGVycyc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0iKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGlmIG5vdCBoYXNoTWFwLmdldCgicmV0dXJuX3RvX2dvb2RfY2FyZCIpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydHlfaWQnLCAnJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoInJldHVybl90b19nb29kX2NhcmQiKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkJhY2tTY3JlZW4iLCAnJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsICcnKQoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoImN1cnJlbnRfc2NyZWVuX25hbWUiKSA9PSAi0KLQsNCx0LvQuNGG0LAg0L7RgdGC0LDRgtC60L7QsiI6CiAgICAgICAgICAgICAgICBraWxsX3JlbWFpbnNfdGFibGVzKGhhc2hNYXApCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnKQogICAgICAgICAgICBlbGlmIGhhc2hNYXAuZ2V0KCJjdXJyZW50X3NjcmVlbl9uYW1lIikgPT0gItCi0LDQsdC70LjRhtCwINGG0LXQvSI6CiAgICAgICAgICAgICAgICBraWxsX3ByaWNlX3RhYmxlcyhoYXNoTWFwKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2JhcmNvZGUnOgogICAgICAgIGlkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKGhhc2hNYXApCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgaWRlbnRpZnlfYmFyY29kZV9wcmljZXMoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGUnKToKICAgICAgICBoYXNoTWFwLnB1dCgnYmFyY29kZV9pbmZvJywgc3RyKGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykpKQogICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9zZWxlY3QnLCAnJykKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnLCAnJykKCiAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKICAgICAgICBiYXJjb2RlX2dvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBpZF9nb29kLGlkX3Byb3BlcnR5IEZST00gUlNfYmFyY29kZXMgd2hlcmUgYmFyY29kZSA9ICciICsgYmFyY29kZSArICInIikKCiAgICAgICAgaWYgYmFyY29kZV9nb29kX3F1ZXJ5WzBdWzBdOgogICAgICAgICAgICBnb29kX2lkID0gYmFyY29kZV9nb29kX3F1ZXJ5WzBdWzBdCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2lkJywgYmFyY29kZV9nb29kX3F1ZXJ5WzBdWzBdKQoKICAgICAgICAgICAgaWYgbGVuKGdvb2RfaWQpID4gMDoKICAgICAgICAgICAgICAgIGdvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgICAgICAgICAiU0VMRUNUIG5hbWUsYXJ0LHR5cGVfZ29vZCBGUk9NIFJTX2dvb2RzIHdoZXJlIGlkID0gJyIgKyBnb29kX2lkICsgIiciKQoKICAgICAgICAgICAgICAgIGlmIGdvb2RfcXVlcnlbMF1bMF06CiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsIGdvb2RfcXVlcnlbMF1bMF0pCiAgICAgICAgICAgICAgICBpZiBnb29kX3F1ZXJ5WzBdWzFdOgogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2FydCcsIGdvb2RfcXVlcnlbMF1bMV0pCiAgICAgICAgICAgICAgICBpZiBnb29kX3F1ZXJ5WzBdWzJdOgogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX3R5cGVfaWQnLCBnb29kX3F1ZXJ5WzBdWzJdKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAiIikKCiAgICAgICAgaWYgYmFyY29kZV9nb29kX3F1ZXJ5WzBdWzFdOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydHlfaWQnLCBiYXJjb2RlX2dvb2RfcXVlcnlbMF1bMV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0KjRgtGA0LjRhdC60L7QtCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSIpCiAgICBnZXRfcHJpY2VzKGhhc2hNYXApCgoKZGVmIGJhY2tfdG9fcHJpY2VzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YLQuNC/0LAg0YbQtdC90YsiOgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3ByaWNlX3R5cGVfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdwcmljZV90eXBlX3NlbGVjdCcsICcnKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YXQsNGA0LDQutGC0LXRgNC40YHRgtC40LoiOgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X3NlbGVjdCIsICcnKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgPT0gItCS0YvQsdC+0YAg0YPQv9Cw0LrQvtCy0LrQuCI6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfaWQnLCAiIikKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoInVuaXRfc2VsZWN0IiwgIiIpCiAgICBoYXNoTWFwLnB1dCgiQmFja1NjcmVlbiIsICIiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2RvY19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnZG9jX3R5cGVfc2VsZWN0JykgPT0gTm9uZToKICAgICAgICAjINCX0LDQv9C+0LvQvdC40Lwg0L/QvtC70LUg0YTQuNC70YzRgtGA0LAg0L/QviDQstC40LTRgyDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgICAgIHJlc3VsdCA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHVpX2Zvcm1fZGF0YS5nZXRfZG9jX3R5cGVfcXVlcnkoKSkKICAgICAgICBkb2NfdHlwZV9saXN0ID0gWyfQktGB0LUnXQogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0OgogICAgICAgICAgICBkb2NfdHlwZV9saXN0LmFwcGVuZChyZWNvcmRbMF0pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY190eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdjb3VudHJhZ2VudCcpID09IE5vbmU6CiAgICAgICAgI2ZsZF9jb3VudHJhZ2VudCA9IHVpX2dsb2JhbC5nZXRfbmFtZV9saXN0KCdSU19jb3VudHJhZ2VudHMnKQoKICAgICAgICBoYXNoTWFwLnB1dCgnY291bnRyYWdlbnQnLCAn0JrQvtC90YLRgNCw0LPQtdC90YInKSAgI2ZsZF9jb3VudHJhZ2VudAoKICAgIGlmIGhhc2hNYXAuZ2V0KCd3YXJlaG91c2UnKSA9PSBOb25lOgogICAgICAgICNmbGRfY291bnRyYWdlbnQgPSB1aV9nbG9iYWwuZ2V0X25hbWVfbGlzdCgnUlNfd2FyZWhvdXNlcycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsICfQodC60LvQsNC0JykgI2RvY193YXJlaG91c2UKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgnZG9jX2RhdGUnKToKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCAnMDEuMDEuMjAyMicpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2RvY19vbl9zZWxlY3QoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQogICAgdHlwZSA9IGhhc2hNYXAuZ2V0KCdkb2NfdHlwZV9jbGljaycpCiAgICBpZiBub3QgdHlwZToKICAgICAgICB0eXBlID0gJ9Cf0YDQuNGF0L7QtCcKICAgIGZsZF9udW1iZXIgPSBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgaWYgbm90IHR5cGUgb3IgdHlwZT09J9CS0YHQtSc6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsJ9Cj0LrQsNC20LjRgtC1INGC0LjQvyDQtNC+0LrRg9C80LXQvdGC0LAnKQogICAgICAgICAgICByZXR1cm4gaGFzaE1hcAoKICAgICAgICBpZiBub3QgZmxkX251bWJlcjoKCiAgICAgICAgICAgIGlkID0gdWlfZ2xvYmFsLlJzX2RvYy5nZXRfbmV3X2lkKDEpCiAgICAgICAgICAgICMgaWQgPSAoZid7aWQ6MDR9JykKICAgICAgICAgICAgIyBpZCA9ICJ7MDowPjR9Ii5mb3JtYXQoaWQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWQgPSBmbGRfbnVtYmVyCgogICAgICAgIHRyeToKICAgICAgICAgICAgdWlfZ2xvYmFsLlJzX2RvYy5hZGQoJzAxJywgKGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLCAgIyBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnZmxkX2RhdGEnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfYnlfbmFtZShoYXNoTWFwLmdldCgnY291bnRyYWdlbnQnKSwgJ1JTX2NvdW50cmFnZW50cycpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9ieV9uYW1lKGhhc2hNYXAuZ2V0KCd3YXJlaG91c2UnKSwgJ1JTX3dhcmVob3VzZXMnKSkpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0J3QvtC80LXRgCDQtNC+0LrRg9C80LXQvdGC0LAg0L3QtdGD0L3QuNC60LDQu9C10L0hJykKCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2NhbmNlbCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2ZsZF9kYXRhJzoKICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2RhdGUnLCBoYXNoTWFwLmdldCgnZmxkX2RhdGEnKSkKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0nYnRuX3NlbGVjdF93YXJlaG91c2UnOgogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV9mb3Jfc2VsZWN0JywgJ1JTX3dhcmVob3VzZXMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X2NlbGxfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2VsZWN0X2NvdW50cmFnZW50JzoKICAgICAgICBoYXNoTWFwLnB1dCgndGFibGVfZm9yX3NlbGVjdCcsICdSU19jb3VudHJhZ2VudHMnKSAgIyDQotCw0LHQu9C40YbQsCDQtNC70Y8g0LLRi9Cx0L7RgNCwINC30L3QsNGH0LXQvdC40Y8KICAgICAgICBoYXNoTWFwLnB1dCgnU2V0UmVzdWx0TGlzdGVuZXInLCAnc2VsZWN0X2NlbGxfdmFsdWUnKQogICAgICAgIGhhc2hNYXAucHV0KCdmaWx0ZXJfZmllbGRzJywgJ25hbWU7ZnVsbF9uYW1lO2lubjtrcHAnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQo9C90LjQstC10YDRgdCw0LvRjNC90YvQuSDRgdC/0YDQsNCy0L7Rh9C90LjQunzQodC/0YDQsNCy0L7Rh9C90LjQuicpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnc2VsZWN0X2NlbGxfdmFsdWUnOgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCd0YWJsZV9mb3Jfc2VsZWN0JykgPT0gJ1JTX2NvdW50cmFnZW50cyc6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdjb3VudHJhZ2VudCcsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkgI2ZsZF9jb3VudHJhZ2VudAogICAgICAgIGVsaWYgaGFzaE1hcC5nZXQoJ3RhYmxlX2Zvcl9zZWxlY3QnKSA9PSAnUlNfd2FyZWhvdXNlcyc6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd3YXJlaG91c2UnLCBoYXNoTWFwLmdldCgnY3VycmVudF9uYW1lJykpICAjIGZsZF9jb3VudHJhZ2VudAogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZG9jX2JhcmNvZGVzX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGRvY19kZXRhaWxfbGlzdCA9IHVpX2Zvcm1fZGF0YS5nZXRfYmFyY29kZV9jYXJkKHJzX3NldHRpbmdzKQogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfYmFyY29kZV9xdWVyeSgpCiAgICBpZF9kb2MgPSBoYXNoTWFwLmdldCgnaWRfZG9jJykKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoaWRfZG9jLCkpCgogICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFswXSksCiAgICAgICAgICAgICdiYXJjb2RlX3ZhbHVlJzogc3RyKHJlY29yZFszXSksCiAgICAgICAgICAgICdhcHByb3ZlZCc6IHN0cihyZWNvcmRbNF0pCgogICAgICAgIH0KCiAgICAgICAgZG9jX2RldGFpbF9saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgaGFzaE1hcC5wdXQoImJhcmNfY2FyZHMiLCBqc29uLmR1bXBzKGRvY19kZXRhaWxfbGlzdCkpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZG9jX2JhcmNvZGVzX2xpc3RlbmVyKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGJhcmNvZGVfZXJyb3Jfc2NyZWVuX2xpc3RlbmVyKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICMgc3VDbGFzcy51cm92b19zZXRfbG9ja190cmlnZ2VyKEZhbHNlKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKICAgIGVsaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2J0bl9jb250aW51ZV9zY2FuJzoKICAgICAgICAjIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcihGYWxzZSkKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB0aWxlc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzbWFsbF90aWxlID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfdGlsZXMocnNfc2V0dGluZ3MpCiAgICBxdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfZG9jc19zdGF0X3F1ZXJ5KCkKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCBOb25lLCBUcnVlKQoKICAgIHggPSB7J3RpbGVzJzogW1tdXSwgImJhY2tncm91bmRfY29sb3IiOiAiI2Y1ZjVmNSJ9CgogICAgIyB4Wyd0aWxlcyc6WzBdWzBdXT0xCiAgICByb3dzID0gMQogICAgY29sdW1ucyA9IDEKICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgaWYgZWxbJ2RvY1R5cGUnXT09Tm9uZToKICAgICAgICAgICAgY29udGludWUKICAgICAgICBpZiBjb2x1bW5zICUgMyA9PSAwOgogICAgICAgICAgICByb3dzICs9IDEKICAgICAgICAgICAgY29sdW1ucyA9IDAKICAgICAgICAgICAgeFsndGlsZXMnXS5hcHBlbmQoW10pCiAgICAgICAgY29sdW1ucyArPSAxCgogICAgICAgIHRpbGUgPSB7CgogICAgICAgICAgICAibGF5b3V0Ijogc21hbGxfdGlsZSwKICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAiZG9jTmFtZSI6IGVsWydkb2NUeXBlJ10sCiAgICAgICAgICAgICAgICAnUXR0eU9mRG9jcyc6IHN0cihlbFsnY291bnQnXSkgKyAnLycgKyBzdHIoZWxbJ3ZlcmlmaWVkJ10pLAogICAgICAgICAgICAgICAgIyAnUXR0eU9mRG9jc0luY29tcGxldGVkJzplbFsnY291bnQnXSAtIGVsWyd2ZXJpZmllZCddCiAgICAgICAgICAgICAgICAnY291bnRfdmVyaWZpZWQnOiBzdHIoZWxbJ2NvdW50X3ZlcmlmaWVkJ10rZWxbJ2NvdW50X3VudmVyaWZpZWQnXSkgKyAnLycgKyBzdHIoZWxbJ2NvdW50X3VudmVyaWZpZWQnXSksCiAgICAgICAgICAgICAgICAncXR0eV9wbGFuX3ZlcmlmaWVkJzogc3RyKGVsWydxdHR5X3BsYW5fdmVyaWZpZWQnXStlbFsncXR0eV9wbGFuX3VudmVyaWZpZWQnXSkgKyAnLycgKyBzdHIoZWxbJ3F0dHlfcGxhbl91bnZlcmlmaWVkJ10pLAoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAiY29sb3IiOiAnI0ZGRkZGRicsICAjICIjRkZDQzk5IiwKICAgICAgICAgICAgInN0YXJ0X3NjcmVlbiI6ICLQlNC+0LrRg9C80LXQvdGC0YsiLAoKICAgICAgICAgICAgInN0YXJ0X3Byb2Nlc3MiOiAiIiwKICAgICAgICAgICAgJ2tleSc6IGVsWydkb2NUeXBlJ10KICAgICAgICB9CgogICAgICAgIHhbJ3RpbGVzJ11bcm93cyAtIDFdLmFwcGVuZCh0aWxlKQoKICAgIGhhc2hNYXAucHV0KCJ0aWxlcyIsIGpzb24uZHVtcHMoeCwgZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoJ3V0ZjgnKS5kZWNvZGUoKSkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHRpbGVzX29uX3NlbGVjdChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCgogICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgIHBhc3MKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CgogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBhcHBfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyBoYXNoTWFwLnB1dCgnSW5zdGFsbENvbmZpZ3VyYXRpb24nLCAnJykKICAgICMgaGFzaE1hcC5wdXQoJ1VwZGF0ZU1lbnUnLCAnJykKICAgICMgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Ca0L7QvdGE0LAg0YPRgdGC0LDQvdC+0LLQu9C10L3QsCEhIScpCiAgICBzaGVtYSA9IGRhdGFiYXNlX2luaXRfcXVlcnllcy5kYXRhYmFzZV9zaGVtYSgpCiAgICBmb3IgZWwgaW4gc2hlbWE6CiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoZWwpCgoKICAgICAgICAjIGZvciBwYXJhbWV0ZXJfbmFtZSwgdmFsdWUgaW4gcGFyYW1ldGVycy5pdGVtcygpOgogICAgICAgICMgICAgIHNldF9wYXJhbXMucHV0KHBhcmFtZXRlcl9uYW1lLHZhbHVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdUaXRsZVRleHRTaXplJykgaXMgTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlRpdGxlVGV4dFNpemUiLCAiMTgiLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgidGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplIiwgIjE4IiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiQ2FyZFRpdGxlVGV4dFNpemUiLCAiMjAiLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykgaXMgTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmREYXRlVGV4dFNpemUiLCAiMTAiLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiQ2FyZFRleHRTaXplIiwgIjE1IiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpIGlzIE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJHb29kc0NhcmRUaXRsZVRleHRTaXplIiwgIjE4IiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnZ29vZHNUZXh0U2l6ZScpIGlzIE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJnb29kc1RleHRTaXplIiwgIjE4IiwgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJykgaXMgTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlNlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSIsICIxNiIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiRG9jVHlwZUNhcmRUZXh0U2l6ZSIsICIxNSIsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ3NpZ25hbF9udW0nKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnc2lnbmFsX251bScsICc4MycsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnYmVlcF9kdXJhdGlvbicsICcxMDAwJywgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgndXNlX21hcmsnKSAgaXMgTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ3VzZV9tYXJrJywgJ2ZhbHNlJywgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnYWRkX2lmX25vdF9pbl9wbGFuJykgIGlzIE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdhZGRfaWZfbm90X2luX3BsYW4nLCAnZmFsc2UnLCBUcnVlKQogICAgaWYgcnNfc2V0dGluZ3MuZ2V0KCdwYXRoJykgIGlzIE5vbmU6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdwYXRoJywgJycsIFRydWUpCiAgICBpZiByc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9maWxlcycpICBpcyBOb25lOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnZGVsZXRlX2ZpbGVzJywgJ2ZhbHNlJywgVHJ1ZSkKICAgIGlmIHJzX3NldHRpbmdzLmdldCgnYWxsb3dfb3ZlcnNjYW4nKSAgaXMgTm9uZToKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2FsbG93X292ZXJzY2FuJywgJ2ZhbHNlJywgVHJ1ZSkKCgogICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9CT0L7RgtC+0LIg0Log0YDQsNCx0L7RgtC1JykKCiAgICAjINCf0YDQvtCy0LXRgNC40LwsINGB0LLQvtC/0LDQtNCw0Y7RgiDQu9C4INGC0LXQutGD0YnQuNC5INGA0LXQu9C40Lcg0LrQvtC90YTRiyDQuCDQt9Cw0L/QuNGB0Ywg0L4g0L3QtdC8INCyINCR0JQsINC10YHQu9C4INC90LXRgiAtINGC0L4g0L3QsNC00L4g0LLRi9C/0L7Qu9C90LjRgtGMINC/0YDQvtGG0LXQtNGD0YDRgyDQvtCx0L3QvtCy0LvQtdC90LjRjwogICAgIyBpZiBub3QgdWlfZ2xvYmFsLmdldF9jb25zdGFudHMoJ3JlbGVhc2UnKSA9PSBoYXNoTWFwLmdldCgncmVsZWFzZScpOgogICAgIyB1cGRhdGVfcHJvYy51cGRhdGVfb25fcmVsZWFzZShjdXJyZW50X3JlbGVhc2UpCiAgICAjIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdVcGRhdGUgUlNfY29uc3RhbnRzIHNldCByZWxlYXNlID0gPycsKGhhc2hNYXAuZ2V0KCdyZWxlYXNlJyksKSkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBmaWxlX2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdHggPSAnJwoKICAgICMgdHJhdmVyc2Ugcm9vdCBkaXJlY3RvcnksIGFuZCBsaXN0IGRpcmVjdG9yaWVzIGFzIGRpcnMgYW5kIGZpbGVzIGFzIGZpbGVzCiAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2FsaygiLiIpOgogICAgICAgIHBhdGggPSByb290LnNwbGl0KG9zLnNlcCkKICAgICAgICBwcmludCgobGVuKHBhdGgpIC0gMSkgKiAnLS0tJywgb3MucGF0aC5iYXNlbmFtZShyb290KSkKICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgcHJpbnQobGVuKHBhdGgpICogJy0tLScsIGZpbGUpCgogICAgaGFzaE1hcC5wdXQoJ2ZpbGVzX2xpc3QnLCB0eCkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGV2ZW50X3NlcnZpY2UoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgIyBoYXNoTWFwLnB1dCgnX2NvbmZpZ3VyYXRpb24nLCcnKQogICAgaGFzaE1hcC5wdXQoJ3dzX2JvZHknLCBoYXNoTWFwLmdldCgnQU5EUk9JRF9JRCcpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHB1dF9ub3RpZmljYXRpb24oaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaGFzaE1hcC5wdXQoJ19jb25maWd1cmF0aW9uJywnJykKICAgIHF0ZXh0ID0gJ1NFTEVDVCBkb2NfdHlwZSwgY291bnQoaWRfZG9jKSBhcyBjb3VudCwgbWF4KGNyZWF0ZWRfYXQpIGFzIGR0IEZST00gUlNfZG9jcyBXSEVSRSBjcmVhdGVkX2F0Pj8gR1JPVVAgQlkgZG9jX3R5cGUnCiAgICBsYXN0RGF0ZSA9IHJzX3NldHRpbmdzLmdldCgnbGFzdERhdGUnKQogICAgaWYgbm90IGxhc3REYXRlOgogICAgICAgIGxhc3REYXRlID0gJzIwMjAtMDEtMDEgMDA6MDA6MDAnICAjIG9uZV9tb250aF9hZ28uc3RyZnRpbWUoJyVZLSVtLSVkLSVILSVNLSVTJykKICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LChsYXN0RGF0ZSwpLFRydWUpCiAgICBEb2NMaXN0ID0gJycKICAgIGlmIHJlczoKICAgICAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgICAgICBEb2NMaXN0ID0gRG9jTGlzdCArICgnICcgKyBlbFsnZG9jX3R5cGUnXSArICc6ICcgKyBzdHIoZWxbJ2NvdW50J10pKQoKICAgICAgICBoYXNoTWFwLnB1dCgnYmFzaWNfbm90aWZpY2F0aW9uJywganNvbi5kdW1wcyhbeydudW1iZXInOjEsICd0aXRsZSc6J9Cd0L7QstGL0LUg0LTQvtC60YPQvNC10L3RgtGLJywgJ21lc3NhZ2UnOiBEb2NMaXN0IH1dKSkKICAgICAgICBxdGV4dCA9ICdTRUxFQ1QgbWF4KGNyZWF0ZWRfYXQpIGFzIGR0IEZST00gUlNfZG9jcycKICAgICAgICByZXMyID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnbGFzdERhdGUnLHJlczJbMF1bMF0sVHJ1ZSkKICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLGxhc3REYXRlKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGZvbnRfc2l6ZV9zZXR0aW5nc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnOiAgIyBvciBoYXNoTWFwLmdldCgnZXZlbnQnKT09J0lucHV0JwoKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlRpdGxlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiVGl0bGVUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiQ2FyZFRpdGxlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiQ2FyZFRpdGxlVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmRUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJDYXJkVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkNhcmREYXRlVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiQ2FyZERhdGVUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgiR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJHb29kc0NhcmRUaXRsZVRleHRTaXplIiksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCJnb29kc1RleHRTaXplIiwgaGFzaE1hcC5nZXQoImdvb2RzVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIlNlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSIsIGhhc2hNYXAuZ2V0KCJTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUiKSwgVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoIkRvY1R5cGVDYXJkVGV4dFNpemUiLCBoYXNoTWFwLmdldCgiRG9jVHlwZUNhcmRUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgidGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplIiwgaGFzaE1hcC5nZXQoInRpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSIpLCBUcnVlKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKICAgICAgICAjcGFyYW1zLnB1dCgic2lnbmFsX251bSIsIGhhc2hNYXAuZ2V0KCJzaWduYWxfbnVtIiksIFRydWUpCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fb25fY2FuY2VsJyBvciBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZm9udF9zaXplc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgIyDQodC70L7QstCw0YDQuNC6INC90LDQt9Cy0LDQvdC40Lkg0Lgg0LjQvNC10L0g0YDQsNC30LzQtdGA0L7QsiDRiNGA0LjRhNGC0L7QsgogICAgc3MgPSB7CiAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCcsCiAgICAgICAgJ0NhcmRUaXRsZVRleHRTaXplJzogJ9Cg0LDQt9C80LXRgCDQt9Cw0LPQvtC70L7QstC60LAg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICAgICAgIkNhcmREYXRlVGV4dFNpemUiOiAn0JTQsNC90L3Ri9C1INC60LDRgNGC0L7Rh9C60LgnLAogICAgICAgICdDYXJkVGV4dFNpemUnOifQoNCw0LfQvNC10YAg0YLQtdC60YHRgtCwINGN0LvQtdC80LXQvdGC0L7QsicsCiAgICAgICAgJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnOiAn0JfQsNCz0L7Qu9C+0LLQvtC6INGC0L7QstCw0YDQsCcsCiAgICAgICAgJ2dvb2RzVGV4dFNpemUnOiAn0KLQvtCy0LDRgCcsCiAgICAgICAgJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSc6ICfQodC10YDQuNC4INGB0LLQvtC50YHRgtCy0LAnLAogICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogJ9Ci0LjQvyDQtNC+0LrRg9C80LXQvdGC0LAnLAogICAgICAgICd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnOifQndCw0LfQstCw0L3QuNC1INC00L7QutGD0LzQtdC90YLQsCDQsiDQutCw0YDRgtC+0YfQutC1J30gICMsICAgICAgICdzaWduYWxfbnVtJzogItCd0L7QvNC10YAg0YHQuNCz0L3QsNC70LAiCgogICAgaGFzaE1hcC5wdXQoJ1RpdGxlVGV4dFNpemUnLCAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9Cg0LDQt9C80LXRgCDQt9Cw0LPQvtC70L7QstC60LAnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdUaXRsZVRleHRTaXplJyksIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICMgICkKICAgIGhhc2hNYXAucHV0KCdDYXJkVGl0bGVUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCDQutCw0YDRgtC+0YfQutC4JywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjIkNhcmREYXRlVGV4dFNpemUiOiAn0JTQsNC90L3Ri9C1INC60LDRgNGC0L7Rh9C60LgnLAogICAgaGFzaE1hcC5wdXQoJ0NhcmREYXRlVGV4dFNpemUnLAogICAgICAgICAgICAgICAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9CU0LDQvdC90YvQtSDQutCw0YDRgtC+0YfQutC4JywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgICMnQ2FyZFRleHRTaXplJzon0KDQsNC30LzQtdGAINGC0LXQutGB0YLQsCDRjdC70LXQvNC10L3RgtC+0LInLAogICAgaGFzaE1hcC5wdXQoJ0NhcmRUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KDQsNC30LzQtdGAINGC0LXQutGB0YLQsCDRjdC70LXQvNC10L3RgtC+0LInLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnOiAn0JfQsNCz0L7Qu9C+0LLQvtC6INGC0L7QstCw0YDQsCcsCiAgICBoYXNoTWFwLnB1dCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0JfQsNCz0L7Qu9C+0LLQvtC6INGC0L7QstCw0YDQsCcsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjJ2dvb2RzVGV4dFNpemUnOiAn0KLQvtCy0LDRgCcsCiAgICBoYXNoTWFwLnB1dCgnZ29vZHNUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KLQvtCy0LDRgCcsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZSc6ICfQodC10YDQuNC4INGB0LLQvtC50YHRgtCy0LAnLAogICAgaGFzaE1hcC5wdXQoJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0KHQtdGA0LjQuCDRgdCy0L7QudGB0YLQstCwJywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgICMgKQogICAgIydEb2NUeXBlQ2FyZFRleHRTaXplJzogJ9Ci0LjQvyDQtNC+0LrRg9C80LXQvdGC0LAnLAogICAgaGFzaE1hcC5wdXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnLAogICAgICAgICAgICAgICAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9Ci0LjQvyDQtNC+0LrRg9C80LXQvdGC0LAnLCBkZWZhdWx0X3RleHQ9cnNfc2V0dGluZ3MuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgICMgKQogICAgIyd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnOifQndCw0LfQstCw0L3QuNC1INC00L7QutGD0LzQtdC90YLQsCDQsiDQutCw0YDRgtC+0YfQutC1JwogICAgaGFzaE1hcC5wdXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScsCiAgICAgICAgICAgICAgICB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0n0J3QsNC30LLQsNC90LjQtSDQtNC+0LrRg9C80LXQvdGC0LAg0LIg0LrQsNGA0YLQvtGH0LrQtScsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBzb3VuZF9zZXR0aW5nc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAjIHNzID0geydzaWduYWxfbnVtJzogItCd0L7QvNC10YAg0YHQuNCz0L3QsNC70LAiLAogICAgIyAgICAgICAnYmVlcF9kdXJhdGlvbic6J9CU0LvQuNGC0LXQu9GM0L3QvtGB0YLRjCjQvNGBKSd9ICAjICwKCiAgICBoYXNoTWFwLnB1dCgnc2lnbmFsX251bV9jYXJkJywKICAgICAgICAgICAgICAgIHVpX2Zvcm1fZGF0YS5Nb2Rlcm5GaWVsZChoaW50PSfQndC+0LzQtdGAINGB0LjQs9C90LDQu9CwJywgZGVmYXVsdF90ZXh0PXJzX3NldHRpbmdzLmdldCgnc2lnbmFsX251bScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPUZhbHNlKS50b19qc29uKCkpICAjICkKICAgIGhhc2hNYXAucHV0KCdiZWVwX2R1cmF0aW9uX2NhcmQnLAogICAgICAgICAgICAgICAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J9CU0LvQuNGC0LXQu9GM0L3QvtGB0YLRjCjQvNGBKScsIGRlZmF1bHRfdGV4dD1yc19zZXR0aW5ncy5nZXQoJ2JlZXBfZHVyYXRpb24nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKSAgIyApCiAgICAjZmllbGRzX2Zyb21fc2V0dGluZ3MoaGFzaE1hcCwgc3MpCgogICAgcmV0dXJuIGhhc2hNYXAKCmRlZiBzb3VuZF9zZXR0aW5nc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnOiAgIyBvciBoYXNoTWFwLmdldCgnZXZlbnQnKSA9PSAnSW5wdXQnCgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnc2lnbmFsX251bScsIGhhc2hNYXAuZ2V0KCJzaWduYWxfbnVtX3ZhbHVlIiksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdiZWVwX2R1cmF0aW9uJywgaGFzaE1hcC5nZXQoJ2JlZXBfZHVyYXRpb25fdmFsdWUnKSwgVHJ1ZSkKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX29uX2NhbmNlbCcgb3IgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Rlc3Rfc291bmQnOgogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnc2lnbmFsX251bScsIGhhc2hNYXAuZ2V0KCJzaWduYWxfbnVtX3ZhbHVlIiksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdiZWVwX2R1cmF0aW9uJywgaGFzaE1hcC5nZXQoJ2JlZXBfZHVyYXRpb25fdmFsdWUnKSwgVHJ1ZSkKICAgICAgICBoYXNoTWFwLnB1dCgnYmVlcF9kdXJhdGlvbicsIGhhc2hNYXAuZ2V0KCJiZWVwX2R1cmF0aW9uX3ZhbHVlIikpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2JlZXAnLCBoYXNoTWFwLmdldCgnc2lnbmFsX251bV92YWx1ZScpKQoKICAgICAgICAjIGhhc2hNYXAucHV0KCdiZWVwX2R1cmF0aW9uJywgc3RyKHJzX3NldHRpbmdzLmdldCgnYmVlcF9kdXJhdGlvbicpKSkKICAgICAgICAjIGhhc2hNYXAucHV0KCJiZWVwIiwgc3RyKHJzX3NldHRpbmdzLmdldCgnc2lnbmFsX251bScpKSkKCiAgICAgICAgIyBoYXNoTWFwLnB1dCgnYmVlcF9kdXJhdGlvbicsICc4MycpCiAgICAgICAgIyBoYXNoTWFwLnB1dCgiYmVlcCIsICcxMDAwJykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB0ZXN0X2JhcmNvZGVfbGlzdGVuZXIoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJyk9PSdiYXJjb2RlJyBvciBoYXNoTWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgaWYgaGFzaE1hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgogICAgICAgICAgICBiYXJjb2RlID0gaGFzaE1hcC5nZXQoJ2ZsZF9iYXJjb2RlJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlID0gaGFzaE1hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykKICAgICAgICBiYXJjID0gdWlfYmFyY29kZXMucGFyc2VfYmFyY29kZShiYXJjb2RlKQogICAgICAgIGtleXNfbGlzdCA9IFsnRVJST1InLCdHVElOJywnU0VSSUFMJywnRnVsbENvZGUnLCAnQkFSQ09ERScsICdTQ0hFTUUnLCAnRVhQSVJZJywgJ0JBVENIJywgJ05IUk4nLCAnQ0hFQ0snLCAnV0VJR0hUJywgJ1BQTiddCiAgICAgICAgeD0xCiAgICAgICAgZm9yIGkgaW4ga2V5c19saXN0OgogICAgICAgICAgICByZXNfdmFsdWUgPSAgYmFyYy5nZXQoaSxOb25lKQogICAgICAgICAgICBpZiByZXNfdmFsdWU6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZmxkXycrc3RyKHgpLHN0cihpKSsnOiAnKyByZXNfdmFsdWUpCiAgICAgICAgICAgICAgICB4Kz0xCiAgICAgICAgI9CV0YHQu9C4INC30LDQv9C+0LvQvdC10L3QviDQvNC10L3QtdC1IDUg0L/QvtC70LXQuSwg0YHQvtGC0YDQtdC8INC+0YHRgtCw0LvRjNC90YvQtSDQv9GA0L7RiNC70YvQtSDQt9C90LDRh9C10L3QuNGPCiAgICAgICAgd2hpbGUgeDw9NzoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2ZsZF8nICsgc3RyKHgpLCAnJykKICAgICAgICAgICAgeCs9MQoKICAgIGVsaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gIkJBQ0tfQlVUVE9OIiBvciAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvSIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgYmFyY29kZV9mbG93X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgZmFsc2VWYWx1ZUxpc3QgPSAoMCwgJzAnLCAnZmFsc2UnLCAnRmFsc2UnLCBOb25lKQogICAgIyDQpNC+0YDQvNC40YDRg9C10Lwg0YLQsNCx0LvQuNGG0YMg0LrQsNGA0YLQvtGH0LXQuiDQuCDQt9Cw0L/RgNC+0YEg0Log0LHQsNC30LUKCiAgICBkb2NfZGV0YWlsX2xpc3QgPSB1aV9mb3JtX2RhdGEuZG9jX2JhcmNfZmxvd19jYXJkKHJzX3NldHRpbmdzKQogICAgZG9jX2RldGFpbF9saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXSA9IFtdCgoKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2RvY19iYXJjX2Zsb3dfcXVlcnkoKQoKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoaWRfZG9jLCksIFRydWUpCgogICAgaWYgcmVzdWx0czoKICAgICAgICAjIGhhc2hNYXAucHV0KCdpZF9kb2MnLCBzdHIocmVzdWx0c1swXVsnaWRfZG9jJ10pKQogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICAgICAgcGljID0gJyNmMDBjJwoKICAgICAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnYmFyY29kZSddKSwKICAgICAgICAgICAgICAgICdiYXJjb2RlJzogc3RyKHJlY29yZFsnYmFyY29kZSddKSwKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgICAgICAjINCf0YDQuNC30L3QsNC6LCBoYXZlX3F0dHlfcGxhbiDQldGB0YLRjNCf0LvQsNC90J/QntCa0J7Qu9C40YfQtdGB0YLQstGDICAtICDQmNGB0YLQuNC90LAg0LrQvtCz0LTQsCDRgdGD0LzQvNCwINC60L7Qu9C+0L3QutC4IFF0dHlfcGxhbiA+IDAKICAgICAgICAjINCf0YDQuNC30L3QsNC6ICBoYXZlX21hcmtfcGxhbiAi0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDigJMg0JjRgdGC0LjQvdCwLCDQutC+0LPQtNCwINC60L7Qu9C40YfQtdGB0YLQstC+INGB0YLRgNC+0Log0YLQsNCx0LsuIFJTX2RvY3NfYmFyY29kZXMg0YEg0LfQsNC00LDQvdC90YvQvCBpZF9kb2Mg0LggaXNfcGxhbiAg0LHQvtC70YzRiNC1INC90YPQu9GPLgogICAgICAgICMg0J/RgNC40LfQvdCw0LogaGF2ZV96ZXJvX3BsYW4gItCV0YHRgtGMINGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RgtC1IiDQmNGB0YLQuNC90LAsINC60L7Qs9C00LAg0LXRgdGC0Ywg0LfQsNC/0L7Qu9C90LXQvdC90YvQtSDRgdGC0YDQvtC60Lgg0YLQvtCy0LDRgNC+0LIg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAi0JrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjCIgIC0g0L/RgNC40LfQvdCw0Log0LTQu9GPINC00L7QutGD0LzQtdC90YLQsCwg0L3QsNC00L4g0LvQuCDQutC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMCgogICAgICAgIHF0ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9xdHR5X3N0cmluZ19jb3VudF9xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jfSkKICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IHJlc1swXVswXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINGB0YLRgNC+0LrQuAogICAgICAgICAgICBpZiBoYXZlX3plcm9fcGxhbjoKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gcmVzWzBdWzFdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0LrQvtC70LLQviDQv9C70LDQvQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICMg0JXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0L/QviDQutC+0LTQsNC8INC80LDRgNC60LjRgNC+0LLQutC4CiAgICAgICAgcXRleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2hhdmVfbWFya19jb2Rlc19xdWVyeSgpCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jLCAnaXNfcGxhbic6ICcxJ30pCiAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IHJlc1swXVswXSA+IDAKICAgIGVsc2U6CiAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgaGFzaE1hcC5wdXQoJ2hhdmVfcXR0eV9wbGFuJywgc3RyKGhhdmVfcXR0eV9wbGFuKSkKICAgIGhhc2hNYXAucHV0KCdoYXZlX3plcm9fcGxhbicsIHN0cihoYXZlX3plcm9fcGxhbikpCiAgICBoYXNoTWFwLnB1dCgnaGF2ZV9tYXJrX3BsYW4nLCBzdHIoaGF2ZV9tYXJrX3BsYW4pKQogICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoJ1NFTEVDVCBjb250cm9sIGZyb20gUlNfZG9jcyAgV0hFUkUgaWRfZG9jID0gPycsIChpZF9kb2MsKSkKICAgICMg0JXRgdGC0Ywg0LvQuCDQutC+0L3RgtGA0L7Qu9GMINC/0LvQsNC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICBpZiByZXM6CiAgICAgICAgaWYgcmVzWzBdWzBdOgogICAgICAgICAgICBpZiByZXNbMF1bMF0gaW4gZmFsc2VWYWx1ZUxpc3Q6CiAgICAgICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY29udHJvbCA9ICdUcnVlJwoKICAgICAgICAgICAgIyBjb250cm9sID0gcmVzWzBdWzBdICMnVHJ1ZScKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgZWxzZToKICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwoKICAgIGhhc2hNYXAucHV0KCdjb250cm9sJywgY29udHJvbCkKICAgIGhhc2hNYXAucHV0KCJkb2NfYmFyY19mbG93IiwganNvbi5kdW1wcyhkb2NfZGV0YWlsX2xpc3QpKQoKICAgIGlmIFRydWUgaW4gKGhhdmVfcXR0eV9wbGFuLCBoYXZlX3plcm9fcGxhbiwgaGF2ZV9tYXJrX3BsYW4sIGNvbnRyb2wpOgogICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQlNCw0L3QvdGL0Lkg0LTQvtC60YPQvNC10L3RgiDRgdC+0LTQtdGA0LbQuNGCINC/0LvQsNC90L7QstGL0LUg0YHRgtGA0L7QutC4LiDQodC/0LjRgdC+0Log0YjRgtGA0LjRhdC60L7QtNC+0LIg0LIg0L3QtdCz0L4g0L/QvtC80LXRgdGC0LjRgtGMINC90LXQu9GM0LfRjycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCfQlNC+0LrRg9C80LXQvdGC0YsnKQoKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgYmFyY29kZV9mbG93X2xpc3RlbmVyKGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CgogICAgICAgIHBhc3MKCiAgICBlbGlmIGxpc3RlbmVyID09ICJCQUNLX0JVVFRPTiI6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgtGLIikKICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9iYXJjb2RlcyI6CiAgICAgICAgcGFzcwogICAgICAgICNoYXNoTWFwLnB1dCgiU2hvd0RpYWxvZyIsICLQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0IikKCiAgICAjIGVsaWYgaGFzaE1hcC5nZXQoImV2ZW50IikgPT0gIm9uUmVzdWx0UG9zaXRpdmUiOgoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnIG9yIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdmbGRfYmFyY29kZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpCgogICAgICAgIGhhdmVfcXR0eV9wbGFuID0gaGFzaE1hcC5nZXQoJ2hhdmVfcXR0eV9wbGFuJykKICAgICAgICBoYXZlX3plcm9fcGxhbiA9IGhhc2hNYXAuZ2V0KCdoYXZlX3plcm9fcGxhbicpCiAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBoYXNoTWFwLmdldCgnaGF2ZV9tYXJrX3BsYW4nKQogICAgICAgIGNvbnRyb2wgPSBoYXNoTWFwLmdldCgnY29udHJvbCcpCgogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIHF0ZXh0ID0gJycnCiAgICAgICAgICAgIElOU0VSVCBJTlRPIFJTX2JhcmNfZmxvdyAoaWRfZG9jLCBiYXJjb2RlKSBWQUxVRVMgKD8sPykKICAgICAgICAgICAgJycnCiAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LChkb2MuaWRfZG9jLCBiYXJjb2RlKSkKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOgogICAgICAgIGRvYyA9IHVpX2dsb2JhbC5Sc19kb2MKICAgICAgICBkb2MuaWRfZG9jID0gaGFzaE1hcC5nZXQoJ2lkX2RvYycpCiAgICAgICAgZG9jLm1hcmtfdmVyaWZpZWQoZG9jLCAxKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHRpbWVyX3VwZGF0ZShoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdXJsID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICN1cmwgPSAnaHR0cDovLzE5Mi4xNjguMS43Ny9OU0kvaHMvc2ltcGxlX2FjY291bnRpbmcvZGF0YScKCiAgICAjIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQntCx0LzQtdC9JykgI3VybCkKICAgIHJlc3VsdCA9IGh0dHBfZXhjaGFuZ2UudGltZXJfc2VydmVyX2xvYWRfZGF0YSh1cmwpCiAgICAjIGlmIHJlc3VsdC5nZXQoJ0Vycm9yJyk6CiAgICAjICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbG9nJywgKQoKCiAgICAjIHRyeToKICAgICMgICAgIHJlc3VsdCA9IGh0dHBfZXhjaGFuZ2Uuc2VydmVyX2xvYWRfZGF0YSh1cmwpCiAgICAjIGV4Y2VwdDoKICAgICMgICAgIHJhaXNlICfQntGI0LjQsdC60LAg0LfQsNC/0YDQvtGB0LAg0LogSFRUUCcKICAgICMgaWYgcmVzdWx0WydzdGF0dXNfY29kZSddID09MjAwOgogICAgIyAgICAgaWYgcmVzdWx0LmdldCgnYmF0Y2gnKSBpcyBub3QgTm9uZToKICAgICMgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ2JhdGNoJywgcmVzdWx0LmdldCgnYmF0Y2gnKSxUcnVlKQogICAgIyAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnbnVtYmVyX29mX3JlY2VpdmVkJywnMCcsIFRydWUpCiAgICAjCiAgICAjICAgICBpZiByZXN1bHQuZ2V0KCdyZXNfZm9yX3NxbCcpIGlzIG5vdCBOb25lOgogICAgIwogICAgIyAgICAgICAgIGlmIHJzX3NldHRpbmdzLmdldCgnYmF0Y2gnKSBpcyBub3QgTm9uZTogICPQnNGLINCy0YvQv9C+0LvQvdGP0LXQvCDQv9Cw0LrQtdGCINC30LDQs9GA0YPQt9C60LgsINC00LDQvdC90YvQtSDRgNCw0LfQsdC40YLRiyDQvdCwINC90LXRgdC60L7Qu9GM0LrQviDRhNCw0LnQu9C+0LIsINC40YUg0LrQvtC70LjRh9C10YHRgtCy0L4g0LIgYmF0Y2gKICAgICMgICAgICAgICAgICAgbnVtYmVyX29mX3JlY2VpdmVkID0gMCBpZiByc19zZXR0aW5ncy5nZXQoJ251bWJlcl9vZl9yZWNlaXZlZCcpPT0gJ25vdCBmb3VuZCcgZWxzZSBpbnQocnNfc2V0dGluZ3MuZ2V0KCdudW1iZXJfb2ZfcmVjZWl2ZWQnKSkKICAgICMgICAgICAgICAgICAgdG90YWxfcmVjZWl2ZWQgPSBpbnQocnNfc2V0dGluZ3MuZ2V0KCdiYXRjaCcpKQogICAgIyAgICAgICAgICAgICBudW1iZXJfb2ZfcmVjZWl2ZWQgPSsxCiAgICAjICAgICAgICAgZWxzZToKICAgICMgICAgICAgICAgICAgdG90YWxfcmVjZWl2ZWQgPSBOb25lCiAgICAjCiAgICAjICAgICAgICAgc3FsX2Vycm9yID0gRmFsc2UKICAgICMgICAgICAgICBlcnJvcl9wb29sID0gW10KICAgICMgICAgICAgICBmb3Iga2V5IGluIHJlc3VsdFsncmVzX2Zvcl9zcWwnXToKICAgICMgICAgICAgICAgICAgdHJ5OgogICAgIyAgICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoa2V5KQogICAgIyAgICAgICAgICAgICAgICAgIyByZXR1cm4gJ29rJwogICAgIyAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAjICAgICAgICAgICAgICAgICBzcWxfZXJyb3IgPSBUcnVlCiAgICAjICAgICAgICAgICAgICAgICBlcnJvcl9wb29sLmFwcGVuZChlLmFyZ3NbMF0pCiAgICAjCiAgICAjCiAgICAjICAgICAgICAgaWYgdG90YWxfcmVjZWl2ZWQ6CiAgICAjICAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQmNC00LXRgiDQt9Cw0LPRgNGD0LfQutCwINCx0L7Qu9GM0YjQvtCz0L4g0L7QsdGK0LXQvNCwINC00LDQvdC90YvRhS4g0J/QvtC70YPRh9C10L3QviAnKyBzdHIobnVtYmVyX29mX3JlY2VpdmVkKjUwMDAwKSArICfQuNC3LCDQv9GA0LjQvNC10YDQvdC+ICcrIHN0cih0b3RhbF9yZWNlaXZlZCo1MDAwMCkpCiAgICAjICAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnbnVtYmVyX29mX3JlY2VpdmVkJyxzdHIobnVtYmVyX29mX3JlY2VpdmVkKSwgVHJ1ZSkKICAgICMKICAgICMgICAgICAgICBpZiBzcWxfZXJyb3I6CiAgICAjICAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnZXJyb3JfbG9nJywgc3RyKGVycm9yX3Bvb2wpLCBUcnVlKQogICAgIyAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0J/RgNC4INC30LDQs9GA0YPQt9C60LUg0LHRi9C70Lgg0L7RiNC40LHQutC4LiDQn9GA0L7QstC10YDRjNGC0LUg0LjRhSDQsiDQvdCw0YHRgtGA0L7QudC60LDRhSAo0LrQvdC+0L/QutCwINC/0L7RgdC80L7RgtGA0LXRgtGMINC+0YjQuNCx0LrQuCknKQogICAgIyAgICAgaWYgaGFzaE1hcC5nZXQoJ2N1cnJlbnRfc2NyZWVuX25hbWUnKSA9PSAn0JTQvtC60YPQvNC10L3RgtGLJzoKICAgICMgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgICMgICAgICAgICAjZG9jc19vbl9zdGFydChoYXNoTWFwKQogICAgIyAgICAgI3RpbGVzX29uX3N0YXJ0KGhhc2hNYXApCiAgICAjICAgICAgICAgZG9jc19hZHJfb25fc3RhcnQoaGFzaE1hcCkKICAgICMgICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsJycpCiAgICAjCiAgICAjIGVsc2U6CiAgICAjCiAgICAjICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCBzdHIocmVzdWx0WydlcnJvcl9wb29sJ10pKQoKICAgIHF0ZXh0ID0gJycnU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MgV0hFUkUgdmVyaWZpZWQgPSAxICBhbmQgKHNlbnQgPD4gMSBvciBzZW50IGlzIG51bGwpCiAgICAgICAgICAgICAgICBVTklPTgogICAgICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzIFdIRVJFIHZlcmlmaWVkID0gMSAgYW5kIChzZW50IDw+IDEgb3Igc2VudCBpcyBudWxsKScnJwogICAgcmVzICA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LE5vbmUsVHJ1ZSkKCiAgICBpZiByZXM6CiAgICAgICAgZG9jX2xpc3QgPSBbXQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGRvY19saXN0LmFwcGVuZCgnIicrIGVsWydpZF9kb2MnXSsnIicpCiAgICAgICAgZG9jX2luX3N0ciA9ICcsJy5qb2luKGRvY19saXN0KQogICAgICAgICNodHBwYXJhbXMgPSB7J3VzZXJuYW1lJzpoYXNoTWFwLmdldCgnb25saW5lVXNlcicpLCAncGFzc3dvcmQnOmhhc2hNYXAuZ2V0KCdvbmxpbmVQYXNzJyksICd1cmwnOnVybH0KICAgICAgICBhbnN3ZXIgPSBodHRwX2V4Y2hhbmdlLnBvc3RfY2hhbmdlc190b19zZXJ2ZXIoZG9jX2luX3N0ciAsIHVybCkKICAgICAgICBpZiBhbnN3ZXIuZ2V0KCdFcnJvcicpIGlzIG5vdCBOb25lOgogICAgICAgICAgICB1aV9nbG9iYWwud3JpdGVfZXJyb3Jfb25fbG9nKHN0cihhbnN3ZXIuZ2V0KCdFcnJvcicpKSkKICAgICAgICBlbHNlOgoKICAgICAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2Fkcl9kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgc2V0dGluZ3NfZXJyb3JzX29uX3N0YXJ0KGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgZmlsdGVyX3ZhbHVlID0gJycKICAgIGZpbHRlcl9maWVsZHMgPSAoJ2xvZycsKQogICAgaGFzaE1hcC5wdXQoJ2NhcmRzJywgZ2V0X3RhYmxlX2NhcmRzKCdFcnJvcl9sb2cnLCBmaWx0ZXJfZmllbGRzLCBmaWx0ZXJfdmFsdWUpKQoKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgc2V0dGluZ3NfZXJyb3JzX29uX2NsaWNrKGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpCiAgICBpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICAgICAgI2hhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2NsZWFyX2Vycic6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdlcnJvcl9sb2cnLCcnKQogICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9sb2cnLCcnKQogICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgcGFzcwoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgY3VycmVudF9jYXJkID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiY3VycmVudF9jYXJkIikpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnU2VhcmNoJzoKICAgICAgICBmaWx0ZXJfdmFsdWUgPSBoYXNoTWFwLmdldCgnU2VhcmNoU3RyaW5nJykKICAgICAgICBpZiBsZW4oZmlsdGVyX3ZhbHVlKSA+IDI6CiAgICAgICAgICAgIGZpbHRlcl9maWVsZHMgPSBoYXNoTWFwLmdldCgnZmlsdGVyX2ZpZWxkcycpLnNwbGl0KCc7JykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2NhcmRzJywgZ2V0X3RhYmxlX2NhcmRzKGhhc2hNYXAuZ2V0KCd0YWJsZV9mb3Jfc2VsZWN0JyksIGZpbHRlcl9maWVsZHMsIGZpbHRlcl92YWx1ZSkpCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQogICAgICAgICMgdW5pdmVyc2FsX2NhcmRzX29uX3N0YXJ0KGhhc2hNYXApCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCk6CiAgICBodHRwX3NldHRpbmdzID0gewogICAgJ3VybCcgOiByc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgJ3VzZXInIDogcnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAncGFzcycgOiByc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICdkZXZpY2VfbW9kZWwnIDogaGFzaE1hcC5nZXQoJ0RFVklDRV9NT0RFTCcpLAogICAgJ2FuZHJvaWRfaWQnOmhhc2hNYXAuZ2V0KCdBTkRST0lEX0lEJyksCiAgICAndXNlcl9uYW1lJzogcnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgIHJldHVybiBodHRwX3NldHRpbmdzCgpkZWYgaHR0cF9zZXR0aW5nc19vbl9zdGFydChoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgdXJsID0gaGFzaE1hcC5nZXQoJ3VybCcpCiAgICBoYXNoTWFwLnB1dCgnYnRuX3Rlc3RfY29ubmVjdGlvbicsICfQotC10YHRgiDRgdC+0LXQtNC40L3QtdC90LjRjycpCiAgICBpZiB1cmwgPT0gJycgb3IgJ25vdCBmb3VuZCc6ICAj0J7QsdC90L7QstC70Y/QtdC8INGC0L7Qu9GM0LrQviDQtdGB0LvQuCDRgNCw0L3QtdC1INC90LUg0YPRgdGC0LDQvdC+0LLQu9C10L3RiwogICAgICAgIGh0dHBfc2V0dGluZ3MgPSBnZXRfaHR0cF9zZXR0aW5ncyhoYXNoTWFwKQogICAgICAgIGhhc2hNYXAucHV0KCd1cmwnLCAgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VybCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1cmwnXSwgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkgIyAgKQogICAgICAgIGhhc2hNYXAucHV0KCd1c2VyJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXNlciddLCBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKQogICAgICAgIGhhc2hNYXAucHV0KCdwYXNzJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3Bhc3MnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sncGFzcyddLCBwYXNzd29yZD1UcnVlKS50b19qc29uKCkpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3VzZXJfbmFtZScsdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXJfbmFtZScsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyX25hbWUnXSwgcGFzc3dvcmQ9RmFsc2UpLnRvX2pzb24oKSkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGh0dHBfc2V0dGluZ3Nfb25fY2xpY2soaGFzaE1hcCwgIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykKICAgIGlmIGxpc3RlbmVyID09ICdidG5fc2F2ZSc6CiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdVUkwnLCBoYXNoTWFwLmdldCgndXJsJyksVHJ1ZSkKICAgICAgICByc19zZXR0aW5ncy5wdXQoJ1VTRVInLCBoYXNoTWFwLmdldCgndXNlcicpLCBUcnVlKQogICAgICAgIHJzX3NldHRpbmdzLnB1dCgnUEFTUycsIGhhc2hNYXAuZ2V0KCdwYXNzJyksIFRydWUpCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBoYXNoTWFwLmdldCgndXNlcl9uYW1lJyksIFRydWUpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2NhbmNlbCc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICBiYXJjb2RlID0gaGFzaE1hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhMicpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBiYXJjX3N0cnVjdCA9IGpzb24ubG9hZHMoYmFyY29kZSkKCiAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnVVJMJywgYmFyY19zdHJ1Y3QuZ2V0KCd1cmwnKSwgVHJ1ZSkKICAgICAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdVU0VSJywgYmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJyksIFRydWUpCiAgICAgICAgICAgIHJzX3NldHRpbmdzLnB1dCgnUEFTUycsIGJhcmNfc3RydWN0LmdldCgncGFzcycpLCBUcnVlKQogICAgICAgICAgICByc19zZXR0aW5ncy5wdXQoJ3VzZXJfbmFtZScsIGJhcmNfc3RydWN0LmdldCgndXNlcl9uYW1lJyksIFRydWUpCgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndXJsJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VybCcsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VybCcpKS50b19qc29uKCkpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd1c2VyJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJykpLnRvX2pzb24oKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3Bhc3MnLCB1aV9mb3JtX2RhdGEuTW9kZXJuRmllbGQoaGludD0ncGFzcycsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3Bhc3MnKSkudG9fanNvbigpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgndXNlcl9uYW1lJywgdWlfZm9ybV9kYXRhLk1vZGVybkZpZWxkKGhpbnQ9J3VzZXJfbmFtZScsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VzZXJfbmFtZScpKS50b19qc29uKCkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0L3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgUVIt0LrQvtC00LAnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Rlc3RfY29ubmVjdGlvbic6CiAgICAgICAgIy9jb21tdW5pY2F0aW9uX3Rlc3QKICAgICAgICBodHRwID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGh0dHBbJ3VybCddICsgJy9zaW1wbGVfYWNjb3VudGluZy9jb21tdW5pY2F0aW9uX3Rlc3Q/YW5kcm9pZF9pZD0nICsgaHR0cFsnYW5kcm9pZF9pZCddLCBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICAgICAgICAgIHBhcmFtcz17J3VzZXJfbmFtZSc6IGh0dHBbJ3VzZXJfbmFtZSddLCAnZGV2aWNlX21vZGVsJzogaHR0cFsnZGV2aWNlX21vZGVsJ119KQogICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnYnRuX3Rlc3RfY29ubmVjdGlvbicsICfQodC+0LXQtNC40L3QtdC90LjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC+JykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Ch0L7QtdC00LjQvdC10L3QuNC1INGD0YHRgtCw0L3QvtCy0LvQtdC90L4nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdidG5fdGVzdF9jb25uZWN0aW9uJywgJ9Ci0LXRgdGCINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3RvYXN0JywgJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0YPRgdGC0LDQvdC+0LLQuNGC0Ywg0YHQvtC10LTQuNC90LXQvdC40LUnKQoKICAgIHJldHVybiBoYXNoTWFwCgojINCX0LDQv9C+0LvQvdC10L3QuNC1INGB0L/QuNGB0LrQsCDQtNC+0LrRg9C80LXQvdGC0L7QsgpkZWYgcmVmaWxsX2Fkcl9kb2NzX2xpc3QoZmlsdGVyPScnKToKICAgIGRvY19saXN0ID0gdWlfZm9ybV9kYXRhLmdldF9kb2NfY2FyZChyc19zZXR0aW5ncywgJzvQntGC0LrRgNGL0YLRjCDQvtGC0LHQvtGAO9Ce0YLQutGA0YvRgtGMINGA0LDQt9C80LXRidC10L3QuNC1JykKICAgIGRvY19saXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXSA9IFtdCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfYWRyX2RvY19xdWVyeShmaWx0ZXIpCgogICAgaWYgZmlsdGVyID09IE5vbmUgb3IgZmlsdGVyID09ICcnIG9yIGZpbHRlciA9PSAn0JLRgdC1JzoKICAgICAgICByZXN1bHRzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChmaWx0ZXIsKSkKCiAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgY29tcGxldGVkID0gJ3RydWUnIGlmIHJlY29yZFs2XSA9PSAxIGVsc2UgJ2ZhbHNlJwogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiA9ICd0cnVlJyBpZiByZWNvcmRbOF0gPT0gMSBlbHNlICdmYWxzZScKCiAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICdjb21wbGV0ZWQnOiBjb21wbGV0ZWQsCiAgICAgICAgICAgICd0eXBlJzogc3RyKHJlY29yZFsxXSksCiAgICAgICAgICAgICdudW1iZXInOiBzdHIocmVjb3JkWzJdKSwKICAgICAgICAgICAgJ2RhdGEnOiBzdHIocmVjb3JkWzNdKSwKICAgICAgICAgICAgJ2tleSc6IHJlY29yZFswXSwKICAgICAgICAgICAgJ3dhcmVob3VzZSc6IHJlY29yZFs1XSwKICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IGFkZF9tYXJrX3NlbGVjdGlvbgogICAgICAgIH0KICAgICAgICBkb2NfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgIHJldHVybiBqc29uLmR1bXBzKGRvY19saXN0KQoKCmRlZiBkb2NzX2Fkcl9vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAjINCX0LDQv9C+0LvQvdC40Lwg0L/QvtC70LUg0YTQuNC70YzRgtGA0LAg0L/QviDQstC40LTRgyDQtNC+0LrRg9C80LXQvdGC0L7QsgogICAgZG9jX3R5cGVfbGlzdCA9IFsn0JLRgdC1Jywn0J7RgtCx0L7RgCcsJ9Cg0LDQt9C80LXRidC10L3QuNC1Jywn0J/QtdGA0LXQvNC10YnQtdC90LjQtSddCiAgICBoYXNoTWFwLnB1dCgnZG9jX2Fkcl90eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKICAgICNoYXNoTWFwLnB1dCgnZmxkX251bWJlcicsJzEnKQoKICAgICMgaGFzaE1hcC5wdXQoJ2RvY190eXBlX2NsaWNrJywgJ9CS0YHQtScpCiAgICAjINCV0YHQu9C4INCS0YvQt9C+0LIg0Y3QutGA0LDQvdCwINC40Lcg0LzQtdC90Y4g0L/Qu9C40YLQvtC6IC0g0L7QsdGA0LDQsdC+0YLQsNC10LwKCiAgICAjINCf0LXRgNC10LfQsNC/0L7Qu9C90LjQvCDRgdC/0LjRgdC+0Log0LTQvtC60YPQvNC10L3RgtC+0LIKICAgIGlmIGhhc2hNYXAuZ2V0KCdkb2NfYWRyX3R5cGVfY2xpY2snKSA9PSBOb25lOgogICAgICAgIGxzID0gcmVmaWxsX2Fkcl9kb2NzX2xpc3QoKQogICAgZWxzZToKICAgICAgICBscyA9IHJlZmlsbF9hZHJfZG9jc19saXN0KGhhc2hNYXAuZ2V0KCdkb2NfYWRyX3R5cGVfY2xpY2snKSkKICAgIGhhc2hNYXAucHV0KCJkb2NBZHJDYXJkcyIsIGxzKQoKICAgIHJldHVybiBoYXNoTWFwCgpkZWYgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsIGZpbHRlciA9ICcnKToKICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiZG9jQWRyQ2FyZHMiKSkKICAgIGN1cnJlbnRfZG9jID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0cildCgogICAgIyBpZF9kb2MgPSBjdXJyZW50X2RvY1sna2V5J10KICAgIGhhc2hNYXAucHV0KCdpZF9kb2MnLCBjdXJyZW50X2RvY1sna2V5J10pCiAgICBoYXNoTWFwLnB1dCgnZG9jX3R5cGUnLCBjdXJyZW50X2RvY1sndHlwZSddKQogICAgaGFzaE1hcC5wdXQoJ2RvY19uJywgY3VycmVudF9kb2NbJ251bWJlciddKQogICAgaGFzaE1hcC5wdXQoJ2RvY19kYXRlJywgY3VycmVudF9kb2NbJ2RhdGEnXSkKICAgIGhhc2hNYXAucHV0KCd3YXJlaG91c2UnLCBjdXJyZW50X2RvY1snd2FyZWhvdXNlJ10pCiAgICBmaWx0ZXIgPSAnaW4nICBpZiBjdXJyZW50X2RvY1sndHlwZSddID09ICfQoNCw0LfQvNC10YnQtdC90LjQtScgZWxzZSAnb3V0JwogICAgaWYgZmlsdGVyOgogICAgICAgIGhhc2hNYXAucHV0KCd0YWJsZV90eXBlX2ZpbHRlcicsIGZpbHRlcikKCgoKZGVmIGRvY3NfYWRyX29uX3NlbGVjdChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICAgICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXApCiAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJkb2NfYWRyX3R5cGVfY2xpY2siOgoKICAgICAgICAgICAgbHMgPSByZWZpbGxfYWRyX2RvY3NfbGlzdChoYXNoTWFwLmdldCgnZG9jX2Fkcl90eXBlX2NsaWNrJykpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdkb2NDYXJkcycsIGxzKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIGxheW91dF9saXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgICAgICAjINCd0LDRhdC+0LTQuNC8IElEINC00L7QutGD0LzQtdC90YLQsAogICAgICAgICAgICBjdXJyZW50X2RvYyA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRfZGF0YSIpKQogICAgICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfYWRyX2RvYwogICAgICAgICAgICBkb2MuaWRfZG9jID0gY3VycmVudF9kb2NbJ2tleSddCgogICAgICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ0NoZWNrQm94MSc6CiAgICAgICAgICAgICAgICBpZiBjdXJyZW50X2RvY1snY29tcGxldGVkJ10gPT0gJ2ZhbHNlJzoKICAgICAgICAgICAgICAgICAgICBkb2MubWFya192ZXJpZmllZChkb2MsIDEpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMCkKCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQn9C+0LTRgtCy0LXRgNC00LjRgtGMJzoKICAgICAgICAgICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKGRvYywgMSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9CU0L7QutGD0LzQtdC90YLRiycpCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICAgICAgZG9jLmNsZWFyX2JhcmNvZGVfZGF0YShkb2MpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgndG9hc3QnLCAn0JTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCDQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQvtGH0LjRidC10L3RiycpCiAgICAgICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQo9C00LDQu9C40YLRjCc6CiAgICAgICAgICAgICAgICBkb2MuZGVsZXRlX2RvYyhkb2MpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICAgICAgZG9jLmRlbGV0ZV9kb2MoZG9jKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7RgtC60YDRi9GC0Ywg0L7RgtCx0L7RgCc6CgogICAgICAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsICdvdXQnKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQogICAgICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7RgtC60YDRi9GC0Ywg0YDQsNC30LzQtdGJ0LXQvdC40LUnOgogICAgICAgICAgICAgICAgb3Blbl9hZHJfZG9jX3RhYmxlKGhhc2hNYXAsICdpbicpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gImJ0bl9hZGRfZG9jIjoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J3QvtCy0YvQuSDQtNC+0LrRg9C80LXQvdGCJykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpCgogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCdTaG93U2NyZWVuJywgJ9Cd0L7QstGL0Lkg0LTQvtC60YPQvNC10L3RgicpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgbmV3X2Fkcl9kb2Nfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2RvY19hZHJfdHlwZV9zZWxlY3QnKSA9PSBOb25lOgogICAgICAgICMg0JfQsNC/0L7Qu9C90LjQvCDQv9C+0LvQtSDRhNC40LvRjNGC0YDQsCDQv9C+INCy0LjQtNGDINC00L7QutGD0LzQtdC90YLQvtCyCiAgICAgICAgZG9jX3R5cGVfbGlzdCA9IFsn0J7RgtCx0L7RgCcsICfQoNCw0LfQvNC10YnQtdC90LjQtScsICfQn9C10YDQtdC80LXRidC10L3QuNC1J10KICAgICAgICBoYXNoTWFwLnB1dCgnZG9jX2Fkcl90eXBlX3NlbGVjdCcsICc7Jy5qb2luKGRvY190eXBlX2xpc3QpKQoKCiAgICBpZiBoYXNoTWFwLmdldCgnd2FyZWhvdXNlJykgPT0gTm9uZToKICAgICAgICAjZmxkX2NvdW50cmFnZW50ID0gdWlfZ2xvYmFsLmdldF9uYW1lX2xpc3QoJ1JTX3dhcmVob3VzZXMnKQogICAgICAgIGhhc2hNYXAucHV0KCd3YXJlaG91c2UnLCAn0KHQutC70LDQtCcpICNkb2Nfd2FyZWhvdXNlCgogICAgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoJ2RvY19kYXRlJyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2RvY19kYXRlJywgJzAxLjAxLjIwMjInKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIG5ld19hZHJfZG9jX29uX3NlbGVjdChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBsaXN0ZW5lciA9IGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpCiAgICB0eXBlID0gaGFzaE1hcC5nZXQoJ2RvY190eXBlX2NsaWNrJykKICAgIGlmIG5vdCB0eXBlIG9yIHR5cGU9PSfQktGB0LUnOgogICAgICAgIHR5cGUgPSAn0J7RgtCx0L7RgCcKICAgIGZsZF9udW1iZXIgPSBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCgogICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgaWYgbm90IGZsZF9udW1iZXI6CgogICAgICAgICAgICBpZCA9IHVpX2dsb2JhbC5Sc19hZHJfZG9jLmdldF9uZXdfaWQoMSkKICAgICAgICAgICAgIyBpZCA9IChmJ3tpZDowNH0nKQogICAgICAgICAgICAjIGlkID0gInswOjA+NH0iLmZvcm1hdChpZCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZCA9IGZsZF9udW1iZXIKCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1aV9nbG9iYWwuUnNfYWRyX2RvYy5hZGQoJzAxJywgKGlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkLCAgIyBoYXNoTWFwLmdldCgnZmxkX251bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnZmxkX2RhdGEnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5nZXRfYnlfbmFtZShoYXNoTWFwLmdldCgnZG9jX3dhcmVob3VzZScpLCAnUlNfd2FyZWhvdXNlcycpKSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JTQvtC60YPQvNC10L3RgtGLJykKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsICfQndC+0LzQtdGAINC00L7QutGD0LzQtdC90YLQsCDQvdC10YPQvdC40LrQsNC70LXQvSEnKQoKCiAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fY2FuY2VsJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnZmxkX2RhdGEnOgogICAgICAgIGhhc2hNYXAucHV0KCdkb2NfZGF0ZScsIGhhc2hNYXAuZ2V0KCdmbGRfZGF0YScpKQogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQogICAgZWxpZiBsaXN0ZW5lciA9PSdidG5fc2VsZWN0X3dhcmVob3VzZSc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ3RhYmxlX2Zvcl9zZWxlY3QnLCAnUlNfd2FyZWhvdXNlcycpICAjINCi0LDQsdC70LjRhtCwINC00LvRjyDQstGL0LHQvtGA0LAg0LfQvdCw0YfQtdC90LjRjwogICAgICAgIGhhc2hNYXAucHV0KCdTZXRSZXN1bHRMaXN0ZW5lcicsICdzZWxlY3RfY2VsbF92YWx1ZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2ZpbHRlcl9maWVsZHMnLCAnbmFtZScpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dQcm9jZXNzUmVzdWx0JywgJ9Cj0L3QuNCy0LXRgNGB0LDQu9GM0L3Ri9C5INGB0L/RgNCw0LLQvtGH0L3QuNC6fNCh0L/RgNCw0LLQvtGH0L3QuNC6JykKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3NlbGVjdF9jZWxsX3ZhbHVlJzoKICAgICAgICBpZiBoYXNoTWFwLmdldCgndGFibGVfZm9yX3NlbGVjdCcpID09ICdSU193YXJlaG91c2VzJzoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3dhcmVob3VzZScsIGhhc2hNYXAuZ2V0KCdjdXJyZW50X25hbWUnKSkgICMgZmxkX2NvdW50cmFnZW50CgogICAgcmV0dXJuIGhhc2hNYXAKCmRlZiB1bml2ZXJzYWxfY2FyZHNfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgZmlsdGVyX3ZhbHVlID1oYXNoTWFwLmdldCgnU2VhcmNoU3RyaW5nJykKICAgIGlmIGZpbHRlcl92YWx1ZToKICAgICAgIGZpbHRlcl9maWVsZHMgPSBoYXNoTWFwLmdldCgnZmlsdGVyX2ZpZWxkcycpLnNwbGl0KCc7JykKICAgIGVsc2U6CiAgICAgICAgZmlsdGVyX2ZpZWxkcyA9IGxpc3QoKQogICAgaGFzaE1hcC5wdXQoJ2NhcmRzJywgZ2V0X3RhYmxlX2NhcmRzKGhhc2hNYXAuZ2V0KCd0YWJsZV9mb3Jfc2VsZWN0JyksZmlsdGVyX2ZpZWxkcyxmaWx0ZXJfdmFsdWUpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHVuaXZlcnNhbF9jYXJkc19saXN0ZW5lcihoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgbGlzdGVuZXIgPSBoYXNoTWFwLmdldCgibGlzdGVuZXIiKQoKICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICBjdXJyZW50X3N0ciA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIikKICAgICAgICBqbGlzdCA9IGpzb24ubG9hZHMoaGFzaE1hcC5nZXQoImNhcmRzIikpCiAgICAgICAgY3VycmVudF9lbGVtID0gamxpc3RbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjdXJyZW50X3N0cildCiAgICAgICAgaGFzaE1hcC5yZW1vdmUoJ1NlYXJjaFN0cmluZycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfaWQnLGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2N1cnJlbnRfbmFtZScsIGN1cnJlbnRfZWxlbVsnbmFtZSddKQogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCgoKICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gaGFzaE1hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgIyDQndCw0YXQvtC00LjQvCBJRCDQtNC+0LrRg9C80LXQvdGC0LAKICAgICAgICBjdXJyZW50X2NhcmQgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCJjdXJyZW50X2NhcmQiKSkKCgogICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnJlbW92ZSgnU2VhcmNoU3RyaW5nJykKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9pZCcsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCiAgICBlbGlmIGxpc3RlbmVyID09ICdTZWFyY2gnOgogICAgICAgIGZpbHRlcl92YWx1ZSA9IGhhc2hNYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKQogICAgICAgIGlmIGxlbihmaWx0ZXJfdmFsdWUpID4gMjoKICAgICAgICAgICAgZmlsdGVyX2ZpZWxkcyA9IGhhc2hNYXAuZ2V0KCdmaWx0ZXJfZmllbGRzJykuc3BsaXQoJzsnKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnY2FyZHMnLCBnZXRfdGFibGVfY2FyZHMoaGFzaE1hcC5nZXQoJ3RhYmxlX2Zvcl9zZWxlY3QnKSwgZmlsdGVyX2ZpZWxkcywgZmlsdGVyX3ZhbHVlKSkKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdSZWZyZXNoU2NyZWVuJywnJykKICAgICAgICAjdW5pdmVyc2FsX2NhcmRzX29uX3N0YXJ0KGhhc2hNYXApCgogICAgcmV0dXJuIGhhc2hNYXAKCgojINCU0L7QsdCw0LLQu9C10L0g0L/QsNGA0LDQvNC10YLRgCAibm9fbGFiZWwiCmRlZiBnZXRfdGFibGVfY2FyZHModGFibGVfbmFtZTogc3RyLCBmaWx0ZXJfZmllbGRzPWxpc3QoKSwgZmlsdGVyX3ZhbHVlPScnLCBleGNsdWRlX2xpc3Q9bGlzdCgpLCBub19sYWJlbD1GYWxzZSwgc3RydWN0X3ZpZXc6bGlzdCA9IGxpc3QoKSk6CiAgICAjINCf0L7Qu9GD0YfQuNC8INGB0L/QuNGB0L7QuiDQv9C+0LvQtdC5INGC0LDQsdC70LjRhtGLCiAgICAjIHRhYmxlX25hbWUgPSAnUlNfZ29vZHMnCiAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChmIlBSQUdNQSB0YWJsZV9pbmZvKHt0YWJsZV9uYW1lfSkiKQogICAgZmllbGRzID0gW2ZbMV0gZm9yIGYgaW4gcmVzXQogICAgIyDQodC70L7QstCw0YDRjCDRgNGD0YHRgdC60LjRhSDQuNC80LXQvSDQv9C+0LvQtdC5CiAgICBhbGlhc2VzID0gdWlfZm9ybV9kYXRhLmZpZWxkc19hbGlhc19kaWN0KCkKICAgICMg0KHQu9C+0LLQsNGA0Ywg0L/QvtC70LXQuS3RgdGB0YvQu9C+0Log0L3QsCDRgtCw0LHQu9C40YbRiwogICAgdGFibGVzX2RpY3QgPSB1aV9mb3JtX2RhdGEudGFibGVfbmFtZXNfZGljdCgpCgogICAgIyDQodC+0LfQtNCw0LTQuNC8INC30LDQv9GA0L7RgSDQuiDRgtCw0LHQu9C40YbQtS4g0KHRgdGL0LvQvtGH0L3Ri9C1INC/0L7Qu9GPINC30LDQvNC10L3QuNC8INC90LAg0L3QsNC40LzQtdC90L7QstCw0L3QuNC1INC40Lcg0YHQstGP0LfQsNC90L3Ri9GFINGC0LDQsdC70LjRhgogICAgY2FyZF9lbGVtID0gdWlfZm9ybV9kYXRhLmdldF9lbGVtX2RpY3QoMjQpCiAgICBjYXJkcyA9IHVpX2Zvcm1fZGF0YS5nZXRfdW5pdmVyc2FsX2NhcmQoKQoKICAgIHFmaWVsZF90ZXh0ID0gW10KICAgIGxlZnRfam9pbnNfbGlzdCA9IFtdCiAgICBmb3IgZWwgaW4gZmllbGRzOgogICAgICAgIGlmIGVsIG5vdCBpbiBleGNsdWRlX2xpc3Q6CiAgICAgICAgICAgIGxpbmtfdGFibGVfbmFtZSA9IHRhYmxlc19kaWN0LmdldChlbCkKICAgICAgICAgICAgcWZpZWxkX3RleHQuYXBwZW5kKHRhYmxlX25hbWUgKyAnLicgKyBlbCkKCiAgICAgICAgICAgICMg0JTQvtC/0L7Qu9C90LjQvCDQstGL0YXQvtC00L3Rg9GOINGB0YLRgNGD0LrRgtGD0YDRgyDQv9C+0LvRj9C80Lgg0YLQsNCx0LvQuNGG0Ys6CiAgICAgICAgICAgIGFsaWFzZXNfZWxlbSA9IGFsaWFzZXMuZ2V0KGVsKQogICAgICAgICAgICBpZiBhbGlhc2VzX2VsZW06ICAjINCU0LvRjyDRjdGC0L7Qs9C+INC/0L7Qu9GPINC/0YDQtdC00YPRgdC80L7RgtGA0LXQvdCwINC90LDRgdGC0YDQvtC50LrQsAogICAgICAgICAgICAgICAgaWYgbm90IGFsaWFzZXNfZWxlbVsnbmFtZSddID09ICdrZXknOiAgIyDQlNC70Y8g0LrQu9GO0YfQsCDQvdCw0YHRgtGA0L7QudC60Lgg0L3QtSDQvdGD0LbQvdGLCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IG5vX2xhYmVsOgogICAgICAgICAgICAgICAgICAgICAgICAjINC00L7QsdCw0LLQuNC8INC+0L/QuNGB0LDQvdC40LUg0L/QvtC70Y86Li4uCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVmFsdWUnXSA9IGFsaWFzZXNfZWxlbVsnbmFtZSddCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dFNpemUnXSA9IHJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpICAjIGFsaWFzZXNfZWxlbVsndGV4dF9zaXplJ10KICAgICAgICAgICAgICAgICAgICAgICAgY2FyZF9lbGVtWydUZXh0Qm9sZCddID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2xheW91dCddWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddLmFwcGVuZChjYXJkX2VsZW0uY29weSgpKQoKICAgICAgICAgICAgICAgICAgICAjINCi0LXQv9C10YDRjCDRgdCw0LzQviDQv9C+0LvQtToKICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW1bJ1ZhbHVlJ10gPSAnQCcgKyBlbAogICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dFNpemUnXSA9IHJzX3NldHRpbmdzLmdldChhbGlhc2VzX2VsZW1bJ3RleHRfc2l6ZSddKQogICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dEJvbGQnXSA9IGFsaWFzZXNfZWxlbVsnVGV4dEJvbGQnXQogICAgICAgICAgICBlbHNlOiAgIyDQmNC90LDRh9C1INC/0YDQvtGB0YLQviDQtNC+0LHQsNCy0LjQvCDQtdCz0L4g0YHQviDRgdGC0LDQvdC00LDRgNGC0L3Ri9C80Lgg0L3QsNGB0YLRgNC+0LnQutCw0LzQuAogICAgICAgICAgICAgICAgY2FyZF9lbGVtWydWYWx1ZSddID0gJ0AnICsgZWwKCiAgICAgICAgICAgIGlmIGxpbmtfdGFibGVfbmFtZToKICAgICAgICAgICAgICAgICMg0K3RgtC+INGB0YHRi9C70LrQsCDQvdCwINGC0LDQsdC70LjRhtGDCiAgICAgICAgICAgICAgICBxZmllbGRfdGV4dC5hcHBlbmQobGlua190YWJsZV9uYW1lICsgZicubmFtZSBhcyB7bGlua190YWJsZV9uYW1lfV9uYW1lJykKICAgICAgICAgICAgICAgIGxlZnRfam9pbnNfbGlzdC5hcHBlbmQoZicnJwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiB7bGlua190YWJsZV9uYW1lfQogICAgICAgICAgICAgICAgICAgIE9OIHtsaW5rX3RhYmxlX25hbWV9LmlkID0ge3RhYmxlX25hbWV9LntlbH0KICAgICAgICAgICAgICAgICAgICAnJycpCiAgICAgICAgICAgICAgICBjYXJkX2VsZW1bCiAgICAgICAgICAgICAgICAgICAgJ1ZhbHVlJ10gPSBmJ0B7bGlua190YWJsZV9uYW1lfV9uYW1lJyAgIyDQotCw0Log0LrQsNC6INC/0L7Qu9C1INGB0YHRi9C70L7Rh9C90L7QtSAtINC/0LXRgNC10LjQvNC10L3Rg9C10Lwg0LXQs9C+INC60LDQuiDQsiDQt9Cw0L/RgNC+0YHQtQoKICAgICAgICAgICAgIyDQlNC+0LHQsNCy0LjQvCDQv9C+0LvQtSDQsiDQutCw0YDRgtC+0YfQutC4CiAgICAgICAgICAgIGNhcmRzWydjdXN0b21jYXJkcyddWydsYXlvdXQnXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXS5hcHBlbmQoY2FyZF9lbGVtLmNvcHkoKSkKCiAgICBxdGV4dCA9ICdTZWxlY3QgJyArICcsJy5qb2luKHFmaWVsZF90ZXh0KSArIGYnIEZST00ge3RhYmxlX25hbWV9ICcgKyAnICcuam9pbihsZWZ0X2pvaW5zX2xpc3QpCiAgICAjINCV0YHQu9C4INC10YHRgtGMINGE0LjQu9GM0YLRgNGLL9C+0YLQsdC+0YDRiyAtINC00L7QsdCw0LLQuNC8INC40YUg0LIg0LfQsNC/0YDQvtGBCiAgICBpZiBmaWx0ZXJfdmFsdWU6CiAgICAgICAgIyBjb25kaXRpb25zID0gW2Yie2ZpZWxkfSBMSUtFICcle2ZpbHRlcl92YWx1ZX0lJyIgZm9yIGZpZWxkIGluIGZpbHRlcl9maWVsZHNdCiAgICAgICAgY29uZGl0aW9ucyA9IFtmInt0YWJsZV9uYW1lfS57ZmllbGR9IExJS0UgJyV7ZmlsdGVyX3ZhbHVlfSUnIiBmb3IgZmllbGQgaW4gZmlsdGVyX2ZpZWxkc10KICAgICAgICBxdGV4dCA9IHF0ZXh0ICsgZiIgV0hFUkUgeycgT1IgJy5qb2luKGNvbmRpdGlvbnMpfSIKICAgIHJlc19xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCBOb25lLCBUcnVlKQogICAgIyBzZXR0aW5nc19nbG9iYWwuZ2V0CgogICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddID0gW10KCiAgICBmb3IgaSBpbiByZXNfcXVlcnk6CiAgICAgICAgcHJvZHVjdF9yb3cgPSB7fQogICAgICAgIGZvciB4IGluIGk6CiAgICAgICAgICAgIGlmIHggPT0gJ2lkJzoKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydrZXknXSA9IHN0cihpW3hdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dbeF0gPSBzdHIoaVt4XSkKCiAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICByZXR1cm4ganNvbi5kdW1wcyhjYXJkcykKCmNsYXNzIFVuaXZlcnNhbENhcmQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFibGVfbmFtZTogc3RyLCBmaWx0ZXJfZmllbGRzPWxpc3QoKSwgZmlsdGVyX3ZhbHVlPScnLCBleGNsdWRlX2xpc3Q9bGlzdCgpLG5vX2xhYmVsPUZhbHNlLCBzdHJ1Y3RfdmlldzpsaXN0ID0gbGlzdCgpKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5maWx0ZXJfZmllbGRzID0gZmlsdGVyX2ZpZWxkcwogICAgICAgIHNlbGYuZmlsdGVyX3ZhbHVlID0gZmlsdGVyX3ZhbHVlCiAgICAgICAgc2VsZi5leGNsdWRlX2xpc3QgPSBleGNsdWRlX2xpc3QKICAgICAgICBzZWxmLm5vX2xhYmVsID0gbm9fbGFiZWwKICAgICAgICBzZWxmLnN0cnVjdF92aWV3ID0gc3RydWN0X3ZpZXcKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoZiJQUkFHTUEgdGFibGVfaW5mbyh7dGFibGVfbmFtZX0pIikKICAgICAgICBzZWxmLmZpZWxkcyA9IFtmWzFdIGZvciBmIGluIHJlc10KICAgICAgICAjINCh0LvQvtCy0LDRgNGMINGA0YPRgdGB0LrQuNGFINC40LzQtdC9INC/0L7Qu9C10LkKICAgICAgICBzZWxmLmFsaWFzZXMgPSB1aV9mb3JtX2RhdGEuZmllbGRzX2FsaWFzX2RpY3QoKQogICAgICAgICMg0KHQu9C+0LLQsNGA0Ywg0L/QvtC70LXQuS3RgdGB0YvQu9C+0Log0L3QsCDRgtCw0LHQu9C40YbRiwogICAgICAgIHNlbGYudGFibGVzX2RpY3QgPSB1aV9mb3JtX2RhdGEudGFibGVfbmFtZXNfZGljdCgpCiAgICAgICAgc2VsZi5jYXJkX2VsZW0gPSB1aV9mb3JtX2RhdGEuZ2V0X2VsZW1fZGljdCgyNCkKICAgICAgICBzZWxmLmNhcmRzID0gdWlfZm9ybV9kYXRhLmdldF91bml2ZXJzYWxfY2FyZCgpCiAgICAgICAgc2VsZi5nb3Jpem9udGFsX2xheW91dCA9IHsibGF5b3V0IjogewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiZ29yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCgogICAgICAgICAgICAiRWxlbWVudHMiOiBbXX19CgogICAgZGVmIGdldF9xdWVyeV9ieV90YWJsZV9uYW1lKHNlbGYpOgogICAgICAgIHFmaWVsZF90ZXh0ID0gW10KICAgICAgICBsZWZ0X2pvaW5zX2xpc3QgPSBbXQogICAgICAgIGZvciBlbCBpbiBzZWxmLmZpZWxkczoKICAgICAgICAgICAgbGlua190YWJsZV9uYW1lID0gc2VsZi50YWJsZXNfZGljdC5nZXQoZWwpCiAgICAgICAgICAgIHFmaWVsZF90ZXh0LmFwcGVuZChzZWxmLnRhYmxlX25hbWUgKyAnLicgKyBlbCkKICAgICAgICAgICAgI3F0ZXh0ID0gJ1NlbGVjdCAnICsgJywnLmpvaW4ocWZpZWxkX3RleHQpICsgZicgRlJPTSB7c2VsZi50YWJsZV9uYW1lfSAnICsgJyAnLmpvaW4obGVmdF9qb2luc19saXN0KQogICAgICAgICAgICAjINCV0YHQu9C4INC10YHRgtGMINGE0LjQu9GM0YLRgNGLL9C+0YLQsdC+0YDRiyAtINC00L7QsdCw0LLQuNC8INC40YUg0LIg0LfQsNC/0YDQvtGBCiAgICAgICAgICAgIGlmIGxpbmtfdGFibGVfbmFtZToKICAgICAgICAgICAgICAgICMg0K3RgtC+INGB0YHRi9C70LrQsCDQvdCwINGC0LDQsdC70LjRhtGDCiAgICAgICAgICAgICAgICBxZmllbGRfdGV4dC5hcHBlbmQobGlua190YWJsZV9uYW1lICsgZicubmFtZSBhcyB7bGlua190YWJsZV9uYW1lfV9uYW1lJykKICAgICAgICAgICAgICAgIGxlZnRfam9pbnNfbGlzdC5hcHBlbmQoZicnJwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiB7bGlua190YWJsZV9uYW1lfQogICAgICAgICAgICAgICAgICAgIE9OIHtsaW5rX3RhYmxlX25hbWV9LmlkID0ge3NlbGYudGFibGVfbmFtZX0ue2VsfQogICAgICAgICAgICAgICAgICAgICcnJykKICAgICAgICBxdGV4dCA9ICdTZWxlY3QgJyArICcsJy5qb2luKHFmaWVsZF90ZXh0KSArIGYnIEZST00ge3NlbGYudGFibGVfbmFtZX0gJyArICcgJy5qb2luKGxlZnRfam9pbnNfbGlzdCkKICAgICAgICAjINCV0YHQu9C4INC10YHRgtGMINGE0LjQu9GM0YLRgNGLL9C+0YLQsdC+0YDRiyAtINC00L7QsdCw0LLQuNC8INC40YUg0LIg0LfQsNC/0YDQvtGBCiAgICAgICAgaWYgc2VsZi5maWx0ZXJfdmFsdWU6CiAgICAgICAgICAgICMgY29uZGl0aW9ucyA9IFtmIntmaWVsZH0gTElLRSAnJXtmaWx0ZXJfdmFsdWV9JSciIGZvciBmaWVsZCBpbiBmaWx0ZXJfZmllbGRzXQogICAgICAgICAgICBjb25kaXRpb25zID0gW2Yie3NlbGYudGFibGVfbmFtZX0ue2ZpZWxkfSBMSUtFICcle3NlbGYuZmlsdGVyX3ZhbHVlfSUnIiBmb3IgZmllbGQgaW4gc2VsZi5maWx0ZXJfZmllbGRzXQogICAgICAgICAgICBxdGV4dCA9IHF0ZXh0ICsgZiIgV0hFUkUgeycgT1IgJy5qb2luKGNvbmRpdGlvbnMpfSIKICAgICAgICByZXR1cm4gcXRleHQKCiAgICBkZWYgZm9ybV9jYXJkX3N0cnVjdChzZWxmKToKICAgICAgICAjcWZpZWxkX3RleHQgPSBbXQogICAgICAgIGNhcmRfZWxlbSA9IHNlbGYuY2FyZF9lbGVtCiAgICAgICAgY2FyZHMgPSBzZWxmLmNhcmRzCiAgICAgICAgZm9yIGVsIGluIHNlbGYuZmllbGRzOgogICAgICAgICAgICBpZiBlbCBub3QgaW4gc2VsZi5leGNsdWRlX2xpc3Q6CiAgICAgICAgICAgICAgICBsaW5rX3RhYmxlX25hbWUgPSBzZWxmLnRhYmxlc19kaWN0LmdldChlbCkKICAgICAgICAgICAgICAgICNxZmllbGRfdGV4dC5hcHBlbmQoc2VsZi50YWJsZV9uYW1lICsgJy4nICsgZWwpCgogICAgICAgICAgICAgICAgIyDQlNC+0L/QvtC70L3QuNC8INCy0YvRhdC+0LTQvdGD0Y4g0YHRgtGA0YPQutGC0YPRgNGDINC/0L7Qu9GP0LzQuCDRgtCw0LHQu9C40YbRizoKICAgICAgICAgICAgICAgIGFsaWFzZXNfZWxlbSA9IHNlbGYuYWxpYXNlcy5nZXQoZWwpCiAgICAgICAgICAgICAgICBpZiBhbGlhc2VzX2VsZW06ICAjINCU0LvRjyDRjdGC0L7Qs9C+INC/0L7Qu9GPINC/0YDQtdC00YPRgdC80L7RgtGA0LXQvdCwINC90LDRgdGC0YDQvtC50LrQsAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBhbGlhc2VzX2VsZW1bJ25hbWUnXSA9PSAna2V5JzogICMg0JTQu9GPINC60LvRjtGH0LAg0L3QsNGB0YLRgNC+0LnQutC4INC90LUg0L3Rg9C20L3RiwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5ub19sYWJlbDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMg0LTQvtCx0LDQstC40Lwg0L7Qv9C40YHQsNC90LjQtSDQv9C+0LvRjzouLi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVmFsdWUnXSA9IGFsaWFzZXNfZWxlbVsnbmFtZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW1bJ1RleHRTaXplJ10gPSByc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKSAgIyBhbGlhc2VzX2VsZW1bJ3RleHRfc2l6ZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW1bJ1RleHRCb2xkJ10gPSBGYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2xheW91dCddWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW0uY29weSgpKQoKICAgICAgICAgICAgICAgICAgICAgICAgIyDQotC10L/QtdGA0Ywg0YHQsNC80L4g0L/QvtC70LU6CiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVmFsdWUnXSA9ICdAJyArIGVsCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRfZWxlbVsnVGV4dFNpemUnXSA9IHJzX3NldHRpbmdzLmdldChhbGlhc2VzX2VsZW1bJ3RleHRfc2l6ZSddKQogICAgICAgICAgICAgICAgICAgICAgICBjYXJkX2VsZW1bJ1RleHRCb2xkJ10gPSBhbGlhc2VzX2VsZW1bJ1RleHRCb2xkJ10KICAgICAgICAgICAgICAgIGVsc2U6ICAjINCY0L3QsNGH0LUg0L/RgNC+0YHRgtC+INC00L7QsdCw0LLQuNC8INC10LPQviDRgdC+INGB0YLQsNC90LTQsNGA0YLQvdGL0LzQuCDQvdCw0YHRgtGA0L7QudC60LDQvNC4CiAgICAgICAgICAgICAgICAgICAgY2FyZF9lbGVtWydWYWx1ZSddID0gJ0AnICsgZWwKICAgICAgICAgICAgICAgICAgICAjINCU0L7QsdCw0LLQuNC8INC/0L7Qu9C1INCyINC60LDRgNGC0L7Rh9C60LgKICAgICAgICAgICAgY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2xheW91dCddWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddWzBdWydFbGVtZW50cyddLmFwcGVuZChjYXJkX2VsZW0uY29weSgpKQogICAgZGVmIGZvcm1fY2FyZF9zdHJ1Y3RfZnJvbV9yZWFkeV9zcnVjdChzZWxmKToKICAgICAgICB0ZW1wX3N0cnVjdCA9ICgnY29kZScsJ25hbWUnLCgnYXJ0JywndGltZXN0YW1wJyksJ2Z1bGxfbmFtZScpCiAgICAgICAganNvbl9zdHJ1Y3R1cmUgPSBbXQoKICAgICAgICBmb3IgaXRlbSBpbiB0ZW1wX3N0cnVjdDoKICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShpdGVtLCBsaXN0KToKICAgICAgICAgICAgICAgIG5lc3RlZF9zdHJ1Y3R1cmUgPSBbXQogICAgICAgICAgICAgICAgZm9yIG5lc3RlZF9pdGVtIGluIGl0ZW06CiAgICAgICAgICAgICAgICAgICAgbmVzdGVkX3N0cnVjdHVyZS5hcHBlbmQobmVzdGVkX2l0ZW0pCiAgICAgICAgICAgICAgICBqc29uX3N0cnVjdHVyZS5hcHBlbmQobmVzdGVkX3N0cnVjdHVyZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGpzb25fc3RydWN0dXJlLmFwcGVuZChpdGVtKQoKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhqc29uX3N0cnVjdHVyZSwgaW5kZW50PTQpCgoKIyDQm9C40YLQstC40L3QtdC90LrQviDQntC70LXQsy4g0KHQvtC30LTQsNC90LjQtSDRgtCw0LHQu9C40YYg0L/QviDQt9Cw0L/RgNC+0YHRgyDQvtGB0YLQsNGC0LrQvtCyINC4INGG0LXQvS4gMTYuMDUuMjAyMwoKZGVmIG9wZW5fd2hfbGlzdF9vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgaiA9IHVpX3RhYmxlc19zdHJ1Y3R1cmUud2hfbGlzdF9jYXJkcwoKICAgIGpbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdID0gW10KCiAgICBxdWVyeV90ZXh0ID0gIlNFTEVDVCAqIEZST00gUlNfd2FyZWhvdXNlcyIKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQoKICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICBjID0geyJrZXkiOiBzdHIocmVjb3JkWzBdKSwgIm5hbWUiOiBzdHIocmVjb3JkWzFdKX0KICAgICAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXS5hcHBlbmQoYykKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgid2hfY2FyZHMiKToKICAgICAgICBoYXNoTWFwLnB1dCgid2hfY2FyZHMiLCBqc29uLmR1bXBzKGosIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgb3Blbl9jZWxsX2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlkZW50aWZ5X2lucHV0X3RleHQoaGFzaE1hcCkKCiAgICBnb29kX2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2dvb2RfaWQiKQoKICAgIGlmIG5vdCBnb29kX2lkOgogICAgICAgIGhhc2hNYXAucHV0KCJ0b2FzdCIsICLQndC1INCy0YvQsdGA0LDQvSDRgtC+0LLQsNGAIikKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgiKQoKICAgICIiImVsc2U6CgogICAgICAgIGhhc2hNYXAucHV0KCJjYXJkc19sb2FkaW5nIiwgItCX0LDQs9GA0YPQttCw0LXRgtGB0Y8g0YHQv9C40YHQvtC6INGP0YfQtdC10LouLi4iKSIiIgoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9nb29kX2NlbGxzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGdvb2RfaWQgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfZ29vZF9pZCIpCgogICAgaHR0cCA9IGdldF9odHRwX3NldHRpbmdzKGhhc2hNYXApCiAgICBnZXRfcmVtYWluc191cmwgPSBodHRwWyd1cmwnXSArICcvc2ltcGxlX2FjY291bnRpbmcvZ29vZF9iYWxhbmNlcy9jZWxscz8nCiAgICBwYXJhbXMgPSB7J2FuZHJvaWRfaWQnOiBodHRwWydhbmRyb2lkX2lkJ10sICJpZF9nb29kIjogZ29vZF9pZH0KICAgIHIgPSByZXF1ZXN0cy5nZXQoZ2V0X3JlbWFpbnNfdXJsLAogICAgICAgICAgICAgICAgICAgICBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPXsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9LAogICAgICAgICAgICAgICAgICAgICBwYXJhbXM9cGFyYW1zKQoKICAgIGpzb25fcmVzcG9uc2UgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgaiA9IHVpX3RhYmxlc19zdHJ1Y3R1cmUuY2VsbF9saXN0X2NhcmRzCiAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXSA9IFtdCiAgICBpZiBsZW4oanNvbl9yZXNwb25zZSkgPiAwOgoKICAgICAgICBhcHBlbmRlZF9jZWxsX2lkX2xpc3QgPSBbXQogICAgICAgIGZvciByZWNvcmQgaW4ganNvbl9yZXNwb25zZToKICAgICAgICAgICAgaWYgcmVjb3JkWyJpZF9jZWxsIl0gbm90IGluIGFwcGVuZGVkX2NlbGxfaWRfbGlzdDoKICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNoTWFwLmdldCgicHJvcGVydHlfaWQiKSBvciBcCiAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZFsnaWRfcHJvcGVydHknXSA9PSBoYXNoTWFwLmdldCgicHJvcGVydHlfaWQiKToKICAgICAgICAgICAgICAgICAgICBjID0geyJrZXkiOiByZWNvcmRbImlkX2NlbGwiXSwgIm5hbWUiOiBnZXRfbmFtZV9ieV9maWVsZCgiUlNfY2VsbHMiLCAnaWQnLCByZWNvcmRbImlkX2NlbGwiXSl9CiAgICAgICAgICAgICAgICAgICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kZWRfY2VsbF9pZF9saXN0LmFwcGVuZChyZWNvcmRbImlkX2NlbGwiXSkKCiAgICAgICAgYXBwZW5kZWRfY2VsbF9pZF9saXN0LmNsZWFyKCkKCiAgICAgICAgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoImNlbGxfY2FyZHMiKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoImNlbGxfY2FyZHMiLCBqc29uLmR1bXBzKGosIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgbm90IGhhc2hNYXAuZ2V0KCJjZWxsX2NhcmRzIik6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiY2VsbF9jYXJkcyIsIGpzb24uZHVtcHMoaiwgZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoJ3V0ZjgnKS5kZWNvZGUoKSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCJjYXJkc19sb2FkaW5nIiwgIiIpCiAgICBlbHNlOgogICAgICAgIGhhc2hNYXAucHV0KCJjZWxsX3NlbGVjdCIsICLQndC1INGA0LDQt9C80LXRidC10L0g0LIg0Y/Rh9C10LnQutCw0YUiKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCIpCgogICAgaGFzaE1hcC5wdXQoIlJlZnJlc2hTY3JlZW4iLCAiIikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBjZWxsX2xpc3Rfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgIHNlbGVjdGVkX2NlbGxfaWQgPSBoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgIGN1cnJlbnRfc3RyID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2NhcmRfcG9zaXRpb24iKQogICAgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgiY2VsbF9jYXJkcyIpKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpsaXN0WydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY3VycmVudF9zdHIpXQogICAgICAgIHNlbGVjdGVkX2NlbGxfbmFtZSA9IGN1cnJlbnRfZWxlbVsibmFtZSJdCgogICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgc2VsZWN0ZWRfY2VsbF9pZCkKICAgICAgICBoYXNoTWFwLnB1dCgiY2VsbF9zZWxlY3QiLCBzZWxlY3RlZF9jZWxsX25hbWUpCiAgICAgICAgaGFzaE1hcC5wdXQoInNlbGVjdGVkX2NlbGxfbmFtZSIsIHNlbGVjdGVkX2NlbGxfbmFtZSkKICAgICAgICBoYXNoTWFwLnB1dCgiY2VsbF9jYXJkcyIsICIiKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3JlbWFpbnMnIG9yICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGJhY2tfdG9fcmVtYWlucyhoYXNoTWFwKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9yZW1haW5zKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBodHRwID0gZ2V0X2h0dHBfc2V0dGluZ3MoaGFzaE1hcCkKCiAgICBpZiBub3QgKGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykgb3IgaGFzaE1hcC5nZXQoJ3doX3NlbGVjdCcpIG9yIGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykKICAgICAgICAgICAgb3IgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKSBvciBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpKToKICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZHNfY3VzdG9tX3RhYmxlJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ29iamVjdF9uYW1lJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAi0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQsdGA0LDQvSDRgdC60LvQsNC0LCDRgtC+0LLQsNGAINC40LvQuCDRj9GH0LXQudC60LAiKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCdnb29kX2FydF9pbnB1dCcpIG9yIGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykgYW5kIG5vdCBoYXNoTWFwKCJzZWxlY3RlZF9nb29kX2lkIik6CiAgICAgICAgaWRlbnRpZnlfaW5wdXRfdGV4dChoYXNoTWFwKQoKICAgIGlmIGhhc2hNYXAuZ2V0KCJlcnJvcl9tc2ciKToKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd19lcnJvcl9tc2ciLCAiMSIpCiAgICBlbHNlOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93X2Vycm9yX21zZyIsICItMSIpCgogICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKToKCiAgICAgICAgZ2V0X3JlbWFpbnNfdXJsID0gaHR0cFsndXJsJ10gKyAnL3NpbXBsZV9hY2NvdW50aW5nL2dvb2RfYmFsYW5jZXMvY2VsbHM/JwoKICAgICAgICBwYXJhbXMgPSB7J2FuZHJvaWRfaWQnOiBodHRwWydhbmRyb2lkX2lkJ10sICdpZF9jZWxsJzogaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2NlbGxfaWQnKX0KCiAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlID0gdWlfdGFibGVzX3N0cnVjdHVyZS5nb29kc19jdXN0b21fdGFibGVfY2VsbAoKICAgICAgICB0Ym9keV9sYXlvdXQgPSB1aV90YWJsZXNfc3RydWN0dXJlLnRib2R5X3JlbWFpbnNfbGF5b3V0X2NlbGwKCiAgICAgICAgaWYgbm90IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jZWxsX25hbWUiKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsIGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfc2VsZWN0ZWRfY2VsbF9uYW1lJywgJzEnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX3doX25hbWUnLCAnLTEnKQoKICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpOgogICAgICAgICAgICBwYXJhbXNbJ2lkX2dvb2QnXSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX29iamVjdF9uYW1lJywgaGFzaE1hcC5nZXQoJ29iamVjdF9uYW1lJykgKyAiLCAiICsgaGFzaE1hcC5nZXQoJ2dvb2RfY29kZScpKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICcxJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICctMScpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlX2luZm8nKSBhbmQgaGFzaE1hcC5nZXQoImJhcmNvZGVfaW5mbyIpICE9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9jZWxsX25hbWUnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJzEnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X2JhcmNvZGVfaW5mbycsICctMScpCgogICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX2NlbGxfbmFtZScsICcxJykKCiAgICAgICAgciA9IHJlcXVlc3RzLmdldChnZXRfcmVtYWluc191cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz1wYXJhbXMpCgogICAgICAgIGpzb25fcmVzcG9uc2UgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgICAgIGlmIGxlbihqc29uX3Jlc3BvbnNlKSA8IDE6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJub19kYXRhIiwgItCd0LXRgiDQtNCw0L3QvdGL0YUiKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd19ub19kYXRhIiwgIjEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJTaG93X25vX2RhdGEiLCAiLTEiKQoKICAgICAgICB2YWx1ZXMgPSAwCiAgICAgICAgZm9yIGVsZW1lbnQgaW4ganNvbl9yZXNwb25zZToKICAgICAgICAgICAgaWYgZWxlbWVudFsiaWRfcHJvcGVydHkiXToKICAgICAgICAgICAgICAgIHZhbHVlcyArPSAxCgogICAgICAgIGlmIHZhbHVlcyA9PSAwOgogICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ2xheW91dCddWydFbGVtZW50cyddLnBvcCgzKQogICAgICAgICAgICB0Ym9keV9sYXlvdXRbJ0VsZW1lbnRzJ10ucG9wKDMpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJyk6CiAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDEpCiAgICAgICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMSkKCiAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWydjdXN0b210YWJsZSddWydsYXlvdXQnXVsnRWxlbWVudHMnXS5wb3AoMCkKICAgICAgICB0Ym9keV9sYXlvdXRbJ0VsZW1lbnRzJ10ucG9wKDApCgogICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0gPSBbe31dCgogICAgICAgIGkgPSAwCiAgICAgICAgZm9yIGVsZW1lbnQgaW4ganNvbl9yZXNwb25zZToKCiAgICAgICAgICAgIGMgPSB7ImtleSI6IHN0cihpKSwgIml0ZW0iOiBnZXRfbmFtZV9ieV9pZCgiUlNfZ29vZHMiLCBlbGVtZW50WyJpZF9nb29kIl0pLAogICAgICAgICAgICAgICAgICJxdWFudGl0eSI6IGVsZW1lbnRbJ3F0dHknXSwgJ19sYXlvdXQnOiB0Ym9keV9sYXlvdXQsCiAgICAgICAgICAgICAgICAgJ2NlbGwnOiBnZXRfbmFtZV9ieV9pZCgiUlNfY2VsbHMiLCBlbGVtZW50WyJpZF9jZWxsIl0pfQoKICAgICAgICAgICAgaWYgZWxlbWVudFsiaWRfcHJvcGVydHkiXSBpcyBOb25lOgogICAgICAgICAgICAgICAgY1sncHJvcGVydGllcyddID0gJycKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNbJ3Byb3BlcnRpZXMnXSA9IGdldF9uYW1lX2J5X2ZpZWxkKCJSU19wcm9wZXJ0aWVzIiwgJ2lkJywgZWxlbWVudFsiaWRfcHJvcGVydHkiXSkKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICBpZiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdID09IGhhc2hNYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpOgogICAgICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbImN1c3RvbXRhYmxlIl1bInRhYmxlZGF0YSJdLmFwcGVuZChjKQogICAgICAgICAgICAgICAgaSArPSAxCgogICAgZWxzZToKCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKSBvciBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJyk6CgogICAgICAgICAgICBnZXRfcmVtYWluc191cmwgPSBodHRwWyd1cmwnXSArICcvc2ltcGxlX2FjY291bnRpbmcvZ29vZF9iYWxhbmNlcy93YXJlaG91c2VzPycKCiAgICAgICAgICAgIHBhcmFtcyA9IHsnYW5kcm9pZF9pZCc6IGh0dHBbJ2FuZHJvaWRfaWQnXX0KCiAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZSA9IHVpX3RhYmxlc19zdHJ1Y3R1cmUuZ29vZHNfY3VzdG9tX3RhYmxlX3doCgogICAgICAgICAgICB0Ym9keV9sYXlvdXQgPSB1aV90YWJsZXNfc3RydWN0dXJlLnRib2R5X3JlbWFpbnNfbGF5b3V0X3doCgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpOgogICAgICAgICAgICAgICAgcGFyYW1zWydpZF9nb29kJ10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCBoYXNoTWFwLmdldCgnb2JqZWN0X25hbWUnKSArICIsICIgKyBoYXNoTWFwLmdldCgnZ29vZF9jb2RlJykpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19zZWxlY3RlZF9vYmplY3RfbmFtZScsICcxJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX29iamVjdF9uYW1lJywgJy0xJykKCiAgICAgICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF93YXJlaG91c2VfaWQnKToKICAgICAgICAgICAgICAgIHBhcmFtc1snaWRfd2FyZWhvdXNlJ10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJykKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF93aF9uYW1lJywgaGFzaE1hcC5nZXQoJ3doX3NlbGVjdCcpKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfc2VsZWN0ZWRfd2hfbmFtZScsICcxJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX3doX25hbWUnLCAnLTEnKQoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGVfaW5mbycpOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJzEnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJy0xJykKCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdTaG93X3NlbGVjdGVkX2NlbGxfbmFtZScsICctMScpCgogICAgICAgICAgICByID0gcmVxdWVzdHMuZ2V0KGdldF9yZW1haW5zX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRoPUhUVFBCYXNpY0F1dGgoaHR0cFsndXNlciddLCBodHRwWydwYXNzJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9eydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04J30sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zPXBhcmFtcykKCiAgICAgICAgICAgIGpzb25fcmVzcG9uc2UgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgICAgICAgICBpZiBsZW4oanNvbl9yZXNwb25zZSkgPCAxOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoIm5vX2RhdGEiLCAi0J3QtdGCINC00LDQvdC90YvRhSIpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd19ub19kYXRhIiwgIjEiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dfbm9fZGF0YSIsICItMSIpCgogICAgICAgICAgICB2YWx1ZXMgPSAwCiAgICAgICAgICAgIGZvciBlbGVtZW50IGluIGpzb25fcmVzcG9uc2U6CiAgICAgICAgICAgICAgICBpZiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdOgogICAgICAgICAgICAgICAgICAgIHZhbHVlcyArPSAxCgogICAgICAgICAgICBpZiB2YWx1ZXMgPT0gMDoKICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDMpCiAgICAgICAgICAgICAgICB0Ym9keV9sYXlvdXRbJ0VsZW1lbnRzJ10ucG9wKDMpCgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfZ29vZF9pZCcpOgogICAgICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWydjdXN0b210YWJsZSddWydsYXlvdXQnXVsnRWxlbWVudHMnXS5wb3AoMSkKICAgICAgICAgICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMSkKCiAgICAgICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF93YXJlaG91c2VfaWQnKToKICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDApCiAgICAgICAgICAgICAgICB0Ym9keV9sYXlvdXRbJ0VsZW1lbnRzJ10ucG9wKDApCgogICAgICAgICAgICBnb29kc19jdXN0b21fdGFibGVbImN1c3RvbXRhYmxlIl1bInRhYmxlZGF0YSJdID0gW3t9XQoKICAgICAgICAgICAgaSA9IDAKCiAgICAgICAgICAgIGZvciBlbGVtZW50IGluIGpzb25fcmVzcG9uc2U6CgogICAgICAgICAgICAgICAgYyA9IHsia2V5Ijogc3RyKGkpLCAiaXRlbSI6IGdldF9uYW1lX2J5X2lkKCJSU19nb29kcyIsIGVsZW1lbnRbImlkX2dvb2QiXSksCiAgICAgICAgICAgICAgICAgICAgICJxdWFudGl0eSI6IGVsZW1lbnRbJ3F0dHknXSwgJ19sYXlvdXQnOiB0Ym9keV9sYXlvdXQsCiAgICAgICAgICAgICAgICAgICAgICd3YXJlaG91c2UnOiBnZXRfbmFtZV9ieV9pZCgiUlNfd2FyZWhvdXNlcyIsIGVsZW1lbnRbImlkX3dhcmVob3VzZSJdKX0KCiAgICAgICAgICAgICAgICBpZiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgY1sncHJvcGVydGllcyddID0gJycKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgY1sncHJvcGVydGllcyddID0gZ2V0X25hbWVfYnlfZmllbGQoIlJTX3Byb3BlcnRpZXMiLCAnaWQnLCBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdKQogICAgICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICAgICAgaWYgZWxlbWVudFsiaWRfcHJvcGVydHkiXSA9PSBoYXNoTWFwLmdldCgncHJvcGVydHlfaWQnKToKICAgICAgICAgICAgICAgICAgICAgICAgZ29vZHNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXS5hcHBlbmQoYykKICAgICAgICAgICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGdvb2RzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICAgICAgaSArPSAxCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgogICAgaWYgbm90IGhhc2hNYXAuZ2V0KCJyZXR1cm5fdG9fZ29vZF9jYXJkIik6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKCiAgICBpZiBsZW4oZ29vZHNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXSkgPCAxOgogICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAi0KLQvtCy0LDRgCDQvdC1INC90LDQudC00LXQvSIpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfZXJyb3JfbXNnJywgJzEnKQoKICAgIGhhc2hNYXAucHV0KCJwcm9wZXJ0eV9pZCIsICIiKQoKICAgIGhhc2hNYXAucHV0KCJnb29kc19jdXN0b21fdGFibGUiLCBqc29uLmR1bXBzKGdvb2RzX2N1c3RvbV90YWJsZSkpCgogICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0KLQsNCx0LvQuNGG0LAg0L7RgdGC0LDRgtC60L7QsiIpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgaWRlbnRpZnlfaW5wdXRfdGV4dChoYXNoTWFwKToKCiAgICBpZiBoYXNoTWFwLmdldCgnZ29vZF9hcnRfaW5wdXQnKToKICAgICAgICBnb29kX2FydF9pbnB1dCA9IGhhc2hNYXAuZ2V0KCdnb29kX2FydF9pbnB1dCcpCgogICAgY2VsbF9pbnB1dCA9IGhhc2hNYXAuZ2V0KCdjZWxsX2lucHV0JykKCiAgICBpZiBnb29kX2FydF9pbnB1dCBhbmQgbm90IGhhc2hNYXAuZ2V0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJyk6CgogICAgICAgIGdvb2RfbmFtZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgbmFtZSBGUk9NIFJTX2dvb2RzIHdoZXJlIGFydCA9ICciICsgZ29vZF9hcnRfaW5wdXQgKyAiJyIpCgogICAgICAgIGlmIGxlbihnb29kX25hbWUpID4gMDoKCiAgICAgICAgICAgIGdvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkLGNvZGUgRlJPTSBSU19nb29kcyB3aGVyZSBhcnQgPSAnIiArIGdvb2RfYXJ0X2lucHV0ICsgIiciKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsIGdvb2RfcXVlcnlbMF1bMF0pCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCBnb29kX3F1ZXJ5WzBdWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCBzdHIoZ29vZF9uYW1lKS5zcGxpdCgiJyIpWzFdKQogICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0JywgaGFzaE1hcC5nZXQoJ2dvb2RfYXJ0X2lucHV0JykpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAiINCi0L7QstCw0YAg0YEg0LDRgNGC0LjQutGD0LvQvtC8ICIgKyAiJyIgKyBnb29kX2FydF9pbnB1dCArICInIiArICIg0L3QtSDQvdCw0LnQtNC10L0iKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQoKICAgIGlmIGNlbGxfaW5wdXQ6CgogICAgICAgIGNlbGxfaWQgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkIEZST00gUlNfY2VsbHMgd2hlcmUgbmFtZSA9ICciICsgY2VsbF9pbnB1dCArICInIikKCiAgICAgICAgaWYgbGVuKGNlbGxfaWQpID4gMDoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCBzdHIoY2VsbF9pZCkuc3BsaXQoIiciKVsxXSkKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2NlbGxfbmFtZScsIGNlbGxfaW5wdXQpCiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICIiKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBoYXNoTWFwLmdldCgnZXJyb3JfbXNnJyk6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgaGFzaE1hcC5nZXQoJ2Vycm9yX21zZycpICsgIlxuIiArICIg0K/Rh9C10LnQutCwIGMg0LjQvNC10L3QtdC8ICIgKyAiJyIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbF9pbnB1dCArICInIiArICIg0L3QtSDQvdCw0LnQtNC10L3QsCIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiDQr9GH0LXQudC60LAgYyDQuNC80LXQvdC10LwgIiArICInIiArIGNlbGxfaW5wdXQgKyAiJyIgKyAiINC90LUg0L3QsNC50LTQtdC90LAiKQogICAgICAgICAgICAjIGhhc2hNYXAucHV0KCdjZWxsX25hbWUnLCAiIikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBpZGVudGlmeV9iYXJjb2RlX3JlbWFpbnMoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlX2luZm8nLCBzdHIoaGFzaE1hcC5nZXQoJ2JhcmNvZGUnKSkpCiAgICBoYXNoTWFwLnB1dCgiY2VsbF9jYXJkcyIsICIiKQoKCiAgICBpZiBoYXNoTWFwLmdldCgnYmFyY29kZScpOgogICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnYmFyY29kZScpCgogICAgICAgIGJhcmNvZGVfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkX2dvb2QsaWRfcHJvcGVydHkgRlJPTSBSU19iYXJjb2RlcyB3aGVyZSBiYXJjb2RlID0gJyIgKyBiYXJjb2RlICsgIiciKQoKICAgICAgICBpZiBsZW4oYmFyY29kZV9xdWVyeSkgPiAwOgogICAgICAgICAgICBpZiBiYXJjb2RlX3F1ZXJ5WzBdWzBdOgogICAgICAgICAgICAgICAgZ29vZF9pZCA9IGJhcmNvZGVfcXVlcnlbMF1bMF0KICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9nb29kX2lkJywgc3RyKGdvb2RfaWQpKQoKICAgICAgICAgICAgICAgIGdvb2RfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIG5hbWUsYXJ0LGNvZGUgRlJPTSBSU19nb29kcyB3aGVyZSBpZCA9ICciICsgZ29vZF9pZCArICInIikKICAgICAgICAgICAgICAgIGlmIGdvb2RfcXVlcnlbMF1bMF06CgogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdvYmplY3RfbmFtZScsIGdvb2RfcXVlcnlbMF1bMF0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCJvYmplY3RfbmFtZSIsICIiKQogICAgICAgICAgICAgICAgaWYgZ29vZF9xdWVyeVswXVsxXToKCiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0Jywgc3RyKGdvb2RfcXVlcnlbMF1bMV0pKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZF9hcnRfaW5wdXQnLCAiIikKICAgICAgICAgICAgICAgIGlmIGdvb2RfcXVlcnlbMF1bMl06CiAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoImdvb2RfY29kZSIsIGdvb2RfcXVlcnlbMF1bMl0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCJnb29kX2NvZGUiLCAiIikKCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCgogICAgICAgICAgICBpZiBiYXJjb2RlX3F1ZXJ5WzBdWzFdOgogICAgICAgICAgICAgICAgcHJvcGVydHlfaWQgPSBiYXJjb2RlX3F1ZXJ5WzBdWzFdCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydHlfaWQnLCBwcm9wZXJ0eV9pZCkKCiAgICAgICAgZWxzZToKCiAgICAgICAgICAgIGNlbGxfaWQgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkIEZST00gUlNfY2VsbHMgd2hlcmUgYmFyY29kZSA9ICciICsgYmFyY29kZSArICInIikKCiAgICAgICAgICAgIGlmIGxlbihjZWxsX2lkKSA+IDA6CgogICAgICAgICAgICAgICAgY2VsbF9uYW1lID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoIlNFTEVDVCBuYW1lIEZST00gUlNfY2VsbHMgd2hlcmUgaWQgPSAnIiArIHN0cihjZWxsX2lkKS5zcGxpdCgiJyIpWzFdICsgIiciKQoKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgc3RyKGNlbGxfaWQpLnNwbGl0KCInIilbMV0pCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgc3RyKGNlbGxfbmFtZSkuc3BsaXQoIiciKVsxXSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICLQqNGC0YDQuNGF0LrQvtC0INC90LUg0YDQsNGB0L/QvtC30L3QsNC9IikKCiAgICBnZXRfcmVtYWlucyhoYXNoTWFwKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGJhY2tfdG9fcmVtYWlucyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBoYXNoTWFwLnB1dCgnd2hfc2VsZWN0JywgJycpCiAgICBoYXNoTWFwLnB1dCgnY2VsbF9zZWxlY3QnLCAnJykKICAgIGhhc2hNYXAucHV0KCdjZWxsX2NhcmRzJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9pZCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3dhcmVob3VzZV9pZCcsICcnKQogICAgaGFzaE1hcC5wdXQoIkJhY2tTY3JlZW4iLCAiIikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBwcmljZV90eXBlc19saXN0X29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBqID0gdWlfdGFibGVzX3N0cnVjdHVyZS5wcmljZV90eXBlc19saXN0X2NhcmRzCgogICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0gPSBbXQoKICAgIHF1ZXJ5X3RleHQgPSAiU0VMRUNUICogRlJPTSBSU19wcmljZV90eXBlcyIKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQoKICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICBjID0geyJrZXkiOiBzdHIocmVjb3JkWzBdKSwgIm5hbWUiOiBzdHIocmVjb3JkWzFdKX0KICAgICAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXS5hcHBlbmQoYykKCiAgICBpZiBub3QgaGFzaE1hcC5jb250YWluc0tleSgicHJpY2VfdHlwZV9jYXJkcyIpOgogICAgICAgIGhhc2hNYXAucHV0KCJwcmljZV90eXBlX2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHByb3BlcnR5X2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGogPSB1aV90YWJsZXNfc3RydWN0dXJlLnByb3BlcnR5X2xpc3RfY2FyZHMKCiAgICBqWyJjdXN0b21jYXJkcyJdWyJjYXJkc2RhdGEiXSA9IFtdCgogICAgaWYgaGFzaE1hcC5nZXQoImdvb2RfdHlwZV9pZCIpOgogICAgICAgIGdvb2RfdHlwZSA9IGhhc2hNYXAuZ2V0KCdnb29kX3R5cGVfaWQnKQogICAgZWxzZToKICAgICAgICBnb29kX3R5cGVfcXVlcnlfdGV4dCA9ICJTRUxFQ1QgdHlwZV9nb29kIEZST00gUlNfZ29vZHMgV0hFUkUgaWQgPSAnIiArIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykgKyAiJyIKICAgICAgICBnb29kX3R5cGVfcXVlcnkgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChnb29kX3R5cGVfcXVlcnlfdGV4dCkKICAgICAgICBpZiBsZW4oZ29vZF90eXBlX3F1ZXJ5KSA+IDA6CiAgICAgICAgICAgIGdvb2RfdHlwZSA9IGdvb2RfdHlwZV9xdWVyeVswXVswXQoKICAgIHBlcnNvbmFsX3Byb3BlcnRpZXNfcXVlcnlfdGV4dCA9ICJTRUxFQ1QgKiBGUk9NIFJTX3Byb3BlcnRpZXMgV0hFUkUgaWRfb3duZXIgPSAnIiArIGdvb2RfdHlwZSArICInIgogICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHBlcnNvbmFsX3Byb3BlcnRpZXNfcXVlcnlfdGV4dCkKCiAgICBpZiBub3QgbGVuKHJlc3VsdHMpID4gMDoKICAgICAgICB0eXBlX3Byb3BlcnRpZXNfcXVlcnlfdGV4dCA9ICJTRUxFQ1QgKiBGUk9NIFJTX3Byb3BlcnRpZXMgV0hFUkUgaWRfb3duZXIgPSAnIiArIGhhc2hNYXAuZ2V0KAogICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCcpICsgIiciCiAgICAgICAgcmVzdWx0cyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHR5cGVfcHJvcGVydGllc19xdWVyeV90ZXh0KQoKICAgIGlmIGxlbihyZXN1bHRzKSA+IDA6CiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBpZiByZWNvcmRbMF0gYW5kIHJlY29yZFsyXToKICAgICAgICAgICAgICAgIGMgPSB7ImtleSI6IHN0cihyZWNvcmRbMF0pLCAibmFtZSI6IHN0cihyZWNvcmRbMl0pfQogICAgICAgICAgICAgICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCgogICAgICAgICMgaWYgbm90IGhhc2hNYXAuY29udGFpbnNLZXkoInByb3BlcnR5X2NhcmRzIik6CiAgICAgICAgaGFzaE1hcC5wdXQoInByb3BlcnR5X2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQogICAgZWxzZToKICAgICAgICBoYXNoTWFwLnB1dCgidG9hc3QiLCAi0JTQu9GPINC00LDQvdC90L7Qs9C+INGC0L7QstCw0YDQsCDQvdC10YIg0YXQsNGA0LDQutGC0LXRgNC40YHRgtC40LoiKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCf0YDQvtCy0LXRgNC60LAg0YbQtdC9IikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiB1bml0X2xpc3Rfb25fc3RhcnQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGogPSB1aV90YWJsZXNfc3RydWN0dXJlLnVuaXRfbGlzdF9jYXJkcwoKICAgIGpbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdID0gW10KCiAgICBxdWVyeV90ZXh0ID0gIlNFTEVDVCAqIEZST00gUlNfdW5pdHMgV0hFUkUgaWRfb3duZXIgPSAnIiArIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykgKyAiJyIKICAgIHJlc3VsdHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQoKICAgIGlmIGxlbihyZXN1bHRzKSA+IDA6CiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBjID0geyJrZXkiOiBzdHIocmVjb3JkWzBdKSwgIm5hbWUiOiBzdHIocmVjb3JkWzNdKX0KICAgICAgICAgICAgalsiY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCgogICAgICAgIGlmIG5vdCBoYXNoTWFwLmNvbnRhaW5zS2V5KCJ1bml0X2NhcmRzIik6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJ1bml0X2NhcmRzIiwganNvbi5kdW1wcyhqLCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpKQoKICAgIGVsc2U6CiAgICAgICAgaGFzaE1hcC5wdXQoInRvYXN0IiwgItCU0LvRjyDQtNCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAg0L3QtdGCINCy0YvQsdC+0YDQsCDRg9C/0LDQutC+0LLQutC4IikKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQn9GA0L7QstC10YDQutCwINGG0LXQvSIpCgoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9wcmljZXMoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGh0dHAgPSBnZXRfaHR0cF9zZXR0aW5ncyhoYXNoTWFwKQoKICAgIHByaWNlc19jdXN0b21fdGFibGUgPSB1aV90YWJsZXNfc3RydWN0dXJlLnByaWNlc19jdXN0b21fdGFibGUKCiAgICB0Ym9keV9sYXlvdXQgPSB1aV90YWJsZXNfc3RydWN0dXJlLnRib2R5X3ByaWNlc19sYXlvdXQKCiAgICBnZXRfZ29vZF9ieV9hcnQoaGFzaE1hcCkKCiAgICBpZiBoYXNoTWFwLmdldCgnYmFyY29kZV9pbmZvJyk6CiAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dfYmFyY29kZV9pbmZvJywgJzEnKQogICAgZWxzZToKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd19iYXJjb2RlX2luZm8nLCAnLTEnKQoKICAgIGhhc2hNYXAucHV0KCJub19kYXRhIiwgIiIpCgogICAgaWYgaGFzaE1hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKTogICMg0JXRgdC70Lgg0L3QsNC50LTQtdC9INGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQuSDRgtC+0LLQsNGACgogICAgICAgIGdldF9wcmljZXNfdXJsID0gaHR0cFsndXJsJ10gKyAnL3NpbXBsZV9hY2NvdW50aW5nL2dvb2RfcHJpY2VzPycKCiAgICAgICAgcGFyYW1zID0geydhbmRyb2lkX2lkJzogaHR0cFsnYW5kcm9pZF9pZCddLCAnaWRfZ29vZCc6IGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJyl9CgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcpOgogICAgICAgICAgICBwYXJhbXNbJ2lkX3Byb3BlcnR5J10gPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnKQoKICAgICAgICBpZiBoYXNoTWFwLmdldCgncHJvcGVydHlfaWQnKTogICMg0J7RgiDQqNGC0YDQuNGFLdC60L7QtNCwCiAgICAgICAgICAgIHBhcmFtc1snaWRfcHJvcGVydHknXSA9IGhhc2hNYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpCgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF91bml0X2lkJyk6CiAgICAgICAgICAgIHBhcmFtc1snaWRfdW5pdCddID0gaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX3VuaXRfaWQnKQoKICAgICAgICBpZiBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfcHJpY2VfdHlwZV9pZCcpOgogICAgICAgICAgICBwYXJhbXNbJ2lkX3ByaWNlX3R5cGUnXSA9IGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJykKCiAgICAgICAgciA9IHJlcXVlc3RzLmdldChnZXRfcHJpY2VzX3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGg9SFRUUEJhc2ljQXV0aChodHRwWyd1c2VyJ10sIGh0dHBbJ3Bhc3MnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPXsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9LAogICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zPXBhcmFtcykKCiAgICAgICAganNvbl9wcmljZXMgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgICAgIGlmIGxlbihqc29uX3ByaWNlcykgPCAxOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgibm9fZGF0YSIsICLQndC10YIg0LTQsNC90L3Ri9GFIikKCiAgICAgICAgdW5pdF92YWx1ZXMgPSAwCiAgICAgICAgcHJvcGVydHlfdmFsdWVzID0gMAogICAgICAgIGZvciBlbGVtZW50IGluIGpzb25fcHJpY2VzOgogICAgICAgICAgICBpZiBlbGVtZW50WyJpZF91bml0Il06CiAgICAgICAgICAgICAgICB1bml0X3ZhbHVlcyArPSAxCiAgICAgICAgICAgIGlmIGVsZW1lbnRbJ2lkX3Byb3BlcnR5J106CiAgICAgICAgICAgICAgICBwcm9wZXJ0eV92YWx1ZXMgKz0gMQoKICAgICAgICBpZiB1bml0X3ZhbHVlcyA9PSAwOgogICAgICAgICAgICBwcmljZXNfY3VzdG9tX3RhYmxlWydjdXN0b210YWJsZSddWydsYXlvdXQnXVsnRWxlbWVudHMnXS5wb3AoNCkKICAgICAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCg0KQoKICAgICAgICBpZiBwcm9wZXJ0eV92YWx1ZXMgPT0gMDoKICAgICAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDEpCiAgICAgICAgICAgIHRib2R5X2xheW91dFsnRWxlbWVudHMnXS5wb3AoMSkKCiAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsnY3VzdG9tdGFibGUnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ10ucG9wKDApCiAgICAgICAgdGJvZHlfbGF5b3V0WydFbGVtZW50cyddLnBvcCgwKQoKICAgICAgICBwcmljZXNfY3VzdG9tX3RhYmxlWyJjdXN0b210YWJsZSJdWyJ0YWJsZWRhdGEiXSA9IFt7fV0KCiAgICAgICAgaSA9IDAKCiAgICAgICAgZm9yIGVsZW1lbnQgaW4ganNvbl9wcmljZXM6CgogICAgICAgICAgICBjID0geyJrZXkiOiBzdHIoaSksICJnb29kIjogZWxlbWVudFsiaWRfZ29vZCJdLCAicHJvcGVydHkiOiBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdLAogICAgICAgICAgICAgICAgICJwcmljZSI6IGVsZW1lbnRbJ3ByaWNlJ10sICJwcmljZV90eXBlIjogZWxlbWVudFsnaWRfcHJpY2VfdHlwZSddLCAidW5pdCI6IGVsZW1lbnRbImlkX3VuaXQiXSwKICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHRib2R5X2xheW91dH0KCiAgICAgICAgICAgIGlmIGVsZW1lbnRbJ2lkX2dvb2QnXToKICAgICAgICAgICAgICAgIGNbJ2dvb2QnXSA9IGdldF9uYW1lX2J5X2lkKCJSU19nb29kcyIsIGVsZW1lbnRbImlkX2dvb2QiXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNbJ2dvb2QnXSA9ICIiCgogICAgICAgICAgICBpZiBlbGVtZW50WydpZF91bml0J106CiAgICAgICAgICAgICAgICBjWyd1bml0J10gPSBnZXRfbmFtZV9ieV9pZCgiUlNfdW5pdHMiLCBlbGVtZW50WyJpZF91bml0Il0pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjWyd1bml0J10gPSAiIgoKICAgICAgICAgICAgaWYgZWxlbWVudFsnaWRfcHJpY2VfdHlwZSddOgogICAgICAgICAgICAgICAgY1sncHJpY2VfdHlwZSddID0gZ2V0X25hbWVfYnlfaWQoIlJTX3ByaWNlX3R5cGVzIiwgZWxlbWVudFsiaWRfcHJpY2VfdHlwZSJdKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY1sncHJpY2VfdHlwZSddID0gIiIKCiAgICAgICAgICAgIGlmIGVsZW1lbnRbImlkX3Byb3BlcnR5Il06ICAjINCf0L7RhdC+0LbQtSDQvtCx0YDQsNGJ0LXQvdC40LUg0L3QtSDQuiDRgtC+0Lkg0YLQsNCx0LvQuNGG0LUKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBjWydwcm9wZXJ0eSddID0gZ2V0X25hbWVfYnlfaWQoIlJTX3Byb3BlcnRpZXMiLCBlbGVtZW50WyJpZF9wcm9wZXJ0eSJdKQogICAgICAgICAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CiAgICAgICAgICAgICAgICAgICAgY1sncHJvcGVydHknXSA9IGVsZW1lbnRbImlkX3Byb3BlcnR5Il0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNbJ3Byb3BlcnR5J10gPSAiIgoKICAgICAgICAgICAgcHJpY2VzX2N1c3RvbV90YWJsZVsiY3VzdG9tdGFibGUiXVsidGFibGVkYXRhIl0uYXBwZW5kKGMpCgogICAgICAgICAgICBpICs9IDEKCiAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19jdXN0b21fdGFibGUnLCBqc29uLmR1bXBzKHByaWNlc19jdXN0b21fdGFibGUpKQoKICAgICAgICBoYXNoTWFwLnB1dCgncHJpY2VzX2Vycm9yX21zZycsICIiKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0LDQsdC70LjRhtCwINGG0LXQvSIpCgogICAgZWxzZToKICAgICAgICBpZiBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0J3QtSDQvdCw0LnQtNC10L0g0YHQvtC+0YLQstC10YLRgdGC0LLRg9GO0YnQuNC5INGC0L7QstCw0YAiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCd0LUg0YPQutCw0LfQsNC9INGC0L7QstCw0YAiKQoKICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsICIiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdldF9nb29kX2J5X2FydChoYXNoTWFwKToKCiAgICAjIGhhc2hNYXAucHV0KCdpbnB1dF92YWx1ZScsIGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykpCgogICAgaWYgbm90IGhhc2hNYXAuZ2V0KCdpbnB1dF9nb29kX2lkJyk6CgogICAgICAgIGlmIGxlbihoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSkgPiAwOgoKICAgICAgICAgICAgZ29vZF9pZF9xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgaWQgRlJPTSBSU19nb29kcyB3aGVyZSBhcnQgPSAnIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoTWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSArICInIikKCiAgICAgICAgICAgIGdvb2RfbmFtZV9xdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCJTRUxFQ1QgbmFtZSxjb2RlLHR5cGVfZ29vZCBGUk9NIFJTX2dvb2RzIHdoZXJlIGFydCA9ICciICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzaE1hcC5nZXQoJ2lucHV0X2dvb2RfYXJ0JykgKyAiJyIpCgogICAgICAgICAgICBpZiBsZW4oZ29vZF9pZF9xdWVyeSkgPiAwOgogICAgICAgICAgICAgICAgZ29vZF9pZCA9IHN0cihnb29kX2lkX3F1ZXJ5KS5zcGxpdCgiJyIpWzFdCiAgICAgICAgICAgICAgICBnb29kX25hbWUgPSBnb29kX25hbWVfcXVlcnlbMF1bMF0KICAgICAgICAgICAgICAgIGdvb2RfY29kZSA9IGdvb2RfbmFtZV9xdWVyeVswXVsxXQogICAgICAgICAgICAgICAgZ29vZF90eXBlX2lkID0gZ29vZF9uYW1lX3F1ZXJ5WzBdWzJdCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgiaW5wdXRfZ29vZF9pZCIsIGdvb2RfaWQpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgicHJpY2VzX29iamVjdF9uYW1lIiwgZ29vZF9uYW1lICsgIiwgIiArIGdvb2RfY29kZSkKICAgICAgICAgICAgICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCBnb29kX2NvZGUpCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnZ29vZF90eXBlX2lkJywgZ29vZF90eXBlX2lkKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCi0L7QstCw0YAg0L3QtSDQstGL0LHRgNCw0L0iKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZ2V0X25hbWVfYnlfaWQodGFibGVfbmFtZSwgcmVjb3JkX2lkKToKCiAgICBxdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICJTRUxFQ1QgbmFtZSBGUk9NICIgKyB0YWJsZV9uYW1lLnN0cmlwKCciXCcnKSArICIgd2hlcmUgaWQgPSAnIiArIHJlY29yZF9pZCArICInIikKICAgIGlmIHR5cGUocXVlcnkpID09ICJzdHIiOgogICAgICAgIHJldHVybiBzdHIocXVlcnkpLnNwbGl0KCInIilbMV0KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHN0cihxdWVyeVswXSkuc3BsaXQoIiciKVsxXQoKCmRlZiBraWxsX3JlbWFpbnNfdGFibGVzKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGhhc2hNYXAucHV0KCd3aF9zZWxlY3QnLCAnJykKICAgIGhhc2hNYXAucHV0KCdnb29kX2FydF9pbnB1dCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ2NlbGxfaW5wdXQnLCAnJykKICAgIGhhc2hNYXAucHV0KCdjZWxsX25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdjZWxsX3NlbGVjdCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ29iamVjdF9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgnZXJyb3JfbXNnJywgJycpCiAgICBoYXNoTWFwLnB1dCgnZ29vZHNfY3VzdG9tX3RhYmxlJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9pZCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ2dvb2RfY29kZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX29iamVjdF9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfd2hfbmFtZScsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3dhcmVob3VzZV9pZCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGVfaW5mbycsICcnKQogICAgaWYgbm90IGhhc2hNYXAuZ2V0KCJyZXR1cm5fdG9fZ29vZF9jYXJkIik6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBraWxsX3ByaWNlX3RhYmxlcyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBoYXNoTWFwLnB1dCgnaW5wdXRfZ29vZF9hcnQnLCAnJykKICAgIGhhc2hNYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgJycpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgncHJpY2VfdHlwZV9zZWxlY3QnLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnJykKICAgIGhhc2hNYXAucHV0KCJwcm9wZXJ0eV9zZWxlY3QiLCAnJykKICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF91bml0X2lkJywgIiIpCiAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJycpCiAgICBoYXNoTWFwLnB1dCgidW5pdF9zZWxlY3QiLCAiIikKICAgIGhhc2hNYXAucHV0KCdwcmljZXNfY3VzdG9tX3RhYmxlJywgJycpCiAgICBoYXNoTWFwLnB1dCgnaW5wdXRfZ29vZF9pZCcsICcnKQogICAgaWYgbm90IGhhc2hNYXAuZ2V0KCJyZXR1cm5fdG9fZ29vZF9jYXJkIik6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdnb29kX2NvZGUnLCAnJykKICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlX2luZm8nLCAnJykKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgZmlsdGVyX2ZpZWxkcyA9IFtdCiAgICBmaWx0ZXJfdmFsdWUgPSAnJwoKICAgIGlmIGhhc2hNYXAuZ2V0KCd0eXBlX2lkJyk6CiAgICAgICAgZmlsdGVyX2ZpZWxkcy5hcHBlbmQoJ3R5cGVfZ29vZCcpCiAgICAgICAgZmlsdGVyX3ZhbHVlID0gaGFzaE1hcC5nZXQoJ3R5cGVfaWQnKQoKICAgIGdvb2RzX2NhcmRzX2pzb24gPSBnZXRfdGFibGVfY2FyZHMoJ1JTX2dvb2RzJywgZmlsdGVyX2ZpZWxkcywgZmlsdGVyX3ZhbHVlLCBleGNsdWRlX2xpc3Q9WydkZXNjcmlwdGlvbiddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub19sYWJlbD1UcnVlKQogICAgZ29vZHNfY2FyZHMgPSBtb2RpZnlfY2FyZHMoanNvbi5sb2Fkcyhnb29kc19jYXJkc19qc29uKSwgaGlkZV9uYW1lPVRydWUsIHRpdGxlX2NvbG9yPSIjN0EwMDVDIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VfYmxhbms9VHJ1ZSwgZGlzYWJsZV9vdmVycmlkZV9zZWFyY2g9VHJ1ZSkKICAgIGhhc2hNYXAucHV0KCdnb29kc19jYXJkcycsIGpzb24uZHVtcHMoZ29vZHNfY2FyZHMpKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdvb2RzX29uX2lucHV0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCJsaXN0ZW5lciIpID09ICJDYXJkc0NsaWNrIjoKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsIGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpKQogICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JrQsNGA0YLQvtGH0LrQsCDRgtC+0LLQsNGA0LAiKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3NlbGVjdF9nb29kc190eXBlJzoKICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICLQktGL0LHQvtGAIikKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYXJjb2RlJzoKICAgICAgICBpZGVudGlmeV9iYXJjb2RlX2dvb2RzKGhhc2hNYXApCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICBoYXNoTWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgaWRlbnRpZnlfYmFyY29kZV9nb29kcyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgnYmFyY29kZScpOgogICAgICAgIGJhcmNvZGUgPSBoYXNoTWFwLmdldCgnYmFyY29kZScpCgogICAgICAgIGdvb2RfaWQgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIGlkX2dvb2QgRlJPTSBSU19iYXJjb2RlcyB3aGVyZSBiYXJjb2RlID0gJyIgKyBiYXJjb2RlICsgIiciKQoKICAgICAgICBwcm9wZXJ0aWVzX3F1ZXJ5ID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQoCiAgICAgICAgICAgICJTRUxFQ1QgaWRfcHJvcGVydHkgRlJPTSBSU19iYXJjb2RlcyB3aGVyZSBiYXJjb2RlID0gJyIgKyBiYXJjb2RlICsgIiciKQoKICAgICAgICBpZiBwcm9wZXJ0aWVzX3F1ZXJ5OgogICAgICAgICAgICBwcm9wZXJ0eV9pZCA9IHN0cihwcm9wZXJ0aWVzX3F1ZXJ5KS5zcGxpdCgiJyIpWzFdCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsIHByb3BlcnR5X2lkKQoKICAgICAgICBpZiBsZW4oZ29vZF9pZCkgPiAwOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsIHN0cihnb29kX2lkKS5zcGxpdCgiJyIpWzFdKQoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0JrQsNGA0YLQvtGH0LrQsCDRgtC+0LLQsNGA0LAnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdlcnJvcl90eHQnLCAn0KLQvtCy0LDRgCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSDQv9C+INGI0YLRgNC40YXQutC+0LTRgycpCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZ29vZF9jYXJkX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICBoYXNoTWFwLnB1dCgiU2hvd19idXR0b25zIiwgIi0xIikgICMg0J/QvtC60LAg0YHQv9GA0Y/RgtCw0LvQuCDQv9C10YDQtdGF0L7QtCDQuiDQv9GA0L7RhtC10YHRgdCw0LwgItC+0YHRgtCw0YLQutC4IiDQuCAi0YbQtdC90YsiCgogICAgaWYgaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKToKICAgICAgICBzZWxlY3RlZF9nb29kX2lkID0gaGFzaE1hcC5nZXQoJ3NlbGVjdGVkX2dvb2RfaWQnKQoKICAgICAgICByZXN1bHRfcnNfZ29vZHMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgiU0VMRUNUIG5hbWUsYXJ0LGNvZGUsdHlwZV9nb29kLGRlc2NyaXB0aW9uIEZST00gUlNfZ29vZHMgd2hlcmUgaWQgPSAnIiArIHNlbGVjdGVkX2dvb2RfaWQgKyAiJyIpCgogICAgICAgIGdvb2RfbmFtZSA9IHJlc3VsdF9yc19nb29kc1swXVswXQogICAgICAgIGdvb2RfYXJ0ID0gcmVzdWx0X3JzX2dvb2RzWzBdWzFdCiAgICAgICAgZ29vZF9jb2RlID0gcmVzdWx0X3JzX2dvb2RzWzBdWzJdCiAgICAgICAgZ29vZF90eXBlX2lkID0gcmVzdWx0X3JzX2dvb2RzWzBdWzNdCiAgICAgICAgZ29vZF9kZXNjciA9IHJlc3VsdF9yc19nb29kc1swXVs0XQoKICAgICAgICBnb29kX3R5cGUgPSBnZXRfbmFtZV9ieV9pZCgnUlNfdHlwZXNfZ29vZHMnLCBnb29kX3R5cGVfaWQpCgogICAgICAgIGZpbGxfZW1wdHlfdmFsdWVzKGhhc2hNYXAsIHsiZ29vZF9uYW1lIjogZ29vZF9uYW1lLCAiZ29vZF9hcnQiOiBnb29kX2FydCwgImdvb2RfY29kZSI6IGdvb2RfY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImdvb2RfZGVzY3IiOiBnb29kX2Rlc2NyLCAiZ29vZF90eXBlIjogZ29vZF90eXBlfSwgdmFsdWU9ItC+0YLRgdGD0YLRgdGC0LLRg9C10YIiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIGdvb2RfY2FyZF9vbl9pbnB1dChoYXNoTWFwLCAgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgoKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdiYXJjb2RlJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlJywgJycpCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ2JhcmNvZGVfY2FyZHMnKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGVfY2FyZHMnLCAnJykKICAgICAgICBpZiBoYXNoTWFwLmdldCgncmV0dXJuX3RvX2dvb2RfY2FyZCcpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgncmV0dXJuX3RvX2dvb2RfY2FyZCcsICcnKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdzZWxlY3RlZF9nb29kX2lkJywgJycpCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YDRiyDRgdC/0LjRgdC+0LoiKQogICAgaWYgaGFzaE1hcC5nZXQoImxpc3RlbmVyIikgPT0gIlRpbGVzQ2xpY2siOgogICAgICAgIGhhc2hNYXAucHV0KCd0b2FzdCcsIHN0cihoYXNoTWFwLmdldCgnc2VsZWN0ZWRfdGlsZV9rZXknKSkpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAndG9fcHJpY2VzJzoKICAgICAgICBoYXNoTWFwLnB1dCgnaW5wdXRfZ29vZF9pZCcsIGhhc2hNYXAuZ2V0KCdzZWxlY3RlZF9nb29kX2lkJykpICAjIHNlbGVjdGVkX2dvb2RfaWQgaW5wdXRfZ29vZF9pZAogICAgICAgIGhhc2hNYXAucHV0KCdpbnB1dF9nb29kX2FydCcsIGhhc2hNYXAuZ2V0KCdnb29kX2FydCcpKQogICAgICAgIGhhc2hNYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCBoYXNoTWFwLmdldCgnZ29vZF9uYW1lJykgKyAiLCAiICsgaGFzaE1hcC5nZXQoJ2dvb2RfY29kZScpKQogICAgICAgIGhhc2hNYXAucHV0KCJyZXR1cm5fdG9fZ29vZF9jYXJkIiwgInRydWUiKQogICAgICAgIGhhc2hNYXAucHV0KCdwcm9wZXJ0eV9pZCcsIGhhc2hNYXAuZ2V0KCdwcm9wZXJ0eV9pZCcpKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQptC10L3Ri3zQn9GA0L7QstC10YDQutCwINGG0LXQvScpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAndG9fcmVtYWlucyc6CiAgICAgICAgaGFzaE1hcC5wdXQoJ2dvb2RfYXJ0X2lucHV0JywgaGFzaE1hcC5nZXQoJ2dvb2RfYXJ0JykpCiAgICAgICAgaGFzaE1hcC5wdXQoInJldHVybl90b19nb29kX2NhcmQiLCAidHJ1ZSIpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdGVkX29iamVjdF9uYW1lJywgaGFzaE1hcC5nZXQoJ2dvb2RfbmFtZScpICsgIiwgIiArIGhhc2hNYXAuZ2V0KCdnb29kX2NvZGUnKSkKICAgICAgICBoYXNoTWFwLnB1dCgnb2JqZWN0X25hbWUnLCBoYXNoTWFwLmdldCgnZ29vZF9uYW1lJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3Byb3BlcnR5X2lkJywgaGFzaE1hcC5nZXQoJ3Byb3BlcnR5X2lkJykpCiAgICAgICAgaGFzaE1hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgJ29uU3RhcnQnKQogICAgICAgIGhhc2hNYXAucHV0KCdTaG93UHJvY2Vzc1Jlc3VsdCcsICfQntGB0YLQsNGC0LrQuHzQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcHJpY2VfdGFibGVzX29uX3N0YXJ0KGhhc2hNYXAsICBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBpZiBoYXNoTWFwLmdldCgncGFyZW50X3NjcmVlbicpID09ICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IjoKICAgICAgICBoYXNoTWFwLnB1dCgnY3VycmVudF9zY3JlZW5fbmFtZScsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnZXRfZ29vZF92YXJpYW50cyhoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzZWxlY3RlZF9nb29kX2lkID0gaGFzaE1hcC5nZXQoInNlbGVjdGVkX2dvb2RfaWQiKQogICAgYmFyY29kZSA9IGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykKCiAgICBpZiBiYXJjb2RlOgogICAgICAgIGdvb2RzX2JhcmNvZGUgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgKICAgICAgICAgICAgIlNFTEVDVCBiYXJjb2RlLGlkX3Byb3BlcnR5LGlkX3NlcmllcyxpZF91bml0IEZST00gUlNfYmFyY29kZXMgV0hFUkUgYmFyY29kZSA9ICciICsgYmFyY29kZSArCiAgICAgICAgICAgICInIikKCiAgICBlbGlmIHNlbGVjdGVkX2dvb2RfaWQ6CiAgICAgICAgZ29vZHNfYmFyY29kZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICAgICAiU0VMRUNUIGJhcmNvZGUsaWRfcHJvcGVydHksaWRfc2VyaWVzLGlkX3VuaXQgRlJPTSBSU19iYXJjb2RlcyBXSEVSRSBpZF9nb29kID0gJyIgKyBzZWxlY3RlZF9nb29kX2lkICsKICAgICAgICAgICAgIiciKQoKICAgIGlmIGxlbihnb29kc19iYXJjb2RlKSA+IDA6CiAgICAgICAgYmFyY29kZV9jYXJkcyA9IHVpX3RhYmxlc19zdHJ1Y3R1cmUuYmFyY29kZV9jYXJkcwogICAgICAgIGJhcmNvZGVfY2FyZHNbImN1c3RvbWNhcmRzIl1bImNhcmRzZGF0YSJdID0gW10KICAgICAgICBpID0gMAogICAgICAgIGZvciBlbGVtZW50IGluIGdvb2RzX2JhcmNvZGU6CiAgICAgICAgICAgIGMgPSB7ImtleSI6IHN0cihpKSwgImJhcmNvZGUiOiBlbGVtZW50WzBdLCAicHJvcGVydGllcyI6IGVsZW1lbnRbMV0sICJ1bml0IjogZWxlbWVudFszXSwKICAgICAgICAgICAgICAgICAic2VyaWVzIjogZWxlbWVudFsyXX0KCiAgICAgICAgICAgIGlmIGVsZW1lbnRbMV06CiAgICAgICAgICAgICAgICBjWydwcm9wZXJ0aWVzJ10gPSBnZXRfbmFtZV9ieV9maWVsZCgiUlNfcHJvcGVydGllcyIsICJpZCIsIGVsZW1lbnRbMV0pCiAgICAgICAgICAgIGlmIGVsZW1lbnRbM106CiAgICAgICAgICAgICAgICBjWyd1bml0J10gPSBnZXRfbmFtZV9ieV9maWVsZCgiUlNfdW5pdHMiLCAiaWQiLCBlbGVtZW50WzNdKQoKICAgICAgICAgICAgYmFyY29kZV9jYXJkc1siY3VzdG9tY2FyZHMiXVsiY2FyZHNkYXRhIl0uYXBwZW5kKGMpCiAgICAgICAgICAgIGkgKz0gMQogICAgICAgIGhhc2hNYXAucHV0KCJiYXJjb2RlX2NhcmRzIiwganNvbi5kdW1wcyhiYXJjb2RlX2NhcmRzKSkKICAgICAgICBoYXNoTWFwLnB1dCgibG9hZF9pbmZvIiwgIiIpCiAgICBlbHNlOgogICAgICAgIGhhc2hNYXAucHV0KCJsb2FkX2luZm8iLCAi0JTQsNC90L3Ri9C1INC+INGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LDRhSDQvtGC0YHRg9GC0YHRgtCy0YPRjtGCIikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBmaWxsX2VtcHR5X3ZhbHVlcyhoYXNoTWFwLCBuYW1lc19saXN0PWRpY3QoKSwgdmFsdWU9IiIpOgoKICAgIGZvciBrLCB2IGluIG5hbWVzX2xpc3QuaXRlbXMoKToKCiAgICAgICAgaWYgdiBpcyBOb25lIG9yIHYgPT0gIk5vbmUiOgogICAgICAgICAgICB2ID0gJycKICAgICAgICBpZiBsZW4odikgPT0gMDoKICAgICAgICAgICAgaGFzaE1hcC5wdXQoaywgdmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoaywgdikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiByZW1haW5zX29uX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBtb2RpZnlfY2FyZHMoaiwgaGlkZV9uYW1lPUZhbHNlLCB0aXRsZV9jb2xvcj0nJywgcmVwbGFjZV9ibGFuaz1GYWxzZSwgZGlzYWJsZV9vdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgY2FyZHNfbGF5b3V0X2VsZW1lbnRzID0galsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10KCiAgICBpZiBkaXNhYmxlX292ZXJyaWRlX3NlYXJjaDoKICAgICAgICBqWydjdXN0b21jYXJkcyddWydvcHRpb25zJ11bJ292ZXJyaWRlX3NlYXJjaCddID0gRmFsc2UKCiAgICBmb3IgZWxlbWVudCBpbiBjYXJkc19sYXlvdXRfZWxlbWVudHM6CiAgICAgICAgaWYgZWxlbWVudFsnVmFsdWUnXSA9PSAnQG5hbWUnOgogICAgICAgICAgICBpZiBjYXJkc19sYXlvdXRfZWxlbWVudHMuaW5kZXgoZWxlbWVudCkgPT0gMDoKICAgICAgICAgICAgICAgIGVsZW1lbnRbJ2dyYXZpdHlfaG9yaXpvbnRhbCddID0gImxlZnQiCiAgICAgICAgICAgICAgICBpZiB0aXRsZV9jb2xvcjoKICAgICAgICAgICAgICAgICAgICBlbGVtZW50WyJUZXh0Q29sb3IiXSA9IHRpdGxlX2NvbG9yCiAgICAgICAgICAgICAgICAjIGVsZW1lbnRbJ1ZhbHVlJ10gPSBzdHIoMCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGhpZGVfbmFtZToKCiAgICAgICAgICAgICAgICAgICAgIyBlbGVtZW50WyJzaG93X2J5X2NvbmRpdGlvbiJdID0gIlRydWUiCiAgICAgICAgICAgICAgICAgICAgZGVsIGNhcmRzX2xheW91dF9lbGVtZW50c1tjYXJkc19sYXlvdXRfZWxlbWVudHMuaW5kZXgoZWxlbWVudCldCgogICAgaWYgcmVwbGFjZV9ibGFuazoKICAgICAgICBjYXJkc19kYXRhID0galsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gY2FyZHNfZGF0YToKICAgICAgICAgICAgZm9yIGtleSwgdmFsIGluIGVsZW1lbnQuaXRlbXMoKToKICAgICAgICAgICAgICAgIGlmIHZhbCA9PSAnTm9uZScgb3IgdmFsID09ICIiOgogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRba2V5XSA9ICLigJQiCgogICAgcmV0dXJuIGoKCgpkZWYgZ2V0X25hbWVfYnlfZmllbGQodGFibGVfbmFtZSwgZmllbGQsIGZpZWxkX3ZhbHVlKToKCiAgICBxdWVyeSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICJTRUxFQ1QgbmFtZSBGUk9NICIgKyB0YWJsZV9uYW1lLnN0cmlwKCciXCcnKSArICIgV0hFUkUgIiArIGZpZWxkICsgJz0nICsgIiciICsgZmllbGRfdmFsdWUgKyAiJyIpCiAgICB0cnk6CiAgICAgICAgaWYgdHlwZShxdWVyeSkgPT0gInN0ciI6CiAgICAgICAgICAgIHJldHVybiBzdHIocXVlcnkpLnNwbGl0KCInIilbMV0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3RyKHF1ZXJ5WzBdKS5zcGxpdCgiJyIpWzFdCiAgICBleGNlcHQgSW5kZXhFcnJvcjoKICAgICAgICByZXR1cm4gZmllbGRfdmFsdWUKCgpkZWYgZ29vZF90eXBlc19vbl9zdGFydChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CgogICAgY2FyZHNfanNvbiA9IGdldF90YWJsZV9jYXJkcygnUlNfdHlwZXNfZ29vZHMnLCBleGNsdWRlX2xpc3Q9Wyd1c2VfbWFyayddLCBub19sYWJlbD1UcnVlKQoKICAgIGNhcmRzID0gbW9kaWZ5X2NhcmRzKGpzb24ubG9hZHMoY2FyZHNfanNvbiksIGhpZGVfbmFtZT1UcnVlLCBkaXNhYmxlX292ZXJyaWRlX3NlYXJjaD1UcnVlKQoKICAgIGhhc2hNYXAucHV0KCdjYXJkcycsIGpzb24uZHVtcHMoY2FyZHMpKQoKICAgICMgaGFzaE1hcC5wdXQoJ2NhcmRzJywgY2FyZHNfanNvbikKCiAgICByZXR1cm4gaGFzaE1hcAoKCmRlZiBnb29kX3R5cGVzX29uX2NsaWNrKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKCiAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CgogICAgICAgIHNlbGVjdGVkX3R5cGVfaWQgPSBoYXNoTWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9rZXknKQoKICAgICAgICBoYXNoTWFwLnB1dCgndHlwZV9pZCcsIHN0cihzZWxlY3RlZF90eXBlX2lkKSkKCiAgICAgICAgc2VsZWN0ZWRfdHlwZV9uYW1lID0gZ2V0X25hbWVfYnlfZmllbGQoIlJTX3R5cGVzX2dvb2RzIiwgImlkIiwgc2VsZWN0ZWRfdHlwZV9pZCkKCiAgICAgICAgaGFzaE1hcC5wdXQoJ3NlbGVjdF9nb29kc190eXBlJywgc2VsZWN0ZWRfdHlwZV9uYW1lKQoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCd0eXBlX2lkJywgJycpCiAgICAgICAgaGFzaE1hcC5wdXQoJ3R5cGVfbmFtZScsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCi0L7QstCw0YDRiyDRgdC/0LjRgdC+0LoiKQoKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIHJlbWFpbnNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3doX3NlbGVjdCc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JLRi9Cx0L7RgCDRgdC60LvQsNC00LAiKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2NlbGxfc2VsZWN0JzoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQktGL0LHQvtGAINGP0YfQtdC50LrQuCIpCiAgICBpZiBoYXNoTWFwLmdldCgnbGlzdGVuZXInKSA9PSAnZ2V0X3JlbWFpbnNfYnRuJzoKICAgICAgICBnZXRfcmVtYWlucyhoYXNoTWFwKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2JhcmNvZGUnOgogICAgICAgIGlkZW50aWZ5X2JhcmNvZGVfcmVtYWlucyhoYXNoTWFwKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAga2lsbF9yZW1haW5zX3RhYmxlcyhoYXNoTWFwKQogICAgICAgIGlmIGhhc2hNYXAuZ2V0KCdyZXR1cm5fdG9fZ29vZF9jYXJkJyk6CiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJGaW5pc2hQcm9jZXNzUmVzdWx0IiwgIiIpCiAgICAgICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCa0LDRgNGC0L7Rh9C60LAg0YLQvtCy0LDRgNCwIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgiRmluaXNoUHJvY2VzcyIsICIiKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgd2FyZWhvdXNlX29uX2lucHV0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdDYXJkc0NsaWNrJzoKICAgICAgICBzZWxlY3RlZF93aF9pZCA9IGhhc2hNYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgc2VsZWN0ZWRfd2hfbmFtZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KAogICAgICAgICAgICAiU0VMRUNUIG5hbWUgRlJPTSBSU193YXJlaG91c2VzIHdoZXJlIGlkID0gJyIgKyBzZWxlY3RlZF93aF9pZCArICInIikKICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfd2FyZWhvdXNlX2lkJywgc3RyKHNlbGVjdGVkX3doX2lkKSkKICAgICAgICBoYXNoTWFwLnB1dCgid2hfc2VsZWN0Iiwgc3RyKHNlbGVjdGVkX3doX25hbWVbMF0pLnNwbGl0KCInIilbMV0pCiAgICAgICAgaGFzaE1hcC5wdXQoJ2Vycm9yX21zZycsICcnKQogICAgICAgIGhhc2hNYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCiAgICAgICAgcmV0dXJuIGhhc2hNYXAKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdiYWNrX3RvX3JlbWFpbnMnIG9yICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGJhY2tfdG9fcmVtYWlucyhoYXNoTWFwKQogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgcmVtYWluc190YWJsZXNfb25faW5wdXQoaGFzaE1hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ3Nob3dfZmlsdGVycyc6CiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0J/RgNC+0LLQtdGA0LjRgtGMINC+0YHRgtCw0YLQutC4IikKICAgIGlmIGhhc2hNYXAuZ2V0KCdsaXN0ZW5lcicpID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGlmIG5vdCBoYXNoTWFwLmdldCgicmV0dXJuX3RvX2dvb2RfY2FyZCIpOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgncHJvcGVydHlfaWQnLCAnJykKICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ2JhcmNvZGUnLCAnJykKCiAgICAgICAgaWYgaGFzaE1hcC5nZXQoInJldHVybl90b19nb29kX2NhcmQiKToKICAgICAgICAgICAgaGFzaE1hcC5wdXQoIkJhY2tTY3JlZW4iLCAnJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBoYXNoTWFwLnB1dCgnc2VsZWN0ZWRfZ29vZF9pZCcsICcnKQoKICAgICAgICAgICAgaWYgaGFzaE1hcC5nZXQoImN1cnJlbnRfc2NyZWVuX25hbWUiKSA9PSAi0KLQsNCx0LvQuNGG0LAg0L7RgdGC0LDRgtC60L7QsiI6CiAgICAgICAgICAgICAgICBraWxsX3JlbWFpbnNfdGFibGVzKGhhc2hNYXApCiAgICAgICAgICAgICAgICBoYXNoTWFwLnB1dCgnU2hvd1NjcmVlbicsICfQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnKQogICAgICAgICAgICBlbGlmIGhhc2hNYXAuZ2V0KCJjdXJyZW50X3NjcmVlbl9uYW1lIikgPT0gItCi0LDQsdC70LjRhtCwINGG0LXQvSI6CiAgICAgICAgICAgICAgICBraWxsX3ByaWNlX3RhYmxlcyhoYXNoTWFwKQogICAgICAgICAgICAgICAgaGFzaE1hcC5wdXQoJ1Nob3dTY3JlZW4nLCAn0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gJ2JhcmNvZGUnOgogICAgICAgIGlkZW50aWZ5X2JhcmNvZGVfcmVtYWlucyhoYXNoTWFwKQogICAgaWYgaGFzaE1hcC5nZXQoJ2xpc3RlbmVyJykgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgIGhhc2hNYXAucHV0KCJ0b2FzdCIsIHN0cihoYXNoTWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpKSkKICAgIHJldHVybiBoYXNoTWFwCgoKZGVmIG9uX2Nsb3NlX2FwcChoYXNoTWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzdUNsYXNzLmRlbGV0ZUNhY2hlKCkKICAgIHJldHVybiBoYXNoTWFw",
        "PyTimerTask": [
            {
                "PyTimerTaskKey": "timer_update",
                "PyTimerTaskDef": "timer_update",
                "PyTimerTaskPeriod": "15000",
                "PyTimerTaskBuilIn": false
            }
        ],
        "PyFiles": [
            {
                "PyFileKey": "ui_csv",
                 "PyFileData": ""            },
            {
                "PyFileKey": "ui_global",
                 "PyFileData": ""            },
            {
                "PyFileKey": "ui_form_data",
                 "PyFileData": ""            },
            {
                "PyFileKey": "ui_form_data2",
                 "PyFileData": ""            },
            {
                "PyFileKey": "database_init_queryes",
                 "PyFileData": ""            },
            {
                "PyFileKey": "http_exchange",
                 "PyFileData": ""            },
            {
                "PyFileKey": "ui_utils",
                 "PyFileData": ""            },
            {
                "PyFileKey": "widgets",
                 "PyFileData": ""            },
            {
                "PyFileKey": "ui_models",
                 "PyFileData": ""            },
            {
                "PyFileKey": "db_services",
                 "PyFileData": ""            }
        ],
        "StyleTemplates": [],
        "arch2": true,
        "CommonHandlers": [
            {
                "event": "onLaunch",
                "action": "run",
                "type": "python",
                "method": "app_on_start",
                "postExecute": "",
                "alias": "on_start"
            },
            {
                "event": "onWebServiceSyncCommand",
                "action": "run",
                "type": "python",
                "method": "event_service",
                "postExecute": "",
                "alias": "event_service"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "put_notification",
                "postExecute": "",
                "alias": ""
            }
        ]
    }
}