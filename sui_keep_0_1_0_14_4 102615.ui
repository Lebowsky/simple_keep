{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.0.14.4",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Найдено по артикулам",
                                                "Variable": "finded_by_article",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "20",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f031",
                                "Variable": "btn_goods_ocr"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "6",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "btn_previous_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "@Good",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "btn_next_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Маркировка",
                                "Variable": "btn_marks_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good",
                                        "Variable": "id_good",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@code_art",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@unit_name",
                                        "Variable": "id_unit",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Групповая обработка",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "runprogress",
                                "type": "python",
                                "method": "gs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "CButtons"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Cинхронизировать данные с 1С",
                                "Variable": "sync_doc"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить все сканы на 1С",
                                "Variable": "send_all_scan_lines"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "7",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "@Good",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#7A005C",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_left",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_right",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "@delta",
                                                        "Variable": "delta",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "ModernEditText"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "Подтвердите действие",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@group_scan_message",
                                        "Variable": "group_scan_message",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Адресное хранение",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_adr_type_select",
                                                "Variable": "doc_adr_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docAdrCards",
                                        "Variable": "doc_adr_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_title",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "20",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "12",
                                                        "Elements": [
                                                            {
                                                                "Value": "",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "2",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "Elements": [
                                                            {
                                                                "Value": "Текущая ячейка: ",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@current_cell",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextSize": "20",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "10",
                                                "Elements": [
                                                    {
                                                        "Value": "х",
                                                        "Variable": "btn_clear_cell",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextSize": "18",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Табл.",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@tables_type",
                                                "Variable": "table_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выбрать ячейку",
                                "Variable": "btn_select_cell"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@item_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Сбор ШК",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Шаблон распознавания",
                                "Variable": "btn_ocr_serial_template_settings"
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_find_serial_cv"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "ШаблонРаспознавания",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Количество цифр",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_num_amount",
                                        "Variable": "ocr_serial_template_num_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Префикс",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_prefix",
                                        "Variable": "ocr_serial_template_prefix",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "@current_ocr_serial_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Универсальный справочник",
                "DefineOnBackPressed": false,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Справочник",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@cards",
                                        "Variable": "current_card",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "universal_cards_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "universal_cards_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Товары",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Товары список",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Категория:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_txt",
                                        "Variable": "error_txt",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Карточка товара",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "buttons",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Цены",
                                                "Variable": "to_prices",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Остатки",
                                                "Variable": "to_balances",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "name",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_name",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextSize": "22",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@item_key",
                                                "Variable": "item_key",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "good_info",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_type",
                                                "Variable": "good_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "art",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_art",
                                                        "Variable": "good_art",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "code",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Код:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_code",
                                                        "Variable": "good_code",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "descr",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Описание:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "CardsLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@load_info",
                                        "Variable": "load_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_item_good_barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_post_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор категории товаров ",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@goods_types_cards",
                                        "Variable": "goods_types_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Остатки",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверить остатки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Выбор склада:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "art",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул товара:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@item_art_input",
                                                                "Variable": "item_art_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "cell",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "info_block",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@error_msg",
                                        "Variable": "error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Запросить остатки",
                                        "Variable": "get_balance_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextSize": "15",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@balances_table",
                                        "Variable": "balances_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Цены",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверка цен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул товара:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "TextItalic": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "EditTextText"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "price_type",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Тип цены:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "properties",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Характеристики:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@property_select",
                                                                "Variable": "property_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "units",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Упаковка:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_object_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_price_type_name",
                                        "Variable": "selected_price_type_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_property_name",
                                        "Variable": "selected_property_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_unit_name",
                                        "Variable": "selected_unit_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@prices_error_msg",
                                        "Variable": "prices_error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_table",
                                        "Variable": "prices_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Параметры",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки и обмен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Разрешить ввод факт товара",
                                        "Variable": "allow_fact_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Оффлайн режим",
                                        "Variable": "offline_mode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Настройки HTTP подключения",
                                        "Variable": "btn_http_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки шрифтов",
                                        "Variable": "btn_size",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки звука",
                                        "Variable": "btn_sound_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки документов",
                                        "Variable": "btn_documents_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Тест сканера",
                                        "Variable": "btn_test_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Лог ошибок",
                                        "Variable": "btn_err_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить данные на  HTTP сервер",
                                        "Variable": "btn_upload_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Обмен с HTTP 1c сервером",
                                        "Variable": "btn_timer",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки печати",
                                        "Variable": "btn_print_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "СписокФайлов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@files_list",
                                        "Variable": "files_list",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "MultilineText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки Шрифтов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Размеры",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@TitleTextSize",
                                        "Variable": "TitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTitleTextSize",
                                        "Variable": "CardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardDateTextSize",
                                        "Variable": "CardDateTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTextSize",
                                        "Variable": "CardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@GoodsCardTitleTextSize",
                                        "Variable": "GoodsCardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@goodsTextSize",
                                        "Variable": "goodsTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@SeriesPropertiesTextSize",
                                        "Variable": "SeriesPropertiesTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@DocTypeCardTextSize",
                                        "Variable": "DocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@titleDocTypeCardTextSize",
                                        "Variable": "titleDocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_on_save",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_sizes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_size_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Тест сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_1",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_2",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_3",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_4",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_5",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_6",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_7",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "test_barcode_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Очистить",
                                                "Variable": "btn_clear_err",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "@date_sort_select",
                                                "Variable": "date_sort_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_log_table",
                                        "Variable": "error_log_table",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки http соединения",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@url",
                                        "Variable": "url",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user",
                                        "Variable": "user",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@pass",
                                        "Variable": "pass",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user_name",
                                        "Variable": "user_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@btn_test_connection",
                                        "Variable": "btn_test_connection",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@ANDROID_ID",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera2"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройка звука",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@event_cards",
                                        "Variable": "event_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки документов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Время хранения",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Укажите сколько дней документы будут храниться на устройстве.",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_delete_settings_days",
                                        "Variable": "doc_delete_settings_days",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Удалять устаревшие документы",
                                        "Variable": "doc_settings_confirm_delete_old_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Отладка",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Отладочный экран",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить лог",
                                        "Variable": "btn_unload_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Удалять файлы после загрузки",
                                        "Variable": "delete_files",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Загрузить локальные csv файлы",
                                        "Variable": "btn_local_files",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить изменения в csv ",
                                        "Variable": "btn_export",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Создать таблицы БД",
                                        "Variable": "btn_init",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Заполнить Ratio",
                                        "Variable": "btn_fill_ratio",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_listener",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Печать",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки печати",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройка Bluetooth принтера",
                                        "Variable": "btn_bluetooth_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка WiFi принтера",
                                        "Variable": "btn_wifi_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка шаблонов печати",
                                        "Variable": "btn_label_templates_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Печать через Bluetooth",
                                        "Variable": "check_box_bluetooth_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Печать через WiFi",
                                        "Variable": "check_box_wifi_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Список шаблонов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@templates_cards",
                                        "Variable": "templates_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Результат",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Шаблон:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@html",
                                        "Variable": "html",
                                        "height": "300",
                                        "width": "match_parent",
                                        "orientation": "vertical",
                                        "weight": "3",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "html"
                                    },
                                    {
                                        "Value": "@matching_table",
                                        "Variable": "matching_table_values",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Параметры штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Ширина",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_width",
                                                "Variable": "barcode_width",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Высота",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_height",
                                                "Variable": "barcode_height",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Тип:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_types",
                                                "Variable": "barcode_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Влево",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_left",
                                                "Variable": "barcode_left",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вправо",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_right",
                                                "Variable": "barcode_right",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вверх",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_up",
                                                "Variable": "barcode_up",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вниз",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_down",
                                                "Variable": "barcode_down",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "НастройкаСоответствияДиалог",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "layout",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@list_field",
                                        "Variable": "select_field",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "SpinnerLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Bluetooth",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки принтера Bluetooth",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать присоединенные",
                                        "Variable": "btn_show_connected",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Начать сканирование",
                                        "Variable": "btn_start_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Остановить сканирование",
                                        "Variable": "btn_stop_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_print",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Сбросить подключение",
                                        "Variable": "btn_bt_disconnect",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Подключенный принтер:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@default_printer",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "set",
                                "method": "BTGetBounded",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати WiFi",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Укажите ip устройства",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_ip",
                                        "Variable": "wi_fi_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Сохранить IP",
                                        "Variable": "btn_wifi_save_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить IP",
                                        "Variable": "btn_wifi_delete_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@info_wifi_current_ip",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_wi_fi",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Код ZPL для печати:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_zpl_input",
                                        "Variable": "wi_fi_zpl_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Напечатать zpl",
                                        "Variable": "btn_wi_fi_print_zpl",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Шаблоны",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки шаблонов ценников и этикеток",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Получить шаблоны с сервера",
                                        "Variable": "btn_get_labels",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@current_label_template_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Выбрать из списка",
                                        "Variable": "btn_select_label_template",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить настройки шаблонов печати",
                                        "Variable": "btn_delete_template_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка размеров шаблона",
                                        "Variable": "btn_label_template_size_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@preview_label_template_image",
                                        "Variable": "",
                                        "height": "300",
                                        "width": "match_parent",
                                        "weight": "3",
                                        "type": "Picture"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Размеры",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "label Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@width_print_template",
                                                        "Variable": "width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Label Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@height_print_template",
                                                        "Variable": "height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Img Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_width_print_template",
                                                        "Variable": "image_width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Img Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_height_print_template",
                                                        "Variable": "image_height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "LL",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_ll_print_template",
                                                        "Variable": "image_ll_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "PW",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_pw_print_template",
                                                        "Variable": "image_pw_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сдвиг вправо",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_x_print_template",
                                                        "Variable": "image_x_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Сдвиг вниз",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_y_print_template",
                                                        "Variable": "image_y_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "dpmm",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "6;8;12;24",
                                                        "Variable": "dpmm_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            }
                                        ],
                                        "StrokeWidth": "5"
                                    },
                                    {
                                        "Value": "@image_print",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Picture"
                                    }
                                ],
                                "StrokeWidth": "5"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить на печать",
                                "Variable": "btn_sent_to_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Сохранить шаблон",
                                "Variable": "btn_save_template_sizes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Удалить шаблон",
                                "Variable": "btn_delete_print_template"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Проводник",
                "DefineOnBackPressed": false,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проводник файлов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Вверх",
                                        "Variable": "btn_get_up",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@file_browser_cards",
                                        "Variable": "file_browser_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SeriesProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SeriesSelectScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@properties_name",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@series_cards",
                                        "Variable": "series_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_series_ocr_serial_number"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Настройки шаблона",
                                "Variable": "btn_ocr_serial_template_settings"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "FillingSeriesScreen",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "1",
                                "Elements": [
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Имя серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@name",
                                                "Variable": "name",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Номер серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@number",
                                                "Variable": "number",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Дата производства:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@production_date",
                                                "Variable": "production_date",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Годен до: ",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@best_before",
                                                "Variable": "best_before",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Количество:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@FillingSeriesScreen_qtty",
                                                "Variable": "FillingSeriesScreen_qtty",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "orientation": "horizontal",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "CVOperationName": "Распознавание артикулов",
                "type": "CVOperation",
                "hidden": true,
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "OCR",
                        "CVResolution": "VGA",
                        "CVMode": "list_and_grey",
                        "CVActionButtons": "Обработать",
                        "CVAction": "Поиск по артикулу",
                        "CVInfo": "@art_info",
                        "CVCameraDevice": "Back",
                        "Handlers": [
                            {
                                "event": "OnObjectDetected",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_object_detected",
                                "postExecute": ""
                            },
                            {
                                "event": "OnInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "OnCreate",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SelectItemProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SelectItemScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@cards_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowItemsScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "BarcodeRegistration",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "BarcodeRegistration",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод товара",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "22",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good_name_barcode",
                                        "Variable": "good_name_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Штрихкод:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@scanned_barcode",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "properties",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Характеристика:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@property_select",
                                                "Variable": "property_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "units",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Упаковка:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@unit_select",
                                                "Variable": "unit_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_ok",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@barcodes_data",
                                        "Variable": "barcodes_data",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_click",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "OcrTextRecognition",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SerialNumberOCRSettings",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Количество цифр",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_num_amount",
                                                "Variable": "ocr_serial_template_num_amount",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Префикс",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_prefix",
                                                "Variable": "ocr_serial_template_prefix",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@ocr_serial_current_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_save_ocr_settings",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple",
            "vendor_url": "",
            "vendor_auth": "",
            "handler_split_mode": false,
            "handler_code": "",
            "handler_url": "",
            "handler_auth": "",
            "dictionaries": ""
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "FaceRecognitionURL": "",
        "ForegroundService": false,
        "StopForegroundServiceOnExit": false,
        "RunPython": true,
        "LaunchProcess": "",
        "MainMenu": [
            {
                "MenuId": "01",
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuTop": false
            },
            {
                "MenuId": "02",
                "MenuItem": "update_conf",
                "MenuTitle": "Обновить конфигурацию",
                "MenuTop": false
            }
        ],
        "Mediafile": [],
        "PyHandlers": "aW1wb3J0IGpzb24KCmltcG9ydCB1aV9nbG9iYWwKaW1wb3J0IHVpX2Zvcm1fZGF0YQoKZnJvbSBuZXdfaGFuZGxlcnMgaW1wb3J0ICoKCgpkZWYgZGVsZXRlX2JhcmNvZGVfc2NyZWVuX3N0YXJ0KGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgICMg0J3QsNGF0L7QtNC40LwgSUQg0LTQvtC60YPQvNC10L3RgtCwCiAgICBiYXJjb2RlX2RhdGEgPSBqc29uLmxvYWRzKGhhc2hNYXAuZ2V0KCdiYXJjb2RlJykpWydiYXJjb2RlJ10KICAgICMg0J3QsNC50LTQtdC8INC90YPQttC90YvQtSDQv9C+0LvRjyDQt9Cw0L/RgNC+0YHQvtC8INC6INCx0LDQt9C1CiAgICBxdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfbWFya2NvZGVfcXVlcnkoKQogICAgYXJncyA9IHsnaWRfZG9jJzogaGFzaE1hcC5nZXQoJ2lkX2RvYycpLAogICAgICAgICAgICAnR1RJTic6IGJhcmNvZGVfZGF0YVsnR1RJTiddLCAnU2VyaWVzJzogYmFyY29kZV9kYXRhWydTRVJJQUwnXX0KCiAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgYXJncywgVHJ1ZSkKCiAgICBoYXNoTWFwLnB1dCgnY3VycmVudFN0cicsIGpzb24uZHVtcHMocmVzWzBdKSkKICAgIGhhc2hNYXAucHV0KCJDdXJTdHIiLCBzdHIocmVzWzBdWydDdXJTdHInXSkpCiAgICBoYXNoTWFwLnB1dCgiZ29vZCIsIHJlc1swXVsnZ29vZF9uYW1lJ10pCiAgICBoYXNoTWFwLnB1dCgiJ2NvZGVfYXJ0JyIsIHJlc1swXVsnZ29vZF9jb2RlJ10pCiAgICBoYXNoTWFwLnB1dCgidW5pdF9uYW1lIiwgc3RyKHJlc1swXVsndW5pdCddKSkKICAgIGhhc2hNYXAucHV0KCdiYXJjb2RlX3ZhbHVlJywgJzAxJyArIGJhcmNvZGVfZGF0YVsnR1RJTiddICsgJzIxJyArIGJhcmNvZGVfZGF0YVsnU0VSSUFMJ10pCgogICAgcmV0dXJuIGhhc2hNYXAKCgpkZWYgZGVsZXRlX2JhcmNvZGVfc2NyZWVuX2NsaWNrKGhhc2hNYXAsIF9maWxlcz1Ob25lLCBfZGF0YT1Ob25lKToKICAgIGxpc3RlbmVyID0gaGFzaE1hcC5nZXQoImxpc3RlbmVyIikKICAgIGlmIGxpc3RlbmVyID09ICJidG5fYmFyY29kZV9jYW5jZWwiOgoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgogICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2JhcmNvZGVfZGVsZXRlIjoKICAgICAgICBkb2MgPSB1aV9nbG9iYWwuUnNfZG9jCiAgICAgICAgZG9jLmlkX2RvYyA9IGhhc2hNYXAuZ2V0KCdpZF9kb2MnKQogICAgICAgIGN1cnJlbnRfYmFyY29kZV9zdHIgPSBpbnQoaGFzaE1hcC5nZXQoIkN1clN0ciIpKQogICAgICAgIGVsID0ganNvbi5sb2FkcyhoYXNoTWFwLmdldCgnY3VycmVudFN0cicpKQoKICAgICAgICAjIGRvYy5pZF9zdHIgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAjIGRvYy5xdHR5ID0gZmxvYXQoaGFzaE1hcC5nZXQoJ3F0dHknKSkKICAgICAgICAjIGRvYy51cGRhdGVfZG9jX3N0cihkb2MsIGhhc2hNYXAuZ2V0KCdwcmljZScpKQogICAgICAgIHF1ZXJ5X3RleHQgPSAnVXBkYXRlICBSU19kb2NzX2JhcmNvZGVzIFNFVCBhcHByb3ZlZD0/IFdoZXJlIGlkPT8nCiAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKCcwJywgY3VycmVudF9iYXJjb2RlX3N0cikpCiAgICAgICAgZG9jLnVwZGF0ZV9kb2NfdGFibGVfZGF0YShkb2MsIGVsLCAtMSkKCiAgICAgICAgaGFzaE1hcC5wdXQoIlNob3dTY3JlZW4iLCAi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICBoYXNoTWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCiAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgIGhhc2hNYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICByZXR1cm4gaGFzaE1hcAoK",
        "pyHandlersPath": "C:/Work/simple_keep/simple_keep\\main.py",
        "PyTimerTask": [
            {
                "PyTimerTaskKey": "timer_update",
                "PyTimerTaskDef": "timer_update",
                "PyTimerTaskPeriod": "15000",
                "PyTimerTaskBuilIn": false
            }
        ],
        "PyFiles": [
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\database_init_queryes.py",
                "PyFileKey": "database_init_queryes",
                "PyFileData": "I2ltcG9ydCB1aV9nbG9iYWwKZGVmIGRhdGFiYXNlX3NoZW1hKCk6CiAgICBScyA9IFtdCgoKICAgICPQmtC+0L3RgdGC0LDQvdGC0Ysg0Lgg0YXRgNCw0L3QuNC80YvQtSDQvdCw0YHRgtGA0L7QudC60LggUlNfY29uc3RhbnRzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19jb25zdGFudHMgKAogICAgICAgIGlkICAgICAgICAgICAgIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICB1c2Vfc2VyaWVzICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgdXNlX3Byb3BlcnRpZXMgVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHVzZV9tYXJrICAgICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBhZGRfaWZfbm90X2luX3BsYW4gICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBwYXRoICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUZBVUxUICIvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvIiwKICAgICAgICBkZWxldGVfZmlsZXMgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgcmVzZXJ2ZWQgICAgICAgVEVYVCAgICBOT1QgTlVMTCwKICAgICAgICBtYXhfaWRfZG9jICAgICAgICAgSU5URUdFUiBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMSksCiAgICAgICAgYWxsb3dfb3ZlcnNjYW4gVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHJlbGVhc2UgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCgogICAgIyDQmtC70LDRgdGB0LjRhNC40LrQsNGC0L7RgCDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPIFJTX2NsYXNzaWZpZXJfdW5pdHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NsYXNzaWZpZXJfdW5pdHMgKAogICAgICAgIGlkIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgY29kZSAgICBURVhUIE5PVCBOVUxMLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICMg0JLQuNC00Ysg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3R5cGVzX2dvb2RzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU190eXBlc19nb29kcyAoCiAgICBpZCAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgbmFtZSAgICAgVEVYVCBOT1QgTlVMTCwKICAgIHVzZV9tYXJrIElOVCAgREVGQVVMVCAoMCkgCiAgICApCiAgICAnJycpCgogICAgIyDQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAgUlNfZ29vZHMKICAgIFJzLmFwcGVuZCgnJycKICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19nb29kcyAoCiAgICAgICAgICAgIGlkICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgICAgIGNvZGUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIG5hbWUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIGFydCAgICAgICAgIFRFWFQsCiAgICAgICAgICAgIHVuaXQgICAgICAgIFRFWFQgIFJFRkVSRU5DRVMgUlNfY2xhc3NpZmllcl91bml0cyAoaWQpLAogICAgICAgICAgICB0eXBlX2dvb2QgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU190eXBlc19nb29kcyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVRDSCBbRlVMTF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQKICAgICAgICApCiAgICAgICAgJycnKQoKCiAgICAjINCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3Byb3BlcnRpZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3Byb3BlcnRpZXMgKAogICAgaWQgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBPTiBDT05GTElDVCBSRVBMQUNFLAogICAgaWRfb3duZXIgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCkgT04gREVMRVRFIE5PIEFDVElPTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gVVBEQVRFIE5PIEFDVElPTiwKICAgIG5hbWUgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCgogICAgIyDQo9C/0LDQutC+0LLQutC4INCV0LTQuNC90LjRhtGLINC40LfQvNC10YDQtdC90LjRjyBSU191bml0cwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfdW5pdHMgKAogICAgICAgIGlkICAgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgaWRfb3duZXIgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBjb2RlICAgICAgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgbmFtZSAgICAgICAgICBURVhUICAgIE5PVCBOVUxMLAogICAgICAgIG5vbWluYXRvciAgICAgSU5URUdFUiBOT1QgTlVMTCwKICAgICAgICBkZW5vbWluYXRvciAgIElOVEVHRVIgTk9UIE5VTEwsCiAgICAgICAgaW50X3JlZHVjdGlvbiBURVhUICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgoKCiAgICAjINCh0LXRgNC40Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3NlcmllcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfc2VyaWVzICgKICAgICAgICBpZCAgICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBiZXN0X2JlZm9yZSAgICAgVEVYVCwKICAgICAgICB0eXBlX2dvb2RzICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBwcm9kdWN0aW9uX2RhdGUgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICPQmNC90LTQtdC60YHRiyBSU19zZXJpZXMKICAgIFJzLmFwcGVuZCgnJydDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyAgU2VyaWVzX25hbWUgT04gUlNfc2VyaWVzICgKICAgIG5hbWUgQVNDICkKICAgICcnJykKCiAgICAjINCo0YLRgNC40YXQutC+0LTRiyBSU19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCAnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNvZGVzICgKICAgIGJhcmNvZGUgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBpZF9nb29kICAgICBURVhUIE5PVCBOVUxMLAogICAgaWRfcHJvcGVydHkgVEVYVCwKICAgIGlkX3NlcmllcyAgIFRFWFQsCiAgICBpZF91bml0ICAgICBURVhULAogICAgcmF0aW8gICAgICAgSU5UICBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgogICAgI9Ca0L7QtNGLINC80LDRgNC60LjRgNC+0LLQutC4IFJTX21hcmtpbmdfY29kZXMKICAgIFJzLmFwcGVuZCggJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19tYXJraW5nX2NvZGVzICgKICAgICAgICBpZCAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBtYXJrX2NvZGUgICBURVhUIE5PVCBOVUxMLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9wcm9wZXJ0eSBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSAKICAgICkKICAgICcnJykKCgoKICAgICMg0JrQvtC90YLRgNCw0LPQtdC90YLRiyBSU19jb3VudHJhZ2VudHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NvdW50cmFnZW50cyAoCiAgICAgICAgaWQgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgbmFtZSAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgZnVsbF9uYW1lIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgaW5uICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAga3BwICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCh0LrQu9Cw0LTRiyBSU193YXJlaG91c2VzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU193YXJlaG91c2VzICgKICAgICAgICBpZCBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NlbGxzICgKICAgIGlkICAgVEVYVCBQUklNQVJZIEtFWQogICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgbmFtZSBURVhUIE5PVCBOVUxMLAogICAgYmFyY29kZSBURVhUCiAgICApJycnKQoKICAgICMg0JLQuNC00Ysg0YbQtdC9INC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZV90eXBlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfcHJpY2VfdHlwZXMgKAogICAgICAgIGlkICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCm0LXQvdGLINC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3ByaWNlcyAoCiAgICAgICAgaWQgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX3ByaWNlX3R5cGVzIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBpZF9nb29kcyAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICAgICAgaWRfcHJvcGVydGllcyAgVEVYVCAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgcHJpY2UgICAgICAgICAgUkVBTCwKICAgICAgICBpZF91bml0ICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3VuaXRzIChpZCkgCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jX3R5cGVzICgKICAgIGRvY190eXBlIFRFWFQgUFJJTUFSWSBLRVkgT04gQ09ORkxJQ1QgUkVQTEFDRQogICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICBpc19hZHJfc3RvcmFnZSBJTlQgIERFRkFVTFQgKDApIAogICAgKQogICAgJycnKQoKICAgICMg0JLRgdC1INC00L7QutGD0LzQtdC90YLRiyDRgdC/0LjRgdC60L7QvCBSU19kb2NzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfY291bnRyYWdlbnRzICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfY291bnRyYWdlbnRzIChpZCksCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUIERFRkFVTFQgMCwKICAgICAgICBpc19ncm91cF9zY2FuICAgICAgVEVYVCBERUZBVUxUIDAsCiAgICAgICAgaXNfYmFyY19mbG93ICAgICAgIFRFWFQgREVGQVVMVCAwLAogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgICBURVhUIERFRkFVTFQgMAogICAgICAgIAogICAgKQogICAgJycnKQoKCiAgICAjINCi0LDQsdC70LjRh9C90LDRjyDRh9Cw0YHRgtGMINC00L7QutGD0LzQtdC90YLQvtCyIFJTX2RvY3NfdGFibGUKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfdGFibGUgKAogICAgICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICBpZF9kb2MgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICAgICAgaWRfZ29vZCAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgICAgIGlkX3Byb3BlcnRpZXMgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgaWRfc2VyaWVzICAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSwKICAgICAgICBxdHR5ICAgICAgICAgIFJFQUwsCiAgICAgICAgZF9xdHR5ICAgICAgICBSRUFMLCAgCiAgICAgICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgICAgIHByaWNlICAgICAgICAgUkVBTCwKICAgICAgICBpZF9wcmljZSAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBzZW50ICAgICAgICAgIElOVEVHRVIsCiAgICAgICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGlzX3BsYW4gICAgICAgVEVYVCBERUZBVUxUICJUcnVlIiwKICAgICAgICBpZF9jZWxsICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgSU5URUdFUiBERUZBVUxUIDAgCiAgICApCiAgICAnJycpCgoKICAgICMg0JrQvtC00Ysg0LzQsNGA0LrQuNGA0L7QstC60Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1IFJTX2RvY3NfYmFyY29kZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfYmFyY29kZXMgKAogICAgaWQgICAgICAgICAgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgaWRfZG9jICAgICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUsCiAgICBpZF9nb29kICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydHkgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJvcGVydGllcyAoaWQpLAogICAgaWRfc2VyaWVzICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfc2VyaWVzIChpZCksCiAgICBpZF91bml0ICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpICwKICAgIG1hcmtfY29kZSAgICAgICAgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICBiYXJjb2RlX2Zyb21fc2Nhbm5lciAgICBURVhULAogICAgaXNfcGxhbiAgICAgICAgICAgICAgICAgSU5URUdFUiBERUZBVUxUIDAgTk9UIE5VTEwsCiAgICBhcHByb3ZlZCAgICAgICAgICAgICAgICBJTlRFR0VSIERFRkFVTFQgMCwKICAgIEdUSU4gICAgICAgICAgICAgICAgICAgIFRFWFQsCiAgICBTZXJpZXMgICAgICAgICAgICAgICAgICBURVhUCiAgICApCiAgICAnJycpCgogICAgI9Cf0L7RgtC+0Log0L/RgNC+0LjQt9Cy0L7Qu9GM0L3Ri9GFINGI0YLRgNC40YXQutC+0LTQvtCyCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19iYXJjX2Zsb3cgKAogICAgaWRfZG9jICBURVhUIFJFRkVSRU5DRVMgUlNfZG9jcyAoaWRfZG9jKSwKICAgIGJhcmNvZGUgVEVYVAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzICgKICAgIGlkX2RvYyAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX24gICAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX2RhdGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICB2ZXJpZmllZCAgICAgICAgICAgSU5URUdFUiwKICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgYWRkX21hcmtfc2VsZWN0aW9uIElOVEVHRVIsCiAgICBjcmVhdGVkX2F0ICAgICAgICAgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwKICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICBERUZBVUxUIDAsCiAgICBhbGxvd19mYWN0X2lucHV0ICAgVEVYVCBERUZBVUxUIDAKICAgIAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzX3RhYmxlICgKICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19hZHJfZG9jcyAoaWRfZG9jKSBPTiBERUxFVEUgQ0FTQ0FERQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBTRVQgREVGQVVMVCwKICAgIGlkX2dvb2QgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydGllcyBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpLAogICAgcXR0eSAgICAgICAgICBSRUFMLAogICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgc2VudCAgICAgICAgICBJTlRFR0VSLAogICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiAgICAgICBURVhUICAgICBERUZBVUxUIFRydWUsCiAgICBpZF9jZWxsICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwgCiAgICB0YWJsZV90eXBlICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFQgJ291dCcsCiAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkKICAgICkKICAgICcnJykKCiAgICBScy5hcHBlbmQoJycnCiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRXJyb3JfbG9nICgKICAgICAgICBsb2cgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoJycpLAogICAgICAgIHRpbWVzdGFtcCBEQVRFVElNRSBERUZBVUxUIChDVVJSRU5UX1RJTUVTVEFNUCkpIAogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgbmFtZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX2JhcmNvZGUgT04gUlNfY2VsbHMgKAogICAgYmFyY29kZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3Nfc2VyaWVzICgKICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsCiAgICBpZF9kb2MgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICBpZF9nb29kICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICBpZF9wcm9wZXJ0aWVzICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3dhcmVob3VzZSAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3dhcmVob3VzZXMgKGlkKSwKICAgIHF0dHkgICAgICAgICAgICBSRUFMLAogICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgYmVzdF9iZWZvcmUgICAgIERBVEVUSU1FLAogICAgbnVtYmVyICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgY2VsbCAgICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSBPTiBERUxFVEUgTk8gQUNUSU9OCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICknJycpCgoKCiMgUlNfY29uc3RhbnRzICsgUlNfY2xhc3NpZmllcl91bml0cyArIFJTX3R5cGVzX2dvb2RzCiMgICAgIFJzID0gKyBSU19nb29kcyArIFJTX3Byb3BlcnRpZXNcCiMgICAgICAgICAgKyBSU19zZXJpZXMgKyBSU191bml0cyArIFJTX2JhcmNvZGVzICsgUlNfbWFya2luZ19jb2RlcyArIFJTX2RvY3MgKyBSU19kb2NzX2JhcmNvZGVzXAojICAgICAgICAgICsgUlNfZG9jc190YWJsZSArIFJTX3ByaWNlX3R5cGVzICsgUlNfcHJpY2VzICsgUlNfY291bnRyYWdlbnRzICsgUlNfd2FyZWhvdXNlcwoKICAgIHJldHVybiBScwojcHJpbnQoZGF0YWJhc2Vfc2hlbWEoKSkKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2NvbnN0YW50cykKICAgICMgUnMuYXBwZW5kKFJTX2NsYXNzaWZpZXJfdW5pdHMpCiAgICAjIFJzLmFwcGVuZChSU190eXBlc19nb29kcykKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2dvb2RzKQogICAgIyBScy5hcHBlbmQoUlNfcHJvcGVydGllcykKICAgICMgUnMuYXBwZW5kKFJTX3NlcmllcykKICAgICMgUnMuYXBwZW5kKFJTX3VuaXRzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19tYXJraW5nX2NvZGVzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfZG9jcykKICAgICMgUnMuYXBwZW5kKFJTX2RvY3NfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19kb2NzX3RhYmxlKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfcHJpY2VfdHlwZXMpCiAgICAjIFJzLmFwcGVuZChSU19wcmljZXMpCiAgICAjCiAgICAjIFJzLmFwcGVuZChSU19jb3VudHJhZ2VudHMpCiAgICAjIFJzLmFwcGVuZChSU193YXJlaG91c2VzKQogICAgI3VpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KFJzKQoK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\db_services.py",
                "PyFileKey": "db_services",
                "PyFileData": "aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YSwgdGltZXpvbmUKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIExpdGVyYWwsIE9wdGlvbmFsCgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVTUUxQcm92aWRlciBhcyBzcWxDbGFzcwpmcm9tIHVpX2dsb2JhbCBpbXBvcnQgZ2V0X3F1ZXJ5X3Jlc3VsdCwgYnVsa19xdWVyeQpmcm9tIHRpbnlfZGJfc2VydmljZXMgaW1wb3J0IFRpbnlOb1NRTFByb3ZpZGVyLCBTY2FubmluZ1F1ZXVlU2VydmljZQoKCmNsYXNzIERiU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc3FsX2NsYXNzPXNxbENsYXNzKCkpCgogICAgZGVmIF93cml0ZV9lcnJvcl9vbl9sb2coc2VsZiwgZXJyb3JfdGV4dDogc3RyKToKICAgICAgICBpZiBlcnJvcl90ZXh0OgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnRXJyb3JfbG9nJwogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZSh7J2xvZyc6IGVycm9yX3RleHR9KQogICAgICAgICAgICBzZWxmLnNxbF90ZXh0ID0gc2VsZi5wcm92aWRlci5zcWxfdGV4dAogICAgICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9wYXJhbXMKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtczogc3RyID0gJycsIHRhYmxlX25hbWU9JycpOgoKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCgpjbGFzcyBUaW1lclNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2ludF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQoKICAgIGRlZiBzYXZlX2xvYWRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX3ByZXBhcmVfZGF0YV90b19zYXZlKGRhdGEpCgogICAgICAgIGNsZWFyX3RhYmxlcyA9IFsnUlNfZG9jc190YWJsZScsICdSU19hZHJfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfZG9jc19zZXJpZXMnXQoKICAgICAgICBmb3IgdGFibGVfbmFtZSwgdmFsdWVzIGluIGRhdGEuaXRlbXMoKToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiBjbGVhcl90YWJsZXMgYW5kIHZhbHVlczoKICAgICAgICAgICAgICAgIGlkX2RvYyA9IHZhbHVlc1swXVsnaWRfZG9jJ10KICAgICAgICAgICAgICAgIF9maWx0ZXIgPSB7J2lkX2RvYyc6IGlkX2RvY30KCiAgICAgICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyKQogICAgICAgICAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKHZhbHVlcykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucHJvdmlkZXIucmVwbGFjZSh2YWx1ZXMpCgogICAgZGVmIF9wcmVwYXJlX2RhdGFfdG9fc2F2ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiAnUlNfZG9jc19iYXJjb2RlcycgaW4gZGF0YToKICAgICAgICAgICAgZG9jc19iYXJjb2RlcyA9IFtdCiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXToKICAgICAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYucGFyc2VfYmFyY29kZShpdGVtWydtYXJrX2NvZGUnXSkKICAgICAgICAgICAgICAgIGRvY3NfYmFyY29kZXMuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGl0ZW1bJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGl0ZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogaXRlbVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IGl0ZW1bJ2lkX3NlcmllcyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGl0ZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmtfY29kZSc6IGl0ZW1bJ21hcmtfY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZV9mcm9tX3NjYW5uZXInOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2lzX3BsYW4nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcHJvdmVkJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdHVElOJzogYmFyY29kZV9kYXRhWydHVElOJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdTZXJpZXMnOiBiYXJjb2RlX2RhdGFbJ1NlcmllcyddCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBkYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NzX2JhcmNvZGVzCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsID0gdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKS5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBndGluID0gdmFsWzI6MTZdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZ3RpbiA9IHZhbFs6MTRdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBndGluLCAnU2VyaWVzJzogc2VyaWVzfQoKICAgIGRlZiBnZXRfbmV3X2xvYWRfZG9jcyhzZWxmLCBkYXRhOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGxvYWRlZF9kb2N1bWVudHMgPSB7fQoKICAgICAgICBmb3IgZG9jX3R5cGUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ106CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGEuZ2V0KGRvY190eXBlLCBbXSk6CiAgICAgICAgICAgICAgICBsb2FkZWRfZG9jdW1lbnRzW2l0ZW1bJ2lkX2RvYyddXSA9IGl0ZW0KCiAgICAgICAgaWYgbm90IGxvYWRlZF9kb2N1bWVudHM6CiAgICAgICAgICAgIHJldHVybiBsb2FkZWRfZG9jdW1lbnRzCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MKICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzCiAgICAgICAgJycnCgogICAgICAgIGRiX2RvY3MgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQogICAgICAgIGZvciBkb2MgaW4gZGJfZG9jczoKICAgICAgICAgICAgaWYgZG9jWydpZF9kb2MnXSBpbiBsb2FkZWRfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbG9hZGVkX2RvY3VtZW50cy5wb3AoZG9jWydpZF9kb2MnXSkKCiAgICAgICAgcmV0dXJuIGxvYWRlZF9kb2N1bWVudHMKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICBkYXRhID0gRG9jU2VydmljZSgpLmdldF9kYXRhX3RvX3NlbmQoKSArIEFkckRvY1NlcnZpY2UoKS5nZXRfZGF0YV90b19zZW5kKCkKICAgICAgICByZXR1cm4gZGF0YQoKCmNsYXNzIEJhcmNvZGVTZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUnNfYmFyY29kZXMnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKCiAgICBkZWYgYWRkX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZShiYXJjb2RlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2RlX2RhdGEoc2VsZiwgYmFyY29kZV9pbmZvLCBpZF9kb2MsIGlzX2Fkcl9kb2M9RmFsc2UsIGlkX2NlbGw9JycsIHRhYmxlX3R5cGU9JycpOgogICAgICAgIGlmIGJhcmNvZGVfaW5mby5zY2hlbWUgPT0gJ0dTMSc6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5ndGluWzE6XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5iYXJjb2RlCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCBpZF9jZWxsOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdpZF9jZWxsIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCB0YWJsZV90eXBlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd0YWJsZV90eXBlIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgJ3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLnByaWNlJywKICAgICAgICAgICAgJ2lkX3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLmlkX3ByaWNlJywKICAgICAgICAgICAgJ2RfcXR0eV9maWVsZCc6ICdkb2NfdGFibGUucXR0eScgaWYgaXNfYWRyX2RvYyBlbHNlICdkb2NfdGFibGUuZF9xdHR5JywKICAgICAgICAgICAgJ3VzZV9tYXJrX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZ29vZHMudXNlX21hcmsnLAogICAgICAgICAgICAnZG9jc190YWJsZSc6ICdSU19hZHJfZG9jc190YWJsZScgaWYgaXNfYWRyX2RvYyBlbHNlICdSU19kb2NzX3RhYmxlJywKICAgICAgICAgICAgJ2NlbGxfY29uZGl0aW9uJzogZidBTkQgZG9jX3RhYmxlLmlkX2NlbGwgPSAie2lkX2NlbGx9IicgaWYgaXNfYWRyX2RvYyBlbHNlICcnLAogICAgICAgICAgICAndGFibGVfdHlwZV9jb25kaXRpb24nOiBmJ0FORCBkb2NfdGFibGUudGFibGVfdHlwZSA9ICJ7dGFibGVfdHlwZX0iJyBpZiBpc19hZHJfZG9jIGVsc2UgJycsCiAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgICdndGluJzogYmFyY29kZV9pbmZvLmd0aW4sCiAgICAgICAgICAgICdzZXJpZXMnOiBiYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlYXJjaF92YWx1ZSwKICAgICAgICB9CgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfZ29vZCBBUyBpZF9nb29kLCAKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3Byb3BlcnR5IEFTIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfc2VyaWVzIEFTIGlkX3NlcmllcywKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3VuaXQgQVMgaWRfdW5pdCwKICAgICAgICAgICAgICAgIGJhcmNvZGVzLnJhdGlvIEFTIHJhdGlvLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY19iYXJjb2Rlcy5hcHByb3ZlZCwgMCkgQVMgYXBwcm92ZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jX2JhcmNvZGVzLmlkLCAwKSBBUyBtYXJrX2lkLAogICAgICAgICAgICAgICAgSUZOVUxMKHt1c2VfbWFya19maWVsZH0sIGZhbHNlKSBBUyB1c2VfbWFyaywKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUuaWQsICcnKSBBUyByb3dfa2V5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS51c2Vfc2VyaWVzLCAwKSBBUyB1c2Vfc2VyaWVzLAogICAgICAgICAgICAgICAgSUZOVUxMKHtkX3F0dHlfZmllbGR9LCAwLjApIEFTIGRfcXR0eSwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUucXR0eSwgMC4wKSBBUyBxdHR5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuLAogICAgICAgICAgICAgICAgSUZOVUxMKHtwcmljZV9maWVsZH0sIDAuMCkgQVMgcHJpY2UsCiAgICAgICAgICAgICAgICBJRk5VTEwoe2lkX3ByaWNlX2ZpZWxkfSwgJycpIEFTIGlkX3ByaWNlCiAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgQVMgYmFyY29kZXMKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICAgICAgICAgIChTRUxFQ1QgCiAgICAgICAgICAgICAgICAgICAgICAgIGdvb2RzLmlkIEFTIGlkX2dvb2RzLCAKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXNfZ29vZHMudXNlX21hcmsgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEZST00gIFJTX2dvb2RzIEFTIGdvb2RzCiAgICAgICAgICAgICAgICAgICAgSk9JTiBSU190eXBlc19nb29kcyBBUyB0eXBlc19nb29kcyBPTiBnb29kcy50eXBlX2dvb2QgPSB0eXBlc19nb29kcy5pZCkgQVMgZ29vZHMKICAgICAgICAgICAgICAgIE9OIGJhcmNvZGVzLmlkX2dvb2QgPSBnb29kcy5pZF9nb29kcwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIHtkb2NzX3RhYmxlfSBBUyBkb2NfdGFibGUgCiAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF9nb29kID0gZG9jX3RhYmxlLmlkX2dvb2QKICAgICAgICAgICAgICAgICAgICAgQU5EIGJhcmNvZGVzLmlkX3Byb3BlcnR5ID0gZG9jX3RhYmxlLmlkX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgQU5EIGJhcmNvZGVzLmlkX3VuaXQgPSBkb2NfdGFibGUuaWRfdW5pdAogICAgICAgICAgICAgICAgICAgICBBTkQgZG9jX3RhYmxlLmlkX2RvYyA9ICJ7aWRfZG9jfSIKICAgICAgICAgICAgICAgICAgICAge2NlbGxfY29uZGl0aW9ufQogICAgICAgICAgICAgICAgICAgICB7dGFibGVfdHlwZV9jb25kaXRpb259CiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZG9jc19iYXJjb2RlcyBhcyBkb2NfYmFyY29kZXMKICAgICAgICAgICAgICAgIE9OIGRvY19iYXJjb2Rlcy5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgICAgICAgICAgICAgQU5EIGRvY19iYXJjb2Rlcy5HVElOID0gIntndGlufSIKICAgICAgICAgICAgICAgICAgICBBTkQgZG9jX2JhcmNvZGVzLlNlcmllcyA9ICJ7c2VyaWVzfSIKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBXSEVSRSBiYXJjb2Rlcy5iYXJjb2RlID0gIntiYXJjb2RlfSInJycuZm9ybWF0KCoqcGFyYW1zKQoKICAgICAgICByZXN1bHQgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQogICAgICAgIGlmIHJlc3VsdDoKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFswXQoKICAgIGRlZiBnZXRfYmFyY29kZV9mcm9tX2RvY190YWJsZShzZWxmLCBpZF9kb2NfdGFibGU6IHN0cikgLT4gc3RyOgogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgYmFyY29kZQogICAgICAgICAgRlJPTSBSU19iYXJjb2RlcyAKICAgICAgICBMRUZUIEpPSU4gICBSU19kb2NzX3RhYmxlIE9OIAogICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZCA9IFJTX2JhcmNvZGVzLmlkX2dvb2QgQU5EIAogICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IEFORCAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQgPSBSU19iYXJjb2Rlcy5pZF91bml0ICAKICAgICAgICAKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgIAogICAgICAgIExJTUlUIDEgJycnCgogICAgICAgIHJlc3VsdCA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvY190YWJsZSkKICAgICAgICBpZiByZXN1bHQ6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF1bJ2JhcmNvZGUnXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAnMDAwMDAwMDAwMDAxMScKCgogICAgZGVmIHJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKHNlbGYsIHRhYmxlX25hbWUsIGRvY3NfdGFibGVfdXBkYXRlX2RhdGEpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnJlcGxhY2UoZG9jc190YWJsZV91cGRhdGVfZGF0YSkKCiAgICBkZWYgZ2V0X2JhcmNvZGVzX2J5X2dvb2RzX2lkKHNlbGYsIGdvb2RzX2lkKSAtPiBsaXN0OgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmJhcmNvZGUsCiAgICAgICAgICAgICAgICBJRk5VTEwocHJvcHMubmFtZSwgJycpIEFTIHByb3BlcnR5LAogICAgICAgICAgICAgICAgSUZOVUxMKHVuaXRzLm5hbWUsICcnKSBBUyB1bml0CgogICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjb2RlcyBBUyBiYXJjb2RlcwogICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMgQVMgcHJvcHMKICAgICAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF9wcm9wZXJ0eSA9IHByb3BzLmlkCiAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgQVMgdW5pdHMKICAgICAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF91bml0ID0gdW5pdHMuaWQKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgV0hFUkUgYmFyY29kZXMuaWRfZ29vZCA9ICd7Z29vZHNfaWR9JwogICAgICAgICcnJwoKICAgICAgICByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHEpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGluc2VydF9ub19zcWwocXVldWVfdXBkYXRlX2RhdGEpOgogICAgICAgIHByb3ZpZGVyID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQogICAgICAgIHByb3ZpZGVyLnNhdmVfc2Nhbm5lZF9yb3dfZGF0YShxdWV1ZV91cGRhdGVfZGF0YSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0X3RhYmxlX2xpbmUodGFibGVfbmFtZSwgZmlsdGVyczogZGljdCA9IE5vbmUpOgogICAgICAgIHByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPXRhYmxlX25hbWUpCiAgICAgICAgc2VsZWN0X3BhcnQgPSBmIiIiU0VMRUNUICogRlJPTSB7dGFibGVfbmFtZX0iIiIKICAgICAgICBxdWVyeSA9IHNlbGVjdF9wYXJ0CiAgICAgICAgaWYgZmlsdGVyczoKICAgICAgICAgICAgZmlsdGVyc19wYXJ0ID0gIiIiIFdIRVJFICIiIgogICAgICAgICAgICBmb3IgY291bnQsIGZpZWxkX25hbWUgaW4gZW51bWVyYXRlKGxpc3QoZmlsdGVycykpOgogICAgICAgICAgICAgICAgZmlsdGVyc19wYXJ0ICs9IGYiIiJ7ZmllbGRfbmFtZX09J3tmaWx0ZXJzW2ZpZWxkX25hbWVdfSciIiIgaWYgY291bnQgPT0gMCBlbHNlIFwKICAgICAgICAgICAgICAgICAgICBmIiIiIEFORCB7ZmllbGRfbmFtZX09J3tmaWx0ZXJzW2ZpZWxkX25hbWVdfSciIiIKICAgICAgICAgICAgcXVlcnkgPSBmIiIie3NlbGVjdF9wYXJ0fSB7ZmlsdGVyc19wYXJ0fSIiIgoKICAgICAgICByZXN1bHQgPSBwcm92aWRlci5zcWxfcXVlcnkocXVlcnksICcnKQogICAgICAgIHJldHVybiByZXN1bHRbMF0gaWYgcmVzdWx0IGVsc2UgTm9uZQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB1cGRhdGVfbGluZV9xdHR5KHRhYmxlX2xpbmUpOgogICAgICAgIHByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPSdSU19kb2NzX3RhYmxlJykKICAgICAgICBwcm92aWRlci51cGRhdGUoZGF0YT10YWJsZV9saW5lKQoKICAgIGRlZiBsb2dfZXJyb3Ioc2VsZiwgZXJyb3JfbXNnKToKICAgICAgICBlcnJvcl90ZXh0ID0gZiIiItCg0LDQsdC+0YLQsCDRgSDRiNGC0YDQuNGF0LrQvtC00LDQvNC4OgogICAgICAgICAgICB7ZXJyb3JfbXNnfSIiIgogICAgICAgIHN1cGVyKCkuX3dyaXRlX2Vycm9yX29uX2xvZyhlcnJvcl90ZXh0KQoKCmNsYXNzIERvY1NlcnZpY2U6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZG9jX2lkPScnLCBpc19ncm91cF9zY2FuPUZhbHNlLCBpc19iYXJjX2Zsb3c9RmFsc2UpOgogICAgICAgIHNlbGYuZG9jX2lkID0gZG9jX2lkCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLmRldGFpbHNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgICAgIHNlbGYuaXNBZHIgPSBGYWxzZQogICAgICAgIHNlbGYuc3FsX3RleHQgPSAnJwogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IE5vbmUKICAgICAgICBzZWxmLmRlYnVnID0gRmFsc2UKICAgICAgICBzZWxmLmlzX2dyb3VwX3NjYW4gPSBpc19ncm91cF9zY2FuCiAgICAgICAgc2VsZi5pc19iYXJjX2Zsb3cgPSBpc19iYXJjX2Zsb3cKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzZWxmLmRvY3NfdGFibGVfbmFtZSwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCgogICAgZGVmIGdldF9sYXN0X2VkaXRlZF9nb29kcyhzZWxmLCB0b19qc29uPUZhbHNlKToKICAgICAgICBxdWVyeV9kb2NzID0gZidTRUxFQ1QgKiBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gV0hFUkUgaWRfZG9jID0gPyBhbmQgdmVyaWZpZWQgPSAxJwoKICAgICAgICBxdWVyeV9nb29kcyA9IGYnJycKICAgICAgICBTRUxFQ1QgKiBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX1fdGFibGUKICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IGFuZCBzZW50ID0gMAogICAgICAgICcnJwoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc19kb2NzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2NzLCAoc2VsZi5kb2NfaWQsKSwgVHJ1ZSkKICAgICAgICAgICAgcmVzX2dvb2RzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9nb29kcywgKHNlbGYuZG9jX2lkLCksIFRydWUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgICAgICMgcmV0dXJuIHsnRXJyb3InOiBlLmFyZ3NbMF19CgogICAgICAgIGlmIG5vdCByZXNfZ29vZHM6CiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgIHJldHVybiBzZWxmLmZvcm1fZGF0YV9mb3JfcmVxdWVzdChyZXNfZG9jcywgcmVzX2dvb2RzLCB0b19qc29uKQoKICAgIGRlZiBmb3JtX2RhdGFfZm9yX3JlcXVlc3Qoc2VsZiwgcmVzX2RvY3MsIHJlc19nb29kcywgdG9fanNvbik6CiAgICAgICAgZm9yIGl0ZW0gaW4gcmVzX2RvY3M6CiAgICAgICAgICAgIGZpbHRlcmVkX2xpc3QgPSBbZCBmb3IgZCBpbiByZXNfZ29vZHMgaWYgZFsnaWRfZG9jJ10gPT0gaXRlbVsnaWRfZG9jJ11dCiAgICAgICAgICAgIGdvb2RzX3RhYmxlID0gZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9X3RhYmxlJwogICAgICAgICAgICBpdGVtW2dvb2RzX3RhYmxlXSA9IGZpbHRlcmVkX2xpc3QKICAgICAgICAgICAgaWYgbm90IHNlbGYuaXNBZHI6CiAgICAgICAgICAgICAgICBpdGVtWydSU19kb2NzX2JhcmNvZGVzJ10gPSBbXQogICAgICAgICAgICAgICAgaXRlbVsnUlNfYmFyY19mbG93J10gPSBbXQoKICAgICAgICBpZiB0b19qc29uOgogICAgICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhyZXNfZG9jcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcmVzX2RvY3MKCiAgICBkZWYgdXBkYXRlX2RhdGFfZnJvbV9qc29uKHNlbGYsIGpzb25fZGF0YSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBkYXRhID0ganNvbi5sb2Fkcyhqc29uX2RhdGEpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBkYXRhID0ganNvbl9kYXRhCgogICAgICAgIGlmIGRhdGEuZ2V0KHNlbGYuZG9jc190YWJsZV9uYW1lKToKICAgICAgICAgICAgc2VsZi51cGRhdGVfZG9jcyhkYXRhKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudXBkYXRlX25zaShkYXRhKQoKICAgIGRlZiB1cGRhdGVfZG9jcyhzZWxmLCBkYXRhKToKICAgICAgICBkb2NfaWRzID0gJywnLmpvaW4oW2YnIntpdGVtLmdldCgiaWRfZG9jIil9IicgZm9yIGl0ZW0gaW4gZGF0YVtzZWxmLmRvY3NfdGFibGVfbmFtZV1dKQoKICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICAgICAgU0VMRUNUIGlkX2RvYywgdmVyaWZpZWQKICAgICAgICAgICAgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9CiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyBJTiAoe2RvY19pZHN9KQogICAgICAgICcnJwogICAgICAgIGRvY3MgPSB7aXRlbVsnaWRfZG9jJ106IGl0ZW1bJ3ZlcmlmaWVkJ10gb3IgRmFsc2UgZm9yIGl0ZW0gaW4KICAgICAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dD1xdWVyeSwgcmV0dXJuX2RpY3Q9VHJ1ZSl9CgogICAgICAgIHF1ZXJpZXMgPSBzZWxmLmpzb25fdG9fc3FsaXRlX3F1ZXJ5KGRhdGEsIGRvY3MpCgogICAgICAgIGZvciBxdWVyeSBpbiBxdWVyaWVzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICByYWlzZSBlCgogICAgICAgIHJldHVybiBkb2NzCgogICAgZGVmIHVwZGF0ZV9uc2koc2VsZiwgZGF0YSk6CiAgICAgICAgcXVlcmllcyA9IHNlbGYuanNvbl90b19zcWxpdGVfcXVlcnkoZGF0YSkKCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJpZXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIGUKCiAgICBkZWYgdXBkYXRlX3NlbnRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBmb3IgZG9jIGluIGRhdGE6CiAgICAgICAgICAgICAgICBpZF9kb2MgPSBkb2NbJ2lkX2RvYyddCiAgICAgICAgICAgICAgICBpZF9nb29kcyA9ICcsJy5qb2luKFtmJyJ7aXRlbS5nZXQoImlkX2dvb2QiKX0iJyBmb3IgaXRlbSBpbiBkb2MuZ2V0KCdSU19kb2NzX3RhYmxlJywgW10pXSkKCiAgICAgICAgICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICAgICAgICAgICAgICBVUERBVEUge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfQogICAgICAgICAgICAgICAgICAgIFNFVCBzZW50ID0gMQogICAgICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ICd7aWRfZG9jfScgQU5EIGlkX2dvb2QgSU4gKHtpZF9nb29kc30pCiAgICAgICAgICAgICAgICAgICAgJycnCgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKCiAgICAgICAgICAgIHF1ZXJ5ID0gZidVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfSBTRVQgc2VudD0xIFdIRVJFIGlkX2RvYyA9ICJ7c2VsZi5kb2NfaWR9IicKICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKCiAgICBkZWYganNvbl90b19zcWxpdGVfcXVlcnkoc2VsZiwgZGF0YTogZGljdCwgZG9jcz1Ob25lKToKICAgICAgICBpZiBkb2NzIGlzIE5vbmU6CiAgICAgICAgICAgIGRvY3MgPSB7fQoKICAgICAgICBxbGlzdCA9IFtdCiAgICAgICAgIyDQptC40LrQuyDQv9C+INC40LzQtdC90LDQvCDRgtCw0LHQu9C40YYKICAgICAgICB0YWJsZV9saXN0ID0gKAogICAgICAgICAgICAnUlNfZG9jX3R5cGVzJywgJ1JTX2dvb2RzJywgJ1JTX3Byb3BlcnRpZXMnLCAnUlNfdW5pdHMnLCAnUlNfdHlwZXNfZ29vZHMnLCAnUlNfc2VyaWVzJywgJ1JTX2NvdW50cmFnZW50cycsCiAgICAgICAgICAgICdSU193YXJlaG91c2VzJywgJ1JTX3ByaWNlX3R5cGVzJywgJ1JTX2NlbGxzJywgJ1JTX2JhcmNvZGVzJywgJ1JTX3ByaWNlcycsICdSU19kb2NfdHlwZXMnLCAnUlNfZG9jcycsCiAgICAgICAgICAgICdSU19kb2NzX3RhYmxlJywgJ1JTX2RvY3NfYmFyY29kZXMnLCAnUlNfYWRyX2RvY3MnLCAnUlNfYWRyX2RvY3NfdGFibGUnKSAgIyAsLCAnUlNfYmFyY19mbG93JwogICAgICAgIHRhYmxlX2Zvcl9kZWxldGUgPSAoJ1JTX2RvY3NfdGFibGUnLCAnUlNfZG9jc19iYXJjb2RlcywgUlNfYmFyY19mbG93JywgJ1JTX2Fkcl9kb2NzX3RhYmxlJykgICMgLCAnUlNfYmFyY19mbG93JwogICAgICAgIGRvY19pZF9saXN0ID0gW10KICAgICAgICBmb3IgdGFibGVfbmFtZSBpbiB0YWJsZV9saXN0OgogICAgICAgICAgICBpZiBub3QgZGF0YS5nZXQodGFibGVfbmFtZSk6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgIyDQlNC+0LHQsNCy0LjQvCDQsiDQt9Cw0L/RgNC+0YHRiyDRg9C00LDQu9C10L3QuNC1INC40Lcg0LHQsNC30Ysg0YHRgtGA0L7QuiDRgtC10YUg0LTQvtC60YPQvNC10L3RgtC+0LIsINGH0YLQviDQvNGLINC30LDQs9GA0YPQttCw0LXQvAogICAgICAgICAgICBpZiB0YWJsZV9uYW1lIGluIHRhYmxlX2Zvcl9kZWxldGU6CiAgICAgICAgICAgICAgICBxdWVyeSA9IGYiREVMRVRFIEZST00ge3RhYmxlX25hbWV9IFdIRVJFIGlkX2RvYyBpbiAoeycsICcuam9pbihkb2NfaWRfbGlzdCl9KSAiCiAgICAgICAgICAgICAgICBxbGlzdC5hcHBlbmQocXVlcnkpCgogICAgICAgICAgICBjb2x1bW5fbmFtZXMgPSBkYXRhW3RhYmxlX25hbWVdWzBdLmtleXMoKQogICAgICAgICAgICBpZiAnbWFya19jb2RlJyBpbiBjb2x1bW5fbmFtZXM6CiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMgPSBsaXN0KGNvbHVtbl9uYW1lcykKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcy5hcHBlbmQoJ0dUSU4nKQogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLmFwcGVuZCgnU2VyaWVzJykKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcy5yZW1vdmUoJ21hcmtfY29kZScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMgPSBsaXN0KGNvbHVtbl9uYW1lcykKCiAgICAgICAgICAgIGlmIHRhYmxlX25hbWUgaW4gKCdSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJyk6ICAjCiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMuYXBwZW5kKCd2ZXJpZmllZCcpCgogICAgICAgICAgICBxdWVyeSA9IGYiUkVQTEFDRSBJTlRPIHt0YWJsZV9uYW1lfSAoeycsICcuam9pbihxdWVyeV9jb2xfbmFtZXMpfSkgVkFMVUVTICIKICAgICAgICAgICAgdmFsdWVzID0gW10KCiAgICAgICAgICAgIGZvciByb3cgaW4gZGF0YVt0YWJsZV9uYW1lXToKICAgICAgICAgICAgICAgIHJvd192YWx1ZXMgPSBbXQogICAgICAgICAgICAgICAgbGlzdF9xdW90ZWRfZmllbGRzID0gKCduYW1lJywgJ2Z1bGxfbmFtZScsICJtYXJrX2NvZGUiKQogICAgICAgICAgICAgICAgZm9yIGNvbCBpbiBxdWVyeV9jb2xfbmFtZXM6CiAgICAgICAgICAgICAgICAgICAgaWYgY29sIGluIGxpc3RfcXVvdGVkX2ZpZWxkcyBhbmQgIlwiIiBpbiByb3dbY29sXToKICAgICAgICAgICAgICAgICAgICAgICAgcm93W2NvbF0gPSByb3dbY29sXS5yZXBsYWNlKCJcIiIsICJcIlwiIikKCiAgICAgICAgICAgICAgICAgICAgIyDQl9C00LXRgdGMINGD0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INGE0LvQsNCzIHZlcmlmaWVkISEhCiAgICAgICAgICAgICAgICAgICAgaWYgY29sID09ICd2ZXJpZmllZCcgYW5kICh0YWJsZV9uYW1lIGluIFsnUlNfZG9jcycsICdSU19hZHJfZG9jcyddKToKICAgICAgICAgICAgICAgICAgICAgICAgcm93W2NvbF0gPSBkb2NzLmdldChyb3dbJ2lkX2RvYyddLCAwKQoKICAgICAgICAgICAgICAgICAgICBpZiByb3cuZ2V0KGNvbCkgaXMgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgcm93W2NvbF0gPSAnJwoKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgPT0gJ21hcmtfY29kZSc6ICAjINCX0LDQvNC10L3Rj9C10Lwg0Y3RgtC+INC/0L7Qu9C1INC90LAg0L/QvtC70Y8gR1RJTiDQuCBTZXJpZXMKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY19zdHJ1Y3QgPSBzZWxmLnBhcnNlX2JhcmNvZGUocm93W2NvbF0pCiAgICAgICAgICAgICAgICAgICAgICAgIHJvd192YWx1ZXMuYXBwZW5kKGJhcmNfc3RydWN0WydHVElOJ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHJvd192YWx1ZXMuYXBwZW5kKGJhcmNfc3RydWN0WydTZXJpZXMnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICByb3dfdmFsdWVzLmFwcGVuZChyb3dbY29sXSkgICMgKGYnIntyb3dbY29sXX0iJykKCiAgICAgICAgICAgICAgICAgICAgaWYgY29sID09ICdpZF9kb2MnIGFuZCAodGFibGVfbmFtZSBpbiBbJ1JTX2RvY3MnLCAnUlNfYWRyX2RvY3MnXSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY19pZF9saXN0LmFwcGVuZCgnIicgKyByb3dbY29sXSArICciJykKCiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfdmFsID0gW2YnInt4fSInIGlmIGlzaW5zdGFuY2UoeCwgc3RyKSBlbHNlIHN0cih4KSBmb3IgeCBpbiByb3dfdmFsdWVzXQogICAgICAgICAgICAgICAgdmFsdWVzLmFwcGVuZChmIih7JywgJy5qb2luKGZvcm1hdHRlZF92YWwpfSkiKQogICAgICAgICAgICBxdWVyeSArPSAiLCAiLmpvaW4odmFsdWVzKQogICAgICAgICAgICBxbGlzdC5hcHBlbmQocXVlcnkpCgogICAgICAgIHJldHVybiBxbGlzdAoKICAgIGRlZiBnZXRfYWxsX2FydGljbGVzX2luX2RvY3VtZW50KHNlbGYpIC0+IExpc3Rbc3RyXToKICAgICAgICBxdWVyeSA9ICgnU0VMRUNUIERJU1RJTkNUIFJTX2dvb2RzLmFydCBhcyBhcnQnCiAgICAgICAgICAgICAgICAgJyBGUk9NIFJTX2RvY3NfdGFibGUnCiAgICAgICAgICAgICAgICAgJyBMRUZUIEpPSU4gUlNfZ29vZHMgT04gUlNfZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQnCiAgICAgICAgICAgICAgICAgJyBXSEVSRSBSU19kb2NzX3RhYmxlLmlkX2RvYyA9ID8nKQogICAgICAgIGdvb2RzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocXVlcnksIHNlbGYuZG9jX2lkKQogICAgICAgIHJldHVybiBbZ29vZFsnYXJ0J10gZm9yIGdvb2QgaW4gZ29vZHNdIGlmIGdvb2RzIGlzIG5vdCBOb25lIGVsc2UgW10KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJncz1Ob25lLCByZXR1cm5fZGljdD1GYWxzZSk6CiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJncz1hcmdzLCByZXR1cm5fZGljdD1yZXR1cm5fZGljdCkKCiAgICBkZWYgc2V0X2RvY192YWx1ZShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICAgICAgVVBEQVRFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgU0VUIHtrZXl9ID0ge3ZhbHVlfQogICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSAie3NlbGYuZG9jX2lkfSIKICAgICAgICAgICAgJycnCgogICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCgogICAgZGVmIHNldF9kb2NfdmFsdWVzKHNlbGYsICoqdmFsdWVzKToKICAgICAgICBpZiBub3QgdmFsdWVzOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2V0X2ZpZWxkcyA9W2Yne2t9PXt2fSdmb3IgaywgdiBpbiB2YWx1ZXMuaXRlbXMoKV0KICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICAgICAgVVBEQVRFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgU0VUIHsnLCcuam9pbihzZXRfZmllbGRzKX0KICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gIntzZWxmLmRvY19pZH0iCiAgICAgICAgICAgICcnJwoKICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgIGRlZiBnZXRfZG9jX3ZhbHVlKHNlbGYsIGtleSwgaWRfZG9jKToKICAgICAgICBxdWVyeSA9IGYnU0VMRUNUIHtrZXl9IGZyb20ge3NlbGYuZG9jc190YWJsZV9uYW1lfSAgV0hFUkUgaWRfZG9jID0gPycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaWRfZG9jLCksIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdW2tleV0KCiAgICBkZWYgZ2V0X2RvY190eXBlcyhzZWxmKSAtPiBsaXN0OgogICAgICAgIHdoZXJlX2dyb3VwX3NjYW4gPSBmJ2lzX2dyb3VwX3NjYW4gPSAiMCInIGlmIHNlbGYuaXNfZ3JvdXBfc2NhbiBpcyBGYWxzZSBlbHNlIFRydWUKCiAgICAgICAgd2hlcmVfZW1wdHkgPSAoIlJTX2RvY3MuaWRfZG9jIG5vdCBpbiAiCiAgICAgICAgICAgICAgICAgICAgICAgIihTRUxFQ1QgZGlzdGluY3QgaWRfZG9jIEZyb20gUlNfZG9jc190YWJsZSkiKQogICAgICAgIHdoZXJlX2JhcmNfZmxvdyA9IGYnKGlzX2JhcmNfZmxvdyA9ICIxIiBPUiB7d2hlcmVfZW1wdHl9KScgXAogICAgICAgICAgICBpZiBzZWxmLmlzX2JhcmNfZmxvdyBlbHNlIGYnaXNfYmFyY19mbG93ID0gIjAiJwoKICAgICAgICB3aGVyZSA9IGYie3doZXJlX2dyb3VwX3NjYW59IEFORCB7d2hlcmVfYmFyY19mbG93fSIKCiAgICAgICAgcXVlcnlfdGV4dCA9IGYnU0VMRUNUIERJU1RJTkNUIGRvY190eXBlIGZyb20ge3NlbGYuZG9jc190YWJsZV9uYW1lfScKICAgICAgICBxdWVyeSA9IGYie3F1ZXJ5X3RleHR9IFdIRVJFIHt3aGVyZX0iCgogICAgICAgIGRvY190eXBlcyA9IFtyZWNbMF0gZm9yIHJlYyBpbiBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KV0KICAgICAgICByZXR1cm4gZG9jX3R5cGVzCgogICAgZGVmIGdldF9kb2Nfdmlld19kYXRhKHNlbGYsIGRvY190eXBlPScnLCBkb2Nfc3RhdHVzPScnKSAtPiBsaXN0OgogICAgICAgIGZpZWxkcyA9IFsKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX2RvYycsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfdHlwZScsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfbicsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfZGF0ZScsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF93YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbChSU193YXJlaG91c2VzLm5hbWUsIiIpIGFzIFJTX3dhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwiIikgYXMgd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS52ZXJpZmllZCwgMCkgYXMgdmVyaWZpZWQnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnNlbnQsIDApIGFzIHNlbnQnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uYWRkX21hcmtfc2VsZWN0aW9uJywKICAgICAgICBdCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfY291bnRyYWdlbnRzJykKICAgICAgICAgICAgZmllbGRzLmFwcGVuZChmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlzX2dyb3VwX3NjYW4sIDApIGFzIGlzX2dyb3VwX3NjYW4nKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKFJTX2NvdW50cmFnZW50cy5mdWxsX25hbWUsICIiKSBhcyBSU19jb3VudHJhZ2VudCcpCgogICAgICAgIHF1ZXJ5X3RleHQgPSAnU0VMRUNUICcgKyAnLFxuJy5qb2luKGZpZWxkcykKCiAgICAgICAgam9pbnMgPSBmJycnRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9CiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIGFzIFJTX3dhcmVob3VzZXMKICAgICAgICAgICAgICAgIE9OIFJTX3dhcmVob3VzZXMuaWQgPSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZQogICAgICAgICcnJwoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfbmFtZSA9PSAnUlNfZG9jcyc6CiAgICAgICAgICAgIGpvaW5zICs9IGYnJycKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2NvdW50cmFnZW50cyBhcyBSU19jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgIE9OIFJTX2NvdW50cmFnZW50cy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfY291bnRyYWdlbnRzCiAgICAgICAgICAgICAgICAnJycKICAgICAgICB3aGVyZSA9ICcnCgogICAgICAgIGlmIGRvY19zdGF0dXM6CiAgICAgICAgICAgIGlmIGRvY19zdGF0dXMgPT0gItCS0YvQs9GA0YPQttC10L0iOgogICAgICAgICAgICAgICAgd2hlcmUgPSAiV0hFUkUgc2VudD0xIEFORCB2ZXJpZmllZD0xIgogICAgICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQs9GA0YPQt9C60LUiOgogICAgICAgICAgICAgICAgd2hlcmUgPSAiV0hFUkUgaWZudWxsKHZlcmlmaWVkLDApPTEgQU5EIGlmbnVsbChzZW50LDApPTAiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4iOgogICAgICAgICAgICAgICAgd2hlcmUgPSAiV0hFUkUgaWZudWxsKHZlcmlmaWVkLDApPTAgQU5EIGlmbnVsbChzZW50LDApPTAiCgogICAgICAgIGlmIG5vdCBkb2NfdHlwZSBvciBkb2NfdHlwZSA9PSAi0JLRgdC1IjoKICAgICAgICAgICAgYXJnc190dXBsZSA9IE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gKGRvY190eXBlLCkKICAgICAgICAgICAgaWYgbm90IGRvY19zdGF0dXMgb3IgZG9jX3N0YXR1cyA9PSAi0JLRgdC1IjoKICAgICAgICAgICAgICAgIHdoZXJlID0gJ1dIRVJFIGRvY190eXBlPT8nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aGVyZSArPSAnIEFORCBkb2NfdHlwZT0/JwoKICAgICAgICBpZiBzZWxmLmlzX2dyb3VwX3NjYW4gaXMgRmFsc2UgYW5kIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgICAgICB3aGVyZSArPSBmJyBBTkQgaXNfZ3JvdXBfc2Nhbj17aW50KHNlbGYuaXNfZ3JvdXBfc2Nhbil9JwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2hlcmUgPSBmJyBXSEVSRSBpc19ncm91cF9zY2FuPXtpbnQoc2VsZi5pc19ncm91cF9zY2FuKX0nCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi5pc19iYXJjX2Zsb3cgaXMgRmFsc2UgYW5kIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgICAgICB3aGVyZSArPSBmJyBBTkQgaXNfYmFyY19mbG93PXtpbnQoc2VsZi5pc19iYXJjX2Zsb3cpfScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdoZXJlID0gZicgV0hFUkUgaXNfYmFyY19mbG93PXtpbnQoc2VsZi5pc19iYXJjX2Zsb3cpfScKICAgICAgICAKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICB7cXVlcnlfdGV4dH0KICAgICAgICAgICAge2pvaW5zfQogICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgIE9SREVSIEJZIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUKICAgICAgICAnJycKICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfdHVwbGUsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBkZWxldGVfZG9jKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcXVlcnllcyA9ICgKICAgICAgICAnREVMRVRFIEZST00gUlNfYmFyY19mbG93IFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICdERUxFVEUgRlJPTSBSU19kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICdERUxFVEUgRlJPTSBSU19kb2NzX3NlcmllcyBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICAnREVMRVRFIEZST00gUlNfZG9jc19iYXJjb2RlcyBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICBmJ0RFTEVURSBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgKQogICAgICAgIGZvciBxdWVyeSBpbiBxdWVyeWVzOgogICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaWRfZG9jLCkpCgogICAgZGVmIGRlbGV0ZV9hZHJfZG9jKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcXVlcnllcyA9ICgKICAgICAgICAnREVMRVRFIEZST00gUlNfYWRyX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2Fkcl9kb2NzIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICkKICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcnllczoKICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGlkX2RvYywpKQoKICAgIGRlZiBkZWxldGVfb2xkX2RvY3Moc2VsZiwgZGF5czogaW50KSAtPiBsaXN0OgogICAgICAgIG9sZF9kb2NzX2lkcyA9IHNlbGYuX2ZpbmRfb2xkX2RvY3MoZGF5cykKICAgICAgICBvbGRfYWRyX2RvY3NfaWRzID0gc2VsZi5fZmluZF9vbGRfZG9jcyhkYXlzLCAnUlNfYWRyX2RvY3MnKQogICAgICAgIGZvciBpZF9kb2MgaW4gb2xkX2RvY3NfaWRzOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV9kb2MoaWRfZG9jKQogICAgICAgIGZvciBpZF9kb2MgaW4gb2xkX2Fkcl9kb2NzX2lkczoKICAgICAgICAgICAgc2VsZi5kZWxldGVfYWRyX2RvYyhpZF9kb2MpCiAgICAgICAgcmV0dXJuIG9sZF9kb2NzX2lkcyArIG9sZF9hZHJfZG9jc19pZHMKCiAgICBkZWYgX2ZpbmRfb2xkX2RvY3MoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRheXM6IGludCwKICAgICAgICAgICAgdGFibGU6IExpdGVyYWxbJ1JTX2RvY3MnLCAnUlNfYWRyX2RvY3MnXSA9ICdSU19kb2NzJwogICAgKSAtPiBMaXN0W3N0cl06CiAgICAgICAgIiIi0JLQvtC30LLRgNCw0YnQsNC10YIg0YHQv9C40YHQvtC6IGlkINCy0YHQtdGFINGD0YHRgtCw0YDQtdCy0YjQuNGFINC00L7QutGD0LzQtdC90YLQvtCyIiIiCiAgICAgICAgcXVlcnkgPSBmJycnU0VMRUNUIGlkX2RvYyBGUk9NIHt0YWJsZX0gV0hFUkUgY3JlYXRlZF9hdCA8ID8nJycKICAgICAgICBjdXJyZW50X2RhdGV0aW1lID0gZGF0ZXRpbWUubm93KHR6PXRpbWV6b25lLnV0YykKICAgICAgICB0YXJnZXRfdGltZSA9IGN1cnJlbnRfZGF0ZXRpbWUgLSB0aW1lZGVsdGEoZGF5cz1kYXlzKQogICAgICAgIGRvY3MgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAodGFyZ2V0X3RpbWUsICkpCiAgICAgICAgcmV0dXJuIFtkb2NbMF0gZm9yIGRvYyBpbiBkb2NzXQoKICAgIGRlZiBnZXRfZG9jc19zdGF0KHNlbGYpOgogICAgICAgIHdoZXJlX2dyb3VwX3NjYW4gPSBmJ2lzX2dyb3VwX3NjYW4gPSAiMCInIGlmIHNlbGYuaXNfZ3JvdXBfc2NhbiBpcyBGYWxzZSBlbHNlIFRydWUKICAgICAgICB3aGVyZV9iYXJjX2Zsb3cgPSBmJ2lzX2JhcmNfZmxvdyA9ICIwIicgaWYgc2VsZi5pc19iYXJjX2Zsb3cgaXMgRmFsc2UgZWxzZSBUcnVlCiAgICAgICAgd2hlcmUgPSBmInt3aGVyZV9ncm91cF9zY2FufSBBTkQge3doZXJlX2JhcmNfZmxvd30iCgogICAgICAgIHF1ZXJ5X3NlbGVjdCA9IGYnJycKICAgICAgICBXSVRIIHRtcCBBUyAoCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgICAgICAxIGFzIGRvY19Db3VudCwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NzX3RhYmxlLnNlbnQsMCkgYXMgc2VudCwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NzX3RhYmxlLnZlcmlmaWVkLDApIGFzIHZlcmlmaWVkLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUuaXNfZ3JvdXBfc2NhbiwgMCkgYXMgaXNfZ3JvdXBfc2NhbiwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NzX3RhYmxlLmlzX2JhcmNfZmxvdywgMCkgYXMgaXNfYmFyY19mbG93LAogICAgICAgICAgICAgICAgQ0FTRSBXSEVOIElGTlVMTCh2ZXJpZmllZCwwKT0wIFRIRU4gCiAgICAgICAgICAgICAgICAgICAgQ09VTlQoZG9jc19kZXRhaWxzLmlkKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIGNvdW50X3ZlcmlmaWVkLAogICAgICAgICAgICAgICAgQ0FTRSBXSEVOIElGTlVMTCh2ZXJpZmllZCwwKT0xIFRIRU4gCiAgICAgICAgICAgICAgICAgICAgY291bnQoZG9jc19kZXRhaWxzLmlkKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIGNvdW50X3VudmVyaWZpZWQsCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTAgVEhFTgogICAgICAgICAgICAgICAgICAgICBTVU0oZG9jc19kZXRhaWxzLnF0dHlfcGxhbikKICAgICAgICAgICAgICAgIEVMU0UgCiAgICAgICAgICAgICAgICAgICAgMCAKICAgICAgICAgICAgICAgIEVORCBhcyBxdHR5X3BsYW5fdmVyaWZpZWQsCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTEgVEhFTiAKICAgICAgICAgICAgICAgICAgICBTVU0oZG9jc19kZXRhaWxzLnF0dHlfcGxhbikKICAgICAgICAgICAgICAgIEVMU0UgCiAgICAgICAgICAgICAgICAgICAgMCAKICAgICAgICAgICAgICAgIEVORCBhcyBxdHR5X3BsYW5fdW52ZXJpZmllZAogICAgICAgICAgICBGUk9NIFJTX2RvY3MgQVMgZG9jc190YWJsZQogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZG9jc190YWJsZSBBUyBkb2NzX2RldGFpbHMKICAgICAgICAgICAgICAgIE9OIGRvY3NfZGV0YWlscy5pZF9kb2MgPSBkb2NzX3RhYmxlLmlkX2RvYwogICAgICAgICAgICBHUk9VUCBCWSBkb2NzX3RhYmxlLmlkX2RvYwogICAgICAgICkKICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgIGRvY190eXBlIGFzIGRvY1R5cGUsIAogICAgICAgICAgICBDT1VOVChpZF9kb2MpLAogICAgICAgICAgICBTVU0oZG9jX0NvdW50KSBhcyBjb3VudCwgCiAgICAgICAgICAgIFNVTShzZW50KSBhcyBzZW50LCAKICAgICAgICAgICAgU1VNKHZlcmlmaWVkKSBhcyB2ZXJpZmllZCwKICAgICAgICAgICAgU1VNKGNvdW50X3ZlcmlmaWVkKSBhcyBjb3VudF92ZXJpZmllZCwKICAgICAgICAgICAgU1VNKGNvdW50X3VudmVyaWZpZWQpIGFzIGNvdW50X3VudmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShxdHR5X3BsYW5fdmVyaWZpZWQpIGFzIHF0dHlfcGxhbl92ZXJpZmllZCwKICAgICAgICAgICAgU1VNKHF0dHlfcGxhbl91bnZlcmlmaWVkKSBhcyBxdHR5X3BsYW5fdW52ZXJpZmllZAogICAgICAgIEZST00gdG1wCiAgICAgICAgV0hFUkUge3doZXJlfQogICAgICAgIEdST1VQIEJZIGRvY190eXBlCiAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9zZWxlY3QsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jX2Zsb3dfc3RhdChzZWxmKToKICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICBXSVRIIHRtcCBBUyAoCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgUlNfZG9jcy5pZF9kb2MsCiAgICAgICAgICAgICAgICAxIGFzIGRvY19Db3VudCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLnNlbnQsMCkgYXMgc2VudCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLnZlcmlmaWVkLDApIGFzIHZlcmlmaWVkLAoKICAgICAgICAgICAgICAgIGNvdW50KFJTX2JhcmNfZmxvdy5iYXJjb2RlKSBhcyBiYXJjX2NvdW50CgogICAgICAgICAgICBGUk9NIFJTX2RvY3MKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjX2Zsb3cgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzLmlkX2RvYyA9IFJTX2JhcmNfZmxvdy5pZF9kb2MKICAgICAgICAgICAgICAgIAogICAgICAgICAgIFdIRVJFICBSU19kb2NzLmlkX2RvYyBub3QgaW4gKFNFTEVDVCBkaXN0aW5jdAogICAgICAgICAgICAgICAgaWRfZG9jCiAgICAgICAgICAgICAgICBGcm9tIAogICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgIAogICAgICAgICAgIEdST1VQIEJZIFJTX2RvY3MuaWRfZG9jCiAgICAgICAgKQogICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgZG9jX3R5cGUgYXMgZG9jVHlwZSwgCiAgICAgICAgICAgIENPVU5UKGlkX2RvYykgYXMgaWRfY291bnQsCiAgICAgICAgICAgIFNVTShkb2NfQ291bnQpIGFzIGNvdW50LCAKICAgICAgICAgICAgU1VNKHNlbnQpIGFzIHNlbnQsIAogICAgICAgICAgICBTVU0odmVyaWZpZWQpIGFzIHZlcmlmaWVkLAogICAgICAgICAgICBTVU0oYmFyY19jb3VudCkgYXMgYmFyY19jb3VudAogICAgICAgIEZST00gdG1wCiAgICAgICAgR1JPVVAgQlkgZG9jX3R5cGUKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgZ2V0X2RvY19kZXRhaWxzX2RhdGEoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGlkX2RvYzogc3RyLAogICAgICAgICAgICBmaXJzdF9lbGVtOiBpbnQsCiAgICAgICAgICAgIGl0ZW1zX29uX3BhZ2U6IGludCwKICAgICAgICAgICAgYXJ0aWNsZXNfbGlzdDogT3B0aW9uYWxbTGlzdFtzdHJdXSA9IE5vbmUsCiAgICAgICAgICAgIHJvd19maWx0ZXJzOiBPcHRpb25hbFtzdHJdID0gTm9uZSwKICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogT3B0aW9uYWxbc3RyXSA9IE5vbmUKICAgICkgLT4gbGlzdDoKICAgICAgICBzZWxlY3RfcXVlcnkgPSBmIiIiCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICAgUlNfZ29vZHMuY29kZSwKICAgICAgICAgICAgUlNfZ29vZHMuYXJ0LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfc2VyaWVzLAogICAgICAgICAgICBSU19zZXJpZXMubmFtZSBhcyBzZXJpZXNfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0LAogICAgICAgICAgICBSU191bml0cy5uYW1lIGFzIHVuaXRzX25hbWUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuZF9xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHksCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eV9wbGFuLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnByaWNlLAogICAgICAgICAgICBSU19wcmljZV90eXBlcy5uYW1lIGFzIHByaWNlX25hbWUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eV9wbGFuIC1SU19kb2NzX3RhYmxlLnF0dHkgYXMgSXNEb25lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmxhc3RfdXBkYXRlZCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzCiAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkPVJTX2RvY3NfdGFibGUuaWRfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID1SU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgICAgICBPTiBSU19zZXJpZXMuaWQgPVJTX2RvY3NfdGFibGUuaWRfc2VyaWVzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICBPTiBSU191bml0cy5pZCA9IFJTX2RvY3NfdGFibGUuaWRfdW5pdAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJpY2VfdHlwZXMKICAgICAgICAgICAgT04gUlNfcHJpY2VfdHlwZXMuaWQgPVJTX2RvY3NfdGFibGUuaWRfcHJpY2UKICAgICAgICAgICAgIiIiCgogICAgICAgIHdoZXJlID0gZiIiIldIRVJFIGlkX2RvYyA9ICd7c3RyKGlkX2RvYyl9JyIiIgogICAgICAgIHJvd19maWx0ZXJzX2NvbmRpdGlvbiA9ICIiIkFORCBxdHR5ICE9IENPQUxFU0NFKHF0dHlfcGxhbiwgJzAnKSAiIiIgaWYgcm93X2ZpbHRlcnMgZWxzZSAnJwogICAgICAgIHNlYXJjaF9zdHJpbmdfY29uZGl0aW9uID0gZiIiIkFORCBnb29kX25hbWUgTElLRSAnJXtzZWFyY2hfc3RyaW5nfSUnIiIiIGlmIHNlYXJjaF9zdHJpbmcgZWxzZSAnJwoKICAgICAgICB3aGVyZV9xdWVyeSA9IGYiIiIKICAgICAgICB7d2hlcmV9CiAgICAgICAge3Jvd19maWx0ZXJzX2NvbmRpdGlvbn0KICAgICAgICB7c2VhcmNoX3N0cmluZ19jb25kaXRpb259CiAgICAgICAgIiIiCiAgICAgICAgYXJncyA9ICgpCiAgICAgICAgaWYgYXJ0aWNsZXNfbGlzdDoKICAgICAgICAgICAgd2hlcmVfcXVlcnkgKz0gZiIiIkFORCBhcnQgSU4gKHsnLCcuam9pbignPycgZm9yIF8gaW4gYXJ0aWNsZXNfbGlzdCl9KSIiIgogICAgICAgICAgICBhcmdzICs9IHR1cGxlKGFydGljbGVzX2xpc3QpCiAgICAgICAgb3JkZXJfYnkgPSAiIiJPUkRFUiBCWSBsYXN0X3VwZGF0ZWQgREVTQyIiIgogICAgICAgIGxpbWl0ID0gZidMSU1JVCB7aXRlbXNfb25fcGFnZX0gT0ZGU0VUIHtmaXJzdF9lbGVtfScKICAgICAgICBxdWVyeSA9IGYie3NlbGVjdF9xdWVyeX0ge3doZXJlX3F1ZXJ5fSB7b3JkZXJfYnl9IHtsaW1pdH0iCgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIGFyZ3MsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgIyByZXMgPSBzZWxmLl9zcWxfcXVlcnkocXVlcnksICcnKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgcGFyc2VfYmFyY29kZShzZWxmLCB2YWwpOgogICAgICAgIGlmIGxlbih2YWwpIDwgMjE6CiAgICAgICAgICAgIHJldHVybiB7J0dUSU4nOiAnJywgJ1Nlcmllcyc6ICcnfQoKICAgICAgICB2YWwucmVwbGFjZSgnKDAxKScsICcwMScpCiAgICAgICAgdmFsLnJlcGxhY2UoJygyMSknLCAnMjEnKQoKICAgICAgICBpZiB2YWxbOjJdID09ICcwMSc6CiAgICAgICAgICAgIEdUSU4gPSB2YWxbMjoxNl0KICAgICAgICAgICAgU2VyaWVzID0gdmFsWzE4Ol0KICAgICAgICBlbHNlOgogICAgICAgICAgICBHVElOID0gdmFsWzoxNF0KICAgICAgICAgICAgU2VyaWVzID0gdmFsWzE0Ol0KCiAgICAgICAgcmV0dXJuIHsnR1RJTic6IEdUSU4sICdTZXJpZXMnOiBTZXJpZXN9CgogICAgZGVmIGNsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAoJ1VwZGF0ZSBSU19kb2NzX2JhcmNvZGVzIFNldCBhcHByb3ZlZCA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ0RlbGV0ZSBGcm9tIFJTX2RvY3NfYmFyY29kZXMgV2hlcmUgIGlkX2RvYz06aWRfZG9jIEFuZCBpc19wbGFuID0gMCcsCiAgICAgICAgICAgICAgICAgICAgICAnVXBkYXRlIFJTX2RvY3NfdGFibGUgU2V0IHF0dHkgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdVcGRhdGUgUlNfZG9jc190YWJsZSBTZXQgZF9xdHR5ID0gMCBXaGVyZSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICAgICAgICAgICAnRGVsZXRlIEZyb20gUlNfZG9jc190YWJsZSBXaGVyZSBpZF9kb2M9OmlkX2RvYyBhbmQgaXNfcGxhbiA9ICJGYWxzZSInLAogICAgICAgICAgICAgICAgICAgICAgJ0RlbGV0ZSBGcm9tIFJTX2JhcmNfZmxvdyBXaGVyZSBpZF9kb2MgPSA6aWRfZG9jJykKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvciBlbCBpbiBxdWVyeV90ZXh0OgogICAgICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChlbCwgKHsnaWRfZG9jJzogaWRfZG9jfSkpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByZXR1cm4geydyZXN1bHQnOiBGYWxzZSwgJ2Vycm9yJzogZS5hcmdzWzBdfQoKICAgICAgICByZXR1cm4geydyZXN1bHQnOiBUcnVlLCAnZXJyb3InOiAnJ30KCiAgICBkZWYgZ2V0X21hcmtzX2RhdGEoc2VsZiwgaWRfZG9jLCBkb2Nfcm93X2lkKToKICAgICAgICBxdWVyeSA9IGYnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgYi5tYXJrX2NvZGUsCiAgICAgICAgICAgICAgICBiLmFwcHJvdmVkIAogICAgICAgICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMgQVMgYgogICAgICAgICAgICBKT0lOIFJTX2RvY3NfdGFibGUgYXMgdAogICAgICAgICAgICAgICAgT04gYi5pZF9kb2M9dC5pZF9kb2MgQU5ECiAgICAgICAgICAgICAgICAgICAgYi5pZF9nb29kID0gdC5pZF9nb29kIEFORAogICAgICAgICAgICAgICAgICAgIGIuaWRfcHJvcGVydHkgPSB0LmlkX3Byb3BlcnRpZXMgQU5ECiAgICAgICAgICAgICAgICAgICAgYi5pZF9zZXJpZXMgPSB0LmlkX3NlcmllcyBBTkQKICAgICAgICAgICAgICAgICAgICB0LmlkID0gIntkb2Nfcm93X2lkfSIKICAgICAgICAgICAgCiAgICAgICAgICAgIFdIRVJFIGIuaWRfZG9jID0gIntpZF9kb2N9IgogICAgICAgICcnJwoKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgZ2V0X2RvY3NfY291bnQoc2VsZiwgZG9jX3R5cGU9JycpOgogICAgICAgIHF1ZXJ5ID0gZidTRUxFQ1QgQ09VTlQoKikgQVMgZG9jc19jb3VudCBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0nCiAgICAgICAgYXJncyA9IE5vbmUKCiAgICAgICAgaWYgZG9jX3R5cGU6CiAgICAgICAgICAgIHF1ZXJ5ID0gJ1xuJy5qb2luKFtxdWVyeSwgJ1dIRVJFIGRvY190eXBlID0gPyddKQogICAgICAgICAgICBhcmdzID0gKGRvY190eXBlLCkKCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgYXJncywgVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0uZ2V0KCdkb2NzX2NvdW50JywgMCkKICAgICAgICByZXR1cm4gMAoKICAgIGRlZiBnZXRfZXhpc3RpbmdfZG9jcyhzZWxmKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiJTRUxFQ1QgZG9jX24sZG9jX3R5cGUgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IgogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCkKICAgICAgICByZXR1cm4gcmVzCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHdyaXRlX2Vycm9yX29uX2xvZyhFcnJfdmFsdWUpOgogICAgICAgIGlmIEVycl92YWx1ZToKICAgICAgICAgICAgcXRleHQgPSAnSW5zZXJ0IGludG8gRXJyb3JfbG9nKGxvZykgVmFsdWVzKD8pJwogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAoRXJyX3ZhbHVlLCkpCgogICAgZGVmIGdldF9kb2NzX2FuZF9nb29kc19mb3JfdXBsb2FkKHNlbGYpOgoKICAgICAgICBxdWVyeV9kb2NzID0gZicnJ1NFTEVDVCAqIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBXSEVSRSB2ZXJpZmllZCA9IDEgIGFuZCAoc2VudCA8PiAxIG9yIHNlbnQgaXMgbnVsbCknJycKICAgICAgICBxdWVyeV9nb29kcyA9IGYnJydTRUxFQ1QgKiBGUk9NIHtzZWxmLmRldGFpbHNfdGFibGVfbmFtZX0gV0hFUkUgKHNlbnQgPSAwIE9SIHNlbnQgaXMgTnVsbCknJycKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc19kb2NzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2NzLCBOb25lLCBUcnVlKQogICAgICAgICAgICByZXNfZ29vZHMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2dvb2RzLCBOb25lLCBUcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgIGlmIG5vdCByZXNfZ29vZHM6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgcmV0dXJuIHNlbGYuZm9ybV9kYXRhX2Zvcl9yZXF1ZXN0KHJlc19kb2NzLCByZXNfZ29vZHMsIEZhbHNlKQoKICAgIGRlZiBnZXRfZGF0YV90b19zZW5kKHNlbGYpOgogICAgICAgIGRhdGEgPSBbXQoKICAgICAgICBxID0gZicnJ1NFTEVDVCBpZF9kb2MKICAgICAgICAgICAgICAgIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSAKICAgICAgICAgICAgICAgIFdIRVJFIHZlcmlmaWVkID0gMSAgQU5EIChzZW50ID0gMCBPUiBzZW50IElTIE5VTEwpCiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEpCgogICAgICAgIGZvciByb3cgaW4gcmVzOgogICAgICAgICAgICBpZF9kb2MgPSByb3dbJ2lkX2RvYyddCgogICAgICAgICAgICBkb2NfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydGllcycsICdpZF9zZXJpZXMnLCAnaWRfdW5pdCcsICdxdHR5JywgJ3F0dHlfcGxhbiddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCAoc2VudCA9IDAgT1Igc2VudCBJUyBOVUxMKQogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBnb29kcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3NfdGFibGUnXSA9IGdvb2RzCgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3Byb3BlcnR5JywgJ2lkX3NlcmllcycsICdiYXJjb2RlX2Zyb21fc2Nhbm5lcicsICdHVElOJywgJ1NlcmllcyddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBJRk5VTEwoYmFyY29kZV9mcm9tX3NjYW5uZXIsICcnKSA8PiAnJywgCiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIGRvY19iYXJjb2RlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXSA9IGRvY19iYXJjb2RlcwoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnYmFyY29kZSddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjX2Zsb3cKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8KICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQoKICAgICAgICAgICAgYmFyY19mbG93ID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfYmFyY19mbG93J10gPSBiYXJjX2Zsb3cKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfc2VyaWVzJywgJ2lkX3dhcmVob3VzZScsICdxdHR5JywgJ25hbWUnLCAnYmVzdF9iZWZvcmUnLCAnbnVtYmVyJywKICAgICAgICAgICAgICAgICAgICAgICdwcm9kdWN0aW9uX2RhdGUnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ID8KICAgICAgICAgICAgJycnLmZvcm1hdCgnLCcuam9pbihmaWVsZHMpKQoKICAgICAgICAgICAgc2VyaWVzX3RhYmxlID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfZG9jc19zZXJpZXMnXSA9IHNlcmllc190YWJsZQogICAgICAgICAgICBkYXRhLmFwcGVuZChkb2NfZGF0YSkKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgZ2V0X2NvdW50X21hcmtfY29kZXMoc2VsZiwgaWRfZG9jKToKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCBESVNUSU5DVCBDT1VOVChpZCkgYXMgY29sX3N0ciAKICAgICAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdIRVJFIGlkX2RvYyA9ID8gQU5EIGlzX3BsYW4gPSAxCiAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5fc3FsX3F1ZXJ5KAogICAgICAgICAgICBxPXEsCiAgICAgICAgICAgIHBhcmFtcz1pZF9kb2MsCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcmVzWzBdWydjb2xfc3RyJ10KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdXBkYXRlX3VwbG9hZGVkX2RvY3Nfc3RhdHVzKGRvY19pbl9zdHIpOgogICAgICAgIHF0ZXh0ID0gZidVUERBVEUgUlNfZG9jcyBTRVQgc2VudCA9IDEgIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19pbl9zdHJ9KSAnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19hZHJfZG9jcyBTRVQgc2VudCA9IDEgIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19pbl9zdHJ9KSAnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzX3RhYmxlIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB1cGRhdGVfcnNfZG9jc190YWJsZV9zZW50X3N0YXR1cyh0YWJsZV9zdHJpbmdfaWQ6IHN0cik6CiAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzX3RhYmxlIFNFVCBzZW50ID0gMCAgV0hFUkUgaWQgaW4gKHt0YWJsZV9zdHJpbmdfaWR9KSAnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICBkZWYgc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYsIGRvY19pZCk6CiAgICAgICAgcXRleHQgPSBmIlVQREFURSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFNFVCBzZW50ID0gMCwgdmVyaWZpZWQgPSAwICBXSEVSRSBpZF9kb2MgPSAne2RvY19pZH0nIgogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgZGVmIHVwZGF0ZV9kb2NfdGFibGVfcm93KHNlbGYsIHJvd19pZCwgZGF0YSk6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZShkYXRhPWRhdGEsIF9maWx0ZXI9eydpZCc6IHJvd19pZH0pCgogICAgZGVmIF9zcWxfZXhlYyhzZWxmLCBxLCBwYXJhbXMsIHRhYmxlX25hbWU9JycpOgogICAgICAgIGlmIHRhYmxlX25hbWU6CiAgICAgICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBpZiBpc2luc3RhbmNlKHBhcmFtcywgc3RyKToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci5zcWxfZXhlYyhxLCBwYXJhbXMpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX3NxbF9xdWVyeShzZWxmLCBxLCBwYXJhbXMsIHRhYmxlX25hbWU9JycpOgogICAgICAgIGlmIHRhYmxlX25hbWU6CiAgICAgICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICByZXR1cm4gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgcGFyYW1zKQogICAgCiAgICBkZWYgZ2V0X2RvY19yb3dzX2NvdW50KHNlbGYsIGlkX2RvYykgLT4gZGljdDoKICAgICAgICByZXN1bHQgPSB7fSAgCiAgICAgICAgCiAgICAgICAgaWYgaWRfZG9jOiAgCiAgICAgICAgICAgIHEgPSAnU0VMRUNUIGNvdW50KGlkX2RvYykgYXMgZG9jX3Jvd3MgRlJPTSBSU19kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYz0/JwogICAgICAgICAgICByZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBzdHIoaWRfZG9jKSkgIAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzIGFuZCAnZG9jX3Jvd3MnIGluIHJlc1swXTogCiAgICAgICAgICAgICAgICByZXN1bHQgPSB7J2RvY19yb3dzJzogcmVzWzBdWydkb2Nfcm93cyddfQogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdCAgCgogICAgZGVmIGdldF9iYXJjb2RlKHNlbGYsIGJhcmNvZGUpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0ge30gIAoKICAgICAgICBpZiBiYXJjb2RlOiAgCiAgICAgICAgICAgIHEgPSAnU0VMRUNUICogRlJPTSBSU19iYXJjb2RlcyBXSEVSRSBiYXJjb2RlPT8nCiAgICAgICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHN0cihiYXJjb2RlKSkgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXM6ICAKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc1swXSBpZiByZXMgZWxzZSB7fQoKICAgICAgICByZXR1cm4gcmVzdWx0ICAgIAoKICAgIGRlZiBtYXJrX3ZlcmlmaWVkKHNlbGYsIHZhbHVlPTEpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHNlbGYuZG9jc190YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci51cGRhdGUoeyd2ZXJpZmllZCc6IHZhbHVlfSwgeydpZF9kb2MnOiBzZWxmLmRvY19pZH0pCgoKY2xhc3MgU2VyaWVzU2VydmljZShEYlNlcnZpY2UpOgogICAgZG9jX2Jhc2ljX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgIGRvY19iYXNpY19oYW5kbGVyX25hbWUgPSAnUlNfZG9jcycKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAjaWYgcGFyYW1zIGFuZCBpc2luc3RhbmNlKHBhcmFtcywgZGljdCk6CiAgICAgICAgIyAgICBzZWxmLnBhcmFtcyA9IHBhcmFtcwogICAgICAgICNlbHNlOgogICAgICAgIHNlbGYucGFyYW1zID0ge30KCiAgICBkZWYgZ2V0X3Nlcmllc19ieV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUsIHBhcmFtczogZGljdCk6CgogICAgICAgIHBhcmFtcyA9IFsKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksCiAgICAgICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfcHJvcGVydGllcycpLAogICAgICAgICAgICBiYXJjb2RlLAogICAgICAgICAgICBiYXJjb2RlCiAgICAgICAgXSAgIyBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpLAogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgaWRfcHJvcGVydGllcywKICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgIHF0dHksCiAgICAgICAgICAgbmFtZSwKICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgIGNlbGwKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcyA9ID8gCiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9hZHJfc2VyaWVzX2J5X2JhcmNvZGUoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgcGFyYW1zID0gW3NlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2NlbGwnKSwKICAgICAgICAgICAgICAgICAgYmFyY29kZSwgIGJhcmNvZGVdICAjIHNlbGYucGFyYW1zLmdldCgnaWRfd2FyZWhvdXNlJyksCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCBpZCwKICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICBpZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICBpZF93YXJlaG91c2UsCiAgICAgICAgICAgcXR0eSwKICAgICAgICAgICBuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciwKICAgICAgICAgICBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgY2VsbAogICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIFJTX2RvY3Nfc2VyaWVzLmNlbGwgPSA/CiAgICAgICAgICAgIEFORCAobmFtZSA9ID8gT1IgbnVtYmVyID0gPyknJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGdldF9zZXJpZXNfYnlfZG9jX2FuZF9nb29kcyhzZWxmKToKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJykpICAjICwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKQoKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkIGFzIGtleSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyBhcyBpZF9kb2MsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLnF0dHksCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsICcnKSBBUyBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX24sICcnKSBBUyBkb2NfbiwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3dhcmVob3VzZXMubmFtZSAsICcnKSBBUyB3YXJlaG91c2VfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZG9jcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9IFJTX2RvY3MuaWRfZG9jCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIAogICAgICAgICAgICAgICAgT04gUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gUlNfd2FyZWhvdXNlcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gPyAKICAgICAgICAgICAgCiAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBnZXRfc2VyaWVzX2J5X2Fkcl9kb2NfYW5kX2dvb2RzKHNlbGYpOgogICAgICAgIGN1cnJfY2VsbCA9IHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGlmIHNlbGYucGFyYW1zLmdldCgnY2VsbCcpIGVsc2Ugc2VsZi5wYXJhbXMuZ2V0KCdpZF9jZWxsJykKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksIGN1cnJfY2VsbCkgICMgLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWQgYXMga2V5LAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MgYXMgaWRfZG9jLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9zZXJpZXMsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMubmFtZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuYmVzdF9iZWZvcmUsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMucHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsLAogICAgICAgICAgICBSU19kb2NzLmRvY190eXBlLAogICAgICAgICAgICBSU19kb2NzLmRvY19uLCAKICAgICAgICAgICAgUlNfZG9jcy5kb2NfZGF0ZSwKICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcy5uYW1lIGFzIHdhcmVob3VzZV9uYW1lLAogICAgICAgICAgICBSU19jZWxscy5uYW1lIGFzIGNlbGxfbmFtZQogICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19zZXJpZXMgCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gCiAgICAgICAgICAgIFJTX2RvY3MgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9ICBSU19kb2NzLmlkX2RvYwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19nb29kcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ICBSU19nb29kcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19wcm9wZXJ0aWVzIE9OIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzID0gIFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgUlNfd2FyZWhvdXNlcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlID0gIFJTX3dhcmVob3VzZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19jZWxscyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBXSEVSRSBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gQU5EIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5jZWxsID0gPwogICAgICAgICAgICAnJycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMsIFRydWUpCgogICAgZGVmIGFkZF9xdHR5X3RvX3RhYmxlX3N0cihzZWxmLCBpdGVtX2lkKToKICAgICAgICBwYXJhbXMgPSAoaXRlbV9pZCwpCiAgICAgICAgcSA9ICcnJ1VQREFURSBSU19kb2NzX3NlcmllcwogICAgICAgICAgICBTRVQgcXR0eSA9IHF0dHkgKyAxCiAgICAgICAgICAgIFdIRVJFIGlkID0gPycnJwoKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCgoKICAgIGRlZiBhZGRfbmV3X3Nlcmllc19pbl9kb2Nfc2VyaWVzX3RhYmxlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHFfcGFyYW1zID0gKAogICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX3Byb3BlcnRpZXMnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKSwgMSwKICAgICAgICAgICAgICAgIGJhcmNvZGUsIGJhcmNvZGUsIHNlbGYucGFyYW1zLmdldCgnaWRfY2VsbCcpKQogICAgICAgIHEgPSAnSU5TRVJUIElOVE8gUlNfZG9jc19zZXJpZXMgKGlkX2RvYywgaWRfZ29vZCwgaWRfcHJvcGVydGllcywgaWRfd2FyZWhvdXNlLCBxdHR5LCBuYW1lLCBudW1iZXIsIGNlbGwpIFZBTFVFUyg/LD8sPyw/LD8sPyw/LD8pJwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIHFfcGFyYW1zKQoKICAgIGRlZiBnZXRfaXRlbV9ieV9uYW1lKHNlbGYsIGl0ZW1fbmFtZSwgdGFibGVfbmFtZSk6CiAgICAgICAgcSA9IGYnU0VMRUNUIGlkIEZST00ge3RhYmxlX25hbWV9IFdIRVJFIHt0YWJsZV9uYW1lfS5uYW1lID0gPycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIChpdGVtX25hbWUsKSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1bMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBkZWxldGVfY3VycmVudF9zdChzZWxmLCBpZCk6CiAgICAgICAgcSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3NlcmllcyAgV0hFUkUgaWQgPSA/JwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIChpZCwpKQoKCiAgICBkZWYgZ2V0X3Nlcmllc19wcm9wX2J5X2lkKHNlbGYsIGlkKToKICAgICAgICB0YWJsZV9uYW1lID0gc2VsZi5kb2NfYmFzaWNfdGFibGVfbmFtZQogICAgICAgIGlzX2FkciA9IEZhbHNlIGlmIHRhYmxlX25hbWUgPT0gJ1JTX2RvY3NfdGFibGUnIGVsc2UgVHJ1ZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZCwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfZG9jLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9nb29kLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9zZXJpZXMsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX3VuaXQsCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHksCiAgICAgICAgICAge3RhYmxlX25hbWV9LnF0dHlfcGxhbiwKICAgICAgICAgICAgICAgICAgICAgJycnCiAgICAgICAgcSA9IHEgKyBmJycnIHt0YWJsZV9uYW1lfS5pZF9jZWxsLCAKICAgICAgICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfY2VsbCBhcyBjZWxsLCAKICAgICAgICAgICAgICAgIFJTX2NlbGxzLm5hbWUgYXMgY2VsbF9uYW1lLCAKICAgICAgICAgICAgICAgIDAgYXMgcHJpY2UsCiAgICAgICAgICAgICAgICBOdWxsIGFzIGlkX3ByaWNlLCcnJyBpZiBpc19hZHIgZWxzZSBxICsgIGYnJycKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5wcmljZSwKICAgICAgICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF9wcmljZSwnJycKCiAgICAgICAgcSA9IHEgKyBmJycnCiAgICAgICAgICAge3RhYmxlX25hbWV9LnVzZV9zZXJpZXMsCiAgICAgICAgICAgUlNfZ29vZHMuYXJ0IGFzIGNvZGVfYXJ0LCAKICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZQogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0gCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX2dvb2RzCiAgICAgICAgICAgIE9OIHt0YWJsZV9uYW1lfS5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAgIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04ge3RhYmxlX25hbWV9LmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gICBSU191bml0cwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfdW5pdCA9IFJTX3VuaXRzLmlkCiAgICAgICAgICAgICcnJwogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gICBSU19jZWxscwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgICAgICcnJyBpZiBpc19hZHIgZWxzZSBxCgogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWQgPSA/CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKGlkLCksIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHt9CgoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2VyaWVzX3RhYmxlX3N0cihpZCk6CiAgICAgICAgcSA9ICcnJwogICAgICAgU0VMRUNUIAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3NlcmllcywKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF93YXJlaG91c2UsCiAgICAgICAgUlNfZG9jc19zZXJpZXMucXR0eSwKICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLmJlc3RfYmVmb3JlLCAnJykgQVMgYmVzdF9iZWZvcmUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMubnVtYmVyLAogICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5wcm9kdWN0aW9uX2RhdGUsICcnKSBBUyBwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCwKICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwgCiAgICAgICAgUlNfY2VsbHMubmFtZSBhcyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzCiAgICAgICAgT04gUlNfZ29vZHMuaWQgPSBSU19kb2NzX3Nlcmllcy5pZF9nb29kCiAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgT04gUlNfY2VsbHMuaWQgPSBSU19kb2NzX3Nlcmllcy5jZWxsCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWQgPSA/CiAgICAgICAgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCAoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKCiAgICBkZWYgZ2V0X2RvY19wcm9wX2J5X2lkKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgdGFibGVfbmFtZSA9IHNlbGYuZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZQogICAgICAgIHEgPSBmJycnCiAgICAgICAgU0VMRUNUIHt0YWJsZV9uYW1lfS5pZF9kb2MsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmRvY19uLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5kb2NfZGF0ZSwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlIGFzIGlkX3dhcmVob3VzZSwKICAgICAgICAgICBSU193YXJlaG91c2VzLm5hbWUgYXMgd2FyZWhvdXNlCiAgICAgICAgICAgCiAgICAgICAgRlJPTSB7dGFibGVfbmFtZX0KICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBPTgogICAgICAgIHt0YWJsZV9uYW1lfS5pZF93YXJlaG91c2UgPSBSU193YXJlaG91c2VzLmlkCiAgICAgICAgICAKICAgICAgICBXSEVSRSB7dGFibGVfbmFtZX0uaWRfZG9jID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWRfZG9jLCksVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCiAgICBkZWYgZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKHNlbGYsIGlkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5wcmljZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfbiwgJycpIEFTIGRvY19uLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfZGF0ZSwgJycpIEFTIGRvY19kYXRlLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMubmFtZSwgJycpIEFTIGdvb2RfbmFtZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmFydCwgJycpIEFTIGdvb2RfYXJ0LAogICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCAnJykgQVMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwgJycpIEFTIGdvb2RfdW5pdCAKICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgQVMgUlNfZG9jc190YWJsZQogICAgICAgIAogICAgICAgIExFRlQgSk9JTiBSU19kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwoaWQsKSxUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBzYXZlX3RhYmxlX3N0cihzZWxmLCBwYXJhbXMpOgogICAgICAgIHEgPSAnJycKICAgICAgICBVUERBVEUgUlNfZG9jc19zZXJpZXMKICAgICAgICBTRVQgCiAgICAgICAgICAgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzLAogICAgICAgICAgIGlkX3NlcmllcyA9IDppZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlID0gOmlkX3dhcmVob3VzZSwKICAgICAgICAgICBxdHR5ID0gOnF0dHksCiAgICAgICAgICAgbmFtZSA9IDpuYW1lLAogICAgICAgICAgIGJlc3RfYmVmb3JlID0gOmJlc3RfYmVmb3JlLAogICAgICAgICAgIG51bWJlciA9IDpudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlID0gOnByb2R1Y3Rpb25fZGF0ZSwKICAgICAgICAgICBjZWxsICA9IDpjZWxsCiAgICAgICAgV0hFUkUgaWQgPSA6aWQgJycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0X3RvdGFsX3F0dHkoc2VsZik6CgogICAgICAgIHBhcmFtcyA9IChzZWxmLnBhcmFtcy5nZXQoJ2lkX2RvYycpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2dvb2QnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9wcm9wZXJ0aWVzJykpCiAgICAgICAgcSA9ICcnJwogICAgICAgIFNFTEVDVCAKICAgICAgICBzdW0ocXR0eSkgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBpZF9nb29kID0gPyBBTkQgaWRfcHJvcGVydGllcyA9ID8nJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIHBhcmFtcykKICAgICAgICBpZiByZXMgYW5kIHJlc1swXVswXSBpcyBub3QgTm9uZToKICAgICAgICAgICAgcmV0dXJuIHJlc1swXVswXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAwCgogICAgZGVmIHVwZGF0ZV90b3RhbF9xdHkoc2VsZiwgcXR5LCByb3dfaWQpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFVQREFURSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgIFNFVCBkX3F0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgQWRyU2VyaWVzU2VydmljZShTZXJpZXNTZXJ2aWNlKToKICAgIGRlZiBnZXRfdmFsdWVzX2Zvcl9zY3JlZW5fYnlfaWQoc2VsZiwgX2lkKSAtPiBkaWN0OgoKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCBSU19kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5LAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS51c2Vfc2VyaWVzLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2NlbGwsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY190eXBlLCAnJykgQVMgZG9jX3R5cGUsCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19uLCAnJykgQVMgZG9jX24sCiAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19kYXRlLCAnJykgQVMgZG9jX2RhdGUsCiAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5uYW1lLCAnJykgQVMgZ29vZF9uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuYXJ0LCAnJykgQVMgZ29vZF9hcnQsCiAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsICcnKSBBUyBwcm9wZXJ0aWVzX25hbWUsCiAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCAnJykgQVMgZ29vZF91bml0LCAKICAgICAgICAgICAgSUZOVUxMKFJTX2NlbGxzLm5hbWUsICcnKSBBUyBjZWxsX25hbWUKICAgICAgICBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIEFTIFJTX2RvY3NfdGFibGUKCiAgICAgICAgTEVGVCBKT0lOIFJTX2Fkcl9kb2NzIEFTIFJTX2RvY3MgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZAogICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcyA9IFJTX3Byb3BlcnRpZXMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfdW5pdHMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9jZWxsID0gUlNfY2VsbHMuaWQKICAgICAgICBXSEVSRSBSU19kb2NzX3RhYmxlLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKF9pZCwpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiB1cGRhdGVfdG90YWxfcXR5KHNlbGYsIHF0eSwgcm93X2lkKToKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUKICAgICAgICAgICAgU0VUIHF0dHkgPSB7cXR5fSwgdXNlX3NlcmllcyA9IDEKICAgICAgICAgICAgV0hFUkUgaWQgPSB7cm93X2lkfQogICAgICAgICAgICAnJycKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHEpCgoKY2xhc3MgU2VsZWN0SXRlbVNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCgogICAgZGVmIGdldF9zZWxlY3RfZGF0YShzZWxmLCAqKmNvbmQpIC0+IGxpc3Q6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi50YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc2VsZWN0KGNvbmQpCgoKY2xhc3MgQWRyRG9jU2VydmljZShEb2NTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkb2NfaWQ9JycsIGN1cl9jZWxsPScnLCB0YWJsZV90eXBlPSdpbicpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuZG9jX2lkID0gZG9jX2lkCiAgICAgICAgc2VsZi5kb2NzX3RhYmxlX25hbWUgPSAnUlNfQWRyX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfYWRyX2RvY3NfdGFibGUnCiAgICAgICAgc2VsZi5pc0FkciA9IFRydWUKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IEZhbHNlCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSBjdXJfY2VsbAogICAgICAgIHNlbGYudGFibGVfdHlwZSA9IHRhYmxlX3R5cGUKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzZWxmLmRvY3NfdGFibGVfbmFtZSwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gRmFsc2UKICAgICAgICBzZWxmLmlzX2JhcmNfZmxvdyA9IEZhbHNlCgogICAgZGVmIGdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBzZWxmLAogICAgICAgICAgICBmaXJzdF9lbGVtLAogICAgICAgICAgICBpdGVtc19vbl9wYWdlLAogICAgICAgICAgICByb3dfZmlsdGVycz1Ob25lLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPU5vbmUsCiAgICAgICAgICAgIGlkX2RvYz0nJywKICAgICAgICAgICAgY2VsbD0nJwogICAgKSAtPiBsaXN0OgoKICAgICAgICBzZWxlY3RfcXVlcnkgPSAnJydTRUxFQ1QKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLm5hbWUsIDpOdWxsVmFsdWUpIGFzIGdvb2RfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLmNvZGUsIDpFbXB0eVN0cmluZykgYXMgY29kZSwKICAgICAgICAgICAgaWZudWxsKFJTX2dvb2RzLmFydCwgOkVtcHR5U3RyaW5nKSBhcyBhcnQsCiAgICAgICAgICAgIGlmbnVsbChSU19hZHJfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLCA6RW1wdHlTdHJpbmcpIGFzIGlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgIGlmbnVsbChSU19wcm9wZXJ0aWVzLm5hbWUsIDpFbXB0eVN0cmluZykgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfc2VyaWVzLCA6RW1wdHlTdHJpbmcpIGFzIGlkX3NlcmllcywKICAgICAgICAgICAgaWZudWxsKFJTX3Nlcmllcy5uYW1lLCA6RW1wdHlTdHJpbmcpIGFzIHNlcmllc19uYW1lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfdW5pdCwgOkVtcHR5U3RyaW5nKSBhcyBpZF91bml0LAogICAgICAgICAgICBpZm51bGwoUlNfdW5pdHMubmFtZSwgOkVtcHR5U3RyaW5nKSBhcyB1bml0c19uYW1lLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5IGFzIHF0dHksCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHlfcGxhbiBhcyBxdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHlfcGxhbiAtIFJTX2Fkcl9kb2NzX3RhYmxlLnF0dHkgYXMgSXNEb25lLAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfY2VsbCwgOkVtcHR5U3RyaW5nKSBhcyBpZF9jZWxsLAogICAgICAgICAgICBpZm51bGwoUlNfY2VsbHMubmFtZSwgOk51bGxWYWx1ZSkgYXMgY2VsbF9uYW1lLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS51c2Vfc2VyaWVzCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jc190YWJsZSAKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gUlNfYWRyX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiAgICAgICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9IFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3NlcmllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfdW5pdAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMKICAgICAgICAgICAgT04gUlNfY2VsbHMuaWQ9UlNfYWRyX2RvY3NfdGFibGUuaWRfY2VsbAogICAgICAgICAgICAnJycKCiAgICAgICAgYmFzaWNfd2hlcmUgPSBmIiIiV0hFUkUgaWRfZG9jID0gOmlkX2RvYyBhbmQgdGFibGVfdHlwZSA9IDp0YWJsZV90eXBlIiIiCgogICAgICAgIGN1cl9jZWxsX2NvbmRpdGlvbiA9ICcnJ2FuZCAoaWRfY2VsbD06Y3VycmVudF9jZWxsIE9SIGlkX2NlbGw9IiIgT1IgaWRfY2VsbCBpcyBOdWxsKScnJyBpZiBjZWxsIGVsc2UgJycKICAgICAgICByb3dfZmlsdGVyc19jb25kaXRpb24gPSAiIiJBTkQgcXR0eSAhPSBDT0FMRVNDRShxdHR5X3BsYW4sICcwJykgIiIiIGlmIHJvd19maWx0ZXJzIGVsc2UgJycKICAgICAgICBzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbiA9IGYiIiJBTkQgZ29vZF9uYW1lIExJS0UgJyV7c2VhcmNoX3N0cmluZ30lJyIiIiBpZiBzZWFyY2hfc3RyaW5nIGVsc2UgJycKCiAgICAgICAgd2hlcmVfZnVsbCA9IGYiIiIKICAgICAgICAgICAgICAgIHtiYXNpY193aGVyZX0KICAgICAgICAgICAgICAgIHtjdXJfY2VsbF9jb25kaXRpb259CiAgICAgICAgICAgICAgICB7cm93X2ZpbHRlcnNfY29uZGl0aW9ufQogICAgICAgICAgICAgICAge3NlYXJjaF9zdHJpbmdfY29uZGl0aW9ufQogICAgICAgICIiIgoKICAgICAgICBvcmRlcl9ieSA9IGYiIiJPUkRFUiBCWSBSU19jZWxscy5uYW1lLCBSU19hZHJfZG9jc190YWJsZS5sYXN0X3VwZGF0ZWQgREVTQyIiIgogICAgICAgIGxpbWl0ID0gZidMSU1JVCB7aXRlbXNfb25fcGFnZX0gT0ZGU0VUIHtmaXJzdF9lbGVtfScKICAgICAgICBxdWVyeV90ZXh0ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfZnVsbH0ge29yZGVyX2J5fSB7bGltaXR9IgoKICAgICAgICBwYXJhbXNfZGljdCA9IHsnaWRfZG9jJzogaWRfZG9jLCAnTnVsbFZhbHVlJzogTm9uZSwgJ0VtcHR5U3RyaW5nJzogJycsICd0YWJsZV90eXBlJzogc2VsZi50YWJsZV90eXBlfQogICAgICAgIGlmIGNlbGw6CiAgICAgICAgICAgIHBhcmFtc19kaWN0WydjdXJyZW50X2NlbGwnXSA9IGNlbGwKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIHBhcmFtc19kaWN0LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgX2ZpbHRlciA9IHsnaWRfZG9jJzogaWRfZG9jfQogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9ICdSU19kb2NzX3NlcmllcycKICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyPV9maWx0ZXIpCgogICAgICAgIHF1ZXJ5X3RleHQgPSAoJ1VwZGF0ZSBSU19hZHJfZG9jc190YWJsZSBTZXQgcXR0eSA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ0RlbGV0ZSBGcm9tIFJTX2Fkcl9kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYz06aWRfZG9jIGFuZCBpc19wbGFuID0gIkZhbHNlIicpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmb3IgZWwgaW4gcXVlcnlfdGV4dDoKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQoZWwsICh7J2lkX2RvYyc6IGlkX2RvY30pKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogRmFsc2UsICdlcnJvcic6IGUuYXJnc1swXX0KCiAgICAgICAgcmV0dXJuIHsncmVzdWx0JzogVHJ1ZSwgJ2Vycm9yJzogJyd9CgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmQoc2VsZik6CiAgICAgICAgZGF0YSA9IFtdCgogICAgICAgIHEgPSBmJycnU0VMRUNUIGlkX2RvYwogICAgICAgICAgICAgICAgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IAogICAgICAgICAgICAgICAgV0hFUkUgdmVyaWZpZWQgPSAxICBBTkQgKHNlbnQgPSAwIE9SIHNlbnQgSVMgTlVMTCkKICAgICAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKCiAgICAgICAgZm9yIHJvdyBpbiByZXM6CiAgICAgICAgICAgIGlkX2RvYyA9IHJvd1snaWRfZG9jJ10KCiAgICAgICAgICAgIGRvY19kYXRhID0gewogICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGlkX2RvYywKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnaWRfZ29vZCcsICdpZF9wcm9wZXJ0aWVzJywgJ2lkX3NlcmllcycsICdpZF91bml0JywgJ3F0dHknLCAncXR0eV9wbGFuJywgJ3RhYmxlX3R5cGUnLAogICAgICAgICAgICAgICAgICAgICAgJ2lkX2NlbGwnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCAoc2VudCA9IDAgT1Igc2VudCBJUyBOVUxMKQogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCiAgICAgICAgICAgIGdvb2RzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfYWRyX2RvY3NfdGFibGUnXSA9IGdvb2RzCgoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnaWRfZ29vZCcsICdpZF9zZXJpZXMnLCAnaWRfd2FyZWhvdXNlJywgJ2NlbGwnLCAncXR0eScsICduYW1lJywgJ2Jlc3RfYmVmb3JlJywgJ251bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIHNlcmllc190YWJsZSA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3Nfc2VyaWVzJ10gPSBzZXJpZXNfdGFibGUKCiAgICAgICAgICAgIGRhdGEuYXBwZW5kKGRvY19kYXRhKQoKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgZmluZF9jZWxsKHNlbGYsIGJhcmNvZGUpOgogICAgICAgICMgVE9ETyDQvdC1INGD0YfQuNGC0YvQstCw0LXRgtGB0Y8g0LLQsNGA0LjQsNC90YIg0YEg0L7QtNC40L3QsNC60L7QstGL0LzQuCDQqNCaINGB0LXRgNC40LkKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnUlNfY2VsbHMnCiAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zZWxlY3QoeydiYXJjb2RlJzogYmFyY29kZX0pCgogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQoKY2xhc3MgRmxvd0RvY1NlcnZpY2UoRG9jU2VydmljZSk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRvY19pZD0nJyk6CiAgICAgICAgc2VsZi5kb2NfaWQgPSBkb2NfaWQKICAgICAgICBzZWxmLmRvY3NfdGFibGVfbmFtZSA9ICdSU19kb2NzJwogICAgICAgIHNlbGYuZGV0YWlsc190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICAgICAgc2VsZi5pc0FkciA9IEZhbHNlCiAgICAgICAgc2VsZi5zcWxfdGV4dCA9ICcnCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gTm9uZQogICAgICAgIHNlbGYuZGVidWcgPSBGYWxzZQogICAgICAgIHNlbGYucHJvdmlkZXIgPSBTcWxRdWVyeVByb3ZpZGVyKHNlbGYuZG9jc190YWJsZV9uYW1lLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKICAgICAgICBzZWxmLmlzX2dyb3VwX3NjYW4gPSBGYWxzZQogICAgICAgIHNlbGYuaXNfYmFyY19mbG93ID0gVHJ1ZQoKICAgIGRlZiBnZXRfZG9jX3ZpZXdfZGF0YShzZWxmLCBkb2NfdHlwZT0nJywgZG9jX3N0YXR1cz0nJykgLT4gbGlzdDoKICAgICAgICBmaWVsZHMgPSBbCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9kb2MnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX3R5cGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX24nLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCIiKSBhcyBSU193YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnZlcmlmaWVkLCAwKSBhcyB2ZXJpZmllZCcsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uc2VudCwgMCkgYXMgc2VudCcsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5hZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgIF0KCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMnKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfZ3JvdXBfc2NhbiwgMCkgYXMgaXNfZ3JvdXBfc2NhbicpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19iYXJjX2Zsb3csIDApIGFzIGlzX2JhcmNfZmxvdycpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoUlNfY291bnRyYWdlbnRzLmZ1bGxfbmFtZSwgIiIpIGFzIFJTX2NvdW50cmFnZW50JykKCiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgJyArICcsXG4nLmpvaW4oZmllbGRzKQoKICAgICAgICBqb2lucyA9IGYnJydGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgUlNfd2FyZWhvdXNlcwogICAgICAgICAgICAgICAgT04gUlNfd2FyZWhvdXNlcy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlCiAgICAgICAgJycnCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgam9pbnMgKz0gZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY291bnRyYWdlbnRzIGFzIFJTX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgICcnJwoKICAgICAgICB3aGVyZV9iYXJjX2Zsb3cgPSBmJ1dIRVJFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfYmFyY19mbG93ID0gMScKICAgICAgICB3aGVyZV9lbXB0eSA9ICgiUlNfZG9jcy5pZF9kb2Mgbm90IGluICIKICAgICAgICAgICAgICAgICAgICAgICAiKFNFTEVDVCBkaXN0aW5jdCBpZF9kb2MgRnJvbSBSU19kb2NzX3RhYmxlKSIpCiAgICAgICAgd2hlcmUgPSBmInt3aGVyZV9iYXJjX2Zsb3d9IE9SIHt3aGVyZV9lbXB0eX0iCgogICAgICAgIGlmIGRvY19zdGF0dXM6CiAgICAgICAgICAgIGlmIGRvY19zdGF0dXMgPT0gItCS0YvQs9GA0YPQttC10L0iOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gIkFORCBzZW50PTEgQU5EIHZlcmlmaWVkPTEiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9Cz0YDRg9C30LrQtSI6CiAgICAgICAgICAgICAgICB3aGVyZSArPSAiQU5EIGlmbnVsbCh2ZXJpZmllZCwwKT0xIEFORCBpZm51bGwoc2VudCwwKT0wIgogICAgICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQv9C+0LvQvdC10L3QuNGOIjoKICAgICAgICAgICAgICAgIHdoZXJlICs9ICJBTkQgaWZudWxsKHZlcmlmaWVkLDApPTAgQU5EIGlmbnVsbChzZW50LDApPTAiCgogICAgICAgIGlmIG5vdCBkb2NfdHlwZSBvciBkb2NfdHlwZSA9PSAi0JLRgdC1IjoKICAgICAgICAgICAgYXJnc190dXBsZSA9IE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gKGRvY190eXBlLCkKICAgICAgICAgICAgd2hlcmUgKz0gJyBBTkQgZG9jX3R5cGU9PycKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICB7cXVlcnlfdGV4dH0KICAgICAgICAgICAge2pvaW5zfQogICAgICAgICAgICB7d2hlcmV9CiAgICAgICAgICAgIE9SREVSIEJZIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUKICAgICAgICAnJycKICAgICAgICByZXN1bHQgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfdHVwbGUsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBnZXRfZmxvd190YWJsZV9kYXRhKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJydXSVRIIHRlbXBfcSBhcyAoU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNfZmxvdy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kIGFzIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAxIGFzIHF0dHkKCiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfYmFyY29kZXMuYmFyY29kZSA9IFJTX2JhcmNfZmxvdy5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2JhcmNfZmxvdy5pZF9kb2MgPSA/KQoKICAgICAgICAgICAgICAgICAgICAgICAgU0VMRUNUIHRlbXBfcS5iYXJjb2RlLCB0ZW1wX3EuaWRfZ29vZCwgdGVtcF9xLmlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAgICBzdW0ocXR0eSkgYXMgcXR0eQogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHRlbXBfcQogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy5pZCA9IHRlbXBfcS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgICAgIEdST1VQIEJZIHRlbXBfcS5iYXJjb2RlJycnCgogICAgICAgIHJldHVybiBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChzZWxmLmRvY19pZCwpLCBUcnVlKQoKICAgIGRlZiBnZXRfZGF0YV9mb3JfdGlja2V0X3ByaW50aW5nKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJydXSVRIIHRlbXBfcSBhcyAoU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNfZmxvdy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9nb29kIGFzIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAxIGFzIHF0dHkKCiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfYmFyY29kZXMuYmFyY29kZSA9IFJTX2JhcmNfZmxvdy5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2JhcmNfZmxvdy5pZF9kb2M9PyBBTkQgUlNfYmFyY19mbG93LmJhcmNvZGUgPSA/KQoKICAgICAgICAgICAgICAgICAgICAgICAgU0VMRUNUIHRlbXBfcS5iYXJjb2RlLCB0ZW1wX3EuaWRfZ29vZCwgdGVtcF9xLmlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lIGFzIG5hbWUsIAogICAgICAgICAgICAgICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgUHJvcF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICBzdW0ocXR0eSkgYXMgcXR0eQogICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHRlbXBfcQogICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy5pZCA9IHRlbXBfcS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IHRlbXBfcS5pZF9wcm9wZXJ0eSAgICAKICAgICAgICAgICAgICAgICAgICAgIEdST1VQIEJZIHRlbXBfcS5iYXJjb2RlCiAgICAgICAgICAgICAgICAgICAgICAnJycKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoc2VsZi5kb2NfaWQsIGJhcmNvZGUpLCBUcnVlKQoKICAgIGRlZiBhZGRfYmFyY29kZV90b19kYXRhYmFzZShzZWxmLCBiYXJjb2RlOiBzdHIpOgogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBxdGV4dCA9ICcnJ0lOU0VSVCBJTlRPIFJTX2JhcmNfZmxvdyAoaWRfZG9jLCBiYXJjb2RlKSBWQUxVRVMgKD8sPyknJycKICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHF0ZXh0LCAnLCcuam9pbihbc2VsZi5kb2NfaWQsIGJhcmNvZGVdKSkKICAgICAgICBzZWxmLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmRvY19pZCkKCiAgICBkZWYgc2V0X2JhcmNfZmxvd19zdGF0dXMoc2VsZik6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kb2NzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZSh7J2lzX2JhcmNfZmxvdyc6ICcxJ30sIHsnaWRfZG9jJzogc2VsZi5kb2NfaWR9KQoKCmNsYXNzIEdvb2RzU2VydmljZShEYlNlcnZpY2UpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGl0ZW1faWQ9JycpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuaXRlbV9pZCA9IGl0ZW1faWQKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcih0YWJsZV9uYW1lPSJSU19nb29kcyIsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQoKICAgIGRlZiBnZXRfdHlwZV9uYW1lX2J5X2lkKHNlbGYsIGlkKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiJTRUxFQ1QgbmFtZSBGUk9NIFJTX3R5cGVzX2dvb2RzIFdIRVJFIGlkID0ne2lkfSciCiAgICAgICAgcmV0dXJuIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKCiAgICBkZWYgZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxmLCBnb29kc190eXBlPScnLCBpdGVtX2lkPScnKSAtPiBsaXN0OgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgUlNfZ29vZHMuaWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuY29kZSwgJ+KAlCcpIEFTIGNvZGUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lLAogICAgICAgICAgICAgICAgUlNfZ29vZHMuYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsJ+KAlCcpIEFTIHVuaXQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdHlwZXNfZ29vZHMubmFtZSwgJ+KAlCcpIEFTIHR5cGVfZ29vZCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5kZXNjcmlwdGlvbiwn4oCUJykgQVMgZGVzY3JpcHRpb24KICAgICAgICAgICAgRlJPTSBSU19nb29kcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdHlwZXNfZ29vZHMKICAgICAgICAgICAgICAgIE9OIFJTX3R5cGVzX2dvb2RzLmlkID0gUlNfZ29vZHMudHlwZV9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSBSU19nb29kcy51bml0CiAgICAgICAgICAgICIiIgogICAgICAgIHdoZXJlID0gJycgaWYgbm90IGdvb2RzX3R5cGUgZWxzZSAnV0hFUkUgUlNfZ29vZHMudHlwZV9nb29kPT8nCiAgICAgICAgaWYgd2hlcmUgPT0gJycgYW5kIGl0ZW1faWQ6CiAgICAgICAgICAgIHdoZXJlICs9ICdXSEVSRSBSU19nb29kcy5pZD0/JwoKICAgICAgICBxdWVyeV90ZXh0ID0gZicnJwogICAgICAgICAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgICAgICAgICBPUkRFUiBCWSBSU19nb29kcy5pZAogICAgICAgICAgICAgICAgJycnCgogICAgICAgIGlmIGdvb2RzX3R5cGU6CiAgICAgICAgICAgIGFyZ3MgPSBnb29kc190eXBlCiAgICAgICAgZWxpZiBpdGVtX2lkOgogICAgICAgICAgICBhcmdzID0gaXRlbV9pZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3MgPSBOb25lCgogICAgICAgIHJlc3VsdCA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2l0ZW1fZGF0YV9ieV9pZChzZWxmLCBpdGVtX2lkKToKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmlkLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmNvZGUsICfigJQnKSBBUyBjb2RlLAogICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCfigJQnKSBBUyB1bml0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3R5cGVzX2dvb2RzLm5hbWUsICfigJQnKSBBUyB0eXBlX2dvb2QsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuZGVzY3JpcHRpb24sJ+KAlCcpIEFTIGRlc2NyaXB0aW9uCiAgICAgICAgICAgIEZST00gUlNfZ29vZHMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3R5cGVzX2dvb2RzCiAgICAgICAgICAgICAgICBPTiBSU190eXBlc19nb29kcy5pZCA9IFJTX2dvb2RzLnR5cGVfZ29vZAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfZ29vZHMudW5pdAogICAgICAgICAgICBXSEVSRSBSU19nb29kcy5pZCA9ICJ7aXRlbV9pZH0iCiAgICAgICAgICAgIAogICAgICAgICAgICBMSU1JVCAxCiAgICAgICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0KQogICAgICAgIHJldHVybiByZXN1bHRbMF0gaWYgcmVzdWx0IGVsc2Uge30KCiAgICBkZWYgZ2V0X2l0ZW1fZGF0YV9ieV9jb25kaXRpb24oc2VsZiwgaXRlbV9pZCwgcHJvcGVydHlfaWQ9JycsIHVuaXRfaWQ9JycpIC0+IGRpY3Q6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBSU19nb29kcy5pZCBBUyBpZCwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmNvZGUgQVMgY29kZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgQVMgbmFtZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmFydCBhcyBhcnQsCiAgICAgICAgICAgICAgICBSU19nb29kcy5kZXNjcmlwdGlvbiBBUyBkZXNjcmlwdGlvbiwKICAgICAgICAgICAgICAgIElGTlVMTChSU191bml0cy5uYW1lLCfigJQnKSBBUyB1bml0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3Byb3BlcnRpZXMubmFtZSwn4oCUJykgQVMgcHJvcGVydHkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2dvb2RzCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gInt1bml0X2lkfSIKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPSAie3Byb3BlcnR5X2lkfSIKICAgICAgICAgICAgV0hFUkUgUlNfZ29vZHMuaWQgPSAie2l0ZW1faWR9IgoKICAgICAgICAgICAgTElNSVQgMQogICAgICAgICAgICAiIiIKICAgICAgICByZXN1bHQgPSBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCkKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIHt9CgogICAgZGVmIGdldF9hbGxfZ29vZHNfdHlwZXNfZGF0YShzZWxmKToKICAgICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCBpZCxuYW1lIEZST00gUlNfdHlwZXNfZ29vZHMnCiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gJ1JTX3R5cGVzX2dvb2RzJwogICAgICAgIHJldHVybiBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgJycpCgogICAgZGVmIGdldF92YWx1ZXNfZnJvbV9iYXJjb2RlKHNlbGYsIGlkZW50aWZ5X2ZpZWxkOiBzdHIsIGlkZW50aWZ5X3ZhbHVlOiBzdHIpIC0+IGxpc3Q6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5iYXJjb2RlLAogICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLm5hbWUsICcnKSBBUyBuYW1lLAogICAgICAgICAgICAgICAgICAgIElGTlVMTChSU19wcm9wZXJ0aWVzLm5hbWUsICcnKSBBUyBwcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICBJRk5VTEwoUlNfc2VyaWVzLm5hbWUsICcnKSBBUyBzZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsICcnKSBBUyB1bml0CgogICAgICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMKICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQgPSBSU19iYXJjb2Rlcy5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5CiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfYmFyY29kZXMuaWRfdW5pdAogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfc2VyaWVzLmlkID0gUlNfYmFyY29kZXMuaWRfc2VyaWVzCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgV0hFUkUge2lkZW50aWZ5X2ZpZWxkfSA9ICd7aWRlbnRpZnlfdmFsdWV9JwogICAgICAgICAgICAgICAgICAgICIiIgoKICAgICAgICByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsICcnKQoKICAgIGRlZiBnZXRfdmFsdWVzX2J5X2ZpZWxkKHNlbGYsIHRhYmxlX25hbWUsIGZpZWxkLCBmaWVsZF92YWx1ZSk6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnNlbGVjdCh7ZmllbGQ6IGZpZWxkX3ZhbHVlfSkKCiAgICBkZWYgZ2V0X3F1ZXJ5X3dpdGhfYXJnX2xpc3Qoc2VsZiwgdGFibGVfbmFtZSwgdmFsdWUsIGZpZWxkLCB0YWJsZV9zdHJpbmdfaWQpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiU0VMRUNUIGlmbnVsbCh7dmFsdWV9LCAnLScpIGFzIHt2YWx1ZX0gRlJPTSB7dGFibGVfbmFtZX0gV0hFUkUge2ZpZWxkfSBpbiAoe3RhYmxlX3N0cmluZ19pZH0pIiIiCiAgICAgICAgIyBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgIyByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsIHRhYmxlX25hbWU9dGFibGVfbmFtZSwgcGFyYW1zPScnKQogICAgICAgIHJldHVybiBxdWVyeV90ZXh0CgogICAgZGVmIGdldF9zZWxlY3RfZGF0YShzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBxdWVyeV90ZXh0ID0gZidTRUxFQ1QgKiBGUk9NIHt0YWJsZV9uYW1lfScKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCAnJykKCgpjbGFzcyBEYkNyZWF0b3IoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKCiAgICBkZWYgY3JlYXRlX3RhYmxlcyhzZWxmKToKICAgICAgICBpbXBvcnQgZGF0YWJhc2VfaW5pdF9xdWVyeWVzCiAgICAgICAgIyDQodC+0LfQtNCw0LXQvCDRgtCw0LHQu9C40YbRiyDQtdGB0LvQuCDQuNGFINC90LXRggogICAgICAgIHNjaGVtYSA9IGRhdGFiYXNlX2luaXRfcXVlcnllcy5kYXRhYmFzZV9zaGVtYSgpCiAgICAgICAgZm9yIGVsIGluIHNjaGVtYToKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChlbCkKCiAgICBkZWYgZHJvcF9hbGxfdGFibGVzKHNlbGYpOgogICAgICAgIHRhYmxlcyA9IHNlbGYuZ2V0X2FsbF90YWJsZXMoKQoKICAgICAgICBmb3IgdGFibGUgaW4gdGFibGVzOgogICAgICAgICAgICBzZWxmLl9zcWxfcXVlcnkoZidEUk9QIFRBQkxFIHt0YWJsZX0nKQoKICAgIGRlZiBnZXRfYWxsX3RhYmxlcyhzZWxmKToKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIG5hbWUgCiAgICAgICAgICAgIEZST00gCiAgICAgICAgICAgICAgICBzcWxpdGVfbWFzdGVyCiAgICAgICAgICAgIFdIRVJFIAogICAgICAgICAgICAgICAgdHlwZT0ndGFibGUnIEFORCAKICAgICAgICAgICAgICAgIG5hbWUgTk9UIExJS0UgJ3NxbGl0ZV8lJwogICAgICAgICcnJwogICAgICAgIHRhYmxlcyA9IHNlbGYuX3NxbF9xdWVyeShxKQoKICAgICAgICByZXR1cm4gW3RhYmxlWyduYW1lJ10gZm9yIHRhYmxlIGluIHRhYmxlc10KCgpjbGFzcyBFcnJvclNlcnZpY2U6CiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0X2FsbF9lcnJvcnMoZGF0ZV9zb3J0KToKICAgICAgICBzb3J0ID0gIkRFU0MiIGlmIG5vdCBkYXRlX3NvcnQgb3IgZGF0ZV9zb3J0ID09ICLQndC+0LLRi9C1IiBlbHNlICJBU0MiCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQoZiJTRUxFQ1QgKiBGUk9NIEVycm9yX2xvZyBPUkRFUiBCWSB0aW1lc3RhbXAge3NvcnR9IikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY2xlYXIoKToKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdCgiREVMRVRFIEZST00gRXJyb3JfbG9nIikKCmNsYXNzIFVuaXZlcnNhbENhcmRzU2VydmljZShEYlNlcnZpY2UpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYudGFibGVfbmFtZTogc3RyCiAgICAgICAgc2VsZi5maWx0ZXJfZmllbGRzID0gW10KICAgICAgICBzZWxmLmZpbHRlcl92YWx1ZSA9ICcnCiAgICAgICAgc2VsZi5leGNsdWRlX2xpc3QgPSBbXQogICAgICAgIHNlbGYubm9fbGFiZWwgPSBGYWxzZQogICAgICAgIHNlbGYudGFibGVfbmFtZXMgPSBzZWxmLl90YWJsZV9uYW1lc19kaWN0KCkKCiAgICBkZWYgZ2V0X3ZpZXdzX2RhdGEoc2VsZiwgdGFibGVfbmFtZTogc3RyKToKICAgICAgICBmaWVsZHMgPSBzZWxmLl9nZXRfZmllbGRzKHRhYmxlX25hbWUpCiAgICAgICAgZmllbGRzX2xpbmtzID0ge30KICAgICAgICBxX2ZpZWxkcyA9IFtdCiAgICAgICAgcV9qb2lucyA9IFtdCiAgICAgICAgcV9jb25kaXRpb25zID0gWyd0cnVlJ10KCiAgICAgICAgZm9yIGZpZWxkIGluIGZpZWxkczoKICAgICAgICAgICAgaWYgZmllbGQgaW4gc2VsZi5leGNsdWRlX2xpc3Q6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgcV9maWVsZHMuYXBwZW5kKCd7fS57fSBBUyB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgdGFibGVfbmFtZSwgZmllbGQsICdrZXknIGlmIGZpZWxkID09ICdpZCcgZWxzZSBmaWVsZCkpCgogICAgICAgICAgICBsaW5rX3RhYmxlX25hbWUgPSBzZWxmLnRhYmxlX25hbWVzLmdldChmaWVsZCkKICAgICAgICAgICAgaWYgbGlua190YWJsZV9uYW1lOgogICAgICAgICAgICAgICAgcV9maWVsZHMuYXBwZW5kKGYne2xpbmtfdGFibGVfbmFtZX0ubmFtZSBhcyB7bGlua190YWJsZV9uYW1lfV9uYW1lJykKICAgICAgICAgICAgICAgIHFfam9pbnMuYXBwZW5kKCdMRUZUIEpPSU4ge30gT04ge30uaWQgPSB7fS57fScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGxpbmtfdGFibGVfbmFtZSwgbGlua190YWJsZV9uYW1lLCB0YWJsZV9uYW1lLCBmaWVsZAogICAgICAgICAgICAgICAgKSkKCiAgICAgICAgICAgICAgICBmaWVsZHNfbGlua3NbZmllbGRdID0gZid7bGlua190YWJsZV9uYW1lfV9uYW1lJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZmllbGRzX2xpbmtzW2ZpZWxkXSA9ICdrZXknIGlmIGZpZWxkID09ICdpZCcgZWxzZSBmaWVsZAoKICAgICAgICBpZiBzZWxmLmZpbHRlcl92YWx1ZToKICAgICAgICAgICAgcV9jb25kaXRpb25zID0gW2Yie3RhYmxlX25hbWV9LntmaWVsZH0gTElLRSAnJXtzZWxmLmZpbHRlcl92YWx1ZX0lJyIgZm9yIGZpZWxkIGluIHNlbGYuZmlsdGVyX2ZpZWxkc10KCiAgICAgICAgcSA9ICcnJ1NFTEVDVCB7fSAKICAgICAgICAgICAgICAgIEZST00ge30KICAgICAgICAgICAgICAgIHt9CiAgICAgICAgICAgICAgICBXSEVSRSB7fQogICAgICAgICcnJy4gZm9ybWF0KCcsJy5qb2luKHFfZmllbGRzKSwgdGFibGVfbmFtZSwgJyAnLmpvaW4ocV9qb2lucyksICcgT1IgJy5qb2luKHFfY29uZGl0aW9ucykpCgogICAgICAgIHJldHVybiBmaWVsZHNfbGlua3MsIHNlbGYuX3NxbF9xdWVyeShxKQoKICAgIGRlZiBfZ2V0X2ZpZWxkcyhzZWxmLCB0YWJsZV9uYW1lKSAtPiBMaXN0W3N0cl06CiAgICAgICAgIiIiCiAgICAgICAgOnBhcmFtIHRhYmxlX25hbWU6CiAgICAgICAgOnJldHVybiBsaXN0IGNvbHVtbiBuYW1lczoKICAgICAgICAiIiIKICAgICAgICBxID0gZidQUkFHTUEgdGFibGVfaW5mbyh7dGFibGVfbmFtZX0pJwogICAgICAgIHJlcyA9IHNlbGYuX3NxbF9xdWVyeShxLCB0YWJsZV9uYW1lPXRhYmxlX25hbWUpCgogICAgICAgIHJldHVybiBbcm93WyduYW1lJ10gZm9yIHJvdyBpbiByZXNdCgogICAgZGVmIF90YWJsZV9uYW1lc19kaWN0KHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdpZF9nb29kJzogJ1JTX2dvb2RzJywKICAgICAgICAgICAgJ3R5cGVfZ29vZCc6ICdSU190eXBlc19nb29kcycsCiAgICAgICAgICAgICd1bml0JzogJ1JTX3VuaXRzJywKICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogJ1JTX3Byb3BlcnRpZXMnLAogICAgICAgICAgICAnaWRfc2VyaWVzJzogJ1JTX3NlcmllcycsCiAgICAgICAgICAgICdpZF91bml0JzogJ1JTX3VuaXRzJywKICAgICAgICAgICAgJ2lkX2NvdW50cmFnZW50cyc6ICdSU19jb3VudHJhZ2VudHMnLAogICAgICAgICAgICAnaWRfd2FyZWhvdXNlJzogJ1JTX3dhcmVob3VzZXMnLAogICAgICAgICAgICAnaWRfZG9jJzogJ1JTX2RvY3MnLAogICAgICAgICAgICAnaWRfY2VsbCc6ICdSU19jZWxscycsCiAgICAgICAgICAgICdpZF9vd25lcic6ICdSU19nb29kcycsCiAgICAgICAgICAgICdpZF9wcmljZV90eXBlcyc6ICdSU19wcmljZV90eXBlcycKICAgICAgICB9CgpjbGFzcyBTcWxRdWVyeVByb3ZpZGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRhYmxlX25hbWU9JycsIHNxbF9jbGFzcz1zcWxDbGFzcygpLCBkZWJ1Zz1GYWxzZSk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgICMgc2VsZi5zcWwgPSBzcWxfY2xhc3MKICAgICAgICBzZWxmLnNxbCA9IHNlbGYKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IGRlYnVnCgogICAgQHByb3BlcnR5CiAgICBkZWYgdGFibGVfbmFtZShzZWxmKToKICAgICAgICBpZiBzZWxmLl90YWJsZV9uYW1lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fdGFibGVfbmFtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZid7c2VsZn06IHRhYmxlX25hbWUgbXVzdCBiZSBzcGVjaWZpZWQnKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidTcWxRdWVyeVByb3ZpZGVyKHRhYmxlX25hbWU9e3NlbGYuX3RhYmxlX25hbWV9KScKCiAgICBAdGFibGVfbmFtZS5zZXR0ZXIKICAgIGRlZiB0YWJsZV9uYW1lKHNlbGYsIHYpOgogICAgICAgIHNlbGYuX3RhYmxlX25hbWUgPSB2CgogICAgZGVmIGNyZWF0ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfY3JlYXRlKAogICAgICAgICAgICBjb2x1bW5zPXF1ZXJ5X2RhdGFbJ2NvbHVtbnMnXSwKICAgICAgICAgICAgcGFyYW1zPXF1ZXJ5X2RhdGFbJ3BhcmFtcyddCiAgICAgICAgKQoKICAgIGRlZiByZXBsYWNlKHNlbGYsIGRhdGEpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcXVlcnlfZGF0YSA9IHNlbGYuX2NvbnZlcnRfcXVlcnlfZGF0YShkYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19yZXBsYWNlKAogICAgICAgICAgICBjb2x1bW5zPXF1ZXJ5X2RhdGFbJ2NvbHVtbnMnXSwKICAgICAgICAgICAgcGFyYW1zPXF1ZXJ5X2RhdGFbJ3BhcmFtcyddCiAgICAgICAgKQoKICAgIGRlZiB1cGRhdGUoc2VsZiwgZGF0YSwgX2ZpbHRlcj1Ob25lKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIGZpbHRlcl9kYXRhID0gW10KICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBsaXN0KF9maWx0ZXIudmFsdWVzKCkpCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSwgZmlsdGVyX2RhdGE9ZmlsdGVyX2RhdGEpCgogICAgICAgIHJldHVybiBzZWxmLl9leGVjX3VwZGF0ZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXSwKICAgICAgICAgICAgd2hlcmU9d2hlcmUKICAgICAgICApCgogICAgZGVmIGRlbGV0ZShzZWxmLCBfZmlsdGVyPU5vbmUpOgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIGZpbHRlcl9kYXRhID0gW10KICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBsaXN0KF9maWx0ZXIudmFsdWVzKCkpCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoe30sIGZpbHRlcl9kYXRhPWZpbHRlcl9kYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19kZWxldGUoCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXSwKICAgICAgICAgICAgd2hlcmU9d2hlcmUKICAgICAgICApCgogICAgZGVmIHNlbGVjdChzZWxmLCBfZmlsdGVyPU5vbmUpIC0+IGxpc3Q6CiAgICAgICAgd2hlcmUgPSBOb25lCiAgICAgICAgcGFyYW1zID0gJycKICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgcGFyYW1zID0gW3N0cih2KSBmb3IgdiBpbiBfZmlsdGVyLnZhbHVlcygpXQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19zZWxlY3QoCiAgICAgICAgICAgIHBhcmFtcz1wYXJhbXMsCiAgICAgICAgICAgIHdoZXJlPXdoZXJlLAogICAgICAgICkKCiAgICBkZWYgX2V4ZWNfY3JlYXRlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcyk6CiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsJy5qb2luKCc/JyAqIGxlbihjb2x1bW5zKSkKICAgICAgICBzdHJfa2V5cyA9ICcsICcuam9pbihbZid7bmFtZX0nIGZvciBuYW1lIGluIGNvbHVtbnNdKQoKICAgICAgICBxID0gZidJTlNFUlQgSU5UTyB7c2VsZi50YWJsZV9uYW1lfSAoe3N0cl9rZXlzfSkgVkFMVUVTICh7c3RyX3ZhbHVlc30pJwoKICAgICAgICBwYXJhbXMgPSBqc29uLmR1bXBzKHBhcmFtcywgZW5zdXJlX2FzY2lpPUZhbHNlKQogICAgICAgIHJldHVybiBzZWxmLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfZXhlY19yZXBsYWNlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcyk6CiAgICAgICAgc3RyX2NvbHVtbnMgPSAnLCAnLmpvaW4oY29sdW1ucykKICAgICAgICBzdHJfdmFsdWVzID0gJywnLmpvaW4oJz8nICogbGVuKGNvbHVtbnMpKQoKICAgICAgICBxID0gZidSRVBMQUNFIElOVE8ge3NlbGYudGFibGVfbmFtZX0gKHtzdHJfY29sdW1uc30pIFZBTFVFUyAoe3N0cl92YWx1ZXN9KScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfdXBkYXRlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsICcuam9pbihbZid7bmFtZX09PycgZm9yIG5hbWUgaW4gY29sdW1uc10pCgogICAgICAgIHEgPSBmJ1VQREFURSB7c2VsZi50YWJsZV9uYW1lfSBTRVQge3N0cl92YWx1ZXN9IFdIRVJFIHtzdHJfd2hlcmV9JwoKICAgICAgICBwYXJhbXMgPSBqc29uLmR1bXBzKHBhcmFtcywgZW5zdXJlX2FzY2lpPUZhbHNlKQogICAgICAgIHJldHVybiBzZWxmLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfZXhlY19kZWxldGUoc2VsZiwgcGFyYW1zLCB3aGVyZT1Ob25lKToKICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJyBhbmQgJy5qb2luKFtmJ3trZXl9PT8nIGZvciBrZXkgaW4gd2hlcmVdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICd0cnVlJwoKICAgICAgICBxID0gZidERUxFVEUgRlJPTSB7c2VsZi50YWJsZV9uYW1lfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfc2VsZWN0KHNlbGYsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgcSA9IGYnU0VMRUNUICogRlJPTSB7c2VsZi50YWJsZV9uYW1lfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0gJywgJy5qb2luKHBhcmFtcykKICAgICAgICByZXR1cm4gc2VsZi5zcWxfcXVlcnkocSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfZXhlY19tYW55KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgbm90IHNlbGYuZGVidWc6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnNxbC5TUUxFeGVjTWFueShxLCBwYXJhbXMpCgogICAgZGVmIHNxbF9leGVjKHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgbm90IHNlbGYuZGVidWc6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnNxbC5TUUxFeGVjKHEsIHBhcmFtcz1wYXJhbXMpCgogICAgZGVmIHNxbF9xdWVyeShzZWxmLCBxLCBwYXJhbXM6IHN0ciA9ICcnKSAtPiBMaXN0W2RpY3RdOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmLnNxbC5TUUxRdWVyeShxLCBwYXJhbXMpCiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWRzKHJlc3VsdCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2NvbnZlcnRfcXVlcnlfZGF0YShkYXRhLCBmaWx0ZXJfZGF0YT1Ob25lKToKICAgICAgICBjb2x1bW5zID0gW10KICAgICAgICBwYXJhbXMgPSBbXQogICAgICAgIGlmIG5vdCBmaWx0ZXJfZGF0YToKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBbXQoKICAgICAgICBpZiBpc2luc3RhbmNlKGRhdGEsIGxpc3QpOgogICAgICAgICAgICBjb2x1bW5zID0gbGlzdChkYXRhWzBdKQogICAgICAgICAgICBmb3Igcm93IGluIGRhdGE6CiAgICAgICAgICAgICAgICBwYXJhbXMuYXBwZW5kKFt2IGZvciB2IGluIHJvdy52YWx1ZXMoKV0gKyBmaWx0ZXJfZGF0YSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZGF0YSwgZGljdCk6CiAgICAgICAgICAgIGNvbHVtbnMgPSBsaXN0KGRhdGEpCiAgICAgICAgICAgIHBhcmFtcyA9IFtbdiBmb3IgdiBpbiBkYXRhLnZhbHVlcygpXSArIGZpbHRlcl9kYXRhXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIFZhbHVlRXJyb3IoZidkYXRhIG11c3QgYmUgbGlzdCBvciBkaWN0LCBub3Qge3R5cGUoZGF0YSl9JykKCiAgICAgICAgcmV0dXJuIHsnY29sdW1ucyc6IGNvbHVtbnMsICdwYXJhbXMnOiBwYXJhbXN9CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNvbnZlcnRfc3FsX3BhcmFtcyhzcWxfcXVlcnksIHBhcmFtc19kaWN0KToKICAgICAgICBpbXBvcnQgcmUKICAgICAgICBwYXJhbV92YWx1ZXMgPSBbXQoKICAgICAgICBkZWYgcmVwbGFjZV9uYW1lZF9wYXJhbShtYXRjaCk6CiAgICAgICAgICAgIHBhcmFtX25hbWUgPSBtYXRjaC5ncm91cCgxKQoKICAgICAgICAgICAgcGFyYW1fdmFsdWVzLmFwcGVuZChwYXJhbXNfZGljdFtwYXJhbV9uYW1lXSkKCiAgICAgICAgICAgIHJldHVybiAiPyIKCiAgICAgICAgbmV3X3F1ZXJ5ID0gcmUuc3ViKHInOihcdyspJywgcmVwbGFjZV9uYW1lZF9wYXJhbSwgc3FsX3F1ZXJ5KQoKICAgICAgICByZXR1cm4gbmV3X3F1ZXJ5LCBwYXJhbV92YWx1ZXMKCiAgICAjINC80LXRgtC+0LTRiyDQvdC40LbQtSDQtNC+0LHQsNCy0LvQtdC90Ysg0LTQu9GPINCy0YDQtdC80LXQvdC90L7Qs9C+INGA0LXRiNC10L3QuNGPINC/0YDQvtCx0LvQtdC80YsgU1FMUHJvdmlkZXIg0L3QsCA5INCw0L3QtNGA0L7QuNC00LUKICAgIGRlZiBTUUxFeGVjKHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgcGFyYW1zOgogICAgICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhnZXRfcXVlcnlfcmVzdWx0KHEsIHR1cGxlKHBhcmFtcy5zcGxpdCgnLCcpKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxKSkKCiAgICBkZWYgU1FMRXhlY01hbnkoc2VsZiwgcSwgcGFyYW1zKToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gcQogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IHBhcmFtcwoKICAgICAgICByZXR1cm4gYnVsa19xdWVyeShxLCBqc29uLmxvYWRzKHBhcmFtcykpCgogICAgZGVmIFNRTFF1ZXJ5KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgcGFyYW1zOgogICAgICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhnZXRfcXVlcnlfcmVzdWx0KHEsIHR1cGxlKHBhcmFtcy5zcGxpdCgnLCcpKSwgcmV0dXJuX2RpY3Q9VHJ1ZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCByZXR1cm5fZGljdD1UcnVlKSkK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\hs_services.py",
                "PyFileKey": "hs_services",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBDYWxsYWJsZSwgVW5pb24KZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IGpzb24KZnJvbSByZXF1ZXN0cy5hdXRoIGltcG9ydCBIVFRQQmFzaWNBdXRoCgoKY2xhc3MgSHNTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGh0dHBfcGFyYW1zKToKICAgICAgICBzZWxmLnVybCA9IGh0dHBfcGFyYW1zWyd1cmwnXQogICAgICAgIHNlbGYudXNlcm5hbWUgPSBodHRwX3BhcmFtc1sndXNlciddCiAgICAgICAgc2VsZi5wYXNzd29yZCA9IGh0dHBfcGFyYW1zWydwYXNzJ10KICAgICAgICBzZWxmLmFuZHJvaWRfaWQgPSBodHRwX3BhcmFtc1snYW5kcm9pZF9pZCddCiAgICAgICAgc2VsZi5kZXZpY2VfbW9kZWwgPSBodHRwX3BhcmFtc1snZGV2aWNlX21vZGVsJ10KICAgICAgICBzZWxmLnVzZXJfbmFtZSA9IGh0dHBfcGFyYW1zWyd1c2VyX25hbWUnXQogICAgICAgIHNlbGYucGFyYW1zID0geyd1c2VyX25hbWUnOiBzZWxmLnVzZXJfbmFtZSwgJ2RldmljZV9tb2RlbCc6IHNlbGYuZGV2aWNlX21vZGVsfQogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBzZWxmLmF1dGggPSBIVFRQQmFzaWNBdXRoKHNlbGYudXNlcm5hbWUsIHNlbGYucGFzc3dvcmQpCiAgICAgICAgc2VsZi5oZWFkZXJzID0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04J30KICAgICAgICBzZWxmLmh0dHBfYW5zd2VyOiBPcHRpb25hbFtIc1NlcnZpY2UuSHR0cEFuc3dlcl0gPSBOb25lCgogICAgZGVmIGdldF90ZW1wbGF0ZXMoc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX2hzID0gJ2xhYmVsX3RlbXBsYXRlcycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CgogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgICNyZXR1cm4ganNvbl9kYXRhCiAgICAgICAgZWxpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICBwcmludChhbnN3ZXIpCiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyWydyZWFzb24nXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyLmdldCgndGV4dCcpCgogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2RhdGEoc2VsZiwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgc2VsZi5faHMgPSAnZGF0YScKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlclsndGV4dCddKQogICAgICAgICAgICBmb3JtYXRfZGF0YSA9IGpzb25fZGF0YS5nZXQoJ2Zvcm1hdCcpCgogICAgICAgICAgICBpZiBmb3JtYXRfZGF0YToKICAgICAgICAgICAgICAgIGFuc3dlclsnZm9ybWF0J10gPSBmb3JtYXRfZGF0YQogICAgICAgICAgICAgICAgaWYgJ2lzX29rJyA9PSBmb3JtYXRfZGF0YSBhbmQganNvbl9kYXRhLmdldCgnYmF0Y2gnKToKICAgICAgICAgICAgICAgICAgICAjINCd0LDRiCDQt9Cw0L/RgNC+0YEg0L/RgNC40L3Rj9GCLCDQvdC+INCy0LXRgNC90YPRgtGMINC/0L7QutCwINC90LXRh9C10LPQvi4g0JTQsNC90L3Ri9C1INC40LvQuCDQs9C+0YLQvtCy0Y/RgtGB0Y8g0LjQu9C4INC40YUg0L3QtdGCCiAgICAgICAgICAgICAgICAgICAgYW5zd2VyWydiYXRjaCddID0ganNvbl9kYXRhLmdldCgnYmF0Y2gnKQoKICAgICAgICAgICAgICAgIGVsaWYgZm9ybWF0X2RhdGEgPT0gJ2lzX2RhdGEnOgogICAgICAgICAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhWydkYXRhJ10KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGFuc3dlclsnZm9ybWF0J10gPSBOb25lCiAgICAgICAgZWxpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICBwcmludChhbnN3ZXIpCiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyWydyZWFzb24nXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID0gYW5zd2VyLmdldCgndGV4dCcpCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYzogc3RyLCAqKmt3YXJncykgLT4gJ0h0dHBBbnN3ZXInOgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBzZW5kX2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYywgZGF0YSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKICAgICAgICBzZWxmLnBhcmFtc1snaWRfZG9jJ10gPSBpZF9kb2MKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCgogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfYWxsX2RvY3VtZW50X2xpbmVzKHNlbGYsIGlkX2RvYywgZGF0YSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCgogICAgICAgIHNlbGYuX2hzID0gJ2RvY3VtZW50X2xpbmVzX3Jld3JpdGUnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgcmVzZXRfZXhjaGFuZ2Uoc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX2hzID0gJ3Jlc2V0X2V4Y2hhbmdlJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgY3JlYXRlX21lc3NhZ2VzKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgY29tbXVuaWNhdGlvbl90ZXN0KHNlbGYsICoqa3dhcmdzKSAtPiBkaWN0OgogICAgICAgIHNlbGYuX2hzID0gJ2NvbW11bmljYXRpb25fdGVzdCcKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5nZXQKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgZ2V0X2JhbGFuY2VzX2dvb2RzKHNlbGYsIGlkX3dhcmVob3VzZT1GYWxzZSwgaWRfY2VsbD1GYWxzZSwgaWRfZ29vZD1GYWxzZSwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHBhcmFtcyA9IHt9CiAgICAgICAgaWYgaWRfZ29vZDoKICAgICAgICAgICAgcGFyYW1zWydpZF9nb29kJ10gPSBpZF9nb29kCiAgICAgICAgaWYgaWRfY2VsbDoKICAgICAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9iYWxhbmNlcy9jZWxscycKICAgICAgICAgICAgcGFyYW1zWydpZF9jZWxsJ10gPSBpZF9jZWxsCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9iYWxhbmNlcy93YXJlaG91c2VzJwogICAgICAgICAgICBpZiBpZF93YXJlaG91c2U6CiAgICAgICAgICAgICAgICBwYXJhbXNbJ2lkX3dhcmVob3VzZSddID0gaWRfd2FyZWhvdXNlCiAgICAgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgZ2V0X3ByaWNlc19nb29kcyhzZWxmLCBpZF9nb29kLCBpZF9wcm9wZXJ0eT1GYWxzZSwgaWRfdW5pdD1GYWxzZSwgaWRfcHJpY2VfdHlwZT1GYWxzZSwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIHNlbGYuX2hzID0gJ2dvb2RfcHJpY2VzJwogICAgICAgIHBhcmFtcyA9IHsnaWRfZ29vZCc6IGlkX2dvb2R9CiAgICAgICAgaWYgaWRfcHJvcGVydHk6CiAgICAgICAgICAgIHBhcmFtc1snaWRfcHJvcGVydHknXSA9IGlkX3Byb3BlcnR5CiAgICAgICAgaWYgaWRfdW5pdDoKICAgICAgICAgICAgcGFyYW1zWydpZF91bml0J10gPSBpZF91bml0CiAgICAgICAgaWYgaWRfcHJpY2VfdHlwZToKICAgICAgICAgICAgcGFyYW1zWydpZF9wcmljZV90eXBlJ10gPSBpZF9wcmljZV90eXBlCgogICAgICAgIHNlbGYucGFyYW1zID0gcGFyYW1zCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfZG9jdW1lbnRzKHNlbGYsIGRhdGEsICoqa3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4geydlbXB0eSc6IFRydWV9CgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gYW5zd2VyCgogICAgZGVmIHNlbmRfZGF0YShzZWxmLCBkYXRhLCAqKmt3YXJncykgLT4gJ0h0dHBBbnN3ZXInOgogICAgICAgIGt3YXJnc1snZGF0YSddID0gZGF0YSBpZiBpc2luc3RhbmNlKGRhdGEsIHN0cikgZWxzZSBqc29uLmR1bXBzKGRhdGEpCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBzZW5kX2JhcmNvZGVzKHNlbGYsIGRhdGE6IGxpc3QsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAgIiIiCiAgICAgICAgOnBhcmFtIGRhdGE6IGRpY3QgKCdiYXJjb2RlJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydHknLCAnaWRfdW5pdCcpCiAgICAgICAgOnBhcmFtIGt3YXJnczogcmVxdWVzdHMgcG9zdCBwYXJhbXMKICAgICAgICA6cmV0dXJuOiBIdHRwQW5zd2VyCiAgICAgICAgIiIiCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdiYXJjb2RlcycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgX3NlbmRfcmVxdWVzdChzZWxmLCBrd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWV9CiAgICAgICAgdHJ5OgogICAgICAgICAgICByID0gc2VsZi5fbWV0aG9kKGYne3NlbGYudXJsfS9zaW1wbGVfYWNjb3VudGluZy97c2VsZi5faHN9P2FuZHJvaWRfaWQ9e3NlbGYuYW5kcm9pZF9pZH0nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGg9c2VsZi5hdXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9c2VsZi5oZWFkZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz1zZWxmLnBhcmFtcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJncykKCiAgICAgICAgICAgIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9IHIuc3RhdHVzX2NvZGUKICAgICAgICAgICAgYW5zd2VyWyd1cmwnXSA9IHIudXJsCiAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFuc3dlclsnanNvbiddID0gci5qc29uKCkKICAgICAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuSlNPTkRlY29kZUVycm9yOgogICAgICAgICAgICAgICAgYW5zd2VyWydqc29uJ10gPSB7fQoKICAgICAgICAgICAgaWYgci5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ2VtcHR5J10gPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci5yZWFzb24KICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgZQogICAgICAgICAgICAjIGFuc3dlclsnRXJyb3InXSA9IGUuYXJnc1swXQoKICAgICAgICByZXR1cm4gYW5zd2VyCgogICAgZGVmIF9jcmVhdGVfaHR0cF9hbnN3ZXIoc2VsZiwgYW5zd2VyOiBkaWN0KToKICAgICAgICBhbnN3ZXJfZGF0YSA9IHsKICAgICAgICAgICAgJ3N0YXR1c19jb2RlJzogYW5zd2VyLmdldCgnc3RhdHVzX2NvZGUnKSwKICAgICAgICAgICAgJ3VybCc6IGFuc3dlci5nZXQoJ3VybCcpLAogICAgICAgICAgICAnanNvbic6IGFuc3dlci5nZXQoJ2pzb24nKQogICAgICAgIH0KCiAgICAgICAgaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBhbnN3ZXJfZGF0YVsnZGF0YSddID0gYW5zd2VyLmdldCgnZGF0YScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yJ10gPSBUcnVlCiAgICAgICAgICAgIGFuc3dlcl9kYXRhWydlcnJvcl90ZXh0J10gPSBhbnN3ZXIuZ2V0KCdFcnJvcicpIG9yIGFuc3dlci5nZXQoJ2Vycm9yJykKICAgICAgICAgICAgaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gNDAxOgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ3VuYXV0aG9yaXplZCddID0gVHJ1ZQogICAgICAgICAgICBlbGlmIGFuc3dlcl9kYXRhWydzdGF0dXNfY29kZSddID09IDQwMzoKICAgICAgICAgICAgICAgIGFuc3dlcl9kYXRhWydmb3JiaWRkZW4nXSA9IFRydWUKCiAgICAgICAgICAgIGlmIGFuc3dlci5nZXQoJ3RleHQnKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBqc29uX3Jlc3VsdCA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dCA9IGpzb25fcmVzdWx0LmdldCgnZXJyb3InKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGVycm9yX3RleHQgPSBhbnN3ZXJbJ3RleHQnXS5kZWNvZGUoKQoKICAgICAgICAgICAgICAgIGFuc3dlcl9kYXRhWydlcnJvcl90ZXh0J10gPSBlcnJvcl90ZXh0CgogICAgICAgIHJldHVybiBzZWxmLkh0dHBBbnN3ZXIoKiphbnN3ZXJfZGF0YSkKCiAgICBkZWYgZ2V0X21ldGhvZF9ieV9wYXRoKHNlbGYsIHBhdGgpIC0+IFVuaW9uW0NhbGxhYmxlLCBOb25lXToKICAgICAgICBtZXRob2RzID0gewogICAgICAgICAgICAnYmFyY29kZXMnOiBzZWxmLnNlbmRfYmFyY29kZXMsCiAgICAgICAgICAgICdkb2N1bWVudHMnOiBzZWxmLnNlbmRfZG9jdW1lbnRzCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWV0aG9kcy5nZXQocGF0aCkKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBIdHRwQW5zd2VyOgogICAgICAgIHVybDogc3RyCiAgICAgICAgc3RhdHVzX2NvZGU6IGludAogICAgICAgIGpzb246IE9wdGlvbmFsID0gTm9uZQogICAgICAgIGVycm9yX3RleHQ6IE9wdGlvbmFsW3N0cl0gPSAnJwogICAgICAgIGRhdGE6IE9wdGlvbmFsID0gTm9uZQogICAgICAgIHVuYXV0aG9yaXplZDogYm9vbCA9IEZhbHNlCiAgICAgICAgZm9yYmlkZGVuOiBib29sID0gRmFsc2UKICAgICAgICBlcnJvcjogYm9vbCA9IEZhbHNlCgoKY2xhc3MgRGVidWdTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlwX2hvc3QsIHBvcnQ9MjQ0NCk6CiAgICAgICAgc2VsZi5pcF9ob3N0ID0gaXBfaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAgICBzZWxmLnVybCA9IGYnaHR0cDovL3tzZWxmLmlwX2hvc3R9OntzZWxmLnBvcnR9JwogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgZGVmIGV4cG9ydF9kYXRhYmFzZShzZWxmLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHsnU2ltcGxlS2VlcC5kYic6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2ZpbGUoc2VsZiwgZmlsZV9uYW1lLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHtmaWxlX25hbWU6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2xvZyhzZWxmLCBkYXRhKToKICAgICAgICBzZWxmLl9ocyA9ICd1bmxvYWRfbG9nJwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3Qoeydqc29uJzoganNvbi5kdW1wcyhkYXRhKX0pCgogICAgZGVmIF9zZW5kX3JlcXVlc3Qoc2VsZiwga3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGFuc3dlciA9IHsnZW1wdHknOiBUcnVlfQogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHNlbGYuX21ldGhvZChmJ3tzZWxmLnVybH0ve3NlbGYuX2hzfScsICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci50ZXh0CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCgogICAgICAgIHJldHVybiBhbnN3ZXIK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\http_exchange.py",
                "PyFileKey": "http_exchange",
                "PyFileData": "aW1wb3J0IGlwYWRkcmVzcwppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKZnJvbSByZXF1ZXN0cy5hdXRoIGltcG9ydCBIVFRQQmFzaWNBdXRoCiNpbXBvcnQgdGltZQppbXBvcnQgdWlfYmFyY29kZXMKCmltcG9ydCB1aV9nbG9iYWwKZnJvbSBoc19zZXJ2aWNlcyBpbXBvcnQgSHNTZXJ2aWNlCmZyb20gZGJfc2VydmljZXMgaW1wb3J0IERvY1NlcnZpY2UKZnJvbSB1aV9nbG9iYWwgaW1wb3J0IGdldF9xdWVyeV9yZXN1bHQKCmRlZiByZXBsYXNlX2dzX2luX3JlcyhzdHJ1Y3QpOgogICAgcmV0dXJuIFt7azogdi5yZXBsYWNlKGNocigyOSksICcnKS5yZXBsYWNlKGNocigyMzIpLCAnJykucmVwbGFjZShjaHIoMzIpLCcnKSBpZiBpc2luc3RhbmNlKHYsIHN0cikgZWxzZSB2IGZvciBrLCB2IGluIGQuaXRlbXMoKX0gZm9yIGQgaW4gc3RydWN0XQogICAgIyBmb3IgZWwgaW4gc3RydWN0OgogICAgIyAgICAgaWYgZWwuZ2V0KCdiYXJjb2RlX2Zyb21fc2Nhbm5lcicpOgogICAgIyAgICAgICAgIGVsWydiYXJjb2RlX2Zyb21fc2Nhbm5lciddID0gZWxbJ2JhcmNvZGVfZnJvbV9zY2FubmVyJ10ucmVwbGFjZShjaHIoMjkpLCcnKQogICAgIyAgICAgICAgIGVsWydiYXJjb2RlX2Zyb21fc2Nhbm5lciddID0gZWxbJ2JhcmNvZGVfZnJvbV9zY2FubmVyJ10ucmVwbGFjZShjaHIoMjMyKSwgJycpCgoKZGVmIHBhcnNlX2JhcmNvZGUodmFsKToKICAgIGlmIGxlbih2YWwpIDwgMjE6CiAgICAgICAgcmV0dXJuIHsnR1RJTic6ICcnLCAnU2VyaWVzJzogJyd9CgogICAgdmFsLnJlcGxhY2UoJygwMSknLCcwMScpCiAgICB2YWwucmVwbGFjZSgnKDIxKScsICcyMScpCiAgICBpZiB2YWxbOjJdPT0nMDEnOgogICAgICAgIEdUSU4gPSB2YWxbMjoxNl0KICAgICAgICBTZXJpZXMgPSB2YWxbMTg6XQoKICAgIGVsc2U6CiAgICAgICAgR1RJTiA9IHZhbFs6MTRdCiAgICAgICAgU2VyaWVzID0gdmFsWzE0Ol0KCiAgICByZXR1cm4geydHVElOJzpHVElOLCAnU2VyaWVzJzpTZXJpZXN9CgoKZGVmIHNlcnZlcl9sb2FkX2RhdGEoaHR0cCk6CiAgICB1c2VybmFtZSA9IGh0dHBbJ3VzZXInXQogICAgcGFzc3dvcmQgPWh0dHBbJ3Bhc3MnXQogICAgdXJsID0gaHR0cFsndXJsJ10KICAgIGFuZHJvaWRfaWQgPSBodHRwWydhbmRyb2lkX2lkJ10KCgogICAgI2FuZHJvaWRfaWQgPSc3YjFiYzkxMzM1OGI3MDQ5JwogICAgIyByID0gcmVxdWVzdHMuZ2V0KHVybCArICcvZ2V0X2RhdGE/YW5kcm9pZF9pZD0nICsgYW5kcm9pZF9pZCwgYXV0aD1IVFRQQmFzaWNBdXRoKHVzZXJuYW1lLCBwYXNzd29yZCwgKSwKICAgICMgICAgICAgICAgICAgICAgICBoZWFkZXJzPXsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9LAogICAgIyAgICAgICAgICAgICAgICAgIHBhcmFtcz17J2NvZGUnOiBhbmRyb2lkX2lkLCAnZnVsbF9sb2FkJzogZnVsbF9sb2FkfSkKICAgIHIgPSByZXF1ZXN0cy5nZXQodXJsICsgJy9zaW1wbGVfYWNjb3VudGluZy9kYXRhP2FuZHJvaWRfaWQ9JyArIGFuZHJvaWRfaWQsIGF1dGg9SFRUUEJhc2ljQXV0aCh1c2VybmFtZSwgcGFzc3dvcmQsICksCiAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9eydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PXV0Zi04J30sCiAgICAgICAgICAgICAgICAgICAgIHBhcmFtcz17J3VzZXJfbmFtZSc6IGh0dHBbJ3VzZXJfbmFtZSddLCAnZGV2aWNlX21vZGVsJzogaHR0cFsnZGV2aWNlX21vZGVsJ119KQogICAgIyBwcmludChyLnN0YXR1c19jb2RlKQogICAgIyBwcmludChyLnRleHQpCiAgICBhbnN3ZXIgPSB7J3N0YXR1c19jb2RlJzogci5zdGF0dXNfY29kZX0KICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgIHIuZW5jb2RpbmcgPSAndXRmLTgnCiAgICAgICAgamRhdGEgPSBqc29uLmxvYWRzKHIudGV4dC5lbmNvZGUoInV0Zi04IikpCgogICAgICAgIGlmICdmb3JtYXQnIGluIGpkYXRhLmtleXMoKToKICAgICAgICAgICAgYW5zd2VyWydmb3JtYXQnXSA9IGpkYXRhWydmb3JtYXQnXQogICAgICAgICAgICBpZiBqZGF0YVsnZm9ybWF0J10gPT0gJ2lzX2RhdGEnOgogICAgICAgICAgICAgICAgI9Cf0LDRgNGB0LjQvCwg0L/QsNGA0LDQvNC10YLRgCBkYXRhINGB0L7QtNC10YDQttC40YIg0YHQv9C40YHQvtC6INGB0LvQvtCy0LDRgNC10Lkg0YEg0LTQsNC90L3Ri9C80Lgg0LfQsNC/0YDQvtGB0LAKICAgICAgICAgICAgICAgIHJlc19mb3Jfc3FsID0ganNvbl90b19zcWxpdGVfcXVlcnkoamRhdGFbJ2RhdGEnXSkKICAgICAgICAgICAgICAgIGlmIHJlc19mb3Jfc3FsOgogICAgICAgICAgICAgICAgICAgIGFuc3dlclsncmVzX2Zvcl9zcWwnXSA9IHJlc19mb3Jfc3FsCgogICAgICAgICAgICBlbGlmIGpkYXRhWydmb3JtYXQnXSA9PSAnaXNfb2snOiAj0J3QsNGIINC30LDQv9GA0L7RgSDQv9GA0LjQvdGP0YIsINC90L4g0LLQtdGA0L3Rg9GC0Ywg0L/QvtC60LAg0L3QtdGH0LXQs9C+LiDQlNCw0L3QvdGL0LUg0LjQu9C4INCz0L7RgtC+0LLRj9GC0YHRjyDQuNC70Lgg0LjRhSDQvdC10YIKICAgICAgICAgICAgICAgIGlmIGpkYXRhLmdldCgnYmF0Y2gnKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBhbnN3ZXJbJ2JhdGNoJ10gPSBqZGF0YS5nZXQoJ2JhdGNoJykKCiAgICAgICAgICAgIGVsaWYgamRhdGFbJ2Zvcm1hdCddID09ICdmaWxlX2xpc3QnOgogICAgICAgICAgICAgICAgY29sdW1uX25hbWVzID0gW10KICAgICAgICAgICAgICAgIGZvciBmaWxlcyBpbiBqZGF0YVsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgIGNvbHVtbl9uYW1lcy5hcHBlbmQoZmlsZXMpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFuc3dlclsnZm9ybWF0J10gPSBOb25lCgoKICAgIGVsaWYgci5zdGF0dXNfY29kZSA9PSA0MDM6CgogICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddID1bci50ZXh0XQogICAgZWxpZiByLnN0YXR1c19jb2RlID09IDQwMToKICAgICAgICBhbnN3ZXJbJ2Vycm9yX3Bvb2wnXT1bci5yZWFzb25dCiAgICBlbHNlOgogICAgICAgIGFuc3dlclsnZXJyb3JfcG9vbCddPVtyLnRleHRdCgogICAgcmV0dXJuIGFuc3dlcgoKCgogICAgIyDQv9C+0LTRgtCy0LXRgNC20LTQsNC10Lwg0L/RgNC40L3Rj9GC0LjQtSDQv9Cw0LrQtdGC0LAg0LTQsNC90L3Ri9GFINCyIDHQoQogICAgIyByID0gcmVxdWVzdHMuZ2V0KHVybCArICcvZ2V0X2V4Y2hhbmdlX2NvbmZpcm1hdGlvbj9hbmRyb2lkX2lkPScgKyBhbmRyb2lkX2lkLAogICAgIyAgICAgICAgICAgICAgICAgIGF1dGg9SFRUUEJhc2ljQXV0aCh1c2VybmFtZSwgcGFzc3dvcmQsICksCiAgICAjICAgICAgICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICMgICAgICAgICAgICAgICAgICBwYXJhbXM9eydjb2RlJzogYW5kcm9pZF9pZCwgJ05ObWVzc2FnZSc6IE5ObWVzc2FnZX0pCgoKCmRlZiBqc29uX3RvX3NxbGl0ZV9xdWVyeShkYXRhKToKCiAgICBxbGlzdCA9IFtdCiAgICAj0KbQuNC60Lsg0L/QviDQuNC80LXQvdCw0Lwg0YLQsNCx0LvQuNGGCiAgICB0YWJsZV9saXN0ID0gKAogICAgJ1JTX2RvY190eXBlcycsICdSU19nb29kcycsICdSU19wcm9wZXJ0aWVzJywgJ1JTX3VuaXRzJywgJ1JTX3R5cGVzX2dvb2RzJywgJ1JTX3NlcmllcycsICdSU19jb3VudHJhZ2VudHMnLAogICAgJ1JTX3dhcmVob3VzZXMnLCAnUlNfcHJpY2VfdHlwZXMnLCAnUlNfY2VsbHMnLCAnUlNfYmFyY29kZXMnLCAnUlNfcHJpY2VzJywgJ1JTX2RvY190eXBlcycsICdSU19kb2NzJywKICAgICdSU19kb2NzX3RhYmxlJywgJ1JTX2RvY3NfYmFyY29kZXMnLCAnUlNfYWRyX2RvY3MnLCAnUlNfYWRyX2RvY3NfdGFibGUnKSAjLCwgJ1JTX2JhcmNfZmxvdycKICAgIHRhYmxlX2Zvcl9kZWxldGUgPSAoJ1JTX2RvY3NfdGFibGUnLCAnUlNfZG9jc19iYXJjb2RlcywgUlNfYWRyX2RvY3NfdGFibGUnKSAgIywgJ1JTX2JhcmNfZmxvdycKICAgIGRvY19pZF9saXN0ID0gW10KICAgIGZvciB0YWJsZV9uYW1lIGluIHRhYmxlX2xpc3Q6CiAgICAgICAgaWYgZGF0YS5nZXQodGFibGVfbmFtZSkgaXMgTm9uZToKICAgICAgICAgICAgY29udGludWUKCiAgICAjZm9yIHRhYmxlX25hbWUgaW4gZGF0YVsnZGF0YSddOgogICAgICAgIGlmIGRhdGFbdGFibGVfbmFtZV0gPT0gW106CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgI9CU0L7QsdCw0LLQuNC8INCyINC30LDQv9GA0L7RgdGLINGD0LTQsNC70LXQvdC40LUg0LjQtyDQsdCw0LfRiyDRgdGC0YDQvtC6INGC0LXRhSDQtNC+0LrRg9C80LXQvdGC0L7Qsiwg0YfRgtC+INC80Ysg0LfQsNCz0YDRg9C20LDQtdC8CiAgICAgICAgaWYgdGFibGVfbmFtZSBpbiB0YWJsZV9mb3JfZGVsZXRlOgogICAgICAgICAgICBxdWVyeSA9IGYiREVMRVRFIEZST00ge3RhYmxlX25hbWV9IFdIRVJFIGlkX2RvYyBpbiAoeycsICcuam9pbihkb2NfaWRfbGlzdCl9KSAiCiAgICAgICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCiAgICAgICAgY29sdW1uX25hbWVzID0gZGF0YVt0YWJsZV9uYW1lXVswXS5rZXlzKCkKICAgICAgICBpZiAnbWFya19jb2RlJyBpbiBjb2x1bW5fbmFtZXM6CiAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcyA9IGxpc3QoY29sdW1uX25hbWVzKQogICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMuYXBwZW5kKCdHVElOJykKICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLmFwcGVuZCgnU2VyaWVzJykKICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLnJlbW92ZSgnbWFya19jb2RlJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMgPSBjb2x1bW5fbmFtZXMKCiAgICAgICAgcXVlcnkgPSBmIlJFUExBQ0UgSU5UTyB7dGFibGVfbmFtZX0gKHsnLCAnLmpvaW4ocXVlcnlfY29sX25hbWVzKX0pIFZBTFVFUyAiCiAgICAgICAgdmFsdWVzID0gW10KCiAgICAgICAgZm9yIHJvdyBpbiBkYXRhW3RhYmxlX25hbWVdOgoKICAgICAgICAgICAgcm93X3ZhbHVlcyA9IFtdCiAgICAgICAgICAgIGxpc3RfcXVvdGVkX2ZpZWxkcyA9ICgnbmFtZScsICdmdWxsX25hbWUnLCAibWFya19jb2RlIiwgImFydCIpCiAgICAgICAgICAgIGZvciBjb2wgaW4gY29sdW1uX25hbWVzOgogICAgICAgICAgICAgICAgaWYgY29sIGluIGxpc3RfcXVvdGVkX2ZpZWxkcyBhbmQgICJcIiIgaW4gcm93W2NvbF06CiAgICAgICAgICAgICAgICAgICAgcm93W2NvbF0gPSByb3dbY29sXS5yZXBsYWNlKCJcIiIsICJcIlwiIikKICAgICAgICAgICAgICAgIGlmIHJvd1tjb2xdIGlzIE5vbmU6CiAgICAgICAgICAgICAgICAgICAgcm93W2NvbF0gPSAnJwogICAgICAgICAgICAgICAgaWYgY29sID09ICdtYXJrX2NvZGUnOiAgICPQl9Cw0LzQtdC90Y/QtdC8INGN0YLQviDQv9C+0LvQtSDQvdCwINC/0L7Qu9GPIEdUSU4g0LggU2VyaWVzCiAgICAgICAgICAgICAgICAgICAgYmFyY19zdHJ1Y3QgPSBwYXJzZV9iYXJjb2RlKHJvd1tjb2xdKQogICAgICAgICAgICAgICAgICAgIHJvd192YWx1ZXMuYXBwZW5kKGJhcmNfc3RydWN0WydHVElOJ10pCiAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQoYmFyY19zdHJ1Y3RbJ1NlcmllcyddKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByb3dfdmFsdWVzLmFwcGVuZChyb3dbY29sXSkgICMoZicie3Jvd1tjb2xdfSInKQogICAgICAgICAgICAgICAgaWYgY29sID09ICdpZF9kb2MnIGFuZCB0YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgICAgICAgICBkb2NfaWRfbGlzdC5hcHBlbmQoJyInK3Jvd1tjb2xdKyciJykKICAgICAgICAgICAgZm9ybWF0dGVkX3ZhbCAgPSBbZicie3h9IicgaWYgaXNpbnN0YW5jZSh4LCBzdHIpIGVsc2Ugc3RyKHgpIGZvciB4IGluIHJvd192YWx1ZXNdCiAgICAgICAgICAgIHZhbHVlcy5hcHBlbmQoZiIoeycsICcuam9pbihmb3JtYXR0ZWRfdmFsKX0pIikKICAgICAgICBxdWVyeSArPSAiLCAiLmpvaW4odmFsdWVzKQogICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCgogICAgcmV0dXJuIHFsaXN0CgoKZGVmIGdldF9hbGxfY2hhbmdlc19mcm9tX2RhdGFiYXNlKGRvY19saXN0OiBzdHIgPSAnJyk6CiAgICB0cnk6CiAgICAgICAgcXRleHQgPSBmJycnCiAgICAgICAgU0VMRUNUICogRlJPTSBSU19kb2NzIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19saXN0fSknJycKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCxOb25lLFRydWUpCiAgICAgICAgcXRleHQgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCAqIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfbGlzdH0pJycnIyBpbiAoCiAgICAgICAgICAgICNTRUxFQ1QgaWRfZG9jIEZST00gUlNfZG9jcyBXSEVSRSB2ZXJpZmllZCBpcyBOdWxsKScnJwogICAgICAgIHJlc19kb2NzX3RhYmxlID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsTm9uZSxUcnVlKQogICAgICAgIHF0ZXh0ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3NfYmFyY29kZXMgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2xpc3R9KSBhbmQgYmFyY29kZV9mcm9tX3NjYW5uZXIgaXMgbm90IE51bGwnJycjIGluICgKICAgICAgICAgICAgI1NFTEVDVCBpZF9kb2MgRlJPTSBSU19kb2NzIFdIRVJFIHZlcmlmaWVkIGlzIE51bGwpJycnCiAgICAgICAgcmVzX2RvY3NfYmFyY29kZSA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LE5vbmUsVHJ1ZSkKICAgICAgICByZXNfZG9jc19iYXJjb2RlID0gcmVwbGFzZV9nc19pbl9yZXMocmVzX2RvY3NfYmFyY29kZSkKICAgICAgICBxdGV4dCA9IGYnJycKICAgICAgICAgICAgU0VMRUNUICogRlJPTSBSU19iYXJjX2Zsb3cgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2xpc3R9KScnJyMgaW4gKAogICAgICAgICAgICAjU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MgV0hFUkUgdmVyaWZpZWQgaXMgTnVsbCknJycKICAgICAgICByZXNfZmxvdyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LE5vbmUsVHJ1ZSkKICAgICAgICByZXNfZmxvdyA9IHJlcGxhc2VfZ3NfaW5fcmVzKHJlc19mbG93KQoKICAgICAgICBxdGV4dCA9IGYnJycKICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3Nfc2VyaWVzIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19saXN0fSknJycgICMgaW4gKAogICAgICAgICMgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MgV0hFUkUgdmVyaWZpZWQgaXMgTnVsbCknJycKICAgICAgICByZXNfc2VyaWVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIE5vbmUsIFRydWUpCiAgICAgICAgcmVzX3NlcmllcyA9IHJlcGxhc2VfZ3NfaW5fcmVzKHJlc19mbG93KQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzcWxfZXJyb3IgPSBUcnVlCiAgICAgICAgICAgICNlcnJvcl9wb29sLmFwcGVuZChlLmFyZ3NbMF0pCiAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzplLmFyZ3NbMF19CiAgICAjIGlmIGxlbihyZXMpID09IDA6CiAgICAjICAgICByZXR1cm4gTm9uZQoKICAgIGZvciBpdGVtIGluIHJlczoKICAgICAgICBmaWx0ZXJlZF9saXN0ID0gW2QgZm9yIGQgaW4gcmVzX2RvY3NfdGFibGUgaWYgZFsnaWRfZG9jJ10gPT0gaXRlbVsnaWRfZG9jJ11dCiAgICAgICAgaXRlbVsnUlNfZG9jc190YWJsZSddID0gZmlsdGVyZWRfbGlzdAoKICAgICAgICBmaWx0ZXJlZF9saXN0ID0gW2QgZm9yIGQgaW4gcmVzX2RvY3NfYmFyY29kZSBpZiBkWydpZF9kb2MnXSA9PSBpdGVtWydpZF9kb2MnXV0KICAgICAgICBpdGVtWydSU19kb2NzX2JhcmNvZGVzJ10gPSBmaWx0ZXJlZF9saXN0CgogICAgICAgIGZpbHRlcmVkX2xpc3QgPSBbZCBmb3IgZCBpbiByZXNfZmxvdyBpZiBkWydpZF9kb2MnXSA9PSBpdGVtWydpZF9kb2MnXV0KICAgICAgICBpdGVtWydSU19iYXJjX2Zsb3cnXSA9IGZpbHRlcmVkX2xpc3QKCiAgICAgICAgZmlsdGVyZWRfbGlzdCA9IFtkIGZvciBkIGluIHJlc19zZXJpZXMgaWYgZFsnaWRfZG9jJ10gPT0gaXRlbVsnaWRfZG9jJ11dCiAgICAgICAgaXRlbVsnUlNfZG9jc19zZXJpZXMnXSA9IGZpbHRlcmVkX2xpc3QKICAgICPQkNC00YDQtdGB0L3QvtC1INGF0YDQsNC90LXQvdC40LUKICAgIHRyeToKICAgICAgICBxdGV4dCA9IGYnJycKICAgICAgICBTRUxFQ1QgKiBGUk9NIFJTX2Fkcl9kb2NzIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19saXN0fSknJycKICAgICAgICByZXNfYWRyID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsTm9uZSxUcnVlKQogICAgICAgIHF0ZXh0ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgKiBGUk9NIFJTX2Fkcl9kb2NzX3RhYmxlIFdIRVJFIGlkX2RvYyBpbiAoe2RvY19saXN0fSknJycjIGluICgKICAgICAgICAgICAgI1NFTEVDVCBpZF9kb2MgRlJPTSBSU19kb2NzIFdIRVJFIHZlcmlmaWVkIGlzIE51bGwpJycnCiAgICAgICAgcmVzX2Fkcl9kb2NzX3RhYmxlID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsTm9uZSxUcnVlKQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc3FsX2Vycm9yID0gVHJ1ZQogICAgICAgICAgICAjZXJyb3JfcG9vbC5hcHBlbmQoZS5hcmdzWzBdKQogICAgICAgICAgICByZXR1cm4geydFcnJvcic6ZS5hcmdzWzBdfQogICAgIyBpZiBsZW4ocmVzKSA9PSAwOgogICAgIyAgICAgcmV0dXJuIE5vbmUKCiAgICBmb3IgaXRlbSBpbiByZXNfYWRyOgogICAgICAgIGZpbHRlcmVkX2xpc3QgPSBbZCBmb3IgZCBpbiByZXNfYWRyX2RvY3NfdGFibGUgaWYgZFsnaWRfZG9jJ10gPT0gaXRlbVsnaWRfZG9jJ11dCiAgICAgICAgaXRlbVsnUlNfYWRyX2RvY3NfdGFibGUnXSA9IGZpbHRlcmVkX2xpc3QKCgoKICAgIGlmIGxlbihyZXMpICsgbGVuKHJlc19hZHIpID09IDA6CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICByZXR1cm4ganNvbi5kdW1wcyhyZXMgKyByZXNfYWRyKQoKCmRlZiBwb3N0X2NoYW5nZXNfdG9fc2VydmVyKGRvY19saXN0OiBzdHIsIGh0cHBhcmFtcyk6CiAgICB1cmwgPSBodHBwYXJhbXNbJ3VybCddCiAgICB1c2VybmFtZSA9IGh0cHBhcmFtc1sndXNlciddCiAgICBwYXNzd29yZCA9IGh0cHBhcmFtc1sncGFzcyddCiAgICBhbmRyb2lkX2lkID0gaHRwcGFyYW1zWydhbmRyb2lkX2lkJ10KICAgIHJlcyA9IGdldF9hbGxfY2hhbmdlc19mcm9tX2RhdGFiYXNlKGRvY19saXN0KQogICAgaWYgdHlwZShyZXMpID09IHR5cGUoZGljdCkgYW5kIHJlcy5nZXQoJ0Vycm9yJyk6CiAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWUsICdFcnJvcic6IHJlcy5nZXQoJ0Vycm9yJyl9CiAgICAgICAgcmV0dXJuIGFuc3dlcgogICAgYW5zd2VyID0geydlbXB0eSc6IFRydWV9CiAgICBpZiByZXMgaXMgbm90IE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByID0gcmVxdWVzdHMucG9zdCh1cmwgKyAnL3NpbXBsZV9hY2NvdW50aW5nL2RvY3VtZW50cz9hbmRyb2lkX2lkPScgKyBhbmRyb2lkX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGg9SFRUUEJhc2ljQXV0aCh1c2VybmFtZSwgcGFzc3dvcmQsICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9dXRmLTgnfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM9eyd1c2VyX25hbWUnOiBodHBwYXJhbXNbJ3VzZXJfbmFtZSddLCAnZGV2aWNlX21vZGVsJzogaHRwcGFyYW1zWydkZXZpY2VfbW9kZWwnXX0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE9cmVzKQogICAgICAgICAgICBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPSByLnN0YXR1c19jb2RlCiAgICAgICAgICAgIGlmIHIuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgYW5zd2VyWydlbXB0eSddID0gRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IFRydWUKICAgICAgICAgICAgICAgIGFuc3dlclsnRXJyb3InXSA9IHIudGV4dAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYW5zd2VyWydlbXB0eSddID0gVHJ1ZQogICAgICAgICAgICBhbnN3ZXJbIkVycm9yIl0gPSBzdHIoZSkKICAgIHJldHVybiBhbnN3ZXIKCgpkZWYgcG9zdF9nb29kc190b19zZXJ2ZXIoZG9jX2lkLCBodHRwX3BhcmFtcyk6CiAgICBoc19zZXJ2aWNlID0gSHNTZXJ2aWNlKGh0dHBfcGFyYW1zKQogICAgZG9jX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKGRvY19pZCkKCiAgICByZXMgPSBkb2Nfc2VydmljZS5nZXRfbGFzdF9lZGl0ZWRfZ29vZHModG9fanNvbj1GYWxzZSkKCiAgICBpZiBpc2luc3RhbmNlKHJlcywgZGljdCkgYW5kIHJlcy5nZXQoJ0Vycm9yJyk6CiAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWUsICdFcnJvcic6IHJlcy5nZXQoJ0Vycm9yJyl9CiAgICAgICAgcmV0dXJuIGFuc3dlcgogICAgZWxpZiByZXM6CiAgICAgICAgaHNfc2VydmljZS5zZW5kX2RvY3VtZW50cyhyZXMpCgogICAgICAgIGlmIG5vdCByZXMgb3IgKGlzaW5zdGFuY2UocmVzLCBkaWN0KSBhbmQgcmVzLmdldCgnRXJyb3InKSk6CiAgICAgICAgICAgIGFuc3dlciA9IHsnZW1wdHknOiBUcnVlLCAnRXJyb3InOiByZXMuZ2V0KCdFcnJvcicpfQogICAgICAgICAgICByZXR1cm4gYW5zd2VyCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZG9jX3NlcnZpY2UudXBkYXRlX3NlbnRfZGF0YShyZXMpCgogICAgdGltZXJfc2VydmVyX2xvYWRfZGF0YShodHRwX3BhcmFtcykKCgpkZWYgdGltZXJfc2VydmVyX2xvYWRfZGF0YShodHRwX3BhcmFtcyk6CiAgICBoc19zZXJ2aWNlID0gSHNTZXJ2aWNlKGh0dHBfcGFyYW1zKQogICAgZG9jX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCcnKQoKICAgIGRvY3NfZGF0YSA9IGhzX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgaWYgZG9jc19kYXRhLmdldCgnZGF0YScpOgogICAgICAgIHRyeToKICAgICAgICAgICAgZG9jX3NlcnZpY2UudXBkYXRlX2RhdGFfZnJvbV9qc29uKGRvY3NfZGF0YVsnZGF0YSddKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmFpc2UgZQo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_barcodes.py",
                "PyFileKey": "ui_barcodes",
                "PyFileData": "IyDQnNC+0LTRg9C70Ywg0L/QsNGA0YHQuNGCINGI0YLRgNC40YXQutC+0LQg0LjQu9C4INC00LDRgtCw0LzQsNGC0YDQuNC60YEg0L3QsCDRgdC+0YHRgtCw0LLQu9GP0Y7RidC40LUgMTEKCmltcG9ydCByZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKCmRlZiBwYXJzZV9iYXJjb2RlKGJhcmNvZGUpOgogICAgI9Ce0YLQu9Cw0LTQvtGH0L3QvtC1CiAgICAjIHJldHVybiB7J1NDSEVNRSc6ICdFQU4xMycsICdCQVJDT0RFJzogYmFyY29kZSwgJ0dUSU4nOiBiYXJjb2RlLCAnU0VSSUFMJzogJyd9CgogICAgaWYgYmFyY29kZToKICAgICAgICAjINCf0YDQvtGB0YLQvtC5IEVBTjEzCiAgICAgICAgaWYgbm90IHJlLmZ1bGxtYXRjaChyJ1xkezEzfScsIGJhcmNvZGUpIGlzIE5vbmUgYW5kIHJlLmZ1bGxtYXRjaChyJ1xkezEzfScsIGJhcmNvZGUpLnN0cmluZyA9PSBiYXJjb2RlOgoKICAgICAgICAgICAgcmVzID0geydTQ0hFTUUnOiAnRUFOMTMnLCAnQkFSQ09ERSc6IGJhcmNvZGUsICdHVElOJzogYmFyY29kZSwgJ1NFUklBTCc6ICcnfQoKICAgICAgICBlbGlmIGxlbihiYXJjb2RlKSA9PSAyOTogICMg0K3RgtC+INC00LDRgtCw0LzQsNGC0YDQuNC60YEg0KLQsNCx0LDQuiwg0J/QsNGH0LrQsAogICAgICAgICAgICAjIHJlcyA9IHBhcnNlX3RvYmFjY28oYmFyY29kZSkKICAgICAgICAgICAgcmVzID0geydTQ0hFTUUnOiAnR1MxJywgJ0dUSU4nOiBiYXJjb2RlWzE6MTRdLCAnU0VSSUFMJzogYmFyY29kZVsxNDoyMV0sICdNUkMnOiBiYXJjb2RlWzIxOjI1XSwKICAgICAgICAgICAgICAgICAgICdDSEVDSyc6IGJhcmNvZGVbMjU6MjldLCAnRnVsbENvZGUnOiBiYXJjb2RlfQoKICAgICAgICBlbGlmIGNocigyOSkgaW4gYmFyY29kZTogICMgRGF0YW1hdHJpeAoKICAgICAgICAgICAgcmVzID0gZGF0YW1hdHJpeChiYXJjb2RlKQogICAgICAgICAgICByZXNbJ0Z1bGxDb2RlJ10gPSBiYXJjb2RlCiAgICAgICAgZWxpZiAnPEdTPicgaW4gYmFyY29kZToKICAgICAgICAgICAgcmVzID0gZGF0YW1hdHJpeChiYXJjb2RlKQogICAgICAgICAgICByZXNbJ0Z1bGxDb2RlJ10gPSBiYXJjb2RlCiAgICAgICAgZWxzZTogICMg0J3QtdC40LfQstC10YHRgtC90YvQuSDRgtC40L8g0LrQvtC00LAKICAgICAgICAgICAgcmVzID0geydTQ0hFTUUnOiAnVU5LTk9XTicsICdCQVJDT0RFJzogYmFyY29kZSwgJ0dUSU4nOiBiYXJjb2RlLCAnU0VSSUFMJzogJyd9CgogICAgICAgIHJldHVybiByZXMKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHsnU0NIRU1FJzogJ1VOS05PV04nLCAnQkFSQ09ERSc6IGJhcmNvZGUsICdHVElOJzogJycsICdTRVJJQUwnOiAnJywgJ0VSUk9SJzogJ0VtcHR5IGJhcmNvZGUnfQoKCmRlZiBkYXRhbWF0cml4KGJhcmNvZGU6IHN0cikgLT4gZGljdDoKICAgICIiIgogICAgVGhlIGZ1bmN0aW9uIHRha2VzIGJhcmNvZGUgc3RyaW5nIGFuZCByZXR1cm4gcGFyc2VkIG9iamVjdHMgaW4gYSBgZGljdGAuCiAgICBPcHRpb25hbGx5IHVzZXIgY2FuIHBhc3MgYm9vbCB2YWx1ZSB0byB2YWxpZGF0ZSB0aGUgYmFyY29kZQogICAgUGFyYW1ldGVyczoKICAgICAgICBiYXJjb2RlOiBzdHJpbmcgdHlwZS4gVGhpcyBpcyB0aGUgYmFyY29kZSBzdHJpbmcgd2l0aCB0aGUgPEdTPiBzZXBlcmF0b3JzLgoKICAgIFJldHVybnM6CiAgICAgICAgZGljdDogUmV0dXJucyBkaWN0aW9uYXJ5IG9iamVjdCB3aXRoIFNDSEVNRSwgUFBOLCBHVElOLCBFWFBJUlksIEJBVENILCBTRVJJQUwgJiBOSFJOIGFzIGtleXMgZm9yIHZhbGlkIHJlcXVlc3RzCiAgICAgICAgb3IgcmVsZXZhbnQgZXJyb3Igc3RyaW5ncy4KICAgICIiIgoKICAgIGlmIGJhcmNvZGVbOjNdID09ICJdZDIiOiAgIyBNb3N0IGJhcmNvZGUgc2Nhbm5lcnMgcHJlcGVuZCAnXWQyJyBpZGVudGlmaWVyIGZvciB0aGUgR1MxIGRhdGFtYXRyaXguIFRoaXMgc2VjdGlvbiByZW1vdmVzIHRoZSBpZGVudGlmaWVyLgogICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzM6XQogICAgICAgIHJlc3VsdCA9IGdzMV9ndGluKGJhcmNvZGUpCgogICAgZWxpZiBiYXJjb2RlWzoyXSBpbiBbJzAxJywgJzIxJywgJzE3JywgJzEwJywgJzcxJ106CiAgICAgICAgcmVzdWx0ID0gZ3MxX2d0aW4oYmFyY29kZSkKCiAgICBlbGlmIGJhcmNvZGVbMF0gPT0gY2hyKDI5KTogICMgU2hvcnQgR1MxIGJhcmNvZGUKICAgICAgICByZXN1bHQgPSBnczFfZ3RpbihiYXJjb2RlKQoKICAgIGVsaWYgYmFyY29kZVs6Nl0gPT0gKCdbKT4nICsgY2hyKDMwKSArICcwNicpIG9yICgnWyk+JyArIGNocigzMCkgKyAnMDUnKTogICMgTUFDUk8gMDYgb3IgTUFDUk8gMDUKICAgICAgICBiYXJjb2RlID0gYmFyY29kZVs3Ol0gICMgUmVtb3ZlcyB0aGUgbGVhZGluZyBBU0NJSSBzZXBlcmF0b3IgYWZ0ZXIgdGhlIHNjaGVtZSBpZGVudGlmaWVyLgogICAgICAgIHJlc3VsdCA9IGlmYV9wcG4oYmFyY29kZSkKCiAgICBlbHNlOgogICAgICAgIHJlc3VsdCA9IHsnRVJST1InOiAnSU5WQUxJRCBGT1JNQVQnLCAnQkFSQ09ERSc6IGJhcmNvZGV9CgogICAgcmV0dXJuIHJlc3VsdAoKCmRlZiBndGluX2NoZWNrKGd0aW46IHN0cik6CiAgICByZXZlcnNlX2d0aW4gPSBndGluWy0yOjotMV0gICMgUmV2ZXJzaW5nIHRoZSBzdHJpbmcgd2l0aG91dCB0aGUgY2hlY2stZGlnaXQKICAgIGRpZ2l0X211bHRpcGxlcjMgPSBbXQogICAgZGlnaXRfbXVsdGlwbGVyMSA9IFtdCgogICAgZm9yIGksIGwgaW4gZW51bWVyYXRlKHJldmVyc2VfZ3Rpbik6CiAgICAgICAgaWYgaSAlIDIgPT0gMDoKICAgICAgICAgICAgZGlnaXRfbXVsdGlwbGVyMy5hcHBlbmQoaW50KGwpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRpZ2l0X211bHRpcGxlcjEuYXBwZW5kKGludChsKSkKCiAgICBkaWdpdF9zdW0gPSAoc3VtKGRpZ2l0X211bHRpcGxlcjMpICogMykgKyBzdW0oZGlnaXRfbXVsdGlwbGVyMSkKICAgIG5lYXJlc3RfdGVuID0gcm91bmQoZGlnaXRfc3VtIC8gMTApICogMTAKICAgIGNoZWNrX3N1bV9kaWdpdCA9IG5lYXJlc3RfdGVuIC0gZGlnaXRfc3VtCiAgICBpZiBjaGVja19zdW1fZGlnaXQgPCAwOgogICAgICAgIGNoZWNrX3N1bV9kaWdpdCA9IDEwICsgY2hlY2tfc3VtX2RpZ2l0CiAgICByZXR1cm4gY2hlY2tfc3VtX2RpZ2l0ID09IGludChndGluWy0xXSkKCgpzcmVzdWx0ID0geydTQ0hFTUUnOiAnR1MxJ30KCgpkZWYgZ3MxX2d0aW4oYmFyY29kZTogc3RyKSAtPiBkaWN0OgogICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgoKICAgICAgICB3aGlsZSBiYXJjb2RlOgogICAgICAgICAgICBpZiBiYXJjb2RlWzoyXSA9PSAnMDEnOgogICAgICAgICAgICAgICAgc3Jlc3VsdFsnR1RJTiddID0gYmFyY29kZVsyOjE2XQogICAgICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gMTY6CiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTY6XQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzozXSA9PSBjaHIoMjkpICsgJzAxJzoKICAgICAgICAgICAgICAgIHNyZXN1bHRbJ0dUSU4nXSA9IGJhcmNvZGVbMzoxN10KICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDE3OgogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzE3Ol0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMTcnOgogICAgICAgICAgICAgICAgc3Jlc3VsdFsnRVhQSVJZJ10gPSBiYXJjb2RlWzI6OF0KICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDg6CiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbODpdCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICcxMCc6CiAgICAgICAgICAgICAgICBpZiBjaHIoMjkpIGluIGJhcmNvZGU6CiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCiAgICAgICAgICAgICAgICAgICAgc3Jlc3VsdFsnQkFUQ0gnXSA9IGJhcmNvZGVbMjppbmRleF0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzcmVzdWx0WydCQVRDSCddID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMjEnOgogICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQogICAgICAgICAgICAgICAgICAgIHNyZXN1bHRbJ1NFUklBTCddID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlW2luZGV4ICsgMTpdCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNyZXN1bHRbJ1NFUklBTCddID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTEnOgogICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQogICAgICAgICAgICAgICAgICAgIHNyZXN1bHRbJ05IUk4nXSA9IGJhcmNvZGVbMjppbmRleF0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzcmVzdWx0WydOSFJOJ10gPSBiYXJjb2RlWzI6Nl0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTMnOiAgIyDQnNC+0LvQvtGH0LrQsCwg0LLQvtC00LAKICAgICAgICAgICAgICAgIHNyZXN1bHRbJ0NIRUNLJ10gPSBiYXJjb2RlWzI6Nl0KICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzc6XQoKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTInOiAgIyDQlNCw0LvQtdC1INGB0LvQtdC00YPQtdGCINC60L7QtCDQv9GA0L7QstC10YDQutC4LCA0NCDRgdC40LzQstC+0LvQsAogICAgICAgICAgICAgICAgIyBpZiBsZW4oYmFyY29kZVsyOl0pPT00NDoKICAgICAgICAgICAgICAgIHNyZXN1bHRbJ0NIRUNLJ10gPSBiYXJjb2RlWzI6XQogICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzo0XSA9PSAnODAwNSc6ICAjINCi0LDQsdCw0LosINCR0LvQvtC6CiAgICAgICAgICAgICAgICBzcmVzdWx0WydOSFJOJ10gPSBiYXJjb2RlWzU6MTFdCiAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxMTpdCiAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6NF0gPT0gJzMxMDMnOiAgIyDQnNC+0LvQvtGH0LrQsCDRgSDQktC10YHQvtC8CgogICAgICAgICAgICAgICAgc3Jlc3VsdFsnV0VJR0hUJ10gPSBiYXJjb2RlWzQ6XQogICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIEJBUkNPREUnLCAnQkFSQ09ERSc6IHNyZXN1bHR9CiAgICBlbHNlOgogICAgICAgIHNyZXN1bHRbJ0VSUk9SJ10gPSAnTm8gR1MgU2VwYXJhdG9yJwogICAgICAgIHJldHVybiBzcmVzdWx0CgogICAgIyBpZiAoJ0dUSU4nICwgJ0JBVENIJyAsICdFWFBJUlknICwgJ1NFUklBTCcpIGluIHJlc3VsdC5rZXlzKCk6CiAgICAjICAgICBpZiBndGluX2NoZWNrKHJlc3VsdFsnR1RJTiddKSA9PSBGYWxzZSBhbmQgZXhwaXJ5X2RhdGVfY2hlY2socmVzdWx0WydFWFBJUlknXSkgPT0gRmFsc2U6CiAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBHVElOICYgRVhQSVJZIERBVEUnLCAnQkFSQ09ERSc6IHJlc3VsdH0KICAgICMgICAgIGVsaWYgZXhwaXJ5X2RhdGVfY2hlY2socmVzdWx0WydFWFBJUlknXSkgPT0gRmFsc2U6CiAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBFWFBJUlkgREFURScsICdCQVJDT0RFJzogcmVzdWx0fQogICAgIyAgICAgZWxpZiBndGluX2NoZWNrKHJlc3VsdFsnR1RJTiddKSA9PSBGYWxzZToKICAgICMgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIEdUSU4nLCAnQkFSQ09ERSc6IHJlc3VsdH0KICAgICMgICAgIGVsc2U6CiAgICAjICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgIyBlbHNlOgogICAgIyAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5DT01QTEVURSBEQVRBJywgJ0JBUkNPREUnOiByZXN1bHR9CiAgICByZXR1cm4gc3Jlc3VsdAoKCmRlZiBleHBpcnlfZGF0ZV9jaGVjayhlOiBzdHIpOgogICAgbXlfeWVhciA9IGVbOjJdCiAgICBteV9tb250aCA9IGVbMjo0XQogICAgbXlfZGF0ZSA9IGVbNDpdCgogICAgaWYgaW50KG15X21vbnRoKSBub3QgaW4gcmFuZ2UoMSwgMTMpOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZWxpZiBpbnQobXlfZGF0ZSkgbm90IGluIHJhbmdlKDMyKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiBteV9kYXRlID09ICcwMCc6CiAgICAgICAgaWYgbXlfbW9udGggPT0gJzAyJyBhbmQgaW50KG15X3llYXIpICUgNCA9PSAwOgogICAgICAgICAgICBteV9kYXRlID0gJzI5JwogICAgICAgIGVsaWYgbXlfbW9udGggPT0gJzAyJyBhbmQgaW50KG15X3llYXIpICUgNCAhPSAwOgogICAgICAgICAgICBteV9kYXRlID0gJzI4JwogICAgICAgIGVsaWYgbXlfbW9udGggaW4gWycwMScsICcwMycsICcwNScsICcwNycsICcwOCcsICcxMCcsICcxMiddOgogICAgICAgICAgICBteV9kYXRlID0gJzMxJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG15X2RhdGUgPSAnMzAnCgogICAgaWYgbXlfbW9udGggPT0gJzAyJyBhbmQgaW50KG15X3llYXIpICUgNCA9PSAwIGFuZCBteV9kYXRlIDw9ICcyOSc6CiAgICAgICAgcGFzcwogICAgZWxpZiBteV9tb250aCA9PSAnMDInIGFuZCBpbnQobXlfeWVhcikgJSA0ICE9IDAgYW5kIG15X2RhdGUgPD0gJzI4JzoKICAgICAgICBwYXNzCiAgICBlbGlmIG15X21vbnRoIGluIFsnMDEnLCAnMDMnLCAnMDUnLCAnMDcnLCAnMDgnLCAnMTAnLCAnMTInXSBhbmQgbXlfZGF0ZSA8PSAnMzEnOgogICAgICAgIHBhc3MKICAgIGVsaWYgbXlfbW9udGggaW4gWycwNCcsICcwNicsICcwOScsICcxMSddIGFuZCBteV9kYXRlIDw9ICczMCc6CiAgICAgICAgcGFzcwogICAgZWxzZToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBhY3R1YWxfZGF0ZSA9IG15X3llYXIgKyBteV9tb250aCArIG15X2RhdGUKICAgIGlmIGFjdHVhbF9kYXRlID4gZGF0ZXRpbWUudG9kYXkoKS5zdHJmdGltZSgnJXklbSVkJyk6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKZGVmIGlmYV9wcG4oYmFyY29kZTogc3RyKSAtPiBkaWN0OgogICAgc3Jlc3VsdCA9IHsnU0NIRU1FJzogJ0lGQSd9CiAgICB3aGlsZSBiYXJjb2RlOgoKICAgICAgICBpZiBiYXJjb2RlWzoyXSA9PSAnOU4nOgogICAgICAgICAgICBzcmVzdWx0WydQUE4nXSA9IGJhcmNvZGVbMjoxNF0KICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gMTQ6CiAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxNTpdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICBlbGlmIGJhcmNvZGVbOjFdID09ICdEJzoKICAgICAgICAgICAgc3Jlc3VsdFsnRVhQSVJZJ10gPSBiYXJjb2RlWzE6N10KICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gNzoKICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzg6XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMVQnOgogICAgICAgICAgICBpZiBjaHIoMjkpIGluIGJhcmNvZGU6CiAgICAgICAgICAgICAgICBpbmRleCA9IGJhcmNvZGUuaW5kZXgoY2hyKDI5KSkKICAgICAgICAgICAgICAgIHNyZXN1bHRbJ0JBVENIJ10gPSBiYXJjb2RlWzI6aW5kZXhdCiAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigzMCkpCiAgICAgICAgICAgICAgICBzcmVzdWx0WydCQVRDSCddID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgZWxpZiBiYXJjb2RlWzoxXSA9PSAnUyc6CiAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQogICAgICAgICAgICAgICAgc3Jlc3VsdFsnU0VSSUFMJ10gPSBiYXJjb2RlWzE6aW5kZXhdCiAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigzMCkpCiAgICAgICAgICAgICAgICBzcmVzdWx0WydTRVJJQUwnXSA9IGJhcmNvZGVbMTppbmRleF0KICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzhQJzoKICAgICAgICAgICAgc3Jlc3VsdFsnR1RJTiddID0gYmFyY29kZVsyOjE2XQogICAgICAgICAgICBpZiBsZW4oYmFyY29kZSkgPiAxNjoKICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzE3Ol0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgQkFSQ09ERScsICdCQVJDT0RFJzogc3Jlc3VsdH0KCiAgICBpZiAnUFBOJyBhbmQgJ0JBVENIJyBhbmQgJ0VYUElSWScgYW5kICdTRVJJQUwnIGluIHNyZXN1bHQua2V5cygpOgogICAgICAgIGlmIHBwbl9jaGVjayhzcmVzdWx0WydQUE4nXSkgaXMgRmFsc2UgYW5kIGV4cGlyeV9kYXRlX2NoZWNrKHNyZXN1bHRbJ0VYUElSWSddKSBpcyBGYWxzZToKICAgICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBQUE4gJiBFWFBJUlkgREFURScsICdCQVJDT0RFJzogc3Jlc3VsdH0KICAgICAgICBlbGlmIGV4cGlyeV9kYXRlX2NoZWNrKHNyZXN1bHRbJ0VYUElSWSddKSBpcyBGYWxzZToKICAgICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBFWFBJUlkgREFURScsICdCQVJDT0RFJzogc3Jlc3VsdH0KICAgICAgICBlbGlmIG5vdCBwcG5fY2hlY2soc3Jlc3VsdFsnUFBOJ10pOgogICAgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIFBQTicsICdCQVJDT0RFJzogc3Jlc3VsdH0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc3Jlc3VsdAogICAgZWxzZToKICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTkNPTVBMRVRFIERBVEEnLCAnQkFSQ09ERSc6IHNyZXN1bHR9CgoKZGVmIHBwbl9jaGVjayhwcG46IHN0cikgLT4gYm9vbDoKICAgICMgaSA9IDAKICAgIHdlaWdodCA9IDIKICAgIGRpZ2l0X3N1bSA9IDAKICAgIGZvciBpIGluIHJhbmdlKDEwKToKICAgICAgICBkaWdpdF9zdW0gKz0gKG9yZChwcG5baV0pICogd2VpZ2h0KQogICAgICAgIHdlaWdodCArPSAxCiAgICBjaGVja19kaWdpdCA9IGRpZ2l0X3N1bSAlIDk3CiAgICByZXR1cm4gY2hlY2tfZGlnaXQgPT0gaW50KHBwblstMjpdKSAgIyBQUE4gbGFzdCB0d28gY2hhcnMgYXJlIGNvbnZlcnRlZCB0byBpbnQgdG8gcmVtb3ZlIGFueSBsZWFkaW5nIHplcm8uCgojIHBhcnNlX2JhcmNvZGUoJzAxMDMwNDEwOTQ3ODc0NDMyMTVRYmFnITxHUz45M1pqcXcnKQo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_csv.py",
                "PyFileKey": "ui_csv",
                "PyFileData": "aW1wb3J0IGNzdgppbXBvcnQgb3MKaW1wb3J0IHJlCgppbXBvcnQgdWlfYmFyY29kZXMKaW1wb3J0IHVpX2dsb2JhbApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKCmRlZiBnZXRfcXVlcnlfdGV4dChxX25hbWU9JycpIC0+IHN0cjoKICAgIGlmIHFfbmFtZSA9PSAnUlNfZ29vZHMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX2dvb2RzICggIGlkLCBjb2RlLCBhcnQsIG5hbWUsIHVuaXQsIHR5cGVfZ29vZCwgZGVzY3JpcHRpb24pIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyknCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfcHJvcGVydGllcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfcHJvcGVydGllcyAoICBpZCAsIGlkX293bmVyLCBuYW1lKSBWQUxVRVMgJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX3VuaXRzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU191bml0cyAoICBpZCxpZF9vd25lciwgY29kZSwgbmFtZSwgbm9taW5hdG9yLCBkZW5vbWluYXRvciwgaW50X3JlZHVjdGlvbikgVkFMVUVTICg/LD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU190eXBlc19nb29kcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfdHlwZXNfZ29vZHMgKCAgaWQsIG5hbWUpIFZBTFVFUyAoPyw/KScgICMgKD8sPykKICAgIGVsaWYgcV9uYW1lID09ICdSU19zZXJpZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX3NlcmllcyAoICBpZCwgbmFtZSwgYmVzdF9iZWZvcmUsIHR5cGVfZ29vZHMsIG51bWJlciwgcHJvZHVjdGlvbl9kYXRlKSBWQUxVRVMnCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfY291bnRyYWdlbnRzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19jb3VudHJhZ2VudHMgKCAgaWQsIG5hbWUsIGZ1bGxfbmFtZSwgaW5uLCBrcHApIFZBTFVFUyAnCiAgICBlbGlmIHFfbmFtZSA9PSAnUlNfd2FyZWhvdXNlcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfd2FyZWhvdXNlcyAoICBpZCwgbmFtZSkgVkFMVUVTICg/LD8pJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX3ByaWNlX3R5cGVzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19wcmljZV90eXBlcyAoaWQsIG5hbWUpIFZBTFVFUyAoPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19iYXJjb2Rlcyc6CiAgICAgICAgcmV0dXJuICdSRVBMQUNFIElOVE8gUlNfYmFyY29kZXMgKGlkLCBiYXJjb2RlLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfc2VyaWVzLCBpZF91bml0KSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19tYXJraW5nX2NvZGVzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19tYXJraW5nX2NvZGVzIChpZCwgbWFya19jb2RlLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfc2VyaWVzLCBpZF91bml0KSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19wcmljZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX3ByaWNlcyAoaWRfcHJpY2VfdHlwZXMsIGlkX2dvb2RzLCBpZF9wcm9wZXJ0aWVzLCBwcmljZSwgaWRfdW5pdCkgVkFMVUVTICcKICAgIGVsaWYgcV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19kb2NzIChpZF9kb2MsIGRvY190eXBlLCBkb2NfbiwgZG9jX2RhdGUsIGlkX2NvdW50cmFnZW50cywgaWRfd2FyZWhvdXNlKSBWQUxVRVMgKD8sPyw/LD8sPyw/KScKICAgIGVsaWYgcV9uYW1lID09ICdSU19kb2NzX3RhYmxlJzoKICAgICAgICByZXR1cm4gJ1JFUExBQ0UgSU5UTyBSU19kb2NzX3RhYmxlIChpZF9kb2MsIGlkX2dvb2QsIGlkX3Byb3BlcnRpZXMsIGlkX3NlcmllcywgaWRfdW5pdCwgcXR0eSwgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UpIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/LD8pJwogICAgZWxpZiBxX25hbWUgPT0gJ1JTX2RvY3NfYmFyY29kZXMnOgogICAgICAgIHJldHVybiAnUkVQTEFDRSBJTlRPIFJTX2RvY3NfYmFyY29kZXMgKGlkX2RvYywgaWRfYmFyY29kZSwgaXNfcGxhbikgVkFMVUVTICg/LD8sPyknCgoKZGVmIGdldF9xdWVyeV90ZXh0X2V4cG9ydCgpOgogICAgcmV0dXJuICcnJwogICAgICAgICBTRUxFQ1QgCiAgICAgICAgJzAnIEFTIEdUSU4sCiAgICAgICAgUlNfbWFya2luZy5pZF9nb29kLAogICAgICAgIFJTX21hcmtpbmcubmFtZSwgCiAgICAgICAgMSBhcyBEZWNsYXJlZFF1YW50aXR5LAogICAgICAgIENBU0UgYXBwcm92ZWQKICAgICAgICAgICAgV0hFTiAnMScgVEhFTiAxCiAgICAgICAgICAgIEVMU0UgMAogICAgICAgIEVORCBBUyBDdXJyZW50UXVhbnRpdHksCiAgICAgICAgYmFyY29kZV9mcm9tX3NjYW5uZXIgYXMg0JzQsNGA0LrQsCwKICAgICAgICBSU19tYXJraW5nLm1hcmtfY29kZSBBUyDQnNCw0YDQutCw0JjQodCc0J8sCiAgICAgICAgUlNfbWFya2luZy5pZF9wcm9wZXJ0eSBhcyDQmNC90LLQvtC50YEsCiAgICAgICAgJ9Cn0YPQttC+0LknIGFzINCf0YDQuNC90LDQtNC70LXQttC90L7RgdGC0YwgCgogICAgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcyAKCiAgICAgICAgTEVGVCBKT0lOIChTRUxFQ1QgCiAgICAgICAgICAgICAgICAgICAgaWQgQVMgaWRfYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICBtYXJrX2NvZGUgQVMgbWFya19jb2RlLAogICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgIGlkX3VuaXQsCiAgICAgICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSwKICAgICAgICAgICAgICAgICAgICBSU19nb29kcy5jb2RlCgogICAgICAgICAgICAgICAgICAgIEZST00gUlNfbWFya2luZ19jb2RlcwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy4gIGlkICA9IFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZAogICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX21hcmtpbmdfY29kZXMuaWQgSU4gCiAgICAgICAgICAgICAgICAgICAgICAgIChTRUxFQ1QgaWRfYmFyY29kZSBGUk9NIFJTX2RvY3NfYmFyY29kZXMgCiAgICAgICAgICAgICAgICAgICAgICAgIFdIRVJFIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gOmlkX2RvYykpIEFTIFJTX21hcmtpbmcKICAgICAgICBPTiBSU19kb2NzX2JhcmNvZGVzLmlkX2JhcmNvZGUgPSBSU19tYXJraW5nLmlkX2JhcmNvZGUgIAoKICAgICAgICBXSEVSRSBSU19kb2NzX2JhcmNvZGVzLmlkX2RvYyA9IDppZF9kb2MKJycnCgoKZGVmIG5vcm1hbGl6ZV9ndGluKGd0aW46IHN0cikgLT4gc3RyOgogICAgYSA9IGxlbihndGluKQogICAgaWYgYSA+IDE0OgogICAgICAgIHJldHVybiBndGluWzotMTRdCiAgICBlbHNlOgogICAgICAgIHJldHVybiAnMCcgKiAoMTQgLSBhKSArIGd0aW4KCgpkZWYgbG9hZF9mcm9tX2NzdihwYXRoPScnLCBmaWxlPScnKToKICAgICMgcmUuZnVsbG1hdGNoKHInXGR7MTN9JywgYmFyY29kZSkuc3RyaW5nID09IGJhcmNvZGU6CiAgICBjdXJyZW50X2RhdGUgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgiJWQtJW0tJVkiKQogICAgIyBmaWxlID0gZmlsZSArICgiICIgKiAxNSkgI9GH0YLQvtCx0Ysg0L3QtSDQvdCw0YLRi9C60LDRgtGM0YHRjyDQvdCwIG91dCBvZiByYW5nZSDQsiDRgtC10LrRgdGC0L7QstC+0Lwg0LjQvNC10L3QuCAtINC00L7QsdCw0LLQuNC8IDE1INC/0YDQvtCx0LXQu9C+0LIKICAgIGlmIGZpbGVbOjZdID09ICdkb2NfaW4nOgogICAgICAgICMg0JfQsNCz0YDRg9C20LDQtdC8INC00L7QutGD0LzQtdC90YLRiwogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicsIG5ld2xpbmU9JycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGNzdmZpbGU6CgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3YucmVhZGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKCiAgICAgICAgICAgIHJzX2RvY19kYXRhID0gW10KICAgICAgICAgICAgcnNfZG9jX3RhYmxlX2RhdGEgPSBbXQogICAgICAgICAgICByc19kb2NfYmFyY29kZSA9IFtdCiAgICAgICAgICAgIHJzX21hcmtpbmdfY29kZXMgPSBbXQogICAgICAgICAgICByc19wcm9wZXJ0aWVzID0gW10KICAgICAgICAgICAgdGVtcF9kb2NfbiA9ICcnCiAgICAgICAgICAgIHRlbXBfZ29vZCA9ICcnCiAgICAgICAgICAgIGRvY19udW0gPSB1aV9nbG9iYWwuUnNfZG9jLmdldF9uZXdfaWQoJycpCiAgICAgICAgICAgIGZvciByb3cgaW4gbXlfcmVhZGVyOgogICAgICAgICAgICAgICAgaWYgbXlfcmVhZGVyLmxpbmVfbnVtID4gNTogICMg0JfQsNCz0L7Qu9C+0LLQutC4INGC0LDQsdC70LjRhtGLCiAgICAgICAgICAgICAgICAgICAgIyBpZiB0ZW1wX2RvY19uICE9IHJvd1s4XToKICAgICAgICAgICAgICAgICAgICAjICAgICAjIFJTX2RvY3MgKGlkX2RvYywgZG9jX3R5cGUsIGRvY19uLCBkb2NfZGF0ZSwgaWRfY291bnRyYWdlbnRzLCBpZF93YXJlaG91c2UpCiAgICAgICAgICAgICAgICAgICAgIyAgICAgcnNfZG9jX2RhdGUuYXBwZW5kKChkb2NfbnVtLCAn0JjQvdCy0L7QudGBJywgZG9jX251bSwgY3VycmVudF9kYXRlLCAnMDAxJywgJzAwMScpKQogICAgICAgICAgICAgICAgICAgICMgICAgIHRlbXBfZG9jX24gPSByb3dbOF0KICAgICAgICAgICAgICAgICAgICAjIFJTX2RvY3NfdGFibGUoaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwgcHJpY2UsIGlkX3ByaWNlKQogICAgICAgICAgICAgICAgICAgIGlmIHRlbXBfZ29vZCAhPSByb3dbMF06CiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY190YWJsZV9kYXRhLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkb2NfbnVtLCByb3dbMF0sIHJvd1s4XSwgJycsIHJvd1sxXSArIHJvd1swXSwgaW50KHJvd1s3XSksIGludChyb3dbNl0pLCAnJywgJycpKQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyX2NvdW50ID0gcnNfZG9jX3RhYmxlX2RhdGEuX19sZW5fXygpIC0gMQogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2dvb2QgPSByb3dbMF0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjINC00L7QsdCw0LLQuNC8INC60L7Qu9C40YfQtdGB0YLQstC+INCyINGB0YLRgNC+0LrRgywg0LTQu9GPINGN0YLQvtCz0L4g0L/RgNC10L7QsdGA0LDQt9GD0LXQvCDQtdC1INCyINCb0LjRgdGCLCDQv9C+0LzQtdC90Y/QtdC8INC60L7Qu9C40YfQtdGB0YLQstC+INC4INC30LDRgdGD0L3QtdC8INC+0LHRgNCw0YLQvdC+INCyINC60L7RgNGC0LXQtgogICAgICAgICAgICAgICAgICAgICAgICBsc3QgPSBsaXN0KHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdKQogICAgICAgICAgICAgICAgICAgICAgICBsc3RbNl0gPSBpbnQobHN0WzZdKSArIGludChyb3dbNl0pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdID0gdHVwbGUobHN0KQogICAgICAgICAgICAgICAgICAgICAgICAjIHJzX2RvY190YWJsZV9kYXRhW2N1cnJfY291bnRdWzZdPWludChyc19kb2NfdGFibGVfZGF0YVtjdXJyX2NvdW50XVs2XSkgKyBpbnQocm93WzZdKQogICAgICAgICAgICAgICAgICAgIGlmIHJvd1s1XToKICAgICAgICAgICAgICAgICAgICAgICAgIyBSU19kb2NzX2JhcmNvZGVzIChpZF9kb2MsIGlkX2JhcmNvZGUsIGlzX3BsYW4pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX2RvY19iYXJjb2RlLmFwcGVuZCgoZG9jX251bSwgcm93WzVdLCAnMScpKQogICAgICAgICAgICAgICAgICAgICAgICAjIFJTX21hcmtpbmdfY29kZXMoaWQsIG1hcmtfY29kZSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3NlcmllcywgaWRfdW5pdCkgVkFMVUVTKD8sID8sID8sID8sID8sID8pCiAgICAgICAgICAgICAgICAgICAgICAgIHJzX21hcmtpbmdfY29kZXMuYXBwZW5kKChyb3dbNV0sIHJvd1s1XSwgcm93WzBdLCByb3dbOF0sICcnLCByb3dbMV0gKyByb3dbMF0pKQoKICAgICAgICAgICAgICAgIGVsaWYgbXlfcmVhZGVyLmxpbmVfbnVtID09IDM6CiAgICAgICAgICAgICAgICAgICAgaWYgcm93WzBdOgogICAgICAgICAgICAgICAgICAgICAgICBkb2NfbnVtID0gcm93WzBdCiAgICAgICAgICAgICAgICAgICAgcnNfZG9jX2RhdGEuYXBwZW5kKChkb2NfbnVtLCAn0JjQvdCy0L7QudGBJywgZG9jX251bSwgY3VycmVudF9kYXRlLCAnMDAxJywgJzAwMScpKQogICAgICAgICAgICAgICAgZWxpZiBteV9yZWFkZXIubGluZV9udW0gPT0gNToKICAgICAgICAgICAgICAgICAgICBsaXN0X2hlYWRlcnMgPSByb3cuY29weSgpCgogICAgICAgICMg0JfQsNC/0L7Qu9C90Y/QtdC8INGC0LDQsdC70LjRhtGLCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfZG9jcycpLCByc19kb2NfZGF0YSkKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU19kb2NzX3RhYmxlJyksIHJzX2RvY190YWJsZV9kYXRhKQogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2RvY3NfYmFyY29kZXMnKSwgcnNfZG9jX2JhcmNvZGUpCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfbWFya2luZ19jb2RlcycpLCByc19tYXJraW5nX2NvZGVzKQoKICAgICAgICAjINCf0L4g0LTQvtC60YPQvNC10L3RgtCw0LwsINCz0LTQtSDQtdGB0YLRjCDQt9Cw0L/Qu9Cw0L3QuNGA0L7QstCw0L3QvdGL0LUg0LzQsNGA0LrQuCwg0LTQvtCx0LDQstC40Lwg0L/RgNC40LfQvdCw0LoKICAgICAgICBxdGV4dCA9ICdTRUxFQ1QgaWRfZG9jLCBDT1VOVChpc19wbGFuKSBhcyBpc19wbGFuIEZST00gUlNfZG9jc19iYXJjb2RlcyBXSEVSRSBpc19wbGFuID0gIjEiICcKICAgICAgICByZXMgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgJycsIFRydWUpCiAgICAgICAgcXRleHQgPSAnVVBEQVRFIFJTX2RvY3MgU0VUIGFkZF9tYXJrX3NlbGVjdGlvbiA9ID8gV0hFUkUgaWRfZG9jID0gPycKICAgICAgICAjIC0tLQogICAgICAgIGZvciBlbCBpbiByZXM6CiAgICAgICAgICAgIGlmIGVsWydpc19wbGFuJ10gPiAwOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgxLCBlbFsnaWRfZG9jJ10pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgwLCBlbFsnaWRfZG9jJ10pKQogICAgICAgIHJldHVybiAyMDAKCgoKCiAgICBlbGlmIGZpbGVbOjE0XSA9PSAnaW5pdGlhbF9kaWN0c18nOgogICAgICAgICMg0JTQvtCx0LDQstC40Lwg0YLQuNC/INGC0L7QstCw0YDQsCDQtNC70Y8g0LLRgdC10YUg0YLQsNCx0LvQuNGGCiAgICAgICAgcXRleHQgPSAnUkVQTEFDRSBJTlRPIFJTX3R5cGVzX2dvb2RzICggIGlkLCBuYW1lKSBWQUxVRVMgKD8sPyknCiAgICAgICAgdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsICgn0KLQvtCy0LDRgCcsICfQotC+0LLQsNGAJykpCgogICAgICAgIHdpdGggb3BlbihwYXRoLCAncicsIG5ld2xpbmU9JycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGNzdmZpbGU6CgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3YucmVhZGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKCiAgICAgICAgICAgIHJzX2dvb2RzX2RhdGEgPSBbXQogICAgICAgICAgICByc19iYXJjb2Rlc19kYXRhID0gW10KICAgICAgICAgICAgcnNfdW5pdHNfZGF0YSA9IFtdCiAgICAgICAgICAgICMgUlNfd2FyZWhvdXNlcyggIGlkLCBuYW1lKQogICAgICAgICAgICByc193YXJlaG91c2VzID0gW1snMDAxJywgJ9Ce0YHQvdC+0LLQvdC+0LknXV0KICAgICAgICAgICAgIyBSU190eXBlc19nb29kcyAoICBpZCwgbmFtZSkKICAgICAgICAgICAgcnNfdHlwZXNfZ29vZHNfZGF0YSA9IFtbJzAwMScsICfQotC+0LLQsNGAJ11dCiAgICAgICAgICAgIHBhcnRfY291bnQgPSAxMDAwCgogICAgICAgICAgICBmb3Igcm93IGluIG15X3JlYWRlcjoKICAgICAgICAgICAgICAgIGlmIG15X3JlYWRlci5saW5lX251bSA9PSAxOiAgIyDQl9Cw0LPQvtC70L7QstC60Lgg0YLQsNCx0LvQuNGG0YsKICAgICAgICAgICAgICAgICAgICBsaXN0X2hlYWRlcnMgPSByb3cuY29weSgpCiAgICAgICAgICAgICAgICBlbHNlOiAgIyDQt9Cw0L/QvtC70L3Rj9C10Lwg0YLQsNCx0LvQuNGG0Ysg0L/QsNGA0LDQvNC10YLRgNC+0LIg0LfQsNC/0YDQvtGB0LAg0LogU1FMCiAgICAgICAgICAgICAgICAgICAgIyAgIGlkLCBjbyBkZSwgYXJ0LCBuYW1lLCB1bml0LCB0eXBlX2dvb2QsIGRlc2NyaXB0aW9uCiAgICAgICAgICAgICAgICAgICAgcnNfZ29vZHNfZGF0YS5hcHBlbmQoKHJvd1syXSwgcm93WzNdLCByb3dbNV0sIHJvd1s0XSwgcm93WzFdLCAn0KLQvtCy0LDRgCcsIHJvd1sxNV0pKQogICAgICAgICAgICAgICAgICAgICMgICBpZCwgaWRfb3duZXIsIGNvZGUsIG5hbWUsIG5vbWluYXRvciwgZGVub21pbmF0b3IsIGludF9yZWR1Y3Rpb24KICAgICAgICAgICAgICAgICAgICByc191bml0c19kYXRhLmFwcGVuZCgocm93WzFdICsgcm93WzJdLCByb3dbMl0sIHJvd1sxXSwgcm93WzFdLCAxLCAxLCByb3dbMV0pKQogICAgICAgICAgICAgICAgICAgICMgYmFyY29kZSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3NlcmllcywgaWRfdW5pdAogICAgICAgICAgICAgICAgICAgIGd0aW4gPSBub3JtYWxpemVfZ3Rpbihyb3dbMF0pCiAgICAgICAgICAgICAgICAgICAgcnNfYmFyY29kZXNfZGF0YS5hcHBlbmQoKGd0aW4sIGd0aW4sIHJvd1syXSwgJycsICcnLCByb3dbMV0gKyByb3dbMl0pKQoKICAgICAgICAgICAgICAgICMg0JrQsNC20LTRi9C1IDEwMDAg0YHRgtGA0L7QuiDQt9Cw0L/QuNGB0YvQstCw0LXQvCDQsiDQsdCw0LfRgwogICAgICAgICAgICAgICAgaWYgbXlfcmVhZGVyLmxpbmVfbnVtID09IHBhcnRfY291bnQ6CiAgICAgICAgICAgICAgICAgICAgcGFydF9jb3VudCArPSAxMDAwCiAgICAgICAgICAgICAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfZ29vZHMnKSwgcnNfZ29vZHNfZGF0YSkKICAgICAgICAgICAgICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU191bml0cycpLCByc191bml0c19kYXRhKQogICAgICAgICAgICAgICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2JhcmNvZGVzJyksIHJzX2JhcmNvZGVzX2RhdGEpCiAgICAgICAgICAgICAgICAgICAgcnNfZ29vZHNfZGF0YSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcnNfYmFyY29kZXNfZGF0YSA9IFtdCiAgICAgICAgICAgICAgICAgICAgcnNfdW5pdHNfZGF0YSA9IFtdCgogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX3dhcmVob3VzZXMnKSwgcnNfd2FyZWhvdXNlcykKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU190eXBlc19nb29kcycpLCByc190eXBlc19nb29kc19kYXRhKQogICAgICAgIHVpX2dsb2JhbC5idWxrX3F1ZXJ5X3JlcGxhY2UoZ2V0X3F1ZXJ5X3RleHQoJ1JTX2dvb2RzJyksIHJzX2dvb2RzX2RhdGEpCiAgICAgICAgdWlfZ2xvYmFsLmJ1bGtfcXVlcnlfcmVwbGFjZShnZXRfcXVlcnlfdGV4dCgnUlNfdW5pdHMnKSwgcnNfdW5pdHNfZGF0YSkKICAgICAgICB1aV9nbG9iYWwuYnVsa19xdWVyeV9yZXBsYWNlKGdldF9xdWVyeV90ZXh0KCdSU19iYXJjb2RlcycpLCByc19iYXJjb2Rlc19kYXRhKQoKICAgICAgICByZXR1cm4gMjAwCgoKZGVmIGxpc3RfZm9sZGVyKHBhdGg6IHN0ciwgZGVsZXRlX2ZpbGVzOiBib29sKToKICAgICMgdHJ5OgogICAgYWEgPSAwCiAgICB0b3RhbCA9IDAKICAgIGZvciBmaWxlIGluIG9zLmxpc3RkaXIocGF0aCk6CiAgICAgICAgdG90YWwgKz0gMQogICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoIi5jc3YiKToKICAgICAgICAgICAgZmlsZW5hbWUgPSBmaWxlICsgKCIgIiAqIDE1KSAgIyDRh9GC0L7QsdGLINC90LUg0L3QsNGC0YvQutCw0YLRjNGB0Y8g0L3QsCBvdXQgb2YgcmFuZ2Ug0LIg0YLQtdC60YHRgtC+0LLQvtC8INC40LzQtdC90LggLSDQtNC+0LHQsNCy0LjQvCAxNSDQv9GA0L7QsdC10LvQvtCyCiAgICAgICAgICAgIGlmIGZpbGVuYW1lWzo2XSA9PSAnZG9jX2luJyBvciBmaWxlbmFtZVs6MTRdID09ICdpbml0aWFsX2RpY3RzXyc6CiAgICAgICAgICAgICAgICBhYSArPSAxCiAgICAgICAgICAgICAgICBhbnMgPSBsb2FkX2Zyb21fY3N2KHBhdGggKyBmaWxlLCBmaWxlKQogICAgICAgICAgICAgICAgaWYgYW5zID09IDIwMCBhbmQgZGVsZXRlX2ZpbGVzID09ICd0cnVlJzoKICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUocGF0aCArIGZpbGUpCgogICAgcmV0dXJuICfQl9Cw0LPRgNGD0LfQutCwINC30LDQstC10YDRiNC10L3QsCwg0LfQsNCz0YDRg9C20LXQvdC+ICcgKyBzdHIoYWEpICsgJyDRhNCw0LnQu9C+0LIg0LjQtyAnICsgc3RyKHRvdGFsKQogICAgIyBleGNlcHQ6CiAgICAjICAgcmV0dXJuICfQntGI0LjQsdC60LAg0L/RgNC4INC30LDQs9GA0YPQt9C60LUg0YTQsNC50LvQsCcKCgpkZWYgZXhwb3J0X2NzdihwYXRoLCBJUCwgQW5kcm9pZElEKToKICAgIGRvY3MgPSB1aV9nbG9iYWwuZ2V0X3F1ZXJ5X3Jlc3VsdCgnU0VMRUNUIGlkX2RvYywgZG9jX24gZnJvbSBSU19kb2NzIFdoZXJlIHZlcmlmaWVkID0gMScpCiAgICBjb3VudCA9IDAKICAgIGZvciBkb2NfaXRlbSBpbiBkb2NzOgogICAgICAgIHF0ZXh0ID0gZ2V0X3F1ZXJ5X3RleHRfZXhwb3J0KCkKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIChkb2NfaXRlbVswXSwpLCBUcnVlKQogICAgICAgIGNvdW50ICs9IDEKICAgICAgICB3aXRoIG9wZW4ocGF0aCArICdkb2Nfb3V0XycgKyBkb2NfaXRlbVsxXSArICcuY3N2JywgJ3cnLCBuZXdsaW5lPScnLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBjc3ZmaWxlOgogICAgICAgICAgICBteV9yZWFkZXIgPSBjc3Yud3JpdGVyKGNzdmZpbGUsIGRpYWxlY3Q9J2V4Y2VsJywgZGVsaW1pdGVyPSc7JywgcXVvdGVjaGFyPSciJykKICAgICAgICAgICAgbXlfcmVhZGVyLndyaXRlcm93KCgnTmFtZScsICdVc2VyTmFtZScsICdEZXZpY2VJZCcsICdEZXZpY2VJUCcpKQogICAgICAgICAgICBteV9yZWFkZXIud3JpdGVyb3coKCfQn9GA0LjRhdC+0LQg0L3QsCDRgdC60LvQsNC0ICcgKyBkb2NfaXRlbVsxXSwgJ9Cc0L7RgdC60LLQsDEnLCBBbmRyb2lkSUQsIElQKSkKICAgICAgICAgICAgbXlfcmVhZGVyLndyaXRlcm93KCgnR1RJTicsICfQmtC+0LTQktCj0YfQtdGC0L3QvtC50KHQuNGB0YLQtdC80LUnLCAn0J3QsNC40LzQtdC90L7QstCw0L3QuNC1JywgJ0RlY2xhcmVkUXVhbnRpdHknLCAnQ3VycmVudFF1YW50aXR5JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JrQvtGA0L7QsdC60LAnLCAn0JzQsNGA0LrQsCcsICfQnNCw0YDQutCw0JjQodCc0J8nLCAn0JjQvdCy0L7QudGBJywgJ9Cf0YDQuNC90LDQtNC70LXQttC90L7RgdGC0YwnKSkKICAgICAgICAgICAgZm9yIGVsIGluIHJlczoKICAgICAgICAgICAgICAgIGd0aW4gPSB1aV9iYXJjb2Rlcy5nZXRfZ3Rpbl9zZXJpYWxfZnJvbV9kYXRhbWF0cml4KGVsWyfQnNCw0YDQutCw0JjQodCc0J8nXSkKICAgICAgICAgICAgICAgIGVsWydHVElOJ10gPSBndGluWydHVElOJ10KICAgICAgICAgICAgICAgIG15X3JlYWRlci53cml0ZXJvdygoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxbJ0dUSU4nXSwgZWxbJ2lkX2dvb2QnXSwgZWxbJ25hbWUnXSwgZWxbJ0RlY2xhcmVkUXVhbnRpdHknXSwgZWxbJ0N1cnJlbnRRdWFudGl0eSddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsWyfQnNCw0YDQutCwJ10sIGVsWyfQnNCw0YDQutCw0JjQodCc0J8nXSwgZWxbJ9CY0L3QstC+0LnRgSddLCBlbFsn0J/RgNC40L3QsNC00LvQtdC20L3QvtGB0YLRjCddKSkKCiAgICByZXR1cm4gc3RyKGNvdW50KSArICcg0LTQvtC60YPQvNC10L3RgtC+0LInCiMgZXhwb3J0X2Nzdign0J7QsdC80LXQvdCi0KHQlC/QndCQLycpICMnCgoKIyBvcGVuX2ZpbGVzX25ldCgnJywgJ0Q6L1B5dGhvblByb2plY3RzL1JpZ2h0U2Nhbi9TVUltYWluL9Ce0LHQvNC10L3QotCh0JQv0J3QkC9pbml0aWFsX2RpY3RzXzAxLmNzdicsICdpbml0aWFsX2RpY3RzXzAxLmNzdicpCiMgb3Blbl9maWxlc19uZXQoJycsICdEOi9QeXRob25Qcm9qZWN0cy9SaWdodFNjYW4vU1VJbWFpbi/QntCx0LzQtdC90KLQodCUL9Cd0JAvZG9jXzEuY3N2JywnZG9jXzEuY3N2JykK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_form_data.py",
                "PyFileKey": "ui_form_data",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IHdpZGdldHMKCmJhcmNvZGVfY2FyZHMgPSB7ImN1c3RvbWNhcmRzIjogewogICAgIm9wdGlvbnMiOiB7CiAgICAgICAgInNlYXJjaF9lbmFibGVkIjogVHJ1ZSwKICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgIH0sCgogICAgImxheW91dCI6IHsKICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgIlBhZGRpbmciOiAiMCIsCiAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcHJvcGVydGllcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0YwRjhGRiIsCiAgICAgICAgICAgICAgICAiUGFkZGluZyI6ICIwIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHVuaXQiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBiYXJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgIkJhY2tncm91bmRDb2xvciI6ICIjRjBGOEZGIiwKICAgICAgICAgICAgICAgICJQYWRkaW5nIjogIjAiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwoKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAc2VyaWVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEJvbGQiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAxCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgXQogICAgICAgIH0KICAgIH0KfQoKZGVmIGdldF9kb2NfY2FyZChzZXR0aW5nc19nbG9iYWwsIEFkZE1lbnU9JycpOgogICAgZG9jX2xpc3QgPSB7ImN1c3RvbWNhcmRzIjogewogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAic2VhcmNoX2VuYWJsZWQiOiBUcnVlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAogICAgICAgICJsYXlvdXQiOiB7CiAgICAgICAgICAgICJWYWx1ZSI6ICIiLAogICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiQ2hlY2tCb3giLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBjb21wbGV0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIkNoZWNrQm94MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiAiMzIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNEQjcwOTMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHR5cGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCJUaXRsZVRleHRTaXplIikgIyIxOCIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiUG9wdXBNZW51QnV0dG9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogZiLQo9C00LDQu9C40YLRjDvQn9C+0LTRgtCy0LXRgNC00LjRgtGMO9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsHtBZGRNZW51fSIsICAjO9Ch0LrQsNC90LjRgNC+0LLQsNGC0Ywg0YjRgtGA0LjRhdC60L7QtNGLINC/0L7RgtC+0LrQvtC8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICJtZW51X2RlbGV0ZSIKCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAbnVtYmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykgICMiMjAiCiAgICAgICAgICAgICAgICAgICAgICAgIH0jLAogICAgICAgICAgICAgICAgICAgICAgICAjIHsKICAgICAgICAgICAgICAgICAgICAgICAgIyAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAiVmFsdWUiOiAiQGRhdGEiLAogICAgICAgICAgICAgICAgICAgICAgICAjICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIyAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgICAgICMgfQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBjb3VudHJhZ2VudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHdhcmVob3VzZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdCiAgICAgICAgfQogICAgfX0KCiAgICByZXR1cm4gZG9jX2xpc3QKCgpkZWYgZ2V0X2RvY19jYXJkX25ldyhzZXR0aW5nc19nbG9iYWwsIHRhYmxlX2RhdGEpOgogICAgZG9jX2xpc3QgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTgsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B0eXBlJywKICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J3JpZ2h0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1zZXR0aW5nc19nbG9iYWwuZ2V0KCJUaXRsZVRleHRTaXplIiksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J9Cj0LTQsNC70LjRgtGMJywKICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbnVtYmVyJywKICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY291bnRyYWdlbnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B3YXJlaG91c2UnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICksCiAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICApCgogICAgcmV0dXJuIGRvY19saXN0LnRvX2pzb24oKQoKCmRlZiBnZXRfZG9jX3F1ZXJ5KGFyZz0nJyk6CiAgICBxdWVyeV90ZXh0ID0gIiIiCiAgICBTRUxFQ1QgUlNfZG9jcy5pZF9kb2MsCiAgICBSU19kb2NzLmRvY190eXBlLAogICAgUlNfZG9jcy5kb2NfbiwKICAgIFJTX2RvY3MuZG9jX2RhdGUsCiAgICBSU19kb2NzLmlkX2NvdW50cmFnZW50cywKICAgIFJTX2RvY3MuaWRfd2FyZWhvdXNlLAogICAgaWZudWxsKFJTX2NvdW50cmFnZW50cy5mdWxsX25hbWUsJycpIGFzIFJTX2NvdW50cmFnZW50LAogICAgaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwnJykgYXMgUlNfd2FyZWhvdXNlLAogICAgUlNfZG9jcy52ZXJpZmllZCwKICAgIFJTX2RvY3Muc2VudCwKICAgIFJTX2RvY3MuYWRkX21hcmtfc2VsZWN0aW9uCgogICAgIEZST00gUlNfZG9jcwogICAgIExFRlQgSk9JTiBSU19jb3VudHJhZ2VudHMgYXMgUlNfY291bnRyYWdlbnRzCiAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0gUlNfZG9jcy5pZF9jb3VudHJhZ2VudHMKICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgT04gUlNfd2FyZWhvdXNlcy5pZD1SU19kb2NzLmlkX3dhcmVob3VzZQogICAgICIiIgogICAgaWYgbm90IChhcmcgPT0gJycgb3IgYXJnID09ICfQktGB0LUnKToKICAgICAgICBxdWVyeV90ZXh0ID0gcXVlcnlfdGV4dCArICcnJwogICAgICAgIFdoZXJlIFJTX2RvY3MuZG9jX3R5cGU9PycnJwoKICAgIHF1ZXJ5X3RleHQgPSBxdWVyeV90ZXh0ICsgIiIiCiAgICBPUkRFUgogICAgQlkKICAgIFJTX2RvY3MuZG9jX2RhdGUiIiIKICAgIHJldHVybiBxdWVyeV90ZXh0CgpkZWYgZ2V0X2Fkcl9kb2NfcXVlcnkoYXJnPScnKToKICAgIHF1ZXJ5X3RleHQgPSAiIiIKICAgIFNFTEVDVCBSU19hZHJfZG9jcy5pZF9kb2MsCiAgICBSU19hZHJfZG9jcy5kb2NfdHlwZSwKICAgIFJTX2Fkcl9kb2NzLmRvY19uLAogICAgUlNfYWRyX2RvY3MuZG9jX2RhdGUsCiAgICBSU19hZHJfZG9jcy5pZF93YXJlaG91c2UsCiAgICBpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCcnKSBhcyBSU193YXJlaG91c2UsCiAgICBSU19hZHJfZG9jcy52ZXJpZmllZCwKICAgIFJTX2Fkcl9kb2NzLnNlbnQsCiAgICBSU19hZHJfZG9jcy5hZGRfbWFya19zZWxlY3Rpb24KCiAgICAgRlJPTSBSU19hZHJfZG9jcwoKICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyBhcyBSU193YXJlaG91c2VzCiAgICAgT04gUlNfd2FyZWhvdXNlcy5pZD1SU19hZHJfZG9jcy5pZF93YXJlaG91c2UKICAgICAiIiIKICAgIGlmIG5vdCAoYXJnID09ICcnIG9yIGFyZyA9PSAn0JLRgdC1Jyk6CiAgICAgICAgcXVlcnlfdGV4dCA9IHF1ZXJ5X3RleHQgKyAnJycKICAgICAgICBXaGVyZSBSU19hZHJfZG9jcy5kb2NfdHlwZT0/JycnCgogICAgcXVlcnlfdGV4dCA9IHF1ZXJ5X3RleHQgKyAiIiIKICAgIE9SREVSCiAgICBCWQogICAgUlNfYWRyX2RvY3MuZG9jX2RhdGUiIiIKICAgIHJldHVybiBxdWVyeV90ZXh0CgpkZWYgZ2V0X2RvY190eXBlX3F1ZXJ5KCk6CiAgICBscyA9ICdTRUxFQ1QgRElTVElOQ1QgZG9jX3R5cGUgZnJvbSBSU19kb2NzJwogICAgcmV0dXJuIGxzCgoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLdCi0L7QstCw0YDRiwoKZGVmIGdldF9nb29kc19xdWVyeSgpOgogICAgcXVlcnlfdGV4dCA9ICIiIgogICAgU0VMRUNUIFJTX2dvb2RzLmlkLAogICAgUlNfZ29vZHMuY29kZSwKICAgIFJTX2dvb2RzLmFydCwKICAgIFJTX2dvb2RzLm5hbWUsCiAgICBSU19nb29kcy50eXBlX2dvb2QsCiAgICBSU190eXBlc19nb29kcy5uYW1lIEFTIHR5cGVzX2dvb2RzLAogICAgUlNfZ29vZHMudW5pdCwKICAgIFJTX3VuaXRzLm5hbWUKICAgIEZST00gUlNfZ29vZHMKICAgIExFRlQgSk9JTiBSU190eXBlc19nb29kcwogICAgT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBSU19nb29kcy50eXBlX2dvb2QKICAgIExFRlQgSk9JTiBSU191bml0cwogICAgT04gUlNfdW5pdHMuaWRfb3duZXIgPSBSU19nb29kcy5pZCIiIgogICAgcmV0dXJuIHF1ZXJ5X3RleHQKCgpkZWYgZ2V0X3ByaWNlX2NhcmQoc2V0dGluZ3NfZ2xvYmFsKToKICAgIHR4dCA9IHsiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IEZhbHNlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAogICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAiVmFsdWUiOiAiIiwKICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIyIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBwcmljZV90eXBlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHByaWNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0NhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgXQogICAgfQogICAgfQogICAgcmV0dXJuIHR4dAoKCmRlZiBnZXRfZG9jX2RldGFpbHNfcXVlcnkoaXNBZHIgPSBGYWxzZSwgY3VyQ2VsbCA9IEZhbHNlKToKICAgIGlmIGlzQWRyOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnJycKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5uYW1lLCA6TnVsbFZhbHVlKSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5jb2RlLCA6RW1wdHlTdHJpbmcpIGFzIGNvZGUsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5hcnQsIDpFbXB0eVN0cmluZykgYXMgYXJ0LAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcywgOkVtcHR5U3RyaW5nKSBhcyBpZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBpZm51bGwoUlNfcHJvcGVydGllcy5uYW1lLCA6RW1wdHlTdHJpbmcpIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3NlcmllcywgOkVtcHR5U3RyaW5nKSBhcyBpZF9zZXJpZXMsCiAgICAgICAgICAgIGlmbnVsbChSU19zZXJpZXMubmFtZSwgOkVtcHR5U3RyaW5nKSBhcyBzZXJpZXNfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQsIDpFbXB0eVN0cmluZykgYXMgaWRfdW5pdCwKICAgICAgICAgICAgaWZudWxsKFJTX3VuaXRzLm5hbWUsIDpFbXB0eVN0cmluZykgYXMgdW5pdHNfbmFtZSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eSBhcyBxdHR5LAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5X3BsYW4gYXMgcXR0eV9wbGFuLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5X3BsYW4gLSBSU19hZHJfZG9jc190YWJsZS5xdHR5IGFzIElzRG9uZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2NlbGwsIDpFbXB0eVN0cmluZykgYXMgaWRfY2VsbCwKICAgICAgICAgICAgaWZudWxsKFJTX2NlbGxzLm5hbWUsIDpOdWxsVmFsdWUpIGFzIGNlbGxfbmFtZQogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgICAgICBPTiBSU19zZXJpZXMuaWQgPSBSU19hZHJfZG9jc190YWJsZS5pZF9zZXJpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgICAgIE9OIFJTX2NlbGxzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2NlbGwKCiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9IDppZF9kb2MgYW5kIHRhYmxlX3R5cGUgPSA6dGFibGVfdHlwZQogICAgICAgICAgICAKICAgICAgICAgICAgJycnCgogICAgICAgIGlmIGN1ckNlbGw6CiAgICAgICAgICAgIHF1ZXJ5X3RleHQgPSBxdWVyeV90ZXh0ICsgJycnCiAgICAgICAgICAgICBhbmQgKGlkX2NlbGw9OmN1cnJlbnRfY2VsbCBPUiBpZF9jZWxsPSIiIE9SIGlkX2NlbGwgaXMgTnVsbCkKICAgICAgICAgICAgJycnCgogICAgICAgIHF1ZXJ5X3RleHQgPSBxdWVyeV90ZXh0ICsgJyBPUkRFUiBCWSBSU19jZWxscy5uYW1lLCBSU19hZHJfZG9jc190YWJsZS5sYXN0X3VwZGF0ZWQgREVTQycKCiAgICBlbHNlOgogICAgICAgIHF1ZXJ5X3RleHQgPSAiIiIKICAgICAgICBTRUxFQ1QKICAgICAgICBSU19kb2NzX3RhYmxlLmlkLAogICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZG9jLAogICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKICAgICAgICBSU19nb29kcy5jb2RlLAogICAgICAgIFJTX2dvb2RzLmFydCwKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3NlcmllcywKICAgICAgICBSU19zZXJpZXMubmFtZSBhcyBzZXJpZXNfbmFtZSwKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgUlNfdW5pdHMubmFtZSBhcyB1bml0c19uYW1lLAogICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSwKICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiwKICAgICAgICBSU19kb2NzX3RhYmxlLnByaWNlLAogICAgICAgIFJTX3ByaWNlX3R5cGVzLm5hbWUgYXMgcHJpY2VfbmFtZSwKICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHlfcGxhbiAtIFJTX2RvY3NfdGFibGUucXR0eSBhcyBJc0RvbmUKICAgICAgICBGUk9NIFJTX2RvY3NfdGFibGUgCiAgICAKICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgT04gUlNfZ29vZHMuaWQ9UlNfZG9jc190YWJsZS5pZF9nb29kCiAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9IFJTX2RvY3NfdGFibGUuaWRfc2VyaWVzCiAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgT04gUlNfdW5pdHMuaWQ9UlNfZG9jc190YWJsZS5pZF91bml0CiAgICAgICAgTEVGVCBKT0lOIFJTX3ByaWNlX3R5cGVzCiAgICAgICAgT04gUlNfcHJpY2VfdHlwZXMuaWQgPSBSU19kb2NzX3RhYmxlLmlkX3ByaWNlCiAgICAgICAgV0hFUkUgaWRfZG9jID0gJGFyZzEKICAgICAgICBPUkRFUiBCWSBSU19kb2NzX3RhYmxlLmxhc3RfdXBkYXRlZCBERVNDIAogICAgICAgICIiIgoKICAgIHJldHVybiBxdWVyeV90ZXh0CgoKZGVmIGdldF9kb2NfZGV0YWlsX2NhcmRzKHVzZV9zZXJpZXMsIHVzZV9wcm9wZXJ0aWVzLCBzZXR0aW5nc19nbG9iYWwsIGlzQWRyID0gRmFsc2UpOgogICAgY2VsbE1lbnVDb21tYW5kID0gJzvQmNC30LzQtdC90LjRgtGMINGP0YfQtdC50LrRgycgaWYgaXNBZHIgZWxzZSAnJwogICAgbGlzdCA9IHsKICAgICAgICAiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAgICAgInNlYXJjaF9lbmFibGVkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICJzYXZlX3Bvc2l0aW9uIjogVHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICAibGF5b3V0IjogewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAZ29vZF9uYW1lIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcGljdHVyZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6ICIyNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiI0RCNzA5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiI0ZGRkZGRiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAiMjUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlBvcHVwTWVudUJ1dHRvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiBmItCj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRg3tjZWxsTWVudUNvbW1hbmR9IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAibWVudV9nb29kX3N0cmluZyIKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGNvZGVfYXJ0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkB1bml0X25hbWUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImdvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogInZlcnRpY2FsIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAi0J/Qu9Cw0L0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQHF0dHlfcGxhbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQpNCw0LrRgiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcXR0eSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICLQptC10L3QsCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAcHJpY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ2dvb2RzVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgaWYgdXNlX3NlcmllcyA9PSAndHJ1ZScgb3IgdXNlX3NlcmllcyA9PSAnMSc6CiAgICAgICAgbGlzdFsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10uaW5zZXJ0KDEsIHsndHlwZSc6ICdUZXh0VmlldycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnKSwgIzE2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hvd19ieV9jb25kaXRpb24nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6ICdAc2VyaWVzX25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ05vUmVmcmVzaCc6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RvY3VtZW50X3R5cGUnOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXNrJzogJycsICdWYXJpYWJsZSc6ICcnfSkKICAgIGlmIHVzZV9wcm9wZXJ0aWVzID09ICd0cnVlJyBvciB1c2VfcHJvcGVydGllcyA9PSAnMSc6CiAgICAgICAgbGlzdFsnY3VzdG9tY2FyZHMnXVsnbGF5b3V0J11bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ11bMF1bJ0VsZW1lbnRzJ10uaW5zZXJ0KDEsIHsndHlwZSc6ICdUZXh0VmlldycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnKSwgIycxNicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hvd19ieV9jb25kaXRpb24nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdWYWx1ZSc6ICdAcHJvcGVydGllc19uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdOb1JlZnJlc2gnOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkb2N1bWVudF90eXBlJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWFzayc6ICcnLCAnVmFyaWFibGUnOiAnJ30pCiAgICBpZiBpc0FkcjoKICAgICAgICBsaXN0WydjdXN0b21jYXJkcyddWydsYXlvdXQnXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXVswXVsnRWxlbWVudHMnXS5pbnNlcnQoMSwgeyd0eXBlJzogJ1RleHRWaWV3JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Nlcmllc1Byb3BlcnRpZXNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAnMTYnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Nob3dfYnlfY29uZGl0aW9uJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVmFsdWUnOiAnQGNlbGxfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTm9SZWZyZXNoJzogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZG9jdW1lbnRfdHlwZSc6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hc2snOiAnJywgJ1ZhcmlhYmxlJzogJyd9KQoKICAgICAgICBwYXNzCgogICAgcmV0dXJuIGxpc3QKCgpkZWYgZ2V0X2RvY19kZXRhaWxfY2FyZHNfbmV3KHNldHRpbmdzX2dsb2JhbCwgY2FyZHNfZGF0YTogbGlzdCwgYWRkX2xhYmVsczogbGlzdCA9IE5vbmUpOgogICAgZ29vZHNfdGV4dF9zaXplID0gc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpCiAgICBoZWFkZXIgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgKQoKICAgICMgc2VyaWVzX25hbWUsIHByb3BlcnRpZXNfbmFtZSwgY2VsbF9uYW1lCiAgICBhZGRfbGFiZWxzID0gYWRkX2xhYmVscyBvciBbXQogICAgZm9yIGxhYmVsIGluIGFkZF9sYWJlbHM6CiAgICAgICAgaGVhZGVyLmFwcGVuZCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhWYWx1ZT1mJ0B7bGFiZWx9JywgVGV4dFNpemU9c2V0dGluZ3NfZ2xvYmFsLmdldCgnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJykpLAogICAgICAgICkKCiAgICBoZWFkZXIuYXBwZW5kKAogICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9uYW1lJywKICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgVGV4dFNpemU9c2V0dGluZ3NfZ2xvYmFsLmdldCgnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZScpLAogICAgICAgICAgICB3ZWlnaHQ9JzEnCiAgICAgICAgKSwKICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICBWYWx1ZT0nQHBpY3R1cmUnLAogICAgICAgICAgICBUZXh0U2l6ZT0nMjUnLAogICAgICAgICAgICBUZXh0Q29sb3I9JyNEQjcwOTMnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9IiNGRkZGRkYiLAogICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgaGVpZ2h0PTI1LAogICAgICAgICksCiAgICApCgogICAgY29kZV9hcnQgPSB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSdAY29kZV9hcnQnLCBUZXh0U2l6ZT1zZXR0aW5nc19nbG9iYWwuZ2V0KCdnb29kc1RleHRTaXplJykpCiAgICB1bml0X25hbWUgPSB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSdAdW5pdF9uYW1lJywgVGV4dFNpemU9c2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpKQogICAgZm9vdGVyID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWU9J9Cf0LvQsNC9JywgVGV4dFNpemU9Z29vZHNfdGV4dF9zaXplKSwKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhWYWx1ZT0nQHF0dHlfcGxhbicsIFRleHRTaXplPWdvb2RzX3RleHRfc2l6ZSksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICApLAogICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSfQpNCw0LrRgicsIFRleHRTaXplPWdvb2RzX3RleHRfc2l6ZSksCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWU9J0BxdHR5JywgVGV4dFNpemU9Z29vZHNfdGV4dF9zaXplKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICksCiAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWU9J9Cm0LXQvdCwJywgVGV4dFNpemU9Z29vZHNfdGV4dF9zaXplKSwKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhWYWx1ZT0nQHByaWNlJywgVGV4dFNpemU9Z29vZHNfdGV4dF9zaXplKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICksCiAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICB3ZWlnaHQ9MSwKICAgICkKCiAgICBkZXRhaWxfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIGhlYWRlciwKICAgICAgICAgICAgICAgICAgICBjb2RlX2FydCwKICAgICAgICAgICAgICAgICAgICB1bml0X25hbWUsCiAgICAgICAgICAgICAgICAgICAgZm9vdGVyLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0nMScKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJwogICAgICAgICAgICApLAogICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgKSwKICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICkKCiAgICByZXR1cm4gZGV0YWlsX2NhcmRzLnRvX2pzb24oKQoKCmRlZiBnZXRfZG9jX2JhcmNfZmxvd19xdWVyeSgpOgogICAgcmV0dXJuICcnJwogICAgU2VsZWN0ICogZnJvbSBSU19iYXJjX2Zsb3cgV0hlcmUgaWRfZG9jID0/CiAgICAnJycKCmRlZiBkb2NfYmFyY19mbG93X2NhcmQoc2V0dGluZ3NfZ2xvYmFsKToKICAgIGxpc3QgPSB7CiAgICAgICAgImN1c3RvbWNhcmRzIjogewogICAgICAgICAgICAib3B0aW9ucyI6IHsKICAgICAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IFRydWUsCiAgICAgICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICAgICAgfSwKICAgICAgICAgICAgImxheW91dCI6IHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgIkVsZW1lbnRzIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBiYXJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdHb29kc0NhcmRUaXRsZVRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgoKICAgIHJldHVybiBsaXN0CgpkZWYgZ2V0X3ByaWNlX3F1ZXJ5KCk6CiAgICB0eHQgPSAiIiIKICAgIFNFTEVDVCAqLAogICAgUlNfcHJpY2VfdHlwZXMubmFtZQogICAgIGZyb20gUlNfcHJpY2VzIAogICAgIExFRlQgSk9JTiBSU19wcmljZV90eXBlcyBPTiBSU19wcmljZV90eXBlcy5pZD1SU19wcmljZXMuaWRfcHJpY2VfdHlwZXMKICAgICB3aGVyZSBpZF9nb29kcz0/IiIiCiAgICByZXR1cm4gdHh0CgoKIyDQodC+0LLRgNC10LzQtdC90L3QvtC1INC/0L7Qu9C1INCy0LLQvtC00LAsINC90LUg0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGPCmRlZiBnZXRfbnVtX2ZpZWxkX2Rlc2NyKHF0dHkpOgogICAganNvbl9kZXNjciA9IHsKICAgICAgICAiaGludCI6ICfQutC+0LvQuNGH0LXRgdGC0LLQvicsCiAgICAgICAgImRlZmF1bHRfdGV4dCI6IHF0dHksCiAgICAgICAgJ2lucHV0VHlwZSAnOiAnVFlQRV9DTEFTU19OVU1CRVInCiAgICB9CiAgICByZXR1cm4ganNvbl9kZXNjcgoKCiMgZGVmIGdldF9iYXJjb2RlX3F1ZXJ5KCk6CiMgICAgIHF1ZXJ5X3RleHQgPSAnU0VMRUNUICogRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdoZXJlIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gPycKIyAgICAgcmV0dXJuIHF1ZXJ5X3RleHQKCgojINCX0LDQv9GA0L7RgSDQvdCw0YXQvtC00LjRgiDQstGB0LUg0LfQsNC/0LjRgdC4INGC0LDQsdC70LjRhtGLINC00L7QutGD0LzQtdC90YLQsCBSU19kb2NzX2JhcmNvZGVzINC/0L4g0L/QvtC70L3QvtC80YMg0YHQvtCy0L/QsNC00LXQvdC40Y4g0YjRgtGA0LjRhdC60L7QtNCwINC40LvQuCDRgtC+0LvRjNC60L4g0L/QviBHVElOCmRlZiBnZXRfcXVlcnlfbWFya19maW5kX2luX2RvYygpOgogICAgcXVlcnkgPSAnJycKICAgIFNFTEVDVCAKICAgIGlkLAogICAgaWRfZG9jLAogICAgSUZOVUxMKEdUSU4sICcwJykgQVMgR1RJTiwKICAgIElGTlVMTChTZXJpZXMsICcwJykgQVMgU2VyaWVzLAogICAgSUZOVUxMKGlkX2dvb2QsICcnKSBBUyBpZF9nb29kLAogICAgSUZOVUxMKGlkX3Byb3BlcnR5LCAnJykgQVMgaWRfcHJvcGVydHkgLAogICAgSUZOVUxMKGlkX3NlcmllcywgJycpIEFTIGlkX3NlcmllcywKICAgIElGTlVMTChpZF91bml0LCAnJykgIEFTIGlkX3VuaXQsCiAgICBpc19wbGFuLAogICAgYXBwcm92ZWQKCiAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKCiAgICBXSEVSRSBpZF9kb2MgPSA6aWRfZG9jICBhbmQgR1RJTiA9IDpHVElOIEFuZCBTZXJpZXMgPSA6U2VyaWVzJycnCgogICAgIwogICAgIwogICAgIyAgICAgJycnCiAgICAjIFNFTEVDVCAqIEZST00gKAogICAgIwogICAgIyBTRUxFQ1QKICAgICMgUlNfZG9jc19iYXJjb2Rlcy5pZCwKICAgICMgUlNfZG9jc19iYXJjb2Rlcy5pZF9kb2MsCiAgICAjCiAgICAjIFJTX2RvY3NfYmFyY29kZXMuaWRfYmFyY29kZSwKICAgICMKICAgICMgSUZOVUxMKFJTX21hcmtpbmdfY29kZXMubWFya19jb2RlLCAnMCcpIEFTIG1hcmtfY29kZSwKICAgICMgSUZOVUxMKFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZCwgJycpIEFTIGlkX2dvb2QsCiAgICAjIElGTlVMTChSU19tYXJraW5nX2NvZGVzLmlkX3Byb3BlcnR5LCAnJykgQVMgaWRfcHJvcGVydHkgLAogICAgIyBJRk5VTEwoUlNfbWFya2luZ19jb2Rlcy5pZF9zZXJpZXMsICcnKSBBUyBpZF9zZXJpZXMsCiAgICAjIElGTlVMTChSU19tYXJraW5nX2NvZGVzLmlkX3VuaXQsICcnKSAgQVMgaWRfdW5pdCwKICAgICMKICAgICMgUlNfZG9jc19iYXJjb2Rlcy5pc19wbGFuLAogICAgIyBSU19kb2NzX2JhcmNvZGVzLmFwcHJvdmVkCiAgICAjCiAgICAjIEZST00gUlNfZG9jc19iYXJjb2RlcwogICAgIwogICAgIyAgICAgTEVGVCBKT0lOIFJTX21hcmtpbmdfY29kZXMgQXMgUlNfbWFya2luZ19jb2RlcwogICAgIyAgICAgT04gUlNfbWFya2luZ19jb2Rlcy5pZCA9IFJTX2RvY3NfYmFyY29kZXMuaWRfYmFyY29kZQogICAgIwogICAgIyBXSEVSRSBpZF9kb2MgPSA6aWRfZG9jICBhbmQgUlNfbWFya2luZ19jb2Rlcy5tYXJrX2NvZGUgPSA6c2V0X2JhcmNvZGUpCiAgICAjICcnJwogICAgIwogICAgIyBTRUxFQ1QgKiBGUk9NICgKICAgICMgICAgIFNFTEVDVAogICAgIyAgICAgJ29uX0dUSU4nIGFzIFR5cGVPZlVuaW9uLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZCwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZF9iYXJjb2RlLAogICAgIyAgICAgUlNfYmFyY29kZXMuR1RJTiwKICAgICMgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAjICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSwKICAgICMgICAgIFJTX2JhcmNvZGVzLmlkX3NlcmllcywKICAgICMgICAgIFJTX2JhcmNvZGVzLmlkX3VuaXQsCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmlzX3BsYW4sCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmFwcHJvdmVkCiAgICAjICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKICAgICMgICAgICAgICBMRUZUIEpPSU4gKFNlbGVjdCBSU19iYXJjb2Rlcy5iYXJjb2RlIGFzIEdUSU4sCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCwKICAgICMgICAgICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSwKICAgICMgICAgICAgICBSU19iYXJjb2Rlcy5pZF9zZXJpZXMsCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfdW5pdCBGUk9NIFJTX2JhcmNvZGVzCiAgICAjICAgICAgICAgV0hFUkUgUlNfYmFyY29kZXMuYmFyY29kZT06Z3RpbiBMSU1JVCAxKSBBUyBSU19iYXJjb2RlcwogICAgIyAgICAgICAgIE9OIFRSVUUKICAgICMgICAgICAgICBMRUZUIEpPSU4gUlNfYmFyY29kZXMgYXMgRnVsbEJhcmNvZGUKICAgICMgICAgICAgICBPTiBGdWxsQmFyY29kZS5iYXJjb2RlID0gUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlCiAgICAjCiAgICAjICAgICBXSEVSRSBpZF9kb2MgPSA6aWRfZG9jICBhbmQgUlNfZG9jc19iYXJjb2Rlcy5iYXJjb2RlIExpa2UgJyUnKzpndGluICsgJyUnCiAgICAjCiAgICAjICAgICBVTklPTiBBTEwKICAgICMKICAgICMgICAgIFNFTEVDVAogICAgIyAgICAgJ0Z1bGxNYXRjaCcsCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmlkLAogICAgIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZF9kb2MsCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmJhcmNvZGUsCiAgICAjICAgICBSU19kb2NzX2JhcmNvZGVzLmlkX2JhcmNvZGUsCiAgICAjICAgICBJRk5VTEwoUlNfYmFyY29kZXMuYmFyY29kZSxSU19iYXJjb2Rlc19pbmFjY3VyYXRlLkdUSU4pLAogICAgIyAgICAgSUZOVUxMKFJTX2JhcmNvZGVzLmlkX2dvb2QsUlNfYmFyY29kZXNfaW5hY2N1cmF0ZS5pZF9nb29kKSwKICAgICMgICAgIElGTlVMTChSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSxSU19iYXJjb2Rlc19pbmFjY3VyYXRlLmlkX3Byb3BlcnR5KSwKICAgICMgICAgIElGTlVMTChSU19iYXJjb2Rlcy5pZF9zZXJpZXMsUlNfYmFyY29kZXNfaW5hY2N1cmF0ZS5pZF9zZXJpZXMpLAogICAgIyAgICAgSUZOVUxMKFJTX2JhcmNvZGVzLmlkX3VuaXQsUlNfYmFyY29kZXNfaW5hY2N1cmF0ZS5pZF91bml0KSwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuaXNfcGxhbiwKICAgICMgICAgIFJTX2RvY3NfYmFyY29kZXMuYXBwcm92ZWQKICAgICMgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcwogICAgIyAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcwogICAgIyAgICAgICAgIE9OIFJTX2JhcmNvZGVzLmJhcmNvZGUgPSBSU19kb2NzX2JhcmNvZGVzLmJhcmNvZGUKICAgICMgICAgICAgICBMRUZUIEpPSU4gKFNlbGVjdCBSU19iYXJjb2Rlcy5iYXJjb2RlIGFzIEdUSU4sCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCwKICAgICMgICAgICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSwKICAgICMgICAgICAgICBSU19iYXJjb2Rlcy5pZF9zZXJpZXMsCiAgICAjICAgICAgICAgUlNfYmFyY29kZXMuaWRfdW5pdCBGUk9NIFJTX2JhcmNvZGVzCiAgICAjICAgICAgICAgV0hFUkUgUlNfYmFyY29kZXMuYmFyY29kZSBMaWtlICclJys6Z3RpbiArICclJyBMSU1JVCAxKSBBUyBSU19iYXJjb2Rlc19pbmFjY3VyYXRlCiAgICAjICAgICAgICAgT04gVFJVRQogICAgIyAgICAgICAgIExFRlQgSk9JTiBSU19iYXJjb2RlcyBhcyBGdWxsQmFyY29kZQogICAgIyAgICAgICAgIE9OIEZ1bGxCYXJjb2RlLmJhcmNvZGUgPSBSU19kb2NzX2JhcmNvZGVzLmJhcmNvZGUKICAgICMKICAgICMgICAgIFdIRVJFIGlkX2RvYyA9IDppZF9kb2MgIGFuZCBSU19kb2NzX2JhcmNvZGVzLmJhcmNvZGUgPSA6c2V0X2JhcmNvZGUpCiAgICAjCiAgICAjIE9SREVSICBCWSBUeXBlT2ZVbmlvbgogICAgIyAnJycKICAgIHJldHVybiBxdWVyeQoKCmRlZiBnZXRfYmFyY29kZV9jYXJkKHNldHRpbmdzX2dsb2JhbCk6CiAgICBscyA9IHsiY3VzdG9tY2FyZHMiOiB7CiAgICAgICAgIm9wdGlvbnMiOiB7CiAgICAgICAgICAgICJzZWFyY2hfZW5hYmxlZCI6IEZhbHNlLAogICAgICAgICAgICAic2F2ZV9wb3NpdGlvbiI6IFRydWUKICAgICAgICB9LAogICAgICAgICJsYXlvdXQiOiB7CiAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJ2ZXJ0aWNhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGJhcmNvZGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnZ29vZHNUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIKICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBwaWN0dXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiI0RCNzA5MyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIiNGRkZGRkYiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogImJ0bl90c3QxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FyZENvcm5lclJhZGl1cyI6ICIxNWRwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIH1dfQoKICAgICAgICAgICAgXQogICAgICAgIH19CiAgICB9CiAgICByZXR1cm4gbHMKCgpkZWYgZ2V0X2RvY19iYXJjb2RlX3F1ZXJ5KCk6CiAgICBscyA9ICcnJwogICAgU0VMRUNUCiAgICAiKDAxKSIgfHwgR1RJTiB8fCAiKDIxKSIgfHwgU2VyaWVzIGFzIG1hcmtfY29kZSwKICAgIGFwcHJvdmVkCiAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKICAgIFdoZXJlCiAgICBpZF9kb2MgPSA6aWRfZG9jIEFORAogICAgaWRfZ29vZCA9IDppZF9nb29kIEFORAogICAgaWRfcHJvcGVydHkgPSA6aWRfcHJvcGVydHkgQU5ECiAgICBpZF9zZXJpZXMgPSA6aWRfc2VyaWVzIAogICAgLS1BTkQgIGlkX3VuaXQgPSA6aWRfdW5pdAogJycnCiAgICByZXR1cm4gbHMKCgpkZWYgZ2V0X2RvY19iYXJjb2RlX3F1ZXJ5X25vX1JTX21hcmtjb2RlcygpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIAogICAgaWRfYmFyY29kZSwKICAgIFJTX21hcmtpbmdfY29kZXMubWFya19jb2RlIGFzIG1hcmtfY29kZSwKICAgIGFwcHJvdmVkCiAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMKCiAgICBKT0lOIFJTX21hcmtpbmdfY29kZXMgCiAgICBPTiBSU19tYXJraW5nX2NvZGVzLmlkID0gUlNfZG9jc19iYXJjb2Rlcy5pZF9iYXJjb2RlIEFORAogICAgUlNfbWFya2luZ19jb2Rlcy5pZF9nb29kID0gOmlkX2dvb2QgQU5ECiAgICBSU19tYXJraW5nX2NvZGVzLmlkX3Byb3BlcnR5ID0gOmlkX3Byb3BlcnR5IEFORAogICAgUlNfbWFya2luZ19jb2Rlcy5pZF9zZXJpZXMgPSA6aWRfc2VyaWVzIEFORAogICAgUlNfbWFya2luZ19jb2Rlcy5pZF91bml0ID0gOmlkX3VuaXQgCgogICAgIFdIRVJFIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gOmlkX2RvYyAnJycKCgpkZWYgZ2V0X21hcmtjb2RlX3F1ZXJ5KCk6CiAgICByZXR1cm4gJycnCiAgICBTRUxFQ1QgCiAgICBSU19kb2NzX2JhcmNvZGVzLmlkIGFzIEN1clN0ciwKICAgIFJTX2RvY3NfYmFyY29kZXMuR1RJTiwKICAgIFJTX2RvY3NfYmFyY29kZXMuU2VyaWVzLAogICAgUlNfZG9jc19iYXJjb2Rlcy5hcHByb3ZlZCwKICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfZ29vZCwKICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfcHJvcGVydHkgYXMgaWRfcHJvcGVydHksCiAgICBSU19kb2NzX2JhcmNvZGVzLmlkX3NlcmllcywKICAgIFJTX2RvY3NfYmFyY29kZXMuaWRfdW5pdCwKICAgIFJTX2dvb2RzLm5hbWUgYXMgZ29vZF9uYW1lLAogICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXMsCiAgICBSU19zZXJpZXMubmFtZSBhcyBzZXJpZXMsCiAgICBSU191bml0cy5uYW1lIGFzIHVuaXQsCiAgICBSU19nb29kcy5jb2RlIEFTIGdvb2RfY29kZSwKICAgIFJTX2RvY3NfYmFyY29kZXMuaXNfcGxhbgoKIEZST00gUlNfZG9jc19iYXJjb2RlcyAKCiBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICBPTiBSU19nb29kcy5pZD1SU19kb2NzX2JhcmNvZGVzLmlkX2dvb2QKICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gUlNfZG9jc19iYXJjb2Rlcy5pZF9wcm9wZXJ0eQogICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgT04gUlNfc2VyaWVzLmlkID0gUlNfZG9jc19iYXJjb2Rlcy5pZF9zZXJpZXMKICAgIExFRlQgSk9JTiBSU191bml0cwogICAgT04gUlNfdW5pdHMuaWQ9UlNfZG9jc19iYXJjb2Rlcy5pZF91bml0CgogICAgIFdIRVJFIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gOmlkX2RvYyBBTkQgR1RJTiA9IDpHVElOIEFuZCBTZXJpZXMgPSA6U2VyaWVzJycnCgoKIyAgICAgJycnCiMgICAgIFNFTEVDVAojICAgICBUZW1wX3F1ZXJ5LkN1clN0ciBhcyBDdXJTdHIsCiMgICAgIFRlbXBfcXVlcnkuaWRfYmFyY29kZSwKIyAgICAgVGVtcF9xdWVyeS5tYXJrX2NvZGUsCiMgICAgIFRlbXBfcXVlcnkuYXBwcm92ZWQsCiMgICAgIFRlbXBfcXVlcnkuaWRfZ29vZCwKIyAgICAgVGVtcF9xdWVyeS5pZF9wcm9wZXJ0aWVzIGFzIGlkX3Byb3BlcnR5LAojICAgICBUZW1wX3F1ZXJ5LmlkX3NlcmllcywKIyAgICAgVGVtcF9xdWVyeS5pZF91bml0LAojICAgICBSU19nb29kcy5uYW1lIGFzIGdvb2RfbmFtZSwKIyAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXMsCiMgICAgIFJTX3Nlcmllcy5uYW1lIGFzIHNlcmllcywKIyAgICAgUlNfdW5pdHMubmFtZSBhcyB1bml0LAojICAgICBSU19nb29kcy5jb2RlIEFTIGdvb2RfY29kZSwKIyAgICAgVGVtcF9xdWVyeS5pc19wbGFuCiMKIwojICBGUk9NICgKIyBTRUxFQ1QKIyAgICAgUlNfZG9jc19iYXJjb2Rlcy5pZCBhcyBDdXJTdHIsCiMgICAgIGlkX2JhcmNvZGUsCiMgICAgIFJTX21hcmtpbmdfY29kZXMubWFya19jb2RlLAojICAgICBhcHByb3ZlZCwKIyAgICAgUlNfbWFya2luZ19jb2Rlcy5pZF9nb29kLAojICAgICBSU19tYXJraW5nX2NvZGVzLmlkX3Byb3BlcnR5IGFzIGlkX3Byb3BlcnRpZXMsCiMgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfc2VyaWVzLAojICAgICBSU19tYXJraW5nX2NvZGVzLmlkX3VuaXQsCiMgICAgIFJTX2RvY3NfYmFyY29kZXMuaXNfcGxhbgojCiMgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcwojCiMgICAgIEpPSU4gUlNfbWFya2luZ19jb2RlcwojICAgICBPTiBSU19tYXJraW5nX2NvZGVzLmlkID0gUlNfZG9jc19iYXJjb2Rlcy5pZF9iYXJjb2RlCiMKIyAgICAgIFdIRVJFIFJTX2RvY3NfYmFyY29kZXMuaWRfZG9jID0gOmlkX2RvYyBBTkQgaWRfYmFyY29kZSA9IDppZF9iYXJjb2RlKSBBUyBUZW1wX3F1ZXJ5CiMKIyAgTEVGVCBKT0lOIFJTX2dvb2RzCiMgICAgIE9OIFJTX2dvb2RzLmlkPVRlbXBfcXVlcnkuaWRfZ29vZAojICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwojICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gVGVtcF9xdWVyeS5pZF9wcm9wZXJ0aWVzCiMgICAgIExFRlQgSk9JTiBSU19zZXJpZXMKIyAgICAgT04gUlNfc2VyaWVzLmlkID0gVGVtcF9xdWVyeS5pZF9zZXJpZXMKIyAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiMgICAgIE9OIFJTX3VuaXRzLmlkPVRlbXBfcXVlcnkuaWRfdW5pdAojICAgICAnJycKCgpkZWYgZ2V0X2JhcmNvZGVfcXVlcnkoKSAtPiBzdHI6CiAgICByZXR1cm4gJycnCiAgICBXaXRoIGJhcmMgYXMgKApTRUxFQ1QgCmJhcmNvZGUsCmlkX2dvb2QsClJTX2dvb2RzLnR5cGVfZ29vZCwKaWRfcHJvcGVydHksCmlkX3NlcmllcywKaWRfdW5pdCwKcmF0aW8KIEZST00gUlNfYmFyY29kZXMgCiBMZWZ0IEpvaW4gUlNfZ29vZHMKIE9OIFJTX2JhcmNvZGVzLmlkX2dvb2QgPSBSU19nb29kcy5pZApXSEVSRSBiYXJjb2RlID0gPykKClNlbGVjdCAqIEZyb20gYmFyYwpMZWZ0IEpPSU4gUlNfdHlwZXNfZ29vZHMKT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBiYXJjLnR5cGVfZ29vZAoKJycnCgoKZGVmIGdldF9tYXJrX3F0dHlfY29uZm9ybWl0eSgpOgogICAgcmV0dXJuICcnJwogICAgU0VMRUNUIGlmbnVsbChkb2NfdGFibGUucXR0eV9wbGFuLDApIC0gaWZudWxsKHRtcC5xdHR5X29mX21hcmssMCkgIEZST00gCgogICAgKFNFTEVDVCBxdHR5X3BsYW4KICAgIEZST00gUlNfZG9jc190YWJsZQogICAgV0hFUkUgCiAgICBpZF9kb2MgPSA6aWREb2MgCiAgICBBTkQgaWRfZ29vZCA9IDppZF9nb29kCiAgICBBTkQgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzCiAgICBBTkQgaWRfc2VyaWVzID0gOmlkX3NlcmllcwogICAgKSBBcyBkb2NfdGFibGUgIC0tQU5EIGlkX3VuaXQgPSA6aWRfdW5pdAogICAgICAgTEVGVCBKT0lOIChTRUxFQ1QgQ291bnQoaWRfYmFyY29kZSkgQXMgcXR0eV9vZl9tYXJrCiAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzIAogICAgICAgIFdIRVJFIGlkX2RvYz06aWREb2MgCiAgICAgICAgQU5EIGlkX2JhcmNvZGUgTElrZSA6YmFyY29kZSBBTkQgYXBwcm92ZWQgPSA6YXBwcm92ZWQpIEFzIHRtcAogICAgICAgIE9OIFRSVUUKICAgICcnJwoKCmRlZiBnZXRfcGxhbl9nb29kX2Zyb21fZG9jKCk6CiAgICByZXR1cm4gJycnCgogICAgU0VMRUNUIGlmbnVsbChxdHR5X3BsYW4sMCkgYXMgcXR0eV9wbGFuLAogICAgaWZudWxsKHF0dHksMCkgYXMgcXR0eSwgaWRfZ29vZCwgdXNlX3NlcmllcywgaWQKICAgIEZST00gUlNfZG9jc190YWJsZQogICAgV0hFUkUgCiAgICBpZF9kb2MgPSA6aWREb2MgCiAgICBBTkQgaWRfZ29vZCA9IDppZF9nb29kCiAgICBBTkQgaWRfcHJvcGVydGllcyA9IDppZF9wcm9wZXJ0aWVzCiAgICBBTkQgaWRfc2VyaWVzID0gOmlkX3NlcmllcwogICAgLS1BTkQgaWRfdW5pdCA9IDppZF91bml0CiAgICAnJycKCmRlZiBnZXRfcXR0eV9hZGRfbWFya190ZXh0KCk6CiAgICByZXR1cm4gJycnCiAgICBTRUxFQ1QgUlNfZG9jcy5hZGRfbWFya19zZWxlY3Rpb24gQXMgTWFya2VkLAogICAgVG1wLlF0dHkgCiAgICBmcm9tIFJTX2RvY3MgCiAgICBMZWZ0IEpvaW4gKFNlbGVjdCBTdW0oUlNfZG9jc190YWJsZS5xdHR5X3BsYW4pIGFzIFF0dHkgRnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIFJTX2RvY3NfdGFibGUuaWRfZG9jPSA6aWRfZG9jKSBBcyBUbXAKICAgIE9OIFRydWUKICAgIFdIRVJFIGlkX2RvYyA9IDppZF9kb2MnJycKCgpkZWYgZ2V0X3F0dHlfc3RyaW5nX2NvdW50X3F1ZXJ5KCk6CiAgICByZXR1cm4gJycnCiAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIsCiAgICBzdW0oaWZudWxsKHF0dHlfcGxhbiwwKSkgYXMgcXR0eV9wbGFuCiAgICBmcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jID0gOmlkX2RvYycnJwoKCmRlZiBnZXRfaGF2ZV9tYXJrX2NvZGVzX3F1ZXJ5KCk6ICAjINCX0LDQv9GA0L7RgSDQstC+0LfQstGA0LDRidCw0LXRgiDQutC+0LvQuNGH0LXRgdGC0LLQviDQutC+0LTQvtCyINC80LDRgNC60LjRgNC+0LLQutC4ICLQn9C70LDQvSIgKNGCLtC1LiDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC40Lcg0YPRh9C10YLQvdC+0LkKICAgICMg0YHQuNGB0YLQtdC80YspCiAgICByZXR1cm4gJycnCiAgICBTRUxFQ1QgZGlzdGluY3QgY291bnQoaWQpIGFzIGNvbF9zdHIKICAgIGZyb20gUlNfZG9jc19iYXJjb2RlcyBXaGVyZSBpZF9kb2MgPSA6aWRfZG9jIEFORCBpc19wbGFuID0gOmlzX3BsYW4nJycKCgpkZWYgZ2V0X2RvY3Nfc3RhdF9xdWVyeSgpOgogICAgcmV0dXJuICcnJwogICB3aXRoIHRtcCBhcyAoCiAgICBTZWxlY3QgCiAgICBkb2NfdHlwZSwKICAgIFJTX2RvY3MuaWRfZG9jLAogICAgMSBhcyBkb2NfQ291bnQsCiAgICBpZm51bGwoUlNfZG9jcy5zZW50LDApIGFzIHNlbnQsCiAgICBpZm51bGwodmVyaWZpZWQsMCkgYXMgdmVyaWZpZWQsIAogICAgQ0FTRQogICAgV0hFTiBpZm51bGwodmVyaWZpZWQsMCk9MCBUSEVOIGNvdW50KFJTX2RvY3NfdGFibGUuaWQpCiAgICBlbHNlIDAgRU5EIGFzIGNvdW50X3ZlcmlmaWVkLAogICAgQ0FTRQogICAgV0hFTiBpZm51bGwodmVyaWZpZWQsMCk9MSBUSEVOIGNvdW50KFJTX2RvY3NfdGFibGUuaWQpCiAgICBlbHNlIDAgRU5EIGFzIGNvdW50X3VudmVyaWZpZWQsCiAgICBDQVNFCiAgICAgICAgV0hFTiBpZm51bGwodmVyaWZpZWQsMCk9MCBUSEVOIHN1bShSU19kb2NzX3RhYmxlLnF0dHlfcGxhbikKICAgIGVsc2UgMCBFTkQgYXMgcXR0eV9wbGFuX3ZlcmlmaWVkLAogICAgQ0FTRQogICAgICAgIFdIRU4gaWZudWxsKHZlcmlmaWVkLDApPTEgVEhFTiBzdW0oUlNfZG9jc190YWJsZS5xdHR5X3BsYW4pCiAgICBlbHNlIDAgRU5EIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICAgZnJvbSBSU19kb2NzCiAgICBMZWZ0IEpvaW4gUlNfZG9jc190YWJsZSAKICAgIE9OIFJTX2RvY3NfdGFibGUuaWRfZG9jID0gUlNfZG9jcy5pZF9kb2MKICAgIEdyb3VwIGJ5IFJTX2RvY3MuaWRfZG9jCiAgICApCiAgIFNlbGVjdCBkb2NfdHlwZSBhcyBkb2NUeXBlLCAKICAgY291bnQoaWRfZG9jKSwKICAgc3VtKGRvY19Db3VudCkgYXMgY291bnQsIAogICBzdW0oc2VudCkgYXMgc2VudCwgCiAgIHN1bSh2ZXJpZmllZCkgYXMgdmVyaWZpZWQsCiAgIHN1bShjb3VudF92ZXJpZmllZCkgYXMgY291bnRfdmVyaWZpZWQsCiAgIHN1bShjb3VudF91bnZlcmlmaWVkKSBhcyBjb3VudF91bnZlcmlmaWVkLAogICBzdW0ocXR0eV9wbGFuX3ZlcmlmaWVkKSBhcyBxdHR5X3BsYW5fdmVyaWZpZWQsCiAgIHN1bShxdHR5X3BsYW5fdW52ZXJpZmllZCkgYXMgcXR0eV9wbGFuX3VudmVyaWZpZWQKICAgIGZyb20gdG1wCiAgICBncm91cCBieSBkb2NfdHlwZQogICAnJycKCgpkZWYgZ2V0X2RvY190aWxlcyhzZXR0aW5nc19nbG9iYWwpOgoKICAgIHNtYWxsX3RpbGUgPSB7CiAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAib3JpZW50YXRpb24iOiAidmVydGljYWwiLAogICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAiYXV0b1NpemVUZXh0VHlwZSIgOiAidW5pZm9ybSIsCiAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgIlZhbHVlIjogIkBkb2NOYW1lIiwKICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSwgIyAiMjUiLAogICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIjMDAwMDAwIiwKICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgIlRleHRJdGFsaWMiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiIiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6IDAsCiAgICAgICAgICAgICAgICAiZ3Jhdml0eV9ob3Jpem9udGFsIjogImNlbnRlciIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInR5cGUiOiAiTGluZWFyTGF5b3V0IiwKICAgICAgICAgICAgICAgICJvcmllbnRhdGlvbiI6ICJob3Jpem9udGFsIiwKICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgIndlaWdodCI6ICIxIiwKICAgICAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIlRleHRWaWV3IiwKICAgICAgICAgICAgICAgICAgICAgICAgInNob3dfYnlfY29uZGl0aW9uIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYWx1ZSI6ICJAUXR0eU9mRG9jcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIjMzMzMzMzIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiRkZDQzk5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAi0KHRgtGA0L7QujogIiwKICAgICAgICAgICAgICAgICAgICAgICAgIk5vUmVmcmVzaCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiZG9jdW1lbnRfdHlwZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAibWFzayI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRTaXplIjogc2V0dGluZ3NfZ2xvYmFsLmdldCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScpLCAjIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIjMzMzMzMzIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiRkZDQzk5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBjb3VudF92ZXJpZmllZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIjMzMzMzMzIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiRkZDQzk5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAiMSIsCiAgICAgICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJUZXh0VmlldyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzaG93X2J5X2NvbmRpdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAi0KLQvtCy0LDRgNC+0LI6ICIsCiAgICAgICAgICAgICAgICAgICAgICAgICJOb1JlZnJlc2giOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgImRvY3VtZW50X3R5cGUiOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIm1hc2siOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0U2l6ZSI6IHNldHRpbmdzX2dsb2JhbC5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRDb2xvciI6ICIjMzMzMzMzIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlRleHRCb2xkIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0SXRhbGljIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJCYWNrZ3JvdW5kQ29sb3IiOiAiRkZDQzk5IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiVGV4dFZpZXciLAogICAgICAgICAgICAgICAgICAgICAgICAic2hvd19ieV9jb25kaXRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBxdHR5X3BsYW5fdmVyaWZpZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAiTm9SZWZyZXNoIjogRmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJkb2N1bWVudF90eXBlIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJtYXNrIjogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dFNpemUiOiBzZXR0aW5nc19nbG9iYWwuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Q29sb3IiOiAiIzMzMzMzMyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJUZXh0Qm9sZCI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiVGV4dEl0YWxpYyI6IEZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAiQmFja2dyb3VuZENvbG9yIjogIkZGQ0M5OSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CgogICAgICAgIF0KICAgIH0KCiAgICByZXR1cm4gc21hbGxfdGlsZQoKY2xhc3MgTW9kZXJuRmllbGQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGludD1Ob25lLCBkZWZhdWx0X3RleHQ9Tm9uZSwgcGFzc3dvcmQ9RmFsc2UpOiAgIyBjb3VudGVyPUZhbHNlLCBjb3VudGVyX21heD1Ob25lLCBpbnB1dF90eXBlPSAxICwKICAgICAgICBzZWxmLmhpbnQgPSBoaW50CiAgICAgICAgc2VsZi5kZWZhdWx0X3RleHQgPSBkZWZhdWx0X3RleHQKICAgICAgICAjc2VsZi5jb3VudGVyID0gY291bnRlcgogICAgICAgICNzZWxmLmNvdW50ZXJfbWF4ID0gY291bnRlcl9tYXgKICAgICAgICAjc2VsZi5pbnB1dF90eXBlID0gaW5wdXRfdHlwZQogICAgICAgIHNlbGYucGFzc3dvcmQgPSBwYXNzd29yZAoKICAgIGRlZiB0b19qc29uKHNlbGYpOgogICAgICAgIHJldCA9IHsKICAgICAgICAgICAgImhpbnQiOiBzZWxmLmhpbnQsCiAgICAgICAgICAgICJkZWZhdWx0X3RleHQiOiBzZWxmLmRlZmF1bHRfdGV4dH0KICAgICAgICAjICJjb3VudGVyIjogc2VsZi5jb3VudGVyLAogICAgICAgICMgImNvdW50ZXJfbWF4Ijogc2VsZi5jb3VudGVyX21heCwKICAgICAgICAjICJpbnB1dF90eXBlIjogc2VsZi5pbnB1dF90eXBlLAogICAgICAgIGlmIHNlbGYucGFzc3dvcmQ6CiAgICAgICAgICAgIHJldFsicGFzc3dvcmQiXSA9IHNlbGYucGFzc3dvcmQKCiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMocmV0KQoKCiMgaHR0cF9zZXR0aW5ncyA9IHsndXJsJzonMTkyJywgJ3VzZXInOidBTUQnLCAncGFzcyc6JzEyMyd9CiMgcHJpbnQoTW9kZXJuRmllbGQoaGludD0ndXJsJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VybCddLCBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKQojIHByaW50KE1vZGVybkZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXNlciddLCBwYXNzd29yZD1GYWxzZSkudG9fanNvbigpKQojIHByaW50KE1vZGVybkZpZWxkKGhpbnQ9J3Bhc3MnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sncGFzcyddLCBwYXNzd29yZD1UcnVlKS50b19qc29uKCkp"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_global.py",
                "PyFileKey": "ui_global",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKaW1wb3J0IGNvbGxlY3Rpb25zCmltcG9ydCBzcWxpdGUzCmZyb20gc3FsaXRlMyBpbXBvcnQgRXJyb3IKaW1wb3J0IHVpX2JhcmNvZGVzCmltcG9ydCBvcwppbXBvcnQgdWlfZm9ybV9kYXRhCmltcG9ydCBxdWV1ZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZWRlbHRhCgoKcXVlcnlfbGlzdCA9IHF1ZXVlLlF1ZXVlKCkKIyDQktC+0YIg0YLQsNC60LjQvCDQvdC10LfQsNGC0LXQudC70LjQstGL0Lwg0LzQtdGC0L7QtNC+0Lwg0L7Qv9GA0LXQtNC10LvRj9C10LwsINC80Ysg0LfQsNC/0YPRgdGC0LjQu9C40YHRjCDQvdCwINC60L7QvNC/0LUg0LjQu9C4INC90LAg0KLQodCUICoqCiMg0J3RgyDQuCDQsiDQt9Cw0LLQuNGB0LjQvNC+0YHRgtC4INC+0YIsINC40YHQv9C+0LvRjNC30YPQtdC8INCx0LDQt9GDICoqKioKaWYgb3MucGF0aC5leGlzdHMoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy8nKTogI9C70L7QutCw0LvRjNC90L4KICAgIGRiX3BhdGggPSAnLy9kYXRhL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvZGF0YWJhc2VzL1NpbXBsZUtlZXAnICAjIHJpZ2h0c2NhbicKZWxzZToKICAgIGRiX3BhdGggPSBmaWxlX2Fic19wYXRoID0gb3MucGF0aC5hYnNwYXRoKCcuL1NpbXBsZUtlZXAuZGInKSAgIyBEOlxQeXRob25Qcm9qZWN0c1xSaWdodFNjYW5cU1VJX25vUG9ueVwKCmNvbm4gPSBOb25lCgoKCmRlZiBmaW5kX2JhcmNvZGVfaW5fbWFya2luZ19jb2Rlc190YWJsZShzZWxmLCBzdHJ1Y3RfYmFyY29kZTogbGlzdCk6CiAgICAiIiLQpNGD0L3QutGG0LjRjyDQv9C+0LvRg9GH0LDQtdGCINGB0YLRgNC+0LrQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQtNC+0LrRg9C80LXQvdGC0LAg0L/QviDQt9C90LDRh9C10L3QuNGOINC80LDRgNC60LjRgNC+0LLQutC4IiIiCgogICAgcXVlcnlfdGV4dCA9IHVpX2Zvcm1fZGF0YS5nZXRfcXVlcnlfbWFya19maW5kX2luX2RvYygpCiAgICBhcmdzX2RpY3QgPSB7fQogICAgYXJnc19kaWN0WydHVElOJ10gPSBzdHJ1Y3RfYmFyY29kZVsnR1RJTiddCiAgICBhcmdzX2RpY3RbJ1NlcmllcyddID0gc3RydWN0X2JhcmNvZGVbJ1NFUklBTCddCiAgICBhcmdzX2RpY3RbJ2lkX2RvYyddID0gc2VsZi5pZF9kb2MKCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfZGljdCwgVHJ1ZSkKICAgIHJldHVybiByZXMKCgpkZWYgZmluZF9iYXJjb2RlX2luX2JhcmNvZGVfdGFibGUoYmFyY29kZTogc3RyKToKICAgIHF1ZXJ5X3RleHQgPSB1aV9mb3JtX2RhdGEuZ2V0X2JhcmNvZGVfcXVlcnkoKQogICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCAoYmFyY29kZSwpLCBUcnVlKQogICAgcmV0dXJuIHJlcwoKCmRlZiBjaGVja19iYXJjb2RlX2NvbXBsaWFuY2UoZWxfZGljdDogZGljdCwgaWRfZG9jKToKICAgICIiIiAxINCi0LDQutC+0Lkg0YLQvtCy0LDRgCDQsiDQv9GA0LjQvdGG0LjQv9C1INC10YHRgtGMINCyINC00L7QutGD0LzQtdC90YLQtSAiIiIKCiAgICBxdWVyeV90ZXh0ID0gdWlfZm9ybV9kYXRhLmdldF9wbGFuX2dvb2RfZnJvbV9kb2MoKQogICAgYXJnc19kaWN0ID0ge30KICAgIGFyZ3NfZGljdFsnaWREb2MnXSA9IGlkX2RvYwogICAgYXJnc19kaWN0WydpZF9nb29kJ10gPSBlbF9kaWN0WydpZF9nb29kJ10KICAgIGFyZ3NfZGljdFsnaWRfcHJvcGVydGllcyddID0gZWxfZGljdFsnaWRfcHJvcGVydHknXQogICAgYXJnc19kaWN0WydpZF9zZXJpZXMnXSA9IGVsX2RpY3RbJ2lkX3NlcmllcyddCiAgICAjYXJnc19kaWN0WydpZF91bml0J10gPSBlbF9kaWN0WydpZF91bml0J10KCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfZGljdCwgVHJ1ZSkKCiAgICByZXR1cm4gcmVzCgoKZGVmIGNoZWNrX2Fkcl9iYXJjb2RlX2NvbXBsaWFuY2UoZWxfZGljdDogZGljdCwgaWRfZG9jKToKICAgICIiIiAxINCi0LDQutC+0Lkg0YLQvtCy0LDRgCDQsiDQv9GA0LjQvdGG0LjQv9C1INC10YHRgtGMINCyINC00L7QutGD0LzQtdC90YLQtSAiIiIKCiAgICBxdWVyeV90ZXh0ID0gICcnJwogICAgU0VMRUNUIGlmbnVsbChxdHR5X3BsYW4sMCkgYXMgcXR0eV9wbGFuLAogICAgaWZudWxsKHF0dHksMCkgYXMgcXR0eSwgaWRfZ29vZCwgaWRfY2VsbCwgaWQsIHVzZV9zZXJpZXMKICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUKICAgIFdIRVJFIAogICAgaWRfZG9jID0gOmlkRG9jIAogICAgQU5EIGlkX2dvb2QgPSA6aWRfZ29vZAogICAgQU5EIGlkX3Byb3BlcnRpZXMgPSA6aWRfcHJvcGVydGllcwogICAgQU5EIGlkX3NlcmllcyA9IDppZF9zZXJpZXMKICAgIEFORCBpZF9jZWxsID0gOmlkX2NlbGwgb3IgaWRfY2VsbCA9ICIiIE9SIGlkX2NlbGwgaXMgTnVsbAogICAgJycnCiAgICBhcmdzX2RpY3QgPSB7fQogICAgYXJnc19kaWN0WydpZERvYyddID0gaWRfZG9jCiAgICBhcmdzX2RpY3RbJ2lkX2dvb2QnXSA9IGVsX2RpY3RbJ2lkX2dvb2QnXQogICAgYXJnc19kaWN0WydpZF9wcm9wZXJ0aWVzJ10gPSBlbF9kaWN0WydpZF9wcm9wZXJ0eSddCiAgICBhcmdzX2RpY3RbJ2lkX3NlcmllcyddID0gZWxfZGljdFsnaWRfc2VyaWVzJ10KICAgIGFyZ3NfZGljdFsnaWRfY2VsbCddID0gZWxfZGljdFsnaWRfY2VsbCddCiAgICAjYXJnc19kaWN0WydpZF91bml0J10gPSBlbF9kaWN0WydpZF91bml0J10KCiAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIGFyZ3NfZGljdCwgVHJ1ZSkKCiAgICByZXR1cm4gcmVzCiMKCgpkZWYgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0OiBzdHIsIGFyZ3MgPSAiIiwgcmV0dXJuX2RpY3Q9RmFsc2UpIC0+IGxpc3Q6CiAgICAjICoqKioqKioqKioqKioqKioqKioqKioKCiAgICAjIGdsb2JhbCBjb25uCiAgICAjIGdldF9kYXRhYmFzZV9jb25uZWN0aW9uKCkKICAgIHRyeToKICAgICAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KGRiX3BhdGgpCgogICAgZXhjZXB0IEVycm9yOgoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBpZiBhcmdzOgogICAgICAgICAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5X3RleHQpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgZQoKICAgICMg0JXRgdC70Lgg0L3QsNC00L4gLSDQstC+0LfQstGA0LDRidCw0LXQvCDQvdC1INGA0LXQt9GD0LvRjNGC0LDRgiDQt9Cw0L/RgNC+0YHQsCwg0LAg0YHQu9C+0LLQsNGA0Ywg0YEg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNC90L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtC+0LwKICAgIGlmIHJldHVybl9kaWN0OgogICAgICAgIHJlcyA9IFtkaWN0KGxpbmUpIGZvciBsaW5lIGluCiAgICAgICAgICAgICAgIFt6aXAoW2NvbHVtblswXSBmb3IgY29sdW1uIGluIGN1cnNvci5kZXNjcmlwdGlvbl0sIHJvdykgZm9yIHJvdyBpbiBjdXJzb3IuZmV0Y2hhbGwoKV1dCiAgICBlbHNlOgogICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjb25uLmNvbW1pdCgpCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCgpkZWYgZXhlY3V0ZV9zY3JpcHQocXVlcnlfdGV4dCk6CiAgICAjIGdsb2JhbCBjb25uICAjID0gTm9uZQogICAgIyBnZXRfZGF0YWJhc2VfY29ubmVjdGlvbigpCiAgICB0cnk6CiAgICAgICAgY29ubiA9IHNxbGl0ZTMuY29ubmVjdChkYl9wYXRoKQoKICAgIGV4Y2VwdCBFcnJvcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBjdXJzb3IuZXhlY3V0ZXNjcmlwdChxdWVyeV90ZXh0KQogICAgICAgIGNvbm4uY29tbWl0KCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yIGFzIGVyOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZXIpCiAgICBjb25uLmNsb3NlKCkKCgpkZWYgYnVsa19xdWVyeV9yZXBsYWNlKHF1ZXJ5X3RleHQ6IHN0ciwgYXJnczogb2JqZWN0ID0gIiIpIC0+IG9iamVjdDoKICAgICMgKioqKioqKioqKioqKioqKioqKioqKgogICAgIyBnbG9iYWwgY29ubgogICAgIyBnZXRfZGF0YWJhc2VfY29ubmVjdGlvbigpCiAgICBjb25uID0gTm9uZQogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKCiAgICBleGNlcHQgRXJyb3I6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcignTm8gY29ubmVjdGlvbiB3aXRoIGRhdGFiYXNlJykKCiAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICB0cnk6CiAgICAgICAgaWYgYXJnczoKICAgICAgICAgICAgY3Vyc29yLmV4ZWN1dGVtYW55KHF1ZXJ5X3RleHQsIGFyZ3MpCgogICAgICAgIGNvbm4uY29tbWl0KCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yIGFzIGVyOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZXIpCgogICAgcmVzID0gY3Vyc29yLmZldGNoYWxsKCkKCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCgpkZWYgYnVsa19xdWVyeShxOiBzdHIsIGFyZ3M6IExpc3RbdHVwbGVdKToKICAgIHRyeToKICAgICAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KGRiX3BhdGgpCiAgICBleGNlcHQgc3FsaXRlMy5FcnJvcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKCiAgICB0cnk6CiAgICAgICAgY3Vyc29yLmV4ZWN1dGVtYW55KHEsIGFyZ3MpCiAgICAgICAgY29ubi5jb21taXQoKQogICAgZXhjZXB0IHNxbGl0ZTMuRXJyb3IgYXMgZXI6CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihlcikKCiAgICBjb25uLmNsb3NlKCkKCmRlZiBnZXRfbmFtZV9saXN0KHN0cl9lbnR0eSk6CiAgICBxdWVyeSA9ICJTRUxFQ1QgbmFtZSBGUk9NICIgKyBzdHJfZW50dHkKICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnkpCiAgICBsaXN0X2VsID0gW10KICAgICMgbGlzdF9lbC5hcHBlbmQobmFtZSBmb3IgbmFtZSBpbiByZXMpCiAgICBmb3IgZWwgaW4gcmVzOgogICAgICAgIGxpc3RfZWwuYXBwZW5kKGVsWzBdKQogICAgcmV0dXJuICI7Ii5qb2luKGxpc3RfZWwpCgoKZGVmIGdldF9ieV9uYW1lKGZsZCwgdGFibGUpOgogICAgcXVlcnkgPSAiU0VMRUNUIGlkIEZST00gIiArIHRhYmxlICsgJyBXSEVSRSBuYW1lID0gPycKICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnksIChmbGQsKSkKCiAgICBpZiBsZW4ocmVzKSA9PSAwOgogICAgICAgIHJldHVybiAiIgogICAgZWxzZToKICAgICAgICByZXR1cm4gcmVzWzBdWzBdCgoKZGVmIElkX3RvX0hFWChndWlkKToKICAgIHgxID0gZ3VpZFsxOToyM10KICAgIHgyID0gZ3VpZFsyNDogMzZdCiAgICB4MyA9IGd1aWRbMTQ6IDE4XQogICAgeDQgPSBndWlkWzk6MTNdCiAgICB4NSA9IGd1aWRbMDogOF0KCiAgICBzdHJfZ3VpZCA9IHgxICsgeDIgKyB4MyArIHg0ICsgeDUKICAgIHJldHVybiBpbnQoc3RyX2d1aWQsIDE2KQoKIwpjbGFzcyBSc19kb2MoKToKICAgIGlkX2RvYyA9ICcnICAjIHN0cikKICAgIGlkX3N0ciA9ICcnICAjIHN0cikKICAgIHF0dHkgPSAnJyAgIyBzdHIpCgogICAgZGVmIHVwZGF0ZV9kb2Nfc3RyKHNlbGYsIHByaWNlPTApOgogICAgICAgIHF1ZXJ5ID0gIiIiCiAgICAgICAgVVBEQVRFIFJTX2RvY3NfdGFibGUKICAgICAgICBTRVQgcXR0eT0/LCBwcmljZT0/CiAgICAgICAgV2hlcmUgaWQ9PyAiIiIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoc2VsZi5xdHR5LCBwcmljZSwgc2VsZi5pZF9zdHIpKQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgZGVsZXRlX2RvYyhzZWxmKToKICAgICAgICBxdWVyeV9kb2NfdGFibGUgPSAnREVMRVRFIEZST00gUlNfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jX3RhYmxlLCAoc2VsZi5pZF9kb2MsKSkKICAgICAgICBxdWVyeV9kb2NfdGFibGUgPSAnREVMRVRFIEZST00gUlNfZG9jc19iYXJjb2RlcyBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jX3RhYmxlLCAoc2VsZi5pZF9kb2MsKSkKICAgICAgICBxdWVyeV9kb2MgPSAnREVMRVRFIEZST00gUlNfZG9jcyBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jLCAoc2VsZi5pZF9kb2MsKSkKCiAgICAgICAgcmV0dXJuIHJlcwogICAgZGVmIGNsZWFyX2JhcmNvZGVfZGF0YShzZWxmKToKICAgICAgICBxdWVyeV90ZXh0ID0gKCdVcGRhdGUgUlNfZG9jc19iYXJjb2RlcyBTZXQgYXBwcm92ZWQgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAnRGVsZXRlIEZyb20gUlNfZG9jc19iYXJjb2RlcyBXaGVyZSAgaWRfZG9jPTppZF9kb2MgQW5kIGlzX3BsYW4gPSAwJywKICAgICAgICAnVXBkYXRlIFJTX2RvY3NfdGFibGUgU2V0IHF0dHkgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAnRGVsZXRlIEZyb20gUlNfZG9jc190YWJsZSBXaGVyZSBpZF9kb2M9OmlkX2RvYyBhbmQgaXNfcGxhbiA9ICJGYWxzZSInKQogICAgICAgIGZvciBlbCBpbiBxdWVyeV90ZXh0OgogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsLCAoeydpZF9kb2MnOnNlbGYuaWRfZG9jfSkpCgogICAgZGVmIG1hcmtfZm9yX3VwbG9hZChzZWxmKToKICAgICAgICBxdWVyeSA9ICIiIgogICAgICAgIFVQREFURSBSU19kb2NzX3RhYmxlCiAgICAgICAgU0VUIHNlbnQ9MQogICAgICAgIFdoZXJlIGlkPT8gIiIiCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKHNlbGYuaWRfZG9jKSkKCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBtYXJrX3ZlcmlmaWVkKHNlbGYsIGtleSk6CiAgICAgICAgcXVlcnkgPSAiIiIKICAgICAgICAgICAgICAgIFVQREFURSBSU19kb2NzCiAgICAgICAgICAgICAgICBTRVQgdmVyaWZpZWQ9PwogICAgICAgICAgICAgICAgV2hlcmUgaWRfZG9jPT8gIiIiCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGludChrZXkpLCBzZWxmLmlkX2RvYykpCgogICAgZGVmIGZpbmRfYmFyY29kZV9pbl90YWJsZShzZWxmLCBzZWFyY2hfdmFsdWU6IHN0ciwgZnVuY19jb21wYXJlZD0nPT8nKSAtPiBsaXN0OgoKICAgICAgICBxdWVyeSA9ICcnJwogICAgICAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QsCiAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX3VuaXQsCiAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZCwKICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLnF0dHkgICAgICAgIAogICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMKICAgICAgICAgICAgICAgICBMZWZ0IGpvaW4gUlNfZG9jc190YWJsZSBPTgogICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZD0gUlNfYmFyY29kZXMuaWRfZ29vZCBhbmQKICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXM9IFJTX2JhcmNvZGVzLmlkX3Byb3BlcnR5IGFuZAogICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdD0gUlNfYmFyY29kZXMuaWRfdW5pdCBBbmQKICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2RvYz0/CiAgICAgICAgICAgICAgICAgd2hlcmUgYmFyY29kZSAnJycgKyBmdW5jX2NvbXBhcmVkCiAgICAgICAgIyBxdWVyeSA9IHF1ZXJ5ICsgZnVuY19jb21wYXJlZAoKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKHNlbGYuaWRfZG9jLCBzZWFyY2hfdmFsdWUpLCBUcnVlKQoKICAgIGRlZiBmaW5kX2JhcmNvZGVfaW5fbWFya190YWJsZShzZWxmLCBzZWFyY2hfdmFsdWU6IHN0ciwgZnVuY19jb21wYXJlZD0nPT8nKSAtPiBvYmplY3Q6CiAgICAgICAgcXVlcnkgPSAnJycKICAgICAgICAgICAgICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfbWFya2luZ19jb2Rlcy5pZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfbWFya2luZ19jb2Rlcy5pZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX21hcmtpbmdfY29kZXMuaWRfdW5pdCwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19tYXJraW5nX2NvZGVzCiAgICAgICAgICAgICAgICAgICAgICAgIExlZnQgam9pbiBSU19kb2NzX3RhYmxlIE9OCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZD0gUlNfbWFya2luZ19jb2Rlcy5pZF9nb29kIGFuZAogICAgICAgICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXM9IFJTX21hcmtpbmdfY29kZXMuaWRfcHJvcGVydHkgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdD0gUlNfbWFya2luZ19jb2Rlcy5pZF91bml0IEFuZAogICAgICAgICAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2RvYz0/CiAgICAgICAgICAgICAgICAgICAgICAgIHdoZXJlIG1hcmtfY29kZSAgJycnICsgZnVuY19jb21wYXJlZAogICAgICAgICMgcXVlcnkgPSBxdWVyeSArIGZ1bmNfY29tcGFyZWQKCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocXVlcnksIChzZWxmLmlkX2RvYywgc2VhcmNoX3ZhbHVlKSwgVHJ1ZSkKCiAgICBkZWYgdXBkYXRlX2RvY190YWJsZV9kYXRhKHNlbGYsIGVsZW1fZm9yX2FkZDogZGljdCwgcXR0eT0xLCB1c2VyX3Rtej0wKToKCiAgICAgICAgIyDQodC90LDRh9Cw0LvQsCDQvtC/0YDQtdC00LXQu9C40LwsINC10YHRgtGMINC70Lgg0LIg0YHQv9C40YHQutC1INGC0L7QstCw0YDQvtCyINC00L7QutGD0LzQtdC90YLQsCDQvdCw0Ygg0YLQvtCy0LDRgDoKICAgICAgICBxdGV4dCA9ICdTZWxlY3QgKiBmcm9tIFJTX2RvY3NfdGFibGUgV2hlcmUgaWRfZG9jPT8gYW5kIGlkX2dvb2QgPSA/IGFuZCBpZF9wcm9wZXJ0aWVzID0gPyBhbmQgaWRfc2VyaWVzID0gPyAnICNhbmQgaWRfdW5pdCA9ID8KICAgICAgICBhcmdzID0gKHNlbGYuaWRfZG9jLCBlbGVtX2Zvcl9hZGRbJ2lkX2dvb2QnXSwgZWxlbV9mb3JfYWRkWydpZF9wcm9wZXJ0eSddLCBlbGVtX2Zvcl9hZGRbJ2lkX3NlcmllcyddKSAjLGVsZW1fZm9yX2FkZFsnaWRfdW5pdCddCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgYXJncywgVHJ1ZSkKICAgICAgICBpZiByZXM6ICAjINCd0LDRiNC70Lgg0YHRgtGA0L7QutC4INC00L7QutGD0LzQtdC90YLQsCwg0LTQvtCx0LDQstC70Y/QtdC8INC60L7Qu9C40YfQtdGB0YLQstC+CgogICAgICAgICAgICBlbCA9IHJlc1swXQogICAgICAgICAgICAjIGlmIGVsWydxdHR5J10rcXR0eSA9PSAwOgogICAgICAgICAgICAjICAgICBxdGV4dCA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3RhYmxlICBXSEVSRSBpZCA9ID8nCiAgICAgICAgICAgICMgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQsIChlbFsnaWQnXSwpKQogICAgICAgICAgICAjIGVsc2U6CiAgICAgICAgICAgIHF0ZXh0ID0gJ1VQREFURSBSU19kb2NzX3RhYmxlIFNFVCBxdHR5PXF0dHkrPywgbGFzdF91cGRhdGVkID0gPywgc2VudCA9IDAgV0hFUkUgaWQgPSA/JwogICAgICAgICAgICBjdXJyZW50X3RpbWVfdXRjXzAgPSAoZGF0ZXRpbWUubm93KCkgLSB0aW1lZGVsdGEoaG91cnM9dXNlcl90bXopKS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiKQogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAocXR0eSwgY3VycmVudF90aW1lX3V0Y18wLCBlbFsnaWQnXSkpCiAgICAgICAgZWxzZTogICMg0KLQsNC60L7QuSDRgdGC0YDQvtC60Lgg0L3QtdGCLCDQvdCw0LTQviDQtNC+0LHQsNCy0LjRgtGMCiAgICAgICAgICAgIGN1cnJlbnRfdGltZV91dGNfMCA9IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz11c2VyX3RteikpLnN0cmZ0aW1lKCIlWS0lbS0lZCAlSDolTTolUyIpCiAgICAgICAgICAgIHF0ZXh0ID0gJ1JFUExBQ0UgSU5UTyBSU19kb2NzX3RhYmxlKGlkX2RvYywgaWRfZ29vZCwgaWRfcHJvcGVydGllcyxpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHByaWNlLCBpZF9wcmljZSwgaXNfcGxhbiwgc2VudCwgbGFzdF91cGRhdGVkKSBWQUxVRVMgKD8sPyw/LD8sPyw/LD8sPyw/LD8sPyknCiAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQsICgKICAgICAgICAgICAgICAgIHNlbGYuaWRfZG9jLCBlbGVtX2Zvcl9hZGRbJ2lkX2dvb2QnXSwgZWxlbV9mb3JfYWRkWydpZF9wcm9wZXJ0eSddLCBlbGVtX2Zvcl9hZGRbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAgICAgZWxlbV9mb3JfYWRkLmdldCgnaWRfdW5pdCcpLCBxdHR5LCAwLCAnJywgJ0ZhbHNlJywgMCwgY3VycmVudF90aW1lX3V0Y18wKSkKCiAgICAgICAgcmV0dXJuIHJlcwoKICAgICMg0KTRg9C90LrRhtC40Y8g0LTQvtCx0LDQstC70Y/QtdGCINGB0YLRgNC+0LrRgyDQsiDQvNCw0YDQutC40YDQvtCy0LrRgyDQtNC+0LrRg9C80LXQvdGC0LAg0L3QsCDQvtGB0L3QvtCy0LDQvdC40Lgg0LHQsNGA0LrQvtC00LAgKGRhdGFNYXRyaXgpCiAgICBkZWYgYWRkX21hcmtlZF9jb2Rlc19pbl9kb2Moc2VsZiwgYmFyY29kZV9pbmZvKToKICAgICAgICBxdGV4dCA9ICdTRUxFQ1QgKiBGUk9NIFJTX21hcmtpbmdfY29kZXMgV2hlcmUgbWFya19jb2RlID0/JwogICAgICAgIHFfZG9jX3RleHQgPSAnUkVQTEFDRSBJTlRPIFJTX2RvY3NfYmFyY29kZXMgKGlkX2RvYywgaWRfYmFyY29kZSwgYmFyY29kZV9mcm9tX3NjYW5uZXIsIGlzX3BsYW4sIGFwcHJvdmVkKSBWQUxVRVMgKD8sPyw/LD8sPyknCiAgICAgICAgIyDQmNGJ0LXQvCDQutC+0LQg0LzQsNGA0LrQuNGA0L7QstC60Lgg0LIg0YLQsNCx0LvQuNGG0LUgUlNfbWFya2luZ19jb2RlcyDQv9C+IEdUSU4g0LggU0VSSUFMCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKCcwMScgKyBiYXJjb2RlX2luZm9bJ0dUSU4nXSArICcyMScgKyBiYXJjb2RlX2luZm9bJ1NFUklBTCddLCksIFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICAjINCd0LDRiNC70Lgg0YLQsNC60L7QuSDQsdCw0YDQutC+0LQg0LIg0YHQv9C40YHQutC1INC80LDRgNC60LjRgNC+0LLQutC4LCDQt9Cw0L/QvtC70L3Rj9C10Lwg0YHRgtGA0L7QutGDINC80LDRgNC60LjRgNC+0LLQutC4INC00L7QutGD0LzQtdC90YLQsAoKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxX2RvY190ZXh0LCAoc2VsZi5pZF9kb2MsIHJlc1swXVsnaWQnXSwgYmFyY29kZV9pbmZvWydGdWxsQmFyY29kZSddLCAnMCcsICcxJyksIFRydWUpCiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOiAgIyDQndC1INC90LDRiNC70LggLSDQv9GA0L7QsdGD0LXQvCDQuNGB0LrQsNGC0Ywg0L/QviBHVElOINCyINGC0LDQsdC70LjRhtC1INCx0LDRgNC60L7QtNC+0LIKICAgICAgICAgICAgcmVzID0gc2VsZi5maW5kX2JhcmNvZGVfaW5fbWFya190YWJsZShzZWxmLCAnMDEnICsgYmFyY29kZV9pbmZvWydHVElOJ10gKyAnJScsICdMaWtlID8nKQogICAgICAgICAgICBpZiByZXM6ICAjINCd0LDRiNC70Lgg0L/QviBHVElOLCDQt9Cw0L/QvtC70L3Rj9C10Lwg0LTQvtC60YPQvNC10L3RggogICAgICAgICAgICAgICAgZWwgPSByZXNbMF0KICAgICAgICAgICAgICAgICMg0KHQvdCw0YfQsNC70LAg0LfQsNC/0L7Qu9C90LjQvCDRgtCw0LHQu9C40YbRgyBSU19tYXJraW5nX2NvZGVzCiAgICAgICAgICAgICAgICBxdGV4dCA9ICdSRVBMQUNFIElOVE8gUlNfbWFya2luZ19jb2RlcyAoaWQsIG1hcmtfY29kZSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3NlcmllcywgaWRfdW5pdCkgVkFMVUVTICg/LD8sPyw/LD8sPyknCiAgICAgICAgICAgICAgICBtYXJrX2NvZGUgPSAnMDEnICsgYmFyY29kZV9pbmZvWydHVElOJ10gKyAnMjEnICsgYmFyY29kZV9pbmZvWydTRVJJQUwnXQogICAgICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKAogICAgICAgICAgICAgICAgICAgIG1hcmtfY29kZSwgbWFya19jb2RlLCBlbFsnaWRfZ29vZCddLCBlbFsnaWRfcHJvcGVydHknXSwgZWxbJ2lkX3NlcmllcyddLCBlbFsnaWRfdW5pdCddKSkKICAgICAgICAgICAgICAgICMg0Jgg0YLQtdC/0LXRgNGMINGC0LDQsdC70LjRhtGDINC00L7QutGD0LzQtdC90YLQsCDRgdC+INGB0YHRi9C70LrQvtC5INC90LAgUlNfbWFya2luZ19jb2RlcwogICAgICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxX2RvY190ZXh0LCAoc2VsZi5pZF9kb2MsIG1hcmtfY29kZSwgYmFyY29kZV9pbmZvWydGdWxsQmFyY29kZSddLCAnMCcsICcxJykpCiAgICAgICAgICAgICAgICBlbFsnbWFya19jb2RlJ10gPSBtYXJrX2NvZGUKICAgICAgICAgICAgICAgIHJldHVybiBlbAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKCgogICAgZGVmIGFkZF9uZXdfYmFyY29kZV9pbl9kb2NfYmFyY29kZXNfdGFibGUoc2VsZiwgZWwsIGJhcmNvZGVfaW5mbyk6CiAgICAgICAgcXVlcnlfdGV4dCA9ICcnJwogICAgICAgIEluc2VydCBJbnRvIFJTX2RvY3NfYmFyY29kZXMgKAogICAgICAgIGlkX2RvYywKICAgICAgICBpZF9nb29kLAogICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgIGlkX3NlcmllcywKICAgICAgICBpZF91bml0LAogICAgICAgIGJhcmNvZGVfZnJvbV9zY2FubmVyLAogICAgICAgIGFwcHJvdmVkICwKICAgICAgICBHVElOLAogICAgICAgIFNlcmllcykgVkFMVUVTICg/LD8sPyw/LD8sPyw/LD8sPyknJycKICAgICAgICBhcmdzID0gKHNlbGYuaWRfZG9jLCBlbFsnaWRfZ29vZCddLGVsWydpZF9wcm9wZXJ0eSddLGVsWydpZF9zZXJpZXMnXSxlbFsnaWRfdW5pdCddLGJhcmNvZGVfaW5mb1snRnVsbENvZGUnXSwnMScsIGJhcmNvZGVfaW5mb1snR1RJTiddLCBiYXJjb2RlX2luZm9bJ1NFUklBTCddKQogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJncykKCgoKICAgICMg0JXRgdGC0Ywg0L/Qu9Cw0L0g0L/QviDQutC+0LvQuNGH0LXRgdGC0LLRgyAgLSBoYXZlX3F0dHlfcGxhbgogICAgIyDQldGB0YLRjCDQv9C70LDQvSDQv9C+INGB0L/QuNGB0LrRgyDRgtC+0LLQsNGA0L7QsiBoYXZlX3plcm9fcGxhbgogICAgIyDQmtCe0L3RgtGA0L7Qu9GMINC/0LvQsNC90L7QsiDQsiDQtNC+0LrRg9C80LXQvdGC0LUgLSBjb250cm9sCiAgICAjINCV0YHRgtGMINC/0LvQsNC9INC/0L4g0LzQsNGA0LrQuNGA0YPQtdC80L7QuSDQv9GA0L7QtNGD0LrRhtC40LggaGF2ZV9tYXJrX3BsYW4KICAgIGRlZiBwcm9jZXNzX3RoZV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUsIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UsIGhhdmVfemVyb19wbGFuID0gRmFsc2UsIGNvbnRyb2wgPSBGYWxzZSwgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW0gPSBOb25lLCB1c2VfbWFya19zZXR0aW5nID0gJ2ZhbHNlJywgdXNlcl90bXo9MCk6ICMgYWRkX2lmX25vdF9mb3VuZD1GYWxzZSwgYWRkX2lmX25vdF9pbl9wbGFuPUZhbHNlKToKICAgICAgICAjINCf0L7Qu9GD0YfQuNC8INGB0YLRgNGD0LrRgtGD0YDRgyDQsdCw0YDQutC+0LTQsAogICAgICAgIGlmIGJhcmNvZGVbMF0gPT0gY2hyKDI5KSBhbmQgbGVuKGJhcmNvZGUpID4gMzE6ICAjIFJlbW92ZSBmaXJzdCBHUzEgY2hhciBmcm9tIGJhcmNvZGUKICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTpdCiAgICAgICAgYmFyY29kZV9pbmZvID0gdWlfYmFyY29kZXMucGFyc2VfYmFyY29kZShiYXJjb2RlKQogICAgICAgIGlmIGJhcmNvZGVfaW5mby5fX2NvbnRhaW5zX18oJ0VSUk9SJyk6CiAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ0ludmFsaWQgQmFyY29kZScsICdEZXNjcic6ICfQndC10LLQtdGA0L3Ri9C5INGI0YLRgNC40YXQutC+0LQnLAogICAgICAgICAgICAgICAgICAgICdCYXJjb2RlJzogYmFyY29kZV9pbmZvLCAnZG9jX2luZm8nOiBzZWxmLmlkX2RvY30KICAgICAgICAjIC4uLiDQuCDQvdCw0LnQtNC10Lwg0L/QviDQvdC10LzRgyDQstGB0LUg0YfRgtC+INC10YHRgtGMINCyINCx0LDQt9C1CiAgICAgICAgc2hlbWEgPSBiYXJjb2RlX2luZm9bJ1NDSEVNRSddCiAgICAgICAgaWYgc2hlbWEgaW4gWydFQU4xMycsICdVTktOT1dOJ106CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mb1snQkFSQ09ERSddCiAgICAgICAgZWxpZiBzaGVtYSA9PSAnR1MxJzoKICAgICAgICAgICAgc2VhcmNoX3ZhbHVlID0gYmFyY29kZV9pbmZvWydHVElOJ10KICAgICAgICBlbHNlOiAgIyAqKioqKioqKioqKioqKioqKirQodGO0LTQsCDQvNC+0LbQvdC+INC00L7QsdCw0LLQuNGC0Ywg0L3QvtCy0YvQtSDQstC40LTRiyDRiNGC0YDQuNGF0LrQvtC00L7QsiAqKioqKioqKioqKioqKioqKioqKgogICAgICAgICAgICBzZWFyY2hfdmFsdWUgPSBiYXJjb2RlX2luZm9bJ0JBUkNPREUnXQoKICAgICAgICByZXMgPSBmaW5kX2JhcmNvZGVfaW5fYmFyY29kZV90YWJsZShzZWFyY2hfdmFsdWUpICAjINCY0YnQtdGCINCx0LDRgNC60L7QtCDQuNC70Lgg0JPQotCY0JjQnSDQv9C+INC+0LHRidC10Lkg0YLQsNCx0LvQuNGG0LUg0YjRgtGA0LjRhdC60L7QtNC+0LIuINCS0L7Qt9Cy0YDQsNGJ0LDQtdGCINGC0L7QstCw0YAsINC10LPQviDQstC40LQsINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60YMg0YHQtdGA0LjRjiDQuNGC0L8uCiAgICAgICAgaWYgbm90IGxlbihyZXMpID09IDA6CiAgICAgICAgICAgIGVsZW0gPSByZXNbMF0gI9CR0LXRgNC10Lwg0L/QtdGA0LLRi9C5INGA0LXQt9GD0LvRjNGC0LDRgi4g0JIg0L/RgNCw0LLQuNC70YzQvdC+0Lwg0YHQv9C40YHQutC1INGI0YLRgNC40YXQutC+0LTQvtCyINC90LUg0LzQvtC20LXRgiDQsdGL0YLRjCDQv9C+0LLRgtC+0YDQtdC90LjQuQogICAgICAgICAgICByYXRpbyA9IGVsZW1bJ3JhdGlvJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4geydFcnJvcic6ICdOb3RGb3VuZCcsICdEZXNjcic6ICfQqNGC0YDQuNGF0LrQvtC0INC90LUg0L3QsNC50LTQtdC9INCyINCx0LDQt9C1JywgJ0JhcmNvZGUnOiBiYXJjb2RlfQoKICAgICAgICB1c2VfbWFyayA9IHVzZV9tYXJrX3NldHRpbmcgID09ICd0cnVlJyBhbmQgZWxlbVsndXNlX21hcmsnXSA9PSAxICNnZXRfY29uc3RhbnRzKCd1c2VfbWFyaycpCgogICAgICAgICMg0J/RgNC+0LLQtdGA0Y/QtdC8INC80LDRgNC60LjRgNC+0LLQutGDCiAgICAgICAgaWYgdXNlX21hcms6CiAgICAgICAgICAgIGlmIHNoZW1hID09ICdHUzEnOgogICAgICAgICAgICAgICAgZWxfbWFya2VkID0gTm9uZQogICAgICAgICAgICAgICAgIyDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvNCw0YDQutC40YDQvtCy0LrRgyDQuCDRgtC+0LLQsNGAINC80LDRgNC60LjRgNGD0LXRgtGB0Y8KICAgICAgICAgICAgICAgICMg0J3QsNGI0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUgR1RJTiArINGB0LXRgNC40Y8KICAgICAgICAgICAgICAgIHJlcyA9IGZpbmRfYmFyY29kZV9pbl9tYXJraW5nX2NvZGVzX3RhYmxlKHNlbGYsIGJhcmNvZGVfaW5mbykKCiAgICAgICAgICAgICAgICBpZiByZXM6CiAgICAgICAgICAgICAgICAgICAgZWxfbWFya2VkID0gcmVzWzBdICPQktGL0LHQuNGA0LDQtdC8INC/0LXRgNCy0YPRjiDRgdGC0YDQvtC60YMg0LjQtyDRgdC/0LjRgdC60LAgKNC10YHQu9C4INCyINGC0LDQsdC70LjRhtC1INGI0YLRgNC40YXQutC+0LTQvtCyINC/0L7RgNGP0LTQvtC6LCDQsiDRgNC10YEg0LLRgdC10LPQtNCwINGC0L7Qu9GM0LrQviDQvtC00L3QsCDRgdGC0YDQvtC60LApCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMg0J3QtSDQvdCw0YjQu9C4LCDQv9GA0L7QstC10YDRj9C10Lwg0LXRgdGC0Ywg0LvQuCDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/Qu9Cw0L0g0Lgg0LrQvtC90YLRgNC+0LvRjAogICAgICAgICAgICAgICAgICAgIGlmIGhhdmVfbWFya19wbGFuIGFuZCBjb250cm9sOiAj0JXRgdGC0YzQn9C70LDQvdCa0J7QtNC+0LLQnNCw0YDQutC40YDQvtCy0LrQuCDQuCDQutC+0L3RgtGA0L7Qu9GMCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ05vdEZvdW5kJywgJ0Rlc2NyJzogJ9Cc0LDRgNC60LAg0L3QtSDQvdCw0LnQtNC10L3QsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCYXJjb2RlJzogYmFyY29kZV9pbmZvLCAnZG9jX2luZm8nOiBzZWxmLmlkX2RvY30KCiAgICAgICAgICAgICAgICAjICoqKioqKioqKioqKgoKICAgICAgICAgICAgICAgIGlmIGVsX21hcmtlZCBhbmQgZWxfbWFya2VkWydpZF9nb29kJ106ICAjINC90LDRiNC70Lgg0YHRgtGA0L7QutGDINC/0L4g0L/QvtC70L3QvtC80YMg0YHQvtCy0L/QsNC00LXQvdC40Y4gR1RJTiDQuCDRgdC10YDQuNGPLCDRgdGB0YvQu9C60LAg0L3QsCDRgtC+0LLQsNGACgogICAgICAgICAgICAgICAgICAgIGlmIGVsX21hcmtlZFsnYXBwcm92ZWQnXSA9PSAnMSc6ICAjINCi0LDQutCw0Y8g0LzQsNGA0LrQsCDRg9C20LUg0LHRi9C70LAg0L7RgtGB0LrQsNC90LjRgNC+0LLQsNC90LAKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsnRXJyb3InOiAnQWxyZWFkeVNjYW5uZWQnLCAnRGVzY3InOiAn0KLQsNC60LDRjyDQvNCw0YDQutCwINGD0LbQtSDQsdGL0LvQsCDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L3QsCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0JhcmNvZGUnOiBiYXJjb2RlX2luZm8sICdkb2NfaW5mbyc6IGVsX21hcmtlZH0KCiAgICAgICAgICAgICAgICAjICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4geydFcnJvcic6ICdOb3RWYWxpZEJhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICAnRGVzY3InOiAn0KLQvtCy0LDRgCDQv9C+0LTQu9C10LbQuNGCINC80LDRgNC60LjRgNC+0LLQutC1LCDQsCDQv9C+INC90LXQvNGDINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvSDQvtCx0YvRh9C90YvQuSDRiNGC0YDQuNGF0LrQvtC0JywKICAgICAgICAgICAgICAgICAgICAgICAgJ0JhcmNvZGUnOiBiYXJjb2RlfQoKICAgICAgICAj0KLQvtCy0LDRgCDQsiDRgtCw0LHQu9C40YbQtSDQtNC+0LrRg9C80LXQvdGC0LAgKNCi0L7QstCw0YAg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtSkKICAgICAgICByZXMgPSBjaGVja19iYXJjb2RlX2NvbXBsaWFuY2UoZWxlbSwgc2VsZi5pZF9kb2MpICAj0J/QvtC70YPRh9Cw0LXQvCDRgdGC0YDQvtC60YMg0YLQsNCx0LvQuNGG0Ysg0YLQvtCy0LDRgNGLINC00L7QutGD0LzQtdC90YLQsAogICAgICAgIGlmIHJlczogI9Ci0L7QstCw0YAg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtQogICAgICAgICAgICBpZiBoYXZlX3F0dHlfcGxhbjogI9CV0YHRgtGMINC/0LvQsNC9INC/0L4g0LrQvtC70LjRh9C10YHRgtCy0YMKICAgICAgICAgICAgICAgIGlmIHJlc1swXVsncXR0eV9wbGFuJ10gPCByZXNbMF1bJ3F0dHknXSArIHJhdGlvOiAj0JrQvtC70LjRh9C10YHRgtCy0L4g0YLQvtCy0LDRgNCwINCyINC00L7QutGD0LzQtdC90YLQtSDRg9C20LUg0L3QsNCx0YDQsNC90L4sINC4INC80Ysg0L/RgNC10LLRi9GI0LDQtdC8INC/0LvQsNC9CiAgICAgICAgICAgICAgICAgICAgaWYgY29udHJvbDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsnUmVzdWx0JzogZifQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsdGD0LTQtdGCINC/0YDQtdCy0YvRiNC10L3QviDQv9GA0Lgg0LTQvtCx0LDQstC70LXQvdC40Lgge3N0cihyYXRpbyl9INC10LTQuNC90LjRhiDRgtC+0LLQsNGA0LAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFcnJvcic6ICdRdWFudGl0eVBsYW5SZWFjaGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGJhcmNvZGUsICdEZXNjcic6IGYn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0g0LHRg9C00LXRgiDQv9GA0LXQstGL0YjQtdC90L4g0L/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4IHtzdHIocmF0aW8pfSDQtdC00LjQvdC40YYg0YLQvtCy0LDRgNCwJ30KICAgICAgICAgICAgI9Ci0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDRg9GH0LXRgtGDINC/0L4g0YHQtdGA0LjRj9C8CiAgICAgICAgICAgIGlmIHJlc1swXVsndXNlX3NlcmllcyddID09IDE6CiAgICAgICAgICAgICAgICByZXR1cm4geydSZXN1bHQnOiAn0JTQsNC90L3Ri9C5INGC0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDRg9GH0LXRgtGDINC/0L4g0YHQtdGA0LjRj9C8JywKICAgICAgICAgICAgICAgICAgICAgICAgJ0Vycm9yJzogJ011c3RfdXNlX3NlcmllcycsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ0Rlc2NyJzogZifQotC+0LLQsNGAINC/0L7QtNC70LXQttC40YIg0YHQtdGA0LjQudC90L7QvNGDINGD0YfQtdGC0YMnLAogICAgICAgICAgICAgICAgICAgICAgICAnY3VycmVudF9lbGVtJzogcmVzWzBdfQoKICAgICAgICBlbHNlOiAj0KLQvtCy0LDRgCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAgICAgaWYgaGF2ZV96ZXJvX3BsYW4gYW5kIGNvbnRyb2w6CiAgICAgICAgICAgICAgICByZXR1cm4geydSZXN1bHQnOiAn0JIg0LTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0L3QtdC70YzQt9GPINC00L7QsdCw0LLQuNGC0Ywg0YLQvtCy0LDRgCDQvdC1INC40Lcg0YHQv9C40YHQutCwJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0Vycm9yJzogJ1plcm9fcGxhbl9lcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ0Rlc2NyJzogJ9CSINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC90LXQu9GM0LfRjyDQtNC+0LHQsNCy0LjRgtGMINGC0L7QstCw0YAg0L3QtSDQuNC3INGB0L/QuNGB0LrQsCd9CgoKICAgICAgICAjINCR0LvQvtC6INC00L7QsdCw0LLQu9C10L3QuNGPINGC0L7QstCw0YDQsCDQsiDQtNC+0LrRg9C80LXQvdGCCiAgICAgICAgaWYgdXNlX21hcms6CiAgICAgICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INGC0L7QstCw0YAg0LIg0YLQsNCx0LvQuNGG0YMg0LzQsNGA0LrQuNGA0L7QstC60LgKICAgICAgICAgICAgaWYgZWxfbWFya2VkIGFuZCBlbF9tYXJrZWRbJ2lkX2dvb2QnXTogI9Ci0L7QstCw0YAg0LHRi9C7INC90LDQudC00LXQvSwg0YLQvtC70YzQutC+INC+0LHQvdC+0LLQu9GP0LXQvCDRg9C20LUg0L3QsNC50LTQtdC90L3Rg9GOINGB0YLRgNC+0LrRgwogICAgICAgICAgICAgICAgcXVlcnlfdGV4dCA9ICdVcGRhdGUgIFJTX2RvY3NfYmFyY29kZXMgU0VUIGFwcHJvdmVkPT8sIGJhcmNvZGVfZnJvbV9zY2FubmVyPT8gV2hlcmUgaWQ9PycKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKCcxJywgYmFyY29kZSwgaW50KGVsX21hcmtlZFsnaWQnXSkpKQogICAgICAgICAgICBlbHNlOiAj0JTQvtCx0LDQstC70Y/QtdC8INC90L7QstGD0Y4g0YHRgtGA0L7QutGDINCyINGC0LDQsdC70LjRhtGDINCx0LDRgNC60L7QtNC+0LIg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgICAgICAgICBzZWxmLmFkZF9uZXdfYmFyY29kZV9pbl9kb2NfYmFyY29kZXNfdGFibGUoc2VsZiwgZWxlbSAsIGJhcmNvZGVfaW5mbykKCgogICAgICAgICMg0J7QsdC90L7QstC70Y/QtdC8INGC0LDQsdC70LjRhtGDINGC0L7QstCw0YDRiwogICAgICAgIHNlbGYudXBkYXRlX2RvY190YWJsZV9kYXRhKHNlbGYsIGVsZW0sIHJhdGlvLCB1c2VyX3RteikKCiAgICAgICAgcmV0dXJuIHsnUmVzdWx0JzogJ9Cc0LDRgNC60LAg0LTQvtCx0LDQstC70LXQvdCwINCyINC00L7QutGD0LzQtdC90YInLCAnRXJyb3InOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGJhcmNvZGVfaW5mb1snR1RJTiddICsgYmFyY29kZV9pbmZvWydTRVJJQUwnXX0KCgogICAgZGVmIGFkZChzZWxmLCBhcmdzKToKICAgICAgICBxdWVyeSA9ICdJTlNFUlQgSU5UTyBSU19kb2NzKGlkX2RvYywgZG9jX3R5cGUsIGRvY19uLCBkb2NfZGF0ZSwgaWRfY291bnRyYWdlbnRzLCBpZF93YXJlaG91c2UsIHZlcmlmaWVkLCBzZW50KSBWQUxVRVMgKD8sPyw/LD8sPyw/LDAsMCknCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgYXJncykKCiAgICBkZWYgZ2V0X25ld19pZChzZWxmKToKICAgICAgICBxdWVyeSA9ICdzZWxlY3QgbWF4X2lkX2RvYyBmcm9tIFJTX2NvbnN0YW50cycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQogICAgICAgIGlmIGxlbihyZXMpID09IDA6CiAgICAgICAgICAgIHJldHVybiAnMScKICAgICAgICBlbHNlOgogICAgICAgICAgICB2YWwgPSByZXNbMF1bMF0KICAgICAgICAgICAgaWYgdmFsIGlzIE5vbmU6CiAgICAgICAgICAgICAgICByZXR1cm4gJzEnCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBxdWVyeSA9ICdVUERBVEUgUlNfY29uc3RhbnRzIFNFVCBtYXhfaWRfZG9jID0gPycKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnksIChpbnQodmFsKSArIDEsKSkKICAgICAgICAgICAgICAgIHJldHVybiBzdHIoaW50KHZhbCkgKyAxKQoKY2xhc3MgUnNfYWRyX2RvYygpOgogICAgaWRfZG9jID0gJycgICMgc3RyKQogICAgaWRfc3RyID0gJycgICMgc3RyKQogICAgcXR0eSA9ICcnICAjIHN0cikKCiAgICBkZWYgdXBkYXRlX2RvY19zdHIoc2VsZik6CiAgICAgICAgcXVlcnkgPSAiIiIKICAgICAgICBVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUKICAgICAgICBTRVQgcXR0eT0/CiAgICAgICAgV2hlcmUgaWQ9PyAiIiIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoc2VsZi5xdHR5LCBzZWxmLmlkX3N0cikpCiAgICAgICAgcmV0dXJuIHJlcwoKCiAgICBkZWYgY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAoJ1VwZGF0ZSBSU19hZHJfZG9jc190YWJsZSBTZXQgcXR0eSA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICdEZWxldGUgRnJvbSBSU19hZHJfZG9jc190YWJsZSBXaGVyZSBpZF9kb2M9OmlkX2RvYyBhbmQgaXNfcGxhbiA9ICJGYWxzZSInKQogICAgICAgIGZvciBlbCBpbiBxdWVyeV90ZXh0OgogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsLCAoeydpZF9kb2MnOnNlbGYuaWRfZG9jfSkpCgoKICAgIGRlZiBkZWxldGVfZG9jKHNlbGYpOgogICAgICAgIHF1ZXJ5X2RvY190YWJsZSA9ICdERUxFVEUgRlJPTSBSU19hZHJfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZG9jX3RhYmxlLCAoc2VsZi5pZF9kb2MsKSkKICAgICAgICAjIHF1ZXJ5X2RvY190YWJsZSA9ICdERUxFVEUgRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgIyBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2RvY190YWJsZSwgKHNlbGYuaWRfZG9jLCkpCiAgICAgICAgcXVlcnlfZG9jID0gJ0RFTEVURSBGUk9NIFJTX2Fkcl9kb2NzIFdIRVJFIGlkX2RvYyA9ID8nCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV9kb2MsIChzZWxmLmlkX2RvYywpKQoKICAgICAgICByZXR1cm4gcmVzCiAgICAjIGRlZiBjbGVhcl9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAjICAgICBxdWVyeV90ZXh0ID0gKCdVcGRhdGUgUlNfZG9jc19iYXJjb2RlcyBTZXQgYXBwcm92ZWQgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICMgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX2JhcmNvZGVzIFdoZXJlICBpZF9kb2M9OmlkX2RvYyBBbmQgaXNfcGxhbiA9IDAnLAogICAgIyAgICAgJ1VwZGF0ZSBSU19kb2NzX3RhYmxlIFNldCBxdHR5ID0gMCBXaGVyZSBpZF9kb2M9OmlkX2RvYycsCiAgICAjICAgICAnRGVsZXRlIEZyb20gUlNfZG9jc190YWJsZSBXaGVyZSBpZF9kb2M9OmlkX2RvYyBhbmQgaXNfcGxhbiA9ICJGYWxzZSInKQogICAgIyAgICAgZm9yIGVsIGluIHF1ZXJ5X3RleHQ6CiAgICAjICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChlbCwgKHsnaWRfZG9jJzpzZWxmLmlkX2RvY30pKQoKICAgIGRlZiBtYXJrX2Zvcl91cGxvYWQoc2VsZik6CiAgICAgICAgcXVlcnkgPSAiIiIKICAgICAgICBVUERBVEUgUlNfYWRyX2RvY3NfdGFibGUKICAgICAgICBTRVQgc2VudD0xCiAgICAgICAgV2hlcmUgaWQ9PyAiIiIKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoc2VsZi5pZF9kb2MpKQoKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIG1hcmtfdmVyaWZpZWQoc2VsZiwga2V5KToKICAgICAgICBxdWVyeSA9ICIiIgogICAgICAgICAgICAgICAgVVBEQVRFIFJTX2Fkcl9kb2NzCiAgICAgICAgICAgICAgICBTRVQgdmVyaWZpZWQ9PwogICAgICAgICAgICAgICAgV2hlcmUgaWRfZG9jPT8gIiIiCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKGludChrZXkpLCBzZWxmLmlkX2RvYykpCgogICAgZGVmIGZpbmRfYmFyY29kZV9pbl90YWJsZShzZWxmLCBzZWFyY2hfdmFsdWU6IHN0ciwgZnVuY19jb21wYXJlZD0nPT8nKSAtPiBvYmplY3Q6CgogICAgICAgIHF1ZXJ5ID0gJycnCiAgICAgICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCwKICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSwKICAgICAgICAgICAgICAgICBSU19iYXJjb2Rlcy5pZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfdW5pdCwKICAgICAgICAgICAgICAgICBSU19kb2NzX2Fkcl90YWJsZS5pZCwKICAgICAgICAgICAgICAgICBSU19kb2NzX2Fkcl90YWJsZS5xdHR5ICAgICAgICAKICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzCiAgICAgICAgICAgICAgICAgTGVmdCBqb2luIFJTX2RvY3NfYWRyX3RhYmxlIE9OCiAgICAgICAgICAgICAgICAgUlNfZG9jc19hZHJfdGFibGUuaWRfZ29vZD0gUlNfYmFyY29kZXMuaWRfZ29vZCBhbmQKICAgICAgICAgICAgICAgICBSU19kb2NzX2Fkcl90YWJsZS5pZF9wcm9wZXJ0aWVzPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBhbmQKICAgICAgICAgICAgICAgICBSU19kb2NzX2Fkcl90YWJsZS5pZF91bml0PSBSU19iYXJjb2Rlcy5pZF91bml0IEFuZAogICAgICAgICAgICAgICAgIFJTX2RvY3NfYWRyX3RhYmxlLmlkX2RvYz0/CiAgICAgICAgICAgICAgICAgd2hlcmUgYmFyY29kZSAnJycgKyBmdW5jX2NvbXBhcmVkCiAgICAgICAgIyBxdWVyeSA9IHF1ZXJ5ICsgZnVuY19jb21wYXJlZAoKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgKHNlbGYuaWRfZG9jLCBzZWFyY2hfdmFsdWUpLCBUcnVlKQoKICAgIGRlZiB1cGRhdGVfZG9jX3RhYmxlX2RhdGEoc2VsZiwgZWxlbV9mb3JfYWRkOiBkaWN0LCBxdHR5PTEsIGNlbGxfaWQgPSBOb25lLCB0YWJsZV90eXBlID0gJ291dCcsIHVzZXJfdG16PTApOgogICAgICAgICPQmNGJ0LXQvCDRj9GH0LXQudC60YMg0L/QviDQuNC80LXQvdC4LCDQvdCw0Lwg0L3Rg9C20LXQvSBJRAogICAgICAgICMgcmVzICA9IGdldF9xdWVyeV9yZXN1bHQoJ1NlbGVjdCBpZCBGcm9tIFJTX2NlbGxzIFdoZXJlIG5hbWUgPSA/JywoY2VsbF9uYW1lLCkpCiAgICAgICAgIwogICAgICAgICMgY2VsbF9pZCA9IHJlc1swXVswXSBpZiByZXMgZWxzZSBOb25lCiAgICAgICAgI9CV0YHQu9C4IGVsZW1fZm9yX2FkZCDRgdC+0LTQtdGA0LbQuNGCINGA0LDRgtC40L4gLSDRg9C80L3QvtC20LjQvCDQtdCz0L4g0L3QsCBxdHR5CiAgICAgICAgI3F0dHkgPSBlbGVtX2Zvcl9hZGQuZ2V0KCdyYXRpbycpKnF0dHkgaWYgZWxlbV9mb3JfYWRkLmdldCgncmF0aW8nKSBpcyBub3QgTm9uZSBlbHNlIHF0dHkKCiAgICAgICAgIyDQodC90LDRh9Cw0LvQsCDQvtC/0YDQtdC00LXQu9C40LwsINC10YHRgtGMINC70Lgg0LIg0YHQv9C40YHQutC1INGC0L7QstCw0YDQvtCyINC00L7QutGD0LzQtdC90YLQsCDQvdCw0Ygg0YLQvtCy0LDRgDoKICAgICAgICBxdGV4dCA9ICdTZWxlY3QgKiBmcm9tIFJTX2Fkcl9kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYz0/IGFuZCBpZF9nb29kID0gPyBhbmQgaWRfcHJvcGVydGllcyA9ID8gYW5kIGlkX3NlcmllcyA9ID8gIGFuZCAoaWRfY2VsbD0/ICBPUiBpZF9jZWxsPSAiIiBPUiBpZF9jZWxsIGlzIE51bGwpIGFuZCB0YWJsZV90eXBlID0gPycgICNhbmQgaWRfdW5pdCA9ID8KICAgICAgICBhcmdzID0gKHNlbGYuaWRfZG9jLCBlbGVtX2Zvcl9hZGRbJ2lkX2dvb2QnXSwgZWxlbV9mb3JfYWRkWydpZF9wcm9wZXJ0eSddLCBlbGVtX2Zvcl9hZGRbJ2lkX3NlcmllcyddLCBjZWxsX2lkLCB0YWJsZV90eXBlKSAjLGVsZW1fZm9yX2FkZFsnaWRfdW5pdCddCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgYXJncywgVHJ1ZSkKICAgICAgICBpZiByZXM6ICAjINCd0LDRiNC70Lgg0YHRgtGA0L7QutC4INC00L7QutGD0LzQtdC90YLQsCwg0LTQvtCx0LDQstC70Y/QtdC8INC60L7Qu9C40YfQtdGB0YLQstC+CgogICAgICAgICAgICBlbCA9IHJlc1swXQogICAgICAgICAgICAjIGlmIGVsWydxdHR5J10rcXR0eSA9PSAwOgogICAgICAgICAgICAjICAgICBxdGV4dCA9ICdERUxFVEUgRlJPTSBSU19kb2NzX3RhYmxlICBXSEVSRSBpZCA9ID8nCiAgICAgICAgICAgICMgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQsIChlbFsnaWQnXSwpKQogICAgICAgICAgICAjIGVsc2U6CiAgICAgICAgICAgIHF0ZXh0ID0gJ1VQREFURSBSU19hZHJfZG9jc190YWJsZSBTRVQgcXR0eT1xdHR5Kz8sIGxhc3RfdXBkYXRlZCA9ID8sIGlkX2NlbGwgPSA/ICBXSEVSRSBpZCA9ID8nCiAgICAgICAgICAgIGN1cnJlbnRfdGltZV91dGNfMCA9IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz1pbnQodXNlcl90bXopKSkuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIikKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCwgKHF0dHksICBjdXJyZW50X3RpbWVfdXRjXzAsIGNlbGxfaWQsIGVsWydpZCddKSkKICAgICAgICBlbHNlOiAgIyDQotCw0LrQvtC5INGB0YLRgNC+0LrQuCDQvdC10YIsINC90LDQtNC+INC00L7QsdCw0LLQuNGC0YwKICAgICAgICAgICAgcXRleHQgPSAnUkVQTEFDRSBJTlRPIFJTX2Fkcl9kb2NzX3RhYmxlKGlkX2RvYywgaWRfZ29vZCwgaWRfcHJvcGVydGllcyxpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIGlzX3BsYW4sIGlkX2NlbGwsIHRhYmxlX3R5cGUpIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/LD8pJwogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAoCiAgICAgICAgICAgICAgICBzZWxmLmlkX2RvYywgZWxlbV9mb3JfYWRkWydpZF9nb29kJ10sIGVsZW1fZm9yX2FkZFsnaWRfcHJvcGVydHknXSwgZWxlbV9mb3JfYWRkWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgICAgIGVsZW1fZm9yX2FkZFsnaWRfdW5pdCddLCBxdHR5LCAnRmFsc2UnLGNlbGxfaWQsIHRhYmxlX3R5cGUpKQoKICAgICAgICByZXR1cm4gcmVzCgoKICAgICMg0JXRgdGC0Ywg0L/Qu9Cw0L0g0L/QviDQutC+0LvQuNGH0LXRgdGC0LLRgyAgLSBoYXZlX3F0dHlfcGxhbgogICAgIyDQldGB0YLRjCDQv9C70LDQvSDQv9C+INGB0L/QuNGB0LrRgyDRgtC+0LLQsNGA0L7QsiBoYXZlX3plcm9fcGxhbgogICAgIyDQmtCe0L3RgtGA0L7Qu9GMINC/0LvQsNC90L7QsiDQsiDQtNC+0LrRg9C80LXQvdGC0LUgLSBjb250cm9sCiAgICAjINCV0YHRgtGMINC/0LvQsNC9INC/0L4g0LzQsNGA0LrQuNGA0YPQtdC80L7QuSDQv9GA0L7QtNGD0LrRhtC40LggaGF2ZV9tYXJrX3BsYW4KICAgIGRlZiBwcm9jZXNzX3RoZV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUsIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UsIGhhdmVfemVyb19wbGFuID0gRmFsc2UsIGNvbnRyb2wgPSBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGxfaWQgPSBOb25lLCB0YWJsZV90eXBlID0gJ291dCcsIHVzZXJfdG16PTApOiAjIGFkZF9pZl9ub3RfZm91bmQ9RmFsc2UsIGFkZF9pZl9ub3RfaW5fcGxhbj1GYWxzZSk6CgogICAgICAgICMg0J/QvtC70YPRh9C40Lwg0YHRgtGA0YPQutGC0YPRgNGDINCx0LDRgNC60L7QtNCwCiAgICAgICAgaWYgYmFyY29kZVswXSA9PSBjaHIoMjkpIGFuZCBsZW4oYmFyY29kZSkgPiAzMTogICMgUmVtb3ZlIGZpcnN0IEdTMSBjaGFyIGZyb20gYmFyY29kZQogICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxOl0KICAgICAgICBiYXJjb2RlX2luZm8gPSB1aV9iYXJjb2Rlcy5wYXJzZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgYmFyY29kZV9pbmZvLl9fY29udGFpbnNfXygnRVJST1InKToKICAgICAgICAgICAgcmV0dXJuIHsnRXJyb3InOiAnSW52YWxpZCBCYXJjb2RlJywgJ0Rlc2NyJzogJ9Cd0LXQstC10YDQvdGL0Lkg0YjRgtGA0LjRhdC60L7QtCcsCiAgICAgICAgICAgICAgICAgICAgJ0JhcmNvZGUnOiBiYXJjb2RlX2luZm8sICdkb2NfaW5mbyc6IHNlbGYuaWRfZG9jfQogICAgICAgICMgLi4uINC4INC90LDQudC00LXQvCDQv9C+INC90LXQvNGDINCy0YHQtSDRh9GC0L4g0LXRgdGC0Ywg0LIg0LHQsNC30LUKICAgICAgICBzaGVtYSA9IGJhcmNvZGVfaW5mb1snU0NIRU1FJ10KICAgICAgICBpZiBzaGVtYSBpbiBbJ0VBTjEzJywgJ1VOS05PV04nXToKICAgICAgICAgICAgc2VhcmNoX3ZhbHVlID0gYmFyY29kZV9pbmZvWydCQVJDT0RFJ10KICAgICAgICBlbGlmIHNoZW1hID09ICdHUzEnOgogICAgICAgICAgICBzZWFyY2hfdmFsdWUgPSBiYXJjb2RlX2luZm9bJ0dUSU4nXQogICAgICAgIGVsc2U6ICAjICoqKioqKioqKioqKioqKioqKtCh0Y7QtNCwINC80L7QttC90L4g0LTQvtCx0LDQstC40YLRjCDQvdC+0LLRi9C1INCy0LjQtNGLINGI0YLRgNC40YXQutC+0LTQvtCyICoqKioqKioqKioqKioqKioqKioqCiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mb1snQkFSQ09ERSddCgogICAgICAgIHJlcyA9IGZpbmRfYmFyY29kZV9pbl9iYXJjb2RlX3RhYmxlKHNlYXJjaF92YWx1ZSkgICMg0JjRidC10YIg0LHQsNGA0LrQvtC0INC40LvQuCDQk9Ci0JjQmNCdINC/0L4g0L7QsdGJ0LXQuSDRgtCw0LHQu9C40YbQtSDRiNGC0YDQuNGF0LrQvtC00L7Qsi4g0JLQvtC30LLRgNCw0YnQsNC10YIg0YLQvtCy0LDRgCwg0LXQs9C+INCy0LjQtCwg0YXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrRgyDRgdC10YDQuNGOINC40YLQvy4KICAgICAgICBpZiBub3QgbGVuKHJlcykgPT0gMDoKICAgICAgICAgICAgZWxlbSA9IHJlc1swXSAj0JHQtdGA0LXQvCDQv9C10YDQstGL0Lkg0YDQtdC30YPQu9GM0YLQsNGCLiDQkiDQv9GA0LDQstC40LvRjNC90L7QvCDRgdC/0LjRgdC60LUg0YjRgtGA0LjRhdC60L7QtNC+0LIg0L3QtSDQvNC+0LbQtdGCINCx0YvRgtGMINC/0L7QstGC0L7RgNC10L3QuNC5CiAgICAgICAgICAgIHJhdGlvID0gZWxlbVsncmF0aW8nXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7J0Vycm9yJzogJ05vdEZvdW5kJywgJ0Rlc2NyJzogJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LHQsNC30LUnLCAnQmFyY29kZSc6IGJhcmNvZGV9CgogICAgICAgIGVsZW1bJ2lkX2NlbGwnXSA9IGNlbGxfaWQKCiAgICAgICAgI9Ci0L7QstCw0YAg0LIg0YLQsNCx0LvQuNGG0LUg0LTQvtC60YPQvNC10L3RgtCwICjQotC+0LLQsNGAINC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUpCiAgICAgICAgcmVzID0gY2hlY2tfYWRyX2JhcmNvZGVfY29tcGxpYW5jZShlbGVtLCBzZWxmLmlkX2RvYykgICPQn9C+0LvRg9GH0LDQtdC8INGB0YLRgNC+0LrRgyDRgtCw0LHQu9C40YbRiyDRgtC+0LLQsNGA0Ysg0LTQvtC60YPQvNC10L3RgtCwCiAgICAgICAgaWYgcmVzOiAj0KLQvtCy0LDRgCDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1CiAgICAgICAgICAgIGlmIGhhdmVfcXR0eV9wbGFuOiAj0JXRgdGC0Ywg0L/Qu9Cw0L0g0L/QviDQutC+0LvQuNGH0LXRgdGC0LLRgwogICAgICAgICAgICAgICAgaWYgcmVzWzBdWydxdHR5X3BsYW4nXSA8IHJlc1swXVsncXR0eSddICsgcmF0aW86ICPQmtC+0LvQuNGH0LXRgdGC0LLQviDRgtC+0LLQsNGA0LAg0LIg0LTQvtC60YPQvNC10L3RgtC1INGD0LbQtSDQvdCw0LHRgNCw0L3Qviwg0Lgg0LzRiyDQv9GA0LXQstGL0YjQsNC10Lwg0L/Qu9Cw0L0KICAgICAgICAgICAgICAgICAgICBpZiBjb250cm9sOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geydSZXN1bHQnOiAgZifQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsdGD0LTQtdGCINC/0YDQtdCy0YvRiNC10L3QviDQv9GA0Lgg0LTQvtCx0LDQstC70LXQvdC40Lgge3N0cihyYXRpbyl9INC10LTQuNC90LjRhiDRgtC+0LLQsNGA0LAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdFcnJvcic6ICdRdWFudGl0eVBsYW5SZWFjaGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZSc6IGJhcmNvZGUsICdEZXNjcic6IGYn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0g0LHRg9C00LXRgiDQv9GA0LXQstGL0YjQtdC90L4g0L/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4IHtzdHIocmF0aW8pfSDQtdC00LjQvdC40YYg0YLQvtCy0LDRgNCwJ30KICAgICAgICAjINCi0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDRg9GH0LXRgtGDINC/0L4g0YHQtdGA0LjRj9C8CiAgICAgICAgICAgIGlmIHJlc1swXVsndXNlX3NlcmllcyddID09IDE6CiAgICAgICAgICAgICAgICByZXR1cm4geydSZXN1bHQnOiAn0JTQsNC90L3Ri9C5INGC0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDRg9GH0LXRgtGDINC/0L4g0YHQtdGA0LjRj9C8JywKICAgICAgICAgICAgICAgICAgICAgICAgJ0Vycm9yJzogJ011c3RfdXNlX3NlcmllcycsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ0Rlc2NyJzogZifQotC+0LLQsNGAINC/0L7QtNC70LXQttC40YIg0YHQtdGA0LjQudC90L7QvNGDINGD0YfQtdGC0YMnLAogICAgICAgICAgICAgICAgICAgICAgICAnY3VycmVudF9lbGVtJzogcmVzWzBdfQoKICAgICAgICBlbHNlOiAj0KLQvtCy0LDRgCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAgICAgaWYgaGF2ZV96ZXJvX3BsYW4gYW5kIGNvbnRyb2w6CiAgICAgICAgICAgICAgICByZXR1cm4geydSZXN1bHQnOiAn0JIg0LTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0L3QtdC70YzQt9GPINC00L7QsdCw0LLQuNGC0Ywg0YLQvtCy0LDRgCDQvdC1INC40Lcg0YHQv9C40YHQutCwJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0Vycm9yJzogJ1plcm9fcGxhbl9lcnJvcicsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJzogYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ0Rlc2NyJzogJ9CSINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC90LXQu9GM0LfRjyDQtNC+0LHQsNCy0LjRgtGMINGC0L7QstCw0YAg0L3QtSDQuNC3INGB0L/QuNGB0LrQsCd9CgoKICAgICAgICAjINCe0LHQvdC+0LLQu9GP0LXQvCDRgtCw0LHQu9C40YbRgyDRgtC+0LLQsNGA0YsKICAgICAgICBzZWxmLnVwZGF0ZV9kb2NfdGFibGVfZGF0YShzZWxmLCBlbGVtLCByYXRpbywgY2VsbF9pZCwgdGFibGVfdHlwZSwgdXNlcl90bXopCgogICAgICAgIHJldHVybiB7J1Jlc3VsdCc6ICfQnNCw0YDQutCwINC00L7QsdCw0LLQu9C10L3QsCDQsiDQtNC+0LrRg9C80LXQvdGCJywgJ0Vycm9yJzogTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2JhcmNvZGUnOiBiYXJjb2RlX2luZm9bJ0dUSU4nXSArIGJhcmNvZGVfaW5mb1snU0VSSUFMJ119CgoKICAgIGRlZiBhZGQoc2VsZiwgYXJncyk6CiAgICAgICAgcXVlcnkgPSAnSU5TRVJUIElOVE8gUlNfYWRyX2RvY3MoaWRfZG9jLCBkb2NfdHlwZSwgZG9jX24sIGRvY19kYXRlLCBpZF93YXJlaG91c2UsIHZlcmlmaWVkLCBzZW50KSBWQUxVRVMgKD8sPyw/LD8sPywwLDApJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnksIGFyZ3MpCgogICAgZGVmIGdldF9uZXdfaWQoc2VsZik6CiAgICAgICAgcXVlcnkgPSAnc2VsZWN0IG1heF9pZF9kb2MgZnJvbSBSU19jb25zdGFudHMnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKICAgICAgICBpZiBsZW4ocmVzKSA9PSAwOgogICAgICAgICAgICByZXR1cm4gJzEnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdmFsID0gcmVzWzBdWzBdCiAgICAgICAgICAgIGlmIHZhbCBpcyBOb25lOgogICAgICAgICAgICAgICAgcmV0dXJuICcxJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcXVlcnkgPSAnVVBEQVRFIFJTX2NvbnN0YW50cyBTRVQgbWF4X2lkX2RvYyA9ID8nCiAgICAgICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaW50KHZhbCkgKyAxLCkpCiAgICAgICAgICAgICAgICByZXR1cm4gc3RyKGludCh2YWwpICsgMSkKCgogICAgZGVmIGZpbmRfY2VsbChzZWxmLCBiYXJjb2RlKToKICAgICAgICBxdGV4dCA9ICcnJ1NlbGVjdCAqIGZyb20gUlNfY2VsbHMgV0hlcmUgUlNfY2VsbHMuYmFyY29kZSA9ID8nJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAoYmFyY29kZSwgKSwgVHJ1ZSkKICAgICAgICByZXN1bHQgPSBOb25lCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXN1bHQgPSByZXNbMF0KCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKCmRlZiBleGVjdXRlX3F1ZXJ5KHFfaW5kZXgsIHFfdGV4dCwgYXJncywgaW5fZGljdCk6CiAgICBpZiBxdWVyeV9saXN0LmVtcHR5KCk6CiAgICAgICAgc3RhcnRfcXVldWUgPVRydWUKICAgIHF1ZXJ5X2xpc3QucHV0KHsncV9pbmRleCc6cV9pbmRleCwgJ3FfdGV4dCc6cV90ZXh0LCAnYXJncyc6YXJncywgJ2luX2RpY3QnOmluX2RpY3R9KQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBpZiBzdGFydF9xdWV1ZToKICAgICAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdCgpCgoKZGVmIHdyaXRlX2Vycm9yX29uX2xvZyhFcnJfdmFsdWUpOgogICAgaWYgRXJyX3ZhbHVlOgogICAgICAgIHF0ZXh0ID0gJ0luc2VydCBpbnRvIEVycm9yX2xvZyhsb2cpIFZhbHVlcyg/KScKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCAoRXJyX3ZhbHVlLCkpCgoKCgoK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_models.py",
                "PyFileKey": "ui_models",
                "PyFileData": "aW1wb3J0IHJlCmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kCmltcG9ydCBqc29uCmZyb20ganNvbi5kZWNvZGVyIGltcG9ydCBKU09ORGVjb2RlRXJyb3IKaW1wb3J0IG9zCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgT3B0aW9uYWwsIFR1cGxlLCBDYWxsYWJsZQppbXBvcnQgc2h1dGlsCmltcG9ydCBkYl9zZXJ2aWNlcwppbXBvcnQgaHNfc2VydmljZXMKZnJvbSBwcmludGluZ19mYWN0b3J5IGltcG9ydCBIVE1MRG9jdW1lbnQsIFByaW50U2VydmljZSwgYnQKZnJvbSB1aV91dGlscyBpbXBvcnQgSGFzaE1hcCwgUnNEb2MsIEJhcmNvZGVXb3JrZXIsIGdldF9pcF9hZGRyZXNzLCBCYXJjb2RlQWRyV29ya2VyCmZyb20gZGJfc2VydmljZXMgaW1wb3J0IERvY1NlcnZpY2UsIEVycm9yU2VydmljZSwgR29vZHNTZXJ2aWNlLCBCYXJjb2RlU2VydmljZSwgQWRyRG9jU2VydmljZSwgVGltZXJTZXJ2aWNlCmZyb20gdGlueV9kYl9zZXJ2aWNlcyBpbXBvcnQgU2Nhbm5pbmdRdWV1ZVNlcnZpY2UsIEV4Y2hhbmdlUXVldWVCdWZmZXIKZnJvbSBoc19zZXJ2aWNlcyBpbXBvcnQgSHNTZXJ2aWNlCmltcG9ydCBzdGF0aWNfZGF0YQpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVVdGlsaXRlcyBhcyBzdUNsYXNzCgpmcm9tIGh0dHBfZXhjaGFuZ2UgaW1wb3J0IHBvc3RfY2hhbmdlc190b19zZXJ2ZXIKaW1wb3J0IHdpZGdldHMKaW1wb3J0IHVpX2dsb2JhbAppbXBvcnQgYmFzZTY0CmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgpub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCmN1cnJlbnRfc2NyZWVuOiAnU2NyZWVuJyA9IE5vbmUKX3JzX3NldHRpbmdzID0gbm9DbGFzcygicnNfc2V0dGluZ3MiKQoKY2xhc3MgU2NyZWVuKEFCQyk6CiAgICBzY3JlZW5fbmFtZTogc3RyCiAgICBwcm9jZXNzX25hbWU6IHN0cgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHNlbGYuaGFzaF9tYXA6IEhhc2hNYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IHJzX3NldHRpbmdzCiAgICAgICAgc2VsZi5saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xpc3RlbmVyJ10KICAgICAgICBzZWxmLmV2ZW50OiBzdHIgPSBzZWxmLmhhc2hfbWFwWydldmVudCddCiAgICAgICAgc2VsZi5maW5pc2hfcHJvY2VzcyA9IEZhbHNlCiAgICAgICAgc2VsZi5wYXJlbnRfc2NyZWVuID0gTm9uZQogICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnM6IExpc3RbQ2FsbGFibGVdPVtdCiAgICAgICAgc2VsZi5pbml0X3BhcmFtcyA9IHt9CgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIEBhYnN0cmFjdG1ldGhvZAogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5yZW1vdmUoZid7c2VsZi5fX2NsYXNzX18uX19uYW1lX199X2luaXQnKQoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShhcmdzKQogICAgICAgIHNlbGYuX2luaXRfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5fdmFsaWRhdGVfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLnNjcmVlbl9uYW1lKQoKICAgIGRlZiBzaG93X3Byb2Nlc3NfcmVzdWx0KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShhcmdzKQogICAgICAgIHNlbGYuX2luaXRfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5fdmFsaWRhdGVfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KHNlbGYucHJvY2Vzc19uYW1lLCBzZWxmLnNjcmVlbl9uYW1lKQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChmJ3tzZWxmLl9fY2xhc3NfXy5fX25hbWVfX31faW5pdCcpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgcmVmcmVzaF9zY3JlZW4oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX2NsZWFyX3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIGtleSBpbiBzZWxmLnNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgdG9hc3Qoc2VsZiwgdGV4dCk6CiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCh0ZXh0KQoKICAgIGRlZiBfaXNfcmVzdWx0X3Bvc2l0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdFBvc2l0aXZlJwoKICAgIGRlZiBfaXNfcmVzdWx0X25lZ2F0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdE5lZ2F0aXZlJwoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmJ3tzZWxmLnByb2Nlc3NfbmFtZX0gLyB7c2VsZi5zY3JlZW5fbmFtZX0nCgogICAgZGVmIF92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmJ1Byb2Nlc3M6IHtzZWxmLnByb2Nlc3NfbmFtZX0sIHNjcmVlbjoge3NlbGYuc2NyZWVuX25hbWV9LicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidGb3Iga2V5IHtrZXl9IG11c3QgYmUgc2V0IHZhbHVlIG5vdCBOb25lJykKCiAgICBkZWYgZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCiAgICBkZWYgcHV0X25vdGlmaWNhdGlvbihzZWxmLCB0ZXh0LCB0aXRsZT1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbih0ZXh0LCB0aXRsZSkKCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfbGlzdGVuZXJfbm90X2ltcGxlbWVudGVkKHNlbGYpOgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IgKGYnbGlzdGVuZXIge3NlbGYubGlzdGVuZXJ9IG5vdCBpbXBsZW1lbnRlZCcpCgogICAgZGVmIF9pc19pbml0X2hhbmRsZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoZid7c2VsZi5fX2NsYXNzX18uX19uYW1lX199X2luaXQnKQoKICAgIGRlZiBfaW5pdF9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrIGluIHNlbGYuc2NyZWVuX3ZhbHVlczoKICAgICAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzW2tdID0gc2VsZi5oYXNoX21hcFtrXQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5maW5pc2hfcHJvY2VzcyA9IFRydWUKICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2dldF9zZWxlY3RlZF9jYXJkX2RhdGEoc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc2VsZWN0ZWRfY2FyZF9kYXRhJykKCiAgICAgICAgcmV0dXJuIHNlbGVjdGVkX2NhcmRfZGF0YQoKICAgIGRlZiBfcnVuX29uX3N0YXJ0X2hhbmRsZXJzKHNlbGYpOgogICAgICAgIGZvciBoYW5kbGVyIGluIHNlbGYub25fc3RhcnRfaGFuZGxlcnM6CiAgICAgICAgICAgIGhhbmRsZXIoKQogICAgICAgICAgICBzZWxmLm9uX3N0YXJ0X2hhbmRsZXJzLnJlbW92ZShoYW5kbGVyKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZm9ybWF0X3F1YW50aXR5KHF0dHkpOgogICAgICAgIGlmIGZsb2F0KHF0dHkpICUgMSA9PSAwOgogICAgICAgICAgICByZXR1cm4gaW50KGZsb2F0KHF0dHkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBxdHR5CgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlLCByc19zZXR0aW5ncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gcnNfc2V0dGluZ3MuZ2V0KCdEb2NUeXBlQ2FyZFRleHRTaXplJykKICAgICAgICAgICAgc2VsZi5UZXh0Q29sb3IgPSAnIzMzMzMzMycKICAgICAgICAgICAgc2VsZi5CYWNrZ3JvdW5kQ29sb3IgPSAnRkZDQzk5JwogICAgICAgICAgICBzZWxmLndlaWdodCA9IDAKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiMgPT09PT09PT09PT09PT09PT09PT0gUHJpbnRpbmcgc2NyZWVucyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIEh0bWxWaWV3KFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQoNC10LfRg9C70YzRgtCw0YInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgbGFibGVfZnVsbF9wYXRoID0gc2VsZi5wcmludF9uY2wuZ2V0KCdsYWJsZV9mdWxsX3BhdGgnKQogICAgICAgIGJhcmNvZGVfd2lkdGggPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV93aWR0aCcpCiAgICAgICAgYmFyY29kZV93aWR0aCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV93aWR0aCkpKSBpZiBiYXJjb2RlX3dpZHRoIGVsc2UgJzIwJwogICAgICAgIGJhcmNvZGVfaGVpZ2h0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfaGVpZ2h0JykKICAgICAgICBiYXJjb2RlX2hlaWdodCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9oZWlnaHQpKSkgaWYgYmFyY29kZV9oZWlnaHQgZWxzZSAnMjAnCiAgICAgICAgYmFyY29kZV9sZWZ0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfbGVmdCcpCiAgICAgICAgYmFyY29kZV9sZWZ0ID0gc3RyKGludChmbG9hdChiYXJjb2RlX2xlZnQpKSkgaWYgYmFyY29kZV9sZWZ0IGVsc2UgJzAnCiAgICAgICAgYmFyY29kZV9yaWdodCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3JpZ2h0JykKICAgICAgICBiYXJjb2RlX3JpZ2h0ID0gc3RyKGludChmbG9hdChiYXJjb2RlX3JpZ2h0KSkpIGlmIGJhcmNvZGVfcmlnaHQgZWxzZSAnMCcKICAgICAgICBiYXJjb2RlX3VwID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdXAnKQogICAgICAgIGJhcmNvZGVfdXAgPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfdXApKSkgaWYgYmFyY29kZV91cCBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfZG93biA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2Rvd24nKQogICAgICAgIGJhcmNvZGVfZG93biA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9kb3duKSkpIGlmIGJhcmNvZGVfZG93biBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfdHlwZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3R5cGVfY2xpY2snKSBvciAnZWFuMTMnCgogICAgICAgIGJhcmNvZGVfdHlwZXMgPSBbJ2VhbjEzJywgJ2NvZGUzOScsICdjb2RlMTI4JywgJ3FyLWNvZGUnXQoKICAgICAgICB0ZW1wbGF0ZV9kaXIsIHRlbXBsYXRlX2ZpbGUgPSBvcy5wYXRoLnNwbGl0KGxhYmxlX2Z1bGxfcGF0aCkKICAgICAgICBodG1sX2RvY19wYXJhbXMgPSBIVE1MRG9jdW1lbnQuZmluZF90ZW1wbGF0ZV92YXJpYWJsZXModGVtcGxhdGVfZGlyLCB0ZW1wbGF0ZV9maWxlKQogICAgICAgIGRvY19kZXRhaWxzID0gc2VsZi5nZXRfZGV0YWlsc19kYXRhKGh0bWxfZG9jX3BhcmFtcykKCiAgICAgICAgZGF0YV9mb3JfcHJpbnRpbmcgPSB7ZWxlbVsna2V5J106IGVsZW1bJ3ZhbHVlJ10gZm9yIGVsZW0gaW4gZG9jX2RldGFpbHN9CiAgICAgICAgZGF0YV9mb3JfcHJpbnRpbmcudXBkYXRlKGJhcmNvZGU9JzEyMzEyMzEyMzEyMycpCiAgICAgICAgbGlzdF9mb3JfY2hvb3NlID0gJzsnLmpvaW4oZGF0YV9mb3JfcHJpbnRpbmcua2V5cygpKQoKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBodG1sID0gSFRNTERvY3VtZW50KHRlbXBsYXRlX2RpciwgdGVtcGxhdGVfZmlsZSkuY3JlYXRlX2h0bWwoCiAgICAgICAgICAgIGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9YmFyY29kZV90eXBlKQoKICAgICAgICBodG1sID0gSFRNTERvY3VtZW50LmluamVjdF9jc3Nfc3R5bGUoCiAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgIHdpZHRoPWJhcmNvZGVfd2lkdGgsCiAgICAgICAgICAgIGhlaWdodD1iYXJjb2RlX2hlaWdodCwKICAgICAgICAgICAgeD1zdHIoaW50KGJhcmNvZGVfcmlnaHQpIC0gaW50KGJhcmNvZGVfbGVmdCkpLAogICAgICAgICAgICB5PXN0cihpbnQoYmFyY29kZV9kb3duKSAtIGludChiYXJjb2RlX3VwKSksCiAgICAgICAgKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3dpZHRoJywgYmFyY29kZV93aWR0aCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9oZWlnaHQnLCBiYXJjb2RlX2hlaWdodCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9sZWZ0JywgYmFyY29kZV9sZWZ0KQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX3JpZ2h0JywgYmFyY29kZV9yaWdodCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV91cCcsIGJhcmNvZGVfdXApCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfZG93bicsIGJhcmNvZGVfZG93bikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV90eXBlcycsICc7Jy5qb2luKGJhcmNvZGVfdHlwZXMpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdodG1sJywgaHRtbCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGF0YV9mb3JfcHJpbnRpbmdfa2V5cycsIGxpc3RfZm9yX2Nob29zZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbWF0Y2hpbmdfdGFibGUnLCB0YWJsZV92aWV3LnRvX2pzb24oKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBnZXRfZGV0YWlsc19kYXRhKHNlbGYsIGh0bWxfZG9jX3BhcmFtczogc2V0KSAtPiBMaXN0W0RpY3RdOgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0gc2VsZi5oYXNoX21hcC5nZXQoJ21hdGNoaW5nX3RhYmxlJykKICAgICAgICBpZiBub3QgbWF0Y2hpbmdfdGFibGU6CiAgICAgICAgICAgIHJldHVybiBbeydrZXknOiBlbGVtLCAndmFsdWUnOiBlbGVtfSBmb3IgZWxlbSBpbiBodG1sX2RvY19wYXJhbXNdCiAgICAgICAgbWF0Y2hpbmdfdGFibGUgPSBqc29uLmxvYWRzKG1hdGNoaW5nX3RhYmxlKQogICAgICAgIG1hdGNoaW5nX3RhYmxlX2RhdGEgPSBtYXRjaGluZ190YWJsZVsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ10KICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGZvciBlbGVtIGluIGh0bWxfZG9jX3BhcmFtczoKICAgICAgICAgICAgdmFsdWUgPSBlbGVtCiAgICAgICAgICAgIGZvciBkYXRhIGluIG1hdGNoaW5nX3RhYmxlX2RhdGE6CiAgICAgICAgICAgICAgICBpZiBkYXRhLmdldCgna2V5JykgPT0gZWxlbToKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFbJ3ZhbHVlJ10KICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh7J2tleSc6IGVsZW0sICd2YWx1ZSc6IHZhbHVlfSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIGlmIHNlbGYucHJpbnRfbmNsLmdldCgnZnJvbV9maWxlX2Jyb3dzZXInKToKICAgICAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnZnJvbV9maWxlX2Jyb3dzZXInKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fc2F2ZSc6CiAgICAgICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgibWF0Y2hpbmdfdGFibGUiKSkKICAgICAgICAgICAgY3VycmVudF90YWJsZSA9IG1hdGNoaW5nX3RhYmxlWydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXQogICAgICAgICAgICBjdXJyZW50X3RhYmxlLnBvcCgwKQogICAgICAgICAgICBmb3IgZWwgaW4gY3VycmVudF90YWJsZToKICAgICAgICAgICAgICAgIGlmIGVsLmdldCgna2V5Jyk6CiAgICAgICAgICAgICAgICAgICAgZWwucG9wKCdfbGF5b3V0JykKCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV93aWR0aCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3dpZHRoJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX2hlaWdodCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2hlaWdodCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9sZWZ0Jywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfbGVmdCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9yaWdodCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3JpZ2h0JyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3VwJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdXAnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfZG93bicsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2Rvd24nKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ21hdGNoaW5nX3RhYmxlJywganNvbi5kdW1wcyhjdXJyZW50X3RhYmxlKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX3R5cGUnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV90eXBlX2NsaWNrJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX25hbWUnLCBzZWxmLnByaW50X25jbC5nZXQoJ2xhYmxlX2ZpbGVfbmFtZScpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfcGF0aCcsIHNlbGYucHJpbnRfbmNsLmdldCgnbGFibGVfZnVsbF9wYXRoJyksIFRydWUpCiAgICAgICAgICAgIGh0bWwgPSBzZWxmLmhhc2hfbWFwLmdldCgnaHRtbCcpCgogICAgICAgICAgICBvbGRfcHJldmlld190bXAgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCiAgICAgICAgICAgIGlmIG9sZF9wcmV2aWV3X3RtcCBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXdfdG1wKToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlld190bXApCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKCiAgICAgICAgICAgIG9sZF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICAgICAgaWYgb2xkX3ByZXZpZXcgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3KToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlldykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1ByaW50UHJldmlldycsIGh0bWwpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdQcmludFRvQml0bWFwJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdQcmludEJpdG1hcCc6CiAgICAgICAgICAgIHBhdGhfdG9fcG5nID0gc2VsZi5oYXNoX21hcC5nZXQoJ1ByaW50Qml0bWFwUGF0aCcpCiAgICAgICAgICAgICMg0J/QtdGA0LXQvdC+0YEg0YjQsNCx0LvQvtC90L7QsiDQsiDQvtGC0LTQtdC70YzQvdGD0Y4g0L/QsNC/0LrRgy4KICAgICAgICAgICAgZGlyZWN0b3J5LCBuYW1lID0gb3MucGF0aC5zcGxpdChwYXRoX3RvX3BuZykKICAgICAgICAgICAgbmV3X3BhdGggPSBvcy5wYXRoLmpvaW4oZGlyZWN0b3J5LCAnc2F2ZWRfbGFiZWxfdGVtcGxhdGVzJywgbmFtZSkKICAgICAgICAgICAgb3MubWFrZWRpcnMob3MucGF0aC5qb2luKGRpcmVjdG9yeSwgJ3NhdmVkX2xhYmVsX3RlbXBsYXRlcycpLCBleGlzdF9vaz1UcnVlKQogICAgICAgICAgICBzaHV0aWwuY29weShwYXRoX3RvX3BuZywgbmV3X3BhdGgpCiAgICAgICAgICAgIG9zLnJlbW92ZShwYXRoX3RvX3BuZykKCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScsIG5ld19wYXRoLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L0g0YHQvtGF0YDQsNC90ZHQvScpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnZnJvbV9maWxlX2Jyb3dzZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgY2FyZF9kYXRhID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJykpCiAgICAgICAgICAgIGlmIG5vdCBjYXJkX2RhdGE6CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2xpc3RfZmllbGQnLCBzZWxmLmhhc2hfbWFwLmdldCgnZGF0YV9mb3JfcHJpbnRpbmdfa2V5cycpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCfQndCw0YHRgtGA0L7QudC60LDQodC+0L7RgtCy0LXRgtGB0YLQstC40Y/QlNC40LDQu9C+0LMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPWNhcmRfZGF0YVsna2V5J10sIGJ1dHRvbnM9WyfQlNCwJywgJ9Cd0LXRgiddKQoKICAgICAgICBlbGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCJldmVudCIpID09ICdvblJlc3VsdFBvc2l0aXZlJzoKICAgICAgICAgICAgY2FyZF9wb3NpdGlvbiA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQogICAgICAgICAgICBtYXRjaGluZ190YWJsZSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoIm1hdGNoaW5nX3RhYmxlIikpCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IG1hdGNoaW5nX3RhYmxlWydjdXN0b210YWJsZSddWyd0YWJsZWRhdGEnXVtjYXJkX3Bvc2l0aW9uXQogICAgICAgICAgICBjdXJyZW50X2VsZW1bJ3ZhbHVlJ10gPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0X2ZpZWxkJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIm1hdGNoaW5nX3RhYmxlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbi5kdW1wcyhtYXRjaGluZ190YWJsZSwgZW5zdXJlX2FzY2lpPUZhbHNlKS5lbmNvZGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXRmOCcpLmRlY29kZSgpKQogICAgICAgICAgICBzZWxmLm9uX3N0YXJ0KCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRldGFpbHM6IExpc3RbZGljdF0pOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgZm9yIHJlY29yZCBpbiBkZXRhaWxzOgogICAgICAgICAgICByZWNvcmQudXBkYXRlKF9sYXlvdXQ9c2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpKQogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gIiNGRkZGRkYiIGlmIHJlY29yZFsndmFsdWUnXSBlbHNlICcjRkJFOUU3JwogICAgICAgICAgICByZWNvcmRbJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kX2NvbG9yCiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHJlY29yZCkKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ca0LvRjtGHJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQl9C90LDRh9C10L3QuNC1Jywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BrZXknLCBzZWxmLnJzX3NldHRpbmdzKSwKCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B2YWx1ZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgoKY2xhc3MgVGVtcGxhdGVzTGlzdChTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5nZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goKQogICAgICAgIGlmIG5vdCBsaXN0X2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyINC/0YPRgdGCJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldyhsaXN0X2RhdGEpCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCd0ZW1wbGF0ZXNfY2FyZHMnLCBkb2NfY2FyZHMudG9fanNvbigpLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0ZW1wbGF0ZXNfY2FyZHMnLCBkb2NfY2FyZHMudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ21hdGNoaW5nX3RhYmxlJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScpKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmxlX2ZpbGVfbmFtZScsIGNhcmRfZGF0YS5nZXQoJ2ZpbGVfbmFtZScpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmxlX2Z1bGxfcGF0aCcsIGNhcmRfZGF0YS5nZXQoJ2Z1bGxfcGF0aCcpLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQoNC10LfRg9C70YzRgtCw0YInKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF9kYXRlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykKCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0iaG9yaXpvbnRhbCIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfc2l6ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY3JlYXRpb25fdGltZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBnZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goc2VsZik6CiAgICAgICAgdGVtcGxhdGVzX2RpciA9IHNlbGYucHJpbnRfbmNsLmdldCgnbGFiZWxfdGVtcGxhdGVzX2RpcicpCiAgICAgICAgZm9sZGVyX3BhdGggPSB0ZW1wbGF0ZXNfZGlyIG9yIG9zLnBhdGguam9pbihzdUNsYXNzLmdldF90ZW1wX2RpcigpLCAnbGFiZWxzJykKICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmVsX3RlbXBsYXRlc19kaXInLCBmb2xkZXJfcGF0aCwgVHJ1ZSkKICAgICAgICBodG1sX2ZpbGVzX2luZm8gPSBbXQoKICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZXMgaW4gb3Mud2Fsayhmb2xkZXJfcGF0aCk6CiAgICAgICAgICAgIGZvciBmaWxlIGluIGZpbGVzOgogICAgICAgICAgICAgICAgaWYgZmlsZS5sb3dlcigpLmVuZHN3aXRoKCcuaHRtJyk6ICAjIGFuZCBtYXNrIGluIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHJvb3QsIGZpbGUpCiAgICAgICAgICAgICAgICAgICAgZmlsZV9zaXplX2J5dGVzID0gb3MucGF0aC5nZXRzaXplKGZpbGVfcGF0aCkKICAgICAgICAgICAgICAgICAgICBmaWxlX3NpemVfa2IgPSBmaWxlX3NpemVfYnl0ZXMgLyAxMDI0ICAjIENvbnZlcnQgYnl0ZXMgdG8ga2lsb2J5dGVzCiAgICAgICAgICAgICAgICAgICAgY3JlYXRpb25fdGltZSA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAob3MucGF0aC5nZXRjdGltZShmaWxlX3BhdGgpKQogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lID0gY3JlYXRpb25fdGltZS5zdHJmdGltZSgKICAgICAgICAgICAgICAgICAgICAgICAgJyVZLSVtLSVkICVIOiVNOiVTJykgICMgRm9ybWF0IGRhdGV0aW1lIGZvciB1c2VyIGV5ZXMgKSkKCiAgICAgICAgICAgICAgICAgICAgZmlsZV9pbmZvID0gewogICAgICAgICAgICAgICAgICAgICAgICAnZnVsbF9wYXRoJzogZmlsZV9wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAnZmlsZV9uYW1lJzogZmlsZSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbGVfc2l6ZSc6IGYne2ZpbGVfc2l6ZV9rYjouMmZ9IEtCJywKICAgICAgICAgICAgICAgICAgICAgICAgIyBGb3JtYXQgZmlsZSBzaXplIHdpdGggMiBkZWNpbWFsIHBsYWNlcwogICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRpb25fdGltZSc6IGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxfZmlsZXNfaW5mby5hcHBlbmQoZmlsZV9pbmZvKQogICAgICAgIHJldHVybiBodG1sX2ZpbGVzX2luZm8KCgpjbGFzcyBQcmludFNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoJ3ByaW50X25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHByaW50X3Rocm91Z2ggPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByaW50X3Rocm91Z2gnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjaGVja19ib3hfYmx1ZXRvb3RoX3ByaW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIocHJpbnRfdGhyb3VnaCA9PSAnQlQnKS5sb3dlcigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjaGVja19ib3hfd2lmaV9wcmludCcsIHN0cihwcmludF90aHJvdWdoID09ICdXaUZpJykubG93ZXIoKSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9ibHVldG9vdGhfcHJpbnRlcl9zZXR0aW5ncyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggQmx1ZXRvb3RoJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fd2lmaV9wcmludGVyX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fbGFiZWxfdGVtcGxhdGVzX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnY2hlY2tfYm94X2JsdWV0b290aF9wcmludCc6CiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgncHJpbnRfdGhyb3VnaCcsICdCVCcsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cf0LXRh9Cw0YLRjCDRh9C10YDQtdC3IEJsdWV0b290aCcpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnY2hlY2tfYm94X3dpZmlfcHJpbnQnOgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByaW50X3Rocm91Z2gnLCAnV2lGaScsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cf0LXRh9Cw0YLRjCDRh9C10YDQtdC3IFdpRmknKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBQcmludEJsdWV0b290aFNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IEJsdWV0b290aCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5idF9uY2wgPSBub0NsYXNzKCJidF9zZXR0aW5ncyIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHByaW50ZXIgPSBzZWxmLmJ0X25jbC5nZXQoImRlZmF1bHRfcHJpbnRlciIpIG9yICfQndC1INCy0YvQsdGA0LDQvScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGVmYXVsdF9wcmludGVyJywgcHJpbnRlcikKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9zaG93X2Nvbm5lY3RlZCc6CiAgICAgICAgICAgIGRldmljZXMgPSBzZWxmLmhhc2hfbWFwLmdldCgiQlRSZXN1bHQiKQogICAgICAgICAgICBkZXZpY2VzID0ganNvbi5sb2FkcyhkZXZpY2VzKSBpZiBkZXZpY2VzIGVsc2UgW10KICAgICAgICAgICAgamNhcmRzID0geyJjYXJkcyI6IFtdfQoKICAgICAgICAgICAgZm9yIGRldmljZSBpbiBkZXZpY2VzOgogICAgICAgICAgICAgICAgY2FyZCA9IHsia2V5IjogZGV2aWNlLmdldCgiYWRkcmVzcyIpLAogICAgICAgICAgICAgICAgICAgICAgICAiaXRlbXMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ICLQo9GB0YLRgNC+0LnRgdGC0LLQviIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInZhbHVlIjogZGV2aWNlLmdldCgibmFtZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAiIzFiMzFjMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fc2l6ZSI6ICIxMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fY29sb3IiOiAiIzFiMzFjMiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleSI6ICJNQUMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGRldmljZS5nZXQoImFkZHJlc3MiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogIiMxMzFlNjEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX3NpemUiOiAiMTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX2NvbG9yIjogIiMxYjMxYzIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJrZXkiOiAic3RhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGRldmljZS5nZXQoInN0YXRlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6ICIjMTMxZTYxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9zaXplIjogIjEyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9jb2xvciI6ICIjMWIzMWMyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBdfQoKICAgICAgICAgICAgICAgIGpjYXJkc1siY2FyZHMiXS5hcHBlbmQoY2FyZCkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJjYXJkcyIsIGpzb24uZHVtcHMoamNhcmRzKSkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3N0b3Bfc2Nhbic6CiAgICAgICAgICAgIGlmIHNlbGYuYnRfbmNsLmdldCgnc2Nhbm5pbmcnKToKICAgICAgICAgICAgICAgIHNlbGYuYnRfbmNsLnB1dCgnc2Nhbm5pbmcnLCBGYWxzZSwgVHJ1ZSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdCVFN0b3BTY2FuJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQodC60LDQvdC40YDQvtCy0LDQvdC40LUg0L7RgdGC0LDQvdC+0LLQu9C10L3QvicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9idF9kaXNjb25uZWN0JzoKICAgICAgICAgICAgaWYgc2VsZi5idF9uY2wuZ2V0KCdkZWZhdWx0X3ByaW50ZXInKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBidC5jbG9zZV9zb2NrZXQoKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdkZWZhdWx0X3ByaW50ZXInKQogICAgICAgICAgICAgICAgICAgIHNlbGYuYnRfbmNsLmRlbGV0ZSgnZGVmYXVsdF9wcmludGVyJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZGVmYXVsdF9wcmludGVyJywgJ9Cd0LUg0LLRi9Cx0YDQsNC9JykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQn9GA0LjQvdGC0LXRgCDQvtGC0LrQu9GO0YfQtdC9JykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3Ri9GFINC/0YDQuNC90YLQtdGA0L7QsicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3Ri9GFINC/0YDQuNC90YLQtdGA0L7QsicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zdGFydF9zY2FuJzoKICAgICAgICAgICAgYnRfZGlzY292ZXJfaGFuZGxlcnMgPSBbewogICAgICAgICAgICAgICAgImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJzZXQiLAogICAgICAgICAgICAgICAgIm1ldGhvZCI6ICJiZWVwO3RvYXN0PUBCVERpc2NvdmVyUmVzdWx0IiwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6ICIiCiAgICAgICAgICAgIH1dCiAgICAgICAgICAgIHNlbGYuYnRfbmNsLnB1dCgnc2Nhbm5pbmcnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiQlRTdGFydFNjYW4iLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkJURGlzY292ZXJIYW5kbGVycyIsIGpzb24uZHVtcHMoYnRfZGlzY292ZXJfaGFuZGxlcnMpKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQutCw0L3QuNGA0L7QstCw0L3QuNC1JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGJ0X2hhbmRsZXJzID0gWwogICAgICAgICAgICAgICAgeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJibHVldG9vdGhfZXJyb3IifQogICAgICAgICAgICBdCgogICAgICAgICAgICBtYWMgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKG1hYykKICAgICAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCLQndC1INC/0L7Qu9GD0YfQuNC70L7RgdGMINC/0L7QtNC60LvRjtGH0LjRgtGM0YHRjyDQuiDRg9GB0YLRgNC+0LnRgdGC0LLRgyIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0YLQtdGB0YInKQogICAgICAgICAgICBjb25uZWN0ZWQgPSBidC5jb25uZWN0X3RvX2NsaWVudChkZXZpY2UsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICBpZiBub3QgY29ubmVjdGVkOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgi0KPRgdGC0YDQvtC50YHRgtCy0L4g0L3QtSDRj9Cy0LvRj9C10YLRgdGPINC/0YDQuNC90YLQtdGA0L7QvCIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5idF9uY2wucHV0KCJkZWZhdWx0X3ByaW50ZXIiLCBtYWMsIEZhbHNlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiZGVmYXVsdF9wcmludGVyIiwgbWFjKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQo9GB0L/QtdGI0L3QvicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl90ZXN0X3ByaW50JzoKICAgICAgICAgICAgaWYgc2VsZi5idF9uY2wuZ2V0KCdkZWZhdWx0X3ByaW50ZXInKToKICAgICAgICAgICAgICAgIHpwbCA9ICdeWEFeQ0ZBLDMwXkZPMTAsNTBeRkRUZXN0XkZTXkJZMywyLDEyMF5GTzEwLDE1MF5CQ15GRDEyMzQ1Njc4XkZTXlhaJwogICAgICAgICAgICAgICAgc2VudCwgcmVzdWx0ID0gUHJpbnRTZXJ2aWNlLnByaW50X2J0KHpwbCkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QocmVzdWx0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90YvRhSDQv9GA0LjQvdGC0LXRgNC+0LInKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBQcmludFdpRmlTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGltcG9ydCByZQogICAgICAgIGlwID0gc2VsZi5wcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBpcDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3dpX2ZpX2lwJywgaXApCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbmZvX3dpZmlfY3VycmVudF9pcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYnSVAg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsDoge2lwfScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaXAgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lfZmlfaXAnKQogICAgICAgICAgICBpZiBpcDoKICAgICAgICAgICAgICAgIHBhdHRlcm4gPSByJ14oXGR7MSwzfVwuKXszfVxkezEsM30kJwogICAgICAgICAgICAgICAgaWYgbm90IHJlLm1hdGNoKHBhdHRlcm4sIGlwKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnd2lfZmlfaXAnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXQstC10YDQvdGL0Lkg0YTQvtGA0LzQsNGCIElQJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90L7Qs9C+INC/0YDQuNC90YLQtdGA0LAnKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2luZm9fd2lmaV9jdXJyZW50X2lwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYnSVAg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsDoge2lwfScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLCBmJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdC+0LPQviDQv9GA0LjQvdGC0LXRgNCwJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl93aWZpX3NhdmVfaXAnOgogICAgICAgICAgICBzZWxmLl93aWZpX3NhdmVfaXAoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl93aWZpX2RlbGV0ZV9pcCc6CiAgICAgICAgICAgIHNlbGYuX3dpZmlfZGVsZXRlX2lwKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGVzdF93aV9maSc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ci0LXRgdGCINC/0LXRh9Cw0YLQuCcpCiAgICAgICAgICAgIHNlbGYuX3Rlc3Rfd2lfZmkoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl93aV9maV9wcmludF96cGwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQotC10YHRgiB6cGwnKQogICAgICAgICAgICBzZWxmLl9wcmludF96cGwoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3dpZmlfc2F2ZV9pcChzZWxmKToKICAgICAgICBpbXBvcnQgcmUKICAgICAgICBpcCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd3aV9maV9pcCcpCiAgICAgICAgaWYgbm90IGlwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHBhdHRlcm4gPSByJ14oXGR7MSwzfVwuKXszfVxkezEsM30kJwogICAgICAgIGlmIG5vdCByZS5tYXRjaChwYXR0ZXJuLCBpcCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCd3aV9maV9pcCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXQstC10YDQvdGL0Lkg0YTQvtGA0LzQsNGCIElQJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdjdXJyZW50X2lwJywgaXAsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCdJUCDQv9GA0LjQvdGC0LXRgNCwINC30LDQv9C40YHQsNC9JykKCiAgICBkZWYgX3dpZmlfZGVsZXRlX2lwKHNlbGYpOgogICAgICAgIGlwID0gc2VsZi5wcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LUg0YPQutCw0LfQsNC9IGlwJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ3dpX2ZpX2lwJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2N1cnJlbnRfaXAnKQogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ0lQINC/0YDQuNC90YLQtdGA0LAg0YPQtNCw0LvRkdC9JykKCiAgICBkZWYgX3ByaW50X3pwbChzZWxmKToKICAgICAgICB6cGwgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lfZmlfenBsX2lucHV0JykKICAgICAgICBpZiBub3QgenBsOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10YIgenBsINC60L7QtNCwINC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3dpZmlfZGF0YV90b19wcmludCcsIHpwbCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygncHJpbnRfd2lmaScpCgogICAgZGVmIF90ZXN0X3dpX2ZpKHNlbGYpOgogICAgICAgIHpwbCA9ICdeWEFeQ0ZBLDMwXkZPMTAsNTBeRkRUZXN0XkZTXkJZMywyLDEyMF5GTzEwLDE1MF5CQ15GRDEyMzQ1Njc4XkZTXlhaJwogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnd2lmaV9kYXRhX3RvX3ByaW50JywgenBsLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCgpjbGFzcyBQcmludExhYmVsVGVtcGxhdGVzU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYucHJpbnRfbmNsID0gbm9DbGFzcygicHJpbnRfbmNsIikKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBIc1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICB0ZW1wbGF0ZSA9IHNlbGYucHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJykgb3IgJ9Cd0LXRgicKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJywgZifQotC10LrRg9GJ0LjQuSDRiNCw0LHQu9C+0L06IHt0ZW1wbGF0ZX0nKQogICAgICAgIHBhdGhfdG9fbGFiZWxfcHJldmlld19pbWFnZSA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgaWYgbm90IHBhdGhfdG9fbGFiZWxfcHJldmlld19pbWFnZToKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgdGVtcF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgIHBhdGggPSB0ZW1wX3ByZXZpZXcgaWYgdGVtcF9wcmV2aWV3IGVsc2UgcGF0aF90b19sYWJlbF9wcmV2aWV3X2ltYWdlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnLCAnficgKyBwYXRoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX2dldF9sYWJlbHMnOgogICAgICAgICAgICBzZWxmLl9nZXRfbGFiZWxzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2VsZWN0X2xhYmVsX3RlbXBsYXRlJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kZWxldGVfdGVtcGxhdGVfc2V0dGluZ3MnOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV90ZW1wbGF0ZV9zZXR0aW5ncygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2xhYmVsX3RlbXBsYXRlX3NpemVfc2V0dGluZ3MnOgogICAgICAgICAgICBwYXRoX3RvX2xhYmVsID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICAgICAgaWYgbm90IHBhdGhfdG9fbGFiZWwgb3Igbm90IG9zLnBhdGguaXNmaWxlKHBhdGhfdG9fbGFiZWwpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQvdCw0YfQsNC70LAg0L3Rg9C20L3QviDQstGL0LHRgNCw0YLRjCDRiNCw0LHQu9C+0L0nKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KDQsNC30LzQtdGA0YsnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9sYWJlbHMoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuZ2V0X3RlbXBsYXRlcygpCiAgICAgICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSAhPSAyMDA6CiAgICAgICAgICAgICAgICByZWFzb24gPSBhbnN3ZXJbJ2Vycm9yX3Bvb2wnXQogICAgICAgICAgICAgICAgcmFpc2UgZifQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvDoge3JlYXNvbn0nCgogICAgICAgICAgICBvdXRwdXRfZm9sZGVyID0gb3MucGF0aC5qb2luKHN1Q2xhc3MuZ2V0X3RlbXBfZGlyKCksICdsYWJlbHMnKQoKICAgICAgICAgICAgb3MubWFrZWRpcnMob3V0cHV0X2ZvbGRlciwgZXhpc3Rfb2s9VHJ1ZSkKCiAgICAgICAgICAgIGRhdGFfbGlzdCA9IGFuc3dlclsnZGF0YSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZidkYXRhX2xpc3Q6e3R5cGUoZGF0YV9saXN0KX0sIHtkYXRhX2xpc3R9JykKCiAgICAgICAgICAgIGZvciBkYXRhX2RpY3QgaW4gZGF0YV9saXN0OgogICAgICAgICAgICAgICAgZmlsZV9uYW1lID0gc2VsZi5fY29ycmVjdF9maWxlbmFtZShkYXRhX2RpY3RbJ25hbWUnXSkgKyAnLmh0bScKICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbihvdXRwdXRfZm9sZGVyLCBmaWxlX25hbWUpCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICd3JywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS53cml0ZShiYXNlNjQuYjY0ZGVjb2RlKGRhdGFfZGljdFsnaHRtbCddKS5kZWNvZGUoJ3V0Zi04JykpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgKICAgICAgICAgICAgICAgICAgICAgICAgZifQntGI0LjQsdC60LAg0YHQvtGF0YDQsNC90LXQvdC40Y8g0YTQsNC50LvQsCB7ZmlsZV9wYXRofToge3N0cihlKX0nKQogICAgICAgICAgICAgICAgICAgIHJhaXNlIGYn0J7RiNC40LHQutCwINGB0L7RhdGA0LDQvdC10L3QuNGPINGE0LDQudC70LAge2ZpbGVfcGF0aH06IHtzdHIoZSl9JwogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2xhYmVsX3RlbXBsYXRlc19kaXInLCBvdXRwdXRfZm9sZGVyLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L3RiyDQt9Cw0LPRgNGD0LbQtdC90YsnKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzdHIoZSkpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9jb3JyZWN0X2ZpbGVuYW1lKGZpbGVuYW1lKToKICAgICAgICBpbGxlZ2FsX2NoYXJzID0gWyc8JywgJz4nLCAnOicsICciJywgIiciLCAnLycsICdcXCcsICd8JywgJz8nLCAnKicsICI8IiwgIj4iLAogICAgICAgICAgICAgICAgICAgICAgICAgJ1x4MDAnXQogICAgICAgIGZvciBjaGFyIGluIGlsbGVnYWxfY2hhcnM6CiAgICAgICAgICAgIGZpbGVuYW1lID0gZmlsZW5hbWUucmVwbGFjZShjaGFyLCAnJykKICAgICAgICByZXR1cm4gZmlsZW5hbWUKCiAgICBkZWYgZGVsZXRlX3RlbXBsYXRlX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV93aWR0aCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX2hlaWdodCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX2xlZnQnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV9yaWdodCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3VwJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfZG93bicpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdtYXRjaGluZ190YWJsZScpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX3R5cGUnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfcGF0aCcpCgogICAgICAgIG9sZF9wcmV2aWV3X3RtcCA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKICAgICAgICBpZiBvbGRfcHJldmlld190bXAgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3X3RtcCk6CiAgICAgICAgICAgIG9zLnJlbW92ZShvbGRfcHJldmlld190bXApCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgIG9sZF9wcmV2aWV3ID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICBpZiBvbGRfcHJldmlldyBhbmQgb3MucGF0aC5leGlzdHMob2xkX3ByZXZpZXcpOgogICAgICAgICAgICBvcy5yZW1vdmUob2xkX3ByZXZpZXcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKCgpjbGFzcyBQcmludFRlbXBsYXRlU2l6ZVNldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCg0LDQt9C80LXRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHdpZHRoX3RlbXBsYXRlID0gc2VsZi5oYXNoX21hcC5nZXQoJ3dpZHRoX3ByaW50X3RlbXBsYXRlJykKICAgICAgICB3aWR0aF90ZW1wbGF0ZSA9IGludChmbG9hdCh3aWR0aF90ZW1wbGF0ZSkpIGlmIHdpZHRoX3RlbXBsYXRlIGVsc2UgNTAKICAgICAgICBoZWlnaHRfdGVtcGxhdGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnaGVpZ2h0X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBoZWlnaHRfdGVtcGxhdGUgPSBpbnQoZmxvYXQoaGVpZ2h0X3RlbXBsYXRlKSkgaWYgaGVpZ2h0X3RlbXBsYXRlIGVsc2UgNTAKICAgICAgICBkcG1tID0gc2VsZi5oYXNoX21hcC5nZXQoJ2RwbW1fcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGRwbW0gPSBpbnQoZHBtbSkgaWYgZHBtbSBlbHNlIDgKICAgICAgICBpbWFnZV9oZWlnaHQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBpbWFnZV9oZWlnaHQgPSBpbnQoZmxvYXQoaW1hZ2VfaGVpZ2h0KSkgaWYgaW1hZ2VfaGVpZ2h0IGVsc2UgNTAKICAgICAgICBpbWFnZV93aWR0aCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgaW1hZ2Vfd2lkdGggPSBpbnQoZmxvYXQoaW1hZ2Vfd2lkdGgpKSBpZiBpbWFnZV93aWR0aCBlbHNlIDUwCiAgICAgICAgbGwgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGxsID0gaW50KGZsb2F0KGxsKSkgaWYgbGwgZWxzZSAxNQogICAgICAgIHB3ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJykKICAgICAgICBwdyA9IGludChmbG9hdChwdykpIGlmIHB3IGVsc2UgMTAwMAogICAgICAgIHkgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2VfeV9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgeSA9IGludChmbG9hdCh5KSkgaWYgeSBlbHNlIDAKICAgICAgICB4ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3hfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIHggPSBpbnQoZmxvYXQoeCkpIGlmIHggZWxzZSAwCgogICAgICAgIHBhdGhfdG9faW1nID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJykKICAgICAgICB6cGxkYXRhID0gUHJpbnRTZXJ2aWNlLm1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlPWltYWdlX3dpZHRoLAogICAgICAgICAgICBpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGU9aW1hZ2VfaGVpZ2h0LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlPWRwbW0sCiAgICAgICAgICAgIGltYWdlX2xsX3ByaW50X3RlbXBsYXRlPWxsLAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZT1wdywKICAgICAgICAgICAgaW1hZ2VfeF9wcmludF90ZW1wbGF0ZT14LAogICAgICAgICAgICBpbWFnZV95X3ByaW50X3RlbXBsYXRlPXksCiAgICAgICAgICAgIHBhdGhfdG9faW1nPXBhdGhfdG9faW1nCiAgICAgICAgKQogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnenBsZGF0YScsIHpwbGRhdGEsIFRydWUpCiAgICAgICAgc3VjY2VzcywgYW5zd2VyID0gUHJpbnRTZXJ2aWNlLnpwbF90b19wbmdfZnJvbV9hcGkoCiAgICAgICAgICAgIHpwbGRhdGEsIGRwbW0sIHdpZHRoX3RlbXBsYXRlLCBoZWlnaHRfdGVtcGxhdGUpCiAgICAgICAgaWYgbm90IHN1Y2Nlc3M6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBwYXRoLCBleHQgPSBvcy5wYXRoLnNwbGl0ZXh0KHBhdGhfdG9faW1nKQogICAgICAgIHByZXZpZXdfcGF0aCA9IHBhdGggKyAnX3ByZXZpZXcnICsgZXh0CiAgICAgICAgd2l0aCBvcGVuKHByZXZpZXdfcGF0aCwgJ3diJykgYXMgb3V0X2ZpbGU6CiAgICAgICAgICAgIHNodXRpbC5jb3B5ZmlsZW9iaihhbnN3ZXIsIG91dF9maWxlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3X3BhdGgsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3ByaW50JywgJ34nICsgcHJldmlld19wYXRoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3aWR0aF9wcmludF90ZW1wbGF0ZScsIHN0cih3aWR0aF90ZW1wbGF0ZSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hlaWdodF9wcmludF90ZW1wbGF0ZScsIHN0cihoZWlnaHRfdGVtcGxhdGUpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZScsIHN0cihpbWFnZV93aWR0aCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZScsIHN0cihpbWFnZV9oZWlnaHQpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkcG1tX3ByaW50X3RlbXBsYXRlJywgc3RyKGRwbW0pKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV9sbF9wcmludF90ZW1wbGF0ZScsIHN0cihsbCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJywgc3RyKHB3KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfeF9wcmludF90ZW1wbGF0ZScsIHN0cih4KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfeV9wcmludF90ZW1wbGF0ZScsIHN0cih5KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGlzdGVuZXInKQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zYXZlX3RlbXBsYXRlX3NpemVzJzoKICAgICAgICAgICAgdGVtcGxhdGUgPSBkaWN0KAogICAgICAgICAgICAgICAgaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnZHBtbV9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2VfeF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3hfcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX3lfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV95X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX2xsX3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX3B3X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdzYXZlZF9wcmludF90ZW1wbGF0ZScsIGpzb24uZHVtcHModGVtcGxhdGUpLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQqNCw0LHQu9C+0L0g0YHQvtGF0YDQsNC90ZHQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kZWxldGVfcHJpbnRfdGVtcGxhdGUnOgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ3NhdmVkX3ByaW50X3RlbXBsYXRlJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC9INGD0LTQsNC70ZHQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZW50X3RvX3ByaW50JzoKICAgICAgICAgICAgenBsZGF0YSA9IHNlbGYucHJpbnRfbmNsLmdldCgnenBsZGF0YScpCiAgICAgICAgICAgIFByaW50U2VydmljZS5wcmludF96cGwoenBsZGF0YSwgc2VsZi5oYXNoX21hcCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBQcmludGluZyBzY3JlZW5zIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTaW1wbGVGaWxlQnJvd3NlcihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KHQv9C40YHQvtC6INGE0LDQudC70L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9GA0L7QstC+0LTQvdC40LonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kZWJ1Z19ob3N0X2lwID0gcnNfc2V0dGluZ3MuZ2V0KCdkZWJ1Z19ob3N0X2lwJykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5EZWJ1Z1NlcnZpY2UoaXBfaG9zdD1zZWxmLmhhc2hfbWFwLmdldCgnaXBfaG9zdCcpIG9yIHNlbGYuZGVidWdfaG9zdF9pcCkgICMgJzE5Mi4xNjguMS43NycKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgY3VycmVudF9kaXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9kaXInKSBvciBzdUNsYXNzLmdldF90ZW1wX2RpcigpCiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5nZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goY3VycmVudF9kaXIpCiAgICAgICAgZG9jX2NhcmRzID0gc2VsZi5fZ2V0X2RvY19jYXJkc192aWV3KGxpc3RfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9kaXInLCBjdXJyZW50X2RpcikKICAgICAgICBzZWxmLmhhc2hfbWFwWydmaWxlX2Jyb3dzZXJfY2FyZHMnXSA9IGRvY19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBjdXJyZW50X2RpcmVjdG9yeSA9IFBhdGgoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZGlyJykpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX2dldF91cCc6CiAgICAgICAgICAgIGlmIG5vdCBvcy5hY2Nlc3MoY3VycmVudF9kaXJlY3RvcnkucGFyZW50LCBvcy5SX09LKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CU0L7RgdGC0YPQvyDQt9Cw0L/RgNC10YnRkdC9JykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2RpciddID0gY3VycmVudF9kaXJlY3RvcnkucGFyZW50CgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfZGF0YSIpKQogICAgICAgICAgICBpZiBjdXJyZW50X2VsZW1bJ2ZpbGVfdHlwZSddID09ICdGb2xkZXInOgogICAgICAgICAgICAgICAgbmV3X2RpciA9IFBhdGgoY3VycmVudF9kaXJlY3RvcnksIGN1cnJlbnRfZWxlbVsnZmlsZV9uYW1lJ10pCiAgICAgICAgICAgICAgICBpZiBvcy5hY2Nlc3MobmV3X2Rpciwgb3MuUl9PSyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9kaXInXSA9IG5ld19kaXIKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdMYXlvdXRBY3Rpb24nOgogICAgICAgICAgICBzZWxmLl9sYXlvdXRfYWN0aW9uKCkKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhOiBMaXN0W0RpY3RdKToKICAgICAgICBmb3Igcm93IGluIHRhYmxlX2RhdGE6CiAgICAgICAgICAgIGlmIHJvd1snZmlsZV90eXBlJ10gIT0gJ0ZpbGUnOgogICAgICAgICAgICAgICAgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfbGF5b3V0KGlzX2ZpbGU9RmFsc2UpCiAgICAgICAgICAgIGVsaWYgcm93WydleHRlbnNpb24nXSA9PSAnLmh0bSc6CiAgICAgICAgICAgICAgICByb3dbJ19sYXlvdXQnXSA9IHNlbGYuX2dldF9sYXlvdXQoaXNfaHRtPVRydWUpCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgc2VsZi5fZ2V0X2xheW91dCgpLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhLAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfZ2V0X2xheW91dChzZWxmLCBpc19maWxlOiBib29sID0gVHJ1ZSwgaXNfaHRtOiBib29sID0gRmFsc2UpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQogICAgICAgIHBvcHVwX3ZhbHVlcyA9IFsn0JjQvdGE0L4nXQogICAgICAgIGlmIGlzX2ZpbGU6CiAgICAgICAgICAgIHBvcHVwX3ZhbHVlcy5hcHBlbmQoJ9Cf0LXRgNC10LTQsNGC0Ywg0L3QsCDQkdCRJykKICAgICAgICAgICAgaWYgaXNfaHRtOgogICAgICAgICAgICAgICAgcG9wdXBfdmFsdWVzLmFwcGVuZCgn0KjQsNCx0LvQvtC9INC/0LXRh9Cw0YLQuCcpCiAgICAgICAgbGF5b3V0ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHBpY3R1cmUnLAogICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPUZhbHNlLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGZpbGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSc7Jy5qb2luKHBvcHVwX3ZhbHVlcyksCiAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9InNlbnQiLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249Imhvcml6b250YWwiLAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BmaWxlX3NpemUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY3JlYXRpb25fdGltZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICApLAoKICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICApCiAgICAgICAgcmV0dXJuIGxheW91dAoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfYWxsX2ZpbGVzX2Zyb21fcGF0Y2goZGlyZWN0b3J5OiBzdHIpIC0+IExpc3RbRGljdF06CiAgICAgICAgZmlsZXNfaW5mbyA9IFtdCiAgICAgICAgIyBXYWxrIHRocm91Z2ggdGhlIGZvbGRlciBhbmQgaXRzIHN1YmRpcmVjdG9yaWVzCiAgICAgICAgZGlyZWN0b3J5X3BhdGggPSBQYXRoKGRpcmVjdG9yeSkKICAgICAgICBmb3IgZmlsZSBpbiBkaXJlY3RvcnlfcGF0aC5pdGVyZGlyKCk6CiAgICAgICAgICAgIHBpYyA9ICgnI2YxNWInIGlmIGZpbGUuaXNfZmlsZSgpIGVsc2UKICAgICAgICAgICAgICAgICAgICcjZjBjMScgaWYgZmlsZS5pc19zeW1saW5rKCkgZWxzZSAnI2YwN2InKQogICAgICAgICAgICBmaWxlX3R5cGUgPSAoIkZpbGUiIGlmIGZpbGUuaXNfZmlsZSgpIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICJTeW1MaW5rIiBpZiBmaWxlLmlzX3N5bWxpbmsoKSBlbHNlICJGb2xkZXIiKQogICAgICAgICAgICBmb3JtYXR0ZWRfY3JlYXRpb25fdGltZSA9IHRpbWUuc3RyZnRpbWUoCiAgICAgICAgICAgICAgICAnJVktJW0tJWQgJUg6JU06JVMnLAogICAgICAgICAgICAgICAgdGltZS5sb2NhbHRpbWUoaW50KGZpbGUuc3RhdCgpLnN0X2N0aW1lKSkKICAgICAgICAgICAgKQogICAgICAgICAgICBmaWxlX2luZm8gPSB7CiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICdmaWxlX3R5cGUnOiBmaWxlX3R5cGUsCiAgICAgICAgICAgICAgICAnZmlsZV9uYW1lJzogZmlsZS5uYW1lLAogICAgICAgICAgICAgICAgJ2Z1bGxfcGF0aCc6IHN0cihkaXJlY3RvcnlfcGF0aC5qb2lucGF0aChmaWxlLm5hbWUpKSwKICAgICAgICAgICAgICAgICdmaWxlX3NpemUnOiBmJ3tmaWxlLnN0YXQoKS5zdF9zaXplIC8gMTAyNDouMmZ9IEtCJywKICAgICAgICAgICAgICAgICdjcmVhdGlvbl90aW1lJzogZm9ybWF0dGVkX2NyZWF0aW9uX3RpbWUsCiAgICAgICAgICAgICAgICAnZXh0ZW5zaW9uJzogZmlsZS5zdWZmaXgKICAgICAgICAgICAgfQogICAgICAgICAgICBmaWxlc19pbmZvLmFwcGVuZChmaWxlX2luZm8pCgogICAgICAgIHJldHVybiBmaWxlc19pbmZvCgogICAgZGVmIF9sYXlvdXRfYWN0aW9uKHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgc2VsZWN0ZWRfY2FyZDogZGljdCA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ2NhcmRfZGF0YScpKQogICAgICAgIGlmIGxpc3RlbmVyID09ICfQn9C10YDQtdC00LDRgtGMINC90LAg0JHQkSc6CiAgICAgICAgICAgIHNlbGYuX2NvcHlfZmlsZShQYXRoKHNlbGVjdGVkX2NhcmRbJ2Z1bGxfcGF0aCddKSkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICfQmNC90YTQvic6CiAgICAgICAgICAgIHNlbGVjdGVkX2NhcmQucG9wKCdfbGF5b3V0JywgTm9uZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzdHIoc2VsZWN0ZWRfY2FyZCkpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAn0KjQsNCx0LvQvtC9INC/0LXRh9Cw0YLQuCc6CiAgICAgICAgICAgIHByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCiAgICAgICAgICAgIHByaW50X25jbC5wdXQoJ2xhYmxlX2ZpbGVfbmFtZScsIHNlbGVjdGVkX2NhcmQuZ2V0KCdmaWxlX25hbWUnKSwgVHJ1ZSkKICAgICAgICAgICAgcHJpbnRfbmNsLnB1dCgnbGFibGVfZnVsbF9wYXRoJywgc2VsZWN0ZWRfY2FyZC5nZXQoJ2Z1bGxfcGF0aCcpLCBUcnVlKQogICAgICAgICAgICBwcmludF9uY2wucHV0KCdmcm9tX2ZpbGVfYnJvd3NlcicsIFRydWUsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19wcm9jZXNzX3Jlc3VsdCgn0J/QtdGH0LDRgtGMJywgJ9Cg0LXQt9GD0LvRjNGC0LDRgicpCgogICAgZGVmIF9jb3B5X2ZpbGUoc2VsZiwgZmlsZTogUGF0aCk6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpcF9ob3N0Jykgb3Igc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlYnVnX2hvc3RfaXAnKSAjICcxOTIuMTY4LjEuNzcnCiAgICAgICAgd2l0aCBvcGVuKGZpbGUsICdyYicpIGFzIGY6CiAgICAgICAgICAgICMgc2VuZF9zZXJ2aWNlID0gc2VsZi5oc19zZXJ2aWNlKGlwX2hvc3QpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuaHNfc2VydmljZS5leHBvcnRfZmlsZShmaWxlLm5hbWUsIGYpCgogICAgICAgICAgICBpZiByZXNbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChmJ9Ck0LDQudC7IHtmaWxlLm5hbWV9INGD0YHQv9C10YjQvdC+INCy0YvQs9GA0YPQttC10L0nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJykKCgojID09PT09PT09PT09PT09PT09PT09IFRpbGVzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBUaWxlcyhTY3JlZW4pOgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF90aWxlX3JvdyhzZWxmLCBsYXlvdXQsIHRpbGVfZWxlbWVudCwgc3RhcnRfc2NyZWVuPSfQlNC+0LrRg9C80LXQvdGC0YsnKToKICAgICAgICB0aWxlID0gewogICAgICAgICAgICAibGF5b3V0IjogbGF5b3V0LAogICAgICAgICAgICAiZGF0YSI6IHNlbGYuX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KSwKICAgICAgICAgICAgImhlaWdodCI6ICJ3cmFwX2NvbnRlbnQiLAogICAgICAgICAgICAiY29sb3IiOiAnI0ZGRkZGRicsCiAgICAgICAgICAgICJzdGFydF9zY3JlZW4iOiBmIntzdGFydF9zY3JlZW59IiwKICAgICAgICAgICAgInN0YXJ0X3Byb2Nlc3MiOiAiIiwKICAgICAgICAgICAgJ2tleSc6IHRpbGVfZWxlbWVudFsnZG9jVHlwZSddCiAgICAgICAgfQogICAgICAgIHJldHVybiB0aWxlCgogICAgZGVmIF9nZXRfbWVzc2FnZV90aWxlKHNlbGYsIG1lc3NhZ2UsIHRleHRfY29sb3I9JyMwMDAwMDAnKToKICAgICAgICB0aWxlX3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPSdAbm9fZGF0YScsCiAgICAgICAgICAgICAgICBUZXh0U2l6ZT1zZWxmLnJzX3NldHRpbmdzLmdldCgndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJyksCiAgICAgICAgICAgICAgICBUZXh0Q29sb3I9dGV4dF9jb2xvciwKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTAsCiAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9ImNlbnRlciIsCiAgICAgICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MCwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0iI2ZmZmZmZiIsCiAgICAgICAgICAgICAgICBQYWRkaW5nPTAKCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBhdXRvU2l6ZVRleHRUeXBlPSd1bmlmb3JtJywKICAgICAgICAgICAgd2VpZ2h0PTAsCiAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSJjZW50ZXIiLAogICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICBTdHJva2VXaWR0aD0zLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9IiNmZmZmZmYiLAogICAgICAgICAgICBQYWRkaW5nPTAKICAgICAgICApCgogICAgICAgIGxheW91dCA9IGpzb24ubG9hZHModGlsZV92aWV3LnRvX2pzb24oKSkKCiAgICAgICAgdGlsZXNfbGlzdCA9IFt7CiAgICAgICAgICAgICJsYXlvdXQiOiBsYXlvdXQsCiAgICAgICAgICAgICJkYXRhIjogeyJub19kYXRhIjogbWVzc2FnZX0sCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgImNvbG9yIjogJyNmZmZmZmYnLAogICAgICAgICAgICAic3RhcnRfc2NyZWVuIjogIiIsCiAgICAgICAgICAgICJzdGFydF9wcm9jZXNzIjogIiIsCiAgICAgICAgICAgICdTdHJva2VXaWR0aCc6ICcnLAogICAgICAgIH1dCgogICAgICAgIGNvdW50X3Jvd19lbGVtZW50cyA9IDEKICAgICAgICB0aWxlcyA9IHsKICAgICAgICAgICAgJ3RpbGVzJzogW3RpbGVzX2xpc3RdLAogICAgICAgICAgICAnYmFja2dyb3VuZF9jb2xvcic6ICcjZmZmZmZmJywKICAgICAgICAgICAgJ1N0cm9rZVdpZHRoJzogJycsCiAgICAgICAgICAgICdoZWlnaHQnOiAnJwoKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aWxlcwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpOgogICAgICAgIGNvdW50X3ZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF92ZXJpZmllZCddIG9yIDAKICAgICAgICBjb3VudF91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF91bnZlcmlmaWVkJ10gb3IgMAogICAgICAgIHF0dHlfcGxhbl92ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsncXR0eV9wbGFuX3ZlcmlmaWVkJ10gb3IgMAogICAgICAgIHF0dHlfcGxhbl91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50WydxdHR5X3BsYW5fdW52ZXJpZmllZCddIG9yIDAKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgImRvY05hbWUiOiB0aWxlX2VsZW1lbnRbJ2RvY1R5cGUnXSwKICAgICAgICAgICAgJ1F0dHlPZkRvY3MnOiAne30ve30nLmZvcm1hdCh0aWxlX2VsZW1lbnRbJ2NvdW50J10sIHRpbGVfZWxlbWVudFsndmVyaWZpZWQnXSksCiAgICAgICAgICAgICdjb3VudF92ZXJpZmllZCc6ICd7fS97fScuZm9ybWF0KAogICAgICAgICAgICAgICAgY291bnRfdmVyaWZpZWQgKyBjb3VudF91bnZlcmlmaWVkLAogICAgICAgICAgICAgICAgY291bnRfdW52ZXJpZmllZCksCiAgICAgICAgICAgICdxdHR5X3BsYW5fdmVyaWZpZWQnOiAne30ve30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHF0dHlfcGxhbl92ZXJpZmllZCArIHF0dHlfcGxhbl91bnZlcmlmaWVkLAogICAgICAgICAgICAgICAgcXR0eV9wbGFuX3VudmVyaWZpZWQpCiAgICAgICAgfQoKICAgIGRlZiBfZ2V0X3RpbGVfdmlldyhzZWxmKSAtPiB3aWRnZXRzLkxpbmVhckxheW91dDoKICAgICAgICB0aWxlc192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY05hbWUnLAogICAgICAgICAgICAgICAgVGV4dFNpemU9c2VsZi5yc19zZXR0aW5ncy5nZXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTAKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAUXR0eU9mRG9jcycsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0YLRgNC+0Lo6ICcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGNvdW50X3ZlcmlmaWVkJywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KLQvtCy0LDRgNC+0LI6ICcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQHF0dHlfcGxhbl92ZXJpZmllZCcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgYXV0b1NpemVUZXh0VHlwZT0ndW5pZm9ybScsCiAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGlsZXNfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSwgcnNfc2V0dGluZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9IHJzX3NldHRpbmdzLmdldCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgIHNlbGYuVGV4dENvbG9yID0gJyMzMzMzMzMnCiAgICAgICAgICAgIHNlbGYuQmFja2dyb3VuZENvbG9yID0gJ0ZGQ0M5OScKICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAwCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKCmNsYXNzIEZsb3dUaWxlc1NjcmVlbihUaWxlcyk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C70LjRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0KHQsdC+0YAg0KjQmicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKCiAgICAgICAgZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfZG9jX2Zsb3dfc3RhdCgpCiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgIyBsYXlvdXQgPSBzZWxmLl9nZXRfdGlsZV92aWV3KCkKICAgICAgICAgICAgbGF5b3V0ID0ganNvbi5sb2FkcyhzZWxmLl9nZXRfdGlsZV92aWV3KCkudG9fanNvbigpKQoKICAgICAgICAgICAgdGlsZXNfbGlzdCA9IFtzZWxmLl9nZXRfdGlsZV9yb3cobGF5b3V0LCBpdGVtKSBmb3IgaXRlbSBpbiBkYXRhXQoKICAgICAgICAgICAgIyBzcGxpdCBsaXN0IGJ5IHR3byBlbGVtZW50IGluIHJvdwogICAgICAgICAgICBjb3VudF9yb3dfZWxlbWVudHMgPSAyCiAgICAgICAgICAgIHRpbGVzID0gewogICAgICAgICAgICAgICAgJ3RpbGVzJzogWwogICAgICAgICAgICAgICAgICAgIHRpbGVzX2xpc3RbaTppICsgY291bnRfcm93X2VsZW1lbnRzXQogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbih0aWxlc19saXN0KSwgY291bnRfcm93X2VsZW1lbnRzKQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kX2NvbG9yJzogJyNmNWY1ZjUnCgogICAgICAgICAgICB9CiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGlsZXMgPSBzZWxmLl9nZXRfbWVzc2FnZV90aWxlKCLQndC10YIg0LfQsNCz0YDRg9C20LXQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0L7QsiIpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0aWxlcycsIHRpbGVzLCB0b19qc29uPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgX2dldF90aWxlX3ZpZXcoc2VsZikgLT4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQ6CiAgICAgICAgdGlsZXNfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgVmFsdWU9J0Bkb2NOYW1lJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXNlbGYucnNfc2V0dGluZ3MuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQFF0dHlPZkRvY3MnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQodGC0YDQvtC6OiAnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BiYXJjX2NvdW50Jywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCgogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgYXV0b1NpemVUZXh0VHlwZT0ndW5pZm9ybScsCiAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGlsZXNfdmlldwoKICAgIGRlZiBfZ2V0X3RpbGVfcm93KHNlbGYsIGxheW91dCwgdGlsZV9lbGVtZW50LCBzdGFydF9zY3JlZW49J9CU0L7QutGD0LzQtdC90YLRiycpOgogICAgICAgIHRpbGUgPSB7CiAgICAgICAgICAgICJsYXlvdXQiOiBsYXlvdXQsCiAgICAgICAgICAgICJkYXRhIjogc2VsZi5fZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJjb2xvciI6ICcjRkZGRkZGJywKICAgICAgICAgICAgInN0YXJ0X3NjcmVlbiI6IGYie3N0YXJ0X3NjcmVlbn0iLAogICAgICAgICAgICAic3RhcnRfcHJvY2VzcyI6ICIiLAogICAgICAgICAgICAna2V5JzogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KToKICAgICAgICBjb3VudF92ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsndmVyaWZpZWQnXSBvciAwCiAgICAgICAgIyBjb3VudF91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF91bnZlcmlmaWVkJ10gb3IgMAogICAgICAgIGJhcmNfY291bnQgPSB0aWxlX2VsZW1lbnRbJ2JhcmNfY291bnQnXSBvciAwCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJkb2NOYW1lIjogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10sCiAgICAgICAgICAgICdRdHR5T2ZEb2NzJzogJ3t9L3t9Jy5mb3JtYXQodGlsZV9lbGVtZW50Wydjb3VudCddLCB0aWxlX2VsZW1lbnRbJ3ZlcmlmaWVkJ10pLAogICAgICAgICAgICAnY291bnRfdmVyaWZpZWQnOiBzdHIoY291bnRfdmVyaWZpZWQpLAogICAgICAgICAgICAnYmFyY19jb3VudCc6IHN0cihiYXJjX2NvdW50KQogICAgICAgIH0KCgpjbGFzcyBHcm91cFNjYW5UaWxlcyhUaWxlcyk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C70LjRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKGlzX2dyb3VwX3NjYW49VHJ1ZSkKICAgICAgICBzZWxmLnNjcmVlbl9uYW1lID0gc2VsZi5oYXNoX21hcC5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIHNlbGYucHJvY2Vzc19uYW1lID0gc2VsZi5oYXNoX21hcC5nZXRfY3VycmVudF9wcm9jZXNzKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICB0aWxlcyA9IHNlbGYuX2dldF9tZXNzYWdlX3RpbGUoItCe0YLRgdGD0YLRgdGC0LLRg9C10YIg0YHQvtC10LTQuNC90LXQvdC40LUg0YEg0YHQtdGA0LLQtdGA0L7QvCIsIHRleHRfY29sb3I9IiNmZjAwMDAiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndGlsZXMnLCB0aWxlcywgdG9fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY2hlY2tfY29ubmVjdGlvbiddID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NoZWNrX2Nvbm5lY3Rpb24nXSA9IFRydWUKCiAgICAgICAgZGF0YSA9IHNlbGYuX2dldF9kb2NzX3N0YXQoKQoKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBsYXlvdXQgPSBqc29uLmxvYWRzKHNlbGYuX2dldF90aWxlX3ZpZXcoKS50b19qc29uKCkpCgogICAgICAgICAgICB0aWxlc19saXN0ID0gW3NlbGYuX2dldF90aWxlX3JvdyhsYXlvdXQsIGl0ZW0pIGZvciBpdGVtIGluIGRhdGFdCgogICAgICAgICAgICAjIHNwbGl0IGxpc3QgYnkgdHdvIGVsZW1lbnQgaW4gcm93CiAgICAgICAgICAgIGNvdW50X3Jvd19lbGVtZW50cyA9IDIKICAgICAgICAgICAgdGlsZXMgPSB7CiAgICAgICAgICAgICAgICAndGlsZXMnOiBbCiAgICAgICAgICAgICAgICAgICAgdGlsZXNfbGlzdFtpOmkgKyBjb3VudF9yb3dfZWxlbWVudHNdCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHRpbGVzX2xpc3QpLCBjb3VudF9yb3dfZWxlbWVudHMpCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgJ2JhY2tncm91bmRfY29sb3InOiAnI2Y1ZjVmNScKCiAgICAgICAgICAgIH0KICAgICAgICBlbHNlOgogICAgICAgICAgICB0aWxlcyA9IHNlbGYuX2dldF9tZXNzYWdlX3RpbGUoItCd0LXRgiDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC00L7QutGD0LzQtdC90YLQvtCyIikKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RpbGVzJywgdGlsZXMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgaWYgKHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBvcgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5jb250YWluc0tleSgnY2hlY2tfY29ubmVjdGlvbicpKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPWhzX3NlcnZpY2UudXJsKQogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIF9nZXRfZG9jc19zdGF0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRiX3NlcnZpY2UuZ2V0X2RvY3Nfc3RhdCgpCgoKY2xhc3MgRG9jdW1lbnRzVGlsZXMoR3JvdXBTY2FuVGlsZXMpOgogICAgc2NyZWVuX25hbWUgPSAn0J/Qu9C40YLQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9nZXRfZG9jc19zdGF0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRiX3NlcnZpY2UuZ2V0X2RvY3Nfc3RhdCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gVGlsZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBEb2NzTGlzdCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERvY3NMaXN0U2NyZWVuKFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQogICAgICAgIHNlbGYucG9wdXBfbWVudV9kYXRhID0gJycKICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UgPSBTY2FubmluZ1F1ZXVlU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgZG9jX3R5cGVzID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfdHlwZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oWyfQktGB0LUnXSArIGRvY190eXBlcykKICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2Nfc3RhdHVzX3NlbGVjdCddID0gJ9CS0YHQtTvQmiDQstGL0L/QvtC70L3QtdC90LjRjjvQktGL0LPRgNGD0LbQtdC9O9CaINCy0YvQs9GA0YPQt9C60LUnCgogICAgICAgIGRvY190eXBlID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfdGlsZV9rZXknXSBvciBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCiAgICAgICAgZG9jX3N0YXR1cyA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RvY19zdGF0dXMnXQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX2NsaWNrJ10gPSBkb2NfdHlwZQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3RpbGVfa2V5J10gPSAnJwogICAgICAgIGxpc3RfZGF0YSA9IHNlbGYuX2dldF9kb2NfbGlzdF9kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQoKICAgICAgICBwcmVwYXJlZF9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGxpc3RfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gJycKICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcocHJlcGFyZWRfZGF0YSwgc2VsZi5wb3B1cF9tZW51X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jQ2FyZHMnXSA9IGRvY19jYXJkcy50b19qc29uKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJkb2Nfc3RhdHVzX2NsaWNrIjoKICAgICAgICAgICAgIyBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9kb2Nfc3RhdHVzJ10gPSBzZWxmLmhhc2hfbWFwWyJkb2Nfc3RhdHVzX2NsaWNrIl0KICAgICAgICAgICAgc2VsZi5fZG9jX3N0YXR1c19jbGljaygpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2RlbGV0ZScpOgogICAgICAgICAgICBzZWxmLmNvbmZpcm1fZGVsZXRlX2RvY19saXN0ZW5lcigpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV9yZXNlbmRfZG9jJyk6CiAgICAgICAgICAgIHNlbGYuX3Jlc2VuZF9kb2MoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZikgLT4gTm9uZToKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwWydsYXlvdXRfbGlzdGVuZXInXQoKICAgICAgICBpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Cj0LTQsNC70LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX2RlbGV0ZScsCiAgICAgICAgICAgICAgICB0aXRsZT0n0KPQtNCw0LvQuNGC0Ywg0LTQvtC60YPQvNC10L3RgiDRgSDRg9GB0YLRgNC+0LnRgdGC0LLQsD8nCiAgICAgICAgICAgICkKICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScsCiAgICAgICAgICAgICAgICB0aXRsZT0n0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGC0L/RgNCw0LLQuNGC0Ywg0L/QvtCy0YLQvtGA0L3Qvic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coCiAgICAgICAgICAgICAgICBsaXN0ZW5lcj0nY29uZmlybV9yZXNlbmRfZG9jJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGC0L/RgNCw0LLQuNGC0Ywg0LTQvtC60YPQvNC10L3RgiDQv9C+0LLRgtC+0YDQvdC+PycKICAgICAgICAgICAgKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/Qu9C40YLQutC4JykKCiAgICBkZWYgX2RvY19zdGF0dXNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZG9jX3N0YXR1cyddID0gc2VsZi5oYXNoX21hcFsiZG9jX3N0YXR1c19jbGljayJdCiAgICAgICAgc2VsZi5jdXJyZW50X3N0YXR1cyA9IHNlbGYuaGFzaF9tYXBbImRvY19zdGF0dXNfY2xpY2siXQoKICAgIGRlZiBfcmVzZW5kX2RvYyhzZWxmKToKICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgIGh0dHBfcGFyYW1zID0gc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgYW5zd2VyID0gcG9zdF9jaGFuZ2VzX3RvX3NlcnZlcihmIid7aWRfZG9jfSciLCBodHRwX3BhcmFtcykKICAgICAgICBpZiBhbnN3ZXIuZ2V0KCdFcnJvcicpIGlzIG5vdCBOb25lOgogICAgICAgICAgICB1aV9nbG9iYWwud3JpdGVfZXJyb3Jfb25fbG9nKAogICAgICAgICAgICAgICAgZifQntGI0LjQsdC60LAg0L/QvtCy0YLQvtGA0L3QvtC5INC+0YLQv9GA0LDQstC60Lgg0LTQvtC60YPQvNC10L3RgtCwIHtzZWxmLmdldF9kb2NfbnVtYmVyKCl9OiAnCiAgICAgICAgICAgICAgICBmJ3tzdHIoYW5zd2VyLmdldCgiRXJyb3IiKSl9JwogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYucHV0X25vdGlmaWNhdGlvbigKICAgICAgICAgICAgICAgIHRleHQ9ZifQntGI0LjQsdC60LAg0L/RgNC4INC+0YLQv9GA0LDQstC60LUg0LTQvtC60YPQvNC10L3RgtCwIHtzZWxmLmdldF9kb2NfbnVtYmVyKCl9LCAnCiAgICAgICAgICAgICAgICAgICAgIGYn0L/QvtC00YDQvtCx0L3QtdC1INCyINC70L7Qs9C1INC+0YjQuNCx0L7Qui4nKQogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INGD0LTQsNC70L7RgdGMINC+0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS5kb2NfaWQgPSBpZF9kb2MKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2NfdmFsdWVzKHZlcmlmaWVkPTEsIHNlbnQ9MSkKICAgICAgICAgICAgc2VsZi50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDQvtGC0L/RgNCw0LLQu9C10L0g0L/QvtCy0YLQvtGA0L3QvicpCgogICAgZGVmIF9nZXRfZG9jX2xpc3RfZGF0YShzZWxmLCBkb2NfdHlwZSwgZG9jX3N0YXR1cykgLT4gbGlzdDoKICAgICAgICByZXN1bHRzID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfdmlld19kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQogICAgICAgIHJldHVybiByZXN1bHRzCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgbGlzdF9kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW10KICAgICAgICBmb3IgcmVjb3JkIGluIGxpc3RfZGF0YToKICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICcnCgogICAgICAgICAgICBpZiByZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddOgogICAgICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICfQktGL0LPRgNGD0LbQtdC9JwogICAgICAgICAgICBlbGlmIHJlY29yZFsndmVyaWZpZWQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9Cz0YDRg9C30LrQtScKICAgICAgICAgICAgZWxpZiBub3QgKHJlY29yZFsndmVyaWZpZWQnXSBhbmQgcmVjb3JkWydzZW50J10pOgogICAgICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICfQmiDQstGL0L/QvtC70L3QtdC90LjRjicKCiAgICAgICAgICAgIGRvY190aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3R5cGUnXSwgc2VsZi5oYXNoX21hcFsnZG9jX24nXSwgc2VsZi5oYXNoX21hcFsnZG9jX2RhdGUnXSkKCiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHsKICAgICAgICAgICAgICAgICdrZXknOiByZWNvcmRbJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgJ3R5cGUnOiByZWNvcmRbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICAgICAnbnVtYmVyJzogcmVjb3JkWydkb2NfbiddLAogICAgICAgICAgICAgICAgJ2RvY190aXRsZSc6IGRvY190aXRsZSwKICAgICAgICAgICAgICAgICdkYXRhJzogc2VsZi5fZm9ybWF0X2RhdGUocmVjb3JkWydkb2NfZGF0ZSddKSwKICAgICAgICAgICAgICAgICd3YXJlaG91c2UnOiByZWNvcmRbJ1JTX3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgJ2NvdW50cmFnZW50JzogcmVjb3JkWydSU19jb3VudHJhZ2VudCddLAogICAgICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IHJlY29yZFsnYWRkX21hcmtfc2VsZWN0aW9uJ10sCiAgICAgICAgICAgICAgICAnc3RhdHVzJzogZG9jX3N0YXR1cywKICAgICAgICAgICAgICAgICdpc19ncm91cF9zY2FuJzogcmVjb3JkWydpc19ncm91cF9zY2FuJ10KICAgICAgICAgICAgfSkKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhLCBwb3B1cF9tZW51X2RhdGEpOgogICAgICAgIHRpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJUaXRsZVRleHRTaXplIikKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF9kYXRlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykKCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHN0YXR1cycsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B0eXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfZGVsZXRlIiwKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbnVtYmVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bjb3VudHJhZ2VudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAd2FyZWhvdXNlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF9kYXRlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9nZXRfc2VsZWN0ZWRfY2FyZF9wdXRfZGF0YShzZWxmLCBwdXRfZGF0YT1Ob25lKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9kYXRhIiwgZnJvbV9qc29uPVRydWUpCgogICAgICAgIHB1dF9kYXRhID0gcHV0X2RhdGEgb3Ige30KICAgICAgICBwdXRfZGF0YVsnaWRfZG9jJ10gPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgcHV0X2RhdGFbJ2RvY190eXBlJ10gPSBjYXJkX2RhdGFbJ3R5cGUnXQogICAgICAgIHB1dF9kYXRhWydkb2NfbiddID0gY2FyZF9kYXRhWydudW1iZXInXQogICAgICAgIHB1dF9kYXRhWydkb2NfZGF0ZSddID0gY2FyZF9kYXRhWydkYXRhJ10KICAgICAgICBwdXRfZGF0YVsnd2FyZWhvdXNlJ10gPSBjYXJkX2RhdGFbJ3dhcmVob3VzZSddCiAgICAgICAgcHV0X2RhdGFbJ2NvdW50cmFnZW50J10gPSBjYXJkX2RhdGFbJ2NvdW50cmFnZW50J10KCiAgICAgICAgcmV0dXJuIHB1dF9kYXRhCgogICAgZGVmIF9zZXRfZG9jX3ZlcmlmaWVkKHNlbGYsIGlkX2RvYywgdmFsdWU9VHJ1ZSk6CiAgICAgICAgIyBzZXJ2aWNlID0gRG9jU2VydmljZShpZF9kb2MpCiAgICAgICAgdmFsdWUgPSBzdHIoaW50KHZhbHVlKSkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZSgndmVyaWZpZWQnLCB2YWx1ZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGUuYXJnc1swXSkKCiAgICBkZWYgZG9jX2RlbGV0ZShzZWxmLCBpZF9kb2MpOgoKICAgICAgICByZXN1bHQgPSBUcnVlCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRlbGV0ZV9kb2MoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UucmVtb3ZlX2RvY19saW5lcyhpZF9kb2MpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhlLmFyZ3NbMF0pCiAgICAgICAgICAgIHJlc3VsdCA9IEZhbHNlCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2RvY3NfY291bnQoc2VsZiwgZG9jX3R5cGU9JycpOgogICAgICAgIGRvY190eXBlID0gJycgaWYgbm90IGRvY190eXBlIG9yIGRvY190eXBlID09ICfQktGB0LUnIGVsc2UgZG9jX3R5cGUKICAgICAgICByZXR1cm4gc2VsZi5zZXJ2aWNlLmdldF9kb2NzX2NvdW50KGRvY190eXBlKQoKICAgIGRlZiBfY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmV0dXJuIHNlbGYuc2VydmljZS5jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQoKICAgIGRlZiBjb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikKICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCgogICAgICAgIGlmIHNlbGYuZG9jX2RlbGV0ZShpZF9kb2MpOgogICAgICAgICAgICBkb2NzX2NvdW50ID0gc2VsZi5nZXRfZG9jc19jb3VudChkb2NfdHlwZT1kb2NfdHlwZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDRg9GB0L/QtdGI0L3QviDRg9C00LDQu9GR0L0nKQogICAgICAgICAgICBpZiBkb2NzX2NvdW50OgogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDRg9C00LDQu9C10L3QuNGPINC00L7QutGD0LzQtdC90YLQsCcpCgogICAgZGVmIF9mb3JtYXRfZGF0ZShzZWxmLCBkYXRlX3N0cjogc3RyKToKICAgICAgICByZXR1cm4gZGF0ZXRpbWUuZnJvbWlzb2Zvcm1hdChkYXRlX3N0cikuc3RyZnRpbWUoJyVtLSVkLSVZICVIOiVNOiVTJykKCiAgICBkZWYgZ2V0X2lkX2RvYyhzZWxmKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKSBvciB7fQogICAgICAgIGlkX2RvYyA9IGNhcmRfZGF0YS5nZXQoJ2tleScpIG9yIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J10KICAgICAgICByZXR1cm4gaWRfZG9jCgogICAgZGVmIGdldF9kb2NfbnVtYmVyKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpIG9yIHt9CiAgICAgICAgZG9jX251bWJlciA9IGNhcmRfZGF0YS5nZXQoJ251bWJlcicpCiAgICAgICAgcmV0dXJuIGRvY19udW1iZXIKCgpjbGFzcyBHcm91cFNjYW5Eb2NzTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UuaXNfZ3JvdXBfc2NhbiA9IFRydWUKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICfQo9C00LDQu9C40YLRjCcKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X21vZGUgPSAi0L7RhNGE0LvQsNC50L0iIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBlbHNlICLQvtC90LvQsNC50L0iCiAgICAgICAgICAgIHdhcm5pbmdfbXNnID0gItCU0L7QutGD0LzQtdC90YIg0L3QtSDQsdGD0LTQtdGCINC00L7RgdGC0YPQv9C10L0g0LIg0L/RgNC+0YbQtdGB0YHQtSAn0JTQvtC60YPQvNC10L3RgtGLJyIKICAgICAgICAgICAgbXNnID0gKGYi0JLRiyDQvtGC0LrRgNGL0LLQsNC10YLQtSDQtNC+0LrRg9C80LXQvdGCINCz0YDRg9C/0L/QvtCy0YPRjiDQvtCx0YDQsNCx0L7RgtC60YMg0LTQvtC60YPQvNC10L3RgtCwICIKICAgICAgICAgICAgICAgICAgIGYi0LIge2N1cnJlbnRfbW9kZS51cHBlcigpfSDRgNC10LbQuNC80LUuIikKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJylbJ2lzX2dyb3VwX3NjYW4nXSA9PSAnMCc6CiAgICAgICAgICAgICAgICBtc2cgKz0gd2FybmluZ19tc2cKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2dyb3VwX3NjYW5fbWVzc2FnZScsIG1zZykKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0LTQtdC50YHRgtCy0LjQtScpCiAgICAgICAgICAgIHNlbGVjdGVkX2NhcmRfa2V5ID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXSA9IHNlbGVjdGVkX2NhcmRfa2V5CgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCfQn9C+0LTRgtCy0LXRgNC00LjRgtC1INC00LXQudGB0YLQstC40LUnKToKICAgICAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRvY19pZCA9IGlkX2RvYwogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZSgndmVyaWZpZWQnLCAxKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZSgnaXNfZ3JvdXBfc2NhbicsICcxJykKCiAgICAgICAgICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgICAgICAgICBzY3JlZW4gPSBTY3JlZW5zRmFjdG9yeS5jcmVhdGVfc2NyZWVuKAogICAgICAgICAgICAgICAgc2NyZWVuX25hbWU9c2NyZWVuX25hbWUsCiAgICAgICAgICAgICAgICBwcm9jZXNzPXNlbGYucHJvY2Vzc19uYW1lLAogICAgICAgICAgICAgICAgaGFzaF9tYXA9c2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgICAgIHJzX3NldHRpbmdzPXNlbGYucnNfc2V0dGluZ3MpCgogICAgICAgICAgICBzY3JlZW4uc2hvdyhhcmdzPXNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkpCgogICAgZGVmIGNhbl9sYXVuY2hfdGltZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKY2xhc3MgRG9jdW1lbnRzRG9jc0xpc3RTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnOycuam9pbigKICAgICAgICAgICAgWyfQo9C00LDQu9C40YLRjCcsICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnLCAn0J7RgtC/0YDQsNCy0LjRgtGMINC/0L7QstGC0L7RgNC90L4nXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgaWRfZG9jID0gc2VsZi5nZXRfaWRfZG9jKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10gPSBpZF9kb2MKICAgICAgICAgICAgIyBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5kb2NfaWQgPSBpZF9kb2MKCiAgICAgICAgICAgIG5vQ2xhc3MoJ2FydGljbGVzX29jcl9uY2wnKS5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgICAgICAgICBzY3JlZW4gPSBTY3JlZW5zRmFjdG9yeS5jcmVhdGVfc2NyZWVuKAogICAgICAgICAgICAgICAgc2NyZWVuX25hbWU9c2NyZWVuX25hbWUsCiAgICAgICAgICAgICAgICBwcm9jZXNzPXNlbGYucHJvY2Vzc19uYW1lLAogICAgICAgICAgICAgICAgaGFzaF9tYXA9c2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgICAgIHJzX3NldHRpbmdzPXNlbGYucnNfc2V0dGluZ3MpCgogICAgICAgICAgICBzY3JlZW4uc2hvdyhhcmdzPXNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICByZXMgPSBzZWxmLl9jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UucmVtb3ZlX2RvY19saW5lcyhpZF9kb2MpCiAgICAgICAgICAgIGlmIHJlcy5nZXQoJ3Jlc3VsdCcpOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCDQuCDQvNCw0YDQutC40YDQvtCy0LrQuCDQvtGH0LjRidC10L3RiycpCiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKGlkX2RvYykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cf0YDQuCDQvtGH0LjRgdGC0LrQtSDQtNCw0L3QvdGL0YUg0L/QtdGA0LXRgdGH0LXRgtCwINCy0L7Qt9C90LjQutC70LAg0L7RiNC40LHQutCwLicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhyZXMuZ2V0KCdlcnJvcicpKQoKICAgIGRlZiBnZXRfaWRfZG9jKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpIG9yIHt9CiAgICAgICAgaWRfZG9jID0gY2FyZF9kYXRhLmdldCgna2V5Jykgb3Igc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIHJldHVybiBpZF9kb2MKCiAgICBkZWYgX2dldF9kb2NfbGlzdF9kYXRhKHNlbGYsIGRvY190eXBlLCBkb2Nfc3RhdHVzKSAtPiBsaXN0OgogICAgICAgIHJlc3VsdHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY192aWV3X2RhdGEoZG9jX3R5cGUsIGRvY19zdGF0dXMpCiAgICAgICAgcmV0dXJuIHJlc3VsdHMKCgpjbGFzcyBBZHJEb2NzTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JDQtNGA0LXRgdC90L7QtSDRhdGA0LDQvdC10L3QuNC1JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgICAgICBzZWxmLnNlcnZpY2UgPSBBZHJEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQogICAgICAgIHNlbGYuZG9jX3R5cGVzID0gKCfQktGB0LUnLCAn0J7RgtCx0L7RgCcsICfQoNCw0LfQvNC10YnQtdC90LjQtScsICfQn9C10YDQtdC80LXRidC10L3QuNC1JykKICAgICAgICBzZWxmLmRvY19zdGF0dXNlcyA9ICgn0JLRgdC1JywgJ9CaINCy0YvQv9C+0LvQvdC10L3QuNGOJywgJ9CS0YvQs9GA0YPQttC10L0nLCAn0Jog0LLRi9Cz0YDRg9C30LrQtScpCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAoJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCcsICfQntGC0L/RgNCw0LLQuNGC0Ywg0L/QvtCy0YLQvtGA0L3QvicpCiAgICAgICAgc2VsZi5jdXJyZW50X3N0YXR1cyA9ICfQktGB0LUnCiAgICAgICAgc2VsZi5jdXJyZW50X2RvY190eXBlID0gJ9CS0YHQtScKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX2Fkcl90eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oc2VsZi5kb2NfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3N0YXR1c19zZWxlY3QnXSA9ICc7Jy5qb2luKHNlbGYuZG9jX3N0YXR1c2VzKQogICAgICAgIHNlbGYuX2ZpbGxfdGFibGVfZGF0YSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCgogICAgICAgIHJldHVybiBzdXBlcigpLmluaXRfc2NyZWVuKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzZWxmLl9maWxsX3RhYmxlX2RhdGEoKQogICAgICAgIHN1cGVyKCkub25fcG9zdF9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljaywKICAgICAgICAgICAgJ2RvY19hZHJfdHlwZV9jbGljayc6IHNlbGYuX2RvY190eXBlX3NlbGVjdCwKICAgICAgICAgICAgJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJzogbGFtYmRhIDogc2VsZi5fY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYuZ2V0X2lkX2RvYygpKSwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CgogICAgICAgIGFyZ3MgPSBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9wdXRfZGF0YSgpCiAgICAgICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihzZWxmLmhhc2hfbWFwLCBBZHJEb2NEZXRhaWxzU2NyZWVuLCBhcmdzKQogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX2RvY190eXBlX3NlbGVjdChzZWxmKToKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfYWRyX3R5cGVfY2xpY2snXQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKSAtPiBOb25lOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xheW91dF9saXN0ZW5lciddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDQtNC+0LrRg9C80LXQvdGCINGBINGD0YHRgtGA0L7QudGB0YLQstCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX3Jlc2VuZF9kb2MnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4/JwogICAgICAgICAgICApCgogICAgZGVmIF9maWxsX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5fZ2V0X2RvY19saXN0X2RhdGEoc2VsZi5jdXJyZW50X2RvY190eXBlLCBzZWxmLmN1cnJlbnRfc3RhdHVzKQogICAgICAgIHByZXBhcmVkX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEobGlzdF9kYXRhKQogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldygKICAgICAgICAgICAgcHJlcGFyZWRfZGF0YSwKICAgICAgICAgICAgcG9wdXBfbWVudV9kYXRhPSc7Jy5qb2luKHNlbGYucG9wdXBfbWVudV9kYXRhKQogICAgICAgICkKICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2NBZHJDYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBfZ2V0X2RvY19saXN0X2RhdGEoc2VsZiwgZG9jX3R5cGUsIGRvY19zdGF0dXMpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZpZXdfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKICAgICAgICByZXR1cm4gcmVzdWx0cwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGxpc3RfZGF0YSkgLT4gbGlzdDoKICAgICAgICB0YWJsZV9kYXRhID0gW10KICAgICAgICBmb3IgcmVjb3JkIGluIGxpc3RfZGF0YToKICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICcnCgogICAgICAgICAgICBpZiByZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddOgogICAgICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICfQktGL0LPRgNGD0LbQtdC9JwogICAgICAgICAgICBlbGlmIHJlY29yZFsndmVyaWZpZWQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9Cz0YDRg9C30LrQtScKICAgICAgICAgICAgZWxpZiBub3QgKHJlY29yZFsndmVyaWZpZWQnXSBhbmQgcmVjb3JkWydzZW50J10pOgogICAgICAgICAgICAgICAgZG9jX3N0YXR1cyA9ICfQmiDQstGL0L/QvtC70L3QtdC90LjRjicKCiAgICAgICAgICAgIGRvY190aXRsZSA9ICd7fSDQvtGCIHt9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICByZWNvcmRbJ2RvY19uJ10sIHNlbGYuX2Zvcm1hdF9kYXRlKHJlY29yZFsnZG9jX2RhdGUnXSkpCgogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZF9kb2MnXSwKICAgICAgICAgICAgICAgICdkb2NfdHlwZSc6IHJlY29yZFsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgICAgICdkb2NfdGl0bGUnOiBkb2NfdGl0bGUsCiAgICAgICAgICAgICAgICAnZG9jX24nOiByZWNvcmRbJ2RvY19uJ10sCiAgICAgICAgICAgICAgICAnZG9jX2RhdGUnOiBzZWxmLl9mb3JtYXRfZGF0ZShyZWNvcmRbJ2RvY19kYXRlJ10pLAogICAgICAgICAgICAgICAgJ3dhcmVob3VzZSc6IHJlY29yZFsnd2FyZWhvdXNlJ10sCiAgICAgICAgICAgICAgICAnYWRkX21hcmtfc2VsZWN0aW9uJzogcmVjb3JkWydhZGRfbWFya19zZWxlY3Rpb24nXSwKICAgICAgICAgICAgICAgICdzdGF0dXMnOiBkb2Nfc3RhdHVzCiAgICAgICAgICAgIH0pCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX2NhcmRzX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSwgcG9wdXBfbWVudV9kYXRhKToKICAgICAgICB0aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgiVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfZGF0ZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCgogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzdGF0dXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jX3R5cGUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT10aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlBvcHVwTWVudUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9cG9wdXBfbWVudV9kYXRhLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bkb2NfbicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAoKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHdhcmVob3VzZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiBkb2NfY2FyZHMKCiAgICBkZWYgX2RvY19kZWxldGUoc2VsZiwgaWRfZG9jKToKICAgICAgICByZXN1bHQgPSBUcnVlCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLnNlcnZpY2UuZGVsZXRlX2Fkcl9kb2MoaWRfZG9jKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5lcnJvcl9sb2coZS5hcmdzWzBdKQogICAgICAgICAgICByZXN1bHQgPSBGYWxzZQoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIF9nZXRfc2VsZWN0ZWRfY2FyZF9wdXRfZGF0YShzZWxmLCBwdXRfZGF0YT1Ob25lKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKCkKCiAgICAgICAgdGFibGVfdHlwZSA9ICdvdXQnIGlmIGNhcmRfZGF0YVsnZG9jX3R5cGUnXSBpbiBbJ9Ce0YLQsdC+0YAnLCAn0J/QtdGA0LXQvNC10YnQtdC90LjQtSddIGVsc2UgJ2luJwoKICAgICAgICBwdXRfZGF0YSA9IHB1dF9kYXRhIG9yIHt9CiAgICAgICAgcHV0X2RhdGFbJ2lkX2RvYyddID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgIHB1dF9kYXRhWydkb2NfdHlwZSddID0gY2FyZF9kYXRhWydkb2NfdHlwZSddCiAgICAgICAgcHV0X2RhdGFbJ3RhYmxlX3R5cGUnXSA9IHRhYmxlX3R5cGUKICAgICAgICBwdXRfZGF0YVsnZG9jX24nXSA9IGNhcmRfZGF0YVsnZG9jX24nXQogICAgICAgIHB1dF9kYXRhWydkb2NfZGF0ZSddID0gY2FyZF9kYXRhWydkb2NfZGF0ZSddCiAgICAgICAgcHV0X2RhdGFbJ2RvY190aXRsZSddID0gY2FyZF9kYXRhWydkb2NfdGl0bGUnXQogICAgICAgIHB1dF9kYXRhWyd3YXJlaG91c2UnXSA9IGNhcmRfZGF0YVsnd2FyZWhvdXNlJ10KCiAgICAgICAgcmV0dXJuIHB1dF9kYXRhCgogICAgZGVmIGNvbmZpcm1fZGVsZXRlX2RvY19saXN0ZW5lcihzZWxmKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKQogICAgICAgIGlkX2RvYyA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICBkb2NfdHlwZSA9IHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlX2NsaWNrJ10KCiAgICAgICAgaWYgc2VsZi5kb2NfZGVsZXRlKGlkX2RvYyk6CiAgICAgICAgICAgIGRvY3NfY291bnQgPSBzZWxmLmdldF9kb2NzX2NvdW50KGRvY190eXBlPWRvY190eXBlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQlNC+0LrRg9C80LXQvdGCINGD0YHQv9C10YjQvdC+INGD0LTQsNC70ZHQvScpCiAgICAgICAgICAgIGlmIGRvY3NfY291bnQ6CiAgICAgICAgICAgICAgICBzZWxmLm9uX3N0YXJ0KCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDRg9C00LDQu9C10L3QuNGPINC00L7QutGD0LzQtdC90YLQsCcpCgogICAgZGVmIF9jbGVhcl9iYXJjb2RlX2RhdGEoc2VsZiwgaWRfZG9jKToKICAgICAgICByZXR1cm4gc2VsZi5zZXJ2aWNlLmNsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCgogICAgZGVmIGdldF9pZF9kb2Moc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikgb3Ige30KICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGEuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKCmNsYXNzIERvY3NPZmZsaW5lTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCddKQoKCmNsYXNzIEZsb3dEb2NTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Ch0LHQvtGAINCo0JonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2VydmljZS5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICfQo9C00LDQu9C40YLRjDvQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgYXJncyA9IHNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwJywgYXJncykKICAgICAgICAgICAgIyBzY3JlZW46IEZsb3dEb2NEZXRhaWxzU2NyZWVuID0gRmxvd0RvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICAgICAgIyBzY3JlZW4uc2hvdyhhcmdzPWFyZ3MpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKSAgIyBmaW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdkb2NfdHlwZV9jbGljayc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICByZXMgPSBzZWxmLl9jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQktGB0LUg0YjRgtGA0LjRhdC60L7QtNGLINGD0LTQsNC70LXQvdGLINC40Lcg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cf0YDQuCDQvtGH0LjRgdGC0LrQtSDQtNCw0L3QvdGL0YUg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERvY3NMaXN0IF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gRG9jRGV0YWlscyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERvY0RldGFpbHNTY3JlZW4oU2NyZWVuKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBOb25lCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IHJzX3NldHRpbmdzCiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCiAgICAgICAgc2VsZi5pdGVtc19vbl9wYWdlID0gMjAKICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UgPSBTY2FubmluZ1F1ZXVlU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIm5leHRfcGFnZSI6CiAgICAgICAgICAgIHNlbGYuX25leHRfcGFnZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJldmlvdXNfcGFnZSc6CiAgICAgICAgICAgIHNlbGYuX3ByZXZpb3VzX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdpdGVtc19vbl9wYWdlX2NsaWNrJzoKICAgICAgICAgICAgc2VsZi5fc2V0X2l0ZW1zX29uX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsICcxJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Jvd3NfZmlsdGVyJywgJzEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29mZic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTZWFyY2hTdHJpbmcnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIlNlYXJjaCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgJzEnKQogICAgICAgICAgICBzZWxmLl9vbl9zdGFydCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2V0VGl0bGUnLCBzZWxmLmhhc2hfbWFwWyJkb2NfdHlwZSJdKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgbGFzdF9zY2FubmVkX2RldGFpbHMgPSBzZWxmLl9nZXRfZG9jX2RldGFpbHNfZGF0YShsYXN0X3NjYW5uZWQ9VHJ1ZSkKICAgICAgICBsYXN0X3NjYW5uZWRfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShsYXN0X3NjYW5uZWRfZGV0YWlscykKICAgICAgICBsYXN0X3NjYW5uZWRfaXRlbSA9IGxhc3Rfc2Nhbm5lZF9kYXRhWzFdIGlmIGxlbihsYXN0X3NjYW5uZWRfZGF0YSkgPj0gMiBlbHNlIE5vbmUKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX2dldF9kb2NfZGV0YWlsc19kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIGlmIHRhYmxlX2RhdGEgYW5kIGxhc3Rfc2Nhbm5lZF9pdGVtOgogICAgICAgICAgICB0YWJsZV9kYXRhLmluc2VydCgxLCBsYXN0X3NjYW5uZWRfaXRlbSkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpID09ICcxJzoKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEucG9wKDEpCiAgICAgICAgICAgIHRhYmxlX2RhdGFbMV0gPSBsYXN0X3NjYW5uZWRfaXRlbQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtc19vbl9wYWdlX3NlbGVjdCddID0gJzIwOzQwOzYwJwogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hpZ2hsaWdodCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGlnaGxpZ2h0JywgRmFsc2UpCiAgICAgICAgICAgICMgc2VsZi5lbmFibGVfaGlnaGxpZ2h0KHRhYmxlX3ZpZXcuY3VzdG9tdGFibGUpCiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ2hpZ2hsaWdodF9zY2FubmVkX2l0ZW0nKQoKICAgICAgICBpZiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsndGFibGVfbGluZXNfcXR0eSddID0gbGVuKGRvY19kZXRhaWxzKQogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHN1bSgKICAgICAgICAgICAgICAgIFtzZWxmLl9mb3JtYXRfdG9fZmxvYXQoc3RyKGl0ZW1bJ3F0dHlfcGxhbiddKSkgZm9yIGl0ZW0gaW4gZG9jX2RldGFpbHMgaWYgaXRlbVsncXR0eV9wbGFuJ11dKSA+IDAKICAgICAgICAgICAgIyBoYXZlX3plcm9fcGxhbiA9IG5vdCBoYXZlX3F0dHlfcGxhbgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IFRydWUKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBzZWxmLl9nZXRfaGF2ZV9tYXJrX3BsYW4oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3F0dHlfcGxhbiddID0gaGF2ZV9xdHR5X3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3plcm9fcGxhbiddID0gaGF2ZV96ZXJvX3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX21hcmtfcGxhbiddID0gaGF2ZV9tYXJrX3BsYW4KCiAgICAgICAgY29udHJvbCA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZhbHVlKCdjb250cm9sJywgc2VsZi5pZF9kb2MpIG5vdCBpbiAoMCwgJzAnLCAnZmFsc2UnLCAnRmFsc2UnLCBOb25lKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NvbnRyb2wnXSA9IGNvbnRyb2wKCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICcnCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRvY19nb29kc190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQoKICAgIGRlZiBfaXRlbV9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpCiAgICAgICAgZG9jID0gUnNEb2MoaWRfZG9jKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQoKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKnNlbGYuX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlX3NjYW5uaW5nX3F1ZXVlPVRydWUpCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdoYXZlX3F0dHlfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfcXR0eV9wbGFuJyksCiAgICAgICAgICAgICdoYXZlX3plcm9fcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfemVyb19wbGFuJyksCiAgICAgICAgICAgICdoYXZlX21hcmtfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfbWFya19wbGFuJyksCiAgICAgICAgICAgICdjb250cm9sJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgfQoKICAgIGRlZiBfcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUoc2VsZiwgc2Nhbl9yZXN1bHQpOgogICAgICAgIGlmIHNjYW5fcmVzdWx0LmVycm9yID09ICd1c2Vfc2VyaWVzJzoKICAgICAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVycy5hcHBlbmQoCiAgICAgICAgICAgICAgICBsYW1iZGE6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzY2FuX3Jlc3VsdC5yb3dfa2V5KQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzY2FuX3Jlc3VsdC5kZXNjcmlwdGlvbikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIF92YXJzID0gWyd3YXJlaG91c2UnLCAnY291bnRyYWdlbnQnXQoKICAgICAgICBmb3IgdiBpbiBfdmFyczoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdhbGxvd19mYWN0X2lucHV0JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfaW5wdXQiLCAnMScgaWYgYWxsb3dfZmFjdF9pbnB1dCBlbHNlICctMScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X25vdGUiLCAnLTEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnMScpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHNlbGYuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCiAgICAgICAgZmluZGVkX2FydGljbGVzID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICBkYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGZpcnN0X2VsZW09MCBpZiBsYXN0X3NjYW5uZWQgZWxzZSBmaXJzdF9lbGVtZW50LAogICAgICAgICAgICBpdGVtc19vbl9wYWdlPTEgaWYgbGFzdF9zY2FubmVkIGVsc2Ugc2VsZi5pdGVtc19vbl9wYWdlLAogICAgICAgICAgICBhcnRpY2xlc19saXN0PWpzb24ubG9hZHMoZmluZGVkX2FydGljbGVzKSBpZiBmaW5kZWRfYXJ0aWNsZXMgZWxzZSBOb25lLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQoKICAgICAgICBpZiBub3QgbGFzdF9zY2FubmVkOgogICAgICAgICAgICBzZWxmLl9jaGVja19uZXh0X3BhZ2UobGVuKGRhdGEpKQogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIF9uZXh0X3BhZ2Uoc2VsZik6CiAgICAgICAgZmlyc3RfZWxlbWVudCA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKSArIHNlbGYuaXRlbXNfb25fcGFnZQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgc3RyKGZpcnN0X2VsZW1lbnQpKQogICAgICAgIGN1cnJlbnRfcGFnZSA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9wYWdlJykpICsgMSBvciAxCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsIHN0cihjdXJyZW50X3BhZ2UpKQoKICAgIGRlZiBfcHJldmlvdXNfcGFnZShzZWxmKToKICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpIC0gc2VsZi5pdGVtc19vbl9wYWdlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCBzdHIoZmlyc3RfZWxlbWVudCkpCiAgICAgICAgY3VycmVudF9wYWdlID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3BhZ2UnKSkgLSAxIG9yIDEKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgc3RyKGN1cnJlbnRfcGFnZSkpCgogICAgZGVmIF9jaGVja19wcmV2aW91c19wYWdlKHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJyk6CiAgICAgICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICAgICAgaWYgZmlyc3RfZWxlbWVudCA+IDA6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19wcmV2aW91c19wYWdlIiwgIjEiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCAnMCcpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsICcxJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19wcmV2aW91c19wYWdlIiwgIjAiKQoKICAgIGRlZiBfY2hlY2tfbmV4dF9wYWdlKHNlbGYsIGVsZW1zX2NvdW50KToKICAgICAgICBpZiBlbGVtc19jb3VudCA8PSBzZWxmLml0ZW1zX29uX3BhZ2U6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmNvbnRhaW5zS2V5KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfbmV4dF9wYWdlIiwgIjAiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X25leHRfcGFnZSIsICIxIikKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ1Nob3dfcHJldmlvdXNfcGFnZScpID09ICcwJyBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ1Nob3dfbmV4dF9wYWdlJykgPT0gJzAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19wYWdpbmF0aW9uX2NvbnRyb2xzIiwgIi0xIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19wYWdpbmF0aW9uX2NvbnRyb2xzIiwgIjEiKQoKICAgIGRlZiBfc2V0X2l0ZW1zX29uX3BhZ2Uoc2VsZik6CiAgICAgICAgdmFsdWUgPSBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbXNfb25fcGFnZV9jbGljaycpCiAgICAgICAgc2VsZi5pdGVtc19vbl9wYWdlID0gaW50KHZhbHVlKQogICAgICAgIG5ld19wYWdlID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpLy9zZWxmLml0ZW1zX29uX3BhZ2UgKyAxCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsIG5ld19wYWdlKQogICAgICAgIG5ld19jdXJyZW50X2ZpcnN0ID0gc2VsZi5pdGVtc19vbl9wYWdlICogKG5ld19wYWdlIC0gMSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsIHN0cihuZXdfY3VycmVudF9maXJzdCkpCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgZG9jX2RldGFpbHMpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgcm93X2ZpbHRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3Jvd3NfZmlsdGVyJykKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgaWYgcm93X2ZpbHRlciBhbmQgcmVjb3JkWydkX3F0dHknXSA9PSByZWNvcmRbJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHBpYyA9ICcjZjAyYScgaWYgcmVjb3JkWydJc0RvbmUnXSAhPSAwIGVsc2UgJyNmMDBjJwogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSA9PSAwIGFuZCByZWNvcmRbJ3F0dHlfcGxhbiddID09IDA6CiAgICAgICAgICAgICAgICBwaWMgPSAnJwoKICAgICAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnaWQnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pLAogICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Byb3BlcnRpZXNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzdHIocmVjb3JkWydpZF9zZXJpZXMnXSksCiAgICAgICAgICAgICAgICAnc2VyaWVzX25hbWUnOiBzdHIocmVjb3JkWydzZXJpZXNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdpZF91bml0Jzogc3RyKHJlY29yZFsnaWRfdW5pdCddKSwKICAgICAgICAgICAgICAgICd1bml0c19uYW1lJzogc3RyKHJlY29yZFsndW5pdHNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdjb2RlX2FydCc6ICfQmtC+0LQ6ICcgKyBzdHIocmVjb3JkWydjb2RlJ10pLAogICAgICAgICAgICAgICAgJ2FydCc6IHN0cihyZWNvcmRbJ2FydCddKSwKICAgICAgICAgICAgICAgICdwcmljZSc6IHN0cihyZWNvcmRbJ3ByaWNlJ10gaWYgcmVjb3JkWydwcmljZSddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAncHJpY2VfbmFtZSc6IHN0cihyZWNvcmRbJ3ByaWNlX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICd1c2Vfc2VyaWVzJzogc3RyKHJlY29yZFsndXNlX3NlcmllcyddKQogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm9wcyA9IFsKICAgICAgICAgICAgICAgICd7fSAnLmZvcm1hdChwcm9kdWN0X3Jvd1snYXJ0J10pIGlmIHByb2R1Y3Rfcm93WydhcnQnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJyh7fSkgJy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICd7fScuZm9ybWF0KHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJywge30nLmZvcm1hdChwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ2dvb2RfaW5mbyddID0gJycuam9pbihwcm9wcykKCiAgICAgICAgICAgIGZvciBrZXkgaW4gWydxdHR5JywgJ2RfcXR0eScsICdxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsZi5fZm9ybWF0X3RvX2Zsb2F0KHN0cihyZWNvcmQuZ2V0KGtleSwgMC4wKSBvciAwLjApKQogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dba2V5XSA9IHN0cihpbnQodmFsdWUpKSBpZiB2YWx1ZS5pc19pbnRlZ2VyKCkgZWxzZSB2YWx1ZQoKICAgICAgICAgICAgdXNlX3NlcmllcyA9IGJvb2woaW50KHByb2R1Y3Rfcm93LmdldCgndXNlX3NlcmllcycsIDApKSkKICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ19sYXlvdXQnXSA9IHNlbGYuX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoKQogICAgICAgICAgICBzZWxmLl9zZXRfYmFja2dyb3VuZF9yb3dfY29sb3IocHJvZHVjdF9yb3cpCgogICAgICAgICAgICBpZiBzZWxmLl9hZGRlZF9nb29kc19oYXNfa2V5KHByb2R1Y3Rfcm93WydrZXknXSk6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmluc2VydCgxLCBwcm9kdWN0X3JvdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHByb2R1Y3Rfcm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV92aWV3KHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKG92ZXJyaWRlX3NlYXJjaD1UcnVlKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoc2VsZiwgdXNlX3Nlcmllcz1GYWxzZSwgdXNlX21hcms9RmFsc2UpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5QaWN0dXJlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT1zdGF0aWNfZGF0YS5zbl9pY29uX2dyZWVuIGlmIHVzZV9zZXJpZXMgZWxzZSBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0xNiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PTEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5QaWN0dXJlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT1zdGF0aWNfZGF0YS5tYXJrX2dyZWVuIGlmIHVzZV9tYXJrIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9MTYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD0xMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWRkaW5nID0gMTYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAZ29vZF9uYW1lJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGdvb2RfaW5mbycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0zLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5X3BsYW4nLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRfcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihzZWxmLCBwcm9kdWN0X3Jvdyk6CiAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgIHF0dHksIHF0dHlfcGxhbiA9IGZsb2F0KHByb2R1Y3Rfcm93WydkX3F0dHknXSksIGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5X3BsYW4nXSkKICAgICAgICBpZiBxdHR5X3BsYW4gPiBxdHR5OgogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gIiNGQkU5RTciCgogICAgICAgIGVsaWYgcXR0eV9wbGFuIDwgcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkZGOUM0IgoKICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddLkJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRfY29sb3IKCiAgICBkZWYgX2FkZGVkX2dvb2RzX2hhc19rZXkoc2VsZiwga2V5KToKICAgICAgICBhZGRlZF9nb29kcyA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ2FkZGVkX2dvb2RzJykKICAgICAgICByZXN1bHQgPSBGYWxzZQoKICAgICAgICBpZiBhZGRlZF9nb29kczoKICAgICAgICAgICAgYWRkZWRfZ29vZHNfZG9jID0gYWRkZWRfZ29vZHMuZ2V0KHNlbGYuaWRfZG9jLCBbXSkKICAgICAgICAgICAgcmVzdWx0ID0gc3RyKGtleSkgaW4gW3N0cihpdGVtKSBmb3IgaXRlbSBpbiBhZGRlZF9nb29kc19kb2NdCiAgICAgICAgICAgIHNlbGYudG9hc3QocmVzdWx0KQoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGVuYWJsZV9oaWdobGlnaHQoY3VzdG9tdGFibGUpOgogICAgICAgIGN1c3RvbXRhYmxlWyd0YWJsZWRhdGEnXVsxXVsnX2xheW91dCddLkJhY2tncm91bmRDb2xvciA9ICcjRjBGOEZGJwoKICAgIGRlZiBkaXNhYmxlX2hpZ2hsaWdodChzZWxmKToKICAgICAgICBzZWxmLl9vbl9zdGFydCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9maWxsX25vbmVfdmFsdWVzKHNlbGYsIGRhdGEsIGtleXMsIGRlZmF1bHQ9JycpOgogICAgICAgIG5vbmVfbGlzdCA9IFtOb25lLCAnTm9uZSddCiAgICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICBkYXRhW2tleV0gPSBkZWZhdWx0IGlmIGRhdGFba2V5XSBpbiBub25lX2xpc3QgZWxzZSBkYXRhW2tleV0KCiAgICBkZWYgc2Nhbl9lcnJvcl9zb3VuZChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnc2Nhbl9lcnJvcicpIGFuZCBzZWxmLmhhc2hfbWFwLmdldCgnc2Nhbl9lcnJvcicpICE9ICJOb25lIjoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3NjYW5fZXJyb3InKSBpbiBbJ1F1YW50aXR5UGxhblJlYWNoZWQnLCAnQWxyZWFkeVNjYW5uZWQnLCAnWmVyb19wbGFuX2Vycm9yJ106CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnd2FybmluZycpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfZm9ybWF0X3RvX2Zsb2F0KHNlbGYsIHZhbHVlOiBzdHIpOgogICAgICAgIHJldHVybiBmbG9hdCh2YWx1ZS5yZXBsYWNlKHUnXHhhMCcsIHUnJykucmVwbGFjZSgnLCcsICcuJykgb3IgJzAuMCcpCgogICAgZGVmIF9nZXRfaGF2ZV9tYXJrX3BsYW4oc2VsZik6CiAgICAgICAgY291bnQgPSBzZWxmLnNlcnZpY2UuZ2V0X2NvdW50X21hcmtfY29kZXMoaWRfZG9jPXNlbGYuaWRfZG9jKQogICAgICAgIHJldHVybiBjb3VudCA+IDAKCiAgICBkZWYgX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLCBkb2Nfcm93X2tleSk6CiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2RvY19yb3dfaWQnOiBkb2Nfcm93X2tleSwKICAgICAgICAgICAgJ3RpdGxlJzogJ9Ch0LXRgNC40LgnLAogICAgICAgICAgICAndXNlX2Fkcl9kb2NzX3RhYmxlcyc6ICcwJwogICAgICAgIH0KCiAgICAgICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgU2VyaWVzU2VsZWN0U2NyZWVuLAogICAgICAgICAgICBzY3JlZW5fdmFsdWVzPXNjcmVlbl92YWx1ZXMKICAgICAgICApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCgpjbGFzcyBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKERvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IGhhc2hfbWFwWydpZF9kb2MnXSwKICAgICAgICAgICAgJ2RvY190eXBlJzogaGFzaF9tYXBbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICdkb2Nfbic6IGhhc2hfbWFwWydkb2NfbiddLAogICAgICAgICAgICAnZG9jX2RhdGUnOiBoYXNoX21hcFsnZG9jX2RhdGUnXSwKICAgICAgICAgICAgJ3dhcmVob3VzZSc6IGhhc2hfbWFwWyd3YXJlaG91c2UnXSwKICAgICAgICAgICAgJ2NvdW50cmFnZW50JzogaGFzaF9tYXBbJ2NvdW50cmFnZW50J10sCiAgICAgICAgfQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkuX29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF90aW1lcl91cGRhdGUnLCAndHJ1ZScpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwWydsaXN0ZW5lciddCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLl9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZygpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCfQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0Jyk6CiAgICAgICAgICAgIHNlbGYuX3J1bl9wcm9ncmVzc19iYXJjb2RlX3NjYW5uaW5nKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ1JldHJ5Q29ubmVjdGlvbicpOgogICAgICAgICAgICBzZWxmLl9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZygpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X25lZ2F0aXZlKCdSZXRyeUNvbm5lY3Rpb24nKToKICAgICAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKEZhbHNlKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYmFyY29kZXMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCfQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdCQUNLX0JVVFRPTiddOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICdmYWxzZScpCgogICAgZGVmIF9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9wcm9ncmVzcygnZG9jX2RldGFpbHNfYmVmb3JlX3Byb2Nlc3NfYmFyY29kZScpCgogICAgZGVmIGJlZm9yZV9wcm9jZXNzX2JhcmNvZGUoc2VsZik6CiAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKFRydWUpCiAgICAgICAgaWYgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICBzZWxmLl91cGRhdGVfZG9jdW1lbnRfZGF0YSgpCiAgICAgICAgICAgIHNjYW5fcmVzdWx0ID0gc2VsZi5fYmFyY29kZV9zY2FubmVkKCkKCiAgICAgICAgICAgIGlmIHNjYW5fcmVzdWx0LmdldCgnRXJyb3InKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50KCdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygnZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0X2V4ZWN1dGVfbWV0aG9kPSdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhGYWxzZSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCc3MCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9IlJldHJ5Q29ubmVjdGlvbiIsIHRpdGxlPSfQntGC0YHRg9GC0YHRgtCy0YPQtdGCINGB0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyLQn9C+0LLRgtC+0YDQuNGC0YwiLCAi0J7RgtC80LXQvdCwIl0pCgogICAgZGVmIF91cGRhdGVfZG9jdW1lbnRfZGF0YShzZWxmKToKICAgICAgICBkb2NzX2RhdGEgPSBzZWxmLl9nZXRfdXBkYXRlX2N1cnJlbnRfZG9jX2RhdGEoKQogICAgICAgIGlmIGRvY3NfZGF0YToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kYXRhX2Zyb21fanNvbihkb2NzX2RhdGEpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS53cml0ZV9lcnJvcl9vbl9sb2coZifQntGI0LjQsdC60LAg0LfQsNC/0LjRgdC4INC00L7QutGD0LzQtdC90YLQsDogIHtlfScpCgogICAgZGVmIF9nZXRfdXBkYXRlX2N1cnJlbnRfZG9jX2RhdGEoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKCiAgICAgICAgICAgIGlmIGFuc3dlci51bmF1dGhvcml6ZWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0LDQstGC0L7RgNC40LfQsNGG0LjQuCDRgdC10YDQstC10YDQsCAx0KEnKQogICAgICAgICAgICBlbGlmIGFuc3dlci5mb3JiaWRkZW46CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbihhbnN3ZXIuZXJyb3JfdGV4dCwgdGl0bGU9J9Ce0YjQuNCx0LrQsCDQvtCx0LzQtdC90LAnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChhbnN3ZXIuZXJyb3JfdGV4dCkKICAgICAgICAgICAgZWxpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtCwOiAge2Fuc3dlci5lcnJvcl90ZXh0fScpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gYW5zd2VyLmRhdGEKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhGYWxzZSkKCiAgICBkZWYgcG9zdF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnYmFyY29kZV9zY2FubmVkJyk6CiAgICAgICAgICAgIGFuc3dlciA9IE5vbmUKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5fcG9zdF9nb29kc190b19zZXJ2ZXIoKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICAgICAgICAgIGlmIGFuc3dlciBhbmQgYW5zd2VyLmdldCgnRXJyb3InKSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGFuc3dlci5nZXQoJ0Vycm9yJykpCgogICAgICAgICAgICBzZWxmLm9uX3N0YXJ0KCkKCiAgICBkZWYgX3Bvc3RfZ29vZHNfdG9fc2VydmVyKHNlbGYpOgogICAgICAgIHJlcyA9IHNlbGYuc2VydmljZS5nZXRfbGFzdF9lZGl0ZWRfZ29vZHModG9fanNvbj1GYWxzZSkKICAgICAgICBoc19zZXJ2aWNlID0gSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKCiAgICAgICAgaWYgaXNpbnN0YW5jZShyZXMsIGRpY3QpIGFuZCByZXMuZ2V0KCdFcnJvcicpOgogICAgICAgICAgICBhbnN3ZXIgPSB7J2VtcHR5JzogVHJ1ZSwgJ0Vycm9yJzogcmVzLmdldCgnRXJyb3InKX0KICAgICAgICAgICAgcmV0dXJuIGFuc3dlcgogICAgICAgIGVsaWYgcmVzOgogICAgICAgICAgICBoc19zZXJ2aWNlLnNlbmRfZG9jdW1lbnRzKHJlcykKICAgICAgICAgICAgYW5zd2VyID0gaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgICAgICBpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGFuc3dlci5lcnJvcl90ZXh0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfc2VudF9kYXRhKHJlcykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICAgICAgIyDQv9C+0LrQsCDRh9GC0L4g0L7RgtC60LvRjtGH0LjQuyDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9C5IGdldC3Qt9Cw0L/RgNC+0YEsINC/0YDQvtCy0LXRgNGP0LXQvCDQv9GA0L7QuNC30LLQvtC00LjRgtC10LvRjNC90L7RgdGC0YwKCiAgICAgICAgIyBkb2NzX2RhdGEgPSBoc19zZXJ2aWNlLmdldF9kYXRhKCkKICAgICAgICAjCiAgICAgICAgIyBpZiBkb2NzX2RhdGEuZ2V0KCdkYXRhJyk6CiAgICAgICAgIyAgICAgdHJ5OgogICAgICAgICMgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RhdGFfZnJvbV9qc29uKGRvY3NfZGF0YVsnZGF0YSddKQogICAgICAgICMgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAjICAgICAgICAgc2VsZi5zZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhlLmFyZ3NbMF0pCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLkh0dHBBbnN3ZXIoCiAgICAgICAgICAgICAgICBlcnJvcj1UcnVlLAogICAgICAgICAgICAgICAgZXJyb3JfdGV4dD1zdHIoZS5hcmdzWzBdKSwKICAgICAgICAgICAgICAgIHN0YXR1c19jb2RlPTQwNCwKICAgICAgICAgICAgICAgIHVybD1zZWxmLmhzX3NlcnZpY2UudXJsKQoKICAgICAgICByZXR1cm4gbm90IGFuc3dlci5lcnJvcgoKICAgIGRlZiBzZXRfc2Nhbm5lcl9sb2NrKHNlbGYsIHZhbHVlOiBib29sKToKICAgICAgICBpZiAndXJvdm8nIGluIHNlbGYuaGFzaF9tYXAuZ2V0KCdERVZJQ0VfTU9ERUwnKS5sb3dlcigpOgogICAgICAgICAgICBzdUNsYXNzLnVyb3ZvX3NldF9sb2NrX3RyaWdnZXIodmFsdWUpCgogICAgZGVmIGNhbl9sYXVuY2hfdGltZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKY2xhc3MgR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyhEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkuX29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF90aW1lcl91cGRhdGUnLCAndHJ1ZScpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdzdG9wX3N5bmNfZG9jJykgYW5kIFwKICAgICAgICAgICAgICAgIG5vdCBzZWxmLnJzX3NldHRpbmdzLmdldCgnb2ZmbGluZV9tb2RlJyk6CiAgICAgICAgICAgIHNlbGYuX3N5bmNfZG9jKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF9zeW5jX2RvYycsICd0cnVlJykKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2RlJzogbGFtYmRhOiBzZWxmLl9ncm91cF9iYXJjb2RlX3NjYW5uZWQoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykpLAogICAgICAgICAgICAnYnRuX2JhcmNvZGVzJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKGxpc3RlbmVyPSLQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0IiksCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLmdvX2JhY2ssCiAgICAgICAgICAgICdzeW5jX2RvYyc6IHNlbGYuX3N5bmNfZG9jLAogICAgICAgICAgICAnc2VuZF9hbGxfc2Nhbl9saW5lcyc6IHNlbGYuc2VuZF9hbGxfc2Nhbl9saW5lc19jYWxsX2hhbmRsZXIsCiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2sKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9CS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQnKToKICAgICAgICAgICAgc2VsZi5fZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYuaGFzaF9tYXAuZ2V0KCdmbGRfYmFyY29kZScpKQoKICAgIGRlZiBfZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5iYXJjb2RlX3dvcmtlciA9IEJhcmNvZGVXb3JrZXIoaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2Vfc2Nhbm5pbmdfcXVldWU9VHJ1ZSkKICAgICAgICByZXN1bHQgPSBzZWxmLmJhcmNvZGVfd29ya2VyLnByb2Nlc3NfdGhlX2JhcmNvZGUoYmFyY29kZSkKCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3NlbmRfZG9jdW1lbnRfbGluZXNfcnVubmluZycpIGFuZCBcCiAgICAgICAgICAgICAgICBub3Qgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ29mZmxpbmVfbW9kZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygnc2VuZF9wb3N0X2xpbmVzX2RhdGEnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0X2V4ZWN1dGVfbWV0aG9kPSdhZnRlcl9zZW5kX3Bvc3RfbGluZXNfZGF0YScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZW5kX2RvY3VtZW50X2xpbmVzX3J1bm5pbmcnLCBUcnVlKQoKICAgIGRlZiBnb19iYWNrKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdzdG9wX3N5bmNfZG9jJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF90aW1lcl91cGRhdGUnLCAnZmFsc2UnKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9CU0L7QutGD0LzQtdC90YLRiycpCgogICAgZGVmIHNlbmRfcG9zdF9saW5lc19kYXRhKHNlbGYsIHNlbnQ9Tm9uZSk6CiAgICAgICAgc2VuZF9kYXRhID0gc2VsZi5xdWV1ZV9zZXJ2aWNlLmdldF9kb2N1bWVudF9saW5lcyhzZWxmLmlkX2RvYywgc2VudD1zZW50KQogICAgICAgIHZhbGlkYXRlZF9zZW5kX2RhdGEgPSBsaXN0KChkaWN0KChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBkLml0ZW1zKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBrZXkgbm90IGluIFsncm93X2tleScsICdzZW50J10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBkIGluIHNlbmRfZGF0YSkpCiAgICAgICAgaWYgbm90IHZhbGlkYXRlZF9zZW5kX2RhdGE6CiAgICAgICAgICAgIHZhbGlkYXRlZF9zZW5kX2RhdGEgPSBbe31dCgogICAgICAgIGlmIHNlbnQgaXMgRmFsc2U6CiAgICAgICAgICAgIGh0dHBfcmVzdWx0ID0gc2VsZi5oc19zZXJ2aWNlLnNlbmRfZG9jdW1lbnRfbGluZXMoc2VsZi5pZF9kb2MsIHZhbGlkYXRlZF9zZW5kX2RhdGEsIHRpbWVvdXQ9OCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBodHRwX3Jlc3VsdCA9IHNlbGYuaHNfc2VydmljZS5zZW5kX2FsbF9kb2N1bWVudF9saW5lcyhzZWxmLmlkX2RvYywgdmFsaWRhdGVkX3NlbmRfZGF0YSwgdGltZW91dD04KQoKICAgICAgICBpZiBodHRwX3Jlc3VsdC5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5sb2dfZXJyb3IoItCe0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDQv9GA0Lgg0L7RgtC/0YDQsNCy0LrQtSAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgItC00LDQvdC90YvRhSDQs9GA0YPQv9C/0L7QstC+0LPQviDRgdC60LDQvdC40YDQvtCy0LDQvdC40Y8g0YLQvtCy0LDRgNCwLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIG5vdCBodHRwX3Jlc3VsdC5kYXRhLmdldCgnZGF0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gaHR0cF9yZXN1bHQuZGF0YVsnZGF0YSddOgogICAgICAgICAgICB0YWJsZV9saW5lID0gc2VsZi5kYl9zZXJ2aWNlLmdldF90YWJsZV9saW5lKCdSU19kb2NzX3RhYmxlJywgZmlsdGVycz17CiAgICAgICAgICAgICAgICAnaWRfZG9jJzogZWxlbWVudFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGVsZW1lbnRbJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogZWxlbWVudFsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAgICAgJ2lkX3VuaXQnOiBlbGVtZW50WydpZF91bml0J119KQogICAgICAgICAgICBpZiB0YWJsZV9saW5lOgogICAgICAgICAgICAgICAgdGFibGVfbGluZVsncXR0eSddID0gZWxlbWVudFsncXR0eSddCiAgICAgICAgICAgICAgICB0YWJsZV9saW5lWydzZW50J10gPSAxCiAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUoJ1JTX2RvY3NfdGFibGUnLCB0YWJsZV9saW5lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbmV3X3RhYmxlX2xpbmUgPSBzZWxmLmNyZWF0ZV9uZXdfdGFibGVfbGluZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKCdSU19kb2NzX3RhYmxlJywgbmV3X3RhYmxlX2xpbmUpCgogICAgICAgIHNlbGYucXVldWVfc2VydmljZS51cGRhdGVfc2VudF9saW5lcyhzZW5kX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbmRfZG9jdW1lbnRfbGluZXNfcnVubmluZycsIEZhbHNlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIHNlbGYub25fc3RhcnQoKQoKICAgIGRlZiBhZnRlcl9zZW5kX2RhdGEoc2VsZik6CiAgICAgICAgaWYgc2VsZi5xdWV1ZV9zZXJ2aWNlLmhhc191bnNlbnRfbGluZXMoc2VsZi5pZF9kb2MpIGFuZCBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdzZW5kX3Bvc3RfbGluZXNfZGF0YScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RfZXhlY3V0ZV9tZXRob2Q9J2FmdGVyX3NlbmRfcG9zdF9saW5lc19kYXRhJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlX25ld190YWJsZV9saW5lKGVsZW1lbnQpOgogICAgICAgIG5ld190YWJsZV9saW5lID0gZWxlbWVudAogICAgICAgIGRlbCBuZXdfdGFibGVfbGluZVsndGFibGVfdHlwZSddCiAgICAgICAgbmV3X3RhYmxlX2xpbmUudXBkYXRlKHsnZF9xdHR5JzogbmV3X3RhYmxlX2xpbmVbJ3F0dHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiAnJywgJ2lkX3ByaWNlJzogJycsICdzZW50JzogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdHR5X3BsYW4nOiBOb25lfSkKICAgICAgICByZXR1cm4gbmV3X3RhYmxlX2xpbmUKCiAgICBkZWYgX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdoYXZlX3F0dHlfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfcXR0eV9wbGFuJyksCiAgICAgICAgICAgICdoYXZlX3plcm9fcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfemVyb19wbGFuJyksCiAgICAgICAgICAgICdoYXZlX21hcmtfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfbWFya19wbGFuJyksCiAgICAgICAgICAgICdjb250cm9sJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgfQoKICAgIGRlZiBfcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUoc2VsZiwgc2Nhbl9yZXN1bHQpOgogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTQKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YIg0YPRgdGC0YDQvtC50YHRgtCy0LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ce0LHRidC40Lkg0YTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAZ29vZF9uYW1lJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGdvb2RfaW5mbycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD00LAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5X3BsYW4nLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRfcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MiwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0yLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLmh0dHBfYW5zd2VyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPXNlbGYuaHNfc2VydmljZS51cmwpCgogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIF9zeW5jX2RvYyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X3Byb2dyZXNzKCdzZW5kX3Bvc3RfbGluZXNfZGF0YScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgMdChJykKCiAgICBkZWYgc2VuZF9hbGxfc2Nhbl9saW5lc19jYWxsX2hhbmRsZXIoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9wcm9ncmVzcygnc2VuZF9hbGxfc2Nhbl9saW5lcycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgMdChJykKCiAgICBkZWYgc2VuZF9hbGxfc2Nhbl9saW5lc19ydW4oc2VsZik6CiAgICAgICAgc2VsZi5zZW5kX3Bvc3RfbGluZXNfZGF0YSgpCgogICAgZGVmIHNlbmRfdW5zZW50X2xpbmVzX3J1bihzZWxmKToKICAgICAgICBzZWxmLnNlbmRfcG9zdF9saW5lc19kYXRhKHNlbnQ9RmFsc2UpCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwCgogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScpKQogICAgICAgICMg0L/RgNC4INC60LvQuNC60LUg0L/QviDRiNCw0L/QutC1INGC0LDQsdC70LjRhtGLINC/0YDQuNC70LXRgtCw0LXRgiDQv9GD0YHRgtC+0Lkg0YHQu9C+0LLQsNGA0YwKICAgICAgICBpZiBub3QgY3VycmVudF9lbGVtOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY3VycmVudF9zdHIgPSBzZWxmLmhhc2hfbWFwWyJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIl0KICAgICAgICB0YWJsZV9saW5lc19xdHR5ID0gc2VsZi5oYXNoX21hcFsndGFibGVfbGluZXNfcXR0eSddCiAgICAgICAgdGl0bGUgPSAne30g4oSWIHt9INC+0YIge30nLmZvcm1hdChzZWxmLmhhc2hfbWFwWydkb2NfdHlwZSddLCBzZWxmLmhhc2hfbWFwWydkb2NfbiddLCBzZWxmLmhhc2hfbWFwWydkb2NfZGF0ZSddKQogICAgICAgIHB1dF9kYXRhX2RpY3QgPSB7CiAgICAgICAgICAgICdEb2NfZGF0YSc6IHRpdGxlLAogICAgICAgICAgICAnR29vZCc6IGN1cnJlbnRfZWxlbVsnZ29vZF9uYW1lJ10sCiAgICAgICAgICAgICdpZF9nb29kJzogY3VycmVudF9lbGVtWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF91bml0JzogY3VycmVudF9lbGVtWydpZF91bml0J10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6IGN1cnJlbnRfZWxlbVsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAnZ29vZF9hcnQnOiBjdXJyZW50X2VsZW1bJ2FydCddLAogICAgICAgICAgICAnZ29vZF9zbic6IGN1cnJlbnRfZWxlbVsnc2VyaWVzX25hbWUnXSwKICAgICAgICAgICAgJ2dvb2RfcHJvcGVydHknOiBjdXJyZW50X2VsZW1bJ3Byb3BlcnRpZXNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9wcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSwKICAgICAgICAgICAgJ2dvb2RfdW5pdCc6IGN1cnJlbnRfZWxlbVsndW5pdHNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9zdHInOiBmJ3tjdXJyZW50X3N0cn0gLyB7dGFibGVfbGluZXNfcXR0eX0nLAogICAgICAgICAgICAncXR0eV9wbGFuJzogY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2dvb2RfcGxhbic6IGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICdrZXknOiBjdXJyZW50X2VsZW1bJ2tleSddLAogICAgICAgICAgICAncHJpY2UnOiBjdXJyZW50X2VsZW1bJ3ByaWNlJ10sCiAgICAgICAgICAgICdwcmljZV90eXBlJzogY3VycmVudF9lbGVtWydwcmljZV9uYW1lJ10sCiAgICAgICAgICAgICdxdHR5Jzogc2VsZi5fZm9ybWF0X3F1YW50aXR5KGN1cnJlbnRfZWxlbVsnZF9xdHR5J10pLAogICAgICAgIH0KICAgICAgICBzY3JlZW4gPSBHcm91cFNjYW5JdGVtU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgc2NyZWVuLnNob3coYXJncz1wdXRfZGF0YV9kaWN0KQoKCmNsYXNzIERvY3VtZW50c0RvY0RldGFpbFNjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpCiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xpc3RlbmVyJ10KICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxlY3RlZF9jYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgICAgICBpZiBub3Qgc2VsZWN0ZWRfY2FyZF9kYXRhOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGlmIChzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICAgICAgICAgIGFuZCBub3Qgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKSk6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coCiAgICAgICAgICAgICAgICAgICAgZGF0YT17J3NlbnQnOiAwLCAnZF9xdHR5JzogZmxvYXQoc2VsZWN0ZWRfY2FyZF9kYXRhWydkX3F0dHknXSkgKyAxLjB9LAogICAgICAgICAgICAgICAgICAgIHJvd19pZD1pbnQoc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkpCiAgICAgICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgKICAgICAgICAgICAgICAgICAgICBmJ9CQ0YDRgtC40LrRg9C7OiB7c2VsZWN0ZWRfY2FyZF9kYXRhWyJhcnQiXX1cbicKICAgICAgICAgICAgICAgICAgICBmJ3tzZWxlY3RlZF9jYXJkX2RhdGFbImdvb2RfbmFtZSJdfVxuJwogICAgICAgICAgICAgICAgICAgIGYne3NlbGVjdGVkX2NhcmRfZGF0YVsicHJvcGVydGllc19uYW1lIl19XG4nCiAgICAgICAgICAgICAgICAgICAgZifQmtC+0LvQuNGH0LXRgdGC0LLQviDRg9Cy0LXQu9C40YfQtdC90L4g0L3QsCAxJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBpZiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gJzEnOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGVjdGVkX2NhcmRfZGF0YVsna2V5J10pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3YXNfY2xpY2tlZCcsICcxJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCi0L7QstCw0YAg0LLRi9Cx0L7RgCIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnIG9yIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgn0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCcpOgogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICByZXMgPSBzZWxmLl9pdGVtX2JhcmNvZGVfc2Nhbm5lZCgpCiAgICAgICAgICAgICMgVE9ETyDRgSDRgNC10LfRg9C70YzRgtCw0YLQvtC8INC+0LHRgNCw0LHQvtGC0LrRgwoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZ29vZHNfb2NyJzoKICAgICAgICAgICAgYXJ0aWNsZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9hcnRpY2xlc19pbl9kb2N1bWVudCgpCiAgICAgICAgICAgIGlmIG5vdCBhcnRpY2xlczoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CSINC00L7QutGD0LzQtdC90YLQtSDQvtGC0YHRgtGD0YLRgdGC0LLRg9GO0YIg0LDRgNGC0LjQutGD0LvRiycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncyhhcnRpY2xlcz1hcnRpY2xlcykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1J1bkNWJywgJ9Cg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7QsicpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0FjdGl2ZUNWJzoKICAgICAgICAgICAgaWYgbm90IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnKToKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdidXR0b25fbWFuYWdlX2FydGljbGVzJykKICAgICAgICAgICAgZmluZGVkX2FydGljbGVzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgaWYgZmluZGVkX2FydGljbGVzIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkNGA0YLQuNC60YPQu9GLINC90LUg0L3QsNC50LTQtdC90YsnKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9iYXJjb2Rlcyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ9CS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQnKQoKICAgICAgICBlbGlmIGxpc3RlbmVyIGluIFsnT05fQkFDS19QUkVTU0VEJywgJ0JBQ0tfQlVUVE9OJ106CiAgICAgICAgICAgIGlmIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpOgogICAgICAgICAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2l0ZW1zX29uX3BhZ2VfY2xpY2snLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV92ZXJpZmllZCcpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgICAgICBkb2MgPSBSc0RvYyhpZF9kb2MpCiAgICAgICAgICAgIGRvYy5tYXJrX3ZlcmlmaWVkKDEpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnY29uZmlybV92ZXJpZmllZCcsICfQl9Cw0LLQtdGA0YjQuNGC0Ywg0LTQvtC60YPQvNC10L3Rgj8nLCBbJ9CU0LAnLCAn0J3QtdGCJ10pCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYsIGFydGljbGVzOiBMaXN0W3N0cl0pOgogICAgICAgIHNldHRpbmdzID0gewogICAgICAgICAgICAidmFsdWVzX2xpc3QiOiAnOycuam9pbihhcnRpY2xlcyksCiAgICAgICAgICAgICJtaW5fbGVuZ3RoIjogbGVuKG1pbihhcnRpY2xlcywga2V5PWxlbikpLAogICAgICAgICAgICAibWF4X2xlbmd0aCI6IGxlbihtYXgoYXJ0aWNsZXMsIGtleT1sZW4pKSwKICAgICAgICB9CiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLnB1dCgnYXJ0aWNsZXNfb2NyX3NldHRpbmdzJywganNvbi5kdW1wcyhzZXR0aW5ncyksIFRydWUpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CgogICAgICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIFNlcmllc1NlbGVjdFNjcmVlbiwKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcz1zY3JlZW5fdmFsdWVzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9ICctMScgaWYgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJykgZWxzZSAnMScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd19idG5fZG9jX21hcmtfdmVyaWZpZWQnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfZG9jX2RhdGUnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfd2FyZWhvdXNlJywgZmluZGVkX2FydGljbGVzKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2NvdW50cmFnZW50JywgZmluZGVkX2FydGljbGVzKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2ZpbmRlZF9ieV9hcnRpY2xlJywgc3RyKC1pbnQoZmluZGVkX2FydGljbGVzKSkpCgoKCmNsYXNzIEFkckRvY0RldGFpbHNTY3JlZW4oRG9jRGV0YWlsc1NjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiycKICAgIHByb2Nlc3NfbmFtZSA9ICfQkNC00YDQtdGB0L3QvtC1INGF0YDQsNC90LXQvdC40LUnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhyc19zZXR0aW5ncz1yc19zZXR0aW5ncywgaGFzaF9tYXA9aGFzaF9tYXApCiAgICAgICAgc2VsZi50YWJsZXNfdHlwZXMgPSAn0J7RgtCx0L7RgDvQoNCw0LfQvNC10YnQtdC90LjQtScKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXSwKICAgICAgICAgICAgJ2RvY190eXBlJzogc2VsZi5oYXNoX21hcFsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgJ3RhYmxlX3R5cGUnOiBzZWxmLmhhc2hfbWFwWyd0YWJsZV90eXBlJ10sCiAgICAgICAgICAgICdkb2Nfbic6IHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sCiAgICAgICAgICAgICdkb2NfZGF0ZSc6IHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10sCiAgICAgICAgICAgICd3YXJlaG91c2UnOiBzZWxmLmhhc2hfbWFwWyd3YXJlaG91c2UnXQogICAgICAgIH0KICAgICAgICBzZWxmLmlkX2RvYyA9IHNlbGYuc2NyZWVuX3ZhbHVlc1snaWRfZG9jJ10KICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5zY3JlZW5fdmFsdWVzWydkb2NfdHlwZSddKQogICAgICAgIHNlbGYuc2VydmljZSA9IEFkckRvY1NlcnZpY2Uoc2VsZi5pZF9kb2MsIHRhYmxlX3R5cGU9c2VsZi50YWJsZV90eXBlKQogICAgICAgIHNlbGYuY3VycmVudF9jZWxsID0gJy0g0L3QtSDQstGL0LHRgNCw0L3QviAtJwogICAgICAgIHNlbGYuY3VycmVudF9jZWxsX2lkID0gJycKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RhYmxlc190eXBlJywgc2VsZi50YWJsZXNfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLmhhc2hfbWFwWyd0YWJsZV90eXBlJ10gPSAn0KDQsNC30LzQtdGJ0LXQvdC40LUnIGlmIHNlbGYuc2NyZWVuX3ZhbHVlc1sndGFibGVfdHlwZSddPT0naW4nIGVsc2UgJ9Ce0YLQsdC+0YAnCiAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkuX29uX3N0YXJ0KCkKICAgICAgICBzZWxmLl9ydW5fb25fc3RhcnRfaGFuZGxlcnMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljaywKICAgICAgICAgICAgJ2J0bl9iYXJjb2Rlcyc6IGxhbWJkYSA6IHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9ItCS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQiKSwKICAgICAgICAgICAgJ2JhcmNvZGUnOiBsYW1iZGEgOiBzZWxmLl9iYXJjb2RlX2xpc3RlbmVyKHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpKSwKICAgICAgICAgICAgJ2J0bl9kb2NfbWFya192ZXJpZmllZCc6IHNlbGYuX2RvY19tYXJrX3ZlcmlmaWVkLAogICAgICAgICAgICAnYnRuX3NlbGVjdF9jZWxsJzogc2VsZi5fc2VsZWN0X2NlbGwsCiAgICAgICAgICAgICdjZWxsX3NlbGVjdF9zdWNjZXNzJzogc2VsZi5fc2VsZWN0X2NlbGxfcmVzdWx0LAogICAgICAgICAgICAnYnRuX2NsZWFyX2NlbGwnOiBzZWxmLl9jbGVhcl9jZWxsLAogICAgICAgICAgICAndGFibGVfdHlwZSc6IHNlbGYuX3RhYmxlX3R5cGVfc2VsZWN0ZWQsCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ0JBQ0tfQlVUVE9OJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgn0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCcpOgogICAgICAgICAgICBzZWxmLl9iYXJjb2RlX2xpc3RlbmVyKHNlbGYuaGFzaF9tYXBbJ2ZsZF9iYXJjb2RlJ10pCgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkX2NhcmRfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIHNlbGVjdGVkX2NhcmRfZGF0YS5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAnMSc6CiAgICAgICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnMuYXBwZW5kKAogICAgICAgICAgICAgICAgbGFtYmRhOiBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX29wZW5fc2VsZWN0X2dvb2RzX3NjcmVlbihkYXRhPXNlbGVjdGVkX2NhcmRfZGF0YSkKCiAgICBkZWYgX2JhcmNvZGVfbGlzdGVuZXIoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgaWYgc2VsZi5fdXBkYXRlX2N1cnJlbnRfY2VsbChiYXJjb2RlKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXMgPSBzZWxmLl9nZXRfYmFyY29kZV9wcm9jZXNzX3BhcmFtcygpCiAgICAgICAgYmFyY29kZV9wcm9jZXNzX3BhcmFtc1snaXNfYWRyX2RvYyddID0gVHJ1ZQogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ2lkX2NlbGwnXSA9IHNlbGYuY3VycmVudF9jZWxsX2lkCiAgICAgICAgYmFyY29kZV9wcm9jZXNzX3BhcmFtc1sndGFibGVfdHlwZSddID0gc2VsZi50YWJsZV90eXBlCgogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlQWRyV29ya2VyKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgICoqYmFyY29kZV9wcm9jZXNzX3BhcmFtcywKICAgICAgICAgICAgdXNlX3NjYW5uaW5nX3F1ZXVlPUZhbHNlCiAgICAgICAgKQoKICAgICAgICByZXN1bHQgPSBzZWxmLmJhcmNvZGVfd29ya2VyLnByb2Nlc3NfdGhlX2JhcmNvZGUoYmFyY29kZSkKICAgICAgICBpZiByZXN1bHQuZXJyb3I6CiAgICAgICAgICAgIHNlbGYuX3Byb2Nlc3NfZXJyb3Jfc2Nhbl9iYXJjb2RlKHJlc3VsdCkKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5lcnJvcgoKICAgIGRlZiBfdXBkYXRlX2N1cnJlbnRfY2VsbChzZWxmLCBiYXJjb2RlKToKICAgICAgICBjdXJyZW50X2NlbGwgPSBzZWxmLmN1cnJlbnRfY2VsbF9pZAogICAgICAgIGRvY19jZWxsID0gc2VsZi5zZXJ2aWNlLmZpbmRfY2VsbChiYXJjb2RlKQoKICAgICAgICBpZiBkb2NfY2VsbDoKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbChkb2NfY2VsbFsnbmFtZSddLCBkb2NfY2VsbFsnaWQnXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaWYgbm90IGN1cnJlbnRfY2VsbCBhbmQgbm90IGRvY19jZWxsOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnd2FybmluZycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsICfQndC1INC90LDQudC00LXQvdCwINGP0YfQtdC50LrQsCcpCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9kb2NfbWFya192ZXJpZmllZChzZWxmKToKICAgICAgICBzZWxmLnNlcnZpY2UubWFya192ZXJpZmllZCgpCiAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIEFkckRvY3NMaXN0U2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGwoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnMuYXBwZW5kKHNlbGYuX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKQoKICAgIGRlZiBfb3Blbl9zZWxlY3RfY2VsbF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RhYmxlX25hbWUnOiAnUlNfY2VsbHMnLAogICAgICAgICAgICAncmVzdWx0X2xpc3RlbmVyJzogJ2NlbGxfc2VsZWN0X3N1Y2Nlc3MnLAogICAgICAgICAgICAnZmllbGRzJzoganNvbi5kdW1wcyhbJ25hbWUnXSksCiAgICAgICAgICAgICdyZXR1cm5fdmFsdWVfa2V5JzogJ3NlbGVjdGVkX2NhcmQnLAogICAgICAgICAgICAndGl0bGUnOiAn0JLRi9Cx0L7RgCDQt9C90LDRh9C10L3QuNGPJwogICAgICAgIH0KICAgICAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKHNlbGYuaGFzaF9tYXAsIFNlbGVjdEl0ZW1TY3JlZW4sIHNjcmVlbl92YWx1ZXMpCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGxfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGVjdGVkX2NlbGwgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKHNlbGVjdGVkX2NlbGwuZ2V0KCduYW1lJyksIHNlbGVjdGVkX2NlbGwuZ2V0KCdpZCcpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCgogICAgZGVmIF9jbGVhcl9jZWxsKHNlbGYpOgogICAgICAgIHNlbGYuX3NldF9jdXJyZW50X2NlbGwoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfdGFibGVfdHlwZV9zZWxlY3RlZChzZWxmKToKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5oYXNoX21hcFsndGFibGVfdHlwZSddKQogICAgICAgIHNlbGYuc2VydmljZS50YWJsZV90eXBlID0gc2VsZi50YWJsZV90eXBlCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCgogICAgICAgIGlmIHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICAgICAgY3JlYXRlX3NjcmVlbihzZWxmLmhhc2hfbWFwLCBBZHJEb2NzTGlzdFNjcmVlbikuc2hvdygpCgogICAgZGVmIF9vcGVuX3NlbGVjdF9nb29kc19zY3JlZW4oc2VsZiwgZGF0YSk6CiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnZG9jX3RpdGxlJzogJ3tkb2NfdHlwZX0g4oSWIHtkb2Nfbn0g0L7RgiB7ZG9jX2RhdGV9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICAqKnNlbGYuc2NyZWVuX3ZhbHVlcwogICAgICAgICAgICApLAogICAgICAgICAgICAnaXRlbV9uYW1lJzogZGF0YVsnZ29vZF9uYW1lJ10sCiAgICAgICAgICAgICdrZXknOiBkYXRhWydrZXknXSwKICAgICAgICAgICAgJ2lkX2dvb2QnOiBkYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF91bml0JzogZGF0YVsnaWRfdW5pdCddLAogICAgICAgICAgICAnaWRfcHJvcGVydHknOiBkYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAncXR0eSc6IGRhdGFbJ3F0dHknXSwKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IGRhdGFbJ3F0dHlfcGxhbiddLAogICAgICAgICAgICAnd2FyZWhvdXNlJzogc2VsZi5zY3JlZW5fdmFsdWVzWyd3YXJlaG91c2UnXSwKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gQWRyR29vZHNTZWxlY3RTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4uc2hvdyhzY3JlZW5fdmFsdWVzKQoKICAgIGRlZiBfZ2V0X2RvY19kZXRhaWxzX2RhdGEoc2VsZiwgbGFzdF9zY2FubmVkPUZhbHNlKToKICAgICAgICBzdXBlcigpLl9jaGVja19wcmV2aW91c19wYWdlKCkKICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpCiAgICAgICAgcm93X2ZpbHRlcnMgPSBzZWxmLmhhc2hfbWFwLmdldCgncm93c19maWx0ZXInKQogICAgICAgIHNlYXJjaF9zdHJpbmcgPSBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ1NlYXJjaFN0cmluZycpIGVsc2UgTm9uZQoKICAgICAgICBkYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGNlbGw9c2VsZi5jdXJyZW50X2NlbGxfaWQsCiAgICAgICAgICAgIGZpcnN0X2VsZW09MCBpZiBsYXN0X3NjYW5uZWQgZWxzZSBmaXJzdF9lbGVtZW50LAogICAgICAgICAgICBpdGVtc19vbl9wYWdlPTEgaWYgbGFzdF9zY2FubmVkIGVsc2Ugc2VsZi5pdGVtc19vbl9wYWdlLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQoKICAgICAgICBpZiBub3QgbGFzdF9zY2FubmVkOgogICAgICAgICAgICBzdXBlcigpLl9jaGVja19uZXh0X3BhZ2UobGVuKGRhdGEpKQogICAgICAgIHJldHVybiBkYXRhCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoX3ZhbCk6CiAgICAgICAgcmV0dXJuICdpbicgaWYgX3ZhbCA9PSAn0KDQsNC30LzQtdGJ0LXQvdC40LUnIGVsc2UgJ291dCcKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBkb2NfZGV0YWlscyk6CiAgICAgICAgIyBUT0RPINC00L7QsdCw0LLQuNGC0Ywg0LPRgNGD0L/Qv9C40YDQvtCy0LrRgyDQv9C+INGP0YfQtdC50LrQsNC8CiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICByb3dfZmlsdGVyID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgncm93c19maWx0ZXInKQoKICAgICAgICBmb3IgcmVjb3JkIGluIGRvY19kZXRhaWxzOgogICAgICAgICAgICBpZiByb3dfZmlsdGVyIGFuZCByZWNvcmRbJ3F0dHknXSA9PSByZWNvcmRbJ3F0dHlfcGxhbiddOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHBpYyA9ICcjZjAyYScgaWYgcmVjb3JkWydJc0RvbmUnXSAhPSAwIGVsc2UgJyNmMDBjJwogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSA9PSAwIGFuZCByZWNvcmRbJ3F0dHlfcGxhbiddID09IDA6CiAgICAgICAgICAgICAgICBwaWMgPSAnJwoKICAgICAgICAgICAgcHJvZHVjdF9yb3cgPSB7CiAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnaWQnXSksCiAgICAgICAgICAgICAgICAnY2VsbCc6IHN0cihyZWNvcmRbJ2NlbGxfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF9jZWxsJzogc3RyKHJlY29yZFsnaWRfY2VsbCddKSwKICAgICAgICAgICAgICAgICdnb29kX25hbWUnOiBzdHIocmVjb3JkWydnb29kX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IHN0cihyZWNvcmRbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaWRfcHJvcGVydHknOiBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pLAogICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXNfbmFtZSc6IHN0cihyZWNvcmRbJ3Byb3BlcnRpZXNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzdHIocmVjb3JkWydpZF9zZXJpZXMnXSksCiAgICAgICAgICAgICAgICAnc2VyaWVzX25hbWUnOiBzdHIocmVjb3JkWydzZXJpZXNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdpZF91bml0Jzogc3RyKHJlY29yZFsnaWRfdW5pdCddKSwKICAgICAgICAgICAgICAgICd1bml0c19uYW1lJzogc3RyKHJlY29yZFsndW5pdHNfbmFtZSddIG9yICcnKSwKICAgICAgICAgICAgICAgICdjb2RlX2FydCc6ICfQmtC+0LQ6ICcgKyBzdHIocmVjb3JkWydjb2RlJ10pLAogICAgICAgICAgICAgICAgJ2FydCc6IHN0cihyZWNvcmRbJ2FydCddKSwKICAgICAgICAgICAgICAgICdwaWN0dXJlJzogcGljLAogICAgICAgICAgICAgICAgJ3VzZV9zZXJpZXMnOiBzdHIocmVjb3JkWyd1c2Vfc2VyaWVzJ10pCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3BzID0gWwogICAgICAgICAgICAgICAgJ3t9ICcuZm9ybWF0KHByb2R1Y3Rfcm93WydhcnQnXSkgaWYgcHJvZHVjdF9yb3dbJ2FydCddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAnKHt9KSAnLmZvcm1hdChwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93Wydwcm9wZXJ0aWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJ3t9Jy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Nlcmllc19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAnLCB7fScuZm9ybWF0KHByb2R1Y3Rfcm93Wyd1bml0c19uYW1lJ10pIGlmIHByb2R1Y3Rfcm93Wyd1bml0c19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgXQogICAgICAgICAgICBwcm9kdWN0X3Jvd1snZ29vZF9pbmZvJ10gPSAnJy5qb2luKHByb3BzKQogICAgICAgICAgICBpZiByZWNvcmRbJ3F0dHknXSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydxdHR5J10gPSBzdHIoaW50KHJlY29yZFsncXR0eSddKSBpZiByZWNvcmRbJ3F0dHknXS5pc19pbnRlZ2VyKCkgZWxzZSByZWNvcmRbJ3F0dHknXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydxdHR5J10gPSAiMCIKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5X3BsYW4nXSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93WydxdHR5X3BsYW4nXSA9IHN0cihpbnQocmVjb3JkWydxdHR5X3BsYW4nXSkgaWYgcmVjb3JkWydxdHR5X3BsYW4nXS5pc19pbnRlZ2VyKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHJlY29yZFsncXR0eV9wbGFuJ10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10gPSAiMCIKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkKICAgICAgICAgICAgc2VsZi5fc2V0X2JhY2tncm91bmRfcm93X2NvbG9yKHByb2R1Y3Rfcm93KQoKICAgICAgICAgICAgaWYgc2VsZi5fYWRkZWRfZ29vZHNfaGFzX2tleShwcm9kdWN0X3Jvd1sna2V5J10pOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5pbnNlcnQoMSwgcHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQr9GH0LXQudC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cd0LDQt9Cy0LDQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cf0LvQsNC9JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQpNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCgogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucyhvdmVycmlkZV9zZWFyY2g9VHJ1ZSkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgoKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BjZWxsJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAZ29vZF9uYW1lJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGdvb2RfaW5mbycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0yLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5X3BsYW4nLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgZGVmIF9nZXRfZGV0YWlsX2NhcmRzKHNlbGYsIHFfcmVzdWx0KToKICAgICAgICByZXN1bHRzID0gcV9yZXN1bHQKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGdvb2RfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9c2VsZi5yc19zZXR0aW5ncy5nZXQoJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oVmFsdWU9ItCj0LTQsNC70LjRgtGMINGB0YLRgNC+0LrRgyIpLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhUZXh0Qm9sZD1UcnVlLCB3ZWlnaHQ9MSwgVmFsdWU9J0Bjb2RlX2FydCcpLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVGV4dEJvbGQ9RmFsc2UsIHdlaWdodD0xLCBWYWx1ZT0nQGFydCcpLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJob3Jpem9udGFsIiksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSfQn9C70LDQvScsIFRleHRTaXplPXNlbGYucnNfc2V0dGluZ3MuZ2V0KCdnb29kc1RleHRTaXplJykpLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWU9J0BxdHR5X3BsYW4nKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSfQpNCw0LrRgicpLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoVmFsdWU9J0BxdHR5JyksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldyhWYWx1ZT0n0KbQtdC90LAnKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KFZhbHVlPSdAcGljdHVyZScpLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJob3Jpem9udGFsIgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJ2ZXJ0aWNhbCIpLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMpCgogICAgICAgIGlmIHJlc3VsdHM6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpZF9kb2MnLCBzdHIocmVzdWx0c1swXVsnaWRfZG9jJ10pKQogICAgICAgICAgICBjdXJyZW50X2NlbGwgPSAnJwogICAgICAgICAgICBmb3IgcmVjb3JkIGluIHJlc3VsdHM6CiAgICAgICAgICAgICAgICAjIGlmIHNlbGYucm93X2ZpbHRlciBhbmQgcmVjb3JkWydxdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eSddID09IHJlY29yZFsncXR0eV9wbGFuJ106CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eSddID09IDAgYW5kIHJlY29yZFsncXR0eV9wbGFuJ10gPT0gMDoKICAgICAgICAgICAgICAgICAgICBwaWMgPSAnJwoKICAgICAgICAgICAgICAgIGlmIGN1cnJlbnRfY2VsbCAhPSByZWNvcmRbJ2NlbGxfbmFtZSddOgogICAgICAgICAgICAgICAgICAgIGMgPSB7Imdyb3VwIjogcmVjb3JkWydjZWxsX25hbWUnXX0KICAgICAgICAgICAgICAgICAgICAjIGRvY19kZXRhaWxfbGlzdFsnY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10uYXBwZW5kKGMpCiAgICAgICAgICAgICAgICAgICAgY2FyZHMuY3VzdG9tY2FyZHNbJ2NhcmRzZGF0YSddLmFwcGVuZChjKQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfY2VsbCA9IHJlY29yZFsnY2VsbF9uYW1lJ10KCiAgICAgICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsKICAgICAgICAgICAgICAgICAgICAna2V5Jzogc3RyKHJlY29yZFsnaWQnXSksCiAgICAgICAgICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHN0cihyZWNvcmRbJ2dvb2RfbmFtZSddKSwKICAgICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IHN0cihyZWNvcmRbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnRpZXMnOiBzdHIocmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10pLAogICAgICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSksCiAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHN0cihyZWNvcmRbJ2lkX3NlcmllcyddKSwKICAgICAgICAgICAgICAgICAgICAnc2VyaWVzX25hbWUnOiBzdHIocmVjb3JkWydzZXJpZXNfbmFtZSddKSwKICAgICAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAgICAgJ3VuaXRzX25hbWUnOiBzdHIocmVjb3JkWyd1bml0c19uYW1lJ10pLAogICAgICAgICAgICAgICAgICAgICdjb2RlX2FydCc6ICfQmtC+0LQ6ICcgKyBzdHIocmVjb3JkWydjb2RlJ10pLAogICAgICAgICAgICAgICAgICAgICdjZWxsX25hbWUnOiBzdHIocmVjb3JkWydjZWxsX25hbWUnXSksCiAgICAgICAgICAgICAgICAgICAgJ2lkX2NlbGwnOiBzdHIocmVjb3JkWydpZF9jZWxsJ10pLAogICAgICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddIGlmIHJlY29yZFsncXR0eSddIGlzIG5vdCBOb25lIGVsc2UgMCksCiAgICAgICAgICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHN0cihyZWNvcmRbJ3F0dHlfcGxhbiddIGlmIHJlY29yZFsncXR0eV9wbGFuJ10gaXMgbm90IE5vbmUgZWxzZSAwKSwKICAgICAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNhcmRzLmN1c3RvbWNhcmRzWydjYXJkc2RhdGEnXS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIF9zZXRfYmFja2dyb3VuZF9yb3dfY29sb3Ioc2VsZiwgcHJvZHVjdF9yb3cpOgogICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAnI0ZGRkZGRicKICAgICAgICBxdHR5LCBxdHR5X3BsYW4gPSBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eSddKSwgZmxvYXQocHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddKQogICAgICAgIGlmIHF0dHlfcGxhbiA+IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZCRTlFNyIKCiAgICAgICAgZWxpZiBxdHR5X3BsYW4gPCBxdHR5OgogICAgICAgICAgICBiYWNrZ3JvdW5kX2NvbG9yID0gIiNGRkY5QzQiCgogICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZF9jb2xvcgoKCiAgICBkZWYgX3NldF9jdXJyZW50X2NlbGwoc2VsZiwgY3VycmVudF9jZWxsPSctINC90LUg0LLRi9Cx0YDQsNC90L4gLScsIGN1cnJlbnRfY2VsbF9pZD0nJyk6CiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwsIHNlbGYuY3VycmVudF9jZWxsX2lkID0gY3VycmVudF9jZWxsLCBjdXJyZW50X2NlbGxfaWQKICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2NlbGwnXSA9IGN1cnJlbnRfY2VsbAogICAgICAgIGlmIGN1cnJlbnRfY2VsbF9pZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnU2hvd19idG5fY2xlYXJfY2VsbCddID0gMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX2NsZWFyX2NlbGwnXSA9IC0xCgoKY2xhc3MgRmxvd0RvY0RldGFpbHNTY3JlZW4oRG9jRGV0YWlsc1NjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C+0YLQvtC60KjRgtGA0LjRhdC60L7QtNC+0LLQlNC+0LrRg9C80LXQvdGC0LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0KHQsdC+0YAg0KjQmicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5GbG93RG9jU2VydmljZShzZWxmLmlkX2RvYykKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fYmFyY29kZV9mbG93X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLl9zZXRfdmlzaW9uX3NldHRpbmdzKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGlzdGVuZXInKQogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgY3VycmVudF9zdHIgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgiZG9jX2JhcmNfZmxvdyIpKQogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAgICAgZGF0YSA9IHsnYmFyY29kZSc6IGN1cnJlbnRfZWxlbVsnYmFyY29kZSddLAogICAgICAgICAgICAgICAgICAgICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiBjdXJyZW50X2VsZW1bJ25hbWUnXSwKICAgICAgICAgICAgICAgICAgICAncXR0eSc6IGN1cnJlbnRfZWxlbVsncXR0eSddLCAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6ICcnfQoKICAgICAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3Jvd3NfZmlsdGVyJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2JhcmNvZGVzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygn0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCcpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9iYXJjb2RlX3RvX2RhdGFiYXNlKGJhcmNvZGUpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5pZF9kb2MpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfYmFyY19mbG93X3N0YXR1cygpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCfQktCy0LXRgdGC0LjQqNGC0YDQuNGF0LrQvtC0Jyk6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGVfdG9fZGF0YWJhc2UoYmFyY29kZSkKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmlkX2RvYykKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fdmVyaWZpZWQnKToKICAgICAgICAgICAgUnNEb2Moc2VsZi5pZF9kb2MpLm1hcmtfdmVyaWZpZWQoMSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnY29uZmlybV92ZXJpZmllZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ9CX0LDQstC10YDRiNC40YLRjCDQtNC+0LrRg9C80LXQvdGCPycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyfQlNCwJywgJ9Cd0LXRgiddKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd2aXNpb25fY2FuY2VsJzoKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbic6CiAgICAgICAgICAgIFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbF9jb3VudGVyLmRlc3Ryb3koKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICfQn9C10YfQsNGC0YzQn9GA0LXQstGM0Y4nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fb2NyX3NlcmlhbF90ZW1wbGF0ZV9zZXR0aW5ncyc6CiAgICAgICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdzaG93X3Byb2Nlc3NfcmVzdWx0JywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCdPY3JUZXh0UmVjb2duaXRpb24nLCAnU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MnKQoKICAgIGRlZiBfYmFyY29kZV9mbG93X29uX3N0YXJ0KHNlbGYpOgoKICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykKICAgICAgICBmYWxzZVZhbHVlTGlzdCA9ICgwLCAnMCcsICdmYWxzZScsICdGYWxzZScsIE5vbmUpCiAgICAgICAgIyDQpNC+0YDQvNC40YDRg9C10Lwg0YLQsNCx0LvQuNGG0YMg0LrQsNGA0YLQvtGH0LXQuiDQuCDQt9Cw0L/RgNC+0YEg0Log0LHQsNC30LUKCiAgICAgICAgZG9jX2RldGFpbHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2Zsb3dfdGFibGVfZGF0YSgpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShkb2NfZGV0YWlscykKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2RvY190YWJsZV92aWV3KHRhYmxlX2RhdGE9dGFibGVfZGF0YSkKCiAgICAgICAgaWYgZG9jX2RldGFpbHM6CiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIHN0cihyZXN1bHRzWzBdWydpZF9kb2MnXSkpCgogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6LCBoYXZlX3F0dHlfcGxhbiDQldGB0YLRjNCf0LvQsNC90J/QntCa0J7Qu9C40YfQtdGB0YLQstGDICAtICDQmNGB0YLQuNC90LAg0LrQvtCz0LTQsCDRgdGD0LzQvNCwINC60L7Qu9C+0L3QutC4IFF0dHlfcGxhbiA+IDAKICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAgaGF2ZV9tYXJrX3BsYW4gItCV0YHRgtGM0J/Qu9Cw0L3QmtCe0LTQvtCy0JzQsNGA0LrQuNGA0L7QstC60Lgg4oCTINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQvtC6INGC0LDQsdC7LiBSU19kb2NzX2JhcmNvZGVzINGBINC30LDQtNCw0L3QvdGL0LwgaWRfZG9jINC4IGlzX3BsYW4gINCx0L7Qu9GM0YjQtSDQvdGD0LvRjy4KICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiBoYXZlX3plcm9fcGxhbiAi0JXRgdGC0Ywg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUiINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQtdGB0YLRjCDQt9Cw0L/QvtC70L3QtdC90L3Ri9C1INGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0L7QsiDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAi0JrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjCIgIC0g0L/RgNC40LfQvdCw0Log0LTQu9GPINC00L7QutGD0LzQtdC90YLQsCwg0L3QsNC00L4g0LvQuCDQutC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMCgogICAgICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyLAogICAgICAgICAgICAgICAgc3VtKGlmbnVsbChxdHR5X3BsYW4sMCkpIGFzIHF0dHlfcGxhbgogICAgICAgICAgICAgICAgZnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYyA9IDppZF9kb2MnJycKICAgICAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jfSkKICAgICAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gcmVzWzBdWzBdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0YHRgtGA0L7QutC4CiAgICAgICAgICAgICAgICBpZiBoYXZlX3plcm9fcGxhbjoKICAgICAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHJlc1swXVsxXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINC60L7Qu9Cy0L4g0L/Qu9Cw0L0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICAjINCV0YHRgtGMINC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0LvQsNC9INC/0L4g0LrQvtC00LDQvCDQvNCw0YDQutC40YDQvtCy0LrQuAogICAgICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyCiAgICAgICAgICAgICAgICBmcm9tIFJTX2RvY3NfYmFyY29kZXMgV2hlcmUgaWRfZG9jID0gOmlkX2RvYyBBTkQgaXNfcGxhbiA9IDppc19wbGFuJycnCiAgICAgICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvYywgJ2lzX3BsYW4nOiAnMSd9KQogICAgICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gcmVzWzBdWzBdID4gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdoYXZlX3F0dHlfcGxhbicsIHN0cihoYXZlX3F0dHlfcGxhbikpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hhdmVfemVyb19wbGFuJywgc3RyKGhhdmVfemVyb19wbGFuKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGF2ZV9tYXJrX3BsYW4nLCBzdHIoaGF2ZV9tYXJrX3BsYW4pKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdTRUxFQ1QgY29udHJvbCBmcm9tIFJTX2RvY3MgIFdIRVJFIGlkX2RvYyA9ID8nLCAoaWRfZG9jLCkpCiAgICAgICAgIyDQldGB0YLRjCDQu9C4INC60L7QvdGC0YDQvtC70Ywg0L/Qu9Cw0L3QsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIGlmIHJlc1swXVswXToKICAgICAgICAgICAgICAgIGlmIHJlc1swXVswXSBpbiBmYWxzZVZhbHVlTGlzdDoKICAgICAgICAgICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjb250cm9sID0gJ1RydWUnCgogICAgICAgICAgICAgICAgIyBjb250cm9sID0gcmVzWzBdWzBdICMnVHJ1ZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NvbnRyb2wnLCBjb250cm9sKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJkb2NfYmFyY19mbG93IiwgdGFibGVfdmlldy50b19qc29uKCkpCgogICAgICAgIGlmIFRydWUgaW4gKGhhdmVfcXR0eV9wbGFuLCBoYXZlX3plcm9fcGxhbiwgaGF2ZV9tYXJrX3BsYW4sIGNvbnRyb2wpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndG9hc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0YHQvtC00LXRgNC20LjRgiDQv9C70LDQvdC+0LLRi9C1INGB0YLRgNC+0LrQuC4g0KHQv9C40YHQvtC6INGI0YLRgNC40YXQutC+0LTQvtCyINCyINC90LXQs9C+INC/0L7QvNC10YHRgtC40YLRjCDQvdC10LvRjNC30Y8nKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTMKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BiYXJjb2RlJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MywKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBkb2NfZGV0YWlscyk6CgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IHN0cihzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlID0gc3RyKHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpKQoKICAgICAgICBpZiBiYXJjb2RlOgogICAgICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX3NvcnRfdGFibGVfYnlfYmFyY29kZShkb2NfZGV0YWlscywgYmFyY29kZSkKCiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICAjIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2VsZi5oYXNoX21hcC5nZXQoJ2FkZGVkX2dvb2RzJykpCgogICAgICAgIGZvciByZWNvcmQgaW4gZG9jX2RldGFpbHM6CgogICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsna2V5Jzogc3RyKHJlY29yZFsnYmFyY29kZSddKSwgJ2JhcmNvZGUnOiBzdHIocmVjb3JkWydiYXJjb2RlJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZFsnbmFtZSddIGlmIHJlY29yZFsnbmFtZSddIGlzIG5vdCBOb25lIGVsc2UgJy3QvdC10YIg0LTQsNC90L3Ri9GFLScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCl9CgogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddLkJhY2tncm91bmRDb2xvciA9ICcjRkZGRkZGJyBpZiByZWNvcmRbJ25hbWUnXSBpcyBub3QgTm9uZSBlbHNlICIjRkJFOUU3IgoKICAgICAgICAgICAgIyDRjdGC0L4g0L3QtSDRgNCw0LHQvtGC0LDQtdGCINGB0YPQtNGPINC/0L4g0LLRgdC10LzRgyDQv9C+0YLQvtC80YMg0YfRgtC+INC90LXRgiDQsiBoYXNoX21hcCDQutC70Y7Rh9CwIGFkZGVkX2dvb2RzCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9zb3J0X3RhYmxlX2J5X2JhcmNvZGUoc2VsZiwgdGFibGUsIGJhcmNvZGUpOgoKICAgICAgICBmb3IgaSwgcm93IGluIGVudW1lcmF0ZSh0YWJsZSk6CiAgICAgICAgICAgIGlmIHN0cihyb3cuZ2V0KCdiYXJjb2RlJykpID09IGJhcmNvZGU6CiAgICAgICAgICAgICAgICBkZWwgdGFibGVbaV0KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydCgwLCByb3cpCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICByZXR1cm4gdGFibGUKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICBvY3Jfbm9zcWwgPSBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWwKICAgICAgICBzZXJpYWxfb2NyX3NldHRpbmdzID0gb2NyX25vc3FsLmdldCgnc2VyaWFsX29jcl9zZXR0aW5ncycpCiAgICAgICAgaWYgc2VyaWFsX29jcl9zZXR0aW5nczoKICAgICAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IGpzb24ubG9hZHMoc2VyaWFsX29jcl9zZXR0aW5ncykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdmlzaW9uX3NldHRpbmdzKCoqc2VyaWFsX29jcl9zZXR0aW5ncykKICAgICAgICAgICAgb2NyX25vc3FsLnB1dCgnZnJvbV9zY3JlZW4nLCAnRmxvd0RvY0RldGFpbHNTY3JlZW4nLCBUcnVlKQoKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBEb2NEZXRhaWxzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHMgc2VsZWN0ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBCYXNlR29vZFNlbGVjdChTY3JlZW4pOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaWRfZG9jJzogJycKICAgICAgICB9CiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaWRfZG9jID0gc2VsZi5zY3JlZW5fdmFsdWVzWydpZF9kb2MnXQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICAjINCg0LXQttC40Lwg0YDQsNCx0L7RgtGLINGBINC80YPQu9GM0YLQuNC80LXQtNC40LAg0Lgg0YTQsNC50LvQsNC80Lgg0L/QviDRgdGB0YvQu9C60LDQvCAo0YTQu9Cw0LMgbW1fbG9jYWwpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnbW1fbG9jYWwnXSA9ICcnCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncXR0eScsICcwJykKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCduZXdfcXR0eScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJyk6CiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKCiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJidG5fb2siOgogICAgICAgICAgICBzZWxmLl9oYW5kbGVfYnRuX29rKCkKICAgICAgICBlbGlmICdvcHMnIGluIGxpc3RlbmVyOgogICAgICAgICAgICAiIiLQn9GA0LXRhNC40LrRgSDQutC90L7Qv9C+0LogKy8tLCDQt9C90LDRh9C10L3QuNC1INCyINC90LDQt9Cy0LDQvdC40Y/RhSDQutC90L7Qv9C+0LoiIiIKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEoaW50KGxpc3RlbmVyWzQ6XSkpCiAgICAgICAgZWxpZiBsaXN0ZW5lciBpbiBbImJ0bl9jYW5jZWwiLCAnQkFDS19CVVRUT04nLCAnT05fQkFDS19QUkVTU0VEJ106CiAgICAgICAgICAgc2VsZi5faGFuZGxlX2J0bl9vaygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3ByaW50JzoKICAgICAgICAgICAgc2VsZi5wcmludF90aWNrZXQoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX3RoZV9iYXJjb2RlKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZi5wcmludF90aWNrZXQoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9kb2NfZ29vZF9iYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5faGFuZGxlX2RvY19nb29kX2JhcmNvZGUoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zZXJpZXNfc2hvdyc6CiAgICAgICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLmhhc2hfbWFwWydrZXknXSkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5faW5wdXRfcXR0eSc6CiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2hvd19kaWFsb2dfcXR0eSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9xdHR5Jyk6CiAgICAgICAgICAgIGlmIHNlbGYuX3ZhbGlkYXRlX2RlbHRhX2lucHV0KCk6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEoMCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fbWFya3Nfc2hvdyc6CiAgICAgICAgICAgIHNlbGYuX29wZW5fbWFya3Nfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQoKICAgIGRlZiBfaGFuZGxlX2J0bl9vayhzZWxmKToKICAgICAgICBjdXJyZW50X2VsZW0gPSBzZWxmLl9nZXRfY3VycmVudF9lbGVtKCkKCiAgICAgICAgbmV3X3F0dHkgPSBmbG9hdChzZWxmLmhhc2hfbWFwWyduZXdfcXR0eSddIG9yIDApCiAgICAgICAgcXR0eV9wbGFuID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHlfcGxhbicpIG9yIDApCiAgICAgICAgcXR0eSA9IGZsb2F0KGN1cnJlbnRfZWxlbS5nZXQoJ2RfcXR0eScpIG9yIDApCgogICAgICAgIGlmIG5ld19xdHR5IDwgMDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JjRgtC+0LPQvtCy0L7QtSDQutC+0LvQuNGH0LXRgdGC0LLQviDQvNC10L3RjNGI0LUgMCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY29udHJvbCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2NvbnRyb2wnKQogICAgICAgIGlmIGNvbnRyb2wgYW5kIChtYXgobmV3X3F0dHksIHF0dHkpID4gcXR0eV9wbGFuKToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0JrQvtC70LjRh9C10YHRgtCy0L4g0L/Qu9Cw0L0g0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0YDQtdCy0YvRiNC10L3QvicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICBxdHR5ID0gbmV3X3F0dHkKCiAgICAgICAgc2VsZi5faGFuZGxlX2Nob2ljZShjdXJyZW50X2VsZW0sIHF0dHkpCgogICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfcXR0eScsICcnKQoKICAgIGRlZiBfaGFuZGxlX2Nob2ljZShzZWxmLCBjdXJyZW50X2VsZW0sIHF0dHkpOgogICAgICAgIHJvd19pZCA9IGludChjdXJyZW50X2VsZW1bJ2tleSddKSBpZiBjdXJyZW50X2VsZW0gZWxzZSBzZWxmLnNjcmVlbl92YWx1ZXMuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwLmdldCgna2V5JykKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAncXR0eSc6IGZsb2F0KHF0dHkpIGlmIHF0dHkgZWxzZSAwLAogICAgICAgIH0KICAgICAgICBzZWxmLl91cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpKQogICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKCiAgICBkZWYgX2hhbmRsZV9kb2NfZ29vZF9iYXJjb2RlKHNlbGYpOgogICAgICAgIHNlbGVjdGVkX2NhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgaW5pdF9kYXRhID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGVjdGVkX2NhcmRfZGF0YS5nZXQoJ2lkX2dvb2QnLCAnJyksCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6IHNlbGVjdGVkX2NhcmRfZGF0YS5nZXQoJ2lkX3Byb3BlcnRpZXMnLCAnJyksCiAgICAgICAgICAgICd1bml0X2lkJzogc2VsZWN0ZWRfY2FyZF9kYXRhLmdldCgnaWRfdW5pdCcsICcnKQogICAgICAgIH0KICAgICAgICBCYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3dfcHJvY2Vzc19yZXN1bHQoaW5pdF9kYXRhKQoKICAgIGRlZiBfdmFsaWRhdGVfZGVsdGFfaW5wdXQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9CS0LLQtdC00LXQvdC90L7QtSDQt9C90LDRh9C10L3QuNC1INC90LUg0Y/QstC70Y/QtdGC0YHRjyDQstCw0LvQuNC00L3Ri9C8INGH0LjRgdC70L7QvCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQoKICAgIGRlZiBfZmlsbF9ub25lX3ZhbHVlcyhzZWxmLCBkYXRhLCBrZXlzLCBkZWZhdWx0PScnKToKICAgICAgICBub25lX2xpc3QgPSBbTm9uZSwgJ05vbmUnXQogICAgICAgIGZvciBrZXkgaW4ga2V5czoKICAgICAgICAgICAgZGF0YVtrZXldID0gZGVmYXVsdCBpZiBkYXRhW2tleV0gaW4gbm9uZV9saXN0IGVsc2UgZGF0YVtrZXldCgogICAgZGVmIF9tYXRjaF9yZWNvcmQoc2VsZiwgcmVjb3JkLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgcmV0dXJuIChyZWNvcmRbJ2lkX2dvb2QnXSA9PSBpZF9nb29kIGFuZAogICAgICAgICAgICAgICAgcmVjb3JkWydpZF9wcm9wZXJ0aWVzJ10gPT0gaWRfcHJvcGVydHkgYW5kCiAgICAgICAgICAgICAgICByZWNvcmRbJ2lkX3VuaXQnXSA9PSBpZF91bml0KQoKICAgIGRlZiBfZmluZF9tYXRjaGluZ19nb29kKHNlbGYsIHRhYmxlX2RhdGEsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF91bml0KToKICAgICAgICBmb3IgaSwgcmVjb3JkIGluIGVudW1lcmF0ZSh0YWJsZV9kYXRhWzE6XSwgc3RhcnQ9MSk6CiAgICAgICAgICAgIGlmIHNlbGYuX21hdGNoX3JlY29yZChyZWNvcmQsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF91bml0KToKICAgICAgICAgICAgICAgIHJldHVybiBpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgX2hhbmRsZV9mb3VuZF9iYXJjb2RlKHNlbGYsIHJlcywgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIGlkX2dvb2RfYnIsIGlkX3Byb3BlcnR5X2JyLCBpZF91bml0X2JyLCByYXRpbyA9IHJlc1snaWRfZ29vZCddLCByZXNbJ2lkX3Byb3BlcnR5J10sIHJlc1snaWRfdW5pdCddLCBpbnQocmVzWydyYXRpbyddKQoKICAgICAgICBpZiBpZF9nb29kID09IGlkX2dvb2RfYnIgYW5kIGlkX3Byb3BlcnR5ID09IGlkX3Byb3BlcnR5X2JyIGFuZCBpZF91bml0ID09IGlkX3VuaXRfYnI6CiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJhdGlvKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX2dldF9jdXJyZW50X2VsZW0oc2VsZik6CiAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICByZXR1cm4gY3VycmVudF9lbGVtIG9yIHNlbGYuc2NyZWVuX3ZhbHVlcwoKICAgIGRlZiBfc2F2ZV9uZXdfZGVsdGEoc2VsZik6CiAgICAgICAgbmV3X3F0dHkgPSBzZWxmLl9nZXRfZmxvYXRfdmFsdWUoc2VsZi5oYXNoX21hcC5nZXQoJ25ld19xdHR5JykpCgogICAgICAgIGlmIG5ld19xdHR5IDwgMDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JjRgtC+0LPQvtCy0L7QtSDQutC+0LvQuNGH0LXRgdGC0LLQviDQvNC10L3RjNGI0LUgMCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY29udHJvbCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2NvbnRyb2wnKQogICAgICAgIGlmIGNvbnRyb2w6CiAgICAgICAgICAgIGlmIG5ld19xdHR5ID4gc2VsZi5fZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5X3BsYW4nKSk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/RgNC10LLRi9GI0LXQvdC+JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjdXJyZW50X2VsZW0gPSBzZWxmLl9nZXRfY3VycmVudF9lbGVtKCkKICAgICAgICBxdHR5ID0gbmV3X3F0dHkKICAgICAgICBvbGRfcXR0eSA9IGZsb2F0KGN1cnJlbnRfZWxlbS5nZXQoJ3F0dHknKSBvciAwKQogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdwYXJlbnRfc2NyZWVuJykgPT0gJ9CS0YvQsdC+0YDQotC+0LLQsNGA0LDQkNGA0YLQuNC60YPQuyc6CiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgICAgIGlmIHF0dHkgPT0gc2VsZi5fZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5JykpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JLRi9Cx0L7RgNCi0L7QstCw0YDQsNCQ0YDRgtC40LrRg9C7IikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBmaW5kZWRfZ29vZHNfY2FyZHMgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmluZGVkX2dvb2RzX2NhcmRzJywgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIGNhcmRzZGF0YSA9IGZpbmRlZF9nb29kc19jYXJkc1snY3VzdG9tY2FyZHMnXVsnY2FyZHNkYXRhJ10KCiAgICAgICAgICAgIGNhcmRfZGF0YSA9IG5leHQoZWxlbSBmb3IgZWxlbSBpbiBjYXJkc2RhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBlbGVtWydrZXknXSA9PSBjdXJyZW50X2VsZW1bJ2tleSddKQogICAgICAgICAgICBjYXJkX2RhdGFbJ3F0dHknXSA9IHF0dHkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ZpbmRlZF9nb29kc19jYXJkcycsIGZpbmRlZF9nb29kc19jYXJkcywgdG9fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQktGL0LHQvtGA0KLQvtCy0LDRgNCw0JDRgNGC0LjQutGD0LsiKQogICAgICAgIGVsaWYgcXR0eSAhPSBvbGRfcXR0eToKICAgICAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAnc2VudCc6IDAsCiAgICAgICAgICAgICAgICAncXR0eSc6IHF0dHksCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcm93X2lkID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgICAgIHNlbGYuX3VwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1yb3dfaWQpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfcXR0eScsIHN0cihyb3VuZChxdHR5LCAzKSkpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdxdHR5Jywgc3RyKHF0dHkpKQoKICAgIGRlZiBfZ2V0X2Zsb2F0X3ZhbHVlKHNlbGYsIHZhbHVlKToKICAgICAgICBpZiB2YWx1ZSBhbmQgcmUubWF0Y2goIl5cZCtcLj9cZCokIiwgdmFsdWUpOgogICAgICAgICAgICByZXR1cm4gZmxvYXQodmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIDAuMAoKICAgIGRlZiBfcHJvY2Vzc190aGVfYmFyY29kZShzZWxmKToKICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfZ29vZF9zZWxlY3QnKQogICAgICAgIGFsbG93ZWRfZmFjdF9pbnB1dCA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdhbGxvd19mYWN0X2lucHV0JykKICAgICAgICBpZiBub3QgKGJhcmNvZGUgYW5kIGFsbG93ZWRfZmFjdF9pbnB1dCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1IScpICMg0L/QvtC60LAg0YLQvtGB0YIsINC80L7QtNCw0LvQutCwINC+0YfQuNGJ0LDQtdGCINC00LXQu9GM0YLRgwogICAgICAgICAgICAjIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9J2JhcmNvZGVfbm90X2ZvdW5kJywgdGl0bGU9J9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1IScpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZF9nb29kID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2dvb2QnKQogICAgICAgIGlkX3Byb3BlcnR5ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX3Byb3BlcnR5Jykgb3IgJycKICAgICAgICBpZF91bml0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX3VuaXQnKSBvciAnJwoKICAgICAgICByZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2JhcmNvZGUoYmFyY29kZSkKICAgICAgICBpZiByZXMgYW5kIHNlbGYuX2hhbmRsZV9mb3VuZF9iYXJjb2RlKHJlcywgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZifQqNGC0YDQuNGF0LrQvtC0INC90LUg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtSEnKSAjINC/0L7QutCwINGC0L7RgdGCLCDQvNC+0LTQsNC70LrQsCDQvtGH0LjRidCw0LXRgiDQtNC10LvRjNGC0YMKICAgICAgICAjc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZyhsaXN0ZW5lcj0nYmFyY29kZV9ub3RfZm91bmQnLCB0aXRsZT0n0KjRgtGA0LjRhdC60L7QtCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUhJykKCiAgICBkZWYgX3NldF9kZWx0YShzZWxmLCB2YWx1ZTogaW50ID0gMCwgcmVzZXQ6IGJvb2wgPSBGYWxzZSk6CiAgICAgICAgIiIi0KHQvtC30LTQsNC10LwgKNC+0LHQvdGD0LvRj9C10LwpINC/0L7Qu9C1INCy0LLQvtC00LAiIiIKICAgICAgICBpZiByZXNldDoKICAgICAgICAgICAgZGVsdGEgPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRlbHRhID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJykgb3IgMCkgKyB2YWx1ZSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKSBlbHNlIHZhbHVlCiAgICAgICAgICAgIGRlbHRhID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KGRlbHRhKQogICAgICAgICAgICBzZWxmLl9zZXRfcmVzdWx0X3F0dHkoZGVsdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkZWx0YScsIGRlbHRhKQoKICAgIGRlZiBfZm9ybWF0X3F1YW50aXR5KHNlbGYsIHF0dHkpOgogICAgICAgIGlmIGZsb2F0KHF0dHkpICUgMSA9PSAwOgogICAgICAgICAgICByZXR1cm4gaW50KGZsb2F0KHF0dHkpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBxdHR5CgogICAgZGVmIF9zZXRfcmVzdWx0X3F0dHkoc2VsZiwgZGVsdGEpOgogICAgICAgIG5ld19xdHR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSBvciAwKSArIGRlbHRhCiAgICAgICAgbmV3X3F0dHkgPSBzdHIoc2VsZi5fZm9ybWF0X3F1YW50aXR5KG5ld19xdHR5KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbmV3X3F0dHknLCBuZXdfcXR0eSkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCiAgICBkZWYgcHJpbnRfdGlja2V0KHNlbGYpOgogICAgICAgICMg0J/QvtC70YPRh9C40Lwg0L/QtdGA0LLRi9C5INCx0LDRgNC60L7QtCDQtNC+0LrRg9C80LXQvdGC0LAKCiAgICAgICAgYmFyY29kZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkuZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZi5oYXNoX21hcC5nZXQoJ2tleScpKQoKICAgICAgICBkYXRhID0geyfQlNCw0YLQsF/QtNC+0LonOiAnRG9jX2RhdGEnLCAn0J3QvtC80LXQvdC60LvQsNGC0YPRgNCwJzogJ0dvb2QnLAogICAgICAgICAgICAgICAgJ9CQ0YDRgtC40LrRg9C7JzogJ2dvb2RfYXJ0JywgJ9Ch0LXRgNC40LnQvdGL0Lkg0L3QvtC80LXRgCc6ICdnb29kX3NuJywKICAgICAgICAgICAgICAgICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJzogJ2dvb2RfcHJvcGVydHknLCAn0KbQtdC90LAnOiAnZ29vZF9wcmljZScsCiAgICAgICAgICAgICAgICAn0JXQtNCY0LfQvCc6ICdnb29kX3VuaXQnLCAn0JrQu9GO0YcnOiAna2V5JywgJ9CS0LDQu9GO0YLQsCc6ICdwcmljZV90eXBlJ30KICAgICAgICBmb3Iga2V5IGluIGRhdGE6CiAgICAgICAgICAgIGRhdGFba2V5XSA9IHNlbGYuaGFzaF9tYXAuZ2V0KGRhdGFba2V5XSkKICAgICAgICBkYXRhWydiYXJjb2RlJ10gPSBiYXJjb2RlIGlmIGJhcmNvZGUgZWxzZSAnMDAwMDAwMDAwMDAwMCcKICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICBkZWYgX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLCBkb2Nfcm93X2tleSk6CiAgICAgICAgc2V0X2N1cnJlbnRfc2NyZWVuKE5vbmUpCiAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2RvY19yb3dfaWQnOiBkb2Nfcm93X2tleSwKICAgICAgICAgICAgJ3RpdGxlJzogJ9Ch0LXRgNC40LgnLAogICAgICAgICAgICAndXNlX2Fkcl9kb2NzX3RhYmxlcyc6ICcwJwogICAgICAgIH0KICAgICAgICBzY3JlZW4gPSBTZXJpZXNTZWxlY3RTY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MKICAgICAgICApCiAgICAgICAgc2NyZWVuLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX3ZhbHVlcykKCiAgICBkZWYgX29wZW5fbWFya3Nfc2NyZWVuKHNlbGYsIGRvY19yb3dfaWQpOgogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9nZXRfbWFya3NfZGF0YShkb2Nfcm93X2lkKQogICAgICAgIGlmIG5vdCB0YWJsZV9kYXRhOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2NyZWVuX2FyZ3MgPSB7CiAgICAgICAgICAgICd0aXRsZSc6ICfQnNCw0YDQutC4INGC0L7QstCw0YDQsCcsCiAgICAgICAgICAgICd0YWJsZV9kYXRhJzoganNvbi5kdW1wcyh0YWJsZV9kYXRhKSwKICAgICAgICAgICAgJ3RhYmxlX2hlYWRlcic6IGpzb24uZHVtcHMoeydtYXJrX2NvZGUnOiAn0JzQsNGA0LrQsCd9KSwKICAgICAgICAgICAgJ2VudW1lcmF0ZSc6IFRydWUKICAgICAgICB9CiAgICAgICAgU2hvd0l0ZW1zU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX2FyZ3MpCgogICAgZGVmIF9nZXRfbWFya3NfZGF0YShzZWxmLCBkb2Nfcm93X2lkKToKICAgICAgICByZXR1cm4gc2VsZi5zZXJ2aWNlLmdldF9tYXJrc19kYXRhKHNlbGYuaWRfZG9jLCBkb2Nfcm93X2lkKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkKToKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAnZF9xdHR5JzogZmxvYXQoZGF0YVsncXR0eSddKSwKICAgICAgICB9CgogICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpKQoKICAgICAgICBpbnNlcnRfdG9fcXVldWUgPSB7CiAgICAgICAgICAgICJpZF9kb2MiOiBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJyksCiAgICAgICAgICAgICJpZF9nb29kIjogc2VsZi5oYXNoX21hcC5nZXQoImlkX2dvb2QiKSwKICAgICAgICAgICAgImlkX3Byb3BlcnRpZXMiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfcHJvcGVydHkiKSwKICAgICAgICAgICAgImlkX3NlcmllcyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9zZXJpZXMiKSwKICAgICAgICAgICAgImlkX3VuaXQiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfdW5pdCIpLAogICAgICAgICAgICAiaWRfY2VsbCI6ICIiLAogICAgICAgICAgICAiZF9xdHR5IjogZmxvYXQoc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJykpLAogICAgICAgICAgICAic2VudCI6IEZhbHNlLAogICAgICAgICAgICAicHJpY2UiOiBzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9wcmljZSIpLAogICAgICAgICAgICAiaWRfcHJpY2UiOiAiIgogICAgICAgIH0KCiAgICAgICAgYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9kb2MiKSkKICAgICAgICBiYXJjb2RlX3dvcmtlci5xdWV1ZV91cGRhdGVfZGF0YSA9IGluc2VydF90b19xdWV1ZQogICAgICAgIGJhcmNvZGVfd29ya2VyLnVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoKQoKICAgIGRlZiBfc2hvd19kaWFsb2dfcXR0eShzZWxmKToKICAgICAgICBsb3lhdXQgPSAnJyd7CiAgICAgICAgICAgICJ0eXBlIjogIkxpbmVhckxheW91dCIsCiAgICAgICAgICAgICJWYXJpYWJsZSI6ICIiLAogICAgICAgICAgICAib3JpZW50YXRpb24iOiAiaG9yaXpvbnRhbCIsCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICJ3ZWlnaHQiOiAiMCIsCiAgICAgICAgICAgICJFbGVtZW50cyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiVmFsdWUiOiAiQGRlbHRhIiwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFibGUiOiAiZGVsdGEiLAogICAgICAgICAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgICAgICAgICAid2lkdGgiOiAibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkVkaXRUZXh0TnVtZXJpYyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0nJycKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdtb2RhbF9kaWFsb2dfaW5wdXRfcXR0eScsIHRpdGxlPSLQktCy0L7QtCDQutC+0LvQuNGH0LXRgdGC0LLQsCDRgtC+0LLQsNGA0LAiLCBkaWFsb2dfbGF5b3V0PWxveWF1dCkKCgpjbGFzcyBHb29kc1NlbGVjdFNjcmVlbihCYXNlR29vZFNlbGVjdCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGAINCy0YvQsdC+0YAnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKICAgICAgICAj0JPQvtGC0L7QstC40Lwg0LTQsNC90L3Ri9C1INC00LvRjyDQv9C10YDQstC40YfQvdC+0LPQviDQvtGC0L7QsdGA0LDQttC10L3QuNGPINC/0YDQuCDQvtGC0LrRgNGL0YLQuNC4INC/0L4g0LrQu9C40LrRgwogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd3YXNfY2xpY2tlZCcpID09ICcxJzoKICAgICAgICAgICAgZG9jX3Jvd3MgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19yb3dzX2NvdW50KHNlbGYuaWRfZG9jKVsnZG9jX3Jvd3MnXQogICAgICAgICAgICBkb2NfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLmlkX2RvYywgMCwgZG9jX3Jvd3MpCiAgICAgICAgICAgIGRvY19kYXRhLmluc2VydCgwLCB7fSkKICAgICAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJykKCiAgICAgICAgICAgICMg0YLQtdC60YPRidC40Lkg0Y3Qu9C10LzQtdC90YIg0L3QtSDQvdCw0LnQtNC10L0g0LjQu9C4INGN0YLQviDQt9Cw0LPQvtC70L7QstC+0Log0YLQsNCx0LvQuNGG0YsKICAgICAgICAgICAgaWYgY3VycmVudF9lbGVtIGlzIE5vbmUgb3IgJ2dvb2RfbmFtZScgbm90IGluIGN1cnJlbnRfZWxlbToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgc2hvd19oaWRlID0gJzEnCiAgICAgICAgICAgICMg0JLQuNC00LjQvNC+0YHRgtGMINC60L3QvtC/0L7QuiAnPCcgJz4nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX25leHRfZ29vZCddID0gc2hvd19oaWRlCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX3ByZXZpb3VzX2dvb2QnXSA9IHNob3dfaGlkZQoKICAgICAgICAgICAgZG9jX3Bvc2l0aW9uID0gc2VsZi5fZmluZF9tYXRjaGluZ19nb29kKGRvY19kYXRhLCBjdXJyZW50X2VsZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9lbGVtWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbVsnaWRfdW5pdCddKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBkb2NfZGF0YSwgdG9fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3Jvd3MnLCBkb2Nfcm93cykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfZGF0YScsIGN1cnJlbnRfZWxlbSwgdG9fanNvbj1UcnVlKQoKICAgICAgICAgICAgaWYgZG9jX3Bvc2l0aW9uOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfcG9zaXRpb24nLCBzdHIoZG9jX3Bvc2l0aW9uKSkKICAgICAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKCdpbmRleCcsIGluZGV4PWRvY19wb3NpdGlvbikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3dhc19jbGlja2VkJywgJy0xJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fbmV4dF9nb29kJzoKICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoIm5leHQiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9wcmV2aW91c19nb29kJzoKICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoInByZXZpb3VzIikKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIGdldF9kb2Moc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2N1cnJlbnRfZWxlbShzZWxmKToKICAgICAgICBzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJykpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQogICAgICAgIGN1cnJlbnRfZWxlbSA9IHRhYmxlX2RhdGFbc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbl0KICAgICAgICBjdXJyZW50X2VsZW1bJ2tleSddID0gY3VycmVudF9lbGVtLmdldCgnaWQnKQogICAgICAgIHJldHVybiBjdXJyZW50X2VsZW0KCiAgICBkZWYgX2dvb2RzX3NlbGVjdG9yKHNlbGYsIGFjdGlvbiwgaW5kZXggPSBOb25lKToKICAgICAgICAKICAgICAgICBnbG9iYWxfcG9zaXRpb24gPSBpbmRleCBpZiBpbmRleCBlbHNlIGludChzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQoKICAgICAgICBkb2Nfcm93cyA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnZG9jX3Jvd3MnKSkKICAgICAgICBkb2NfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQoKICAgICAgICBpZiBpbmRleCBpcyBOb25lOgogICAgICAgICAgICAjINC/0LXRgNC10LQg0L/QtdGA0LXQu9C40YHRgtGL0LLQsNC90LjQtdC8INGB0L7RhdGA0LDQvdC40Lwg0LTQtdC70YzRgtGDINC4INC+0LHQvdC+0LLQuNC8INC60L7Quy3QstC+INCyINGB0LvQvtCy0LDRgNC1CiAgICAgICAgICAgIHNlbGYuX3NhdmVfbmV3X2RlbHRhKCkKICAgICAgICAgICAgZG9jX2RhdGFbZ2xvYmFsX3Bvc2l0aW9uXVsnZF9xdHR5J10gPSBzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpCiAgICAgICAgICAgIGRvY19kYXRhW2dsb2JhbF9wb3NpdGlvbl1bJ25ld19xdHR5J10gPSBzZWxmLmhhc2hfbWFwLmdldCgnbmV3X3F0dHknKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBkb2NfZGF0YSwgdG9fanNvbj1UcnVlKQoKICAgICAgICBpZiBhY3Rpb24gPT0gJ25leHQnOgogICAgICAgICAgICBwb3MgPSBnbG9iYWxfcG9zaXRpb24gKyAxIGlmIGdsb2JhbF9wb3NpdGlvbiA8IGRvY19yb3dzIGVsc2UgMQogICAgICAgIGVsaWYgYWN0aW9uID09ICdwcmV2aW91cyc6CiAgICAgICAgICAgIHBvcyA9IGdsb2JhbF9wb3NpdGlvbiAtIDEgaWYgZ2xvYmFsX3Bvc2l0aW9uID4gMSBlbHNlIGRvY19yb3dzCiAgICAgICAgZWxpZiBhY3Rpb24gPT0gJ2luZGV4JyBhbmQgaW5kZXg6CiAgICAgICAgICAgIHBvcyA9IGluZGV4CgogICAgICAgIGN1cnJlbnRfc3RyID0gcG9zCiAgICAgICAgY3VycmVudF9lbGVtID0gZG9jX2RhdGFbcG9zXQoKICAgICAgICAjINGC0LXQutGD0YnQuNC5INGN0LvQtdC80LXQvdGCINC90LUg0L3QsNC50LTQtdC9INC40LvQuCDRjdGC0L4g0LfQsNCz0L7Qu9C+0LLQvtC6INGC0LDQsdC70LjRhtGLCiAgICAgICAgaWYgY3VycmVudF9lbGVtIGlzIE5vbmUgb3IgJ2dvb2RfbmFtZScgbm90IGluIGN1cnJlbnRfZWxlbToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHRpdGxlID0gJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoc2VsZi5oYXNoX21hcFsnZG9jX3R5cGUnXSwgc2VsZi5oYXNoX21hcFsnZG9jX24nXSwgc2VsZi5oYXNoX21hcFsnZG9jX2RhdGUnXSkKCiAgICAgICAgcXR0eSA9IGN1cnJlbnRfZWxlbVsnZF9xdHR5J10KICAgICAgICBxdHR5ID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KHNlbGYuX2dldF9mbG9hdF92YWx1ZShzdHIocXR0eSkpKQogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnRG9jX2RhdGEnOiB0aXRsZSwKICAgICAgICAgICAgJ0dvb2QnOiBjdXJyZW50X2VsZW1bJ2dvb2RfbmFtZSddLAogICAgICAgICAgICAnaWRfZ29vZCc6IGN1cnJlbnRfZWxlbVsnaWRfZ29vZCddLAogICAgICAgICAgICAnaWRfdW5pdCc6IGN1cnJlbnRfZWxlbVsnaWRfdW5pdCddLAogICAgICAgICAgICAnaWRfcHJvcGVydHknOiBjdXJyZW50X2VsZW1bJ2lkX3Byb3BlcnRpZXMnXSwKICAgICAgICAgICAgJ2dvb2RfYXJ0JzogY3VycmVudF9lbGVtWydhcnQnXSwKICAgICAgICAgICAgJ2dvb2Rfc24nOiBjdXJyZW50X2VsZW1bJ3Nlcmllc19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3Byb3BlcnR5JzogY3VycmVudF9lbGVtWydwcm9wZXJ0aWVzX25hbWUnXSwKICAgICAgICAgICAgJ2dvb2RfcHJpY2UnOiBjdXJyZW50X2VsZW1bJ3ByaWNlJ10gaWYgJ3ByaWNlJyBpbiBjdXJyZW50X2VsZW0gZWxzZSAnJywKICAgICAgICAgICAgJ2dvb2RfdW5pdCc6IGN1cnJlbnRfZWxlbVsndW5pdHNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9zdHInOiBmJ3tjdXJyZW50X3N0cn0gLyB7ZG9jX3Jvd3N9JywKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddKSBpZiBjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddIGVsc2UgMCwKICAgICAgICAgICAgJ2dvb2RfcGxhbic6IGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICdrZXknOiBjdXJyZW50X2VsZW1bJ2lkJ10sCiAgICAgICAgICAgICdwcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSBpZiAncHJpY2UnIGluIGN1cnJlbnRfZWxlbSBlbHNlICcnLAogICAgICAgICAgICAncHJpY2VfdHlwZSc6IGN1cnJlbnRfZWxlbVsncHJpY2VfbmFtZSddIGlmICdwcmljZV9uYW1lJyBpbiBjdXJyZW50X2VsZW0gZWxzZSAnJywKICAgICAgICAgICAgJ3F0dHknOiBxdHR5LAogICAgICAgICAgICAnbmV3X3F0dHknOiBxdHR5LAogICAgICAgICAgICAndXNlX3Nlcmllcyc6IGN1cnJlbnRfZWxlbVsndXNlX3NlcmllcyddCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9maWxsX25vbmVfdmFsdWVzKAogICAgICAgICAgICBwdXRfZGF0YSwKICAgICAgICAgICAgKCdnb29kX2FydCcsICdnb29kX3NuJywgJ2dvb2RfcHJvcGVydHknLCAnZ29vZF9wcmljZScsICdnb29kX3BsYW4nLCAncHJpY2UnLCAncHJpY2VfdHlwZScpLAogICAgICAgICAgICBkZWZhdWx0PSfQvtGC0YHRg9GC0YHRgtCy0YPQtdGCJykKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkdvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfcG9zaXRpb24iLCBjdXJyZW50X3N0cikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQogICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQoKICAgIGRlZiBfaGFuZGxlX2ZvdW5kX2JhcmNvZGUoc2VsZiwgcmVzLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgaWRfZ29vZF9iciwgaWRfcHJvcGVydHlfYnIsIGlkX3VuaXRfYnIsIHJhdGlvID0gcmVzWydpZF9nb29kJ10sIHJlc1snaWRfcHJvcGVydHknXSwgcmVzWydpZF91bml0J10sIGludChyZXNbJ3JhdGlvJ10pCgogICAgICAgIGlmIGlkX2dvb2QgPT0gaWRfZ29vZF9iciBhbmQgaWRfcHJvcGVydHkgPT0gaWRfcHJvcGVydHlfYnIgYW5kIGlkX3VuaXQgPT0gaWRfdW5pdF9icjoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmF0aW8pCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIGlmIGlkX2dvb2QgIT0gaWRfZ29vZF9icjoKICAgICAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9kb2NfZGF0YScsIGZyb21fanNvbj1UcnVlKQogICAgICAgICAgICBtYXRjaF9pbmRleCA9IHNlbGYuX2ZpbmRfbWF0Y2hpbmdfZ29vZCh0YWJsZV9kYXRhLCBpZF9nb29kX2JyLCBpZF9wcm9wZXJ0eV9iciwgaWRfdW5pdF9icikKCiAgICAgICAgICAgIGlmIG1hdGNoX2luZGV4IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgIyDRgdC+0YXRgNCw0L3QuNC8INC00LDQvdC90YvQtSDQuCDQvtCx0L3QvtCy0LjQvCDRgdC70L7QstCw0YDRjCDQv9C10YDQtdC0INC/0LXRgNC10YXQvtC00L7QvCDQvdCwINC90L7QstGD0Y4g0L/QvtC30LjRhtC40Y4KICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfbmV3X2RlbHRhKCkKICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hfcXR0eV9pbl90YWJsZSh0YWJsZV9kYXRhKQogICAgICAgICAgICAgICAgc2VsZi5fZ29vZHNfc2VsZWN0b3IoImluZGV4IiwgaW5kZXg9bWF0Y2hfaW5kZXgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgndXNlX3NlcmllcycpID09ICIxIjoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyYXRpbykKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfcmVmcmVzaF9xdHR5X2luX3RhYmxlKHNlbGYsIHRhYmxlX2RhdGEpOgogICAgICAgIGluZGV4ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJykpCiAgICAgICAgdGFibGVfZGF0YVtpbmRleF1bJ2RfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKQogICAgICAgIHRhYmxlX2RhdGFbaW5kZXhdWyduZXdfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ25ld19xdHR5JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCB0YWJsZV9kYXRhLCB0b19qc29uPVRydWUpCgpjbGFzcyBBZHJHb29kc1NlbGVjdFNjcmVlbihCYXNlR29vZFNlbGVjdCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGAINCy0YvQsdC+0YAnCiAgICBwcm9jZXNzX25hbWUgPSAn0JDQtNGA0LXRgdC90L7QtSDRhdGA0LDQvdC10L3QuNC1JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICBzZWxmLnNlcnZpY2UgPSBBZHJEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXSwKICAgICAgICAgICAgJ2RvY190aXRsZSc6IHNlbGYuaGFzaF9tYXBbJ2RvY190aXRsZSddLAogICAgICAgICAgICAnaXRlbV9uYW1lJzogc2VsZi5oYXNoX21hcFsnaXRlbV9uYW1lJ10sCiAgICAgICAgICAgICdrZXknOiBzZWxmLmhhc2hfbWFwWydrZXknXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBzZWxmLmhhc2hfbWFwWydpZF91bml0J10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6IHNlbGYuaGFzaF9tYXBbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICdxdHR5Jzogc2VsZi5oYXNoX21hcFsncXR0eSddLAogICAgICAgICAgICAncXR0eV9wbGFuJzogc2VsZi5oYXNoX21hcFsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICd3YXJlaG91c2UnOiBzZWxmLmhhc2hfbWFwWyd3YXJlaG91c2UnXQogICAgICAgIH0KCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHkoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX3Nlcmllc19zaG93JzogbGFtYmRhOiBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5zY3JlZW5fdmFsdWVzWydrZXknXSksCiAgICAgICAgICAgICdidG5fZG9jX2dvb2RfYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fb3Blbl9iYXJjb2RlX3JlZ2lzdGVyX3NjcmVlbigpLAogICAgICAgICAgICAnYnRuX3ByaW50JzogbGFtYmRhOiBzZWxmLl9wcmludF90aWNrZXQoKQogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eShzZWxmKToKICAgICAgICBhbGxvd19mYWN0X2lucHV0ID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKSBvciBGYWxzZQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9pbnB1dCIsICcxJyBpZiBhbGxvd19mYWN0X2lucHV0IGVsc2UgJy0xJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfbm90ZSIsICctMScgaWYgYWxsb3dfZmFjdF9pbnB1dCBlbHNlICcxJykKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNjcmVlbiA9IEFkckRvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMScKICAgICAgICB9CgogICAgICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIFNlcmllc1NlbGVjdFNjcmVlbiwKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcz1zY3JlZW5fdmFsdWVzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5zaG93X3Byb2Nlc3NfcmVzdWx0KCkKCiAgICBkZWYgX29wZW5fYmFyY29kZV9yZWdpc3Rlcl9zY3JlZW4oc2VsZik6CiAgICAgICAgaW5pdF9kYXRhID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2lkJyksCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICcnLAogICAgICAgICAgICAndW5pdF9pZCc6ICcnCiAgICAgICAgfQogICAgICAgIEJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvd19wcm9jZXNzX3Jlc3VsdChpbml0X2RhdGEpCiAgICAKICAgIGRlZiBfcHJpbnRfdGlja2V0KHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpLmdldF9iYXJjb2RlX2Zyb21fZG9jX3RhYmxlKHNlbGYuaGFzaF9tYXAuZ2V0KCdrZXknKSkKCiAgICAgICAgZGF0YSA9IHsn0JTQsNGC0LBf0LTQvtC6JzogJ0RvY19kYXRhJywgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6ICdHb29kJywKICAgICAgICAgICAgICAgICfQkNGA0YLQuNC60YPQuyc6ICdnb29kX2FydCcsICfQodC10YDQuNC50L3Ri9C5INC90L7QvNC10YAnOiAnZ29vZF9zbicsCiAgICAgICAgICAgICAgICAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6ICdnb29kX3Byb3BlcnR5JywgJ9Cm0LXQvdCwJzogJ2dvb2RfcHJpY2UnLAogICAgICAgICAgICAgICAgJ9CV0LTQmNC30LwnOiAnZ29vZF91bml0JywgJ9Ca0LvRjtGHJzogJ2tleScsICfQktCw0LvRjtGC0LAnOiAncHJpY2VfdHlwZSd9CiAgICAgICAgZm9yIGtleSBpbiBkYXRhOgogICAgICAgICAgICBkYXRhW2tleV0gPSBzZWxmLmhhc2hfbWFwLmdldChkYXRhW2tleV0pCiAgICAgICAgZGF0YVsnYmFyY29kZSddID0gYmFyY29kZSBpZiBiYXJjb2RlIGVsc2UgJzAwMDAwMDAwMDAwMDAnCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgZGVmIF91cGRhdGVfZG9jX3RhYmxlX3JvdyhzZWxmLCBkYXRhOiBEaWN0LCByb3dfaWQpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHVwZGF0ZV9kYXRhID0gewogICAgICAgICAgICAnc2VudCc6IDAsCiAgICAgICAgICAgICdxdHR5JzogZmxvYXQoZGF0YVsncXR0eSddKSwKICAgICAgICB9CgogICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZG9jX3RhYmxlX3JvdyhkYXRhPXVwZGF0ZV9kYXRhLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpKQoKCmNsYXNzIEdyb3VwU2Nhbkl0ZW1TY3JlZW4oQmFzZUdvb2RTZWxlY3QpOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgCDQstGL0LHQvtGAJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF9zeW5jX2RvYycsICcnKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkKToKICAgICAgICAKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RlbHRhJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ3NlbnQnOiAwLAogICAgICAgICAgICAnZF9xdHR5JzogZGF0YVsncXR0eSddLAogICAgICAgIH0KICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXJvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSkKCgpjbGFzcyBCYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICdCYXJjb2RlUmVnaXN0cmF0aW9uJwogICAgcHJvY2Vzc19uYW1lID0gJ0JhcmNvZGVSZWdpc3RyYXRpb24nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gQmFyY29kZVNlcnZpY2UoKQogICAgICAgIHNlbGYuZ29vZHNfc2VydmljZSA9IEdvb2RzU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXBbJ2l0ZW1faWQnXSwKICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogc2VsZi5oYXNoX21hcFsncHJvcGVydHlfaWQnXSBvciAnJywKICAgICAgICAgICAgJ3VuaXRfaWQnOiBzZWxmLmhhc2hfbWFwWyd1bml0X2lkJ10gb3IgJycsCiAgICAgICAgfQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSBzZWxmLmdvb2RzX3NlcnZpY2UuZ2V0X2l0ZW1fZGF0YV9ieV9jb25kaXRpb24oKipzZWxmLnNjcmVlbl92YWx1ZXMpCiAgICAgICAgaWYgaW5pdF9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RfbmFtZV9iYXJjb2RlJ10gPSBpbml0X2RhdGFbJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9IGluaXRfZGF0YVsncHJvcGVydHknXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gaW5pdF9kYXRhWyd1bml0J10KCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdF9pZCddID0gc2VsZi5zY3JlZW5fdmFsdWVzWydwcm9wZXJ0eV9pZCddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0X2lkJ10gPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3VuaXRfaWQnXQoKICAgICAgICAgICAgc2VsZi5fZmlsbF9iYXJjb2Rlc190YWJsZShzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3QnOiBzZWxmLl9zZWxlY3RfaXRlbSwKICAgICAgICAgICAgJ3VuaXRfc2VsZWN0Jzogc2VsZi5fc2VsZWN0X2l0ZW0sCiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3Rfc3VjY2Vzcyc6IGxhbWJkYSA6IHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgncHJvcGVydHlfc2VsZWN0JyksCiAgICAgICAgICAgICd1bml0X3NlbGVjdF9zdWNjZXNzJzogbGFtYmRhIDogc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCd1bml0X3NlbGVjdCcpLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCwKICAgICAgICAgICAgJ2J0bl9vayc6IHNlbGYuX2hhbmRsZV9vaywKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2ZpbmlzaF9wcm9jZXNzLAogICAgICAgICAgICAnQkFDS19CVVRUT04nOiBzZWxmLl9maW5pc2hfcHJvY2VzcywKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9zZWxlY3RfaXRlbShzZWxmKToKICAgICAgICBpdGVtX3RhYmxlcyA9IHsKICAgICAgICAgICAgJ3Byb3BlcnR5X3NlbGVjdCc6ICdSU19wcm9wZXJ0aWVzJywKICAgICAgICAgICAgJ3VuaXRfc2VsZWN0JzogJ1JTX3VuaXRzJywKICAgICAgICB9CgogICAgICAgIGl0ZW1fdHlwZSA9IHNlbGYubGlzdGVuZXIKICAgICAgICBzZWxmLmhhc2hfbWFwWyd0YWJsZV9uYW1lJ10gPSBpdGVtX3RhYmxlc1tpdGVtX3R5cGVdCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmVzdWx0X2xpc3RlbmVyJ10gPSBmJ3tpdGVtX3R5cGV9X3N1Y2Nlc3MnCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3ZhbHVlX2tleSddID0gJ3NlbGVjdGVkX2NhcmQnCiAgICAgICAgc2VsZi5oYXNoX21hcFsndGl0bGUnXSA9ICfQktGL0LHQvtGAINC30L3QsNGH0LXQvdC40Y8nCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ZpZWxkcycsIFsnbmFtZSddLCB0b19qc29uPVRydWUpCiAgICAgICAgU2VsZWN0SXRlbVNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93KCkKCiAgICBkZWYgX3NlbGVjdF9pdGVtX3Jlc3VsdChzZWxmLCBmaWVsZF9uYW1lKToKICAgICAgICBzZWxlY3RlZF9jYXJkID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgaWYgc2VsZWN0ZWRfY2FyZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9IHNlbGVjdGVkX2NhcmQuZ2V0KCduYW1lJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmJ3tmaWVsZF9uYW1lfV9pZCddID0gc2VsZWN0ZWRfY2FyZC5nZXQoJ2lkJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW2ZpZWxkX25hbWVdID0gJycKCiAgICBkZWYgX2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBzY2FubmVkX2JhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgiYmFyY29kZSIpCiAgICAgICAgc2VsZi5fY2hlY2tfYmFyY29kZShzY2FubmVkX2JhcmNvZGUpCgogICAgZGVmIF9oYW5kbGVfb2soc2VsZik6CiAgICAgICAgc2Nhbm5lZF9iYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoInNjYW5uZWRfYmFyY29kZSIpCiAgICAgICAgaWYgbm90IHNjYW5uZWRfYmFyY29kZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgi0KjRgtGA0LjRhdC60L7QtCDQvdC1INC+0YLRgdC60LDQvdC40YDQvtCy0LDQvSIpCiAgICAgICAgZWxpZiBzZWxmLl9jaGVja19iYXJjb2RlKHNjYW5uZWRfYmFyY29kZSk6CiAgICAgICAgICAgIGl0ZW1faWQgPSBzZWxmLmhhc2hfbWFwLmdldCgiaXRlbV9pZCIpCiAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICJpZF9nb29kIjogaXRlbV9pZCwKICAgICAgICAgICAgICAgICJiYXJjb2RlIjogc2Nhbm5lZF9iYXJjb2RlLAogICAgICAgICAgICAgICAgImlkX3Byb3BlcnR5Ijogc2VsZi5oYXNoX21hcC5nZXQoInByb3BlcnR5X3NlbGVjdF9pZCIpIG9yICcnLAogICAgICAgICAgICAgICAgImlkX3VuaXQiOiBzZWxmLmhhc2hfbWFwLmdldCgidW5pdF9zZWxlY3RfaWQiKSBvciAnJywKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VsZi5fc2F2ZV9iYXJjb2RlKGJhcmNvZGVfZGF0YSkKICAgICAgICAgICAgc2VsZi5fZmlsbF9iYXJjb2Rlc190YWJsZShpdGVtX2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX3NhdmVfYmFyY29kZShzZWxmLCBiYXJjb2RlX2RhdGEpOgogICAgICAgIHNlbGYuc2VydmljZS5hZGRfYmFyY29kZShiYXJjb2RlX2RhdGEpCgogICAgICAgIGJ1ZmZlciA9IEV4Y2hhbmdlUXVldWVCdWZmZXIoJ2JhcmNvZGVzJykKICAgICAgICBidWZmZXIuc2F2ZV9kYXRhX3RvX3NlbmQoYmFyY29kZV9kYXRhLCBwaz0nYmFyY29kZScpCgogICAgZGVmIF9jaGVja19iYXJjb2RlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuZ29vZHNfc2VydmljZS5nZXRfdmFsdWVzX2Zyb21fYmFyY29kZSgiYmFyY29kZSIsIGJhcmNvZGUpCgogICAgICAgIGlmIGJhcmNvZGVfZGF0YToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChmJ9Co0YLRgNC40YXQutC+0LQge2JhcmNvZGV9INC/0YDQuNGB0YPRgtGB0YLQstGD0LXRgiDQsiDQsdCw0LfQtSDQtNCw0L3QvdGL0YUnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9ICcnCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NjYW5uZWRfYmFyY29kZSddID0gYmFyY29kZQoKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfZmlsbF9iYXJjb2Rlc190YWJsZShzZWxmLCBpdGVtX2lkKToKICAgICAgICAjIGJhcmNvZGVzX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2JhcmNvZGVzX2J5X2dvb2RzX2lkKHNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQogICAgICAgIGJhcmNvZGVzX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2JhcmNvZGVzX2J5X2dvb2RzX2lkKGl0ZW1faWQpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShiYXJjb2Rlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2JhcmNvZGVzX2RhdGEnXSA9IHNlbGYuX2dldF9iYXJjb2Rlc190YWJsZV92aWV3KHRhYmxlX2RhdGEpLnRvX2pzb24oKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGJhcmNvZGVzX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCgogICAgICAgIGZvciByb3cgaW4gYmFyY29kZXNfZGF0YToKICAgICAgICAgICAgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVzX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KjRgtGA0LjRhdC60L7QtCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KPQv9Cw0LrQvtCy0LrQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGJhcmNvZGUnKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdW5pdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnLAogICAgICAgICAgICBTdHJva2VXaWR0aCA9IDEKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3NfcmVzdWx0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kcyBzZWxlY3QgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHMoUHJvY2VzcykgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEdvb2RzTGlzdFNjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgNGLINGB0L/QuNGB0L7QuicKICAgIHByb2Nlc3NfbmFtZSA9ICfQotC+0LLQsNGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBjYXJkc19kYXRhID0gc2VsZi5fZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfZ29vZHNfdHlwZScpKQogICAgICAgIGdvb2RzX2NhcmRzID0gc2VsZi5fZ2V0X2dvb2RzX2NhcmRzX3ZpZXcoY2FyZHNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydnb29kc19jYXJkcyddID0gZ29vZHNfY2FyZHMudG9fanNvbigpCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICIiCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcyA9IHsnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J119CiAgICAgICAgICAgIEl0ZW1DYXJkKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3coYXJncz1zY3JlZW5fdmFsdWVzKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gInNlbGVjdF9nb29kc190eXBlIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JLRi9Cx0L7RgCDQutCw0YLQtdCz0L7RgNC40Lgg0YLQvtCy0LDRgNC+0LIiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJGaW5pc2hQcm9jZXNzIiwgIiIpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2lkZW50aWZ5X2JhcmNvZGVfZ29vZHMoKQoKICAgIGRlZiBfZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxmLCBzZWxlY3RlZF9nb29kX3R5cGU9Tm9uZSkgLT4gbGlzdDoKICAgICAgICByZXN1bHRzID0gc2VsZi5zZXJ2aWNlLmdldF9nb29kc19saXN0X2RhdGEoc2VsZWN0ZWRfZ29vZF90eXBlKQogICAgICAgIGNhcmRzX2RhdGEgPSBbXQogICAgICAgIGZvciByZWNvcmQgaW4gcmVzdWx0czoKICAgICAgICAgICAgc2luZ2xlX2NhcmRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdrZXknOiByZWNvcmRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnY29kZSc6IHJlY29yZFsnY29kZSddLAogICAgICAgICAgICAgICAgJ25hbWUnOiByZWNvcmRbJ25hbWUnXSwKICAgICAgICAgICAgICAgICdhcnQnOiByZWNvcmRbJ2FydCddIGlmIHJlY29yZFsnYXJ0J10gZWxzZSAi4oCUIiwKICAgICAgICAgICAgICAgICd1bml0JzogcmVjb3JkWyd1bml0J10gaWYgcmVjb3JkWyd1bml0J10gZWxzZSAi4oCUIiwKICAgICAgICAgICAgICAgICd0eXBlX2dvb2QnOiByZWNvcmRbJ3R5cGVfZ29vZCddLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogcmVjb3JkWydkZXNjcmlwdGlvbiddIGlmIHJlY29yZFsnZGVzY3JpcHRpb24nXSBlbHNlICLigJQiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FyZHNfZGF0YS5hcHBlbmQoc2luZ2xlX2NhcmRfZGF0YSkKCiAgICAgICAgcmV0dXJuIGNhcmRzX2RhdGEKCiAgICBkZWYgX2dldF9nb29kc19jYXJkc192aWV3KHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBnb29kc19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjN0EwMDVDJwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bjb2RlJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAYXJ0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdW5pdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHR5cGVfZ29vZCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGdvb2RzX2NhcmRzCgogICAgZGVmIF9pZGVudGlmeV9iYXJjb2RlX2dvb2RzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJyk6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpCiAgICAgICAgICAgIHZhbHVlcyA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2Zyb21fYmFyY29kZSgiYmFyY29kZSIsIGJhcmNvZGUpCiAgICAgICAgICAgIGlmIHZhbHVlczoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2l0ZW1faWQnXSA9IHZhbHVlc1swXVsnaWRfZ29vZCddCiAgICAgICAgICAgICAgICBJdGVtQ2FyZChzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93KCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Ci0L7QstCw0YAg0L3QtSDRgNCw0YHQv9C+0LfQvdCw0L0g0L/QviDRiNGC0YDQuNGF0LrQvtC00YMnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCgpjbGFzcyBTZWxlY3RHb29kc1R5cGUoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CS0YvQsdC+0YAg0LrQsNGC0LXQs9C+0YDQuNC4INGC0L7QstCw0YDQvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Ci0L7QstCw0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBnb29kc190eXBlc19kYXRhID0gc2VsZi5fZ2V0X2dvb2RzX3R5cGVzX2RhdGEoKQogICAgICAgIGdvb2RzX3R5cGVzX2NhcmRzID0gc2VsZi5fZ2V0X2dvb2RzX3R5cGVzX2NhcmRzX3ZpZXcoZ29vZHNfdHlwZXNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydnb29kc190eXBlc19jYXJkcyddID0gZ29vZHNfdHlwZXNfY2FyZHMudG9fanNvbigpCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICIiCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfZGF0YSIsIGZyb21fanNvbj1UcnVlKQogICAgICAgICAgICB0eXBlX2lkID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgICAgICB0eXBlX25hbWUgPSBjYXJkX2RhdGFbJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0X2dvb2RzX3R5cGUnLCB0eXBlX25hbWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9nb29kc190eXBlJywgdHlwZV9pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dTY3JlZW4iLCAi0KLQvtCy0LDRgNGLINGB0L/QuNGB0L7QuiIpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdF9nb29kc190eXBlJywgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9nb29kc190eXBlJywgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJCYWNrU2NyZWVuIiwgIiIpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2dvb2RzX3R5cGVzX2RhdGEoc2VsZik6CiAgICAgICAgZ29vZHNfdHlwZXNfZGF0YV9yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9nb29kc190eXBlc19kYXRhKCkKICAgICAgICBnb29kc190eXBlc19kYXRhID0gW10KICAgICAgICBmb3IgcmVjb3JkIGluIGdvb2RzX3R5cGVzX2RhdGFfcmVzdWx0OgogICAgICAgICAgICBzaW5nbGVfY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWQnXSwKICAgICAgICAgICAgICAgICduYW1lJzogcmVjb3JkWyduYW1lJ10sCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ29vZHNfdHlwZXNfZGF0YS5hcHBlbmQoc2luZ2xlX2NhcmRfZGF0YSkKICAgICAgICByZXR1cm4gZ29vZHNfdHlwZXNfZGF0YQoKICAgIGRlZiBfZ2V0X2dvb2RzX3R5cGVzX2NhcmRzX3ZpZXcoc2VsZiwgZ29vZHNfdHlwZXNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQoKICAgICAgICB0eXBlX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Z29vZHNfdHlwZXNfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHR5cGVfY2FyZHMKCgpjbGFzcyBJdGVtQ2FyZChTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JrQsNGA0YLQvtGH0LrQsCDRgtC+0LLQsNGA0LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0KLQvtCy0LDRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwWydpdGVtX2lkJ10sCiAgICAgICAgfQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuaW5pdF9zY3JlZW4oKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9wcmludF90aWNrZXQsCiAgICAgICAgICAgICdidG5fcHJpbnQnOiBzZWxmLl9wcmludF90aWNrZXQsCiAgICAgICAgICAgICd0b19wcmljZXMnOiBzZWxmLl90b19wcmljZXMsCiAgICAgICAgICAgICd0b19iYWxhbmNlcyc6IHNlbGYuX3RvX2JhbGFuY2VzLAogICAgICAgICAgICAnYnRuX2l0ZW1fZ29vZF9iYXJjb2RlJzogc2VsZi5faGFuZGxlX2JhcmNvZGVfcmVnaXN0ZXIsCgogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBpdGVtX3Byb3BlcnRpZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19mcm9tX2JhcmNvZGUoImlkX2dvb2QiLCBzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKCiAgICAgICAgaWYgaXRlbV9wcm9wZXJ0aWVzOgogICAgICAgICAgICB2YXJpYW50c19jYXJkc19kYXRhID0gc2VsZi5fZ2V0X3ZhcmlhbnRzX2NhcmRzX2RhdGEoaXRlbV9wcm9wZXJ0aWVzKQogICAgICAgICAgICB2YXJpYW50c19jYXJkcyA9IHNlbGYuX2dldF92YXJpYW50c19jYXJkc192aWV3KHZhcmlhbnRzX2NhcmRzX2RhdGEpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2JhcmNvZGVfY2FyZHMnXSA9IHZhcmlhbnRzX2NhcmRzLnRvX2pzb24oKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgibG9hZF9pbmZvIiwgIiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImxvYWRfaW5mbyIsICLQlNCw0L3QvdGL0LUg0L4g0YXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsNGFINC+0YLRgdGD0YLRgdGC0LLRg9GO0YIiKQoKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc3VwZXIoKS5pbml0X3NjcmVlbigpCgogICAgICAgIGl0ZW1fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfaXRlbV9kYXRhX2J5X2lkKGl0ZW1faWQ9c2VsZi5zY3JlZW5fdmFsdWVzWydpdGVtX2lkJ10pCiAgICAgICAgaWYgaXRlbV9kYXRhOgogICAgICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICJnb29kX25hbWUiOiBpdGVtX2RhdGFbJ25hbWUnXSwKICAgICAgICAgICAgICAgICJnb29kX2FydCI6IGl0ZW1fZGF0YVsnYXJ0J10gaWYgaXRlbV9kYXRhWydhcnQnXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgImdvb2RfY29kZSI6IGl0ZW1fZGF0YVsnY29kZSddLAogICAgICAgICAgICAgICAgImdvb2RfZGVzY3IiOiBpdGVtX2RhdGFbJ2Rlc2NyaXB0aW9uJ10gaWYgaXRlbV9kYXRhWydkZXNjcmlwdGlvbiddIGVsc2UgIuKAlCIsCiAgICAgICAgICAgICAgICAiZ29vZF90eXBlIjogaXRlbV9kYXRhWyd0eXBlX2dvb2QnXSwKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fY2xlYXJfc2NyZWVuX3ZhbHVlcygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ2JhcmNvZGVfY2FyZHMnKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5oYXNoX21hcFsncGFyZW50X3NjcmVlbiddKQoKICAgIGRlZiBfdG9fYmFsYW5jZXMoc2VsZik6CiAgICAgICAgZGljdF9kYXRhID0gewogICAgICAgICAgICAnaW5wdXRfaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2lkJyksCiAgICAgICAgICAgICdpdGVtX2FydF9pbnB1dCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX2FydCcpLAogICAgICAgICAgICAnc2VsZWN0ZWRfb2JqZWN0X25hbWUnOiBmJ3tzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9uYW1lIil9LCB7c2VsZi5oYXNoX21hcC5nZXQoImdvb2RfY29kZSIpfScsCiAgICAgICAgICAgICdvYmplY3RfbmFtZSc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgInJldHVybl90b19pdGVtX2NhcmQiOiAidHJ1ZSIsCiAgICAgICAgICAgICdTaG93UHJvY2Vzc1Jlc3VsdCc6ICfQntGB0YLQsNGC0LrQuHzQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnLAogICAgICAgICAgICAibm9SZWZyZXNoIjogJycKICAgICAgICB9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShkaWN0X2RhdGEpCgogICAgZGVmIF90b19wcmljZXMoc2VsZik6CiAgICAgICAgZGljdF9kYXRhID0gewogICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2lkJyksCiAgICAgICAgICAgICdpbnB1dF9nb29kX2FydCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX2FydCcpLAogICAgICAgICAgICAncHJpY2VzX29iamVjdF9uYW1lJzogZid7c2VsZi5oYXNoX21hcC5nZXQoImdvb2RfbmFtZSIpfSwge3NlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX2NvZGUiKX0nLAogICAgICAgICAgICAicmV0dXJuX3RvX2l0ZW1fY2FyZCI6ICJ0cnVlIiwKICAgICAgICAgICAgJ29iamVjdF9uYW1lJzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfbmFtZScpLAogICAgICAgICAgICAnU2hvd1Byb2Nlc3NSZXN1bHQnOiAn0KbQtdC90Yt80J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nLAogICAgICAgICAgICAibm9SZWZyZXNoIjogJycKICAgICAgICB9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShkaWN0X2RhdGEpCgogICAgZGVmIF9oYW5kbGVfYmFyY29kZV9yZWdpc3RlcihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSB7CiAgICAgICAgICAgICdpdGVtX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1faWQnKSwKICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogJycsCiAgICAgICAgICAgICd1bml0X2lkJzogJycKICAgICAgICB9CiAgICAgICAgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKS5zaG93X3Byb2Nlc3NfcmVzdWx0KGluaXRfZGF0YSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF92YXJpYW50c19jYXJkc19kYXRhKGl0ZW1fcHJvcGVydGllcyk6CiAgICAgICAgdmFyaWFudHNfY2FyZHNfZGF0YSA9IFtdCiAgICAgICAgZm9yIGksIGVsZW1lbnQgaW4gZW51bWVyYXRlKGl0ZW1fcHJvcGVydGllcyk6CiAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzX2RhdGEuYXBwZW5kKAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJrZXkiOiBzdHIoaSksCiAgICAgICAgICAgICAgICAgICAgImJhcmNvZGUiOiBlbGVtZW50WydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOiBlbGVtZW50Wydwcm9wZXJ0eSddIGlmIGVsZW1lbnRbJ3Byb3BlcnR5J10gZWxzZSAiIiwKICAgICAgICAgICAgICAgICAgICAidW5pdCI6IGVsZW1lbnRbJ3VuaXQnXSwKICAgICAgICAgICAgICAgICAgICAic2VyaWVzIjogZWxlbWVudFsnc2VyaWVzJ10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgIHJldHVybiB2YXJpYW50c19jYXJkc19kYXRhCgogICAgZGVmIF9nZXRfdmFyaWFudHNfY2FyZHNfdmlldyhzZWxmLCBjYXJkc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KAogICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnKSBlbHNlIDIwCiAgICAgICAgY2FyZF90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpIGVsc2UgMTUKCiAgICAgICAgdmFyaWFudHNfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvcGVydGllcycsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BiYXJjb2RlJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc2VyaWVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0ndmVydGljYWwnLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCiAgICAgICAgcmV0dXJuIHZhcmlhbnRzX2NhcmRzCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgY3VycmVudF9jYXJkID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCgogICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICdiYXJjb2RlJzogY3VycmVudF9jYXJkLmdldCgnYmFyY29kZScsICcwMDAwMDAwMDAwMDAwJyksCiAgICAgICAgICAgICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9uYW1lJyksCiAgICAgICAgICAgICfQpdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCwJzogY3VycmVudF9jYXJkLmdldCgncHJvcGVydGllcycsICcnKSwKICAgICAgICAgICAgJ9Cj0L/QsNC60L7QstC60LAnOiBjdXJyZW50X2NhcmQuZ2V0KCd1bml0JywgJycpCiAgICAgICAgfQoKICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICBkZWYgX2dldF9zZWxlY3RlZF9jYXJkX2RhdGEoc2VsZikgLT4gZGljdDoKICAgICAgICByZXN1bHQgPSB7fQogICAgICAgIGNhcmRfa2V5ID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICBjYXJkcyA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImJhcmNvZGVfY2FyZHMiKQoKICAgICAgICBpZiBjYXJkX2tleSBhbmQgY2FyZHM6CiAgICAgICAgICAgIHJlc3VsdCA9IGNhcmRzWydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXVtpbnQoY2FyZF9rZXkpXQoKICAgICAgICByZXR1cm4gcmVzdWx0CgpjbGFzcyBJdGVtQ2FyZE9mZmxpbmVTY3JlZW4oSXRlbUNhcmQpOgoKICAgIGRlZiBfdG9fcHJpY2VzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ3ByaWNlc19ub3RfYXZhaWxhYmxlX21vZGFsJywgdGl0bGU9J9CSINGN0YLQvtC8INC/0YDQvtC00YPQutGC0LUg0LfQsNC/0YDQvtGBINGG0LXQvSDQvdC10LTQvtGB0YLRg9C/0LXQvScpCgogICAgZGVmIF90b19iYWxhbmNlcyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKCdiYWxhbmNlc19ub3RfYXZhaWxhYmxlX21vZGFsJywgdGl0bGU9J9CSINGN0YLQvtC8INC/0YDQvtC00YPQutGC0LUg0LfQsNC/0YDQvtGBINC+0YHRgtCw0YLQutC+0LIg0L3QtdC00L7RgdGC0YPQv9C10L0nKQoKICAgIGRlZiBfcHJpbnRfdGlja2V0KHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ3ByaW50X3RpY2tldF9ub3RfYXZhaWxhYmxlX21vZGFsJywgdGl0bGU9J9CSINGN0YLQvtC8INC/0YDQvtC00YPQutGC0LUg0L/QtdGH0LDRgtGMINC90LXQtNC+0YHRgtGD0L/QvdCwJykKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzKFByb2Nlc3MpIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNCYWxhbmNlcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgR29vZHNCYWxhbmNlc0l0ZW1DYXJkKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9GA0L7QstC10YDQuNGC0Ywg0L7RgdGC0LDRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0J7RgdGC0LDRgtC60LgnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgIHNlbGYudGFibGVfdHlwZSA9ICd3YXJlaG91c2VzJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydCgKICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgJ2Vycm9yX21zZycsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLAogICAgICAgICAgICAgICAgJ3NlbGVjdGVkX2NlbGxfbmFtZScsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfd2hfbmFtZScsCiAgICAgICAgICAgICAgICAnaXRlbV9iYXJjb2RlJwogICAgICAgICAgICBdCiAgICAgICAgKQogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnYmFsYW5jZXNfdGFibGUnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCduZXdfYXJ0Jyk6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX2l0ZW1fdmFyaWFudHMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ3doX3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF93aCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnd2hfc2VsZWN0X3N1Y2Nlc3MnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3Rfd2hfcmVzdWx0KCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdnZXRfYmFsYW5jZV9idG4nOgogICAgICAgICAgICBzZWxmLl9nZXRfYmFsYW5jZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9pZGVudGlmeV9iYXJjb2RlX2JhbGFuY2VzKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLl9yZXNldF9iYWxhbmNlc190YWJsZXMoKQogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncmV0dXJuX3RvX2l0ZW1fY2FyZCcpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25vUmVmcmVzaCcsICcnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3NSZXN1bHQiLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJGaW5pc2hQcm9jZXNzIiwgIiIpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Nob3dfZmlsdGVycyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9iYWxhbmNlc19jb250cm9scyIsICIxIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfc2hvd19maWx0ZXJzIiwgIi0xIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScsIGZyb21fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICdzZWxlY3RlZF9vYmplY3RfbmFtZSc6IGYie2NhcmRfZGF0YVsnbmFtZSddfSwge2NhcmRfZGF0YVsnY29kZSddfSIsCiAgICAgICAgICAgICAgICAgICAgImlucHV0X2l0ZW1faWQiOiBjYXJkX2RhdGFbJ2lkJ10sICdpdGVtX2NvZGUnOiBjYXJkX2RhdGFbJ2NvZGUnXSwKICAgICAgICAgICAgICAgICAgICAndmFyaWFudF9zZWxlY3RlZCc6IFRydWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnbmV3X2FydCcpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9CS0YvQsdC10YDQuNGC0LUg0LLQsNGA0LjQsNC90YIg0YLQvtCy0LDRgNCwOicpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfYmFsYW5jZXNfY29udHJvbHMiLCAiMSIpCgogICAgZGVmIF9nZXRfYmFsYW5jZXMoc2VsZik6CiAgICAgICAgaWYgKHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpICE9IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX2FydCcpCiAgICAgICAgICAgIGFuZCBub3Qgc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgndmFyaWFudF9zZWxlY3RlZCcpKToKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfYXJ0JywgVHJ1ZSkKICAgICAgICAgICAgc2VsZi52YWxpZGF0ZV9pbnB1dCgpCgogICAgICAgIHJhd19iYWxhbmNlc19kYXRhID0gc2VsZi5fZ2V0X2JhbGFuY2VzX2RhdGEoKQogICAgICAgIGJhbGFuY2VzX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEocmF3X2JhbGFuY2VzX2RhdGEpCiAgICAgICAgYmFsYW5jZXNfdGFibGUgPSBzZWxmLl9nZXRfYmFsYW5jZXNfdGFibGVfdmlldyhiYWxhbmNlc19kYXRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHsKICAgICAgICAgICAgICAgICdiYWxhbmNlc190YWJsZSc6IGJhbGFuY2VzX3RhYmxlLnRvX2pzb24oKSwKICAgICAgICAgICAgICAgICdTaG93X2dldF9iYWxhbmNlc19jb250cm9scyc6ICctMScsCiAgICAgICAgICAgICAgICAnU2hvd19zaG93X2ZpbHRlcnMnOiAnMScsCiAgICAgICAgICAgICAgICAncHJvcGVydHlfaWQnOiAnJywKICAgICAgICAgICAgICAgICdmcm9tX2JhcmNvZGUnOiBGYWxzZSwKICAgICAgICAgICAgICAgICdpdGVtX2NvZGUnOiAnJywKICAgICAgICAgICAgICAgICd2YXJpYW50X3NlbGVjdGVkJzogRmFsc2UKICAgICAgICAgICAgfSkKCiAgICBkZWYgX3NlbGVjdF93aChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwWyd0YWJsZV9uYW1lJ10gPSAnUlNfd2FyZWhvdXNlcycKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXN1bHRfbGlzdGVuZXInXSA9ICd3aF9zZWxlY3Rfc3VjY2VzcycKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fdmFsdWVfa2V5J10gPSAnc2VsZWN0ZWRfY2FyZCcKICAgICAgICBzZWxmLmhhc2hfbWFwWyd0aXRsZSddID0gJ9CS0YvQsdC10YDQuNGC0LUg0YHQutC70LDQtCcKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZmllbGRzJywgWyduYW1lJ10sIHRvX2pzb249VHJ1ZSkKICAgICAgICBTZWxlY3RJdGVtU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X3doX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxlY3RlZF93aCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX3doOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd3aF9zZWxlY3QnXSA9IHNlbGVjdGVkX3doLmdldCgnbmFtZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnd2hfc2VsZWN0J10gPSAnJwoKICAgIGRlZiB2YWxpZGF0ZV9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KCkKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2NlbGwoKQoKICAgICAgICBpZiBub3QgKHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0Jykgb3Igc2VsZi5oYXNoX21hcC5nZXQoJ3doX3NlbGVjdCcpCiAgICAgICAgICAgICAgICBvciBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2VsbF9pZCcpKToKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoewogICAgICAgICAgICAgICAgICAgICdiYWxhbmNlc190YWJsZXMnOiAnJywKICAgICAgICAgICAgICAgICAgICAnb2JqZWN0X25hbWUnOiAnJywKICAgICAgICAgICAgICAgICAgICAnY2VsbF9uYW1lJzogJycsCiAgICAgICAgICAgICAgICAgICAgJ2Vycm9yX21zZyc6ICLQlNC+0LvQttC10L0g0LHRi9GC0Ywg0LLRi9Cx0YDQsNC9INGB0LrQu9Cw0LQsINGC0L7QstCw0YAg0LjQu9C4INGP0YfQtdC50LrQsCIKICAgICAgICAgICAgICAgIH0pCgogICAgZGVmIF9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0Jyk6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICdvYmplY3RfbmFtZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnbmFtZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnaW5wdXRfaXRlbV9pZCc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZid7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJuYW1lIl19LCB7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJjb2RlIl19JywKICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW1fY29kZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtX2FydF9pbnB1dCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpLAogICAgICAgICAgICAgICAgICAgICAgICAnaXRlbV9iYXJjb2RlJzogJycKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQgIT0gJ+KAlCcgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsIGYiINCi0L7QstCw0YAg0YEg0LDRgNGC0LjQutGD0LvQvtC8ICd7aXRlbV9hcnRfaW5wdXR9JyAg0L3QtSDQvdCw0LnQtNC10L0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9pdGVtX2lkJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCAnJykKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfY2VsbChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnY2VsbF9pbnB1dCcpOgogICAgICAgICAgICBjZWxsX3ZhbHVlc19yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX2NlbGxzJywKICAgICAgICAgICAgICAgIGZpZWxkPSduYW1lJywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0JykKICAgICAgICAgICAgKQoKICAgICAgICAgICAgaWYgY2VsbF92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi50YWJsZV90eXBlID0gJ2NlbGxzJwogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCBjZWxsX3ZhbHVlc19yZXN1bHRbMF1bJ2lkJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2VsbF9uYW1lJywgc2VsZi5oYXNoX21hcC5nZXQoJ2NlbGxfaW5wdXQnKSkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjdXJyZW50X2Vycm9yID0gZiJ7c2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ119XG4iIGlmIHNlbGYuaGFzaF9tYXBbJ2Vycm9yX21zZyddIGVsc2UgJycKICAgICAgICAgICAgICAgIGVycm9yX3RleHQgPSAne33Qr9GH0LXQudC60LAgYyDQuNC80LXQvdC10Lwge30g0L3QtSDQvdCw0LnQtNC10L3QsCcuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZXJyb3IsIHNlbGYuaGFzaF9tYXBbJ2NlbGxfaW5wdXQnXQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ10gPSBlcnJvcl90ZXh0CiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgJycpCgogICAgZGVmIF9pZGVudGlmeV9iYXJjb2RlX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIG5vX2RhdGEgPSBGYWxzZQogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19iYXJjb2RlcyIsCiAgICAgICAgICAgIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKQogICAgICAgICkKCiAgICAgICAgaWYgYmFyY29kZV9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKSkKCiAgICAgICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5Jyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJvcGVydHlfaWQnLCBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9wcm9wZXJ0eScpKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfZ29vZCcpOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IGJhcmNvZGVfZGF0YVswXVsnaWRfZ29vZCddCgogICAgICAgICAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfZ29vZHMiLAogICAgICAgICAgICAgICAgICAgIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9aXRlbV9pZAogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGlmIGl0ZW1fZGF0YVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfaXRlbV9pZCcsIGl0ZW1faWQpCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdWydhcnQnXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2l0ZW1fYXJ0X2lucHV0JywgaXRlbV9kYXRhWzBdWydhcnQnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9hcnRfaW5wdXQnLCAn4oCUJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCBmJ3tpdGVtX2RhdGFbMF1bIm5hbWUiXX0sICB7aXRlbV9kYXRhWzBdWyJjb2RlIl19JykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdmcm9tX2JhcmNvZGUnLCBUcnVlKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgJycpCiAgICAgICAgICAgIGNlbGxfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfY2VsbHMiLCBmaWVsZD0nYmFyY29kZScsCiAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGNlbGxfZGF0YToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgY2VsbF9kYXRhWzBdWydpZCddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsIGNlbGxfZGF0YVswXVsnbmFtZSddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfaW5wdXQnLCBjZWxsX2RhdGFbMF1bJ25hbWUnXSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5vX2RhdGEgPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAi0KjRgtGA0LjRhdC60L7QtCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSIpCiAgICAgICAgaWYgbm90IG5vX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2dldF9iYWxhbmNlcygpCgogICAgZGVmIF9yZXNldF9iYWxhbmNlc190YWJsZXMoc2VsZik6CiAgICAgICAgdmFyc19saXN0ID0gWyd3aF9zZWxlY3QnLCAnaW5wdXRfaXRlbV9pZCcsICdjZWxsX2lucHV0JywgJ2NlbGxfbmFtZScsICdvYmplY3RfbmFtZScsICdlcnJvcl9tc2cnLAogICAgICAgICAgICAgICAgICAgICAnYmFsYW5jZXNfdGFibGUnLCAnYmFyY29kZScsICdzZWxlY3RlZF9jZWxsX2lkJywgJ3Byb3BlcnR5X2lkJywgJ3NlbGVjdGVkX29iamVjdF9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3doX2lkJywgJ2l0ZW1fYmFyY29kZScsICdzZWxlY3RlZF93aF9uYW1lJywgJ3NlbGVjdGVkX2NlbGxfbmFtZSddCiAgICAgICAgZGljdF9kYXRhID0ge3ZhcjogIiIgZm9yIHZhciBpbiB2YXJzX2xpc3R9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShkaWN0X2RhdGEpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydChzZWxmLCBlbGVtZW50cyk6CiAgICAgICAgZm9yIHYgaW4gZWxlbWVudHM6CiAgICAgICAgICAgIG5hbWUgPSBmJ1Nob3dfe3Z9JwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW25hbWVdID0gJzEnIGlmIHNlbGYuaGFzaF9tYXBbdl0gZWxzZSAnLTEnCgogICAgZGVmIF9nZXRfYmFsYW5jZXNfZGF0YShzZWxmKToKICAgICAgICBkYXRhID0gc2VsZi5oc19zZXJ2aWNlLmdldF9iYWxhbmNlc19nb29kcygKICAgICAgICAgICAgaWRfZ29vZD1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfaXRlbV9pZCcpLAogICAgICAgICAgICBpZF9jZWxsPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jZWxsX2lkJyksCiAgICAgICAgICAgIGlkX3dhcmVob3VzZT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfd2hfaWQnKQogICAgICAgICkuZGF0YQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIHJhd19iYWxhbmNlc19kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIGZvciBlbCBpbiByYXdfYmFsYW5jZXNfZGF0YToKICAgICAgICAgICAgc3RvcmFnZV9uYW1lID0gc3RyKGVsWyduYW1lX3dhcmVob3VzZSddKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc3RyKGVsWyduYW1lX2NlbGwnXSkKCiAgICAgICAgICAgIGl0ZW1fbGF5b3V0ID0gc2VsZi5fZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoewogICAgICAgICAgICAgICAgJ3N0b3JhZ2VfbmFtZV9sZW4nOiBsZW4oc3RvcmFnZV9uYW1lKSwKICAgICAgICAgICAgICAgICdpdGVtX25hbWVfbGVuJzogbGVuKGVsWyduYW1lX2dvb2QnXSkKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIHRhYmxlX3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIoZWxbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaXRlbV9uYW1lJzogc3RyKGVsWyduYW1lX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnc3RvcmFnZV9uYW1lJzogc3RvcmFnZV9uYW1lLAogICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIoZWxbJ3F0dHknXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllcyc6IHN0cihlbFsnbmFtZV9wcm9wZXJ0eSddIG9yICfigJQnKSwKICAgICAgICAgICAgICAgICdfbGF5b3V0JzogaXRlbV9sYXlvdXQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfaWQnKSA9PSBzdHIoZWxbJ2lkX3Byb3BlcnR5J10pOgogICAgICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9iYWxhbmNlc190YWJsZV92aWV3KHNlbGYsIGRhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0LrQu9Cw0LQnKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC+0LLQsNGAJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQmtC+0LvQuNGH0LXRgdGC0LLQvicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQuCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnCiAgICAgICAgICAgICksCgogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT1kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoc2VsZiwgcm93X2RhdGEpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHN0b3JhZ2VfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcKCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JyBpZiByb3dfZGF0YVsnc3RvcmFnZV9uYW1lX2xlbiddIDwgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSBlbHNlICd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGl0ZW1fbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcgaWYgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSA8IHJvd19kYXRhWydzdG9yYWdlX25hbWVfbGVuJ10gZWxzZSAnd3JhcF9jb250ZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByb3BlcnRpZXMnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRjBGOEZGJywKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfY2hlY2tfaXRlbV92YXJpYW50cyhzZWxmKToKICAgICAgICBpdGVtX2FydF9pbnB1dCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpCiAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQ6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGl0ZW1fdmFsdWVzX3Jlc3VsdDoKICAgICAgICAgICAgICAgIGlmIGxlbihpdGVtX3ZhbHVlc19yZXN1bHQpID4gMToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnLCAnJykKICAgICAgICAgICAgICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnKSBlbHNlIDE4CgogICAgICAgICAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSksCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNkYXRhPWl0ZW1fdmFsdWVzX3Jlc3VsdAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtX3ZhcmlhbnRzJ10gPSB2YXJpYW50c19jYXJkcy50b19qc29uKCkKCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXI9J9CS0YvQsdC10YDQuNGC0LUg0LLQsNGA0LjQsNC90YIg0YLQvtCy0LDRgNCwOicsCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyfQktGL0LHRgNCw0YLRjCcsICfQntGC0LzQtdC90LAnXQogICAgICAgICAgICAgICAgICAgICkKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc0JhbGFuY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzUHJpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc1ByaWNlc0l0ZW1DYXJkKEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9GA0L7QstC10YDQutCwINGG0LXQvScKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoCiAgICAgICAgICAgIFsncHJpY2VzX2Vycm9yX21zZycsICdwcmljZXNfb2JqZWN0X25hbWUnLCAnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywKICAgICAgICAgICAgJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJ2JhcmNvZGVfaW5mbyddKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3ByaWNlc190YWJsZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKCiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICdwcmljZV90eXBlX3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdwcm9wZXJ0eV9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndW5pdF9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJpY2VfdHlwZV9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgncHJpY2VfdHlwZV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Byb3BlcnR5X3NlbGVjdF9zdWNjZXNzJzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCdwcm9wZXJ0eV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3VuaXRfc2VsZWN0X3N1Y2Nlc3MnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3VuaXRfc2VsZWN0JykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdnZXRfcHJpY2VzX2J0bic6CiAgICAgICAgICAgIHNlbGYuX2dldF9wcmljZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9pZGVudGlmeV9iYXJjb2RlX3ByaWNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fcmVzZXRfcHJpY2VzX3RhYmxlcygpCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2Vzc1Jlc3VsdCIsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdzaG93X2ZpbHRlcnMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NlbGVjdF9pdGVtKHNlbGYpOgogICAgICAgIGl0ZW1fdGFibGVzID0gewogICAgICAgICAgICAncHJpY2VfdHlwZV9zZWxlY3QnOiAnUlNfcHJpY2VfdHlwZXMnLAogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0JzogJ1JTX3Byb3BlcnRpZXMnLAogICAgICAgICAgICAndW5pdF9zZWxlY3QnOiAnUlNfdW5pdHMnLAogICAgICAgIH0KICAgICAgICBpdGVtX3R5cGUgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgc2VsZi5oYXNoX21hcFsndGFibGVfbmFtZSddID0gaXRlbV90YWJsZXNbaXRlbV90eXBlXQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Jlc3VsdF9saXN0ZW5lciddID0gZid7aXRlbV90eXBlfV9zdWNjZXNzJwogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3JldHVybl92YWx1ZV9rZXknXSA9ICdzZWxlY3RlZF9jYXJkJwogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3RpdGxlJ10gPSAn0JLRi9Cx0L7RgCDQt9C90LDRh9C10L3QuNGPJwogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdmaWVsZHMnLCBbJ25hbWUnXSwgdG9fanNvbj1UcnVlKQogICAgICAgIFNlbGVjdEl0ZW1TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvdygpCgogICAgZGVmIF9zZWxlY3RfaXRlbV9yZXN1bHQoc2VsZiwgZmllbGRfbmFtZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX2NhcmQ6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSBzZWxlY3RlZF9jYXJkLmdldCgnbmFtZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9ICcnCgogICAgZGVmIF9nZXRfcHJpY2VzKHNlbGYpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX2lucHV0KCkKICAgICAgICByYXdfcHJpY2VzX2RhdGEgPSBzZWxmLl9nZXRfcHJpY2VzX2RhdGEoKQogICAgICAgIHByaWNlc19kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKHJhd19wcmljZXNfZGF0YSkKICAgICAgICBwcmljZXNfdGFibGUgPSBzZWxmLl9nZXRfcHJpY2VzX3RhYmxlX3ZpZXcocHJpY2VzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc190YWJsZScsIHByaWNlc190YWJsZS50b19qc29uKCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X3ByaWNlc19jb250cm9scyIsICItMSIpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfc2hvd19maWx0ZXJzIiwgIjEiKQoKICAgIGRlZiBfdmFsaWRhdGVfaW5wdXQoc2VsZik6CiAgICAgICAgc2VsZi5fcHJvY2Vzc19pbnB1dF9nb29kX2FydCgpCiAgICAgICAgaWYgbm90IChzZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKSk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfdGFibGVzJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc19lcnJvcl9tc2cnLCAi0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQsdGA0LDQvSDRgtC+0LLQsNGAIikKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfZ29vZF9hcnQoc2VsZik6CiAgICAgICAgaXRlbV9hcnRfaW5wdXQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9hcnQnKQogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCc6ICcnLAogICAgICAgICAgICAncHJpY2VzX29iamVjdF9uYW1lJzogJycsCiAgICAgICAgICAgICdlcnJvcl9tc2cnOiAnJwogICAgICAgIH0KCiAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQ6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywgZmllbGRfdmFsdWU9aXRlbV9hcnRfaW5wdXQpCgogICAgICAgICAgICBpZiBpdGVtX3ZhbHVlc19yZXN1bHQ6CiAgICAgICAgICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICAnaW5wdXRfZ29vZF9pZCc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSwKICAgICAgICAgICAgICAgICAgICAnZ29vZF9jb2RlJzogaXRlbV92YWx1ZXNfcmVzdWx0WzBdWydjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgJ3ByaWNlc19vYmplY3RfbmFtZSc6IGYne2l0ZW1fdmFsdWVzX3Jlc3VsdFswXVsibmFtZSJdfSwgJ2Yne2l0ZW1fdmFsdWVzX3Jlc3VsdFswXVsiY29kZSJdfScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIGl0ZW1fYXJ0X2lucHV0ICE9ICfigJQnIGFuZCBzZWxmLmhhc2hfbWFwLmdldCgncmV0dXJuX3RvX2l0ZW1fY2FyZCcpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCBmIiDQotC+0LLQsNGAINGBINCw0YDRgtC40LrRg9C70L7QvCAne2l0ZW1fYXJ0X2lucHV0fScg0L3QtSDQvdCw0LnQtNC10L0iKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBfaWRlbnRpZnlfYmFyY29kZV9wcmljZXMoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfaW5mbycsIHN0cihzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgJycpCiAgICAgICAgbm9fZGF0YSA9IEZhbHNlCgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9IlJTX2JhcmNvZGVzIiwgZmllbGQ9J2JhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJykpCiAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdOgogICAgICAgICAgICBpZiBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9wcm9wZXJ0eScpOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfcHJvcGVydHknKSkKICAgICAgICAgICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU19wcm9wZXJ0aWVzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1iYXJjb2RlX2RhdGFbMF0uZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaWRfcHJvcGVydHknKSkKICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkX3Byb3BlcnR5X25hbWVbMF0uZ2V0KCduYW1lJyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdLmdldCgnbmFtZScpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICcnKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfZ29vZCcpOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IGJhcmNvZGVfZGF0YVswXVsnaWRfZ29vZCddCgogICAgICAgICAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0iUlNfZ29vZHMiLCBmaWVsZD0naWQnLCBmaWVsZF92YWx1ZT1pdGVtX2lkKQogICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9nb29kX2lkJywgaXRlbV9pZCkKICAgICAgICAgICAgICAgICAgICBpZiBpdGVtX2RhdGFbMF1bJ2FydCddOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9hcnQnLCBpdGVtX2RhdGFbMF1bJ2FydCddKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9nb29kX2FydCcsICfigJQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfb2JqZWN0X25hbWUnLCBpdGVtX2RhdGFbMF1bJ25hbWUnXSkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG5vX2RhdGEgPSBUcnVlCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgItCo0YLRgNC40YXQutC+0LQg0L3QtSDRgNCw0YHQv9C+0LfQvdCw0L0iKQoKICAgICAgICBpZiBub3Qgbm9fZGF0YToKICAgICAgICAgICAgc2VsZi5fZ2V0X3ByaWNlcygpCgogICAgZGVmIF9yZXNldF9wcmljZXNfdGFibGVzKHNlbGYpOgogICAgICAgIHZhcnNfbGlzdCA9IFsnaW5wdXRfZ29vZF9hcnQnLCAncHJpY2VzX29iamVjdF9uYW1lJywgJ3NlbGVjdGVkX3ByaWNlX3R5cGVfaWQnLCAnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgJ3ByaWNlX3R5cGVfc2VsZWN0JywgJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJywgJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAncHJvcGVydHlfc2VsZWN0JywKICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3VuaXRfaWQnLCAnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJ3VuaXRfc2VsZWN0JywgJ3ByaWNlc19jdXN0b21fdGFibGUnLCAnaW5wdXRfZ29vZF9pZCcsCiAgICAgICAgICAgICAgICAgICAgICdiYXJjb2RlJywgJ2JhcmNvZGVfaW5mbycsICdwcmljZXNfdGFibGUnXQogICAgICAgIGRpY3RfZGF0YSA9IHt2YXI6ICIiIGZvciB2YXIgaW4gdmFyc19saXN0fQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoZGljdF9kYXRhKQoKICAgIGRlZiBfc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoc2VsZiwgZWxlbWVudHMpOgogICAgICAgIGZvciB2IGluIGVsZW1lbnRzOgogICAgICAgICAgICBuYW1lID0gZidTaG93X3t2fScKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtuYW1lXSA9ICcxJyBpZiBzZWxmLmhhc2hfbWFwW3ZdIGVsc2UgJy0xJwoKICAgIGRlZiBfZ2V0X3ByaWNlc19kYXRhKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfc2VsZWN0Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZScsICcnKQoKICAgICAgICBkYXRhID0gc2VsZi5oc19zZXJ2aWNlLmdldF9wcmljZXNfZ29vZHMoaWRfZ29vZD1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9wcm9wZXJ0eT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfdW5pdD1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfdW5pdF9pZCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9wcmljZV90eXBlPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9wcmljZV90eXBlX2lkJykpLmRhdGEKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIHJhd19iYWxhbmNlc19kYXRhKToKCiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICBmb3IgZWwgaW4gcmF3X2JhbGFuY2VzX2RhdGE6CiAgICAgICAgICAgIHRhYmxlX3JvdyA9IHsna2V5Jzogc3RyKGVsWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3ByaWNlX3R5cGUnOiBzdHIoZWxbJ25hbWVfcHJpY2VfdHlwZSddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICdwcmljZSc6IHN0cihlbFsncHJpY2UnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAndW5pdCc6IHN0cihlbFsnbmFtZV91bml0J10pIG9yICfigJQnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXMnOiBzdHIoZWxbJ25hbWVfcHJvcGVydHknXSBvciAn4oCUJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9pdGVtX3RhYmxlX3Jvd192aWV3KGVsKX0KICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQodGFibGVfcm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3ByaWNlc190YWJsZV92aWV3KHNlbGYsIGRhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ci0LjQvyDRhtC10L3RiycpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQuCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KbQtdC90LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cj0L/QsNC60L7QstC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRjBGOEZGJwogICAgICAgICAgICApLAoKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9ZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9pdGVtX3RhYmxlX3Jvd192aWV3KHNlbGYsIHJvd19kYXRhKToKCiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJpY2VfdHlwZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0aWVzJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BwcmljZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0YwRjhGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAnaG9yaXpvbnRhbCcKICAgICAgICAgICAgc2VsZi5oZWlnaHQgPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLndpZHRoID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi5TdHJva2VXaWR0aCA9IDEKCmNsYXNzIFNlbGVjdFByb3BlcnRpZXMoR29vZHNQcmljZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQktGL0LHQvtGAINGF0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC6JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cm0LXQvdGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX2lucHV0KCkKICAgICAgICBjYXJkc19kYXRhID0gc2VsZi5fZ2V0X2RhdGEoKQogICAgICAgIHByb3BlcnRpZXNfY2FyZHMgPSBzZWxmLl9nZXRfY2FyZHMoY2FyZHNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJvcGVydHlfY2FyZHMnLCBwcm9wZXJ0aWVzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgX2dldF9kYXRhKHNlbGYpOgogICAgICAgIHRhYmxlX25hbWUgPSAiUlNfcHJvcGVydGllcyIKICAgICAgICByYXdfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWUsIGZpZWxkPSdpZF9vd25lcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfZ29vZF9pZCcpKQogICAgICAgIGNhcmRzX2RhdGEgPSBbXQogICAgICAgIGZvciBlbGVtZW50IGluIHJhd19kYXRhOgogICAgICAgICAgICBjYXJkX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAna2V5JzogZWxlbWVudFsnaWQnXSwKICAgICAgICAgICAgICAgICduYW1lJzogZWxlbWVudFsnbmFtZSddCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FyZHNfZGF0YS5hcHBlbmQoY2FyZF9kYXRhKQogICAgICAgIHJldHVybiBjYXJkc19kYXRhCgogICAgZGVmIF9nZXRfY2FyZHMoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpCgogICAgICAgIGNhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQogICAgICAgIHJldHVybiBjYXJkcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9pZCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgICAgIHNlbGVjdGVkX3Byb3BlcnR5X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU19wcm9wZXJ0aWVzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGVjdGVkX3Byb3BlcnR5X2lkKVswXVsnbmFtZSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIHNlbGVjdGVkX3Byb3BlcnR5X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9IHNlbGVjdGVkX3Byb3BlcnR5X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZSddID0gc2VsZWN0ZWRfcHJvcGVydHlfbmFtZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9GA0L7QstC10YDQutCwINGG0LXQvScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCIgb3IgJ2JhY2tfdG9fcHJpY2VzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfaWQnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdCddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfcHJvcGVydHlfbmFtZSddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKY2xhc3MgU2VsZWN0VW5pdChHb29kc1ByaWNlc0l0ZW1DYXJkKToKICAgIHNjcmVlbl9uYW1lID0gJ9CS0YvQsdC+0YAg0YPQv9Cw0LrQvtCy0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuX2dldF9kYXRhKCkKICAgICAgICBwcm9wZXJ0aWVzX2NhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VuaXRfY2FyZHMnLCBwcm9wZXJ0aWVzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgX2dldF9kYXRhKHNlbGYpOgogICAgICAgIHRhYmxlX25hbWUgPSAiUlNfdW5pdHMiCiAgICAgICAgcmF3X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lLCBmaWVsZD0naWRfb3duZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSkKICAgICAgICBjYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgZWxlbWVudCBpbiByYXdfZGF0YToKICAgICAgICAgICAgY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGVsZW1lbnRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IGVsZW1lbnRbJ25hbWUnXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzX2RhdGEuYXBwZW5kKGNhcmRfZGF0YSkKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgICwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gY2FyZHMKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZWN0ZWRfdW5pdF9pZCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpCiAgICAgICAgICAgIHNlbGVjdGVkX3VuaXRfbmFtZSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9J1JTX3VuaXRzJywgZmllbGQ9J2lkJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZWN0ZWRfdW5pdF9pZClbMF1bJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9pZCcsIHNlbGVjdGVkX3VuaXRfaWQpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0J10gPSBzZWxlY3RlZF91bml0X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfbmFtZScsIHNlbGVjdGVkX3VuaXRfbmFtZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiIG9yICdiYWNrX3RvX3ByaWNlcyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3VuaXRfaWQnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0J10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJycpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9GA0L7QstC10YDQutCwINGG0LXQvScpCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IFNlcmllcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIFNlcmllc1NlbGVjdFNjcmVlbihTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1Nlcmllc1Byb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZXJpZXNTZWxlY3RTY3JlZW4nCiAgICBkb2NfYmFzaWNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZSA9ICdSU19kb2NzJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlcmllc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RpdGxlJzogJ9CS0YvQsdC+0YAg0YHQtdGA0LjQuCcsCiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogc2VsZi5oYXNoX21hcFsnZG9jX3Jvd19pZCddLAogICAgICAgIH0KICAgICAgICBzZWxmLnVzZV9hZHJfZG9jc190YWJsZXM9c2VsZi5oYXNoX21hcC5nZXRfYm9vbCgndXNlX2Fkcl9kb2NzX3RhYmxlcycpCgoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBpZiBzZWxmLnVzZV9hZHJfZG9jc190YWJsZXM6CiAgICAgICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkclNlcmllc1NlcnZpY2UoKQoKICAgICAgICBrZXkgPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ2RvY19yb3dfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKGtleSkKICAgICAgICAjICMg0J7QsdGA0LDQsdC+0YLQsNC10Lwg0YfQuNGB0LvQvtCy0YvQtSDQutC70Y7Rh9C4INCyINGB0LvQvtCy0LDRgNC1CiAgICAgICAgc2VsZi5faGFuZGxlX251bV9rZXlzKHNlbGYuc2NyZWVuX2RhdGEpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnBhcmFtcyA9IHNlbGYuc2NyZWVuX2RhdGEKICAgICAgICBzZWxmLl9yZWZyZXNoX3Nlcmllc19jYXJkcygpCgogICAgICAgIHRpdGxlID0gJ3t9IOKEliB7fSDQvtGCIHt9Jy5mb3JtYXQoCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY190eXBlJ10sCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY19uJ10sCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY19kYXRlJ10KICAgICAgICApCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdkb2NfZGF0YScsIHRpdGxlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICBzZWxmLl9yZWZyZXNoX3RvdGFsX3F0dHkoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLnNjcmVlbl92YWx1ZXNbJ3RpdGxlJ10pCiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgIyBzZWxmLl9yZWZyZXNoX3Nlcmllc19jYXJkcygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZi5fY2FyZHNfY2xpY2tfaGFuZGxlcigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9iYXJjb2RlX2xpc3RlbmVyKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd2aXNpb25fY2FuY2VsJzoKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndmlzaW9uJzoKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcigpCiAgICAgICAgICAgIFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbF9jb3VudGVyLmRlc3Ryb3koKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fZGVsZXRlJyk6CiAgICAgICAgICAgIHNlbGYuZGVsZXRlX3NlcmllcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX29jcl9zZXJpYWxfdGVtcGxhdGVfc2V0dGluZ3MnOgogICAgICAgICAgICBvY3Jfbm9zcWwgPSBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWwKICAgICAgICAgICAgb2NyX25vc3FsLnB1dCgnc2hvd19wcm9jZXNzX3Jlc3VsdCcsIFRydWUsIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19wcm9jZXNzX3Jlc3VsdCgnT2NyVGV4dFJlY29nbml0aW9uJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncycpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuc2hvd19wcm9jZXNzX3Jlc3VsdChhcmdzKQoKICAgIGRlZiBfY2FyZHNfY2xpY2tfaGFuZGxlcihzZWxmKToKICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19pdGVtX3NjcmVlbigpCgogICAgZGVmIF9vcGVuX3Nlcmllc19pdGVtX3NjcmVlbihzZWxmKToKICAgICAgICBhcmdzID0gewogICAgICAgICAgICAnc2VyaWVzX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IiksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNGPJwogICAgICAgIH0KICAgICAgICBzY3JlZW4gPSBTZXJpZXNJdGVtKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgc2NyZWVuLnNob3coYXJncykKCiAgICBkZWYgX3JlZnJlc2hfdG90YWxfcXR0eShzZWxmKToKICAgICAgICByZWFsX3F0dHkgPSBzZWxmLnNlcnZpY2UuZ2V0X3RvdGFsX3F0dHkoKQogICAgICAgIG9sZF9xdHkgPSBmbG9hdChzZWxmLmhhc2hfbWFwWydxdHR5J10gb3IgMCkKCiAgICAgICAgaWYgb2xkX3F0eSAhPSBmbG9hdChyZWFsX3F0dHkgb3IgMCk6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfdG90YWxfcXR5KHF0eT1yZWFsX3F0dHksIHJvd19pZD1zZWxmLnNjcmVlbl92YWx1ZXNbJ2RvY19yb3dfaWQnXSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsncXR0eSddID0gc2VsZi5fZm9ybWF0X3F1YW50aXR5KHJlYWxfcXR0eSkKCiAgICBkZWYgX2JhcmNvZGVfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgc2VsZi5faWRlbnRpZnlfYWRkX2JhcmNvZGVfc2VyaWVzKCkKICAgICAgICBzZWxmLl9yZWZyZXNoX3Nlcmllc19jYXJkcygpCiAgICAgICAgc2VsZi5fcmVmcmVzaF90b3RhbF9xdHR5KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX2NoZWNrX3F0dHlfbGltaXRzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2NvbnRyb2wnKToKICAgICAgICAgICAgcXR0eSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQogICAgICAgICAgICBxdHR5X3BsYW4gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHlfcGxhbicpKQogICAgICAgICAgICBpZiBxdHR5ID4gcXR0eV9wbGFuOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgi0KTQsNC60YIg0L/RgNC10LLRi9GI0LDQtdGCINC/0LvQsNC9IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19xdHR5X2xpbWl0cygpOgogICAgICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2Vzc1Jlc3VsdCcpCgogICAgZGVmIF9yZWZyZXNoX3Nlcmllc19jYXJkcyhzZWxmKToKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc19ieV9kb2NfYW5kX2dvb2RzKCkKICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5faGFuZGxlX251bV9rZXlzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5fYWRkX3RleHRfaW5fdmFsdWVzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcobGlzdF9kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Nlcmllc19jYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBfaGFuZGxlX251bV9rZXlzKHNlbGYsIHZhbHVlczogZGljdCkgLT4gZGljdDoKICAgICAgICBudW1lcmljX2tleXMgPSAoJ3F0dHknLCAncXR0eV9wbGFuJywgJ2RfcXR0eScpCiAgICAgICAgZm9yIGtleSBpbiBudW1lcmljX2tleXM6CiAgICAgICAgICAgIGlmIGtleSBpbiB2YWx1ZXMgYW5kIHJlLm1hdGNoKCJeXGQrXC4/XGQqJCIsIHN0cih2YWx1ZXNba2V5XSkpOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoZmxvYXQodmFsdWVzW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSAnMCcKICAgICAgICByZXR1cm4gdmFsdWVzCgogICAgZGVmIF9hZGRfdGV4dF9pbl92YWx1ZXMoc2VsZiwgdmFsdWVzOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGZvciBrZXkgaW4gdmFsdWVzLmtleXMoKToKICAgICAgICAgICAgaWYga2V5ID09ICdiZXN0X2JlZm9yZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9Cz0L7QtNC10L0g0LTQvjoge3ZhbHVlc1trZXldfScKICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ3Byb2R1Y3Rpb25fZGF0ZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C00LDRgtCwINC/0YDQvtC40LfQsi46IHt2YWx1ZXNba2V5XX0nCiAgICAgICAgICAgIGVsaWYga2V5ID09ICdxdHR5JyBhbmQgdmFsdWVzW2tleV0gaXMgbm90IE5vbmUgYW5kIHZhbHVlc1trZXldICE9ICcnOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C60L7Quy3QstC+OiB7dmFsdWVzW2tleV19JwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKCiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BiZXN0X2JlZm9yZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0n0KPQtNCw0LvQuNGC0YwnLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMGYwM2ZjJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9JyAnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvZHVjdGlvbl9kYXRlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfaWRlbnRpZnlfYWRkX2JhcmNvZGVfc2VyaWVzKHNlbGYpOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpIG9yIG9jcl9ub3NxbC5nZXQoJ29jcl9yZXN1bHQnKQogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIG9jcl9ub3NxbC5kZWxldGUoJ29jcl9yZXN1bHQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnYmFyY29kZScpCiAgICAgICAgICAgIHZhbHVlcyA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX2J5X2JhcmNvZGUoYmFyY29kZSwgc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IHZhbHVlc1swXVsnaWQnXQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9xdHR5X3RvX3RhYmxlX3N0cihpdGVtX2lkKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9uZXdfc2VyaWVzX2luX2RvY19zZXJpZXNfdGFibGUoYmFyY29kZSkKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDRgdC10YDQuNGOPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQmNC30LzQtdC90LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9zZXJpZXNfaWQnXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLCBzZWxmLnBhcmFtcykKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBkZWxldGVfc2VyaWVzKHNlbGYpOgogICAgICAgIGlkID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICBzZWxmLnNlcnZpY2UuZGVsZXRlX2N1cnJlbnRfc3QoaWQpCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IG9jcl9ub3NxbC5nZXQoJ3NlcmlhbF9vY3Jfc2V0dGluZ3MnKQogICAgICAgIGlmIHNlcmlhbF9vY3Jfc2V0dGluZ3M6CiAgICAgICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBqc29uLmxvYWRzKHNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3Zpc2lvbl9zZXR0aW5ncygqKnNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ2Zyb21fc2NyZWVuJywgJ1Nlcmllc1NlbGVjdFNjcmVlbicsIFRydWUpCgpjbGFzcyBTZXJpZXNJdGVtKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VyaWVzUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ0ZpbGxpbmdTZXJpZXNTY3JlZW4nCiAgICBkb2NfYmFzaWNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZSA9ICdSU19kb2NzJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlcmllc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RpdGxlJzogJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLAogICAgICAgICAgICAnc2VyaWVzX2lkJzogc2VsZi5oYXNoX21hcFsnc2VyaWVzX2lkJ10sCiAgICAgICAgfQoKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQoKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ2dvb2RfbmFtZSddLAogICAgICAgICAgICAnbmFtZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ25hbWUnXSwKICAgICAgICAgICAgJ251bWJlcic6IHNlbGYuc2NyZWVuX2RhdGFbJ251bWJlciddLAogICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJzogc2VsZi5zY3JlZW5fZGF0YVsncHJvZHVjdGlvbl9kYXRlJ10sCiAgICAgICAgICAgICdiZXN0X2JlZm9yZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ2Jlc3RfYmVmb3JlJ10sCiAgICAgICAgICAgICdGaWxsaW5nU2VyaWVzU2NyZWVuX3F0dHknIDogc2VsZi5zY3JlZW5fZGF0YVsncXR0eSddCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9oYW5kbGVfbnVtX2tleXMocHV0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQogICAgICAgICMgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJidG5fc2F2ZSI6CiAgICAgICAgICAgIHNlbGYuc2F2ZV9kYXRhKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iYWNrX3NjcmVlbigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iYWNrX3NjcmVlbigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2NhbmNlbCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuYmFja19zY3JlZW4oKQoKICAgICAgICAjIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2VsZi5oYXNoX21hcFsncHJvZHVjdGlvbl9kYXRlJ10pCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgIyBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBzYXZlX2RhdGEoc2VsZik6CiAgICAgICAgcGFyYW1zID0geydpZCc6IGludChzZWxmLnNjcmVlbl9kYXRhWydpZCddKSwKICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuc2NyZWVuX2RhdGFbJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6ICBzZWxmLnNjcmVlbl9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzpzZWxmLmhhc2hfbWFwWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmhhc2hfbWFwWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgICAgICAgJ2lkX3dhcmVob3VzZSc6IHNlbGYuaGFzaF9tYXBbJ2lkX3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgICAncXR0eSc6IHNlbGYuaGFzaF9tYXBbJ0ZpbGxpbmdTZXJpZXNTY3JlZW5fcXR0eSddLAogICAgICAgICAgICAgICAgICAnbmFtZSc6IHNlbGYuaGFzaF9tYXBbJ25hbWUnXSwKICAgICAgICAgICAgICAgICAgJ2Jlc3RfYmVmb3JlJzogc2VsZi5oYXNoX21hcFsnYmVzdF9iZWZvcmUnXSBpZiBzZWxmLl9pc192YWxpZF9kYXRlX2Zvcm1hdChzZWxmLmhhc2hfbWFwWydiZXN0X2JlZm9yZSddKSBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICdudW1iZXInOiBzZWxmLmhhc2hfbWFwWydudW1iZXInXSwKICAgICAgICAgICAgICAgICAgJ3Byb2R1Y3Rpb25fZGF0ZSc6IHNlbGYuaGFzaF9tYXBbJ3Byb2R1Y3Rpb25fZGF0ZSddIGlmIHNlbGYuX2lzX3ZhbGlkX2RhdGVfZm9ybWF0KHNlbGYuaGFzaF9tYXBbJ3Byb2R1Y3Rpb25fZGF0ZSddKSBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICdjZWxsJzogc2VsZi5oYXNoX21hcFsnaWRfY2VsbCddCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICBzZWxmLnNlcnZpY2Uuc2F2ZV90YWJsZV9zdHIocGFyYW1zKQoKICAgIGRlZiBfaXNfdmFsaWRfZGF0ZV9mb3JtYXQoc2VsZiwgZGF0ZV9zdHIpOgogICAgICAgIHBhdHRlcm4gPSByIl4oMFsxLTldfFsxMl1bMC05XXwzWzAxXSlcLigwWzEtOV18MVswLTJdKVwuXGR7NH0kIgogICAgICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIGRhdGVfc3RyKSkKCiAgICBkZWYgX2hhbmRsZV9udW1fa2V5cyhzZWxmLCB2YWx1ZXM6IGRpY3QpIC0+IGRpY3Q6CiAgICAgICAgbnVtZXJpY19rZXlzID0gKCdxdHR5JywgJ3F0dHlfcGxhbicsICdkX3F0dHknLCAnRmlsbGluZ1Nlcmllc1NjcmVlbl9xdHR5JykKICAgICAgICBmb3Iga2V5IGluIG51bWVyaWNfa2V5czoKICAgICAgICAgICAgaWYga2V5IGluIHZhbHVlcyBhbmQgcmUubWF0Y2goIl5cZCtcLj9cZCokIiwgc3RyKHZhbHVlc1trZXldKSk6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShmbG9hdCh2YWx1ZXNba2V5XSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9ICcwJwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKIyA9PT09PT09PT09PT09PT09PT09PSBTZWxlY3RJdGVtU2NyZWVuID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZWxlY3RJdGVtU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VsZWN0SXRlbVByb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZWxlY3RJdGVtU2NyZWVuJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RhYmxlX25hbWUnOiBoYXNoX21hcFsndGFibGVfbmFtZSddLAogICAgICAgICAgICAnZmllbGRzJzogaGFzaF9tYXAuZ2V0X2pzb24oJ2ZpZWxkcycpLAogICAgICAgICAgICAncmVzdWx0X2xpc3RlbmVyJzogaGFzaF9tYXBbJ3Jlc3VsdF9saXN0ZW5lciddIG9yICdzZWxlY3Rfc3VjY2VzcycsCiAgICAgICAgICAgICdyZXR1cm5fdmFsdWVfa2V5JzogaGFzaF9tYXBbJ3JldHVybl92YWx1ZV9rZXknXSBvciAnc2VsZWN0ZWRfY2FyZCcsCiAgICAgICAgICAgICd0aXRsZSc6IGhhc2hfbWFwWyd0aXRsZSddIG9yICfQktGL0LHQvtGAINC30L3QsNGH0LXQvdC40Y8nLAogICAgICAgIH0KICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5TZWxlY3RJdGVtU2VydmljZShzZWxmLnNjcmVlbl92YWx1ZXNbJ3RhYmxlX25hbWUnXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdmFsdWVzWyd0aXRsZSddKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2ssCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlc1snZmllbGRzJ10gPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdmaWVsZHMnKQogICAgICAgIGNhcmRzX2RhdGEgPSBzZWxmLmRiX3NlcnZpY2UuZ2V0X3NlbGVjdF9kYXRhKCkKICAgICAgICBjYXJkcyA9IHNlbGYuX2dldF9jYXJkcyhjYXJkc19kYXRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydjYXJkc19kYXRhJ10gPSBjYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gJycKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ1NldFJlc3VsdExpc3RlbmVyJ10gPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3Jlc3VsdF9saXN0ZW5lciddCiAgICAgICAgc2VsZi5zaG93X3Byb2Nlc3NfcmVzdWx0KGFyZ3MpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBmaWVsZHNfdmlld3MgPSBbXQogICAgICAgIGZvciBmaWVsZCBpbiBzZWxmLnNjcmVlbl92YWx1ZXNbJ2ZpZWxkcyddOgogICAgICAgICAgICBmaWVsZHNfdmlld3MuYXBwZW5kKAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9ZidAe2ZpZWxkfScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCgogICAgICAgIGNhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAqZmllbGRzX3ZpZXdzLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCiAgICAgICAgcmV0dXJuIGNhcmRzCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwW3NlbGYuc2NyZWVuX3ZhbHVlc1sncmV0dXJuX3ZhbHVlX2tleSddXSA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfZGF0YSddCiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFtzZWxmLnNjcmVlbl92YWx1ZXNbJ3JldHVybl92YWx1ZV9rZXknXV0gPSAnJwogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHNlbGYuX2NsZWFyX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyZXR1cm5fc2VsZWN0ZWRfZGF0YScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3NlbGVjdGVkX2NhcmRfZGF0YScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ2NhcmRzX2RhdGEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyZXR1cm5fdmFsdWVfa2V5JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgndGl0bGUnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JykKCgpjbGFzcyBTaG93SXRlbXNTY3JlZW4oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICdTZWxlY3RJdGVtUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ1Nob3dJdGVtc1NjcmVlbicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmluaXRfcGFyYW1zID0gWyd0aXRsZScsICd0YWJsZV9kYXRhJywgJ3RhYmxlX2hlYWRlcicsICdlbnVtZXJhdGUnXQogICAgICAgIHNlbGYuZW51bWVyYXRlPVRydWUKICAgICAgICBzZWxmLnRhYmxlX2RhdGEgPSBbXQogICAgICAgIHNlbGYuZmllbGRzID0gW10KICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHt9CiAgICAgICAgc2VsZi50ZXh0X3NpemUgPSAxNQogICAgICAgIHNlbGYuaGVhZGVyX3RleHRfc2l6ZSA9IDE1CgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3RpdGxlKHNlbGYuaGFzaF9tYXBbJ3RpdGxlJ10gb3IgJ9Ch0L/QuNGB0L7QuicpCiAgICAgICAgc2VsZi5lbnVtZXJhdGUgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdlbnVtZXJhdGUnKQogICAgICAgIHNlbGYudGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3RhYmxlX2RhdGEnKQogICAgICAgIHNlbGYudGFibGVfaGVhZGVyID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigndGFibGVfaGVhZGVyJykKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfZGF0YToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvciAoJ3RhYmxlX2RhdGEgbm90IGluaXRpYWxpemVkJykKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfaGVhZGVyOgogICAgICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHtrZXk6IGtleSBmb3Iga2V5IGluIG5leHQoaXRlcihzZWxmLnRhYmxlX2RhdGEpKS5rZXlzKCl9CgogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEoKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2l0ZW1zX3RhYmxlJ10gPSBzZWxmLl9nZXRfdGFibGVfdmlldyh0YWJsZV9kYXRhKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYpOgogICAgICAgIHNlbGYuZmllbGRzID0gbGlzdChzZWxmLnRhYmxlX2hlYWRlci5rZXlzKCkpCiAgICAgICAgdGFibGVfaGVhZGVyX2xheW91dCA9IHsnX2xheW91dCc6IHNlbGYuX2dldF90YWJsZV9oZWFkZXJfdmlldygpfQoKICAgICAgICBpZiBzZWxmLmVudW1lcmF0ZToKICAgICAgICAgICAgdGFibGVfZGF0YSA9IFtkaWN0KCoqeydwb3MnOiAnTid9LCAqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXQogICAgICAgICAgICB0YWJsZV9kYXRhICs9IFtkaWN0KCoqeydwb3MnOiBwb3N9LCAqKnJvdykgZm9yIHBvcywgcm93IGluIGVudW1lcmF0ZShzZWxmLnRhYmxlX2RhdGEsIHN0YXJ0PTEpXQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXSArIHNlbGYudGFibGVfZGF0YQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3RhYmxlX2hlYWRlcl92aWV3KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9nZXRfZmllbGRzX2xheW91dChpc19oZWFkZXI9VHJ1ZSkKCiAgICBkZWYgX2dldF9maWVsZHNfbGF5b3V0KHNlbGYsIGlzX2hlYWRlcj1GYWxzZSwgYmFja2dyb3VuZF9jb2xvcj0nI0ZCRTlFNycsIHdlaWdodD0xKToKICAgICAgICBpZiBpc19oZWFkZXI6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAnI0ZGRkZGRicKICAgICAgICAgICAgdGV4dF9zaXplID0gc2VsZi5oZWFkZXJfdGV4dF9zaXplCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGV4dF9zaXplID0gc2VsZi50ZXh0X3NpemUKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGZpZWxkc19sYXlvdXQgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPWJhY2tncm91bmRfY29sb3IsCiAgICAgICAgKQoKICAgICAgICBpZiBzZWxmLmVudW1lcmF0ZToKICAgICAgICAgICAgcG9zX2xheW91dCA9IHNlbGYuX2dldF9jb2x1bW5fdmlldyh2YWx1ZT0ncG9zJywgdGV4dF9zaXplPXRleHRfc2l6ZSwgd2VpZ2h0PXdlaWdodCkKICAgICAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQocG9zX2xheW91dCkKCiAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgKltzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9ZmllbGQsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpIGZvciBmaWVsZCBpbiBzZWxmLmZpZWxkc10sCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdlaWdodD04CiAgICAgICAgICAgICkKICAgICAgICApCgogICAgICAgIHJldHVybiBmaWVsZHNfbGF5b3V0CgogICAgZGVmIF9nZXRfY29sdW1uX3ZpZXcoc2VsZiwgdmFsdWUsIHRleHRfc2l6ZT0yMCwgd2VpZ2h0PTEpOgogICAgICAgIHJldHVybiB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPWYnQHt2YWx1ZX0nLAogICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgVGV4dFNpemU9dGV4dF9zaXplLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgd2VpZ2h0PXdlaWdodCwKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MSwKICAgICAgICApCgogICAgZGVmIF9nZXRfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfZmllbGRzX2xheW91dCgpLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3LnRvX2pzb24oKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlbGVjdEl0ZW1TY3JlZW4gXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gU2VyaWVzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gU2V0dGluZ3MgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNldHRpbmdzU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gZGJfc2VydmljZXMuRG9jU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgICMgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3RvYXN0JykKICAgICAgICBzZXR0aW5nc19rZXlzID0gWwogICAgICAgICAgICAndXNlX21hcmsnLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCcsCiAgICAgICAgICAgICdhZGRfaWZfbm90X2luX3BsYW4nLAogICAgICAgICAgICAncGF0aCcsCiAgICAgICAgICAgICdkZWxldGVfZmlsZXMnLAogICAgICAgICAgICAnYWxsb3dfb3ZlcnNjYW4nLAogICAgICAgICAgICAnb2ZmbGluZV9tb2RlJwogICAgICAgIF0KCiAgICAgICAgcHV0X2RhdGEgPSB7a2V5OiBzZWxmLnJzX3NldHRpbmdzLmdldChrZXkpIGZvciBrZXkgaW4gc2V0dGluZ3Nfa2V5c30KICAgICAgICBwdXRfZGF0YVsnaXBfYWRyJ10gPSBzZWxmLl9nZXRfaXBfYWRkcmVzcygpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHNlbGYuX3VwZGF0ZV9yc19zZXR0aW5ncygpCgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2J0bl9odHRwX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4IGh0dHAg0YHQvtC10LTQuNC90LXQvdC40Y8nKSwKICAgICAgICAgICAgJ2J0bl9zaXplJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INCo0YDQuNGE0YLQvtCyJyksCiAgICAgICAgICAgICdidG5fc291bmRfc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60LAg0LfQstGD0LrQsCcpLAogICAgICAgICAgICAnYnRuX2RvY3VtZW50c19zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsicpLAogICAgICAgICAgICAnYnRuX29jcl9yZWNvZ25pdGlvbl9zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5wdXQoJ1N0YXJ0UHJvY2VzcycsICdPY3JUZXh0UmVjb2duaXRpb24nKSwKICAgICAgICAgICAgJ2J0bl9wcmludF9zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5wdXQoJ1N0YXJ0UHJvY2VzcycsICfQn9C10YfQsNGC0YwnKSwKICAgICAgICAgICAgJ2J0bl90ZXN0X2JhcmNvZGUnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQotC10YHRgiDRgdC60LDQvdC10YDQsCcpLAogICAgICAgICAgICAnYnRuX2Vycl9sb2cnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQntGI0LjQsdC60LgnKSwKICAgICAgICAgICAgJ2J0bl91cGxvYWRfZG9jcyc6IHNlbGYuX3VwbG9hZF9kb2NzLAogICAgICAgICAgICAnYnRuX3RpbWVyJzogc2VsZi5fbG9hZF9kb2NzLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKSwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfdXBsb2FkX2RvY3Moc2VsZik6CiAgICAgICAgaWYgc2VsZi5fY2hlY2tfaHR0cF9zZXR0aW5ncygpOgogICAgICAgICAgICB0aW1lciA9IFRpbWVyKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgICAgICMgdGltZXIudXBsb2FkX2FsbF9kb2NzKCkKICAgICAgICAgICAgdGltZXIuX3VwbG9hZF9kYXRhKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INC30LDQtNCw0L3RiyDQvdCw0YHRgtGA0L7QudC60Lgg0YHQvtC10LTQuNC90LXQvdC40Y8nKQoKICAgIGRlZiBfbG9hZF9kb2NzKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgdGltZXIgPSBUaW1lcihzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKQogICAgICAgICAgICB0aW1lci50aW1lcl9vbl9zdGFydCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtSDQt9Cw0LTQsNC90Ysg0L3QsNGB0YLRgNC+0LnQutC4INGB0L7QtdC00LjQvdC10L3QuNGPJykKCiAgICBkZWYgX3VwZGF0ZV9yc19zZXR0aW5ncyhzZWxmKSAtPiBOb25lOgogICAgICAgIHVzZV9tYXJrID0gc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9tYXJrJykgb3IgJ2ZhbHNlJwogICAgICAgIHBhdGggPSBzZWxmLmhhc2hfbWFwLmdldCgncGF0aCcpIG9yICcvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvJwogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdhbGxvd19mYWN0X2lucHV0Jykgb3IgRmFsc2UKICAgICAgICBvZmZsaW5lX21vZGUgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdvZmZsaW5lX21vZGUnKSBvciBGYWxzZQoKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgndXNlX21hcmsnLCB1c2VfbWFyaywgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgncGF0aCcsIHBhdGgsIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2FsbG93X2ZhY3RfaW5wdXQnLCBhbGxvd19mYWN0X2lucHV0LCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdvZmZsaW5lX21vZGUnLCBvZmZsaW5lX21vZGUsIFRydWUpCgogICAgZGVmIF9zaG93X3NjcmVlbihzZWxmLCBzY3JlZW5fbmFtZSkgLT4gTm9uZToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNjcmVlbl9uYW1lKQoKICAgIGRlZiBfZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZikgLT4gZGljdDoKICAgICAgICBodHRwX3NldHRpbmdzID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgICAgICAgICAndXNlcic6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICAgICAgICAgJ2RldmljZV9tb2RlbCc6IHNlbGYuaGFzaF9tYXBbJ0RFVklDRV9NT0RFTCddLAogICAgICAgICAgICAnYW5kcm9pZF9pZCc6IHNlbGYuaGFzaF9tYXBbJ0FORFJPSURfSUQnXSwKICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgICAgICByZXR1cm4gaHR0cF9zZXR0aW5ncwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X2lwX2FkZHJlc3MoKSAtPiBzdHI6CiAgICAgICAgcmVzID0gZ2V0X2lwX2FkZHJlc3MoKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiAn0L3QtdGCINGB0LXRgtC4JwoKICAgIGRlZiBfY2hlY2tfaHR0cF9zZXR0aW5ncyhzZWxmKSAtPiBib29sOgogICAgICAgIGh0dHAgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgcmV0dXJuIGFsbChbaHR0cC5nZXQoJ3VybCcpLCBodHRwLmdldCgndXNlcicpLCBodHRwLmdldCgncGFzcycpXSkKCgpjbGFzcyBGb250U2l6ZVNldHRpbmdzU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0KjRgNC40YTRgtC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwdXRfZGF0YSA9IHt9CiAgICAgICAgZmllbGRzX2RhdGEgPSB7CiAgICAgICAgICAgICdUaXRsZVRleHRTaXplJzogJ9Cg0LDQt9C80LXRgCDQt9Cw0LPQvtC70L7QstC60LAnLAogICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCDQutCw0YDRgtC+0YfQutC4JywKICAgICAgICAgICAgIkNhcmREYXRlVGV4dFNpemUiOiAn0JTQsNC90L3Ri9C1INC60LDRgNGC0L7Rh9C60LgnLAogICAgICAgICAgICAnQ2FyZFRleHRTaXplJzogJ9Cg0LDQt9C80LXRgCDRgtC10LrRgdGC0LAg0Y3Qu9C10LzQtdC90YLQvtCyJywKICAgICAgICAgICAgJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnOiAn0JfQsNCz0L7Qu9C+0LLQvtC6INGC0L7QstCw0YDQsCcsCiAgICAgICAgICAgICdnb29kc1RleHRTaXplJzogJ9Ci0L7QstCw0YAnLAogICAgICAgICAgICAnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogJ9Ch0LXRgNC40Lgg0YHQstC+0LnRgdGC0LLQsCcsCiAgICAgICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogJ9Ci0LjQvyDQtNC+0LrRg9C80LXQvdGC0LAnLAogICAgICAgICAgICAndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJzogJ9Cd0LDQt9Cy0LDQvdC40LUg0LTQvtC60YPQvNC10L3RgtCwINCyINC60LDRgNGC0L7Rh9C60LUnCiAgICAgICAgfQoKICAgICAgICBmb3IgZmllbGQsIGhpbnQgaW4gZmllbGRzX2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgcHV0X2RhdGFbZmllbGRdID0gd2lkZ2V0cy5Nb2Rlcm5GaWVsZCgKICAgICAgICAgICAgICAgIGhpbnQ9aGludCwKICAgICAgICAgICAgICAgIGRlZmF1bHRfdGV4dD1zZWxmLnJzX3NldHRpbmdzLmdldChmaWVsZCkgb3IgJycKICAgICAgICAgICAgKS50b19qc29uKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX29uX3NhdmUnOgogICAgICAgICAgICBzYXZlX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAnVGl0bGVUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ1RpdGxlVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ0NhcmRUaXRsZVRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnQ2FyZFRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnQ2FyZFRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnQ2FyZERhdGVUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ0NhcmREYXRlVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdHb29kc0NhcmRUaXRsZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ2dvb2RzVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydnb29kc1RleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJzogc2VsZi5oYXNoX21hcFsnU2VyaWVzUHJvcGVydGllc1RleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnRG9jVHlwZUNhcmRUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ0RvY1R5cGVDYXJkVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWyd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnXSwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIGssIHYgaW4gc2F2ZV9kYXRhLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dChrLCB2LCBUcnVlKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9vbl9jYW5jZWwnIG9yIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdCYWNrU2NyZWVuJywgJycpCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ25vUmVmcmVzaCddID0gJycKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKY2xhc3MgQmFyY29kZVRlc3RTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ci0LXRgdGCINGB0LrQsNC90LXRgNCwJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2RlJzogc2VsZi5fYmFyY29kZV9zY2FubmVkLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdCQUNLX0JVVFRPTic6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JhY2tTY3JlZW4nLCAnJykKCiAgICBkZWYgX2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGJhcmNvZGVfcGFyc2VyID0gQmFyY29kZVdvcmtlcihpZF9kb2M9JycpCiAgICAgICAgcmVzdWx0ID0gYmFyY29kZV9wYXJzZXIucGFyc2UoYmFyY29kZSkKICAgICAgICBmaWVsZHNfY291bnQgPSA3CgogICAgICAgIGtleXNfbGlzdCA9IFsnRVJST1InLCAnR1RJTicsICdTRVJJQUwnLCAnRnVsbENvZGUnLCAnQkFSQ09ERScsICdTQ0hFTUUnLCAnRVhQSVJZJywgJ0JBVENIJywgJ05IUk4nLCAnQ0hFQ0snLAogICAgICAgICAgICAgICAgICAgICAnV0VJR0hUJywgJ1BQTiddCgogICAgICAgIHZhbHVlcyA9IFtmJ3trZXl9OiB7cmVzdWx0W2tleV19JyBmb3Iga2V5IGluIGtleXNfbGlzdCBpZiByZXN1bHQuZ2V0KGtleSkgaXMgbm90IE5vbmVdCgogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICBmJ2ZsZF97aSArIDF9JzogdmFsdWVzW2ldIGlmIGxlbih2YWx1ZXMpID4gaSBlbHNlICcnCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGZpZWxkc19jb3VudCkKICAgICAgICB9CgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgoKY2xhc3MgSHR0cFNldHRpbmdzU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60LggaHR0cCDRgdC+0LXQtNC40L3QtdC90LjRjycKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gTm9uZQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2J0bl90ZXN0X2Nvbm5lY3Rpb24nXSA9ICfQotC10YHRgiDRgdC+0LXQtNC40L3QtdC90LjRjycKICAgICAgICBodHRwX3NldHRpbmdzID0gc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKQoKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0n0JDQtNGA0LXRgSDRgdC10YDQstC10YDQsCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1cmwnXSBvciAnJyksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSfQn9C+0LvRjNC30L7QstCw0YLQtdC70YwnLCBkZWZhdWx0X3RleHQ9aHR0cF9zZXR0aW5nc1sndXNlciddIG9yICcnKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9Cf0LDRgNC+0LvRjCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWydwYXNzJ10gb3IgJycsIHBhc3N3b3JkPVRydWUpLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSfQktCw0YjQtSDQuNC80Y8g0LTQu9GPINC40LTQtdC90YLQuNGE0LjQutCw0YbQuNC4INCyIDHQoScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyX25hbWUnXSBvciAnJyksCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX3Rlc3RfY29ubmVjdGlvbic6IHNlbGYuX3Rlc3RfY29ubmVjdGlvbiwKICAgICAgICAgICAgJ2J0bl9zYXZlJzogc2VsZi5fc2F2ZV9zZXR0aW5ncywKICAgICAgICAgICAgJ2JhcmNvZGUnOiBzZWxmLl9iYXJjb2RlX3NjYW5uZWQsCiAgICAgICAgICAgICdidG5fY2FuY2VsJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfdGVzdF9jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpKQoKICAgICAgICBpZiBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS5jb21tdW5pY2F0aW9uX3Rlc3QodGltZW91dD0zKQogICAgICAgICAgICByZXN1bHQgPSBzZWxmLmhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKCiAgICAgICAgICAgIGlmIHJlc3VsdC51bmF1dGhvcml6ZWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0LDQstGC0L7RgNC40LfQsNGG0LjQuCDRgdC10YDQstC10YDQsCAx0KEnKQogICAgICAgICAgICBlbGlmIHJlc3VsdC5mb3JiaWRkZW46CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQl9Cw0L/RgNC+0YEg0L3QsCDQsNCy0YLQvtGA0LjQt9Cw0YbQuNGOINC/0YDQuNC90Y/RgicpCiAgICAgICAgICAgIGVsaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtSDRg9C00LDQu9C+0YHRjCDRg9GB0YLQsNC90L7QstC40YLRjCDRgdC+0LXQtNC40L3QtdC90LjQtScpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0KHQvtC10LTQuNC90LXQvdC40LUg0YPRgdGC0LDQvdC+0LLQu9C10L3QvicpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnc3VjY2VzcycpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudG9hc3QoItCd0LUg0YPQutCw0LfQsNC90Ysg0L3QsNGB0YLRgNC+0LnQutC4IEhUVFAg0L/QvtC00LrQu9GO0YfQtdC90LjRjyDQuiDRgdC10YDQstC10YDRgyIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgogICAgZGVmIF9zYXZlX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVUkwnLCBzZWxmLmhhc2hfbWFwWyd1cmwnXSwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnVVNFUicsIHNlbGYuaGFzaF9tYXBbJ3VzZXInXSwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnUEFTUycsIHNlbGYuaGFzaF9tYXBbJ3Bhc3MnXSwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgndXNlcl9uYW1lJywgc2VsZi5oYXNoX21hcFsndXNlcl9uYW1lJ10sIFRydWUpCgogICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKCiAgICBkZWYgX2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhMicpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBiYXJjX3N0cnVjdCA9IGpzb24ubG9hZHMoYmFyY29kZSkKCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVUkwnLCBiYXJjX3N0cnVjdC5nZXQoJ3VybCcpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnVVNFUicsIGJhcmNfc3RydWN0LmdldCgndXNlcicpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnUEFTUycsIGJhcmNfc3RydWN0LmdldCgncGFzcycpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgndXNlcl9uYW1lJywgYmFyY19zdHJ1Y3QuZ2V0KCd1c2VyX25hbWUnKSwgVHJ1ZSkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd1cmwnLCBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J3VybCcsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VybCcpKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VzZXInLCBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J3VzZXInLCBkZWZhdWx0X3RleHQ9YmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncGFzcycsIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ncGFzcycsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3Bhc3MnKSkpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd1c2VyX25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J3VzZXJfbmFtZScsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VzZXJfbmFtZScpKSkKICAgICAgICBleGNlcHQgKEpTT05EZWNvZGVFcnJvciwgQXR0cmlidXRlRXJyb3IpIGFzIGU6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LXQstC10YDQvdGL0Lkg0YTQvtGA0LzQsNGCIFFSLdC60L7QtNCwJykKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdCYWNrU2NyZWVuJywgJycpCgogICAgZGVmIF9nZXRfbW9kZXJuX2ZpZWxkKHNlbGYsICoqZGF0YSk6CiAgICAgICAgcmV0dXJuIHdpZGdldHMuTW9kZXJuRmllbGQoKipkYXRhKS50b19qc29uKCkKCiAgICBkZWYgX2NoZWNrX2h0dHBfc2V0dGluZ3Moc2VsZikgLT4gYm9vbDoKICAgICAgICBodHRwID0gc2VsZi5fZ2V0X2h0dHBfc2V0dGluZ3MoKQogICAgICAgIHJldHVybiBhbGwoW2h0dHAuZ2V0KCd1cmwnKSwgaHR0cC5nZXQoJ3VzZXInKSwgaHR0cC5nZXQoJ3Bhc3MnKV0pCgogICAgZGVmIF9nZXRfaHR0cF9zZXR0aW5ncyhzZWxmKToKICAgICAgICBodHRwX3NldHRpbmdzID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgICAgICAgICAndXNlcic6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICAgICAgICAgJ2RldmljZV9tb2RlbCc6IHNlbGYuaGFzaF9tYXBbJ0RFVklDRV9NT0RFTCddLAogICAgICAgICAgICAnYW5kcm9pZF9pZCc6IHNlbGYuaGFzaF9tYXBbJ0FORFJPSURfSUQnXSwKICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgICAgICByZXR1cm4gaHR0cF9zZXR0aW5ncwoKCmNsYXNzIFNvdW5kU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQsCDQt9Cy0YPQutCwJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmV2ZW50cyA9IHsnc3VjY2Vzcyc6ICfQodC40LPQvdCw0Lsg0YPQtNCw0YfQvdC+0LPQviDRgdC+0LHRi9GC0LjRjycsICd3YXJuaW5nJzogJ9Ch0LjQs9C90LDQuyDQv9GA0LXQtNGD0L/RgNC10LbQtNC10L3QuNGPJywKICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3InOiAn0KHQuNCz0L3QsNC7INC+0YjQuNCx0LrQuCd9CgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX2luaXRfc291bmRzKCkKICAgICAgICBldmVudHNfZGF0YSA9IHNlbGYuX2dldF9ldmVudHNfZGF0YSgpCiAgICAgICAgZXZlbnRzX2NhcmRzID0gc2VsZi5fZ2V0X2V2ZW50X2NhcmRzX3ZpZXcoZXZlbnRzX2RhdGEsIHBvcHVwX21lbnVfZGF0YT0nMTsyOzM7NDs1OzY7Nzs4Ozk7MTA7MTE7MTI7MTM7MTQ7MTUnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdldmVudF9jYXJkcycsIGV2ZW50c19jYXJkcy50b19qc29uKCkpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ3NhdmVfYnRuJzoKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3N1Y2Nlc3Nfc2lnbmFsJywgc2VsZi5oYXNoX21hcC5nZXQoImN1cnJlbnRfc3VjY2Vzc19zaWduYWwiKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ3dhcm5pbmdfc2lnbmFsJywgc2VsZi5oYXNoX21hcC5nZXQoImN1cnJlbnRfd2FybmluZ19zaWduYWwiKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2Vycm9yX3NpZ25hbCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCJjdXJyZW50X2Vycm9yX3NpZ25hbCIpLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX29uX2NhbmNlbCcgb3Igc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfc3VjY2Vzc19zaWduYWwnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfd2FybmluZ19zaWduYWwnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZXJyb3Jfc2lnbmFsJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdDYXJkc0NsaWNrJzoKICAgICAgICAgICAgc2VsZWN0ZWRfZXZlbnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9rZXknKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZChldmVudD1zZWxlY3RlZF9ldmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291bmRfdmFsPXNlbGYuaGFzaF9tYXAuZ2V0KGYnY3VycmVudF97c2VsZWN0ZWRfZXZlbnR9X3NpZ25hbCcpKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIHNlbGYuX2xheW91dF9hY3Rpb24oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2luaXRfc291bmRzKHNlbGYpOgogICAgICAgICMgZm9yIGtleSwgdmFsIGluIHNlbGYuZXZlbnRzLml0ZW1zKCk6CiAgICAgICAgIyAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KGYnY3VycmVudF97a2V5fV9zaWduYWwnKToKICAgICAgICAjICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoZidjdXJyZW50X3trZXl9X3NpZ25hbCcsIHNlbGYucnNfc2V0dGluZ3MuZ2V0KGYne2V2ZW50fV9zaWduYWwnIG9yICI2IikpCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9zdWNjZXNzX3NpZ25hbCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9zdWNjZXNzX3NpZ25hbCcsIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdzdWNjZXNzX3NpZ25hbCcpKQogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF93YXJuaW5nX3NpZ25hbCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF93YXJuaW5nX3NpZ25hbCcsIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCd3YXJuaW5nX3NpZ25hbCcpKQogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9lcnJvcl9zaWduYWwnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZXJyb3Jfc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2Vycm9yX3NpZ25hbCcpKQoKICAgIGRlZiBfZ2V0X2V2ZW50c19kYXRhKHNlbGYpOgogICAgICAgIGRhdGEgPSBbXQogICAgICAgIGZvciBrZXksIHZhbCBpbiBzZWxmLmV2ZW50cy5pdGVtcygpOgogICAgICAgICAgICBldmVudCA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBrZXksCiAgICAgICAgICAgICAgICAnZXZlbnRfbmFtZSc6IHZhbCwKICAgICAgICAgICAgICAgICdzZWxlY3RlZF92YWx1ZSc6IHNlbGYuaGFzaF9tYXAuZ2V0KGYnY3VycmVudF97a2V5fV9zaWduYWwnKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRhdGEuYXBwZW5kKGV2ZW50KQogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIF9nZXRfZXZlbnRfY2FyZHNfdmlldyhzZWxmLCBldmVudHNfZGF0YSwgcG9wdXBfbWVudV9kYXRhKToKICAgICAgICB0aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgiVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgiQ2FyZFRpdGxlVGV4dFNpemUiKQogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BldmVudF9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dEJvbGQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc2VsZWN0ZWRfdmFsdWUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0yOCwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT1wb3B1cF9tZW51X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhcmlhYmxlPSJtZW51X3NlbGVjdF9zb3VuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSLQn9GA0L7RgdC70YPRiNCw0YLRjCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAoKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0ndmVydGljYWwnLAogICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgZ3Jhdml0eV92ZXJ0aWNhbD0iY2VudGVyIiwKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9ZXZlbnRzX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiBkb2NfY2FyZHMKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCiAgICAgICAgY3VycmVudF9rZXkgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKVsna2V5J10KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChmJ2N1cnJlbnRfe2N1cnJlbnRfa2V5fV9zaWduYWwnLCBsYXlvdXRfbGlzdGVuZXIpCgoKY2xhc3MgRG9jdW1lbnRzU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmNvbnRhaW5zS2V5KCdkb2Nfc2V0dGluZ3Nfb25fc3RhcnQnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY19zZXR0aW5nc19vbl9zdGFydCcsICd0cnVlJykKICAgICAgICAgICAgc2VsZi5faW5pdF9vbGRfZG9jX2RlbGV0ZV9zZXR0aW5ncygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ3NhdmVfYnRuJzoKICAgICAgICAgICAgZGVsX2RvY3NfZmxhZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdkb2Nfc2V0dGluZ3NfY29uZmlybV9kZWxldGVfb2xkX2RvY3MnKQogICAgICAgICAgICBkZWxfZG9jc19mbGFnID0gVHJ1ZSBpZiBkZWxfZG9jc19mbGFnID09ICd0cnVlJyBlbHNlIEZhbHNlCiAgICAgICAgICAgIGlmIG5vdCBkZWxfZG9jc19mbGFnOgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RlbGV0ZV9vbGRfZG9jcycsIEZhbHNlLCBUcnVlKQogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5kZWxldGUoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkYXlzID0gc2VsZi5oYXNoX21hcC5nZXQoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycpCiAgICAgICAgICAgICAgICBpZiBub3QgZGF5cyBvciBkYXlzID09ICcwJyBvciBub3QgZGF5cy5pc2RpZ2l0KCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQo9C60LDQttC40YLQtSDQutC+0YDRgNC10LrRgtC90L7QtSDQutC+0LvQuNGH0LXRgdGC0LLQviDQtNC90LXQuScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcg0LTQu9GPINC90LDRgdGC0YDQvtC50LrQuCDRg9C00LDQu9C10L3QuNGPINGB0YLQsNGA0YvRhSDQtNC+0LrRg9C80LXQvdGC0L7QsicpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICBpZiBkYXlzID49ICc5OTk5JzoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC00L3QtdC5INC/0YDQtdCy0YvRiNCw0LXRgiA5OTk5JykKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkZWxldGVfb2xkX2RvY3MnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycsIGRheXMsIFRydWUpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndCw0YHRgtGA0L7QudC60Lgg0YHQvtGF0YDQsNC90LXQvdGLJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ2RvY19zZXR0aW5nc19vbl9zdGFydCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnZG9jX3NldHRpbmdzX29uX3N0YXJ0JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2luaXRfb2xkX2RvY19kZWxldGVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgY3VycmVudF9kYXlzX3ZhbHVlID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycpCiAgICAgICAgaW5pdF9kYXlzID0gc3RyKGN1cnJlbnRfZGF5c192YWx1ZSkgaWYgY3VycmVudF9kYXlzX3ZhbHVlIGlzIG5vdCBOb25lIGVsc2UgJzEnCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY19kZWxldGVfc2V0dGluZ3NfZGF5cycsIGluaXRfZGF5cykKCiAgICAgICAgZmxhZyA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZWxldGVfb2xkX2RvY3MnKQogICAgICAgIGluaXRfZmxhZyA9IHN0cihmbGFnKS5sb3dlcigpIGlmIGZsYWcgaXMgbm90IE5vbmUgZWxzZSAnZmFsc2UnCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY19zZXR0aW5nc19jb25maXJtX2RlbGV0ZV9vbGRfZG9jcycsIGluaXRfZmxhZykKCgpjbGFzcyBFcnJvckxvZ1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J7RiNC40LHQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBFcnJvclNlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgZGF0ZV9zb3J0ID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZGF0ZV9zb3J0J10KICAgICAgICBlcnJvcnNfdGFibGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfYWxsX2Vycm9ycyhkYXRlX3NvcnQpCiAgICAgICAgdGFibGVfcmF3cyA9IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfcm93cyhlcnJvcnNfdGFibGVfZGF0YSkKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2Vycm9yc190YWJsZV92aWV3KHRhYmxlX3Jhd3MpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImVycm9yX2xvZ190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RhdGVfc29ydF9zZWxlY3QnXSA9ICfQndC+0LLRi9C1O0PRgtCw0YDRi9C1JwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJidG5fY2xlYXJfZXJyIjoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmNsZWFyKCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvSIpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAiZGF0ZV9zb3J0X2NsaWNrIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZGF0ZV9zb3J0J10gPSBzZWxmLmhhc2hfbWFwWyJkYXRlX3NvcnRfY2xpY2siXQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuX3ZhbGlkYXRlX3NjcmVlbl92YWx1ZXMoKQogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgX2dldF9lcnJvcnNfdGFibGVfcm93cyhzZWxmLCBlcnJvcnNfdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICBpID0gMQogICAgICAgIGZvciByZWNvcmQgaW4gZXJyb3JzX3RhYmxlX2RhdGE6CiAgICAgICAgICAgIGVycm9yX3JvdyA9IHsia2V5IjogaSwgIm1lc3NhZ2UiOiByZWNvcmRbMF0sICJ0aW1lIjogcmVjb3JkWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBzZWxmLl9nZXRfZXJyb3JzX3RhYmxlX3Jvd19sYXlvdXQoKX0KICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoZXJyb3Jfcm93KQogICAgICAgICAgICBpICs9IDEKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9lcnJvcnNfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9yb3dzKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQktGA0LXQvNGPJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQodC+0L7QsdGJ0LXQvdC40LUnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9yb3dzCiAgICAgICAgKQogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZXJyb3JzX3RhYmxlX3Jvd19sYXlvdXQoc2VsZik6CiAgICAgICAgcm93X3ZpZXcgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdGltZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nd3JhcF9jb250ZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MAogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BtZXNzYWdlJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nd3JhcF9jb250ZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0zLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnLAogICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcsCiAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ3ZlcnRpY2FsJwogICAgICAgICAgICBzZWxmLmhlaWdodCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAibWF0Y2hfcGFyZW50IgogICAgICAgICAgICBzZWxmLlN0cm9rZVdpZHRoID0gMQoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgICAgICBzZWxmLlRleHRTaXplID0gJzE1JwogICAgICAgICAgICBzZWxmLlRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLndpZHRoID0gJ21hdGNoX3BhcmVudCcKICAgICAgICAgICAgc2VsZi5WYWx1ZSA9IHZhbHVlCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gU2V0dGluZ3MgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gRGVidWcgc2V0dGluZ3MgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBEZWJ1Z1NldHRpbmdzU2NyZWVuKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAn0J7RgtC70LDQtNC60LAnCiAgICBzY3JlZW5fbmFtZSA9ICfQntGC0LvQsNC00L7Rh9C90YvQuSDRjdC60YDQsNC9JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkRlYnVnU2VydmljZQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBkZWJ1Z19ob3N0X2lwID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlYnVnX2hvc3RfaXAnKSBvciBzZWxmLmhhc2hfbWFwWydpcF9ob3N0J10KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgKICAgICAgICAgICAgJ2lwX2hvc3QnLAogICAgICAgICAgICB7J2hpbnQnOiAnSVAt0LDQtNGA0LXRgSDQtNC70Y8g0LLRi9Cz0YDRg9C30LrQuCDQsdCw0LfRiy/Qu9C+0LPQsCcsICdkZWZhdWx0X3RleHQnOiBkZWJ1Z19ob3N0X2lwIG9yICcnfSwKICAgICAgICAgICAgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fZmlsbF9yYXRpbyc6IHNlbGYuX2ZpbGxfcmF0aW8sCiAgICAgICAgICAgICdidG5fY29weV9iYXNlJzogc2VsZi5fY29weV9iYXNlLAogICAgICAgICAgICAnYnRuX3VubG9hZF9sb2cnOiBzZWxmLl91bmxvYWRfbG9nLAogICAgICAgICAgICAnYnRuX2xvY2FsX2ZpbGVzJzogc2VsZi5fbG9jYWxfZmlsZXMsCiAgICAgICAgICAgICdidG5fdGVtcGxhdGVzJzogc2VsZi5vcGVuX3RlbXBsYXRlc19zY3JlZW4sCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9vbl9iYWNrX3ByZXNzZWQKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZmlsbF9yYXRpbyhzZWxmKToKICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgIFVQREFURSBSU19iYXJjb2RlcwogICAgICAgIFNFVCByYXRpbyA9IENPQUxFU0NFKCgKICAgICAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvciAvIFJTX3VuaXRzLmRlbm9taW5hdG9yCiAgICAgICAgICAgIEZST00gUlNfdW5pdHMKICAgICAgICAgICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICAgICAgKSwgMSknJycKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KLQsNCx0LvQuNGG0LAg0LHQsNGA0LrQvtC00L7QsiDQt9Cw0L/QvtC70L3QtdC90LAg0LfQvdCw0YfQtdC90LjRj9C80Lgg0LjQtyDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPJykKCiAgICBkZWYgX2NvcHlfYmFzZShzZWxmKToKICAgICAgICBpcF9ob3N0ID0gc2VsZi5oYXNoX21hcFsnaXBfaG9zdCddCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdzcWxpdGVfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGZpbGVfcGF0aCk6CiAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGY6CiAgICAgICAgICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2RhdGFiYXNlKGYpCgogICAgICAgICAgICAgICAgaWYgcmVzWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkdCw0LfQsCBTUUxpdGUg0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvdCwJykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScpCgogICAgZGVmIF91bmxvYWRfbG9nKHNlbGYpOgogICAgICAgIGlwX2hvc3QgPSBzZWxmLmhhc2hfbWFwWydpcF9ob3N0J10KCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdsb2dfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgICMgVE9ETyDQl9C00LXRgdGMINC90YPQttC90L4g0LHRg9C00LXRgiDQstGL0LfRi9Cy0LDRgtGMINC60LvQsNGB0YEt0YHQtdGA0LLQuNGBINC00LvRjyDQstC30LDQuNC80L7QtNC10LnRgdGC0LLQuNGPINGBIFRpbnlEQgogICAgICAgIGZyb20gdGlueWRiIGltcG9ydCBUaW55REIKCiAgICAgICAgZGIgPSBUaW55REIoZmlsZV9wYXRoKQogICAgICAgIGRhdGEgPSBkYi5hbGwoKQoKICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2xvZyhkYXRhKQogICAgICAgIGlmIHJlc1snc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cb0L7QsyDRg9GB0L/QtdGI0L3QviDQstGL0LPRgNGD0LbQtdC9JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQoKICAgIGRlZiBfbG9jYWxfZmlsZXMoc2VsZik6CiAgICAgICAgaW1wb3J0IHVpX2NzdgoKICAgICAgICBwYXRoID0gc2VsZi5oYXNoX21hcFsncGF0aCddCiAgICAgICAgZGVsZXRlX2ZpbGVzID0gc2VsZi5oYXNoX21hcFsnZGVsZXRlX2ZpbGVzJ10KCiAgICAgICAgaWYgbm90IGRlbGV0ZV9maWxlczoKICAgICAgICAgICAgZGVsZXRlX2ZpbGVzID0gJzAnCiAgICAgICAgaWYgbm90IHBhdGg6CiAgICAgICAgICAgIHBhdGggPSAnLy9zdG9yYWdlL2VtdWxhdGVkLzAvZG93bmxvYWQvJwoKICAgICAgICByZXRfdGV4dCA9IHVpX2Nzdi5saXN0X2ZvbGRlcihwYXRoLCBkZWxldGVfZmlsZXMpCgogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QocmV0X3RleHQpCgogICAgZGVmIF9vbl9iYWNrX3ByZXNzZWQoc2VsZik6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkZWJ1Z19ob3N0X2lwJywgaXBfaG9zdCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBvcGVuX3RlbXBsYXRlc19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCfQn9C10YfQsNGC0YwnLCAn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERlYnVnIHNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gQWN0aXZlQ1YgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEFjdGl2ZUNWQXJ0aWNsZVJlY29nbml0aW9uKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVicKICAgIHByb2Nlc3NfbmFtZSA9ICfQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LInCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2FydF9pbmZvJywgJ9Cd0LDQudC00LXQvdC90YvQtSDQsNGA0YLQuNC60YPQu9GLOiAnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICfQntCx0YDQsNCx0L7RgtCw0YLRjCc6CiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5wdXQoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgb25fb2JqZWN0X2RldGVjdGVkKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgY3VycmVudF9vYmplY3QgPSBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9vYmplY3QnKQogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgZmluZGVkX2FydGljbGVzID0ganNvbi5sb2FkcyhmaW5kZWRfYXJ0aWNsZXMpIGlmIGZpbmRlZF9hcnRpY2xlcyBlbHNlIFtdCiAgICAgICAgaWYgY3VycmVudF9vYmplY3Qgbm90IGluIGZpbmRlZF9hcnRpY2xlczoKICAgICAgICAgICAgZmluZGVkX2FydGljbGVzLmFwcGVuZChjdXJyZW50X29iamVjdCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICAgICAnYXJ0X2luZm8nLCAn0J3QsNC50LTQtdC90L3Ri9C1INCw0YDRgtC40LrRg9C70Ys6ICcgKyAnOycuam9pbihmaW5kZWRfYXJ0aWNsZXMpKQogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wucHV0KCdmaW5kZWRfYXJ0aWNsZXMnLCBqc29uLmR1bXBzKGZpbmRlZF9hcnRpY2xlcyksIFRydWUpCgogICAgICAgIGdvb2RfbmFtZSA9IHNlbGYuZ2V0X2dvb2RfaW5mbyhjdXJyZW50X29iamVjdCkKICAgICAgICBzZWxmLmhhc2hfbWFwLmFkZF90b19jdl9saXN0KAogICAgICAgICAgICB7J29iamVjdCc6IHN0cihjdXJyZW50X29iamVjdCksCiAgICAgICAgICAgICAnaW5mbyc6IGYn0KLQvtCy0LDRgDogPGJpZz57Z29vZF9uYW1lfTwvYmlnPid9LAogICAgICAgICAgICAnb2JqZWN0X2luZm9fbGlzdCcsIF9kaWN0PVRydWUpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfZ29vZF9pbmZvKHNlbGYsIGFydGljbGU6IHN0cikgLT4gc3RyOgogICAgICAgIHF1ZXJ5ID0gKCdTRUxFQ1QgUlNfZ29vZHMubmFtZSBhcyBuYW1lJwogICAgICAgICAgICAgICAgICcgRlJPTSBSU19kb2NzX3RhYmxlJwogICAgICAgICAgICAgICAgICcgTEVGVCBKT0lOIFJTX2dvb2RzIE9OIFJTX2RvY3NfdGFibGUuaWRfZ29vZCA9IFJTX2dvb2RzLmlkJwogICAgICAgICAgICAgICAgICcgV0hFUkUgUlNfZG9jc190YWJsZS5pZF9kb2MgPSA/IEFORCBSU19nb29kcy5hcnQgPSA/JykKICAgICAgICBnb29kcyA9IHNlbGYuc2VydmljZS5wcm92aWRlci5zcWxfcXVlcnkocXVlcnksIGYne3NlbGYuaWRfZG9jfSx7YXJ0aWNsZX0nKQogICAgICAgIHJldHVybiBnb29kc1swXVsnbmFtZSddIGlmIGdvb2RzIGVsc2UgJ9Cd0LUg0L3QsNC50LTQtdC90L4nCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNldHRpbmdzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnYXJ0aWNsZXNfb2NyX3NldHRpbmdzJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF92aXNpb25fc2V0dGluZ3MoKipqc29uLmxvYWRzKHNldHRpbmdzKSkKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEFjdGl2ZUNWIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IE9DUiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ1NlcmlhbE51bWJlck9DUlNldHRpbmdzJwogICAgcHJvY2Vzc19uYW1lID0gJ09jclRleHRSZWNvZ25pdGlvbicKICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICBvY3Jfbm9zcWxfY291bnRlciA9IG5vQ2xhc3MoIm9jcl9ub3NxbF9jb3VudGVyIikKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKICAgICAgICBzZWxmLm9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgc2VsZi5zY3JlZW5fdGl0bGUgPSAn0KjQsNCx0LvQvtC9INGA0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIFMvTicKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX21pbl9yZWNfYW1vdW50JzogJzUnLAogICAgICAgICAgICAnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JzogJzEwJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JzogJ1NOJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfY29udGludW91c19yZWNvZ25pdGlvbic6ICdmYWxzZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnOiAndHJ1ZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX2N1cnJlbnRfdGVtcGxhdGUnOiAiIgogICAgICAgIH0KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdGl0bGUpCiAgICAgICAgc2VsZi5fc2V0X3NjcmVlbl92YWx1ZXMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fc2F2ZV9vY3Jfc2V0dGluZ3MnOgogICAgICAgICAgICBpc192YWxpZCwgZXJyb3IgPSBzZWxmLl92YWxpZGF0ZV9vY3Jfc2V0dGluZ3MoKQogICAgICAgICAgICBpZiBub3QgaXNfdmFsaWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGVycm9yKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuX3NhdmVfdGVtcGxhdGVfcGF0dGVybnMoKQogICAgICAgICAgICBzZWxmLl9zYXZlX3RlbXBsYXRlX3NldHRpbmdzKCkKICAgICAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRgdC+0YXRgNCw0L3RkdC9JykKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfc2V0X3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUsIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBuZXdfdmFsdWUgPSBzZWxmLmhhc2hfbWFwLmdldCh2YWx1ZV9uYW1lKSBvciBzZWxmLm9jcl9ub3NxbC5nZXQodmFsdWVfbmFtZSkgb3IgdmFsdWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQodmFsdWVfbmFtZSwgbmV3X3ZhbHVlKQoKCiAgICBkZWYgX3NhdmVfdGVtcGxhdGVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUgaW4gc2VsZi5zY3JlZW5fdmFsdWVzOgogICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQodmFsdWVfbmFtZSwgc2VsZi5oYXNoX21hcC5nZXQodmFsdWVfbmFtZSksIFRydWUpCgogICAgZGVmIF9zYXZlX3RlbXBsYXRlX3BhdHRlcm5zKHNlbGYpOgogICAgICAgIG51bV9hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JykKICAgICAgICBwcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnKQogICAgICAgIHVzZV9wcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBpZiB1c2VfcHJlZml4ID09ICd0cnVlJzoKICAgICAgICAgICAgcGF0dGVybnMgPSBbcmYnXntwcmVmaXh9JywgcmYnKFteXGRvT10pKFxke3t7bnVtX2Ftb3VudH19fSkkJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXR0ZXJucyA9IFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGN1cnJlbnRfdGVtcGxhdGUgPSAoZifQotC10LrRg9GJ0LjQuSDRiNCw0LHQu9C+0L06IHtwcmVmaXggaWYgdXNlX3ByZWZpeCA9PSAidHJ1ZSIgZWxzZSAiIn0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ3siKiIgKiBpbnQobnVtX2Ftb3VudCl9JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2NyX3NlcmlhbF9jdXJyZW50X3RlbXBsYXRlJywgY3VycmVudF90ZW1wbGF0ZSkKICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcGF0dGVybnMnLCBqc29uLmR1bXBzKHBhdHRlcm5zKSwgVHJ1ZSkKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICAiIiLQo9GB0YLQsNC90LDQstC70LjQstCw0LXRgiDQvdCw0YHRgtGA0L7QudC60Lgg0LTQu9GPINC60L3QvtC/0LrQuCDRgNCw0YHQv9C+0LfQvdCw0LLQsNC90LjRjyDRgtC10LrRgdGC0LAiIiIKICAgICAgICBudW1fYW1vdW50ID0gaW50KHNlbGYub2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50Jykgb3IgJzEwJykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5vY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnKQogICAgICAgIGlmIHVzZV9wcmVmaXggPT0gJ3RydWUnOgogICAgICAgICAgICBwcmVmaXggPSBzZWxmLm9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICAgICAgbWluX2xlbmd0aCA9IG51bV9hbW91bnQgKyBsZW4ocHJlZml4KQogICAgICAgICAgICBtYXhfbGVuZ3RoID0gbWluX2xlbmd0aCArIDIKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaW5fbGVuZ3RoLCBtYXhfbGVuZ3RoID0gbnVtX2Ftb3VudCwgbnVtX2Ftb3VudAogICAgICAgIHZhbHVlc19saXN0ID0gKCJ+W3tcImFjdGlvblwiOlwicnVuXCIsXCJ0eXBlXCI6XCJweXRob25cIiwiCiAgICAgICAgICAgICAgICAgICAgICAgIlwibWV0aG9kXCI6XCJzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jclwifV0iKQogICAgICAgIHJlY19zZXR0aW5ncyA9IGRpY3QoCiAgICAgICAgICAgIHZhbHVlc19saXN0PXZhbHVlc19saXN0LAogICAgICAgICAgICBtYXhfbGVuZ3RoPW1heF9sZW5ndGgsCiAgICAgICAgICAgIG1pbl9sZW5ndGg9bWluX2xlbmd0aCwKICAgICAgICApCiAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsLnB1dCgnc2VyaWFsX29jcl9zZXR0aW5ncycsIGpzb24uZHVtcHMocmVjX3NldHRpbmdzKSwgVHJ1ZSkKCiAgICBkZWYgX3ZhbGlkYXRlX29jcl9zZXR0aW5ncyhzZWxmKSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgICAgICIiItCS0LDQu9C40LTQsNGG0LjRjyDQtNCw0L3QvdGL0YUg0LLQstC10LTQtdC90L3Ri9GFINCyINC00LjQsNC70L7Qs9C1INCo0LDQsdC70L7QvdCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIiIiCiAgICAgICAgbWluX3JlY19hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9taW5fcmVjX2Ftb3VudCcpCiAgICAgICAgbnVtX2Ftb3VudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnKQogICAgICAgIHByZWZpeDogc3RyID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfdXNlX3ByZWZpeCcpCiAgICAgICAgaWYgbm90IG1pbl9yZWNfYW1vdW50LmlzZGlnaXQoKSBvciBpbnQobWluX3JlY19hbW91bnQpID09IDA6CiAgICAgICAgICAgIGVycm9yID0gKCfQo9C60LDQttC40YLQtSDQutC+0YDRgNC10LrRgtC90L7QtSDQvNC40L3QuNC80LDQu9GM0L3QvtC1INC60L7Qu9C40YfQtdGB0YLQstC+JwogICAgICAgICAgICAgICAgICAgICcg0L7QsdC90LDRgNGD0LbQtdC90LjQuSDRgdC10YDQuNC50L3QvtCz0L4g0L3QvtC80LXRgNCwJykKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIGlmIG5vdCBudW1fYW1vdW50LmlzZGlnaXQoKToKICAgICAgICAgICAgZXJyb3IgPSAn0JrQvtC70LjRh9C10YHRgtCy0L4g0YbQuNGE0YAg0LIg0YjQsNCx0LvQvtC90LUg0L3QtSDQutC+0YDRgNC10LrRgtC90L4nCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZXJyb3IKICAgICAgICBpZiBub3QgMSA8IGludChudW1fYW1vdW50KSA8IDIxOgogICAgICAgICAgICBlcnJvciA9ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDRhtC40YTRgCDQsiDRiNCw0LHQu9C+0L3QtSDQtNC+0LvQttC90L4g0LHRi9GC0Ywg0LIg0LjQvdGC0LXRgNCy0LDQu9C1INC+0YIgMiDQtNC+IDIwJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4Lmlzc3BhY2UoKSBhbmQgdXNlX3ByZWZpeCA9PSAndHJ1ZSc6CiAgICAgICAgICAgIGVycm9yID0gJ9Cd0LUg0YPQutCw0LfQsNC9INC/0YDQtdGE0LjQutGBJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4ICE9IHByZWZpeC5zdHJpcCgpOgogICAgICAgICAgICBlcnJvciA9ICfQn9GA0L7QsdC10LvRiyDQsiDQvdCw0YfQsNC70LUg0LjQu9C4INCyINC60L7QvdGG0LUg0L/RgNC10YTQuNC60YHQsCcKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIHJldHVybiBUcnVlLCAnJwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jcihoYXNoX21hcDogSGFzaE1hcCkgLT4gTm9uZToKICAgICAgICAiIiLQndCw0YXQvtC00LjRgiDQsiDQv9C10YDQtdC00LDQvdC90L7QuSDQuNC3IE9DUiDRgdGC0YDQvtC60LUg0YHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGALCDQv9C+INC30LDQtNCw0L3QvdC+0LzRgyDRiNCw0LHQu9C+0L3RgyIiIgogICAgICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIgPSBub0NsYXNzKCJvY3Jfbm9zcWxfY291bnRlciIpCiAgICAgICAgb2NyX3RleHQgPSBoYXNoX21hcC5nZXQoIm9jcl90ZXh0IikKICAgICAgICB1c2VfcHJlZml4ID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBudW1fYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbnVtX2Ftb3VudCcpKSBvciAxMAogICAgICAgIHBhdHRlcm5zID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wYXR0ZXJucycpCiAgICAgICAgcGF0dGVybnMgPSBqc29uLmxvYWRzKHBhdHRlcm5zKSBpZiBwYXR0ZXJucyBlbHNlIFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGZvciBwYXR0ZXJuIGluIHBhdHRlcm5zOgogICAgICAgICAgICBtYXRjaF9udW0gPSByZS5zZWFyY2gocGF0dGVybiwgb2NyX3RleHQpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaF9udW06CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICByZXN1bHQgPSBtYXRjaF9udW0uZ3JvdXAoMikgaWYgdXNlX3ByZWZpeCA9PSAndHJ1ZScgZWxzZSBtYXRjaF9udW0uZ3JvdXAoKQogICAgICAgIG1pbl9yZWNfYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbWluX3JlY19hbW91bnQnKSkKICAgICAgICByZXN1bHRfaW5fbWVtb3J5ID0gb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHJlc3VsdCkKICAgICAgICBpZiByZXN1bHRfaW5fbWVtb3J5IGlzIE5vbmU6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIDEsIFRydWUpCiAgICAgICAgZWxpZiByZXN1bHRfaW5fbWVtb3J5IDwgbWluX3JlY19hbW91bnQ6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIHJlc3VsdF9pbl9tZW1vcnkgKyAxLCBUcnVlKQogICAgICAgIGVsaWYgcmVzdWx0X2luX21lbW9yeSA9PSBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIucHV0KHJlc3VsdCwgcmVzdWx0X2luX21lbW9yeSArIDEsIFRydWUpCiAgICAgICAgICAgIGZyb21fc2NyZWVuID0gb2NyX25vc3FsLmdldCgnZnJvbV9zY3JlZW4nKQogICAgICAgICAgICBpZiBmcm9tX3NjcmVlbiA9PSAnRmxvd0RvY0RldGFpbHNTY3JlZW4nOgogICAgICAgICAgICAgICAgZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoaGFzaF9tYXBbJ2lkX2RvYyddKS5hZGRfYmFyY29kZV90b19kYXRhYmFzZShyZXN1bHQpCiAgICAgICAgICAgIGVsaWYgZnJvbV9zY3JlZW4gPT0gJ1Nlcmllc1NlbGVjdFNjcmVlbic6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXQoIm9jcl9yZXN1bHQiLCByZXN1bHQpCiAgICAgICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdvY3JfcmVzdWx0JywgcmVzdWx0LCBUcnVlKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAOiAnICsgcmVzdWx0KQogICAgICAgICAgICBpZiBvY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX2NvbnRpbnVvdXNfcmVjb2duaXRpb24nKSA9PSAnZmFsc2UnOgogICAgICAgICAgICAgICAgaGFzaF9tYXAucHV0KCJvY3JfcmVzdWx0IiwgcmVzdWx0KQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGZvciBzZXJpYWwgaW4ganNvbi5sb2FkcyhvY3Jfbm9zcWxfY291bnRlci5nZXRhbGxrZXlzKCkpOgogICAgICAgICAgICAgICAgaWYgb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHNlcmlhbCkgPCBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgICAgICAgICBvY3Jfbm9zcWxfY291bnRlci5wdXQoc2VyaWFsLCAwLCBUcnVlKQojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBPQ1IgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gU2VydmljZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBUaW1lcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYucnNfc2V0dGluZ3MgPSByc19zZXR0aW5ncwogICAgICAgIHNlbGYuaHR0cF9zZXR0aW5ncyA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLmh0dHBfc2VydmljZSA9IEhzU2VydmljZShzZWxmLmh0dHBfc2V0dGluZ3MpCgogICAgZGVmIHRpbWVyX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3N0b3BfdGltZXJfdXBkYXRlJyk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5sb2FkX2RvY3MoKQogICAgICAgIHNlbGYuX3VwbG9hZF9kYXRhKCkKICAgICAgICBzZWxmLl91cGxvYWRfYnVmZmVyX2RhdGEoKQoKICAgIGRlZiBwdXRfbm90aWZpY2F0aW9uKHNlbGYsIHRleHQsIHRpdGxlPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKHRleHQsIHRpdGxlKQoKICAgIGRlZiBfZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCiAgICBkZWYgbG9hZF9kb2NzKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRvY3NfZGF0YSA9IHNlbGYuaHR0cF9zZXJ2aWNlLmdldF9kYXRhKCkKICAgICAgICAgICAgZGF0YSA9IGRvY3NfZGF0YS5nZXQoJ2RhdGEnKQogICAgICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLlRpbWVyU2VydmljZSgpCiAgICAgICAgICAgIG5ld19kb2N1bWVudHMgPSBzZXJ2aWNlLmdldF9uZXdfbG9hZF9kb2NzKGRhdGEpCiAgICAgICAgICAgIHNlcnZpY2Uuc2F2ZV9sb2FkX2RhdGEoZGF0YSkKICAgICAgICAgICAgIyBzZWxmLmRiX3NlcnZpY2UudXBkYXRlX2RhdGFfZnJvbV9qc29uKGRvY3NfZGF0YVsnZGF0YSddKQoKICAgICAgICAgICAgaWYgbmV3X2RvY3VtZW50czoKICAgICAgICAgICAgICAgIG5vdGlmeV90ZXh0ID0gc2VsZi5fZ2V0X25vdGlmeV90ZXh0KG5ld19kb2N1bWVudHMpCiAgICAgICAgICAgICAgICBzZWxmLnB1dF9ub3RpZmljYXRpb24odGV4dD1ub3RpZnlfdGV4dCwgdGl0bGU9ItCX0LDQs9GA0YPQttC10L3RiyDQtNC+0LrRg9C80LXQvdGC0Ys6IikKCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LI6IHtlfScpCgogICAgZGVmIF91cGxvYWRfZGF0YShzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfaHR0cF9zZXR0aW5ncygpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VydmljZSA9IFRpbWVyU2VydmljZSgpCiAgICAgICAgZGF0YSA9IHNlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmh0dHBfc2VydmljZS5zZW5kX2RhdGEoZGF0YSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS53cml0ZV9lcnJvcl9vbl9sb2coZifQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0L7Qsjoge2V9JykKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIGFuc3dlci5lcnJvcjoKICAgICAgICAgICAgIyBzZWxmLnB1dF9ub3RpZmljYXRpb24odGl0bGU9J9Ce0YjQuNCx0LrQsCDQv9GA0Lgg0L7RgtC/0YDQsNCy0LrQtSDQtNC+0LrRg9C80LXQvdGC0L7QsicsIHRleHQ9YW5zd2VyLmVycm9yX3RleHQpCiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS53cml0ZV9lcnJvcl9vbl9sb2coZifQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0L7Qsjoge2Fuc3dlci5lcnJvcl90ZXh0fScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZG9jc19saXN0X3N0cmluZyA9ICcsICcuam9pbihbZiIne2RbJ2lkX2RvYyddfSciIGZvciBkIGluIGRhdGFdKQogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UudXBkYXRlX3VwbG9hZGVkX2RvY3Nfc3RhdHVzKGRvY3NfbGlzdF9zdHJpbmcpCgogICAgZGVmIF91cGxvYWRfYnVmZmVyX2RhdGEoc2VsZik6CiAgICAgICAgIyDQmNC80Y8g0YLQsNCx0LvQuNGG0Ysg0L7Rh9C10YDQtdC00LggKNC40LzRjyDQvNC10YLQvtC00LAg0LIgdXJsIGh0dHAt0YHQtdGA0LLQuNGB0LApCiAgICAgICAgYnVmZmVyX3RhYmxlcyA9IFsKICAgICAgICAgICAgJ2JhcmNvZGVzJywKICAgICAgICAgICAgJ2RvY3VtZW50cycKICAgICAgICBdCgogICAgICAgIGZvciBidWZmZXJfdGFibGUgaW4gYnVmZmVyX3RhYmxlczoKICAgICAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKGJ1ZmZlcl90YWJsZSkKICAgICAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCgogICAgICAgICAgICBtZXRob2QgPSBzZWxmLmh0dHBfc2VydmljZS5nZXRfbWV0aG9kX2J5X3BhdGgoYnVmZmVyX3RhYmxlKQogICAgICAgICAgICBpZiBkYXRhX3RvX3NlbmQgYW5kIG1ldGhvZDoKICAgICAgICAgICAgICAgIHJlcyA9IG1ldGhvZChkYXRhX3RvX3NlbmQpCgogICAgICAgICAgICAgICAgaWYgbm90IHJlcy5lcnJvcjoKICAgICAgICAgICAgICAgICAgICBidWZmZXJfc2VydmljZS5yZW1vdmVfc2VudF9kYXRhKGRhdGFfdG9fc2VuZCkKCiAgICBkZWYgdXBsb2FkX2FsbF9kb2NzKHNlbGYpOgogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IERvY1NlcnZpY2UoKQogICAgICAgIHNlbGYudXBsb2FkX2RvY3MoKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IEFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYudXBsb2FkX2RvY3MoKQoKICAgIGRlZiBsb2FkX2FsbF9kb2NzKHNlbGYpOgogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IERvY1NlcnZpY2UoKQogICAgICAgIHNlbGYubG9hZF9kb2NzKCkKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBBZHJEb2NTZXJ2aWNlKCkKICAgICAgICBzZWxmLmxvYWRfZG9jcygpCgogICAgZGVmIHVwbG9hZF9kb2NzKHNlbGYpOgoKICAgICAgICBpZiBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHRyeToKCiAgICAgICAgICAgICAgICBkb2NzX2dvb2RzX2Zvcm1hdHRlZF9saXN0ID0gc2VsZi5kYl9zZXJ2aWNlLmdldF9kb2NzX2FuZF9nb29kc19mb3JfdXBsb2FkKCkKICAgICAgICAgICAgICAgIGlmIGRvY3NfZ29vZHNfZm9ybWF0dGVkX2xpc3Q6CiAgICAgICAgICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5odHRwX3NlcnZpY2Uuc2VuZF9kb2N1bWVudHMoZG9jc19nb29kc19mb3JtYXR0ZWRfbGlzdCkKICAgICAgICAgICAgICAgICAgICBpZiBhbnN3ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFuc3dlci5nZXQoJ0Vycm9yJykgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnB1dF9ub3RpZmljYXRpb24odGV4dD0n0J7RiNC40LHQutCwINC/0YDQuCDQvtGC0L/RgNCw0LLQutC1INC00L7QutGD0LzQtdC90YLQvtCyJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycl90ZXh0ID0gYW5zd2VyLmdldCgndGV4dCcpLmRlY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBhbnN3ZXIuZ2V0KCJFcnJvciIpIG9yICcnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LI6IHtlcnJfdGV4dH1cbntlcnJvcn0nKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jc19saXN0X3N0cmluZyA9ICcsICcuam9pbihbZiIne2RbJ2lkX2RvYyddfSciIGZvciBkIGluIGRvY3NfZ29vZHNfZm9ybWF0dGVkX2xpc3RdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnVwZGF0ZV91cGxvYWRlZF9kb2NzX3N0YXR1cyhkb2NzX2xpc3Rfc3RyaW5nKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGYn0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LI6IHtlfScpCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X25vdGlmeV90ZXh0KG5ld19kb2N1bWVudHMpOgogICAgICAgIGRvY190aXRsZXMgPSBbCiAgICAgICAgICAgICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KGl0ZW1bJ2RvY190eXBlJ10sIGl0ZW1bJ2RvY19uJ10sIGl0ZW1bJ2RvY19kYXRlJ10pCiAgICAgICAgICAgIGZvciBpdGVtIGluIG5ld19kb2N1bWVudHMudmFsdWVzKCldCiAgICAgICAgcmV0dXJuICIsICIuam9pbihkb2NfdGl0bGVzKQoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICBoc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPWhzX3NlcnZpY2UudXJsKQogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgpjbGFzcyBXZWJTZXJ2aWNlU3luY0NvbW1hbmQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYubGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmxpc3RlbmVyCgogICAgZGVmIG9uX3NlcnZpY2VfcmVxdWVzdChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2Rlcyc6IHNlbGYuZ2V0X2JhcmNvZGVzX2RhdGEsCiAgICAgICAgICAgICdoYXNoX21hcCc6IHNlbGYuZ2V0X2hhc2hfbWFwCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKCiAgICBkZWYgZ2V0X2JhcmNvZGVzX2RhdGEoc2VsZik6CiAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCiAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlSGVhZGVycycsIGhlYWRlcnMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZScsIGRhdGFfdG9fc2VuZCwgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBnZXRfaGFzaF9tYXAoc2VsZik6CiAgICAgICAgYm9keSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3dzX2JvZHknKQogICAgICAgIGlmIGJvZHk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gW10KCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UoYm9keSwgZGljdCk6CiAgICAgICAgICAgICAgICByZXNwb25zZS5hcHBlbmQoe2JvZHlbJ2l0ZW0nXTogc2VsZi5oYXNoX21hcC5nZXQoKipib2R5KX0pCiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShib2R5LCBsaXN0KToKICAgICAgICAgICAgICAgIGZvciBpdGVtIGluIGJvZHk6CiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuYXBwZW5kKHtpdGVtWydpdGVtJ106IHNlbGYuaGFzaF9tYXAuZ2V0KCoqaXRlbSl9KQoKICAgICAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlJywgcmVzcG9uc2UsIHRvX2pzb249VHJ1ZSkKCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gU2VydmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gTWFpbiBldmVudHMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBNYWluRXZlbnRzOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hfbWFwCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IHJzX3NldHRpbmdzCgogICAgZGVmIGFwcF9vbl9zdGFydChzZWxmKToKCiAgICAgICAgIyBzZWxmLmhhc2hfbWFwLnB1dCgnU3RhY2tBZGRNb2RlJywgJycpICAjINCS0LrQu9GO0YfQsNC10YIg0YDQtdC20LjQvCDQvtCx0YrQtdC00LjQvdC10L3QuNGPINC/0LXRgNC10LzQtdC90L3Ri9GFIGhhc2hfbWFwINCyINGC0LDQudC80LXRgNCw0YUKCiAgICAgICAgIyBUT0RPINCe0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L7QsdC90L7QstC70LXQvdC40Y8hCiAgICAgICAgcmVsZWFzZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdSZWxlYXNlJykgb3IgJycKICAgICAgICB0b2FzdCA9ICfQk9C+0YLQvtCyINC6INGA0LDQsdC+0YLQtScKCiAgICAgICAgY3VycmVudF9yZWxlYXNlID0gc2VsZi5oYXNoX21hcFsnX2NvbmZpZ3VyYXRpb25WZXJzaW9uJ10KICAgICAgICAjIHRvYXN0ID0gKGYn0J7QsdC90L7QstC70Y/QtdC80YHRjyDRgSB7cmVsZWFzZX0g0L3QsCB7Y3VycmVudF9yZWxlYXNlfScpCgogICAgICAgIHNlbGYuX2NyZWF0ZV90YWJsZXMoKQoKICAgICAgICBpZiBjdXJyZW50X3JlbGVhc2UgaXMgTm9uZToKICAgICAgICAgICAgdG9hc3QgPSAn0J3QtSDRg9C00LDQu9C+0YHRjCDQvtC/0YDQtdC00LXQu9C40YLRjCDQstC10YDRgdC40Y4g0LrQvtC90YTQuNCz0YPRgNCw0YbQuNC4JwoKICAgICAgICAjIHNlbGYuaGFzaF9tYXAudG9hc3QoZifQntCx0L3QvtCy0LvRj9C10LzRgdGPINGBIHtyZWxlYXNlfSDQvdCwIHtjdXJyZW50X3JlbGVhc2V9JykKICAgICAgICBpZiBjdXJyZW50X3JlbGVhc2UgYW5kIHJlbGVhc2UgIT0gY3VycmVudF9yZWxlYXNlOgogICAgICAgICAgICAjIHRvYXN0ID0gKGYn0J7QsdC90L7QstC70Y/QtdC80YHRjyDRgSB7cmVsZWFzZX0g0L3QsCB7Y3VycmVudF9yZWxlYXNlfScpCiAgICAgICAgICAgICMgcGFzcwogICAgICAgICAgICAjIGltcG9ydCB2ZXJzaW9uX2NvbnRyb2wKICAgICAgICAgICAgIyByZXN1bHRfbGlzdCA9IHZlcnNpb25fY29udHJvbC5ydW5fcmVsZWFzZXMocmVsZWFzZSwgY3VycmVudF9yZWxlYXNlKQogICAgICAgICAgICAjIGZvciBlbGVtIGluIHJlc3VsdF9saXN0OgogICAgICAgICAgICAjICAgICBpZiBub3QgZWxlbVsncmVzdWx0J106CiAgICAgICAgICAgICMgICAgICAgICBwYXNzCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdJbnN0YWxsQ29uZmlndXJhdGlvbicsICcnKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnUmVsZWFzZScsIGN1cnJlbnRfcmVsZWFzZSwgVHJ1ZSkKICAgICAgICAgICAgdG9hc3QgPSBmJ9CS0YvQv9C+0LvQvdC10L3QviDQvtCx0L3QvtCy0LvQtdC90LjQtSDQvdCwINCy0LXRgNGB0LjRjiB7Y3VycmVudF9yZWxlYXNlfScKCiAgICAgICAgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9vbGRfZG9jcycpIGlzIFRydWU6CiAgICAgICAgICAgIGRlbGV0ZWRfZG9jcyA9IHNlbGYuX2RlbGV0ZV9vbGRfZG9jcygpCiAgICAgICAgICAgIGlmIGRlbGV0ZWRfZG9jczoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKAogICAgICAgICAgICAgICAgICAgIHRleHQ9ZifQo9C00LDQu9C10L3RiyDQtNC+0LrRg9C80LXQvdGC0Ys6ICh7bGVuKGRlbGV0ZWRfZG9jcyl9KScsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YfQuNGB0YLQutCwINC90LXQsNC60YLRg9Cw0LvRjNC90YvRhSDQtNCw0L3QvdGL0YUnKQoKICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzID0gewogICAgICAgICAgICAnVGl0bGVUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJzogMTgsCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZSc6IDIwLAogICAgICAgICAgICAnQ2FyZERhdGVUZXh0U2l6ZSc6IDEwLAogICAgICAgICAgICAnQ2FyZFRleHRTaXplJzogMTUsCiAgICAgICAgICAgICdHb29kc0NhcmRUaXRsZVRleHRTaXplJzogMTgsCiAgICAgICAgICAgICdnb29kc1RleHRTaXplJzogMTgsCiAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiAxNiwKICAgICAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAxNSwKICAgICAgICAgICAgJ3NpZ25hbF9udW0nOiA1LAogICAgICAgICAgICAndXNlX21hcmsnOiAnZmFsc2UnLAogICAgICAgICAgICAnYWRkX2lmX25vdF9pbl9wbGFuJzogJ2ZhbHNlJywKICAgICAgICAgICAgJ3BhdGgnOiAnJywKICAgICAgICAgICAgJ2RlbGV0ZV9maWxlcyc6ICdmYWxzZScsCiAgICAgICAgICAgICdzdWNjZXNzX3NpZ25hbCc6IDcsCiAgICAgICAgICAgICd3YXJuaW5nX3NpZ25hbCc6IDgsCiAgICAgICAgICAgICdlcnJvcl9zaWduYWwnOiA1LAogICAgICAgICAgICAnYWxsb3dfb3ZlcnNjYW4nOiAnZmFsc2UnLAogICAgICAgICAgICAicGF0aF90b19kYXRhYmFzZXMiOiAiLi8iLAogICAgICAgICAgICAnc3FsaXRlX25hbWUnOiAnU2ltcGxlS2VlcCcsCiAgICAgICAgICAgICdsb2dfbmFtZSc6ICdsb2cuanNvbicsCiAgICAgICAgICAgICd0aW1lcl9pc19kaXNhYmxlZCc6IEZhbHNlLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCc6IEZhbHNlLAogICAgICAgICAgICAnb2ZmbGluZV9tb2RlJzogRmFsc2UsCiAgICAgICAgICAgICdkZWxldGVfb2xkX2RvY3MnOiBGYWxzZQogICAgICAgIH0KCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy8nKTogICMg0LvQvtC60LDQu9GM0L3QvgogICAgICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzWydwYXRoX3RvX2RhdGFiYXNlcyddID0gJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcycKICAgICAgICBlbHNlOgogICAgICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzWydwYXRoX3RvX2RhdGFiYXNlcyddID0gIi4vIiAgIyBEOlxQeXRob25Qcm9qZWN0c1xSaWdodFNjYW5cU1VJX25vUG9ueVwKCiAgICAgICAgZm9yIGssIHYgaW4gcnNfZGVmYXVsdF9zZXR0aW5ncy5pdGVtcygpOgogICAgICAgICAgICBpZiBzZWxmLnJzX3NldHRpbmdzLmdldChrKSBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoaywgdiwgVHJ1ZSkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsiU1FMQ29ubmVjdERhdGFiYXNlIl0gPSAiU2ltcGxlS2VlcCIKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHRvYXN0KQoKICAgIGRlZiBvbl9zcWxfZXJyb3Ioc2VsZik6CiAgICAgICAgc3FsX2Vycm9yID0gc2VsZi5oYXNoX21hcFsnU1FMRXJyb3InXQogICAgICAgIGlmIHNxbF9lcnJvcjoKICAgICAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgICAgICBzZXJ2aWNlLndyaXRlX2Vycm9yX29uX2xvZyhmJ1NRTF9FcnJvcjoge3NxbF9lcnJvcn0nKQoKICAgIGRlZiBfY3JlYXRlX3RhYmxlcyhzZWxmKToKICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuRGJDcmVhdG9yKCkKICAgICAgICBzZXJ2aWNlLmNyZWF0ZV90YWJsZXMoKQoKICAgIGRlZiBfZGVsZXRlX29sZF9kb2NzKHNlbGYpIC0+IGxpc3Q6CiAgICAgICAgZGF5cyA9IGludChzZWxmLnJzX3NldHRpbmdzLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykpCiAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgIHJldHVybiBzZXJ2aWNlLmRlbGV0ZV9vbGRfZG9jcyhkYXlzKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIE1haW4gZXZlbnRzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTY3JlZW5zRmFjdG9yeToKICAgIHNjcmVlbnMgPSBbR29vZHNTZWxlY3RTY3JlZW4sCiAgICAgICAgSHRtbFZpZXcsCiAgICAgICAgVGVtcGxhdGVzTGlzdCwKICAgICAgICBBZHJEb2NzTGlzdFNjcmVlbiwKICAgICAgICBBZHJEb2NEZXRhaWxzU2NyZWVuLAogICAgICAgIEZsb3dUaWxlc1NjcmVlbiwKICAgICAgICBGbG93RG9jU2NyZWVuLAogICAgICAgIEZsb3dEb2NEZXRhaWxzU2NyZWVuLAogICAgICAgIEdyb3VwU2NhblRpbGVzLAogICAgICAgIERvY3VtZW50c1RpbGVzLAogICAgICAgIEdyb3VwU2NhbkRvY3NMaXN0U2NyZWVuLAogICAgICAgIERvY3VtZW50c0RvY3NMaXN0U2NyZWVuLAogICAgICAgIEdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcsCiAgICAgICAgR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbiwKICAgICAgICBEb2N1bWVudHNEb2NEZXRhaWxTY3JlZW4sCiAgICAgICAgRXJyb3JMb2dTY3JlZW4sCiAgICAgICAgRGVidWdTZXR0aW5nc1NjcmVlbiwKICAgICAgICBIdHRwU2V0dGluZ3NTY3JlZW4sCiAgICAgICAgU2V0dGluZ3NTY3JlZW4sCiAgICAgICAgR29vZHNMaXN0U2NyZWVuLAogICAgICAgIFNlbGVjdEdvb2RzVHlwZSwKICAgICAgICBJdGVtQ2FyZCwKICAgICAgICBGb250U2l6ZVNldHRpbmdzU2NyZWVuLAogICAgICAgIEJhcmNvZGVUZXN0U2NyZWVuLAogICAgICAgIFNvdW5kU2V0dGluZ3MsCiAgICAgICAgR29vZHNCYWxhbmNlc0l0ZW1DYXJkLAogICAgICAgIEdvb2RzUHJpY2VzSXRlbUNhcmQsCiAgICBdCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF9zY3JlZW5fY2xhc3Moc2NyZWVuX25hbWU9Tm9uZSwgcHJvY2Vzcz1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IHNjcmVlbl9uYW1lOgogICAgICAgICAgICBzY3JlZW5fbmFtZSA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIGlmIG5vdCBwcm9jZXNzOgogICAgICAgICAgICBwcm9jZXNzID0ga3dhcmdzWydoYXNoX21hcCddLmdldF9jdXJyZW50X3Byb2Nlc3MoKQoKICAgICAgICBmb3IgaXRlbSBpbiBTY3JlZW5zRmFjdG9yeS5zY3JlZW5zOgogICAgICAgICAgICBpZiBnZXRhdHRyKGl0ZW0sICdzY3JlZW5fbmFtZScpID09IHNjcmVlbl9uYW1lIGFuZCBnZXRhdHRyKGl0ZW0sICdwcm9jZXNzX25hbWUnKSA9PSBwcm9jZXNzOgogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlX3NjcmVlbihzY3JlZW5fbmFtZT1Ob25lLCBwcm9jZXNzPU5vbmUsICoqa3dhcmdzKToKICAgICAgICBpZiBub3Qgc2NyZWVuX25hbWU6CiAgICAgICAgICAgIHNjcmVlbl9uYW1lID0ga3dhcmdzWydoYXNoX21hcCddLmdldF9jdXJyZW50X3NjcmVlbigpCiAgICAgICAgaWYgbm90IHByb2Nlc3M6CiAgICAgICAgICAgIHByb2Nlc3MgPSBrd2FyZ3NbJ2hhc2hfbWFwJ10uZ2V0X2N1cnJlbnRfcHJvY2VzcygpCgogICAgICAgIHNjcmVlbl9jbGFzcyA9IFNjcmVlbnNGYWN0b3J5LmdldF9zY3JlZW5fY2xhc3Moc2NyZWVuX25hbWUsIHByb2Nlc3MpCiAgICAgICAgcmV0dXJuIHNjcmVlbl9jbGFzcygqKmt3YXJncykKCgpjbGFzcyBNb2NrU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICdNb2NrJwogICAgcHJvY2Vzc19uYW1lID0gJ01vY2snCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpkZWYgc2V0X2N1cnJlbnRfc2NyZWVuKHNjcmVlbik6CiAgICBnbG9iYWwgY3VycmVudF9zY3JlZW4KICAgIGN1cnJlbnRfc2NyZWVuID0gc2NyZWVuCiAgICByZXR1cm4gY3VycmVudF9zY3JlZW4KCmRlZiBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwOiBIYXNoTWFwLCBzY3JlZW5fY2xhc3M9Tm9uZSwgc2NyZWVuX3ZhbHVlcz1Ob25lKToKICAgICIiIgogICAg0JzQtdGC0L7QtCDQtNC70Y8g0L/QvtC70YPRh9C10L3QuNGPINC80L7QtNC10LvQuCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10Lkg0YLQtdC60YPRidC10LzRgyDQv9GA0L7RhtC10YHRgdGDINC4INGN0LrRgNCw0L3Rgy4KICAgINCV0YHQu9C4INC80L7QtNC10LvRjCDQvdC1INGA0LXQsNC70LjQt9C+0LLQsNC90LAg0LLQvtC30LLRgNCw0YnQsNC10YIg0LfQsNCz0LvRg9GI0LrRgwogICAg0KDQtdCw0LvQuNC30L7QstCw0L0g0YHQuNC90LPQu9GC0L7QvSDRh9C10YDQtdC3INCz0LvQvtCx0LDQu9GM0L3Rg9GOINC/0LXRgNC10LzQtdC90L3Rg9GOIGN1cnJlbnRfc2NyZWVuLCDQtNC70Y8g0YHQvtGF0YDQtdC90LXQvdC40Y8g0YHQvtGB0YLQvtGP0L3QuNGPINGC0LXQutGD0YnQtdCz0L4g0Y3QutGA0LDQvdCwCiAgICAiIiIKICAgIGdsb2JhbCBjdXJyZW50X3NjcmVlbgoKICAgIHNjcmVlbl9wYXJhbXMgPSB7CiAgICAgICAgJ2hhc2hfbWFwJzogaGFzaF9tYXAsCiAgICAgICAgJ3JzX3NldHRpbmdzJzogX3JzX3NldHRpbmdzCiAgICB9CgogICAgaWYgc2NyZWVuX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgc2NyZWVuX2NsYXNzID0gU2NyZWVuc0ZhY3RvcnkuZ2V0X3NjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCgogICAgaWYgbm90IHNjcmVlbl9jbGFzczoKICAgICAgICBjdXJyZW50X3NjcmVlbiA9IE1vY2tTY3JlZW4oKipzY3JlZW5fcGFyYW1zKQogICAgZWxpZiB0eXBlKGN1cnJlbnRfc2NyZWVuKSAhPSBzY3JlZW5fY2xhc3M6CiAgICAgICAgaWYgc2NyZWVuX3ZhbHVlczoKICAgICAgICAgICAgaGFzaF9tYXAucHV0X2RhdGEoc2NyZWVuX3ZhbHVlcykKICAgICAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCiAgICBlbHNlOgogICAgICAgIGN1cnJlbnRfc2NyZWVuLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBjdXJyZW50X3NjcmVlbi5saXN0ZW5lciA9IGhhc2hfbWFwWydsaXN0ZW5lciddCiAgICAgICAgY3VycmVudF9zY3JlZW4uZXZlbnQgPSBoYXNoX21hcFsnZXZlbnQnXQoKICAgIGlmIGN1cnJlbnRfc2NyZWVuLmZpbmlzaF9wcm9jZXNzOgogICAgICAgIGZpbmlzaF9zY3JlZW4gPSBjdXJyZW50X3NjcmVlbgogICAgICAgIGN1cnJlbnRfc2NyZWVuID0gTm9uZQogICAgICAgIHJldHVybiBmaW5pc2hfc2NyZWVuCgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\ui_utils.py",
                "PyFileKey": "ui_utils",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzb2NrZXQKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzLCBhc2RpY3QKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBVbmlvbiwgTGlzdCwgRGljdCwgTGl0ZXJhbCwgT3B0aW9uYWwsIFR1cGxlCgpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBEb2NTZXJ2aWNlLCBCYXJjb2RlU2VydmljZQpmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwpmcm9tIHVpX2dsb2JhbCBpbXBvcnQgUnNfZG9jLCBmaW5kX2JhcmNvZGVfaW5fYmFyY29kZV90YWJsZQoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBIYXNoTWFwOgogICAgIiIiCiAgICAgICAg0JrQu9Cw0YHRgS3QtNC10LrQvtGA0LDRgtC+0YAg0LTQu9GPINGD0LTQvtCx0L3QvtC5INGA0LDQsdC+0YLRiyDRgSBoYXNoTWFwLiDQotCw0LrQttC1INC80L7QttC90L4g0LTQvtCx0LDQstC40YLRjCDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Rg9GOINC70L7Qs9C40LrRgy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcD1Ob25lLCBkZWJ1ZzogYm9vbCA9IEZhbHNlKToKICAgICAgICBzZWxmLmxpc3RlbmVyID0gTm9uZQogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYuZGVidWdfbW9kZSA9IGRlYnVnCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIGZ1bmM6IENhbGxhYmxlWy4uLiwgTm9uZV0pOgogICAgICAgIEB3cmFwcyhmdW5jKQogICAgICAgIGRlZiB3cmFwcGVyKGhhc2hNYXAsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHNlbGYuaW5pdChoYXNoTWFwKQogICAgICAgICAgICBmdW5jKHNlbGYpCiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgZGVmIGluaXQoc2VsZiwgaGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hNYXAKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3NfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCgogICAgQHByb3BlcnR5CiAgICBkZWYgbGlzdGVuZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2xpc3RlbmVyJ10KCiAgICBAbGlzdGVuZXIuc2V0dGVyCiAgICBkZWYgbGlzdGVuZXIoc2VsZiwgdik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzZXRfcmVzdWx0X2xpc3RlbmVyKHNlbGYsIGxpc3RlbmVyKToKICAgICAgICBpZiBsaXN0ZW5lciBhbmQgaXNpbnN0YW5jZShsaXN0ZW5lciwgc3RyKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgbGlzdGVuZXIpCgogICAgZGVmIHRvYXN0KHNlbGYsIHRleHQsIGFkZF90b19sb2c9RmFsc2UpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsIHN0cih0ZXh0KSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBub3RpZmljYXRpb24oc2VsZiwgdGV4dCwgdGl0bGU9Tm9uZSwgYWRkX3RvX2xvZz1GYWxzZSk6CiAgICAgICAgbm90aWZpY2F0aW9uX2lkID0gcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSArIDEgaWYgcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSBlbHNlIDEKICAgICAgICBpZiB0aXRsZSBpcyBOb25lOgogICAgICAgICAgICB0aXRsZSA9IHNlbGYuZ2V0X2N1cnJlbnRfc2NyZWVuKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJiYXNpY19ub3RpZmljYXRpb24iLAogICAgICAgICAgICBqc29uLmR1bXBzKFt7J251bWJlcic6IG5vdGlmaWNhdGlvbl9pZCwgJ3RpdGxlJzogc3RyKHRpdGxlKSwgJ21lc3NhZ2UnOiB0ZXh0fV0pCiAgICAgICAgKQoKICAgICAgICByc19zZXR0aW5ncy5wdXQoIm5vdGlmaWNhdGlvbl9pZCIsIG5vdGlmaWNhdGlvbl9pZCwgVHJ1ZSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBkZWJ1ZyhzZWxmLCB0ZXh0KToKICAgICAgICBpZiBzZWxmLmRlYnVnX21vZGU6CiAgICAgICAgICAgIHNlbGYudG9hc3QodGV4dCwgYWRkX3RvX2xvZz1UcnVlKQoKICAgIGRlZiByZWZyZXNoX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgIGRlZiBydW5fZXZlbnQoc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSkpCgogICAgZGVmIHJ1bl9ldmVudF9hc3luYyhzZWxmLCBtZXRob2RfbmFtZSwgcG9zdF9leGVjdXRlX21ldGhvZD1Ob25lKToKICAgICAgICBydW5fZXZlbnQgPSBzZWxmLl9nZXRfZXZlbnQobWV0aG9kX25hbWUsICdydW5hc3luYycpCiAgICAgICAgaWYgcG9zdF9leGVjdXRlX21ldGhvZDoKICAgICAgICAgICAgcnVuX2V2ZW50WzBdWydwb3N0RXhlY3V0ZSddID0ganNvbi5kdW1wcyhzZWxmLl9nZXRfZXZlbnQocG9zdF9leGVjdXRlX21ldGhvZCkpCiAgICAgICAgc2VsZlsnUnVuRXZlbnQnXSA9IGpzb24uZHVtcHMocnVuX2V2ZW50KQoKICAgIGRlZiBydW5fZXZlbnRfcHJvZ3Jlc3Moc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSwgJ3J1bnByb2dyZXNzJykpCgogICAgZGVmIGJlZXAoc2VsZiwgdG9uZT0nJyk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JlZXAnLCBzdHIodG9uZSkpCgogICAgZGVmIHBsYXlzb3VuZChzZWxmLCBldmVudDogc3RyLCBzb3VuZF92YWw6IHN0ciA9ICcnKToKICAgICAgICBpZiBub3Qgc291bmRfdmFsOgogICAgICAgICAgICBzb3VuZCA9IHJzX3NldHRpbmdzLmdldChmJ3tldmVudH1fc2lnbmFsJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzb3VuZCA9IHNvdW5kX3ZhbAogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYncGxheXNvdW5kX3tzb3VuZH0nLCAiIikKCiAgICBkZWYgX2dldF9ldmVudChzZWxmLCBtZXRob2RfbmFtZSwgYWN0aW9uPU5vbmUpOgogICAgICAgICIiIgogICAgICAgIDpwYXJhbSBtZXRob2RfbmFtZTogaGFuZGxlcnMgbmFtZQogICAgICAgIDpwYXJhbSBhY3Rpb246IHJ1bnxydW5hc3luY3xydW5wcm9ncmVzcwoKICAgICAgICA6cmV0dXJuOiBldmVudCBkaWN0CiAgICAgICAgIiIiCgogICAgICAgIGV2dCA9IFt7CiAgICAgICAgICAgICdhY3Rpb24nOiBhY3Rpb24gaWYgYWN0aW9uIGVsc2UgJ3J1bicsCiAgICAgICAgICAgICd0eXBlJzogJ3B5dGhvbicsCiAgICAgICAgICAgICdtZXRob2QnOiBtZXRob2RfbmFtZSwKICAgICAgICB9XQoKICAgICAgICByZXR1cm4gZXZ0CgogICAgZGVmIGVycm9yX2xvZyhzZWxmLCBlcnJfZGF0YSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBlcnJfZGF0YSA9IGpzb24uZHVtcHMoZXJyX2RhdGEsIGVuc3VyZV9hc2NpaT1GYWxzZSwgaW5kZW50PTIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBlcnJfZGF0YSA9IHN0cihlcnJfZGF0YSkKCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdlcnJvcl9sb2cnLCBlcnJfZGF0YSwgVHJ1ZSkKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaXRlbSk6CiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0KGl0ZW0sIEZhbHNlKQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBzZWxmLnB1dChrZXksIHZhbHVlLCBGYWxzZSkKCiAgICBkZWYgZ2V0KHNlbGYsIGl0ZW0sIGZyb21fanNvbj1GYWxzZSk6CiAgICAgICAgaWYgZnJvbV9qc29uOgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldChpdGVtKSkgaWYgc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkgZWxzZSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pCgogICAgZGVmIGdldF9qc29uKHNlbGYsIGl0ZW0pOgogICAgICAgIHJldHVybiBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pKSBpZiBzZWxmLmhhc2hfbWFwLmdldChpdGVtKSBlbHNlIE5vbmUKCiAgICBkZWYgZ2V0X2Jvb2woc2VsZiwgaXRlbSk6CiAgICAgICAgdmFsdWUgPSBzdHIoc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkpLmxvd2VyKCkgbm90IGluICgnMCcsICdmYWxzZScsICdub25lJykKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgcHV0KHNlbGYsIGtleSwgdmFsdWU6IFVuaW9uW3N0ciwgTGlzdCwgRGljdCwgYm9vbF0gPSAnJywgdG9fanNvbj1GYWxzZSk6CiAgICAgICAgaWYgdG9fanNvbjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoa2V5LCBqc29uLmR1bXBzKHZhbHVlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBib29sKToKICAgICAgICAgICAgICAgIHZhbHVlID0gc3RyKHZhbHVlKS5sb3dlcigpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGtleSwgc3RyKHZhbHVlKSkKCiAgICBkZWYgcHV0X2RhdGEoc2VsZiwgZGF0YTogZGljdCk6CiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4gZGF0YS5pdGVtcygpOgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gdmFsdWUKCiAgICBkZWYgY29udGFpbnNLZXkoc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5jb250YWluc0tleShrZXkpCgogICAgZGVmIGtleV9zZXQoc2VsZikgLT4gc3RyOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmtleVNldCgpCgogICAgZGVmIGtleXMoc2VsZikgLT4gTGlzdFtzdHJdOgogICAgICAgIGtleXMgPSBzdHIoc2VsZi5rZXlfc2V0KCkpCiAgICAgICAgcmV0dXJuIGtleXNbMTpsZW4oa2V5cyktMV0uc3BsaXQoJywgJykKCiAgICBkZWYgaXRlbXMoc2VsZikgLT4gTGlzdFtUdXBsZVtzdHIsIE9wdGlvbmFsW3N0cl1dXToKICAgICAgICByZXR1cm4gWyhrZXksIHNlbGZba2V5XSkgZm9yIGtleSBpbiBzZWxmLmtleXMoKV0KCiAgICBkZWYgc2hvd19pdGVtcygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgb25seTogT3B0aW9uYWxbTGlzdFtzdHJdXSA9IE5vbmUsCiAgICAgICAgICAgIGV4Y2x1ZGU6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgICAgICAgICBpc192YWx1ZV9leGlzdHM6IGJvb2wgPSBGYWxzZSwKICAgICkgLT4gTm9uZToKICAgICAgICB0ZXh0ID0gJ9Ch0L/QuNGB0L7QuiDRjdC70LXQvNC10L3RgtC+0LIgSGFzaE1hcDogXG4nCiAgICAgICAgaWYgaXNfdmFsdWVfZXhpc3RzOgogICAgICAgICAgICB0ZXh0ICs9ICdUcnVlINC10YHQu9C4INC10YHRgtGMINC70Y7QsdC+0LUg0LfQvdCw0YfQtdC90LjQtSBcbicKICAgICAgICBoYXNobWFwX2tleXMgPSBzZWxmLmtleXMoKQogICAgICAgIGl0ZW1zID0gc2VsZi5pdGVtcygpCiAgICAgICAgaWYgb25seToKICAgICAgICAgICAgaXRlbXMgPSBbaXRlbSBmb3IgaXRlbSBpbiBpdGVtcyBpZiBpdGVtWzBdIGluIG9ubHldCiAgICAgICAgICAgIGZvciBrZXkgaW4gb25seToKICAgICAgICAgICAgICAgIGlmIGtleSBub3QgaW4gaGFzaG1hcF9rZXlzOgogICAgICAgICAgICAgICAgICAgIGl0ZW1zLmFwcGVuZCgoa2V5LCAn0J3QtdGCINC60LvRjtGH0LAnKSkKICAgICAgICBpZiBleGNsdWRlOgogICAgICAgICAgICBpdGVtcyA9IFtpdGVtIGZvciBpdGVtIGluIGl0ZW1zIGlmIGl0ZW1bMF0gbm90IGluIGV4Y2x1ZGVdCgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIGlmIG5vdCBpc192YWx1ZV9leGlzdHMgZWxzZSB2YWx1ZSBpcyBub3QgTm9uZQogICAgICAgICAgICB0ZXh0ICs9IGYne2tleX06IHt2YWx1ZX1cbicKICAgICAgICBzZWxmLnRvYXN0KHRleHQpCgoKICAgIGRlZiByZW1vdmUoc2VsZiwga2V5KToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShrZXkpCgogICAgZGVmIGRlbGV0ZShzZWxmLCBrZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgYWRkX3RvX2N2X2xpc3QoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGVsZW1lbnQ6IFVuaW9uW3N0ciwgZGljdF0sCiAgICAgICAgICAgIGN2X2xpc3Q6IExpdGVyYWxbJ2dyZWVuX2xpc3QnLCAneWVsbG93X2xpc3QnLCAncmVkX2xpc3QnLCAnZ3JheV9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmx1ZV9saXN0JywgJ2hpZGRlbl9saXN0JywgJ29iamVjdF9pbmZvX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdG9wX2xpc3RlbmVyX2xpc3QnLCAnb2JqZWN0X2NhcHRpb25fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdF9kZXRlY3Rvcl9tb2RlJ10sCiAgICAgICAgICAgIF9kaWN0OiBib29sID0gRmFsc2UKICAgICkgLT4gTm9uZToKICAgICAgICAiIiIg0JTQvtCx0LDQstC70Y/QtdGCINCyIGN2LdGB0L/QuNGB0L7QuiDRjdC70LXQvNC10L3Rgiwg0LjQu9C4INGB0L7Qt9C00LDQtdGCINC90L7QstGL0Lkg0YHQv9C40YHQvtC6INGBINGN0YLQuNC8INGN0LvQtdC80LXQvdGC0L7QvC4KICAgICAgICAgICAgb2JqZWN0X2luZm9fbGlzdCAtINCY0L3RhNC+0YDQvNCw0YbQuNGPINC+0LEg0L7QsdGK0LXQutGC0LUgKNGB0L3QuNC30YMpLiBbeydvYmplY3QnOiBvYmplY3RfaWQ6IHN0ciwgJ2luZm8nOiB2YWx1ZX1dCiAgICAgICAgICAgIG9iamVjdF9kZXRlY3Rvcl9tb2RlIC0g0KDQtdC20LjQvCDQtNC10YLQtdC60YLQvtGA0LAuIFt7J29iamVjdF9pZCc6IG9iamVjdF9pZDogaW50LCAnbW9kZSc6IGJhcmNvZGV8b2NyfHN0b3B9XQogICAgICAgICAgICBvYmplY3RfY2FwdGlvbl9saXN0IC0g0JjQvdGE0L7RgNC80LDRhtC40Y8g0L7QsSDQvtCx0YrQtdC60YLQtSAo0YHQstC10YDRhdGDKS4gW3snb2JqZWN0Jzogb2JqZWN0X2lkOiBzdHIsICdjYXB0aW9uJzogdmFsdWV9XQogICAgICAgICAgICBzdG9wX2xpc3RlbmVyX2xpc3QgLSDQkdC70L7QutC40YDRg9C10YIg0LLRi9C/0L7Qu9C90LjQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LIg0LTQu9GPINC+0LHRitC10LrRgtC+0LIg0LIg0YHQv9C40YHQutC1CiAgICAgICAgIiIiCgogICAgICAgIGlmIF9kaWN0OgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0LCBmcm9tX2pzb249VHJ1ZSkgb3IgW10KICAgICAgICAgICAgaWYgZWxlbWVudCBub3QgaW4gbHN0OgogICAgICAgICAgICAgICAgbHN0LmFwcGVuZChlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwganNvbi5kdW1wcyhsc3QsIGVuc3VyZV9hc2NpaT1GYWxzZSkpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QpCiAgICAgICAgICAgIGxzdCA9IGxzdC5zcGxpdCgnOycpIGlmIGxzdCBlbHNlIFtdCiAgICAgICAgICAgIGlmIGVsZW1lbnQgbm90IGluIGxzdDoKICAgICAgICAgICAgICAgIGxzdC5hcHBlbmQoZWxlbWVudCkKICAgICAgICAgICAgICAgIHNlbGYucHV0KGN2X2xpc3QsICc7Jy5qb2luKGxzdCkpCgogICAgZGVmIHJlbW92ZV9mcm9tX2N2X2xpc3QoCiAgICAgICAgc2VsZiwKICAgICAgICBlbGVtZW50OiBVbmlvbltzdHIsIGRpY3RdLAogICAgICAgIGN2X2xpc3Q6IExpdGVyYWxbJ2dyZWVuX2xpc3QnLCAneWVsbG93X2xpc3QnLCAncmVkX2xpc3QnLCAnZ3JheV9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICdibHVlX2xpc3QnLCAnaGlkZGVuX2xpc3QnLCAnb2JqZWN0X2luZm9fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAnc3RvcF9saXN0ZW5lcl9saXN0JywgJ29iamVjdF9jYXB0aW9uX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdF9kZXRlY3Rvcl9tb2RlJ10sCiAgICAgICAgX2RpY3Q6IGJvb2wgPSBGYWxzZQogICAgKToKICAgICAgICAiIiLQo9C00LDQu9GP0LXRgiDQuNC3IGN2LdGB0L/QuNGB0LrQsCIiIgogICAgICAgIGlmIF9kaWN0OgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0LCBmcm9tX2pzb249VHJ1ZSkgb3IgW10KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbHN0LnJlbW92ZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwganNvbi5kdW1wcyhsc3QsIGVuc3VyZV9hc2NpaT1GYWxzZSkpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QpCiAgICAgICAgICAgIGxzdCA9IGxzdC5zcGxpdCgnOycpIGlmIGxzdCBlbHNlIFtdCiAgICAgICAgICAgIGlmIGVsZW1lbnQgaW4gbHN0OgogICAgICAgICAgICAgICAgbHN0LnJlbW92ZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwgJzsnLmpvaW4obHN0KSkKCiAgICBkZWYgc2V0X3Zpc2lvbl9zZXR0aW5ncygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgdmFsdWVzX2xpc3Q6IHN0ciwKICAgICAgICAgICAgdHlwZV9yZWM6IHN0ciA9ICdUZXh0JywKICAgICAgICAgICAgTnVtYmVyUmVjb2duaXRpb246IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgRGF0ZVJlY29nbml0aW9uOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgIFBsYXRlTnVtYmVyUmVjb2duaXRpb246IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgbWluX2xlbmd0aDogaW50ID0gMSwKICAgICAgICAgICAgbWF4X2xlbmd0aDogaW50ID0gMjAsCiAgICAgICAgICAgIHJlc3VsdF92YXI6IHN0ciA9ICdvY3JfcmVzdWx0JywKICAgICAgICAgICAgbWVzdXJlX3F0eTogaW50ID0gMSwKICAgICAgICAgICAgbWluX2ZyZXE6IGludCA9IDEsCiAgICAgICAgICAgIHF1ZXJ5OiBzdHIgPSAnJywKICAgICAgICAgICAgY29udHJvbF9maWVsZDogc3RyID0gJycsCiAgICAgICAgICAgIGN1cnNvcjogT3B0aW9uYWxbbGlzdF0gPSBOb25lLAogICAgICAgICAgICBjb3VudF9vYmplY3RzOiBpbnQgPSAwLAogICAgICAgICAgICBSZXBsYWNlTzogYm9vbCA9IEZhbHNlLAogICAgICAgICAgICBUb1VwY2FzZTogYm9vbCA9IEZhbHNlLAogICAgKToKICAgICAgICAiIiJxdWVyeSAtIFNRTCDQt9Cw0L/RgNC+0YEg0LTQu9GPINCy0LDRgNC40LDQvdGC0LAg0L/QvtC40YHQutCwINC/0L4gU1FMLdGC0LDQsdC70LjRhtC1INGBINC+0LTQuNC90Lwg0L/QsNGA0LDQvNC10YLRgNC+0Lwo0LIg0LrQvtGC0L7RgNGL0Lkg0L/QtdGA0LXQtNCw0LXRgtGB0Y8g0YDQsNGB0L/QvtC30L3QsNC90L3Ri9C5INGC0LXQutGB0YIgKQogICAgICAgICAgICAgICAg0J3QsNC/0YDQuNC80LXRgDogc2VsZWN0ICogZnJvbSBTV19Hb29kcyB3aGVyZSBwcm9kdWN0X251bWJlciBsaWtlICA/CiAgICAgICAgICAgY29udHJvbF9maWVsZCAtINC/0L7Qu9C1INGC0LDQsdC70LjRhtGLINC/0L4g0LrQvtGC0L7RgNC+0LzRgyDQv9GA0L7QstC10YDRj9C10YLRgdGPIE9DUiAsINGD0YHQu9C+0LLQvdC+INCQ0YDRgtC40LrRg9C7ICjQvdC10YHQvNC+0YLRgNGPINC90LAg0YLQviwg0YfRgtC+INCyIHF1ZXJ5INC+0L3QviDRgdC60L7RgNC10LUg0LLRgdC10LPQviDRgtCw0LrQttC1INGD0YfQsNGB0YLQstGD0LXRgikKICAgICAgICAgICBjdXJzb3IgLSDQnNCw0YHRgdC40LIgINGBINC+0LHRitC10LrRgtCw0LzQuCB7ImZpZWxkIjo80L/QvtC70LUg0YLQsNCx0LvQuNGG0Ys+LCJ2YXIiOjzQv9C10YDQtdC80LXQvdC90LDRjyDRgNC10LfRg9C70YzRgtCw0YI+fQogICAgICAgICAgIHZhbHVlc19saXN0IC0g0KDQtdC20LjQvCDQv9C+0LjRgdC60LAg0L/QviDRgdC/0LjRgdC60YMsINC70LjQsdC+INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QvCAoIn4iKQogICAgICAgICAgIG1lc3VyZV9xdHkgLSDQmtC+0LvQuNGH0LXRgdGC0LLQviDQuNC30LzQtdGA0LXQvdC40Lkg0L/Qu9C+0YLQvdC+0YHRgtC4INCy0LXRgNC+0Y/RgtC90L7RgdGC0LggKNC90L7RgNC8LiDRgNCw0YHQv9GA0LXQtNC10LvQtdC90LjQtSkKICAgICAgICAgICBtaW5fZnJlcSAtINCS0LXRgNC+0Y/RgtC90L7RgdGC0YwgKNCyINC/0YDQvtGG0LXQvdGC0LDRhSDQvtGCIDAg0LTQviAxMDAg0LTQu9GPINGD0LTQvtCx0YHRgtCy0LAg0LLQstC+0LTQsCkKICAgICAgICAgICBtaW5fbGVuZ3RoIC0g0JzQuNC90LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINGC0LXQutGB0YLQsAogICAgICAgICAgIG1heF9sZW5ndGggLSDQnNCw0LrRgdC40LzQsNC70YzQvdCw0Y8g0LTQu9C40L3QsCDRgtC10LrRgdGC0LAKICAgICAgICAgICBjb3VudF9vYmplY3RzIC0g0JTQu9GPIE51bWJlclJlY29nbml0aW9uINC60L7Qu9C40YfQtdGB0YLQstC+INGG0LjQutC70L7QsiDQuNC30LzQtdGA0LXQvdC40Lkg0LTQu9GPINGA0LXRiNC10L3QuNGPINC60L7QvNCx0LjQvdCw0YLQvtGA0L3QvtC5INC30LDQtNCw0YfQuC4g0KfQtdC8INCx0L7Qu9GM0YjQtSDRhtC40LrQu9C+0LIg0YLQtdC8INCx0L7Qu9GM0YjQtSDRgtC+0YfQvdC+0YHRgtGMCiAgICAgICAgICAgUmVwbGFjZU8gLSDQl9Cw0LzQtdC90LjRgtGMINCx0YPQutCy0Ysg0J4g0L3QsCAwICjQvdGD0LvQuCkKICAgICAgICAgICBUb1VwY2FzZSAtINCf0YDQtdC+0LHRgNCw0LfQvtCy0LDQvdC40LUg0LIg0LLQtdGA0YXQvdC40Lkg0YDQtdCz0LjRgdGC0YAKICAgICAgICAgICBQbGF0ZU51bWJlclJlY29nbml0aW9uIC0g0KDQvtGB0YHQuNC50YHQutC40LUg0L3QvtC80LXRgNCwICjRgtC+0LvRjNC60L4g0LTQu9GPIEFjdGl2ZUNWKQogICAgICAgICAgIE51bWJlclJlY29nbml0aW9uIC0g0KDQsNGB0L/QvtC30L3QsNCy0LDQvdC40LUg0YfQuNGB0LXQuwogICAgICAgICAgIERhdGVSZWNvZ25pdGlvbiAtINCg0LDRgdC/0L7Qt9C90LDQstC90LjQtSDQtNCw0YIKICAgICAgICAgICByZXN1bHRfZmllbGQgINC00LvRjyDRgNCw0YHQv9C+0LfQvdCy0LDQvdC40Y8g0LTQsNGCINC4INC90L7QvNC10YDQvtCyLCDRgtGD0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDRgNC10LfRg9C70YzRgtCw0YLRiyDQvtGB0L7QsdGL0Lwg0L7QsdGA0LDQt9C+0LwgKNGB0LzQvtGC0YDRjyDRh9GC0L4g0LjRidC10LwpIiIiCiAgICAgICAgaWYgY3Vyc29yIGlzIE5vbmU6CiAgICAgICAgICAgIGN1cnNvciA9IFtdCiAgICAgICAgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICJUeXBlUmVjb2duaXRpb24iOiB0eXBlX3JlYywKICAgICAgICAgICAgIk51bWJlclJlY29nbml0aW9uIjogTnVtYmVyUmVjb2duaXRpb24sCiAgICAgICAgICAgICJEYXRlUmVjb2duaXRpb24iOiBEYXRlUmVjb2duaXRpb24sCiAgICAgICAgICAgICJQbGF0ZU51bWJlclJlY29nbml0aW9uIjogUGxhdGVOdW1iZXJSZWNvZ25pdGlvbiwKICAgICAgICAgICAgIm1pbl9sZW5ndGgiOiBtaW5fbGVuZ3RoLAogICAgICAgICAgICAibWF4X2xlbmd0aCI6IG1heF9sZW5ndGgsCiAgICAgICAgICAgICJ2YWx1ZXNfbGlzdCI6IHZhbHVlc19saXN0LAogICAgICAgICAgICAicmVzdWx0X3ZhciI6IHJlc3VsdF92YXIsCiAgICAgICAgICAgICJtZXN1cmVfcXR5IjogbWVzdXJlX3F0eSwKICAgICAgICAgICAgIm1pbl9mcmVxIjogbWluX2ZyZXEsCiAgICAgICAgICAgICJxdWVyeSI6IHF1ZXJ5LAogICAgICAgICAgICAiY29udHJvbF9maWVsZCI6IGNvbnRyb2xfZmllbGQsCiAgICAgICAgICAgICJjdXJzb3IiOiBjdXJzb3IsCiAgICAgICAgICAgICJjb3VudF9vYmplY3RzIjogY291bnRfb2JqZWN0cywKICAgICAgICAgICAgIlJlcGxhY2VPIjogUmVwbGFjZU8sCiAgICAgICAgICAgICJUb1VwY2FzZSI6IFRvVXBjYXNlCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZXRWaXNpb25TZXR0aW5ncyIsIGpzb24uZHVtcHMoc2V0dGluZ3MpKQoKICAgIGRlZiBzaG93X3NjcmVlbihzZWxmLCBuYW1lLCBkYXRhPU5vbmUpOgogICAgICAgIHNlbGYucHV0KCdTaG93U2NyZWVuJywgbmFtZSkKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBzZWxmLnB1dF9kYXRhKGRhdGEpCgogICAgZGVmIHNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZiwgcHJvY2Vzcywgc2NyZWVuLCBkYXRhOiBkaWN0ID0gTm9uZSk6CiAgICAgICAgaWYgcHJvY2VzcyBhbmQgc2NyZWVuOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCBmJ3twcm9jZXNzfXx7c2NyZWVufScpCgogICAgICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICAgICAgc2VsZi5wdXRfZGF0YShkYXRhKQoKICAgIGRlZiBzd2l0Y2hfcHJvY2Vzc19zY3JlZW4oc2VsZiwgcHJvY2Vzczogc3RyLCBzY3JlZW46IE9wdGlvbmFsW3N0cl0gPSBOb25lKToKICAgICAgICBwcm9jZXNzX3NjcmVlbiA9IGYne3Byb2Nlc3N9fHtzY3JlZW59JyBpZiBzY3JlZW4gZWxzZSBwcm9jZXNzCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1N3aXRjaFByb2Nlc3NTY3JlZW4nLCBwcm9jZXNzX3NjcmVlbikKCiAgICBkZWYgc2hvd19kaWFsb2coc2VsZiwgbGlzdGVuZXIsIHRpdGxlPScnLCBidXR0b25zPU5vbmUsIGRpYWxvZ19sYXlvdXQ9Tm9uZSk6CiAgICAgICAgc2VsZi5wdXQoIlNob3dEaWFsb2ciLCBsaXN0ZW5lcikKICAgICAgICAKICAgICAgICBpZiBkaWFsb2dfbGF5b3V0OgogICAgICAgICAgICBzZWxmLnB1dCgnU2hvd0RpYWxvZ0xheW91dCcsIGRpYWxvZ19sYXlvdXQpCgogICAgICAgIGlmIHRpdGxlIG9yIGJ1dHRvbnM6CiAgICAgICAgICAgIGRpYWxvZ19zdHlsZSA9IHsKICAgICAgICAgICAgICAgICd0aXRsZSc6IHRpdGxlIG9yIGxpc3RlbmVyLAogICAgICAgICAgICAgICAgJ3llcyc6ICfQntC6JywKICAgICAgICAgICAgICAgICdubyc6ICfQntGC0LzQtdC90LAnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgYnV0dG9ucyBhbmQgbGVuKGJ1dHRvbnMpID4gMToKICAgICAgICAgICAgICAgIGRpYWxvZ19zdHlsZVsneWVzJ10gPSBidXR0b25zWzBdCiAgICAgICAgICAgICAgICBkaWFsb2dfc3R5bGVbJ25vJ10gPSBidXR0b25zWzFdCgogICAgICAgICAgICBzZWxmLnB1dCgnU2hvd0RpYWxvZ1N0eWxlJywgZGlhbG9nX3N0eWxlKQoKICAgIGRlZiBnZXRfY3VycmVudF9zY3JlZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2N1cnJlbnRfc2NyZWVuX25hbWUnXSBpZiBzZWxmLmNvbnRhaW5zS2V5KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgZWxzZSAnJwoKICAgIGRlZiBnZXRfcGFyZW50X3NjcmVlbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZlsncGFyZW50X3NjcmVlbiddIGlmIHNlbGYuY29udGFpbnNLZXkoJ3BhcmVudF9zY3JlZW4nKSBlbHNlICcnCgogICAgZGVmIGdldF9jdXJyZW50X3Byb2Nlc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2N1cnJlbnRfcHJvY2Vzc19uYW1lJ10KCiAgICBkZWYgc2V0X3RpdGxlKHNlbGYsIHRpdGxlKToKICAgICAgICBzZWxmWydTZXRUaXRsZSddID0gdGl0bGUKCiAgICBkZWYgcnVuX3B5X3RocmVhZF9wcm9ncmVzcyhzZWxmLCBoYW5kbGVyc19uYW1lOiBzdHIpOgogICAgICAgICIiIgogICAgICAgINCX0LDQv9GD0YHQutCw0LXRgiDQsNGB0LjQvdGF0YDQvtC90L3QvtC1INGE0L7QvdC+0LLQvtC1INCy0YvQv9C+0LvQvdC10L3QuNC1INGB0LrRgNC40L/RgtCwIGMg0LHQu9C+0LrQuNGA0YPRjtGJ0LjQvCDQv9GA0L7Qs9GA0LXRgdGBLdCx0LDRgNC+0LwsINC60L7RgtC+0YDRi9C5INCx0LvQvtC60LjRgNGD0LXRgiBVSS3Qv9C+0YLQvtC6LgogICAgICAgINCSINC60LDRh9C10YHRgtCy0LUg0LDRgNCz0YPQvNC10L3RgtCwIC0g0LjQvNGPINGE0YPQvdC60YbQuNC4LdGF0LXQvdC00LvQtdGA0LAuCiAgICAgICAgIiIiCgogICAgICAgIHNlbGZbJ1J1blB5VGhyZWFkUHJvZ3Jlc3NEZWYnXSA9IGhhbmRsZXJzX25hbWUKCiAgICBkZWYgc3FsX2V4ZWMoc2VsZiwgcXVlcnksIHBhcmFtcz0nJyk6CiAgICAgICAgc2VsZi5fcHV0X3NxbCgnU1FMRXhlYycsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIHNxbF9leGVjX21hbnkoc2VsZiwgcXVlcnksIHBhcmFtcz1Ob25lKToKICAgICAgICBwYXJhbXMgPSBwYXJhbXMgb3IgW10KICAgICAgICBzZWxmLl9wdXRfc3FsKCdTUUxFeGVjTWFueScsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIHNxbF9xdWVyeShzZWxmLCBxdWVyeSwgcGFyYW1zPScnKToKICAgICAgICBzZWxmLl9wdXRfc3FsKCdTUUxRdWVyeScsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIF9wdXRfc3FsKHNlbGYsIHNxbF90eXBlLCBxdWVyeSwgcGFyYW1zKToKICAgICAgICBzZWxmLnB1dCgKICAgICAgICAgICAgc3FsX3R5cGUsCiAgICAgICAgICAgIHsicXVlcnkiOiBxdWVyeSwgJ3BhcmFtcyc6IHBhcmFtc30sCiAgICAgICAgICAgIHRvX2pzb249VHJ1ZQogICAgICAgICkKCiAgICBkZWYgYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZlsnQmFja1NjcmVlbiddID0gJycKCiAgICBkZWYgbm9fcmVmcmVzaChzZWxmKToKICAgICAgICBzZWxmWydOb1JlZnJlc2gnXSA9ICcnCgoKY2xhc3MgUnNEb2MoUnNfZG9jKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHNlbGYuaWRfZG9jID0gaWRfZG9jCgogICAgZGVmIHVwZGF0ZV9kb2Nfc3RyKHNlbGYsIHByaWNlPTApOgogICAgICAgIHBhc3MKCiAgICBkZWYgZGVsZXRlX2RvYyhzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIGNsZWFyX2JhcmNvZGVfZGF0YShzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG1hcmtfZm9yX3VwbG9hZChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG1hcmtfdmVyaWZpZWQoc2VsZiwga2V5KToKICAgICAgICBzdXBlcigpLm1hcmtfdmVyaWZpZWQoa2V5KQoKICAgIGRlZiBmaW5kX2JhcmNvZGVfaW5fdGFibGUoc2VsZiwgc2VhcmNoX3ZhbHVlLCBmdW5jX2NvbXBhcmVkPSc9PycpIC0+IGRpY3Q6CiAgICAgICAgcmVzdWx0ID0gc3VwZXIoKS5maW5kX2JhcmNvZGVfaW5fdGFibGUoc2VhcmNoX3ZhbHVlLCBmdW5jX2NvbXBhcmVkKQogICAgICAgIGlmIHJlc3VsdDoKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFswXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKICAgIGRlZiBmaW5kX2JhcmNvZGVfaW5fbWFya190YWJsZShzZWxmLCBzZWFyY2hfdmFsdWU6IHN0ciwgZnVuY19jb21wYXJlZD0nPT8nKToKICAgICAgICBwYXNzCgogICAgZGVmIHVwZGF0ZV9kb2NfdGFibGVfZGF0YShzZWxmLCBlbGVtX2Zvcl9hZGQ6IGRpY3QsIHF0dHk9MSwgdXNlcl90bXo9MCk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBhZGRfbWFya2VkX2NvZGVzX2luX2RvYyhzZWxmLCBiYXJjb2RlX2luZm8pOgogICAgICAgIHBhc3MKCiAgICBkZWYgYWRkX25ld19iYXJjb2RlX2luX2RvY19iYXJjb2Rlc190YWJsZShzZWxmLCBlbCwgYmFyY29kZV9pbmZvKToKICAgICAgICBwYXNzCgogICAgZGVmIHByb2Nlc3NfdGhlX2JhcmNvZGUoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGJhcmNvZGUsCiAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuPUZhbHNlLAogICAgICAgICAgICBoYXZlX3plcm9fcGxhbj1GYWxzZSwKICAgICAgICAgICAgY29udHJvbD1GYWxzZSwKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW49RmFsc2UsCiAgICAgICAgICAgIGVsZW09Tm9uZSwKICAgICAgICAgICAgdXNlX21hcmtfc2V0dGluZz0nZmFsc2UnLAogICAgICAgICAgICB1c2VyX3Rtej0wKToKCiAgICAgICAgUnNfZG9jLmlkX2RvYyA9IHNlbGYuaWRfZG9jCiAgICAgICAgcmVzdWx0ID0gUnNfZG9jLnByb2Nlc3NfdGhlX2JhcmNvZGUoCiAgICAgICAgICAgIFJzX2RvYywgYmFyY29kZSwgaGF2ZV9xdHR5X3BsYW4sIGhhdmVfemVyb19wbGFuLCBjb250cm9sLCBoYXZlX21hcmtfcGxhbiwgZWxlbSwgdXNlX21hcmtfc2V0dGluZywgdXNlcl90bXoKICAgICAgICApCiAgICAgICAgaWYgbm90IHJlc3VsdC5nZXQoJ0Vycm9yJyk6CiAgICAgICAgICAgIHNlcnZpY2UgPSBEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQogICAgICAgICAgICBzZXJ2aWNlLnNldF9kb2NfdmFsdWUoJ3NlbnQnLCAwKQoKICAgICAgICAgICAgcmVzID0gc2VsZi5maW5kX2JhcmNvZGVfaW5fdGFibGUoYmFyY29kZSkKICAgICAgICAgICAgaWYgcmVzLmdldCgnaWQnKToKICAgICAgICAgICAgICAgIHJlc3VsdFsna2V5J10gPSByZXNbJ2lkJ10KCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBhZGQoc2VsZiwgYXJncyk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfbmV3X2lkKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgZmluZF9iYXJjb2RlX2luX2JhcmNvZGVfdGFibGUoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgcmV0dXJuIGZpbmRfYmFyY29kZV9pbl9iYXJjb2RlX3RhYmxlKGJhcmNvZGUpCgoKY2xhc3MgQmFyY29kZVdvcmtlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2MsICoqa3dhcmdzKToKICAgICAgICBzZWxmLmlkX2RvYyA9IGlkX2RvYwogICAgICAgIHNlbGYuY29udHJvbCA9IGt3YXJncy5nZXQoJ2NvbnRyb2wnLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfbWFya19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9tYXJrX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfcXR0eV9wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9xdHR5X3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfemVyb19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV96ZXJvX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLnVzZV9zY2FubmluZ19xdWV1ZSA9IGt3YXJncy5nZXQoJ3VzZV9zY2FubmluZ19xdWV1ZScsIEZhbHNlKQogICAgICAgIHNlbGYuYmFyY29kZV9pbmZvID0gTm9uZQogICAgICAgIHNlbGYuZG9jdW1lbnRfcm93ID0gTm9uZQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IEJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLnByb2Nlc3NfcmVzdWx0ID0gc2VsZi5Qcm9jZXNzVGhlQmFyY29kZVJlc3VsdCgpCiAgICAgICAgc2VsZi51c2VyX3RteiA9IDAKICAgICAgICBzZWxmLmJhcmNvZGVfZGF0YSA9IHt9CiAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhID0ge30KICAgICAgICBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEgPSB7fQogICAgICAgIHNlbGYucXVldWVfdXBkYXRlX2RhdGEgPSB7fQoKICAgIGRlZiBwcm9jZXNzX3RoZV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuYmFyY29kZSA9IGJhcmNvZGUKICAgICAgICBzZWxmLmJhcmNvZGVfaW5mbyA9IEJhcmNvZGVQYXJzZXIoYmFyY29kZSkucGFyc2UoYXNfZGljdD1GYWxzZSkKCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2luZm8uZXJyb3I6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdpbnZhbGlkX2JhcmNvZGUnKQogICAgICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzX3Jlc3VsdAoKICAgICAgICBzZWxmLmJhcmNvZGVfZGF0YSA9IHNlbGYuX2dldF9iYXJjb2RlX2RhdGEoKQoKICAgICAgICBpZiBzZWxmLmJhcmNvZGVfZGF0YToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfdXNlX3NlcmllcygpCiAgICAgICAgICAgIHNlbGYuY2hlY2tfYmFyY29kZSgpCiAgICAgICAgICAgIHNlbGYudXBkYXRlX2RvY3VtZW50X2JhcmNvZGVfZGF0YSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ25vdF9mb3VuZCcpCgogICAgICAgIHJldHVybiBzZWxmLnByb2Nlc3NfcmVzdWx0CgogICAgZGVmIF9jaGVja191c2Vfc2VyaWVzKHNlbGYpOgogICAgICAgIGlmIGludChzZWxmLmJhcmNvZGVfZGF0YS5nZXQoJ3VzZV9zZXJpZXMnLCAwKSk6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCd1c2Vfc2VyaWVzJykKCiAgICBkZWYgX2dldF9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAgICAgYmFyY29kZV9kYXRhID0gc2VsZi5kYl9zZXJ2aWNlLmdldF9iYXJjb2RlX2RhdGEoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgYmFyY29kZV9pbmZvPXNlbGYuYmFyY29kZV9pbmZvCiAgICAgICAgKQogICAgICAgIHJldHVybiBiYXJjb2RlX2RhdGEgb3Ige30KCiAgICBkZWYgY2hlY2tfYmFyY29kZShzZWxmKToKICAgICAgICBpZiBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgc2VsZi5fdXNlX21hcmsoKToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfbWFya19pbl9kb2N1bWVudCgpCgogICAgICAgIHNlbGYuX2NoZWNrX2JhcmNvZGVfaW5fZG9jdW1lbnQoKQoKICAgIGRlZiBfY2hlY2tfbWFya19pbl9kb2N1bWVudChzZWxmKToKICAgICAgICBpZiBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPT0gJ0dTMSc6CiAgICAgICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydtYXJrX2lkJ106CiAgICAgICAgICAgICAgICBpZiBzZWxmLmJhcmNvZGVfZGF0YVsnYXBwcm92ZWQnXSA9PSAnMSc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ21hcmtfYWxyZWFkeV9zY2FubmVkJykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X21hcmtfZGF0YSgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhdmVfbWFya19wbGFuIGFuZCBzZWxmLmNvbnRyb2w6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ21hcmtfbm90X2ZvdW5kJykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X21hcmtfZGF0YSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ25vdF92YWxpZF9iYXJjb2RlJykKCiAgICBkZWYgX2NoZWNrX2JhcmNvZGVfaW5fZG9jdW1lbnQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIG5ld19kZXZpY2VfcXR0eSA9IHNlbGYuYmFyY29kZV9kYXRhWydkX3F0dHknXSArIHNlbGYuYmFyY29kZV9kYXRhWydyYXRpbyddCiAgICAgICAgbmV3X292ZXJhbGxfcXR0eSA9IHNlbGYuYmFyY29kZV9kYXRhWydxdHR5J10gKyBzZWxmLmJhcmNvZGVfZGF0YVsncmF0aW8nXQoKICAgICAgICBpZiBzZWxmLmJhcmNvZGVfZGF0YVsncm93X2tleSddOgogICAgICAgICAgICBpZiBzZWxmLmhhdmVfcXR0eV9wbGFuIGFuZCBzZWxmLmNvbnRyb2wgYW5kIHNlbGYuYmFyY29kZV9kYXRhWydxdHR5X3BsYW4nXSA8IFwKICAgICAgICAgICAgICAgICAgICBtYXgobmV3X2RldmljZV9xdHR5LCBuZXdfb3ZlcmFsbF9xdHR5KToKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdxdWFudGl0eV9wbGFuX3JlYWNoZWQnKQoKICAgICAgICBlbGlmIHNlbGYuaGF2ZV96ZXJvX3BsYW4gYW5kIHNlbGYuY29udHJvbDoKICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ3plcm9fcGxhbl9lcnJvcicpCgogICAgICAgIGlmIG5vdCBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICBpZiBzZWxmLnVzZV9zY2FubmluZ19xdWV1ZToKICAgICAgICAgICAgICAgIHNlbGYuX2luc2VydF9xdWV1ZV9kYXRhKCkKICAgICAgICAgICAgICAgIHNlbGYuX2luc2VydF9kb2NfdGFibGVfZGF0YShuZXdfZGV2aWNlX3F0dHkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9pbnNlcnRfZG9jX3RhYmxlX2RhdGEobmV3X2RldmljZV9xdHR5KQoKICAgIGRlZiBfaW5zZXJ0X21hcmtfZGF0YShzZWxmKToKICAgICAgICBzZWxmLm1hcmtfdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBzZWxmLmlkX2RvYywKICAgICAgICAgICAgJ2lkX2dvb2QnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfZ29vZCddLAogICAgICAgICAgICAnaWRfcHJvcGVydHknOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfdW5pdCddLAogICAgICAgICAgICAnYmFyY29kZV9mcm9tX3NjYW5uZXInOiBzZWxmLmJhcmNvZGVfaW5mby5iYXJjb2RlLAogICAgICAgICAgICAnYXBwcm92ZWQnOiAnMScsCiAgICAgICAgICAgICdndGluJzogc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiwKICAgICAgICAgICAgJ3Nlcmllcyc6IHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXToKICAgICAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhWydpZCddID0gc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXQoKICAgIGRlZiBfaW5zZXJ0X2RvY190YWJsZV9kYXRhKHNlbGYsIHF0eSk6CgogICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICdpZF91bml0Jzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLmJhcmNvZGVfZGF0YVsncXR0eSddLAogICAgICAgICAgICAnZF9xdHR5JzogZmxvYXQocXR5KSwKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuYmFyY29kZV9kYXRhWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2xhc3RfdXBkYXRlZCc6IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz1zZWxmLnVzZXJfdG16KSkuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIiksCiAgICAgICAgICAgICdpZF9jZWxsJzogJycsCiAgICAgICAgICAgICdwcmljZSc6IHNlbGYuYmFyY29kZV9kYXRhWydwcmljZSddLAogICAgICAgICAgICAnaWRfcHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJpY2UnXQogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ3Jvd19rZXknXToKICAgICAgICAgICAgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhWydpZCddID0gc2VsZi5iYXJjb2RlX2RhdGFbJ3Jvd19rZXknXQoKICAgIGRlZiBfaW5zZXJ0X3F1ZXVlX2RhdGEoc2VsZik6CiAgICAgICAgc2VsZi5xdWV1ZV91cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgImlkX2RvYyI6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAiaWRfZ29vZCI6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICJpZF9wcm9wZXJ0aWVzIjogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICJpZF9zZXJpZXMiOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICJpZF91bml0Ijogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3VuaXQnXSwKICAgICAgICAgICAgImlkX2NlbGwiOiAnJywKICAgICAgICAgICAgImRfcXR0eSI6IHNlbGYuYmFyY29kZV9kYXRhWydyYXRpbyddLAogICAgICAgICAgICAncm93X2tleSc6IHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J10sCiAgICAgICAgICAgICdzZW50JzogRmFsc2UsCiAgICAgICAgICAgICdwcmljZSc6IHNlbGYuYmFyY29kZV9kYXRhWydwcmljZSddLAogICAgICAgICAgICAnaWRfcHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJpY2UnXQogICAgICAgIH0KCiAgICBkZWYgdXBkYXRlX2RvY3VtZW50X2JhcmNvZGVfZGF0YShzZWxmKToKICAgICAgICBpZiBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUodGFibGVfbmFtZT0iUlNfZG9jc19iYXJjb2RlcyIsIGRvY3NfdGFibGVfdXBkYXRlX2RhdGE9c2VsZi5tYXJrX3VwZGF0ZV9kYXRhKQoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5yZXBsYWNlX29yX2NyZWF0ZV90YWJsZSh0YWJsZV9uYW1lPSJSU19kb2NzX3RhYmxlIiwgZG9jc190YWJsZV91cGRhdGVfZGF0YT1zZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEpCgogICAgICAgIGlmIHNlbGYucXVldWVfdXBkYXRlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5pbnNlcnRfbm9fc3FsKHNlbGYucXVldWVfdXBkYXRlX2RhdGEpCgogICAgICAgIGlmIHNlbGYuX3VzZV9tYXJrKCk6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdzdWNjZXNzX21hcmsnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdzdWNjZXNzX2JhcmNvZGUnKQoKICAgIGRlZiBfdXNlX21hcmsoc2VsZik6CiAgICAgICAgcmV0dXJuIHJzX3NldHRpbmdzLmdldCgndXNlX21hcmsnKSA9PSAndHJ1ZScgYW5kIHNlbGYuYmFyY29kZV9kYXRhWyd1c2VfbWFyayddCgogICAgZGVmIF9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbyhzZWxmLCBpbmZvX2tleSk6CiAgICAgICAgcmF0aW8gPSBnZXRhdHRyKHNlbGYuYmFyY29kZV9kYXRhLCAncmF0aW8nLCAwKQoKICAgICAgICBpbmZvX2RhdGEgPSB7CiAgICAgICAgICAgICdpbnZhbGlkX2JhcmNvZGUnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnSW52YWxpZCBiYXJjb2RlJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQndC10LLQtdGA0L3Ri9C5INGI0YLRgNC40YXQutC+0LQnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbm90X2ZvdW5kJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ05vdCBmb3VuZCcsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0KjRgtGA0LjRhdC60L7QtCDQvdC1INC90LDQudC00LXQvSDQsiDQsdCw0LfQtScsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdtYXJrX25vdF9mb3VuZCc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdOb3QgZm91bmQnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Cc0LDRgNC60LAg0L3QtSDQvdCw0LnQtNC10L3QsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbm90X3ZhbGlkX2JhcmNvZGUnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnTm90IHZhbGlkIGJhcmNvZGUnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Ci0L7QstCw0YAg0L/QvtC00LvQtdC20LjRgiDQvNCw0YDQutC40YDQvtCy0LrQtSwg0L7RgtGB0LrQsNC90LjRgNC+0LLQsNC9INC90LXQstC10YDQvdGL0Lkg0YjRgtGA0LjRhdC60L7QtCDQvNCw0YDQutC40YDQvtCy0LrQuCcsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdtYXJrX2FscmVhZHlfc2Nhbm5lZCc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdBbHJlYWR5IHNjYW5uZWQnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Ci0LDQutCw0Y8g0LzQsNGA0LrQsCDRg9C20LUg0LHRi9C70LAg0L7RgtGB0LrQsNC90LjRgNC+0LLQsNC90LAnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnemVyb19wbGFuX2Vycm9yJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ1plcm8gcGxhbiBlcnJvcicsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0JIg0LTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0L3QtdC70YzQt9GPINC00L7QsdCw0LLQuNGC0Ywg0YLQvtCy0LDRgCDQvdC1INC40Lcg0YHQv9C40YHQutCwJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3F1YW50aXR5X3BsYW5fcmVhY2hlZCc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdRdWFudGl0eSBwbGFuIHJlYWNoZWQnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC/0LvQsNC9INCx0YPQtNC10YIg0L/RgNC10LLRi9GI0LXQvdC+INC/0YDQuCDQtNC+0LHQsNCy0LvQtdC90LjQuCB7fSDQtdC00LjQvdC40YYg0YLQvtCy0LDRgNCwJy5mb3JtYXQocmF0aW8pLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnc3VjY2Vzc19iYXJjb2RlJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0KLQvtCy0LDRgCDQtNC+0LHQsNCy0LvQtdC9INCyINC00L7QutGD0LzQtdC90YInCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdzdWNjZXNzX21hcmsnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQnNCw0YDQutCwINC00L7QsdCw0LLQu9C10L3QsCDQsiDQtNC+0LrRg9C80LXQvdGCJwogICAgICAgICAgICB9LAogICAgICAgICAgICAndXNlX3Nlcmllcyc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICd1c2Vfc2VyaWVzJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQlNC70Y8g0YLQvtCy0LDRgNCwINC90LXQvtCx0YXQvtC00LjQvNC+INC+0YLRgdC60LDQvdC40YDQvtCy0LDRgtGMINGB0LXRgNC40LgnLAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiBpbmZvX2RhdGEuZ2V0KGluZm9fa2V5KToKICAgICAgICAgICAgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvciA9IGluZm9fZGF0YVtpbmZvX2tleV1bJ2Vycm9yJ10KICAgICAgICAgICAgc2VsZi5wcm9jZXNzX3Jlc3VsdC5kZXNjcmlwdGlvbiA9IGluZm9fZGF0YVtpbmZvX2tleV1bJ2Rlc2NyaXB0aW9uJ10KICAgICAgICAgICAgc2VsZi5wcm9jZXNzX3Jlc3VsdC5yb3dfa2V5ID0gc2VsZi5iYXJjb2RlX2RhdGEuZ2V0KCdyb3dfa2V5JywgMCkKICAgICAgICAgICAgc2VsZi5wcm9jZXNzX3Jlc3VsdC5iYXJjb2RlX2RhdGEgPSBzZWxmLmJhcmNvZGVfZGF0YQoKICAgIGRlZiBwYXJzZShzZWxmLCBiYXJjb2RlOiBzdHIpOgogICAgICAgIHJldHVybiBCYXJjb2RlUGFyc2VyKGJhcmNvZGUpLnBhcnNlKCkKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBQcm9jZXNzVGhlQmFyY29kZVJlc3VsdDoKICAgICAgICBlcnJvcjogc3RyID0gJycKICAgICAgICBkZXNjcmlwdGlvbjogc3RyID0gJycKICAgICAgICBiYXJjb2RlOiBzdHIgPSAnJwogICAgICAgIHJvd19rZXk6IHN0ciA9ICcnCiAgICAgICAgYmFyY29kZV9kYXRhID0gTm9uZQoKY2xhc3MgQmFyY29kZUFkcldvcmtlcihCYXJjb2RlV29ya2VyKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2MsICoqa3dhcmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGlkX2RvYywgKiprd2FyZ3MpCiAgICAgICAgc2VsZi5pc19hZHJfZG9jID0gVHJ1ZQogICAgICAgIHNlbGYuaWRfY2VsbCA9IGt3YXJncy5nZXQoJ2lkX2NlbGwnLCAnJykKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBrd2FyZ3MuZ2V0KCd0YWJsZV90eXBlJywgJycpCgogICAgZGVmIF9nZXRfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfYmFyY29kZV9kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGJhcmNvZGVfaW5mbz1zZWxmLmJhcmNvZGVfaW5mbywKICAgICAgICAgICAgaXNfYWRyX2RvYz1zZWxmLmlzX2Fkcl9kb2MsCiAgICAgICAgICAgIGlkX2NlbGw9c2VsZi5pZF9jZWxsLAogICAgICAgICAgICB0YWJsZV90eXBlPXNlbGYudGFibGVfdHlwZQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGJhcmNvZGVfZGF0YSBvciB7fQoKICAgIGRlZiBfY2hlY2tfbWFya19pbl9kb2N1bWVudChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIF9pbnNlcnRfbWFya19kYXRhKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2luc2VydF9kb2NfdGFibGVfZGF0YShzZWxmLCBxdHkpOgoKICAgICAgICBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBzZWxmLmlkX2RvYywKICAgICAgICAgICAgJ2lkX2dvb2QnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfZ29vZCddLAogICAgICAgICAgICAnaWRfcHJvcGVydGllcyc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAnaWRfc2VyaWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAnaWRfdW5pdCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF91bml0J10sCiAgICAgICAgICAgICdxdHR5JzogZmxvYXQocXR5KSwKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuYmFyY29kZV9kYXRhWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2xhc3RfdXBkYXRlZCc6IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz1zZWxmLnVzZXJfdG16KSkuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIiksCiAgICAgICAgICAgICdpZF9jZWxsJzogc2VsZi5pZF9jZWxsLAogICAgICAgICAgICAndGFibGVfdHlwZSc6IHNlbGYudGFibGVfdHlwZSwKICAgICAgICB9CgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J106CiAgICAgICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YVsnaWQnXSA9IHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J10KCiAgICBkZWYgX2luc2VydF9xdWV1ZV9kYXRhKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgdXBkYXRlX2RvY3VtZW50X2JhcmNvZGVfZGF0YShzZWxmKToKICAgICAgICBpZiBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUoCiAgICAgICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19hZHJfZG9jc190YWJsZSIsCiAgICAgICAgICAgICAgICBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhPXNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YSkKCiAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ3N1Y2Nlc3NfYmFyY29kZScpCgpjbGFzcyBCYXJjb2RlUGFyc2VyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHNlbGYuYmFyY29kZSA9IGJhcmNvZGUKICAgICAgICBzZWxmLmJhcmNvZGVfaW5mbyA9IEJhcmNvZGVQYXJzZXIuQmFyY29kZUluZm8oYmFyY29kZT1iYXJjb2RlKQogICAgICAgIHNlbGYubWFjcm9fMDUgPSBmJ1spPntjaHIoMzApfTA1JwogICAgICAgIHNlbGYubWFjcm9fMDYgPSBmJ1spPntjaHIoMzApfTA2JwogICAgICAgIHNlbGYuZ3MxX3NlcGFyYXRvciA9IGNocigyOSkKICAgICAgICBzZWxmLmlkZW50aWZpZXIgPSAnXWQyJwoKICAgIGRlZiBwYXJzZShzZWxmLCBhc19kaWN0PVRydWUpOgogICAgICAgIGlmIHNlbGYuaXNfdmFsaWRfZWFuMTMoc2VsZi5iYXJjb2RlKToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2NoZW1lID0gJ0VBTjEzJwogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gc2VsZi5iYXJjb2RlCgogICAgICAgIGVsaWYgbGVuKHNlbGYuYmFyY29kZSkgPT0gMjk6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdHUzEnCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBzZWxmLmJhcmNvZGVbMDoxNF0KICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsID0gc2VsZi5iYXJjb2RlWzE0OjIxXQogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5tcmMgPSBzZWxmLmJhcmNvZGVbMjE6MjVdCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmNoZWNrID0gc2VsZi5iYXJjb2RlWzI1OjI5XQoKICAgICAgICBlbGlmIHNlbGYuZ3MxX3NlcGFyYXRvciBpbiBzZWxmLmJhcmNvZGUgb3IgJzxHUz4nIGluIHNlbGYuYmFyY29kZToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2NoZW1lID0gJ0dTMScKICAgICAgICAgICAgc2VsZi5jaGVja19kYXRhbWF0cml4KHNlbGYuYmFyY29kZSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2NoZW1lID0gJ1VOS05PV04nCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBzZWxmLmJhcmNvZGUKCiAgICAgICAgaWYgYXNfZGljdDoKICAgICAgICAgICAgcmV0dXJuIHNlbGYuYmFyY29kZV9pbmZvLmRpY3QoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmJhcmNvZGVfaW5mbwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpc192YWxpZF9lYW4xMyhjb2RlKToKICAgICAgICBwYXR0ZXJuID0gcideXGR7MTN9JCcKICAgICAgICBpZiBub3QgcmUubWF0Y2gocGF0dGVybiwgY29kZSk6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBmYWN0b3JzID0gWzEsIDNdICogNgogICAgICAgIGNoZWNrc3VtID0gc3VtKGludChjb2RlW2ldKSAqIGZhY3RvcnNbaV0gZm9yIGkgaW4gcmFuZ2UoMTIpKQogICAgICAgIGNoZWNrc3VtID0gKDEwIC0gKGNoZWNrc3VtICUgMTApKSAlIDEwCgogICAgICAgIHJldHVybiBjaGVja3N1bSA9PSBpbnQoY29kZVstMV0pCgogICAgZGVmIGNoZWNrX2RhdGFtYXRyaXgoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgYmFyY29kZSA9IHNlbGYuY2xlYXJfaWRlbnRpZmllcihiYXJjb2RlKQogICAgICAgIHNlbGYuY2hlY2tfZ3MxX2d0aW4oYmFyY29kZSkKCiAgICBkZWYgY2hlY2tfZ3MxX2d0aW4oc2VsZiwgYmFyY29kZTogc3RyKToKICAgICAgICBpZiBzZWxmLmdzMV9zZXBhcmF0b3IgaW4gYmFyY29kZToKICAgICAgICAgICAgd2hpbGUgYmFyY29kZToKICAgICAgICAgICAgICAgIGlmIGJhcmNvZGVbOjJdID09ICcwMSc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IGJhcmNvZGVbMjoxNl0KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYmFyY29kZSkgPiAxNjoKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTY6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzozXSA9PSBjaHIoMjkpICsgJzAxJzoKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gYmFyY29kZVszOjE3XQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDE3OgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxNzpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICcxNyc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZXhwaXJ5ID0gYmFyY29kZVsyOjhdCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gODoKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbODpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICcxMCc6CiAgICAgICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGJhcmNvZGUuaW5kZXgoY2hyKDI5KSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uYmF0Y2ggPSBiYXJjb2RlWzI6aW5kZXhdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlW2luZGV4ICsgMTpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uYmF0Y2ggPSBiYXJjb2RlWzI6XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzIxJzoKICAgICAgICAgICAgICAgICAgICBpZiBjaHIoMjkpIGluIGJhcmNvZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gYmFyY29kZS5pbmRleChjaHIoMjkpKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zZXJpYWwgPSBiYXJjb2RlWzI6aW5kZXhdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlW2luZGV4ICsgMTpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICc5MSc6CiAgICAgICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGJhcmNvZGUuaW5kZXgoY2hyKDI5KSkKCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLm5ocm4gPSBiYXJjb2RlWzI6aW5kZXhdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlW2luZGV4ICsgMTpdCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubmhybiA9IGJhcmNvZGVbMjo2XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6Ml0gPT0gJzkzJzogICMg0JzQvtC70L7Rh9C60LAsINCy0L7QtNCwCiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uY2hlY2sgPSBiYXJjb2RlWzI6Nl0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVs3Ol0KCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICc5Mic6ICAjINCU0LDQu9C10LUg0YHQu9C10LTRg9C10YIg0LrQvtC0INC/0YDQvtCy0LXRgNC60LgsIDQ0INGB0LjQvNCy0L7Qu9CwCiAgICAgICAgICAgICAgICAgICAgIyBpZiBsZW4oYmFyY29kZVsyOl0pPT00NDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5jaGVjayA9IGJhcmNvZGVbMjpdCiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjRdID09ICc4MDA1JzogICMg0KLQsNCx0LDQuiwg0JHQu9C+0LoKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5uaHJuID0gYmFyY29kZVs0OjEwXQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzExOl0KCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjRdID09ICczMTAzJzogICMg0JzQvtC70L7Rh9C60LAg0YEg0JLQtdGB0L7QvAogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLndlaWdodCA9IGJhcmNvZGVbNDpdCiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmVycm9yID0gJ0lOVkFMSUQgQkFSQ09ERScKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5lcnJvciA9ICdObyBHUyBTZXBhcmF0b3InCgogICAgICAgICMgaWYgKCdHVElOJyAsICdCQVRDSCcgLCAnRVhQSVJZJyAsICdTRVJJQUwnKSBpbiByZXN1bHQua2V5cygpOgogICAgICAgICMgICAgIGlmIGd0aW5fY2hlY2socmVzdWx0WydHVElOJ10pID09IEZhbHNlIGFuZCBleHBpcnlfZGF0ZV9jaGVjayhyZXN1bHRbJ0VYUElSWSddKSA9PSBGYWxzZToKICAgICAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBHVElOICYgRVhQSVJZIERBVEUnLCAnQkFSQ09ERSc6IHJlc3VsdH0KICAgICAgICAjICAgICBlbGlmIGV4cGlyeV9kYXRlX2NoZWNrKHJlc3VsdFsnRVhQSVJZJ10pID09IEZhbHNlOgogICAgICAgICMgICAgICAgICByZXR1cm4geydFUlJPUic6ICdJTlZBTElEIEVYUElSWSBEQVRFJywgJ0JBUkNPREUnOiByZXN1bHR9CiAgICAgICAgIyAgICAgZWxpZiBndGluX2NoZWNrKHJlc3VsdFsnR1RJTiddKSA9PSBGYWxzZToKICAgICAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBHVElOJywgJ0JBUkNPREUnOiByZXN1bHR9CiAgICAgICAgIyAgICAgZWxzZToKICAgICAgICAjICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICMgZWxzZToKICAgICAgICAjICAgICByZXR1cm4geydFUlJPUic6ICdJTkNPTVBMRVRFIERBVEEnLCAnQkFSQ09ERSc6IHJlc3VsdH0KCiAgICBkZWYgY2xlYXJfaWRlbnRpZmllcihzZWxmLCBiYXJjb2RlKToKICAgICAgICAiIiIKICAgICAgICBNb3N0IGJhcmNvZGUgc2Nhbm5lcnMgcHJlcGVuZCAnXWQyJyBpZGVudGlmaWVyIGZvciB0aGUgR1MxIGRhdGFtYXRyaXguCiAgICAgICAgVGhpcyBzZWN0aW9uIHJlbW92ZXMgdGhlIGlkZW50aWZpZXIuCiAgICAgICAgIiIiCgogICAgICAgIGlmIGJhcmNvZGVbOjNdID09IHNlbGYuaWRlbnRpZmllcjoKICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMzpdCgogICAgICAgIHJldHVybiBiYXJjb2RlCgogICAgQGRhdGFjbGFzcwogICAgY2xhc3MgQmFyY29kZUluZm86CiAgICAgICAgYmFyY29kZTogc3RyID0gJycKICAgICAgICBzY2hlbWU6IHN0ciA9ICcnCiAgICAgICAgc2VyaWFsOiBzdHIgPSAnJwogICAgICAgIGd0aW46IHN0ciA9ICcnCiAgICAgICAgZXJyb3I6IHN0ciA9ICcnCiAgICAgICAgbXJjOiBzdHIgPSAnJwogICAgICAgIGNoZWNrOiBzdHIgPSAnJwogICAgICAgIGZ1bGxfY29kZTogc3RyID0gJycKICAgICAgICBleHBpcnk6IHN0ciA9ICcnCiAgICAgICAgYmF0Y2g6IHN0ciA9ICcnCiAgICAgICAgbmhybjogc3RyID0gJycKICAgICAgICB3ZWlnaHQ6IHN0ciA9ICcnCgogICAgICAgIGRlZiBkaWN0KHNlbGYpOgogICAgICAgICAgICByZXR1cm4ge2sudXBwZXIoKTogc3RyKHYpIGZvciBrLCB2IGluIGFzZGljdChzZWxmKS5pdGVtcygpIGlmIHZ9CgoKZGVmIGdldF9pcF9hZGRyZXNzKCk6CiAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICB0cnk6CiAgICAgICAgcy5jb25uZWN0KCgiOC44LjguOCIsIDgwKSkKICAgICAgICBpcF9hZGRyZXNzID0gcy5nZXRzb2NrbmFtZSgpWzBdCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgaXBfYWRkcmVzcyA9IE5vbmUKICAgIGZpbmFsbHk6CiAgICAgICAgcy5jbG9zZSgpCgogICAgcmV0dXJuIGlwX2FkZHJlc3MK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\widgets.py",
                "PyFileKey": "widgets",
                "PyFileData": "ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0CmltcG9ydCBqc29uCgp3cmFwX2NvbnRlbnQgPSAid3JhcF9jb250ZW50IgptYXRjaF9wYXJlbnQgPSAnbWF0Y2hfcGFyZW50JwoKCmNsYXNzIFdpZGdldChBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZTogc3RyCiAgICAgICAgc2VsZi5WYWx1ZTogc3RyCiAgICAgICAgc2VsZi53aWR0aCA9IHdyYXBfY29udGVudAogICAgICAgIHNlbGYuaGVpZ2h0ID0gd3JhcF9jb250ZW50CiAgICAgICAgc2VsZi53ZWlnaHQgPSAwCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4ga3dhcmdzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLl9fZGljdF9fW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidXaWRnZXQodHlwZT17c2VsZi50eXBlfSwgVmFsdWU9e3NlbGYuVmFsdWV9KScKCiAgICBkZWYgdG9fanNvbihzZWxmKToKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhzZWxmLCBkZWZhdWx0PWxhbWJkYSB4OiB2YXJzKHgpLCBpbmRlbnQ9NCkKCgpjbGFzcyBQaWN0dXJlKFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHBpYycKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQaWN0dXJlIgoKCmNsYXNzIFRleHRWaWV3KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHZhbHVlJwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gIlRleHRWaWV3IgoKCmNsYXNzIENoZWNrQm94KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gJ0NoZWNrQm94JwoKCmNsYXNzIFBvcHVwTWVudUJ1dHRvbihXaWRnZXQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICBzZWxmLlZhbHVlID0gJ0B2YWx1ZScKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQb3B1cE1lbnVCdXR0b24iCiAgICAgICAgc2VsZi5zaG93X2J5X2NvbmRpdGlvbiA9ICcnCiAgICAgICAgc2VsZi5Ob1JlZnJlc2ggPSBGYWxzZQogICAgICAgIHNlbGYuZG9jdW1lbnRfdHlwZSA9ICcnCiAgICAgICAgc2VsZi5tYXNrID0gJycKCgpjbGFzcyBMaW5lYXJMYXlvdXQoV2lkZ2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZSA9ICdMaW5lYXJMYXlvdXQnCiAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICJ2ZXJ0aWNhbCIKCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykKICAgICAgICBzZWxmLkVsZW1lbnRzID0gbGlzdChhcmdzKSBvciBbXQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgKndpZGdldHMpOgogICAgICAgIGZvciB3aWRnZXQgaW4gd2lkZ2V0czoKICAgICAgICAgICAgc2VsZi5FbGVtZW50cy5hcHBlbmQod2lkZ2V0KQoKCmNsYXNzIE9wdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2VhcmNoX2VuYWJsZWQ9VHJ1ZSwgc2F2ZV9wb3NpdGlvbj1UcnVlLCBvdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgICAgIHNlbGYub3B0aW9ucyA9IHsKICAgICAgICAgICAgJ3NlYXJjaF9lbmFibGVkJzogc2VhcmNoX2VuYWJsZWQsCiAgICAgICAgICAgICdzYXZlX3Bvc2l0aW9uJzogc2F2ZV9wb3NpdGlvbiwKICAgICAgICAgICAgJ292ZXJyaWRlX3NlYXJjaCc6IG92ZXJyaWRlX3NlYXJjaAogICAgICAgIH0KCgpjbGFzcyBDdXN0b21DYXJkczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgY2FyZHNkYXRhOiBMaXN0W2RpY3RdID0gW10pOgogICAgICAgIHNlbGYuY3VzdG9tY2FyZHMgPSB7CiAgICAgICAgICAgICdvcHRpb25zJzogb3B0aW9ucyBvciBPcHRpb25zKCksCiAgICAgICAgICAgICdsYXlvdXQnOiBsYXlvdXQsCiAgICAgICAgICAgICdjYXJkc2RhdGEnOiBjYXJkc2RhdGEKICAgICAgICB9CgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoc2VsZiwgZGVmYXVsdD1sYW1iZGEgeDogdmFycyh4KSwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkKCgpjbGFzcyBDdXN0b21UYWJsZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgdGFibGVkYXRhOiBMaXN0W2RpY3RdKToKICAgICAgICBzZWxmLmN1c3RvbXRhYmxlID0gewogICAgICAgICAgICAnb3B0aW9ucyc6IG9wdGlvbnMgb3IgT3B0aW9ucygpLAogICAgICAgICAgICAnbGF5b3V0JzogbGF5b3V0LAogICAgICAgICAgICAndGFibGVkYXRhJzogdGFibGVkYXRhCiAgICAgICAgfQoKICAgIGRlZiB0b19qc29uKHNlbGYpOgogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHNlbGYsIGRlZmF1bHQ9bGFtYmRhIHg6IHZhcnMoeCksIGluZGVudD00LCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpCgoKQGRhdGFjbGFzcwpjbGFzcyBNb2Rlcm5GaWVsZDoKICAgIGhpbnQ6IHN0ciA9ICcnCiAgICBkZWZhdWx0X3RleHQ6IHN0ciA9ICcnCiAgICBjb3VudGVyOiBib29sID0gRmFsc2UKICAgIGNvdW50ZXJfbWF4OiBpbnQgPSAwCiAgICBpbnB1dF90eXBlOiBpbnQgPSAwCiAgICBwYXNzd29yZDogYm9vbCA9IEZhbHNlCiAgICBldmVudHM6IGJvb2wgPSBGYWxzZQoKICAgICIiIgogICAgVFlQRV9OVUxMOiAwCiAgICAKICAgIFRZUEVfQ0xBU1NfTlVNQkVSOiAyCiAgICBUWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUw6IDgxOTIgCiAgICBUWVBFX05VTUJFUl9GTEFHX1NJR05FRDogNDA5NiAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9QQVNTV09SRDogMTYKICAgIAogICAgVFlQRV9DTEFTU19EQVRFVElNRSA6IDQKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX0RBVEU6IDE2CiAgICBUWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX1RJTUU6IDMyCiAgICAKICAgIFRZUEVfQ0xBU1NfUEhPTkU6IDMKICAgIAogICAgVFlQRV9NQVNLX0NMQVNTOiAxNQogICAgVFlQRV9NQVNLX0ZMQUdTOiAxNjc3MzEyMCAKICAgIFRZUEVfTUFTS19WQVJJQVRJT046IDQwODAgCgogICAgVFlQRV9DTEFTU19URVhUOiAxCiAgICBUWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFOiA2NTUzNiAKICAgIFRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDogMzI3NjggCiAgICBUWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUzogNDA5NiAKICAgIFRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM6IDE2Mzg0IAogICAgVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTOiA4MTkyICAKICAgIFRZUEVfVEVYVF9GTEFHX0VOQUJMRV9URVhUX0NPTlZFUlNJT05fU1VHR0VTVElPTlM6IDEwNDg1NzYgCiAgICBUWVBFX1RFWFRfRkxBR19JTUVfTVVMVElfTElORTogMjYyMTQ0IAogICAgVFlQRV9URVhUX0ZMQUdfTVVMVElfTElORTogMTMxMDcyIAogICAgVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM6IDUyNDI4OCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfQUREUkVTUzogMzIKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfU1VCSkVDVDogNDgKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRklMVEVSOiAxNzYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX0xPTkdfTUVTU0FHRTogODAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMOiAwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEOiAxMjggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BFUlNPTl9OQU1FOiAgOTYKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUEhPTkVUSUM6IDE5MiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUE9TVEFMX0FERFJFU1M6IDExMiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fU0hPUlRfTUVTU0FHRTogNjQgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1VSSTogMTYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1ZJU0lCTEVfUEFTU1dPUkQ6IDE0NCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fV0VCX0VESVRfVEVYVDogMTYwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9FTUFJTF9BRERSRVNTOiAyMDggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9QQVNTV09SRDogMjI0IAogICAgIiIiCgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRlZmF1bHQ9bGFtYmRhIHg6IHtrOiB2IGZvciBrLCB2IGluIHZhcnMoeCkuaXRlbXMoKSBpZiB2fSwKICAgICAgICAgICAgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZQogICAgICAgICkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkK"
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\version_control.py",
                "PyFileKey": "version_control",
                "PyFileData": "aW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCAgcmUKI2Zyb20KZGVmIGlzX3ZhbGlkX3ZlcnNpb24odmVyc2lvbik6CiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBjaGVjayBpZiB0aGUgdmVyc2lvbiBoYXMgdGhlIGNvcnJlY3QgZm9ybWF0ICh4LngueC54KQogICAgaWYgbm90IGlzaW5zdGFuY2UodmVyc2lvbiwgc3RyKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBwYXR0ZXJuID0gcideXGR7MSwyfShcLlxkezEsMn0pezR9JwoKICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIHZlcnNpb24pKQoKCiPQn9C10YDQtdCx0LjRgNCw0LXQvCDRgNC10LvQuNC30Ysg0L/QviDQvtC00L3QvtC80YMuINCk0YPQvdC60YbQuNGPINC/0YvRgtCw0LXRgtGB0Y8g0L3QsNC50YLQuCDQsiDQvNC+0LTRg9C70LUg0YTRg9C90LrRhtC40Y4g0YEg0LjQvNC10L3QtdC8LAojINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQvCDQvdC+0LzQtdGA0YMg0YDQtdC70LjQt9CwINC4INC10YHQu9C4INC90LDRiNC70LAgLSDQstGL0L/QvtC70L3QuNGC0Ywg0LXRkQpkZWYgcnVuX3JlbGVhc2VzKF9zdGFydF92ZXJzaW9uOnN0ciwgX2VuZF92ZXJzaW9uOnN0cik6CiAgICByZXR1cm5fbGlzdCA9IFtdCiAgICBpZiBub3QgaXNfdmFsaWRfdmVyc2lvbihfc3RhcnRfdmVyc2lvbikgb3Igbm90IGlzX3ZhbGlkX3ZlcnNpb24oX2VuZF92ZXJzaW9uKToKICAgICAgICByZXR1cm5fbGlzdC5hcHBlbmQoeydyZXN1bHQnOiBGYWxzZSwgJ2RldGFpbHMnOiAn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIg0LLQtdGA0YHQuNC4INC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuC4g0KTQvtGA0LzQsNGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCDQtNC+0LvQttC10L0g0LHRi9GC0YwgeC54LngueCd9KQogICAgICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiAgICB2ZXJzaW9uID0gX3N0YXJ0X3ZlcnNpb24KICAgIHdoaWxlIGNvbXBhcmVfdmVyc2lvbnModmVyc2lvbiwgX2VuZF92ZXJzaW9uKSA8PSAwOgogICAgICAgIHJlbGVhc2VfZnVuY3Rpb25fbmFtZSA9ICdyJyArIHZlcnNpb24ucmVwbGFjZSgnLicsICdfJykKICAgICAgICByZWxlYXNlX2Z1bmN0aW9uID0gZ2xvYmFscygpLmdldChyZWxlYXNlX2Z1bmN0aW9uX25hbWUpCiAgICAgICAgaWYgcmVsZWFzZV9mdW5jdGlvbiBhbmQgY2FsbGFibGUocmVsZWFzZV9mdW5jdGlvbik6CgogICAgICAgICAgICByZXMgPSByZWxlYXNlX2Z1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuX2xpc3QuYXBwZW5kKHJlcykKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcHJpbnQoZiJSZWxlYXNlIGZ1bmN0aW9uICd7cmVsZWFzZV9mdW5jdGlvbl9uYW1lfScgbm90IGZvdW5kLiIpCgogICAgICAgIHZlcnNpb24gPSBpbmNyZW1lbnRfdmVyc2lvbih2ZXJzaW9uKQoKICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiPQodGA0LDQstC90LjQstCw0LXQvCDQvdC+0LzQtdGA0LAg0LLQtdGA0YHQuNC4LiDQktC+0LfQstGA0LDRidCw0LXRgiAtMSDQn9C+0YHQu9C10LTQvdGP0Y8g0LLQtdGA0YHQuNGPINCy0YHQtSDQtdGJ0ZEg0LHQvtC70YzRiNC1LAojIDAg0LXRgdC70Lgg0YDQsNCy0L3RiyDQuCAxINC10YHQu9C4INGC0LXQutGD0YnQsNGPINCy0LXRgNGB0LjRjyDQsdC+0LvRjNGI0LUg0L/QvtGB0LvQtdC00L3QtdC5CmRlZiBjb21wYXJlX3ZlcnNpb25zKHZlcnNpb24xLCB2ZXJzaW9uMik6CiAgICBwYXJ0czEgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24xLnNwbGl0KCcuJykpKQogICAgcGFydHMyID0gbGlzdChtYXAoaW50LCB2ZXJzaW9uMi5zcGxpdCgnLicpKSkKCiAgICBmb3IgcDEsIHAyIGluIHppcChwYXJ0czEsIHBhcnRzMik6CiAgICAgICAgaWYgcDEgPCBwMjoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgZWxpZiBwMSA+IHAyOgogICAgICAgICAgICByZXR1cm4gMQoKICAgIHJldHVybiAwCgoKI9Cf0YDQuNCx0LDQstC70Y/QtdC8IDEg0Log0L3QvtC80LXRgNGDINGC0LXQutGD0YnQtdC5INCy0LXRgNGB0LjQuCAo0L/QviDQs9GA0YPQv9C/0LDQvCwKIyDQvNCw0LrRgdC40LzRg9C8IDk5INCyINC+0LTQvdC+0Lkg0LPRgNGD0L/Qv9C1KSDQndCw0L/RgNC40LzQtdGAIDEuMS4xLjEuOTkgKyAxINC00LDRgdGCINC90LDQvCAxLjEuMS4yLjAKZGVmIGluY3JlbWVudF92ZXJzaW9uKHZlcnNpb24pOgogICAgcGFydHMgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24uc3BsaXQoJy4nKSkpCiAgICBwYXJ0c1stMV0gKz0gMQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHBhcnRzKSAtIDEsIDAsIC0xKToKICAgICAgICBpZiBwYXJ0c1tpXSA9PSAxMDA6CiAgICAgICAgICAgIHBhcnRzW2ldID0gMAogICAgICAgICAgICBwYXJ0c1tpIC0gMV0gKz0gMQogICAgcmV0dXJuICcuJy5qb2luKG1hcChzdHIsIHBhcnRzKSkKCgoKZGVmIHIwXzFfMF8xMl8zKGhhc2hfbWFwKToKICAgICMgQ29kZSBmb3IgcmVsZWFzZSAwLjEuMC4xMi4zCiAgICBxdGV4dCA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlIEFTIFNFTEVDVCAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzOwogICAgCiAgICBEUk9QIFRBQkxFIFJTX2JhcmNvZGVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfYmFyY29kZXMgKAogICAgICAgIGJhcmNvZGUgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfcHJvcGVydHkgVEVYVCwKICAgICAgICBpZF9zZXJpZXMgICBURVhULAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQsCiAgICAgICAgcmF0aW8gICAgICAgSU5URUdFUiBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19iYXJjb2RlcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgICAgICAKICAgIFVQREFURQogICAgUlNfYmFyY29kZXMKICAgIFNFVAogICAgcmF0aW8gPSBDT0FMRVNDRSgoCiAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvci9SU191bml0cy5kZW5vbWluYXRvcgogICAgRlJPTSBSU191bml0cwogICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICApLCAxKTsKICAgIAogICAgICAgIAogICAgRFJPUCBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZTsKICAgIAogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDE7CiAgICAnJycKCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocXRleHQsJycpCiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOlRydWV9CiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOkZhbHNlLCAnZGV0YWlscyc6ZifQntGI0LjQsdC60LAg0LIg0LfQsNC/0YDQvtGB0LU6IHtxdGV4dH0nfQoKCmRlZiByMF8xXzBfMTNfNyhoYXNoX21hcCk6CgogICAgcSA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFCiAgICBUQUJMRQogICAgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUKICAgIEFTCiAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3NfdGFibGU7CgogICAgRFJPUCBUQUJMRSBSU19kb2NzX3RhYmxlOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc190YWJsZSgKICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgUlNfZG9jcyhpZF9kb2MpCiAgICBPTiBERUxFVEUgQ0FTQ0FERSBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICBpZF9nb29kIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyBSU19nb29kcyhpZCksCiAgICBpZF9wcm9wZXJ0aWVzIFRFWFQgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzKGlkKSwKICAgIGlkX3NlcmllcyBURVhUIFJFRkVSRU5DRVMgUlNfc2VyaWVzKGlkKSwKICAgIGlkX3VuaXQgVEVYVCBOT1QgTlVMTCBSRUZFUkVOQ0VTIFJTX3VuaXRzKGlkKSwKICAgIHF0dHkgUkVBTCwgCiAgICBxdHR5X3BsYW4gUkVBTCwKICAgIHByaWNlIFJFQUwsCiAgICBpZF9wcmljZSBURVhUIFJFRkVSRU5DRVMgIFJTX3ByaWNlX3R5cGVzKGlkKSwKICAgIHNlbnQgSU5URUdFUiwKICAgIGxhc3RfdXBkYXRlZCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiBURVhUIERFRkFVTFQgVHJ1ZSwKICAgIGlkX2NlbGwgVEVYVCBSRUZFUkVOQ0VTIFJTX2NlbGxzKGlkKSwKICAgIHVzZV9zZXJpZXMgICAgSU5UICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMCkKICAgICk7CgogICAgSU5TRVJUIElOVE8gUlNfZG9jc190YWJsZSgKICAgICAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksCiAgICAgICAgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UsIHNlbnQsIGxhc3RfdXBkYXRlZCwgaXNfcGxhbiwgaWRfY2VsbAogICAgKQogICAgU0VMRUNUCiAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwKICAgIHByaWNlLCBpZF9wcmljZSwgc2VudCwgbGFzdF91cGRhdGVkLCBpc19wbGFuLCBpZF9jZWxsIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgIERST1AgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKCiAgICBDUkVBVEUgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUgQVMgU0VMRUNUICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllczsKCiAgICBEUk9QIFRBQkxFIFJTX2RvY3Nfc2VyaWVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc19zZXJpZXMgKAogICAgICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX2RvYyAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICAgICAgaWRfZ29vZCAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgICAgICBpZF93YXJlaG91c2UgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICAgICAgcXR0eSAgICAgICAgICAgIFJFQUwsCiAgICAgICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGJlc3RfYmVmb3JlICAgICBEQVRFVElNRSwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgICAgIGNlbGwgICAgICAgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19jZWxscyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICk7CiAgICAKICAgIElOU0VSVCBJTlRPIFJTX2RvY3Nfc2VyaWVzICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF0dHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdHR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICAKICAgIENSRUFURSBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZSBBUyBTRUxFQ1QgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jczsKICAgIAogICAgRFJPUCBUQUJMRSBSU19hZHJfZG9jczsKICAgIAogICAgQ1JFQVRFIFRBQkxFIFJTX2Fkcl9kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSAgICBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICAgICBERUZBVUxUIDAsCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCBURVhUICAgICBERUZBVUxUICgwKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkgCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19hZHJfZG9jcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19kYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmlmaWVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21hcmtfc2VsZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBQUkFHTUEgZm9yZWlnbl9rZXlzID0gMTsKCgogICAgJycnCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocSwnJykKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6VHJ1ZX0KICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6RmFsc2UsICdkZXRhaWxzJzpmJ9Ce0YjQuNCx0LrQsCDQsiDQt9Cw0L/RgNC+0YHQtToge3F9J30KCgojIGlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiMgICAgICMgUmVwbGFjZSB0aGVzZSB2ZXJzaW9ucyB3aXRoIHlvdXIgYWN0dWFsIHZlcnNpb24gbnVtYmVycwojICAgICBzdGFydF92ZXJzaW9uID0gIjAuMS4wLjExLjciCiMgICAgIHN0YXJ0X3ZlcnNpb24gPSAoInMiKQojICAgICBlbmRfdmVyc2lvbiA9ICIwLjEuMC4xMi4zIgojCiMgICAgIHByaW50KHJ1bl9yZWxlYXNlcyhzdGFydF92ZXJzaW9uLCBlbmRfdmVyc2lvbikpCiNwcmludChpc192YWxpZF92ZXJzaW9uKCIwMS4xLjAuMTEuMjYiKSk="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\new_handlers.py",
                "PyFileKey": "new_handlers",
                "PyFileData": "ZnJvbSBqYXZhIGltcG9ydCBqY2xhc3MKZnJvbSBwcmludGluZ19mYWN0b3J5IGltcG9ydCBQcmludFNlcnZpY2UKZnJvbSBydS50cmF2ZWxmb29kLnNpbXBsZV91aSBpbXBvcnQgU2ltcGxlVXRpbGl0ZXMgYXMgc3VDbGFzcwoKZnJvbSB1aV91dGlscyBpbXBvcnQgSGFzaE1hcAppbXBvcnQgdWlfbW9kZWxzCmZyb20gdWlfbW9kZWxzIGltcG9ydCBjcmVhdGVfc2NyZWVuCgpub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnJzX3NldHRpbmdzID0gbm9DbGFzcygicnNfc2V0dGluZ3MiKQoKCiMgPT09PT09PT09PT09PT09IE1haW4gZXZlbnRzID09PT09PT09PT09PT09PT09CgoKQEhhc2hNYXAoKQpkZWYgYXBwX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQv9GA0Lgg0YHRgtCw0YDRgtC1INC/0YDQuNC70L7QttC10L3QuNGPICIiIgoKICAgIG1vZGVsID0gdWlfbW9kZWxzLk1haW5FdmVudHMoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgbW9kZWwuYXBwX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0aW1lcl91cGRhdGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRhNC+0L3QvtCy0L7Qs9C+INC+0LHQvNC10L3QsCAiIiIKCiAgICB0aW1lciA9IHVpX21vZGVscy5UaW1lcihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICB0aW1lci50aW1lcl9vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZXZlbnRfc2VydmljZShoYXNoX21hcCk6CiAgICAiIiIg0J7QsdGA0LDQsdC+0YLRh9C40Log0LTQu9GPINGA0LDQsdC+0YLRiyDQnNCfINCyINGA0LXQttC40LzQtSDRgdC10YDQstC10YDQsC4KICAgICDQkiB3c19ib2R5INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOINC70LXQttC40YIg0YLQtdC60YHRgiDQutC+0L3RhNC40LPRg9GA0LDRhtC40LggIiIiCgogICAgdWlfbW9kZWxzLldlYlNlcnZpY2VTeW5jQ29tbWFuZChoYXNoX21hcCkub25fc2VydmljZV9yZXF1ZXN0KCkKCgoKQEhhc2hNYXAoKQpkZWYgb25fc3FsX2Vycm9yKGhhc2hfbWFwKToKICAgIG1vZGVsID0gdWlfbW9kZWxzLk1haW5FdmVudHMoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgbW9kZWwub25fc3FsX2Vycm9yKCkKCgpASGFzaE1hcCgpCmRlZiBvbl9jbG9zZV9hcHAoaGFzaF9tYXApOgogICAgIyDQn9C+0L/Ri9GC0LrQsCDQvtGH0LjRgdGC0LrQuCDQutGN0YjQsCDQv9GA0Lgg0LLRi9GF0L7QtNC1INGBINC/0YDQuNC70L7QttC10L3QuNGPCiAgICBzdUNsYXNzLmRlbGV0ZUNhY2hlKCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eIE1haW4gZXZlbnRzIF5eXl5eXl5eXl5eXl5eXl5eCgoKIyA9PT09PT09PT09PT09PT0gRG9jdW1lbnRzID09PT09PT09PT09PT09PT09CkBIYXNoTWFwKCkKZGVmIGZsb3dfZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd0RvY1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGZsb3dfZG9jc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBmbG93X3RpbGVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCe0YLQtNC10LvRjNC90YvQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC/0LvQuNGC0L7QuiDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDQv9GA0L7RhtC10YHRgdCwIGhhc2hfbWFwJ9C+0LwiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5GbG93VGlsZXNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmbG93X3RpbGVzX29uX3NlbGVjdChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd1RpbGVzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9mbG93X29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQodCx0L7RgCDQqNCaLiDQrdC60YDQsNC9OiDQn9C+0YLQvtC60KjRgtGA0LjRhdC60L7QtNC+0LLQlNC+0LrRg9C80LXQvdGC0LAiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5GbG93RG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfZmxvd19saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0KHQsdC+0YAg0KjQmi4g0K3QutGA0LDQvTog0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd0RvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX29iamVjdF9kZXRlY3RlZChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0KDQsNGB0L/QvtC30L3QsNCy0LDQvdC40LUg0LDRgNGC0LjQutGD0LvQvtCyLiDQqNCw0LM6INCd0L7QstGL0Lkg0YjQsNCzIEFjdGl2ZUNWLiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkFjdGl2ZUNWQXJ0aWNsZVJlY29nbml0aW9uKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9vYmplY3RfZGV0ZWN0ZWQoKQoKCkBIYXNoTWFwKCkKZGVmIGFydGljbGVfY3Zfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7Qsi4g0KjQsNCzOiDQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVi4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5BY3RpdmVDVkFydGljbGVSZWNvZ25pdGlvbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFydGljbGVfY3Zfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7Qsi4g0KjQsNCzOiDQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVi4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5BY3RpdmVDVkFydGljbGVSZWNvZ25pdGlvbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmlhbF9udW1iZXJfb2NyX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiBPY3JUZXh0UmVjb2duaXRpb24uINCt0LrRgNCw0L06IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlcmlhbE51bWJlck9DUlNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VyaWFsX251bWJlcl9vY3Jfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6IE9jclRleHRSZWNvZ25pdGlvbi4g0K3QutGA0LDQvTogU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTogT2NyVGV4dFJlY29nbml0aW9uLiDQrdC60YDQsNC9OiBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy4iIiIKICAgIHVpX21vZGVscy5TZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5zZXJpYWxfa2V5X3JlY29nbml0aW9uX29jcihoYXNoX21hcCkKCgpASGFzaE1hcCgpCmRlZiBkb2NzX3RpbGVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCe0YLQtNC10LvRjNC90YvQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC/0LvQuNGC0L7QuiDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDQv9GA0L7RhtC10YHRgdCwIGhhc2hfbWFwJ9C+0LwiIiIKICAgIHNjcmVlbjogdWlfbW9kZWxzLkRvY3VtZW50c1RpbGVzID0gdWlfbW9kZWxzLkRvY3VtZW50c1RpbGVzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3NfdGlsZXNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2NhblRpbGVzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0aWxlc19vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2NzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Eb2N1bWVudHNEb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkRvY3VtZW50c0RvY3NMaXN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBncm91cF9kb2NzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5Eb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZG9jc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2NhbkRvY3NMaXN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgoKIyBASGFzaE1hcCgpCiMgZGVmIGRvY19kZXRhaWxzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKIyAgICAgc2NyZWVuOiB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiMgICAgIHNjcmVlbi5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBkb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3ID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfYmVmb3JlX3Byb2Nlc3NfYmFyY29kZShoYXNoX21hcCk6CiAgICAiIiIg0J7QsdGA0LDQsdC+0YLRh9C40Log0LTQu9GPINGB0LjQvdGF0YDQvtC90L3QvtCz0L4g0LfQsNC/0YDQvtGB0LAg0Lgg0L7QsdC90L7QstC70LXQvdC40Y8g0LTQsNC90L3Ri9GFINC/0L7RgdC70LUg0YHQutCw0L3QuNGA0L7QstCw0L3QuNGPINC4INC/0LXRgNC10LQg0L7QsdGA0LDQsdC+0YLQutC+0Lkg0KjQmiIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5iZWZvcmVfcHJvY2Vzc19iYXJjb2RlKCkKCgpASGFzaE1hcCgpCmRlZiBkb2NfcnVuX3Bvc3RfYmFyY29kZV9zY2FubmVkKGhhc2hfbWFwKToKICAgICIiIiDQntGC0L/RgNCw0LLQutCwINC00LDQvdC90YvRhSDQv9C+0YHQu9C1INC+0LHRgNCw0LHQvtGC0LrQuCDQqNCaIiIiCgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLmhhc2hfbWFwLnJlbW92ZSgndG9hc3QnKQogICAgc2NyZWVuLnBvc3RfYmFyY29kZV9zY2FubmVkKCkKCgpASGFzaE1hcCgpCmRlZiBkb2Nfc2Nhbl9lcnJvcl9zb3VuZChoYXNoX21hcCk6CiAgICAiIiIg0JfQstGD0LrQvtCy0YvQtSDRgdC40LPQvdCw0LvRiyDQvtGI0LjQsdC+0Log0YHQutCw0L3QuNGA0L7QstCw0L3QuNGPIiIiCgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLnNjYW5fZXJyb3Jfc291bmQoKQoKCkBIYXNoTWFwKCkKZGVmIGhpZ2hsaWdodF9zY2FubmVkX2l0ZW0oaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDQvtGC0LzQtdC90Ysg0YDQsNGB0LrRgNCw0YHQutC4INC+0YLRgdC60LDQvdC40YDQvtCy0LDQvdC90L7Qs9C+INGC0L7QstCw0YDQsCAiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5kaXNhYmxlX2hpZ2hsaWdodCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VuZF9wb3N0X2xpbmVzX2RhdGEoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0YLQv9GA0LDQstC60LAg0L3QsCAx0KEg0LLRi9Cx0YDQsNC90L3Ri9GFINCyIG5vc3FsINGB0YLRgNC+0LogcG9zdC3Qt9Cw0L/RgNC+0YHQvtC8ICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLnNlbmRfdW5zZW50X2xpbmVzX3J1bigpCgoKQEhhc2hNYXAoKQpkZWYgc2VuZF9hbGxfc2Nhbl9saW5lcyhoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J7RgtC/0YDQsNCy0LrQsCDQvdCwIDHQoSDQstGB0LXRhSBub3NxbCDRgdGC0YDQvtC6INGC0L7QstCw0YDQsCBwb3N0LdC30LDQv9GA0L7RgdC+0LwgIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uc2VuZF9hbGxfc2Nhbl9saW5lc19ydW4oKQoKCkBIYXNoTWFwKCkKZGVmIGFmdGVyX3NlbmRfcG9zdF9saW5lc19kYXRhKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQn9C+0YHQu9C1INC+0YLQv9GA0LDQstC60Lgt0L7QsdGA0LDQsdC+0YLQutC4IHBvc3Qt0LfQsNC/0YDQvtGB0LAgIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uYWZ0ZXJfc2VuZF9kYXRhKCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKAogICAgICAgIGhhc2hfbWFwPWhhc2hfbWFwLAogICAgICAgIHNjcmVlbl9jbGFzcz11aV9tb2RlbHMuQWRyRG9jc0xpc3RTY3JlZW4KICAgICkKICAgIHNjcmVlbi5pbml0X3NjcmVlbigpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgaGFzaF9tYXA9aGFzaF9tYXAsCiAgICAgICAgc2NyZWVuX2NsYXNzPXVpX21vZGVscy5BZHJEb2NzTGlzdFNjcmVlbgogICAgKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZG9jX2RldGFpbHNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkFkckRvY0RldGFpbHNTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2NfZGV0YWlsc19vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuQWRyRG9jRGV0YWlsc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vZmZsaW5lX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Eb2NzT2ZmbGluZUxpc3RTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBlbGVtX3ZpZXZfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdvb2RzU2VsZWN0U2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZWxlbV92aWV2X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc1NlbGVjdFNjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9lbGVtX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkFkckdvb2RzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZWxlbV92aWV3X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5BZHJHb29kc1NlbGVjdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX3JlZ2lzdGVyX2RvY19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX3JlZ2lzdGVyX2RvY19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBncm91cF9lbGVtX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2Nhbkl0ZW1TY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2VsZW1fdmlld19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuSXRlbVNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBncm91cF9lbGVtX3ZpZXdfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2Nhbkl0ZW1TY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfZXJyb3Jfc2NyZWVuX2xpc3RlbmVyKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIGlmIGhhc2hfbWFwWydsaXN0ZW5lciddIGluIFsnT05fQkFDS19QUkVTU0VEJywgJ2J0bl9jb250aW51ZV9zY2FuJ106CiAgICAgICAgaGFzaF9tYXAuc2hvd19zY3JlZW4oItCU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLIikKCgojIF5eXl5eXl5eXl5eXl5eXl5eIERvY3VtZW50cyBeXl5eXl5eXl5eXl5eXl5eXgoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X2l0ZW1fb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgdWlfbW9kZWxzLlNlbGVjdEl0ZW1TY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKS5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X2l0ZW1fb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgdWlfbW9kZWxzLlNlbGVjdEl0ZW1TY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKS5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X2l0ZW1fcmVzdWx0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIGhhc2hfbWFwLnRvYXN0KCdzZWxlY3RfaXRlbV9yZXN1bHQnKQoKQEhhc2hNYXAoKQpkZWYgc2hvd19pdGVtc19zY3JlZW5fb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNob3dJdGVtc1NjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBzaG93X2l0ZW1zX3NjcmVlbl9vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2hvd0l0ZW1zU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojID09PT09PT09PT09PT09PSBHb29kcyA9PT09PT09PT09PT09PT09PQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hb29kc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4uaW5pdF9zY3JlZW4oKS5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZHNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VsZWN0X3R5cGVfZ29vZHNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlbGVjdEdvb2RzVHlwZShoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF90eXBlX2dvb2RzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RHb29kc1R5cGUoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBnb29kX2NhcmRfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkl0ZW1DYXJkKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBnb29kX2NhcmRfcG9zdF9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuSXRlbUNhcmQpCiAgICBzY3JlZW4ub25fcG9zdF9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5JdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgb2ZmbGluZV9nb29kX2NhcmRfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkl0ZW1DYXJkT2ZmbGluZVNjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl4gR29vZHMgXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNCYWxhbmNlcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgYmFsYW5jZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuR29vZHNCYWxhbmNlc0l0ZW1DYXJkID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgYmFsYW5jZXNfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdvb2RzQmFsYW5jZXNJdGVtQ2FyZChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzQmFsYW5jZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHNQcmljZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIHByaWNlc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5Hb29kc1ByaWNlc0l0ZW1DYXJkID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpY2VzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc1ByaWNlc0l0ZW1DYXJkKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHNQcmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PSBTZXR0aW5ncyA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX29uX2NsaWNrKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkZvbnRTaXplU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVfc2V0dGluZ3NfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRm9udFNpemVTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlc3RfYmFyY29kZV9saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5CYXJjb2RlVGVzdFNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9jbGljayhoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0dHBfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuSHR0cFNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgaHR0cF9zZXR0aW5nc19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5IdHRwU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzb3VuZF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU291bmRTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKICAgICMgc2NyZWVuID0gdWlfbW9kZWxzLlNlbGVjdEdvb2RzVHlwZShoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAjIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc291bmRfc2V0dGluZ3NfbGlzdGVuZXIoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNvdW5kU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2N1bWVudHNfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LDRgNCw0LzQtdGC0YDRiy4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jdW1lbnRzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBkb2N1bWVudHNfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LDRgNCw0LzQtdGC0YDRiy4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jdW1lbnRzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eIFNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PSBQcmludCA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50U2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlbXBsYXRlX2xpc3Rfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LIiIiIKICAgIHNjcmVlbjogdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QgPSB1aV9tb2RlbHMuVGVtcGxhdGVzTGlzdChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlbXBsYXRlX2xpc3Rfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LIiIiIKICAgIHNjcmVlbjogdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QgPSB1aV9tb2RlbHMuVGVtcGxhdGVzTGlzdChoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0bWxfdmlld19vbl9zdGFydChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQoNC10LfRg9C70YzRgtCw0YIiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5IdG1sVmlldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0bWxfdmlld19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQoNC10LfRg9C70YzRgtCw0YIiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5IdG1sVmlldyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2JsdWV0b290aF9zZXR0aW5nc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IEJsdWV0b290aCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50Qmx1ZXRvb3RoU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9ibHVldG9vdGhfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludEJsdWV0b290aFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2hfbWFwKToKICAgICIiItCe0LHRidC40Lkg0L7QsdGA0LDQsdC+0YLRh9C40Log0L7RiNC40LHQutC4INC/0YDQuCDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBCbHVldG9vdGgiIiIKICAgIFByaW50U2VydmljZS5ibHVldG9vdGhfZXJyb3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfd2lmaV9zZXR0aW5nc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IFdpRmkiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFdpRmlTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X3dpZmlfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRXaUZpU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF93aWZpKGhhc2hfbWFwKToKICAgICIiItCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBXaUZpLiDQlNC+0LvQttC10L0g0LHRi9GC0Ywg0LLRi9C30LLQsNC9INCw0YHQuNC90YXRgNC+0L3QvdC+IiIiCiAgICBQcmludFNlcnZpY2UucHJpbnRfd2lmaShoYXNoX21hcCkKCgpASGFzaE1hcCgpCmRlZiB3aWZpX2Vycm9yKGhhc2hfbWFwKToKICAgICIiItCe0LHRidC40Lkg0L7QsdGA0LDQsdC+0YLRh9C40Log0L7RiNC40LHQutC4INC/0YDQuCDQv9C10YfQsNGC0Lgg0YfQtdGA0LXQtyBXaUZpIiIiCiAgICBQcmludFNlcnZpY2Uud2lmaV9lcnJvcihoYXNoX21hcCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50TGFiZWxUZW1wbGF0ZXNTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRMYWJlbFRlbXBsYXRlc1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfbGFiZWxfdGVtcGxhdGVfc2l6ZV9vbl9pbnB1dChoYXNoX21hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0J/QtdGH0LDRgtGMLiDQrdC60YDQsNC9OiDQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCg0LDQt9C80LXRgNGLIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRUZW1wbGF0ZVNpemVTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlX3NpemVfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50VGVtcGxhdGVTaXplU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXApOgogICAgIiIi0KHRgNCw0LHQsNGC0YvQstCw0LXRgiDQv9C+0YHQu9C1INCy0YvQt9C+0LLQsCBQcmludFNlcnZpY2UucHJpbnQg0Lgg0L/QtdGH0LDRgtCw0LXRgiDRhtC10L3QvdC40LoiIiIKICAgIFByaW50U2VydmljZS5wcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXApCgojIF5eXl5eXl5eXl5eXl5eXl5eIFByaW50IF5eXl5eXl5eXl5eXl5eXl5eCgoKQEhhc2hNYXAoKQpkZWYgZmlsZV9icm93c2VyX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TaW1wbGVGaWxlQnJvd3NlcihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGZpbGVfYnJvd3Nlcl9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2ltcGxlRmlsZUJyb3dzZXIoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojID09PT09PT09PT09PT09PSBEZWJ1ZyA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgZGVidWdfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRGVidWdTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRlYnVnX2xpc3RlbmVyKGhhc2hfbWFwLCBfZmlsZXM9Tm9uZSwgX2RhdGE9Tm9uZSk6CiAgICBzY3JlZW46IHVpX21vZGVscy5EZWJ1Z1NldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgojIF5eXl5eXl5eXl5eXl5eXl5eIERlYnVnIF5eXl5eXl5eXl5eXl5eXl5eCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\printing_factory.py",
                "PyFileKey": "printing_factory",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBUdXBsZSwgQW55LCBVbmlvbgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVVdGlsaXRlcyBhcyBzdUNsYXNzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgenBsCmZyb20gUElMIGltcG9ydCBJbWFnZQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cAppbXBvcnQgYmFyY29kZQpmcm9tIGJhcmNvZGUud3JpdGVyIGltcG9ydCBJbWFnZVdyaXRlcgppbXBvcnQgcXJjb2RlCmZyb20gamluamEyIGltcG9ydCBFbnZpcm9ubWVudCwgRmlsZVN5c3RlbUxvYWRlciwgc2VsZWN0X2F1dG9lc2NhcGUsIG1ldGEKaW1wb3J0IGJhc2U2NApmcm9tIGlvIGltcG9ydCBCeXRlc0lPCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwpmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZUJsdWV0b290aApub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCmJ0ID0gU2ltcGxlQmx1ZXRvb3RoKCkKCgpjbGFzcyBIVE1MRG9jdW1lbnQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVtcGxhdGVfZGlyZWN0b3J5LCB0ZW1wbGF0ZV9maWxlKToKICAgICAgICBzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSA9IHRlbXBsYXRlX2RpcmVjdG9yeQogICAgICAgIHNlbGYudGVtcGxhdGVfZmlsZSA9IHRlbXBsYXRlX2ZpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2VuZXJhdGVfYmFyY29kZShkYXRhLCBiYXJjb2RlX3R5cGU9J2VhbjEzJyk6CiAgICAgICAgZWFuX2NsYXNzID0gYmFyY29kZS5nZXRfYmFyY29kZV9jbGFzcyhiYXJjb2RlX3R5cGUpCiAgICAgICAgd3JpdGVyID0gSW1hZ2VXcml0ZXIoKQogICAgICAgIGVhbiA9IGVhbl9jbGFzcyhkYXRhLCB3cml0ZXI9d3JpdGVyKQoKICAgICAgICBiYXJjb2RlX2ltYWdlID0gQnl0ZXNJTygpCiAgICAgICAgZWFuLndyaXRlKGJhcmNvZGVfaW1hZ2UpCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYmFyY29kZV9pbWFnZS5nZXR2YWx1ZSgpKS5kZWNvZGUoKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZW5lcmF0ZV9xcl9jb2RlKGJhcmNvZGVfZGF0YSk6CiAgICAgICAgcXIgPSBxcmNvZGUuUVJDb2RlKHZlcnNpb249MSwgYm94X3NpemU9MTAsIGJvcmRlcj01KQogICAgICAgIHFyLmFkZF9kYXRhKGJhcmNvZGVfZGF0YSkKICAgICAgICBxci5tYWtlKGZpdD1UcnVlKQogICAgICAgIGltZyA9IHFyLm1ha2VfaW1hZ2UoZmlsbF9jb2xvcj0iYmxhY2siLCBiYWNrX2NvbG9yPSJ3aGl0ZSIpCgogICAgICAgIGJ1ZmZlcmVkID0gQnl0ZXNJTygpCiAgICAgICAgaW1nLnNhdmUoYnVmZmVyZWQsIGZvcm1hdD0iUE5HIikKCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYnVmZmVyZWQuZ2V0dmFsdWUoKSkuZGVjb2RlKCkKCiAgICBkZWYgY3JlYXRlX2h0bWwoc2VsZiwgcGFyYW1ldGVycywgYmFyY29kZV90eXBlPSdlYW4xMycpOgogICAgICAgIGVudiA9IEVudmlyb25tZW50KAogICAgICAgICAgICBsb2FkZXI9RmlsZVN5c3RlbUxvYWRlcihzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSksCiAgICAgICAgICAgIGF1dG9lc2NhcGU9c2VsZWN0X2F1dG9lc2NhcGUoWydodG1sJywgJ3htbCddKSwKICAgICAgICAgICAgdmFyaWFibGVfc3RhcnRfc3RyaW5nPSdbJywKICAgICAgICAgICAgdmFyaWFibGVfZW5kX3N0cmluZz0nXScsCiAgICAgICAgKQogICAgICAgIGlmIGJhcmNvZGVfdHlwZSA9PSAncXItY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGVfaW1hZ2VfYmFzZTY0ID0gc2VsZi5nZW5lcmF0ZV9xcl9jb2RlKHBhcmFtZXRlcnNbJ2JhcmNvZGUnXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlX2ltYWdlX2Jhc2U2NCA9IHNlbGYuZ2VuZXJhdGVfYmFyY29kZShwYXJhbWV0ZXJzWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGVfdHlwZSkKCiAgICAgICAgdGVtcGxhdGUgPSBlbnYuZ2V0X3RlbXBsYXRlKHNlbGYudGVtcGxhdGVfZmlsZSkKCiAgICAgICAgYWEgPSB0ZW1wbGF0ZS5yZW5kZXIocGFyYW1ldGVycykKCiAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAoYWEsICdodG1sLnBhcnNlcicpCiAgICAgICAgZm9yIGltZ3RhZyBpbiBzb3VwLmZpbmRfYWxsKCJpbWciKToKICAgICAgICAgICAgaW1ndGFnWydzcmMnXSA9ICgiZGF0YTppbWFnZS9wbmc7IHdpZHRoOmF1dG87IGhlaWdodDphdXRvOyBiYXNlNjQsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYmFyY29kZV9pbWFnZV9iYXNlNjQpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZmluZF90ZW1wbGF0ZV92YXJpYWJsZXMoZGlyZWN0b3J5OiBzdHIsIGZpbGVfbmFtZTogc3RyKToKICAgICAgICBlbnYgPSBFbnZpcm9ubWVudCgKICAgICAgICAgICAgbG9hZGVyPUZpbGVTeXN0ZW1Mb2FkZXIoZGlyZWN0b3J5KSwKICAgICAgICAgICAgYXV0b2VzY2FwZT1zZWxlY3RfYXV0b2VzY2FwZShbJ2h0bWwnLCAneG1sJ10pLAogICAgICAgICAgICB2YXJpYWJsZV9zdGFydF9zdHJpbmc9J1snLAogICAgICAgICAgICB2YXJpYWJsZV9lbmRfc3RyaW5nPSddJywKICAgICAgICApCiAgICAgICAgdGVtcGxhdGVfc291cmNlID0gZW52LmxvYWRlci5nZXRfc291cmNlKGVudiwgZmlsZV9uYW1lKVswXQogICAgICAgIHBhcnNlZF9jb250ZW50ID0gZW52LnBhcnNlKHRlbXBsYXRlX3NvdXJjZSkKICAgICAgICBwYXJhbXMgPSBtZXRhLmZpbmRfdW5kZWNsYXJlZF92YXJpYWJsZXMocGFyc2VkX2NvbnRlbnQpCiAgICAgICAgaWYgJ2JhcmNvZGUnIG5vdCBpbiBwYXJhbXM6CiAgICAgICAgICAgIHBhcmFtcy5hZGQoJ2JhcmNvZGUnKQogICAgICAgIHJldHVybiBwYXJhbXMKCiAgICBkZWYgZ2V0X3RlbXBsYXRlKHNlbGYpOgoKICAgICAgICB3aXRoIG9wZW4oUGF0aChzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSkgLyBzZWxmLnRlbXBsYXRlX2ZpbGUsICJyIiwKICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9InV0Zi04IikgYXMgZmlsZToKICAgICAgICAgICAgaHRtbF9ib2R5ID0gZmlsZS5yZWFkKCkKCiAgICAgICAgcmV0dXJuIGh0bWxfYm9keQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbmplY3RfY3NzX3N0eWxlKGh0bWwsIHdpZHRoOiBzdHIsIGhlaWdodDogc3RyLCB4OiBzdHIsIHk6IHN0cik6CiAgICAgICAgY3NzX3RlbXBsYXRlMiA9ICcnJwogICAgICAgICAgQHBhZ2UgewogICAgICAgICAgICBtYXJnaW46IDFtbTsgLyogQWRqdXN0IGlmIG5lY2Vzc2FyeSAqLwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZmZmZjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsOwogICAgICAgICAgICBmb250LXNpemU6IDhwdDsKICAgICAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgICAgIH0KCiAgICAgICAgLmZ1bGwtdGVtcGxhdGUgewogICAgICAgICAgICB3aWR0aDogY2FsYygxMDB2dyAtIDJtbSk7ICAKICAgICAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMm1tKTsKICAgICAgICAgICAgbWluLXdpZHRoOiA0MG1tOyAgICAvKiBNaW5pbXVtIHdpZHRoICovCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQwbW07ICAgLyogTWluaW11bSBoZWlnaHQgKi8KICAgICAgICAgICAgYm9yZGVyOiAxcHQgc29saWQgYmxhY2s7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IC8qIGVuc3VyZXMgcGFkZGluZyBhbmQgYm9yZGVyIGFyZSBpbmNsdWRlZCBpbiB0aGUgdG90YWwgd2lkdGggYW5kIGhlaWdodCAqLwogICAgICAgICAgICBwYWdlLWJyZWFrLWluc2lkZTogYXZvaWQ7IC8qIEF2b2lkIGJyZWFraW5nIGluc2lkZSB0aGUgdGVtcGxhdGUgKi8KICAgICAgICB9CgogICAgICAgIGltZyB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKCcnJyArIHggKyAnJydweCwgJycnICsgeSArICcnJ3B4KTsKICAgICAgICAgICAgd2lkdGg6ICcnJyArIHdpZHRoICsgJycnbW07CiAgICAgICAgICAgIGhlaWdodDogJycnICsgaGVpZ2h0ICsgJycnbW07CiAgICAgICAgfQoKICAgICAgICB0YWJsZSB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7CiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgICAgICAgICAgIHBhZ2UtYnJlYWstaW5zaWRlOiBhdm9pZDsgLyogQXZvaWQgYnJlYWtpbmcgaW5zaWRlIHRoZSB0YWJsZSAqLwogICAgICAgIH0KCiAgICAgICAgdGQgewogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgfQogICAgICAgICcnJwoKICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cChodG1sLCAiaHRtbC5wYXJzZXIiKQogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INGB0LLQvtC4INGB0YLQuNC70Lgg0LIg0LTQvtC60YPQvNC10L3RggogICAgICAgIGhlYWRfdGFnID0gc291cC5oZWFkCiAgICAgICAgc3R5bGVfdGFnID0gc291cC5uZXdfdGFnKCJzdHlsZSIpCiAgICAgICAgc3R5bGVfdGFnLnN0cmluZyA9IGNzc190ZW1wbGF0ZTIKICAgICAgICBoZWFkX3RhZy5hcHBlbmQoc3R5bGVfdGFnKQogICAgICAgICMg0JfQsNC/0LjRhdGD0LXQvCDQstC10YHRjCDQtNC+0LrRg9C80LXQvdGCINCyINC60L7QvdGC0LXQudC90LXRgAogICAgICAgIHdyYXBwZXIgPSBzb3VwLm5ld190YWcoImRpdiIpCiAgICAgICAgd3JhcHBlclsnY2xhc3MnXSA9ICdmdWxsLXRlbXBsYXRlJwogICAgICAgIGJvZHlfY2hpbGRyZW4gPSBsaXN0KHNvdXAuYm9keS5jaGlsZHJlbikKICAgICAgICBzb3VwLmJvZHkuY2xlYXIoKQogICAgICAgIHNvdXAuYm9keS5hcHBlbmQod3JhcHBlcikKICAgICAgICBmb3IgY2hpbGQgaW4gYm9keV9jaGlsZHJlbjoKICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoY2hpbGQpCgogICAgICAgICMg0KPQtNCw0LvRj9C10Lwg0L/Rg9GB0YLRi9C1INGP0YfQtdC50LrQuCDQuNC3INGC0LDQsdC70LjRhtGLLCDQutC+0YLQvtGA0YvQtSDRgtCw0Log0LvRjtCx0LjRgiAx0YEKICAgICAgICBmb3IgdHIgaW4gc291cC5maW5kX2FsbCgndHInKToKCiAgICAgICAgICAgIGZvciB0ZCBpbiB0ci5maW5kX2FsbCgndGQnKToKICAgICAgICAgICAgICAgIGlmIG5vdCB0ZC5hdHRycy5nZXQoJ2NsYXNzJyk6CiAgICAgICAgICAgICAgICAgICAgdGQuZGVjb21wb3NlKCkKICAgICAgICAjINCb0LjRiNC90LjQtSDQutC+0LvQvtC90LrQuCDRgdC/0YDQsNCy0LAg0YPQtNCw0LvRj9C10Lwg0YLQvtC20LUKICAgICAgICBmb3IgY29sIGluIHNvdXAuZmluZF9hbGwoJ2NvbCcpOgogICAgICAgICAgICBpZiBub3QgY29sLmF0dHJzOgogICAgICAgICAgICAgICAgY29sLmRlY29tcG9zZSgpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCgpjbGFzcyBQcmludFNlcnZpY2U6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU6IGludCwKICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBwYXRoX3RvX2ltZzogc3RyCiAgICApIC0+IHN0cjoKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMgenBsINGBINC60LDRgNGC0LjQvdC60L7QuSDQstC90YPRgtGA0LgiIiIKICAgICAgICBsYWJlbCA9IHpwbC5MYWJlbCgKICAgICAgICAgICAgd2lkdGg9aW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUgKiAyLAogICAgICAgICAgICBoZWlnaHQ9aW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlICogMiwKICAgICAgICAgICAgZHBtbT1kcG1tX3ByaW50X3RlbXBsYXRlCiAgICAgICAgKQogICAgICAgIGxhYmVsLm9yaWdpbihpbWFnZV94X3ByaW50X3RlbXBsYXRlLCBpbWFnZV95X3ByaW50X3RlbXBsYXRlKQogICAgICAgIGxhYmVsLndyaXRlX2dyYXBoaWMoCiAgICAgICAgICAgIGltYWdlPUltYWdlLm9wZW4ocGF0aF90b19pbWcpLAogICAgICAgICAgICB3aWR0aD1pbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZSAqIDIsCiAgICAgICAgICAgIGhlaWdodD1pbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUgKiAyCiAgICAgICAgKQogICAgICAgIGxhYmVsLmVuZG9yaWdpbigpCiAgICAgICAgenBsX2RhdGEgPSBsYWJlbC5kdW1wWlBMKCkKICAgICAgICBsbCA9IGltYWdlX2xsX3ByaW50X3RlbXBsYXRlCiAgICAgICAgcHcgPSBpbWFnZV9wd19wcmludF90ZW1wbGF0ZQogICAgICAgIGlmIGxsIGFuZCBwdzoKICAgICAgICAgICAgenBsX2RhdGEgPSB6cGxfZGF0YS5yZXBsYWNlKCdeWEEnLCAnXlhBJyArIGYnXkxMe2xsfScgKyBmJ15QV3twd30nLCAxKQogICAgICAgIHJldHVybiB6cGxfZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB6cGxfdG9fcG5nX2Zyb21fYXBpKAogICAgICAgICAgICB6cGxfZGF0YTogc3RyLAogICAgICAgICAgICBkcG1tOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX3dpZHRoOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX2hlaWdodDogaW50LAogICAgKSAtPiBUdXBsZVtib29sLCBBbnldOgogICAgICAgICIiIgogICAgICAgINCU0LXQu9Cw0LXRgiDQt9Cw0L/RgNC+0YEg0LogQVBJLiDQntGC0L/RgNCw0LLQu9GP0Y7RgtGB0Y8genBsINC60L7QtCDQuCDRgNCw0LfQvNC10YDRiyDRjdGC0LjQutC10YLQutC4LgogICAgICAgICIiIgogICAgICAgIGZpbGVzID0geydmaWxlJzogenBsX2RhdGF9CgogICAgICAgIHVybCA9IChmJ2h0dHA6Ly9hcGkubGFiZWxhcnkuY29tL3YxL3ByaW50ZXJzL3tkcG1tfWRwbW0vJwogICAgICAgICAgICAgICBmJ2xhYmVscy97bW1fdG9faW5jaChsYWJlbF93aWR0aCAqIDIpfXh7bW1fdG9faW5jaChsYWJlbF9oZWlnaHQgKiAyKX0vMC8nKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIHN0cmVhbT1UcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgcmVzcG9uc2UudGV4dAoKICAgICAgICByZXNwb25zZS5yYXcuZGVjb2RlX2NvbnRlbnQgPSBUcnVlCiAgICAgICAgcmV0dXJuIFRydWUsIHJlc3BvbnNlLnJhdwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludChoYXNoX21hcCwgZGF0YTogZGljdCk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsYWJlbF9wYXRoID0gcHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJykKICAgICAgICBpZiBub3QgbGFiZWxfcGF0aDoKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRiNCw0LHQu9C+0L3QsCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhwcmludF9uY2wuZ2V0KCdtYXRjaGluZ190YWJsZScpKQogICAgICAgIHRlbXBsYXRlX2RpcmVjdG9yeSwgdGVtcGxhdGVfZmlsZSA9IG9zLnBhdGguc3BsaXQobGFiZWxfcGF0aCkKICAgICAgICBkYXRhX2Zvcl9wcmludGluZyA9IHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGEsIG1hdGNoaW5nX3RhYmxlKQoKICAgICAgICBodG1scmVzdWx0ID0gSFRNTERvY3VtZW50KAogICAgICAgICAgICB0ZW1wbGF0ZV9kaXJlY3RvcnksIHRlbXBsYXRlX2ZpbGUKICAgICAgICApLmNyZWF0ZV9odG1sKGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9cHJpbnRfbmNsLmdldCgnYmFyY29kZV90eXBlJykpCgogICAgICAgIGh0bWxyZXN1bHQgPSBIVE1MRG9jdW1lbnQuaW5qZWN0X2Nzc19zdHlsZSgKICAgICAgICAgICAgaHRtbHJlc3VsdCwKICAgICAgICAgICAgd2lkdGg9c3RyKGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX3dpZHRoJykpKSwKICAgICAgICAgICAgaGVpZ2h0PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9oZWlnaHQnKSkpLAogICAgICAgICAgICB4PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9yaWdodCcpKQogICAgICAgICAgICAgICAgICAtIGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX2xlZnQnKSkpLAogICAgICAgICAgICB5PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9kb3duJykpCiAgICAgICAgICAgICAgICAgIC0gaW50KHByaW50X25jbC5nZXQoJ2JhcmNvZGVfdXAnKSkpLAogICAgICAgICkKCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Ce0YLQv9GA0LDQstC70LXQvdC+INC90LAg0L/QtdGH0LDRgtGMJykKICAgICAgICBoYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJSdW5FdmVudCIsCiAgICAgICAgICAgIGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICJhY3Rpb24iOiAicnVuYXN5bmMiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiaHRtbDJpbWFnZSIsCiAgICAgICAgICAgICAgICAibWV0aG9kIjogaHRtbHJlc3VsdCwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6IGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uIjogInJ1biIsCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicHl0aG9uIiwKICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogInByaW50X3Bvc3RfZXhlY3V0ZSIKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9XSkKICAgICAgICApCgogICAgICAgIGZpbGVuYW1lID0gc3VDbGFzcy5nZXRfdGVtcF9maWxlKCJwbmciKQogICAgICAgIHByaW50X25jbC5wdXQoJ3BhdGhfdG9faHRtbDJpbWFnZV9maWxlJywgZmlsZW5hbWUsIFRydWUpCiAgICAgICAgaGFzaF9tYXAucHV0KCJodG1sMmltYWdlX1RvRmlsZSIsIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHBhdGhfdG9faW1nID0gcHJpbnRfbmNsLmdldCgncGF0aF90b19odG1sMmltYWdlX2ZpbGUnKQogICAgICAgIHNhdmVkX3RlbXBsYXRlID0gcHJpbnRfbmNsLmdldCgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGlmIG5vdCBzYXZlZF90ZW1wbGF0ZToKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRgdC+0YXRgNCw0L3QtdC90L3QvtCz0L4g0YjQsNCx0LvQvtC90LAg0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2F2ZWRfdGVtcGxhdGUgPSBqc29uLmxvYWRzKHNhdmVkX3RlbXBsYXRlKQogICAgICAgIHpwbGRhdGEgPSBQcmludFNlcnZpY2UubWFrZV96cGxfZnJvbV9sYWJlbCgKICAgICAgICAgICAgcGF0aF90b19pbWc9cGF0aF90b19pbWcsICoqc2F2ZWRfdGVtcGxhdGUpCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50X3pwbCh6cGxkYXRhLCBoYXNoX21hcCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfenBsKHpwbF9kYXRhOiBzdHIsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBwcmludF90aHJvdWdoID0gcHJpbnRfbmNsLmdldCgncHJpbnRfdGhyb3VnaCcpCiAgICAgICAgaWYgbm90IHByaW50X3Rocm91Z2g6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INCy0YvQsdGA0LDQvdC+INGD0YHRgtGA0L7QudGB0YLQstC+INC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgIGVsaWYgcHJpbnRfdGhyb3VnaCA9PSAnQlQnOgogICAgICAgICAgICBzZW50LCByZXN1bHQgPSBQcmludFNlcnZpY2UucHJpbnRfYnQoenBsX2RhdGEpCiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KHJlc3VsdCkKICAgICAgICBlbGlmIHByaW50X3Rocm91Z2ggPT0gJ1dpRmknOgogICAgICAgICAgICBwcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGxfZGF0YSwgVHJ1ZSkKICAgICAgICAgICAgaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfd2lmaShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaXAgPSBwcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRhdGEgPSBwcmludF9uY2wuZ2V0KCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L/QtdGH0LDRgtC4IHdpZmknKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBwcmludF9uY2wuZGVsZXRlKCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGZhaWxfaGFuZGxlcnMgPSBbeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJ3aWZpX2Vycm9yIn1dCiAgICAgICAgc2VuZGVkID0gc3VDbGFzcy53cml0ZV9zb2NrZXQoaXAsIDkxMDAsIGRhdGEsIGpzb24uZHVtcHMoZmFpbF9oYW5kbGVycykpCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cj0YHQv9C10YjQvdC+JyBpZiBzZW5kZWQgZWxzZSAn0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3QvicpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHByaW50X2J0KGRhdGE6IFVuaW9uW3N0ciwgaW50LCBieXRlc10pOgogICAgICAgIG5jbCA9IG5vQ2xhc3MoImJ0X3NldHRpbmdzIikKICAgICAgICBidF9oYW5kbGVycyA9IFt7ImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJweXRob24iLCAibWV0aG9kIjogImJsdWV0b290aF9lcnJvciJ9XQogICAgICAgIHByaW50ZXIgPSBuY2wuZ2V0KCJkZWZhdWx0X3ByaW50ZXIiKQogICAgICAgIGlmIHByaW50ZXIgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCAi0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3Qvi7QndC1INCy0YvQsdGA0LDQvSBCVC3Qv9GA0LjQvdGC0LXRgCIKICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKHByaW50ZXIpCiAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgItCd0LUg0L7RgtC/0YDQsNCy0LvQtdC90L4u0J3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8g0Log0YPRgdGC0YDQvtC50YHRgtCy0YMiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgKCLQntGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjC4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiDQn9C10YDQtdC/0L7QtNC60LvRjtGH0LjRgtC1INC/0YDQuNC90YLQtdGALCDQtdGB0LvQuCDQv9C10YfQsNGC0Ywg0L3QtSDQvdCw0YfQsNC70LDRgdGMIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJ0LmNvbm5lY3RfdG9fY2xpZW50KGRldmljZSwganNvbi5kdW1wcyhidF9oYW5kbGVycykpCiAgICAgICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUsICLQo9GB0L/QtdGI0L3QviDQvtGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjCIKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2htYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2htYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgaGFzaG1hcC5wdXQoInNwZWFrIiwgItCd0LUg0YPQtNCw0LvQvtGB0Ywg0L/QvtC00LrQu9GO0YfQuNGC0YzRgdGPIEJsdWV0b290aCIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHdpZmlfZXJyb3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIGhhc2hfbWFwLnB1dCgic3BlYWsiLCAi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8gV2lGaSIpCgoKZGVmIG1tX3RvX2luY2goc2l6ZV9tbTogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX21tIC8gMjUuNAoKCmRlZiBpbmNoX3RvX21tKHNpemVfaW5jaDogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX2luY2ggKiAyNS40CgoKZGVmIHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGFfZm9yX3ByaW50aW5nLCBwYXJhbXNfbWF0Y2gpOgogICAgbmV3X2RhdGEgPSB7fQogICAgZm9yIG1hdGNoIGluIHBhcmFtc19tYXRjaDoKICAgICAgICBpZiBtYXRjaFsndmFsdWUnXSBpbiBkYXRhX2Zvcl9wcmludGluZy5rZXlzKCk6CiAgICAgICAgICAgIG5ld19kYXRhW21hdGNoWydrZXknXV0gPSBkYXRhX2Zvcl9wcmludGluZ1ttYXRjaFsndmFsdWUnXV0KICAgIHJldHVybiBuZXdfZGF0YQo="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\tiny_db_services.py",
                "PyFileKey": "tiny_db_services",
                "PyFileData": "aW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0LCBVbmlvbiwgRGljdApmcm9tIGZ1bmN0b29scyBpbXBvcnQgcmVkdWNlCmZyb20gdGlueWRiIGltcG9ydCBUaW55REIsIFF1ZXJ5LCB3aGVyZQoKZnJvbSBqYXZhIGltcG9ydCBqY2xhc3MKCgpub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnJzX3NldHRpbmdzID0gbm9DbGFzcygicnNfc2V0dGluZ3MiKQoKCmNsYXNzIFRpbnlOb1NRTFByb3ZpZGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRhYmxlX25hbWUsIGJhc2VfbmFtZT0nU2ltcGxlS2VlcCcsIGRiX3BhdGg9JycpOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLmJhc2VfbmFtZSA9IGJhc2VfbmFtZSBvciByc19zZXR0aW5ncy5nZXQoJ3NxbGl0ZV9uYW1lJykKICAgICAgICBzZWxmLmRiX3BhdGggPSBkYl9wYXRoIG9yIHJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIHNlbGYuZGIgPSBUaW55REIob3MucGF0aC5qb2luKHNlbGYuZGJfcGF0aCwgZid7c2VsZi5iYXNlX25hbWV9Lmpzb24nKSkKICAgICAgICBzZWxmLnRhYmxlID0gc2VsZi5kYi50YWJsZShzZWxmLnRhYmxlX25hbWUpCiAgICAgICAgc2VsZi5xdWVyeSA9IFF1ZXJ5KCkKCiAgICBkZWYgZHJvcF90YWJsZShzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBzZWxmLmRiLmRyb3BfdGFibGUodGFibGVfbmFtZSkKCiAgICBkZWYgZ2V0X2FsbChzZWxmKSAtPiBsaXN0OgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmFsbCgpCgogICAgZGVmIGdldChzZWxmLCAqKmNvbmQpIC0+IFVuaW9uW0RpY3QsIE5vbmVdOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmdldChjb25kPXNlbGYuX2NyZWF0ZV9jb25kaXRpb24oKipjb25kKSkKCiAgICBkZWYgc2VhcmNoKHNlbGYsICoqY29uZCkgLT4gbGlzdDoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5zZWFyY2goY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIGluc2VydChzZWxmLCBkYXRhOiBkaWN0KSAtPiBpbnQ6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuaW5zZXJ0KGRhdGEpCgogICAgZGVmIGluc2VydF9tdWx0aXBsZShzZWxmLCBkYXRhOiBMaXN0W2RpY3RdKSAtPiBMaXN0W2ludF06CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuaW5zZXJ0X211bHRpcGxlKGRhdGEpCgogICAgZGVmIHVwZGF0ZShzZWxmLCBkYXRhOiBkaWN0LCAqKmNvbmQpIC0+IExpc3RbaW50XToKICAgICAgICAiIiIKICAgICAgICBkZWxldGUoa2V5KTogZGVsZXRlIGEga2V5IGZyb20gdGhlIGRvY3VtZW50CiAgICAgICAgaW5jcmVtZW50KGtleSk6IGluY3JlbWVudCB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBkZWNyZW1lbnQoa2V5KTogZGVjcmVtZW50IHRoZSB2YWx1ZSBvZiBhIGtleQogICAgICAgIGFkZChrZXksIHZhbHVlKTogYWRkIHZhbHVlIHRvIHRoZSB2YWx1ZSBvZiBhIGtleSAoYWxzbyB3b3JrcyBmb3Igc3RyaW5ncykKICAgICAgICBzdWJ0cmFjdChrZXksIHZhbHVlKTogc3VidHJhY3QgdmFsdWUgZnJvbSB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBzZXQoa2V5LCB2YWx1ZSk6IHNldCBrZXkgdG8gdmFsdWUKICAgICAgICBkYi51cGRhdGUoZGVsZXRlKCdrZXkxJyksIFVzZXIubmFtZSA9PSAnSm9obicpCiAgICAgICAgZGIudXBkYXRlKHlvdXJfb3BlcmF0aW9uKGFyZ3VtZW50cyksIHF1ZXJ5KQogICAgICAgICIiIgoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS51cGRhdGUoZGF0YSwgY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHVwc2VydChzZWxmLCBkYXRhLCAqKmNvbmQpIC0+IExpc3RbaW50XToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS51cHNlcnQoZGF0YSwgY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHJlbW92ZShzZWxmLCBkb2NfaWRzPU5vbmUsICoqY29uZCk6CiAgICAgICAgaWYgZG9jX2lkczoKICAgICAgICAgICAgcmV0dXJuIHNlbGYudGFibGUucmVtb3ZlKGRvY19pZHM9ZG9jX2lkcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5yZW1vdmUoY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCksIGRvY19pZHM9ZG9jX2lkcykKCiAgICBkZWYgY29udGFpbnMoc2VsZiwgKipjb25kKToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5jb250YWlucyhzZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIGNvdW50KHNlbGYsICoqY29uZCk6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuY291bnQoc2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLmRiLmNsb3NlKCkKCiAgICBkZWYgX2NyZWF0ZV9jb25kaXRpb24oc2VsZiwgKipjb25kKSAtPiBRdWVyeToKICAgICAgICBjb25kaXRpb25zID0gWyhzZWxmLnF1ZXJ5W2tleV0gPT0gdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIGNvbmQuaXRlbXMoKV0KICAgICAgICByZXR1cm4gcmVkdWNlKGxhbWJkYSBhLCBiOiBhICYgYiwgY29uZGl0aW9ucykKCgpjbGFzcyBTY2FubmluZ1F1ZXVlU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcm92aWRlcj1Ob25lKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSAnc2Nhbm5pbmdfcXVldWUnCiAgICAgICAgc2VsZi5wcm92aWRlciA9IHByb3ZpZGVyIG9yIFRpbnlOb1NRTFByb3ZpZGVyKHRhYmxlX25hbWU9c2VsZi50YWJsZV9uYW1lKQoKICAgIGRlZiBnZXRfZG9jX3NjYW5uaW5nX3F1ZXVlKHNlbGYsIGlkX2RvYykgLT4gZGljdDoKICAgICAgICByZXN1bHQgPSB7fQogICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jKQoKICAgICAgICBmb3Igcm93IGluIGRhdGE6CiAgICAgICAgICAgIHJlc3VsdFtyb3dbJ3Jvd19rZXknXV0gPSByb3dbJ3F0dHknXSMjIE5PVCBXT1JLCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgc2F2ZV9zY2FubmVkX3Jvd19kYXRhKHNlbGYsIGRhdGEsIHNlbnQ9RmFsc2UpOiAgI1RPRE8g0LIg0YLQtdGB0YLRiyDQntC70LXQswogICAgICAgICMgaWRfZG9jLCByb3dfaWQsIHF0dHkKICAgICAgICBkYXRhWydzZW50J10gPSBzZW50CiAgICAgICAgc2VsZi5wcm92aWRlci5pbnNlcnQoZGF0YT1kYXRhKQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLmNvdW50KGlkX2RvYz1kYXRhWydpZF9kb2MnXSkKCiAgICBkZWYgZ2V0X3NjYW5uZWRfcm93X3F0dHkoc2VsZiwgaWRfZG9jLCByb3dfaWQpOgogICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHJldHVybiBzdW0oW3Jvd1sncXR0eSddIGZvciByb3cgaW4gZGF0YV0pICAjIG9yICdkX3F0dHknCgogICAgZGVmIGdldF9kb2N1bWVudF9saW5lcyhzZWxmLCBpZF9kb2MsIHNlbnQ9Tm9uZSkgLT4gbGlzdDoKICAgICAgICBpZiBzZW50IGlzIG5vdCBOb25lOgogICAgICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYywgc2VudD1zZW50KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jKQogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIHVwZGF0ZV9zZW50X2xpbmVzKHNlbGYsIHNlbnRfZGF0YTogbGlzdCwgc2VudD1UcnVlKToKICAgICAgICBkb2NfaWRfbGlzdCA9IFt4LmRvY19pZCBmb3IgeCBpbiBzZW50X2RhdGFdCiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZS51cGRhdGUoeydzZW50Jzogc2VudH0sIGRvY19pZHM9ZG9jX2lkX2xpc3QpCgogICAgZGVmIGhhc191bnNlbnRfbGluZXMoc2VsZiwgaWRfZG9jKSAtPiBib29sOgogICAgICAgIHF0dHkgPSBzZWxmLnByb3ZpZGVyLmNvdW50KGlkX2RvYz1pZF9kb2MsIHNlbnQ9RmFsc2UpCiAgICAgICAgcmV0dXJuIFRydWUgaWYgcXR0eSA+IDAgZWxzZSBGYWxzZQoKICAgIGRlZiByZW1vdmVfZG9jX2xpbmVzKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgc2VsZi5wcm92aWRlci5yZW1vdmUoaWRfZG9jPWlkX2RvYykKCgpjbGFzcyBFeGNoYW5nZVF1ZXVlQnVmZmVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRhYmxlX25hbWUsICk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIgPSBUaW55Tm9TUUxQcm92aWRlcih0YWJsZV9uYW1lPXNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgc2F2ZV9kYXRhX3RvX3NlbmQoc2VsZiwgZGF0YSwgcGspOgogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnVwc2VydChkYXRhPWRhdGEsIHBrPXBrKQoKICAgIGRlZiBnZXRfZGF0YV90b19zZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLmdldF9hbGwoKQoKICAgIGRlZiByZW1vdmVfc2VudF9kYXRhKHNlbGYsIGRhdGEpOgogICAgICAgIGRvY19pZF9saXN0ID0gW3guZG9jX2lkIGZvciB4IGluIGRhdGFdCiAgICAgICAgc2VsZi5wcm92aWRlci5yZW1vdmUoZG9jX2lkcz1kb2NfaWRfbGlzdCkKCg=="
            },
            {
                "file_path": "C:/Work/simple_keep/simple_keep\\static_data.py",
                "PyFileKey": "static_data",
                "PyFileData": "c25faWNvbl9ncmVlbiA9ICdBQUFCQUFFQUdCZ0FBQUVBSUFBb0NRQUFGZ0FBQUNnQUFBQVlBQUFBTUFBQUFBRUFJQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy85Ly8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vLy8vLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vLzIvLy8vLy8vLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vLy8vLy84di8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1mLy8vOFQvLy8vKy8vLy8zdi8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbWYvLy8vUC8vLy90Ly8vL3IvLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWi8vLy93di8vLy8vLy8vKzAvLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaLy8vLzcvLy8vKzcvLy85YS8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaLy8vLzBmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUpuLy8vKzAvLy8vLy8vLy83d0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSm4vLy8vdS8vLy84Ly8vLzJvQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vNC8vLy81Z0NNQUprQWpBQ1pBSXdBbWYvLy8vNy8vLy9GQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbWYvLy83TC8vLy8rLy8vL3dnQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbWYvLy81ei8vLy8vQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vL2YvLy8vTlFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVi8vLy9VZi8vLytuLy8vLzAvLy8vYmdDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtZi8vLzV6Ly8vLy9BSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSm4vLy8vay8vLy9RZ0NNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WLy8vL3FmLy8vLzcvLy8vTEFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1mLy8vNXovLy8vL0FJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKbi8vLy9mLy8vL05RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL2UvLy8vNlAvLy8vZi8vLzk1QUl3QW1RQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKbi8vLy8yLy8vLzVnQ01BSmtBakFDWkFJd0FtZi8vLy83Ly8vL0ZBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vOS8vLy8vdi8vLzg0QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy8vLy8vLytmLy8vNElBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWi8vLy96Zi8vLy96Ly8vLysvLy8vN2YvLy80OEFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKaz0nCnNuX2ljb25fcmVkID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vLzkvLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vLy8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vMi8vLy8vLy8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9BQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1ovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1ovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDhBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNW4vLy8rMC8vLy8vLy8vLzd3QUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81bi8vLy91Ly8vLzgvLy8vMm9BQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy80Ly8vLzVnQUEvNWtBQVArWkFBRC9tZi8vLy83Ly8vL0ZBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tZi8vLzdMLy8vLysvLy8vd2dBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tZi8vLzV6Ly8vLy9BQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vZi8vLy9OUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9iZ0FBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21mLy8vNXovLy8vL0FBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81bi8vLy9rLy8vL1FnQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbWYvLy81ei8vLy8vQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVuLy8vL2YvLy8vTlFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVBQUQvbVFBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVuLy8vLzIvLy8vNWdBQS81a0FBUCtaQUFEL21mLy8vLzcvLy8vRkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODRBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80SUFBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrPScKc25faWNvbl9ncmF5ID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vLzkvLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vLy8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vMi8vLy8vLy8vLy8vLy8vKzhabVptbVdabVpwbi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9abVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDltWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acG4vLy8rMC8vLy8vLy8vLzd4bVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbi8vLy91Ly8vLzgvLy8vMnBtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbi8vLy80Ly8vLzVtWm1acGxtWm1hWlptWm1tZi8vLy83Ly8vL0ZabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tZi8vLzdMLy8vLysvLy8vd21abVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tZi8vLzV6Ly8vLy9abVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vZi8vLy9OV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9ibVptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1mLy8vNXovLy8vL1ptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbi8vLy9rLy8vL1FtWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbWYvLy81ei8vLy8vWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBuLy8vL2YvLy8vTldabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVabVptbVdabVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBuLy8vLzIvLy8vNW1abVpwbG1abWFaWm1abW1mLy8vLzcvLy8vRlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODVtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80Sm1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ5bVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBrPScKbWFya19ncmVlbj0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVY1SlJFRlVPRStsVWlGTXcxQVF2ZjYxV1Nab3dsQUVDSE1zeTRKREROVjZIRmtnd1NFSURzTU1RU0J3S053VWpnUThFNmpXUVRLTEtHNkNEZ0diNk5Ld01aYnkzNVhyRnV5ZXViNS85MTdldjM2ajluaWEwQnd3V21FN3VYeTVwN0s5bXA1b3U1dmFDUm1Ha2ZJL0pFbENoMC9YV3BIeUlIcWo4K29lcWZldmZuWVFSQ0hsbGNtOEdiVEljUndXb2dMb1lRYXpBTFE1dFZ1K2lIK0duR0RUTHRGMmNZTXFpK3ZVcUIrUjUzbmt1aTVYWVBnOW9rSXVUM25Ub3M5UlJGMXRvQkFEZ09za21WQnZQR0FPaUJnVlFBOHprb0N2Y052eG1TQkJ4VjZqSld1QitYNnp3VlhFQUhxWWtYMUJxL2hMQTY0Zk9wWWt1RHUreXFKTFJROHprZ0JRQjZWMFFYQzFsSlVsbUlXa1FBOHprZ0JhaFY4SXdQVzUvNW9sK0w5QUFEM01TQUpvMWM3S0ZoTzQ0amYxeGpIejJRVk9yeER6akNTQTFsd3VGSm1JYXpBSTZheGFKOS8zczhlRWl2ZncwRzFyTm4yNDBNNzVsSWwrQWJSR3NIdGM1a296QUFBQUFFbEZUa1N1UW1DQyIKbWFya19waW5rPSJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBTUNBWUFBQUJyNXoyQkFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFEc1FBQUE3RUFaVXJEaHNBQUFVYmFWUllkRmhOVERwamIyMHVZV1J2WW1VdWVHMXdBQUFBQUFBOFAzaHdZV05yWlhRZ1ltVm5hVzQ5SXUrN3Z5SWdhV1E5SWxjMVRUQk5jRU5sYUdsSWVuSmxVM3BPVkdONmEyTTVaQ0kvUGlBOGVEcDRiWEJ0WlhSaElIaHRiRzV6T25nOUltRmtiMkpsT201ek9tMWxkR0V2SWlCNE9uaHRjSFJyUFNKQlpHOWlaU0JZVFZBZ1EyOXlaU0EyTGpBdFl6QXdNaUF4TVRZdU1UWTBOelkyTENBeU1ESXhMekF5THpFNUxUSXpPakV3T2pBM0lDQWdJQ0FnSUNBaVBpQThjbVJtT2xKRVJpQjRiV3h1Y3pweVpHWTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1Rrdk1ESXZNakl0Y21SbUxYTjViblJoZUMxdWN5TWlQaUE4Y21SbU9rUmxjMk55YVhCMGFXOXVJSEprWmpwaFltOTFkRDBpSWlCNGJXeHVjenA0YlhBOUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOGlJSGh0Ykc1ek9tUmpQU0pvZEhSd09pOHZjSFZ5YkM1dmNtY3ZaR012Wld4bGJXVnVkSE12TVM0eEx5SWdlRzFzYm5NNmNHaHZkRzl6YUc5d1BTSm9kSFJ3T2k4dmJuTXVZV1J2WW1VdVkyOXRMM0JvYjNSdmMyaHZjQzh4TGpBdklpQjRiV3h1Y3pwNGJYQk5UVDBpYUhSMGNEb3ZMMjV6TG1Ga2IySmxMbU52YlM5NFlYQXZNUzR3TDIxdEx5SWdlRzFzYm5NNmMzUkZkblE5SW1oMGRIQTZMeTl1Y3k1aFpHOWlaUzVqYjIwdmVHRndMekV1TUM5elZIbHdaUzlTWlhOdmRYSmpaVVYyWlc1MEl5SWdlRzF3T2tOeVpXRjBiM0pVYjI5c1BTSkJaRzlpWlNCUWFHOTBiM05vYjNBZ01qRXVNaUFvVFdGamFXNTBiM05vS1NJZ2VHMXdPa055WldGMFpVUmhkR1U5SWpJd01qRXRNRGd0TVRCVU1UQTZOVFU2TlRNck1ETTZNREFpSUhodGNEcE5iMlJwWm5sRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUI0YlhBNlRXVjBZV1JoZEdGRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUJrWXpwbWIzSnRZWFE5SW1sdFlXZGxMM0J1WnlJZ2NHaHZkRzl6YUc5d09rTnZiRzl5VFc5a1pUMGlNeUlnY0dodmRHOXphRzl3T2tsRFExQnliMlpwYkdVOUluTlNSMElnU1VWRE5qRTVOall0TWk0eElpQjRiWEJOVFRwSmJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdlRzF3VFUwNlJHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlJSGh0Y0UxTk9rOXlhV2RwYm1Gc1JHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlQaUE4ZUcxd1RVMDZTR2x6ZEc5eWVUNGdQSEprWmpwVFpYRStJRHh5WkdZNmJHa2djM1JGZG5RNllXTjBhVzl1UFNKamNtVmhkR1ZrSWlCemRFVjJkRHBwYm5OMFlXNWpaVWxFUFNKNGJYQXVhV2xrT21GbE9USmlZakptTFRGa09UTXRORFprTkMxaU9XUTVMV0U1WldReU16SXhaRGhtWmlJZ2MzUkZkblE2ZDJobGJqMGlNakF5TVMwd09DMHhNRlF4TURvMU5UbzFNeXN3TXpvd01DSWdjM1JGZG5RNmMyOW1kSGRoY21WQloyVnVkRDBpUVdSdlltVWdVR2h2ZEc5emFHOXdJREl4TGpJZ0tFMWhZMmx1ZEc5emFDa2lMejRnUEM5eVpHWTZVMlZ4UGlBOEwzaHRjRTFOT2tocGMzUnZjbmsrSUR3dmNtUm1Pa1JsYzJOeWFYQjBhVzl1UGlBOEwzSmtaanBTUkVZK0lEd3ZlRHA0YlhCdFpYUmhQaUE4UDNod1lXTnJaWFFnWlc1a1BTSnlJajgramxiSzBnQUFBVWhKUkVGVU9FK2xrckZLdzJBVWhXOSt0VlNrb0ZCZE9sa0ZSOGxveVZCOEFVR2NmWUhhWFhBVzNCeWlnNnV6Q0w1QTdWQmNvK0JTcEc1ZEpOS2lGcXFVeG56WDNsQmNleURjLytTY2MzTVM0ajBmWENVeUE3emVmVHZwWGpZbFh5NU83b2hzbk8xTEVBUi9mSUpXcXlXZDQxdVJ5ZU9HcjdHVWFsVnhQMitmMlkzdjlKTGNuUEtiMnJuNHZxOUJwaUxWOE9BRlpGMi8wVlpDZzZXZGRTbFV5c3BQSDY0bERFT3AxK3M2QVJvZWEwdldsWTZxU3RpYWpCTVo5NGJLZ1lXWkFBMlBOU0RyNHJzbkpXeGQzRndWdDVKWGZsSTUxR2xoZ0liSEdwQjFla3JCMXRIN0lHdGdyd0Jzb3VHeEJzQVY5N2Ixd0ZhMzRHVU5wbUV0MFBCWUE3S3VlOUZVd3RiQll6ZHI4UDhEQWpRODFvQ3NXOTdkVXNKV0x6Y3ZvLzZYOHVrUGFFdlE4RmdEc2k2M1ZsREMxbUVubG8vR2kvSW9pdlJuc2duUThGZ0RzalAreWlLL0dWQ3dxRnVUaDl3QUFBQUFTVVZPUks1Q1lJST0iCm1hcmtfYmx1ZT0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVR4SlJFRlVPRStsa3I5S3cyQVV4VysrS2tJR3JRNWFFQlFYZGNtUVJSejZCRG83K3dUQjNRY29ycElYMExtejRnTmtFQWNEWm5MeUR4WkVpQ2pTUUcwaCtydm1odURhQStIbWZPZWN5OGxIdkpPcjIxS21nSmNOOHZJaWU1TE9nbDhkaVJ6dWJrbTMyNjNZSDVJa2tmUHIrNHFKdkg0V3NoK3NpL3NvUnZVQlQ4dnpsUGZPK2hLR29RYVpBTTE4Z0t6TEJ1OUthTEM1MHBidHpxTHkvbWxQNGppV0tJcDBBalE4MXBhczJ3dldsTEMxTEVzcHhoUGx3TUpNZ0liSEdwQjFOdzl2U3RqYW1mZkZuNTFSZm5CMHJOUENBQTJQTlNEcjlPMFhiQjErVCtvRzlnbkFKaG9lYXdEY3pzYXl2ckMxNWJ5NlFSUFdBZzJQTlNEckxyTm5KV3g5ekwvcUJ2OHZFS0Roc1Faa1hiQzZwTVFhREVkajVjMEx0Q1ZvelFaa1hkdWZVOEpXbnJ1WFhIbWFwdm96MlFSbzVnTmtwL3lWUlg0QTZQdXdyalh5NkZJQUFBQUFTVVZPUks1Q1lJST0iCg=="
            }
        ],
        "StyleTemplates": [],
        "arch2": true,
        "CommonHandlers": [
            {
                "event": "onLaunch",
                "listener": "",
                "action": "run",
                "type": "pythonreload",
                "method": "app_on_start",
                "postExecute": "",
                "alias": "on_start"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "event_service",
                "postExecute": "",
                "alias": "event_service"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "put_notification",
                "postExecute": ""
            },
            {
                "event": "onBackgroundCommand",
                "listener": "menu_2",
                "action": "run",
                "type": "set",
                "method": "UpdateConfigurations",
                "postExecute": ""
            },
            {
                "event": "onSQLError",
                "listener": "",
                "action": "run",
                "type": "set",
                "method": "beep",
                "postExecute": ""
            },
            {
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "timer_update",
                "postExecute": "",
                "alias": "timer_update"
            }
        ]
    }
}