{
    "ClientConfiguration": {
        "ConfigurationName": "Simple Учет",
        "ConfigurationDescription": "Простое решение для работы с штрихкодами товаров. Поставляется в комплекте с расширением для 1С. Подробнее про расширение Вы можете узнать по ссылке: https://www.simple-kit.ru/products/simple-uchet/ ",
        "ConfigurationVersion": "0.1.0.14.6",
        "Processes": [
            {
                "type": "Process",
                "ProcessName": "Документы",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Найдено по артикулам",
                                                "Variable": "finded_by_article",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "20",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "18",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "fab",
                                "Value": "#f031",
                                "Variable": "btn_goods_ocr"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "6",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "btn_previous_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "@Good",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "btn_next_good",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Маркировка",
                                "Variable": "btn_marks_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "elem_viev_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Удаление штрихкода",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Товар с такой маркировкой уже есть в документе!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good",
                                        "Variable": "id_good",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@code_art",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@unit_name",
                                        "Variable": "id_unit",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_value",
                                        "Variable": "barcode_value1",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_barcode_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            },
                                            {
                                                "Value": "Удалить",
                                                "Variable": "btn_barcode_delete",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "delete_barcode_screen_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "|| ||| ||",
                                                "Variable": "btn_barcodes",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Групповая обработка",
                "PlanFactHeader": "...",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "runprogress",
                                "type": "python",
                                "method": "gs_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "tiles_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "doc_date",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@countragent",
                                                "Variable": "countragent",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "@doc_goods_cards",
                                        "Variable": "doc_goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "CButtons"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Cинхронизировать данные с 1С",
                                "Variable": "sync_doc"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить все сканы в 1С",
                                "Variable": "send_all_scan_lines"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "doc_details_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@Doc_data",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "7",
                                                        "Elements": [
                                                            {
                                                                "Value": "@good_str",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Серия:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_sn",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "@Good",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#7A005C",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@barcode_cards",
                                        "Variable": "barcode_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "group_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Подтвердите действие",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@group_scan_message",
                                        "Variable": "group_scan_message",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Адресное хранение",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_adr_type_select",
                                                "Variable": "doc_adr_type_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@documents_list",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документ товары",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_title",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "16",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@warehouse",
                                                "Variable": "warehouse",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "12",
                                                        "Elements": [
                                                            {
                                                                "Value": "",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "2",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "vertical",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "Elements": [
                                                            {
                                                                "Value": "Текущая ячейка: ",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@current_cell",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "8",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextSize": "20",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "10",
                                                "Elements": [
                                                    {
                                                        "Value": "х",
                                                        "Variable": "btn_clear_cell",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "TextSize": "18",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Табл.",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@tables_type",
                                                "Variable": "table_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "pagination_controls",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "<",
                                                "Variable": "previous_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Страница:",
                                                        "Variable": "",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@current_page",
                                                        "Variable": "current_page",
                                                        "height": "match_parent",
                                                        "width": "wrap_content",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@items_on_page_select",
                                                        "Variable": "items_on_page_click",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "16",
                                                        "TextColor": "#000000",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": ">",
                                                "Variable": "next_page",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "Button"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@doc_goods_table",
                                        "Variable": "doc_goods_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Все строки",
                                "Variable": "btn_rows_filter_off"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Необработанные строки",
                                "Variable": "btn_rows_filter_on"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выбрать ячейку",
                                "Variable": "btn_select_cell"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_doc_details_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Товар выбор",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@article",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@property",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@item_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Было:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@qtty",
                                                                        "Variable": "qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "TextSize": "18",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_1",
                                                                        "height": "wrap_content",
                                                                        "width": "match_parent",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "horizontal",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "Будет:",
                                                                        "Variable": "",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "21",
                                                                        "type": "TextView"
                                                                    },
                                                                    {
                                                                        "Value": "@new_qtty",
                                                                        "Variable": "new_qtty",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "1",
                                                                        "TextBold": true,
                                                                        "TextItalic": false,
                                                                        "TextSize": "24",
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "type": "LinearLayout",
                                                                "Variable": "",
                                                                "orientation": "vertical",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "4",
                                                                "Elements": [
                                                                    {
                                                                        "Value": "",
                                                                        "Variable": "blank_2",
                                                                        "height": "wrap_content",
                                                                        "width": "wrap_content",
                                                                        "weight": "0",
                                                                        "TextBold": false,
                                                                        "TextItalic": false,
                                                                        "type": "TextView"
                                                                    }
                                                                ]
                                                            }
                                                        ],
                                                        "Padding": "center"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_note",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "fact_qtty_input",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Добавить:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "TextColor": "#000000",
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "fact_qtty_input",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "-5",
                                                        "Variable": "ops_-5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "-1",
                                                        "Variable": "ops_-1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "...",
                                                        "Variable": "btn_input_qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "orientation": "horizontal",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+1",
                                                        "Variable": "ops_+1",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    },
                                                    {
                                                        "Value": "+5",
                                                        "Variable": "ops_+5",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "21",
                                                        "type": "Button"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сохранить",
                                                        "Variable": "btn_ok",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "Button"
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_good_select"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_doc_good_barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Серии",
                                "Variable": "btn_series_show"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "adr_elem_view_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибка сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@scanned_barcode",
                                        "Variable": "scanned_barcode",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ОШИБКА",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "24",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Товар не найден по штрихкоду!",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Сканер отключен",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Продолжить сканирование",
                                        "Variable": "btn_continue_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_error_screen_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Сбор ШК",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Плитки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "gravity_horizontal": "center",
                                "gravity_vertical": "center",
                                "weight": "0",
                                "type": "Tiles",
                                "Value": "@tiles",
                                "Variable": "tiles",
                                "Elements": [
                                    {
                                        "Value": "@gtin",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@series",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_tiles_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Документы",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_type_select",
                                                "Variable": "doc_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            },
                                            {
                                                "Value": "@doc_status_select",
                                                "Variable": "doc_status_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@docCards",
                                        "Variable": "doc_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "flow_docs_on_select",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ПотокШтрихкодовДокумента",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_type",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "18",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@doc_n",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextSize": "24",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@doc_date",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@warehouse",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@countragent",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "orientation": "vertical",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_barc_flow",
                                        "Variable": "doc_barc_flow",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Выгрузить документ",
                                        "Variable": "btn_doc_mark_verified",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Ввести штрихкод",
                                "Variable": "btn_barcodes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Выгрузить документ",
                                "Variable": "btn_doc_mark_verified"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Шаблон распознавания",
                                "Variable": "btn_ocr_serial_template_settings"
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_find_serial_cv"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_flow_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ВвестиШтрихкод",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Введите значение штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_barcode",
                                        "Variable": "fld_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "ШаблонРаспознавания",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Количество цифр",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_num_amount",
                                        "Variable": "ocr_serial_template_num_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Префикс",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_prefix",
                                        "Variable": "ocr_serial_template_prefix",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "@current_ocr_serial_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Товары",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Товары список",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Категория:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@select_goods_type",
                                                "Variable": "select_goods_type",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_txt",
                                        "Variable": "error_txt",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@goods_cards",
                                        "Variable": "goods_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Карточка товара",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "buttons",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Цены",
                                                "Variable": "to_prices",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "Остатки",
                                                "Variable": "to_balances",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "name",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_name",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextSize": "22",
                                                "TextColor": "#7A005C",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@item_key",
                                                "Variable": "item_key",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "good_info",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "@good_type",
                                                "Variable": "good_type",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "type": "TextView"
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "art",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_art",
                                                        "Variable": "good_art",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "code",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Код:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_code",
                                                        "Variable": "good_code",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "descr",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Описание:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_descr",
                                                        "Variable": "good_descr",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "Value": "@barcode_cards",
                                                "Variable": "barcode_cards",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "type": "CardsLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@load_info",
                                        "Variable": "load_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Печать",
                                "Variable": "btn_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Добавить штрихкод",
                                "Variable": "btn_item_good_barcode"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onPostStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "good_card_post_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Выбор категории товаров ",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@goods_types_cards",
                                        "Variable": "goods_types_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_type_goods_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Остатки",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверить остатки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Выбор склада:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@wh_select",
                                                                "Variable": "wh_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "art",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул товара:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@item_art_input",
                                                                "Variable": "item_art_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "cell",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул ячейки:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@cell_input",
                                                                "Variable": "cell_input",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "EditTextText"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "info_block",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@selected_object_name",
                                        "Variable": "selected_object_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_cell_name",
                                        "Variable": "selected_cell_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@error_msg",
                                        "Variable": "error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "16",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_wh_name",
                                        "Variable": "selected_wh_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_balances_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Запросить остатки",
                                        "Variable": "get_balance_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextSize": "15",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@balances_table",
                                        "Variable": "balances_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "balances_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Цены",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проверка цен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "head_block",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Артикул товара:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "TextItalic": true,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@input_good_art",
                                                        "Variable": "input_good_art",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "type": "EditTextText"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "input_block",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "price_type",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Тип цены:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@price_type_select",
                                                                "Variable": "price_type_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "properties",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Характеристики:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@property_select",
                                                                "Variable": "property_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "Value": "",
                                                        "Variable": "",
                                                        "height": "10",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "units",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "Elements": [
                                                            {
                                                                "Value": "Упаковка:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "2",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@unit_select",
                                                                "Variable": "unit_select",
                                                                "height": "wrap_content",
                                                                "width": "match_parent",
                                                                "weight": "1",
                                                                "type": "object"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_object_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_price_type_name",
                                        "Variable": "selected_price_type_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_property_name",
                                        "Variable": "selected_property_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@selected_unit_name",
                                        "Variable": "selected_unit_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@barcode_info",
                                        "Variable": "barcode_info",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#008000",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@prices_error_msg",
                                        "Variable": "prices_error_msg",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextColor": "#ff0000",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "get_prices_controls",
                                "orientation": "horizontal",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать",
                                        "Variable": "get_prices_btn",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@prices_table",
                                        "Variable": "prices_table",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TableLayout"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "fab",
                                "Value": "#f1de",
                                "Variable": "show_filters"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "prices_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Параметры",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки и обмен",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_adr",
                                        "Variable": "text_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Разрешить ввод факт товара",
                                        "Variable": "allow_fact_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Оффлайн режим",
                                        "Variable": "offline_mode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Настройки HTTP подключения",
                                        "Variable": "btn_http_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки шрифтов",
                                        "Variable": "btn_size",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки звука",
                                        "Variable": "btn_sound_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки документов",
                                        "Variable": "btn_documents_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Тест сканера",
                                        "Variable": "btn_test_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Лог ошибок",
                                        "Variable": "btn_err_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить данные на  HTTP сервер",
                                        "Variable": "btn_upload_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Обмен с HTTP 1c сервером",
                                        "Variable": "btn_timer",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Настройки печати",
                                        "Variable": "btn_print_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "СписокФайлов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@files_list",
                                        "Variable": "files_list",
                                        "height": "match_parent",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "MultilineText"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_list_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки Шрифтов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Размеры",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@TitleTextSize",
                                        "Variable": "TitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTitleTextSize",
                                        "Variable": "CardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardDateTextSize",
                                        "Variable": "CardDateTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@CardTextSize",
                                        "Variable": "CardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@GoodsCardTitleTextSize",
                                        "Variable": "GoodsCardTitleTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@goodsTextSize",
                                        "Variable": "goodsTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@SeriesPropertiesTextSize",
                                        "Variable": "SeriesPropertiesTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@DocTypeCardTextSize",
                                        "Variable": "DocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@titleDocTypeCardTextSize",
                                        "Variable": "titleDocTypeCardTextSize",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_on_save",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_sizes_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "font_size_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Тест сканера",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "wrap_content",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_1",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_2",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_3",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_4",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_5",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_6",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@fld_7",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "test_barcode_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Ошибки",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Очистить",
                                                "Variable": "btn_clear_err",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "@date_sort_select",
                                                "Variable": "date_sort_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@error_log_table",
                                        "Variable": "error_log_table",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "settings_errors_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки http соединения",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@url",
                                        "Variable": "url",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user",
                                        "Variable": "user",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@pass",
                                        "Variable": "pass",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@user_name",
                                        "Variable": "user_name",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "@btn_test_connection",
                                        "Variable": "btn_test_connection",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@ANDROID_ID",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextSize": "20",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Отменить",
                                                "Variable": "btn_cancel",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            },
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "ProgressButton"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode_camera2"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "http_settings_on_click",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройка звука",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@event_cards",
                                        "Variable": "event_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "sound_settings_listener",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки документов",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Время хранения",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextSize": "25",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Укажите сколько дней документы будут храниться на устройстве.",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@doc_delete_settings_days",
                                        "Variable": "doc_delete_settings_days",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Удалять устаревшие документы",
                                        "Variable": "doc_settings_confirm_delete_old_docs",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить и закрыть",
                                        "Variable": "save_btn",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "documents_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Отладка",
                "DefineOnBackPressed": true,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Отладочный экран",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки маркировки",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "ИспользоватьМаркировку",
                                        "Variable": "use_mark",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ModernEditText"
                                    },
                                    {
                                        "Value": "Скопировать базу на компьютер",
                                        "Variable": "btn_copy_base",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Выгрузить лог",
                                        "Variable": "btn_unload_log",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@path",
                                        "Variable": "path",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Создать таблицы БД",
                                        "Variable": "btn_init",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Список локальных файлов",
                                        "Variable": "btn_files_list",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Версия конфигурации",
                                        "Variable": "btn_conf_version",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Очистить базу",
                                        "Variable": "bnt_clear_tables",
                                        "height": "0",
                                        "width": "0",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "Заполнить Ratio",
                                        "Variable": "btn_fill_ratio",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_listener",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "debug_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Печать",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Настройки печати",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройка Bluetooth принтера",
                                        "Variable": "btn_bluetooth_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка WiFi принтера",
                                        "Variable": "btn_wifi_printer_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка шаблонов печати",
                                        "Variable": "btn_label_templates_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Печать через Bluetooth",
                                        "Variable": "check_box_bluetooth_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Печать через WiFi",
                                        "Variable": "check_box_wifi_print",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Список шаблонов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@templates_cards",
                                        "Variable": "templates_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "template_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Результат",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Шаблон:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@html",
                                        "Variable": "html",
                                        "height": "300",
                                        "width": "match_parent",
                                        "orientation": "vertical",
                                        "weight": "3",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "html"
                                    },
                                    {
                                        "Value": "@matching_table",
                                        "Variable": "matching_table_values",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    },
                                    {
                                        "Value": "Параметры штрихкода",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Ширина",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_width",
                                                "Variable": "barcode_width",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Высота",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_height",
                                                "Variable": "barcode_height",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Тип:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "4",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_types",
                                                "Variable": "barcode_type_click",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "3",
                                                "type": "SpinnerLayout"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Влево",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_left",
                                                "Variable": "barcode_left",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вправо",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_right",
                                                "Variable": "barcode_right",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вверх",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_up",
                                                "Variable": "barcode_up",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Вниз",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@barcode_down",
                                                "Variable": "barcode_down",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "html_view_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "НастройкаСоответствияДиалог",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "layout",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@list_field",
                                        "Variable": "select_field",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "SpinnerLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": []
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Bluetooth",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки принтера Bluetooth",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Показать присоединенные",
                                        "Variable": "btn_show_connected",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Начать сканирование",
                                        "Variable": "btn_start_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Остановить сканирование",
                                        "Variable": "btn_stop_scan",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_print",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Сбросить подключение",
                                        "Variable": "btn_bt_disconnect",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Подключенный принтер:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@default_printer",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "type": "TextView"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "set",
                                "method": "BTGetBounded",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_bluetooth_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати WiFi",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Укажите ip устройства",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_ip",
                                        "Variable": "wi_fi_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Сохранить IP",
                                        "Variable": "btn_wifi_save_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить IP",
                                        "Variable": "btn_wifi_delete_ip",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@info_wifi_current_ip",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Тест печати",
                                        "Variable": "btn_test_wi_fi",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Код ZPL для печати:",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@wi_fi_zpl_input",
                                        "Variable": "wi_fi_zpl_input",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Напечатать zpl",
                                        "Variable": "btn_wi_fi_print_zpl",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_wifi_settings_on_start",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Шаблоны",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": false,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Настройки шаблонов ценников и этикеток",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Получить шаблоны с сервера",
                                        "Variable": "btn_get_labels",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@current_label_template_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Выбрать из списка",
                                        "Variable": "btn_select_label_template",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Удалить настройки шаблонов печати",
                                        "Variable": "btn_delete_template_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "Настройка размеров шаблона",
                                        "Variable": "btn_label_template_size_settings",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Button"
                                    },
                                    {
                                        "Value": "@preview_label_template_image",
                                        "Variable": "",
                                        "height": "300",
                                        "width": "match_parent",
                                        "weight": "3",
                                        "type": "Picture"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_templates_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "Настройки печати Размеры",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "label Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@width_print_template",
                                                        "Variable": "width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Label Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@height_print_template",
                                                        "Variable": "height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Img Width (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_width_print_template",
                                                        "Variable": "image_width_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Img Height (мм)",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_height_print_template",
                                                        "Variable": "image_height_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "LL",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_ll_print_template",
                                                        "Variable": "image_ll_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "PW",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_pw_print_template",
                                                        "Variable": "image_pw_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Сдвиг вправо",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_x_print_template",
                                                        "Variable": "image_x_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "Сдвиг вниз",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@image_y_print_template",
                                                        "Variable": "image_y_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "EditTextNumeric"
                                                    },
                                                    {
                                                        "Value": "dpmm",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "6;8;12;24",
                                                        "Variable": "dpmm_print_template",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "2",
                                                        "type": "SpinnerLayout"
                                                    }
                                                ]
                                            }
                                        ],
                                        "StrokeWidth": "5"
                                    },
                                    {
                                        "Value": "@image_print",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "Picture"
                                    }
                                ],
                                "StrokeWidth": "5"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Отправить на печать",
                                "Variable": "btn_sent_to_print"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Сохранить шаблон",
                                "Variable": "btn_save_template_sizes"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Удалить шаблон",
                                "Variable": "btn_delete_print_template"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "print_label_template_size_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "Проводник",
                "DefineOnBackPressed": false,
                "hidden": false,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "Проводник файлов",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@ip_host",
                                        "Variable": "ip_host",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "EditTextText"
                                    },
                                    {
                                        "Value": "Вверх",
                                        "Variable": "btn_get_up",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "ProgressButton"
                                    },
                                    {
                                        "Value": "@file_browser_cards",
                                        "Variable": "file_browser_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "file_browser_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SeriesProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SeriesSelectScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@doc_title",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "TextSize": "16",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "vertical",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "match_parent",
                                                "width": "match_parent",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "type": "LinearLayout",
                                                        "Variable": "",
                                                        "orientation": "horizontal",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "1",
                                                        "Elements": [
                                                            {
                                                                "Value": "Артикул:",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": true,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            },
                                                            {
                                                                "Value": "@good_art",
                                                                "Variable": "",
                                                                "height": "wrap_content",
                                                                "width": "wrap_content",
                                                                "weight": "0",
                                                                "TextBold": false,
                                                                "TextItalic": false,
                                                                "TextColor": "#000000",
                                                                "type": "TextView"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Характеристика:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@properties_name",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Цена:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@price",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#cc0000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "horizontal",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "Elements": [
                                                    {
                                                        "Value": "Упаковка:",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": true,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@good_unit",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "wrap_content",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextColor": "#000000",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "План",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty_plan",
                                                        "Variable": "qtty_plan",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "LinearLayout",
                                                "Variable": "",
                                                "orientation": "vertical",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "Elements": [
                                                    {
                                                        "Value": "Факт",
                                                        "Variable": "",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "type": "TextView"
                                                    },
                                                    {
                                                        "Value": "@qtty",
                                                        "Variable": "qtty",
                                                        "height": "wrap_content",
                                                        "width": "match_parent",
                                                        "weight": "0",
                                                        "TextBold": false,
                                                        "TextItalic": false,
                                                        "TextSize": "24",
                                                        "type": "TextView"
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@series_cards",
                                        "Variable": "series_cards",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            },
                            {
                                "type": "Vision",
                                "Value": "#f002",
                                "Variable": "btn_series_ocr_serial_number"
                            },
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "MenuItem",
                                "Value": "Настройки шаблона",
                                "Variable": "btn_ocr_serial_template_settings"
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_list_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "FillingSeriesScreen",
                        "Timer": false,
                        "hideToolBarScreen": true,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "1",
                                "Elements": [
                                    {
                                        "Value": "@good_name",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "24",
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Имя серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@name",
                                                "Variable": "name",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Номер серии:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@number",
                                                "Variable": "number",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Дата производства:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@production_date",
                                                "Variable": "production_date",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Годен до: ",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@best_before",
                                                "Variable": "best_before",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "DateField"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Количество:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "wrap_content",
                                                "weight": "0",
                                                "TextBold": true,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@FillingSeriesScreen_qtty",
                                                "Variable": "FillingSeriesScreen_qtty",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "5",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "EditTextNumeric"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "Elements": [
                                            {
                                                "Value": "Сохранить",
                                                "Variable": "btn_save",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "orientation": "horizontal",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "TextSize": "21",
                                                "type": "Button"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "series_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "CVOperationName": "Распознавание артикулов",
                "type": "CVOperation",
                "hidden": true,
                "CVFrames": [
                    {
                        "Name": "Новый шаг ActiveCV",
                        "type": "CVFrame",
                        "CVOnline": false,
                        "CVDetector": "OCR",
                        "CVResolution": "VGA",
                        "CVMode": "list_and_grey",
                        "CVActionButtons": "Обработать",
                        "CVAction": "Поиск по артикулу",
                        "CVInfo": "@art_info",
                        "CVCameraDevice": "Back",
                        "Handlers": [
                            {
                                "event": "OnObjectDetected",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_object_detected",
                                "postExecute": ""
                            },
                            {
                                "event": "OnInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_input",
                                "postExecute": ""
                            },
                            {
                                "event": "OnCreate",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "article_cv_on_start",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "SelectItemProcess",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SelectItemScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@SelectItemScreen_items_cards",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "CardsLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "select_item_on_input",
                                "postExecute": ""
                            }
                        ]
                    },
                    {
                        "type": "Operation",
                        "Name": "ShowItemsScreen",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": true,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@items_table",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "show_items_screen_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "BarcodeRegistration",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "BarcodeRegistration",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": false,
                        "Elements": [
                            {
                                "type": "barcode",
                                "Value": "",
                                "Variable": "barcode"
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "Отсканируйте штрихкод товара",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "2",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextSize": "22",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@good_name_barcode",
                                        "Variable": "good_name_barcode",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": true,
                                        "TextItalic": false,
                                        "TextColor": "#7A005C",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Штрихкод:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@scanned_barcode",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "properties",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Характеристика:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "TextBold": false,
                                                "TextItalic": false,
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@property_select",
                                                "Variable": "property_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "",
                                        "Variable": "",
                                        "height": "10",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "units",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Упаковка:",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "2",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@unit_select",
                                                "Variable": "unit_select",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "object"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_ok",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "1",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "Button"
                                    }
                                ]
                            },
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "match_parent",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "Value": "@barcodes_data",
                                        "Variable": "barcodes_data",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "TextBold": false,
                                        "TextItalic": false,
                                        "type": "TableLayout"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "barcode_register_doc_on_click",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            },
            {
                "type": "Process",
                "ProcessName": "OcrTextRecognition",
                "DefineOnBackPressed": true,
                "hidden": true,
                "login_screen": false,
                "SC": false,
                "Operations": [
                    {
                        "type": "Operation",
                        "Name": "SerialNumberOCRSettings",
                        "Timer": false,
                        "hideToolBarScreen": false,
                        "hideBottomBarScreen": true,
                        "noScroll": false,
                        "handleKeyUp": false,
                        "noConfirmation": true,
                        "Elements": [
                            {
                                "type": "LinearLayout",
                                "Variable": "",
                                "orientation": "vertical",
                                "height": "wrap_content",
                                "width": "match_parent",
                                "weight": "0",
                                "Elements": [
                                    {
                                        "type": "LinearLayout",
                                        "Variable": "",
                                        "orientation": "horizontal",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "Elements": [
                                            {
                                                "Value": "Количество цифр",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_num_amount",
                                                "Variable": "ocr_serial_template_num_amount",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextNumeric"
                                            },
                                            {
                                                "Value": "Префикс",
                                                "Variable": "",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "TextView"
                                            },
                                            {
                                                "Value": "@ocr_serial_template_prefix",
                                                "Variable": "ocr_serial_template_prefix",
                                                "height": "wrap_content",
                                                "width": "match_parent",
                                                "weight": "1",
                                                "type": "EditTextText"
                                            }
                                        ]
                                    },
                                    {
                                        "Value": "@ocr_serial_current_template",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "Минимальное количество обнаружений",
                                        "Variable": "",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "TextView"
                                    },
                                    {
                                        "Value": "@ocr_serial_template_min_rec_amount",
                                        "Variable": "ocr_serial_template_min_rec_amount",
                                        "height": "wrap_content",
                                        "width": "match_parent",
                                        "weight": "0",
                                        "type": "EditTextNumeric"
                                    },
                                    {
                                        "Value": "Непрерывное распознавание",
                                        "Variable": "ocr_serial_template_continuous_recognition",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Учитывать префикс",
                                        "Variable": "ocr_serial_template_use_prefix",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "CheckBox"
                                    },
                                    {
                                        "Value": "Сохранить",
                                        "Variable": "btn_save_ocr_settings",
                                        "height": "wrap_content",
                                        "width": "wrap_content",
                                        "weight": "0",
                                        "type": "Button"
                                    }
                                ]
                            }
                        ],
                        "Handlers": [
                            {
                                "event": "onStart",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_start",
                                "postExecute": ""
                            },
                            {
                                "event": "onInput",
                                "listener": "",
                                "action": "run",
                                "type": "python",
                                "method": "serial_number_ocr_settings_on_input",
                                "postExecute": ""
                            }
                        ]
                    }
                ]
            }
        ],
        "ConfigurationSettings": {
            "uid": "a6ce59bc3f714a5284213f6e293e3e91",
            "vendor": "Simple",
            "vendor_url": "",
            "vendor_auth": "",
            "handler_split_mode": false,
            "handler_code": "",
            "handler_url": "",
            "handler_auth": "",
            "dictionaries": ""
        },
        "ConfigurationTags": "Py,off-line,ActiveCV®",
        "FaceRecognitionURL": "",
        "ForegroundService": false,
        "StopForegroundServiceOnExit": false,
        "RunPython": true,
        "LaunchProcess": "",
        "MainMenu": [
            {
                "MenuId": "01",
                "MenuItem": "faq",
                "MenuTitle": "FAQ",
                "MenuTop": false
            },
            {
                "MenuId": "02",
                "MenuItem": "update_conf",
                "MenuTitle": "Обновить конфигурацию",
                "MenuTop": false
            }
        ],
        "Mediafile": [],
        "PyHandlers": "aW1wb3J0IHNtX2Fkcl9kb2NzCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKaW1wb3J0IHVpX21vZGVscwpmcm9tIHVpX21vZGVscyBpbXBvcnQgY3JlYXRlX3NjcmVlbgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgojID09PT09PT09PT09PT09PSBNYWluIGV2ZW50cyA9PT09PT09PT09PT09PT09PQoKCkBIYXNoTWFwKCkKZGVmIGFwcF9vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J7QsdGA0LDQsdC+0YLRh9C40Log0L/RgNC4INGB0YLQsNGA0YLQtSDQv9GA0LjQu9C+0LbQtdC90LjRjyAiIiIKCiAgICBtb2RlbCA9IHVpX21vZGVscy5NYWluRXZlbnRzKGhhc2hfbWFwKQogICAgbW9kZWwuYXBwX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0aW1lcl91cGRhdGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRhNC+0L3QvtCy0L7Qs9C+INC+0LHQvNC10L3QsCAiIiIKCiAgICB0aW1lciA9IHVpX21vZGVscy5UaW1lcihoYXNoX21hcCkKICAgIHRpbWVyLnRpbWVyX29uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBldmVudF9zZXJ2aWNlKGhhc2hfbWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0YDQsNCx0L7RgtGLINCc0J8g0LIg0YDQtdC20LjQvNC1INGB0LXRgNCy0LXRgNCwLgogICAgINCSIHdzX2JvZHkg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0LvQtdC20LjRgiDRgtC10LrRgdGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCAiIiIKCiAgICB1aV9tb2RlbHMuV2ViU2VydmljZVN5bmNDb21tYW5kKGhhc2hfbWFwKS5vbl9zZXJ2aWNlX3JlcXVlc3QoKQoKCgpASGFzaE1hcCgpCmRlZiBvbl9zcWxfZXJyb3IoaGFzaF9tYXApOgogICAgbW9kZWwgPSB1aV9tb2RlbHMuTWFpbkV2ZW50cyhoYXNoX21hcCkKICAgIG1vZGVsLm9uX3NxbF9lcnJvcigpCgoKQEhhc2hNYXAoKQpkZWYgb25fY2xvc2VfYXBwKGhhc2hfbWFwKToKICAgICMg0J/QvtC/0YvRgtC60LAg0L7Rh9C40YHRgtC60Lgg0LrRjdGI0LAg0L/RgNC4INCy0YvRhdC+0LTQtSDRgSDQv9GA0LjQu9C+0LbQtdC90LjRjwogICAgc3VDbGFzcy5kZWxldGVDYWNoZSgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBNYWluIGV2ZW50cyBeXl5eXl5eXl5eXl5eXl5eXgoKCiMgPT09PT09PT09PT09PT09IERvY3VtZW50cyA9PT09PT09PT09PT09PT09PQpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmbG93X2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCe0YLQtNC10LvRjNC90YvQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC/0LvQuNGC0L7QuiDQtNC70Y8g0L7Qv9GA0LXQtNC10LvQtdC90LjRjyDQv9GA0L7RhtC10YHRgdCwIGhhc2hfbWFwJ9C+0LwiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5GbG93RG9jU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd1RpbGVzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZmxvd190aWxlc19vbl9zZWxlY3QoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J7RgtC00LXQu9GM0L3Ri9C1INC+0LHRgNCw0LHQvtGC0YfQuNC60Lgg0L/Qu9C40YLQvtC6INC00LvRjyDQvtC/0YDQtdC00LXQu9C10L3QuNGPINC/0YDQvtGG0LXRgdGB0LAgaGFzaF9tYXAn0L7QvCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dUaWxlc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhcmNvZGVfZmxvd19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTog0KHQsdC+0YAg0KjQmi4g0K3QutGA0LDQvTog0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRmxvd0RvY0RldGFpbHNTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX2Zsb3dfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCh0LHQvtGAINCo0JouINCt0LrRgNCw0L06INCf0L7RgtC+0LrQqNGC0YDQuNGF0LrQvtC00L7QstCU0L7QutGD0LzQtdC90YLQsCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkZsb3dEb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgYXJ0aWNsZV9jdl9vbl9vYmplY3RfZGV0ZWN0ZWQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNC1INCw0YDRgtC40LrRg9C70L7Qsi4g0KjQsNCzOiDQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVi4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5BY3RpdmVDVkFydGljbGVSZWNvZ25pdGlvbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fb2JqZWN0X2RldGVjdGVkKCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBhcnRpY2xlX2N2X29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LIuINCo0LDQszog0J3QvtCy0YvQuSDRiNCw0LMgQWN0aXZlQ1YuIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuQWN0aXZlQ1ZBcnRpY2xlUmVjb2duaXRpb24oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpYWxfbnVtYmVyX29jcl9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQn9GA0L7RhtC10YHRgTogT2NyVGV4dFJlY29nbml0aW9uLiDQrdC60YDQsNC9OiBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy4iIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlcmlhbF9udW1iZXJfb2NyX3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiBPY3JUZXh0UmVjb2duaXRpb24uINCt0LrRgNCw0L06IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNlcmlhbE51bWJlck9DUlNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6IE9jclRleHRSZWNvZ25pdGlvbi4g0K3QutGA0LDQvTogU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MuIiIiCiAgICB1aV9tb2RlbHMuU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Muc2VyaWFsX2tleV9yZWNvZ25pdGlvbl9vY3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgZG9jc190aWxlc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiLQntGC0LTQtdC70YzQvdGL0LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQv9C70LjRgtC+0Log0LTQu9GPINC+0L/RgNC10LTQtdC70LXQvdC40Y8g0L/RgNC+0YbQtdGB0YHQsCBoYXNoX21hcCfQvtC8IiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyA9IHVpX21vZGVscy5Eb2N1bWVudHNUaWxlcyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdzX3RpbGVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5UaWxlcykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgdGlsZXNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuRG9jdW1lbnRzRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Eb2N1bWVudHNEb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZG9jc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2RvY3Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5Eb2NzTGlzdFNjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKCiMgQEhhc2hNYXAoKQojIGRlZiBkb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiMgICAgIHNjcmVlbjogdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQojICAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgZG9jX2RldGFpbHNfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbk5ldyA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2xpc3RlbmVyKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGRvY19kZXRhaWxzX2JlZm9yZV9wcm9jZXNzX2JhcmNvZGUoaGFzaF9tYXApOgogICAgIiIiINCe0LHRgNCw0LHQvtGC0YfQuNC6INC00LvRjyDRgdC40L3RhdGA0L7QvdC90L7Qs9C+INC30LDQv9GA0L7RgdCwINC4INC+0LHQvdC+0LLQu9C10L3QuNGPINC00LDQvdC90YvRhSDQv9C+0YHQu9C1INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyDQuCDQv9C10YDQtdC0INC+0LHRgNCw0LHQvtGC0LrQvtC5INCo0JoiIiIKCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uYmVmb3JlX3Byb2Nlc3NfYmFyY29kZSgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZChoYXNoX21hcCk6CiAgICAiIiIg0J7RgtC/0YDQsNCy0LrQsCDQtNCw0L3QvdGL0YUg0L/QvtGB0LvQtSDQvtCx0YDQsNCx0L7RgtC60Lgg0KjQmiIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5oYXNoX21hcC5yZW1vdmUoJ3RvYXN0JykKICAgIHNjcmVlbi5wb3N0X2JhcmNvZGVfc2Nhbm5lZCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jX3NjYW5fZXJyb3Jfc291bmQoaGFzaF9tYXApOgogICAgIiIiINCX0LLRg9C60L7QstGL0LUg0YHQuNCz0L3QsNC70Ysg0L7RiNC40LHQvtC6INGB0LrQsNC90LjRgNC+0LLQsNC90LjRjyIiIgoKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zY2FuX2Vycm9yX3NvdW5kKCkKCgpASGFzaE1hcCgpCmRlZiBoaWdobGlnaHRfc2Nhbm5lZF9pdGVtKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0L7RgtC80LXQvdGLINGA0LDRgdC60YDQsNGB0LrQuCDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L3QvdC+0LPQviDRgtC+0LLQsNGA0LAgIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuRG9jRGV0YWlsc1NjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4uZGlzYWJsZV9oaWdobGlnaHQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfcG9zdF9saW5lc19kYXRhKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICIiIiDQntGC0L/RgNCw0LLQutCwINC90LAgMdChINCy0YvQsdGA0LDQvdC90YvRhSDQsiBub3NxbCDRgdGC0YDQvtC6IHBvc3Qt0LfQsNC/0YDQvtGB0L7QvCAiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3KGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5zZW5kX3Vuc2VudF9saW5lc19ydW4oKQoKCkBIYXNoTWFwKCkKZGVmIHNlbmRfYWxsX3NjYW5fbGluZXMoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgIiIiINCe0YLQv9GA0LDQstC60LAg0L3QsCAx0KEg0LLRgdC10YUgbm9zcWwg0YHRgtGA0L7QuiDRgtC+0LLQsNGA0LAgcG9zdC3Qt9Cw0L/RgNC+0YHQvtC8ICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLnNlbmRfYWxsX3NjYW5fbGluZXNfcnVuKCkKCgpASGFzaE1hcCgpCmRlZiBhZnRlcl9zZW5kX3Bvc3RfbGluZXNfZGF0YShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAiIiIg0J/QvtGB0LvQtSDQvtGC0L/RgNCw0LLQutC4LdC+0LHRgNCw0LHQvtGC0LrQuCBwb3N0LdC30LDQv9GA0L7RgdCwICIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW5OZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLmFmdGVyX3NlbmRfZGF0YSgpCgoKQEhhc2hNYXAoKQpkZWYgYWRyX2RvY3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbigKICAgICAgICBoYXNoX21hcD1oYXNoX21hcCwKICAgICAgICBzY3JlZW5fY2xhc3M9c21fYWRyX2RvY3MuQWRyRG9jc0xpc3RTY3JlZW4KICAgICkKICAgIHNjcmVlbi5pbml0X3NjcmVlbigpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2Nfb25fc2VsZWN0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgaGFzaF9tYXA9aGFzaF9tYXAsCiAgICAgICAgc2NyZWVuX2NsYXNzPXNtX2Fkcl9kb2NzLkFkckRvY3NMaXN0U2NyZWVuCiAgICApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9kb2NfZGV0YWlsc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCBzbV9hZHJfZG9jcy5BZHJEb2NEZXRhaWxzU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBhZHJfZG9jX2RldGFpbHNfb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyRG9jRGV0YWlsc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jc19vZmZsaW5lX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Eb2NzT2ZmbGluZUxpc3RTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBlbGVtX3ZpZXZfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkdvb2RzU2VsZWN0U2NyZWVuKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZWxlbV92aWV2X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc1NlbGVjdFNjcmVlbihoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9lbGVtX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyR29vZHNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGFkcl9lbGVtX3ZpZXdfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgc21fYWRyX2RvY3MuQWRyR29vZHNTZWxlY3RTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9yZWdpc3Rlcl9kb2Nfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKQEhhc2hNYXAoKQpkZWYgYmFyY29kZV9yZWdpc3Rlcl9kb2Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBncm91cF9lbGVtX3ZpZXdfb25fY2xpY2soaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdyb3VwU2Nhbkl0ZW1TY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGdyb3VwX2VsZW1fdmlld19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR3JvdXBTY2FuSXRlbVNjcmVlbikKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ3JvdXBfZWxlbV92aWV3X29uX2NsaWNrKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hcm91cFNjYW5JdGVtU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBiYXJjb2RlX2Vycm9yX3NjcmVlbl9saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBpZiBoYXNoX21hcFsnbGlzdGVuZXInXSBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdidG5fY29udGludWVfc2NhbiddOgogICAgICAgIGhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGCINGC0L7QstCw0YDRiyIpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBEb2N1bWVudHMgXl5eXl5eXl5eXl5eXl5eXl4KCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF9pdGVtX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZWxlY3RJdGVtU2NyZWVuKS5vbl9zdGFydCgpCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfaXRlbV9vbl9pbnB1dChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VsZWN0SXRlbVNjcmVlbikub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF9pdGVtX3Jlc3VsdChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBoYXNoX21hcC50b2FzdCgnc2VsZWN0X2l0ZW1fcmVzdWx0JykKCkBIYXNoTWFwKCkKZGVmIHNob3dfaXRlbXNfc2NyZWVuX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TaG93SXRlbXNTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKQEhhc2hNYXAoKQpkZWYgc2hvd19pdGVtc19zY3JlZW5fb25faW5wdXQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNob3dJdGVtc1NjcmVlbikKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyA9PT09PT09PT09PT09PT0gR29vZHMgPT09PT09PT09PT09PT09PT0KCgpASGFzaE1hcCgpCmRlZiBnb29kc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR29vZHNMaXN0U2NyZWVuKQogICAgc2NyZWVuLmluaXRfc2NyZWVuKCkub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RzX29uX2lucHV0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5Hb29kc0xpc3RTY3JlZW4pCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNlbGVjdF90eXBlX2dvb2RzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RHb29kc1R5cGUoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZWxlY3RfdHlwZV9nb29kc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VsZWN0R29vZHNUeXBlKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5JdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgZ29vZF9jYXJkX3Bvc3Rfc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkl0ZW1DYXJkKQogICAgc2NyZWVuLm9uX3Bvc3Rfc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGdvb2RfY2FyZF9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuSXRlbUNhcmQpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIG9mZmxpbmVfZ29vZF9jYXJkX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5JdGVtQ2FyZE9mZmxpbmVTY3JlZW4oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzIF5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzQmFsYW5jZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIGJhbGFuY2VzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkdvb2RzQmFsYW5jZXNJdGVtQ2FyZCA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGJhbGFuY2VzX29uX2lucHV0KGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Hb29kc0JhbGFuY2VzSXRlbUNhcmQoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc0JhbGFuY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzUHJpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpASGFzaE1hcCgpCmRlZiBwcmljZXNfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLkdvb2RzUHJpY2VzSXRlbUNhcmQpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaWNlc19vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuR29vZHNQcmljZXNJdGVtQ2FyZCkKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHNQcmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfbGlzdF9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBzZXJpZXNfaXRlbV9vbl9pbnB1dChoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5TZXJpZXNJdGVtID0gIGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXAsIHVpX21vZGVscy5TZXJpZXNJdGVtKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc1ByaWNlcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PSBTZXR0aW5ncyA9PT09PT09PT09PT09PT09PQoKQEhhc2hNYXAoKQpkZWYgc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwLCB1aV9tb2RlbHMuU2V0dGluZ3NTY3JlZW4pCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX29uX2NsaWNrKGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCwgdWlfbW9kZWxzLlNldHRpbmdzU2NyZWVuKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVzX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkZvbnRTaXplU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmb250X3NpemVfc2V0dGluZ3NfbGlzdGVuZXIoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRm9udFNpemVTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHRlc3RfYmFyY29kZV9saXN0ZW5lcihoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5CYXJjb2RlVGVzdFNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9zdGFydChoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNldHRpbmdzX2Vycm9yc19vbl9jbGljayhoYXNoX21hcDogSGFzaE1hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5FcnJvckxvZ1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIGh0dHBfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuSHR0cFNldHRpbmdzU2NyZWVuID0gY3JlYXRlX3NjcmVlbihoYXNoX21hcCkKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgaHR0cF9zZXR0aW5nc19vbl9jbGljayhoYXNoX21hcCk6CiAgICBzY3JlZW46IHVpX21vZGVscy5IdHRwU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBzb3VuZF9zZXR0aW5nc19vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU291bmRTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIHNvdW5kX3NldHRpbmdzX2xpc3RlbmVyKGhhc2hfbWFwKToKICAgIHNjcmVlbiA9IHVpX21vZGVscy5Tb3VuZFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jdW1lbnRzX3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9Cw0YDQsNC80LXRgtGA0YsuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkRvY3VtZW50c1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgZG9jdW1lbnRzX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9Cw0YDQsNC80LXRgtGA0YsuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsiIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLkRvY3VtZW50c1NldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXiBTZXR0aW5ncyBeXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT0gUHJpbnQgPT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIHByaW50X3NldHRpbmdzX29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfc2V0dGluZ3Nfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50U2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0ZW1wbGF0ZV9saXN0X29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCh0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyIiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5UZW1wbGF0ZXNMaXN0ID0gdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiB0ZW1wbGF0ZV9saXN0X29uX2lucHV0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCh0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyIiIiCiAgICBzY3JlZW46IHVpX21vZGVscy5UZW1wbGF0ZXNMaXN0ID0gdWlfbW9kZWxzLlRlbXBsYXRlc0xpc3QoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBodG1sX3ZpZXdfb25fc3RhcnQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KDQtdC30YPQu9GM0YLQsNGCIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuSHRtbFZpZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBodG1sX3ZpZXdfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0KDQtdC30YPQu9GM0YLQsNGCIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuSHRtbFZpZXcoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9ibHVldG9vdGhfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludEJsdWV0b290aFNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfYmx1ZXRvb3RoX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggQmx1ZXRvb3RoIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRCbHVldG9vdGhTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25fc3RhcnQoKQoKCkBIYXNoTWFwKCkKZGVmIGJsdWV0b290aF9lcnJvcihoYXNoX21hcCk6CiAgICAiIiLQntCx0YnQuNC5INC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YjQuNCx0LrQuCDQv9GA0Lgg0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgQmx1ZXRvb3RoIiIiCiAgICBQcmludFNlcnZpY2UuYmx1ZXRvb3RoX2Vycm9yKGhhc2hfbWFwKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X3dpZmlfc2V0dGluZ3Nfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBXaUZpIiIiCiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuUHJpbnRXaUZpU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF93aWZpX3NldHRpbmdzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggV2lGaSIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50V2lGaVNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfd2lmaShoYXNoX21hcCk6CiAgICAiIiLQntCx0YDQsNCx0L7RgtGH0LjQuiDQtNC70Y8g0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgV2lGaS4g0JTQvtC70LbQtdC9INCx0YvRgtGMINCy0YvQt9Cy0LDQvSDQsNGB0LjQvdGF0YDQvtC90L3QviIiIgogICAgUHJpbnRTZXJ2aWNlLnByaW50X3dpZmkoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgd2lmaV9lcnJvcihoYXNoX21hcCk6CiAgICAiIiLQntCx0YnQuNC5INC+0LHRgNCw0LHQvtGC0YfQuNC6INC+0YjQuNCx0LrQuCDQv9GA0Lgg0L/QtdGH0LDRgtC4INGH0LXRgNC10LcgV2lGaSIiIgogICAgUHJpbnRTZXJ2aWNlLndpZmlfZXJyb3IoaGFzaF9tYXApCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfbGFiZWxfdGVtcGxhdGVzX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludExhYmVsVGVtcGxhdGVzU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZXNfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50TGFiZWxUZW1wbGF0ZXNTZXR0aW5ncyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICBzY3JlZW4ub25faW5wdXQoKQoKCkBIYXNoTWFwKCkKZGVmIHByaW50X2xhYmVsX3RlbXBsYXRlX3NpemVfb25faW5wdXQoaGFzaF9tYXApOgogICAgIiIi0J/RgNC+0YbQtdGB0YE6INCf0LXRh9Cw0YLRjC4g0K3QutGA0LDQvTog0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiyIiIgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlByaW50VGVtcGxhdGVTaXplU2V0dGluZ3MoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX2lucHV0KCkKCgpASGFzaE1hcCgpCmRlZiBwcmludF9sYWJlbF90ZW1wbGF0ZV9zaXplX29uX3N0YXJ0KGhhc2hfbWFwKToKICAgICIiItCf0YDQvtGG0LXRgdGBOiDQn9C10YfQsNGC0YwuINCt0LrRgNCw0L06INCd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KDQsNC30LzQtdGA0YsiIiIKICAgIHNjcmVlbiA9IHVpX21vZGVscy5QcmludFRlbXBsYXRlU2l6ZVNldHRpbmdzKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9zdGFydCgpCgoKQEhhc2hNYXAoKQpkZWYgcHJpbnRfcG9zdF9leGVjdXRlKGhhc2hfbWFwKToKICAgICIiItCh0YDQsNCx0LDRgtGL0LLQsNC10YIg0L/QvtGB0LvQtSDQstGL0LfQvtCy0LAgUHJpbnRTZXJ2aWNlLnByaW50INC4INC/0LXRh9Cw0YLQsNC10YIg0YbQtdC90L3QuNC6IiIiCiAgICBQcmludFNlcnZpY2UucHJpbnRfcG9zdF9leGVjdXRlKGhhc2hfbWFwKQoKIyBeXl5eXl5eXl5eXl5eXl5eXiBQcmludCBeXl5eXl5eXl5eXl5eXl5eXgoKCkBIYXNoTWFwKCkKZGVmIGZpbGVfYnJvd3Nlcl9vbl9zdGFydChoYXNoX21hcCk6CiAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2ltcGxlRmlsZUJyb3dzZXIoaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBmaWxlX2Jyb3dzZXJfb25faW5wdXQoaGFzaF9tYXApOgogICAgc2NyZWVuID0gdWlfbW9kZWxzLlNpbXBsZUZpbGVCcm93c2VyKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgIHNjcmVlbi5vbl9pbnB1dCgpCgoKIyA9PT09PT09PT09PT09PT0gRGVidWcgPT09PT09PT09PT09PT09PT0KCkBIYXNoTWFwKCkKZGVmIGRlYnVnX29uX3N0YXJ0KGhhc2hfbWFwOiBIYXNoTWFwKToKICAgIHNjcmVlbjogdWlfbW9kZWxzLkRlYnVnU2V0dGluZ3NTY3JlZW4gPSBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwKQogICAgc2NyZWVuLm9uX3N0YXJ0KCkKCgpASGFzaE1hcCgpCmRlZiBkZWJ1Z19saXN0ZW5lcihoYXNoX21hcCwgX2ZpbGVzPU5vbmUsIF9kYXRhPU5vbmUpOgogICAgc2NyZWVuOiB1aV9tb2RlbHMuRGVidWdTZXR0aW5nc1NjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oaGFzaF9tYXApCiAgICBzY3JlZW4ub25faW5wdXQoKQoKIyBeXl5eXl5eXl5eXl5eXl5eXiBEZWJ1ZyBeXl5eXl5eXl5eXl5eXl5eXgoKCg==",
        "pyHandlersPath": "C:/Users/Gekk0/PycharmProjects/simple_keep\\main.py",
        "PyTimerTask": [
            {
                "PyTimerTaskKey": "timer_update",
                "PyTimerTaskDef": "timer_update",
                "PyTimerTaskPeriod": "15000",
                "PyTimerTaskBuilIn": false
            }
        ],
        "PyFiles": [
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\database_init_queryes.py",
                "PyFileKey": "database_init_queryes",
                "PyFileData": "I2ltcG9ydCB1aV9nbG9iYWwKZGVmIGRhdGFiYXNlX3NoZW1hKCk6CiAgICBScyA9IFtdCgoKICAgICPQmtC+0L3RgdGC0LDQvdGC0Ysg0Lgg0YXRgNCw0L3QuNC80YvQtSDQvdCw0YHRgtGA0L7QudC60LggUlNfY29uc3RhbnRzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19jb25zdGFudHMgKAogICAgICAgIGlkICAgICAgICAgICAgIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICB1c2Vfc2VyaWVzICAgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgdXNlX3Byb3BlcnRpZXMgVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHVzZV9tYXJrICAgICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBhZGRfaWZfbm90X2luX3BsYW4gICAgIFRFWFQgICAgREVGQVVMVCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOT1QgTlVMTCwKICAgICAgICBwYXRoICAgICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBERUZBVUxUICIvL3N0b3JhZ2UvZW11bGF0ZWQvMC9BbmRyb2lkL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvIiwKICAgICAgICBkZWxldGVfZmlsZXMgICBURVhUICAgIERFRkFVTFQgMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgcmVzZXJ2ZWQgICAgICAgVEVYVCAgICBOT1QgTlVMTCwKICAgICAgICBtYXhfaWRfZG9jICAgICAgICAgSU5URUdFUiBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMSksCiAgICAgICAgYWxsb3dfb3ZlcnNjYW4gVEVYVCAgICBERUZBVUxUIDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgICAgIHJlbGVhc2UgICAgICAgIFRFWFQKICAgICkKICAgICcnJykKCgogICAgIyDQmtC70LDRgdGB0LjRhNC40LrQsNGC0L7RgCDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPIFJTX2NsYXNzaWZpZXJfdW5pdHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NsYXNzaWZpZXJfdW5pdHMgKAogICAgICAgIGlkIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgY29kZSAgICBURVhUIE5PVCBOVUxMLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICMg0JLQuNC00Ysg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3R5cGVzX2dvb2RzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU190eXBlc19nb29kcyAoCiAgICBpZCAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgbmFtZSAgICAgVEVYVCBOT1QgTlVMTCwKICAgIHVzZV9tYXJrIElOVCAgREVGQVVMVCAoMCkgCiAgICApCiAgICAnJycpCgogICAgIyDQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAgUlNfZ29vZHMKICAgIFJzLmFwcGVuZCgnJycKICAgICAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19nb29kcyAoCiAgICAgICAgICAgIGlkICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgICAgIGNvZGUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIG5hbWUgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgICAgIGFydCAgICAgICAgIFRFWFQsCiAgICAgICAgICAgIHVuaXQgICAgICAgIFRFWFQgIFJFRkVSRU5DRVMgUlNfY2xhc3NpZmllcl91bml0cyAoaWQpLAogICAgICAgICAgICB0eXBlX2dvb2QgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU190eXBlc19nb29kcyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQVRDSCBbRlVMTF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uIFRFWFQKICAgICAgICApCiAgICAgICAgJycnKQoKCiAgICAjINCl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3Byb3BlcnRpZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3Byb3BlcnRpZXMgKAogICAgaWQgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBPTiBDT05GTElDVCBSRVBMQUNFLAogICAgaWRfb3duZXIgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCkgT04gREVMRVRFIE5PIEFDVElPTgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT04gVVBEQVRFIE5PIEFDVElPTiwKICAgIG5hbWUgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCgogICAgIyDQo9C/0LDQutC+0LLQutC4INCV0LTQuNC90LjRhtGLINC40LfQvNC10YDQtdC90LjRjyBSU191bml0cwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfdW5pdHMgKAogICAgICAgIGlkICAgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgaWRfb3duZXIgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBjb2RlICAgICAgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgbmFtZSAgICAgICAgICBURVhUICAgIE5PVCBOVUxMLAogICAgICAgIG5vbWluYXRvciAgICAgSU5URUdFUiBOT1QgTlVMTCwKICAgICAgICBkZW5vbWluYXRvciAgIElOVEVHRVIgTk9UIE5VTEwsCiAgICAgICAgaW50X3JlZHVjdGlvbiBURVhUICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgoKCiAgICAjINCh0LXRgNC40Lgg0L3QvtC80LXQvdC60LvQsNGC0YPRgNGLIFJTX3NlcmllcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfc2VyaWVzICgKICAgICAgICBpZCAgICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBiZXN0X2JlZm9yZSAgICAgVEVYVCwKICAgICAgICB0eXBlX2dvb2RzICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCBOT1QgTlVMTCwKICAgICAgICBwcm9kdWN0aW9uX2RhdGUgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgICPQmNC90LTQtdC60YHRiyBSU19zZXJpZXMKICAgIFJzLmFwcGVuZCgnJydDUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyAgU2VyaWVzX25hbWUgT04gUlNfc2VyaWVzICgKICAgIG5hbWUgQVNDICkKICAgICcnJykKCiAgICAjINCo0YLRgNC40YXQutC+0LTRiyBSU19iYXJjb2RlcwogICAgUnMuYXBwZW5kKCAnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2JhcmNvZGVzICgKICAgIGJhcmNvZGUgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICBpZF9nb29kICAgICBURVhUIE5PVCBOVUxMLAogICAgaWRfcHJvcGVydHkgVEVYVCwKICAgIGlkX3NlcmllcyAgIFRFWFQsCiAgICBpZF91bml0ICAgICBURVhULAogICAgcmF0aW8gICAgICAgSU5UICBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApCiAgICAnJycpCgogICAgI9Ca0L7QtNGLINC80LDRgNC60LjRgNC+0LLQutC4IFJTX21hcmtpbmdfY29kZXMKICAgIFJzLmFwcGVuZCggJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19tYXJraW5nX2NvZGVzICgKICAgICAgICBpZCAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBtYXJrX2NvZGUgICBURVhUIE5PVCBOVUxMLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9wcm9wZXJ0eSBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSAKICAgICkKICAgICcnJykKCgoKICAgICMg0JrQvtC90YLRgNCw0LPQtdC90YLRiyBSU19jb3VudHJhZ2VudHMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NvdW50cmFnZW50cyAoCiAgICAgICAgaWQgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgbmFtZSAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgZnVsbF9uYW1lIFRFWFQgTk9UIE5VTEwsCiAgICAgICAgaW5uICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICAgICAga3BwICAgICAgIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCh0LrQu9Cw0LTRiyBSU193YXJlaG91c2VzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU193YXJlaG91c2VzICgKICAgICAgICBpZCBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIG5hbWUgICAgVEVYVCBOT1QgTlVMTAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2NlbGxzICgKICAgIGlkICAgVEVYVCBQUklNQVJZIEtFWQogICAgICAgICAgICAgIE5PVCBOVUxMLAogICAgbmFtZSBURVhUIE5PVCBOVUxMLAogICAgYmFyY29kZSBURVhUCiAgICApJycnKQoKICAgICMg0JLQuNC00Ysg0YbQtdC9INC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZV90eXBlcwogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfcHJpY2VfdHlwZXMgKAogICAgICAgIGlkICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSwKICAgICAgICBuYW1lIFRFWFQgTk9UIE5VTEwKICAgICkKICAgICcnJykKCiAgICAjINCm0LXQvdGLINC90L7QvNC10L3QutC70LDRgtGD0YDRiyBSU19wcmljZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX3ByaWNlcyAoCiAgICAgICAgaWQgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX3ByaWNlX3R5cGVzIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBpZF9nb29kcyAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICAgICAgaWRfcHJvcGVydGllcyAgVEVYVCAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgcHJpY2UgICAgICAgICAgUkVBTCwKICAgICAgICBpZF91bml0ICAgICAgICBURVhUICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX3VuaXRzIChpZCkgCiAgICApCiAgICAnJycpCgogICAgUnMuYXBwZW5kKCcnJwogICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgUlNfZG9jX3R5cGVzICgKICAgIGRvY190eXBlIFRFWFQgUFJJTUFSWSBLRVkgT04gQ09ORkxJQ1QgUkVQTEFDRQogICAgICAgICAgICAgICAgTk9UIE5VTEwsCiAgICBpc19hZHJfc3RvcmFnZSBJTlQgIERFRkFVTFQgKDApIAogICAgKQogICAgJycnKQoKICAgICMg0JLRgdC1INC00L7QutGD0LzQtdC90YLRiyDRgdC/0LjRgdC60L7QvCBSU19kb2NzCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfY291bnRyYWdlbnRzICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfY291bnRyYWdlbnRzIChpZCksCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUIERFRkFVTFQgMCwKICAgICAgICBpc19ncm91cF9zY2FuICAgICAgVEVYVCBERUZBVUxUIDAsCiAgICAgICAgaXNfYmFyY19mbG93ICAgICAgIFRFWFQgREVGQVVMVCAwLAogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgICBURVhUIERFRkFVTFQgMAogICAgICAgIAogICAgKQogICAgJycnKQoKCiAgICAjINCi0LDQsdC70LjRh9C90LDRjyDRh9Cw0YHRgtGMINC00L7QutGD0LzQtdC90YLQvtCyIFJTX2RvY3NfdGFibGUKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfdGFibGUgKAogICAgICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgICAgICBpZF9kb2MgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICAgICAgaWRfZ29vZCAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgICAgIGlkX3Byb3BlcnRpZXMgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICAgICAgaWRfc2VyaWVzICAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3NlcmllcyAoaWQpLAogICAgICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfdW5pdHMgKGlkKSwKICAgICAgICBxdHR5ICAgICAgICAgIFJFQUwsCiAgICAgICAgZF9xdHR5ICAgICAgICBSRUFMLCAgCiAgICAgICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgICAgIHByaWNlICAgICAgICAgUkVBTCwKICAgICAgICBpZF9wcmljZSAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfcHJpY2VfdHlwZXMgKGlkKSwKICAgICAgICBzZW50ICAgICAgICAgIElOVEVHRVIsCiAgICAgICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGlzX3BsYW4gICAgICAgVEVYVCBERUZBVUxUICJUcnVlIiwKICAgICAgICBpZF9jZWxsICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgSU5URUdFUiBERUZBVUxUIDAgCiAgICApCiAgICAnJycpCgoKICAgICMg0JrQvtC00Ysg0LzQsNGA0LrQuNGA0L7QstC60Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1IFJTX2RvY3NfYmFyY29kZXMKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3NfYmFyY29kZXMgKAogICAgaWQgICAgICAgICAgICAgICAgICAgICAgSU5URUdFUiBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgaWRfZG9jICAgICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYykgT04gREVMRVRFIENBU0NBREUsCiAgICBpZF9nb29kICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydHkgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfcHJvcGVydGllcyAoaWQpLAogICAgaWRfc2VyaWVzICAgICAgICAgICAgICAgVEVYVCBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfc2VyaWVzIChpZCksCiAgICBpZF91bml0ICAgICAgICAgICAgICAgICBURVhUIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpICwKICAgIG1hcmtfY29kZSAgICAgICAgICAgICAgIFRFWFQgTk9UIE5VTEwsCiAgICBiYXJjb2RlX2Zyb21fc2Nhbm5lciAgICBURVhULAogICAgaXNfcGxhbiAgICAgICAgICAgICAgICAgSU5URUdFUiBERUZBVUxUIDAgTk9UIE5VTEwsCiAgICBhcHByb3ZlZCAgICAgICAgICAgICAgICBJTlRFR0VSIERFRkFVTFQgMCwKICAgIEdUSU4gICAgICAgICAgICAgICAgICAgIFRFWFQsCiAgICBTZXJpZXMgICAgICAgICAgICAgICAgICBURVhUCiAgICApCiAgICAnJycpCgogICAgI9Cf0L7RgtC+0Log0L/RgNC+0LjQt9Cy0L7Qu9GM0L3Ri9GFINGI0YLRgNC40YXQutC+0LTQvtCyCiAgICBScy5hcHBlbmQoJycnCiAgICBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBSU19iYXJjX2Zsb3cgKAogICAgaWRfZG9jICBURVhUIFJFRkVSRU5DRVMgUlNfZG9jcyAoaWRfZG9jKSwKICAgIGJhcmNvZGUgVEVYVAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzICgKICAgIGlkX2RvYyAgICAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX24gICAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgZG9jX2RhdGUgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICB2ZXJpZmllZCAgICAgICAgICAgSU5URUdFUiwKICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgYWRkX21hcmtfc2VsZWN0aW9uIElOVEVHRVIsCiAgICBjcmVhdGVkX2F0ICAgICAgICAgREFURVRJTUUgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCwKICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICBERUZBVUxUIDAsCiAgICBhbGxvd19mYWN0X2lucHV0ICAgVEVYVCBERUZBVUxUIDAKICAgIAogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2Fkcl9kb2NzX3RhYmxlICgKICAgIGlkICAgICAgICAgICAgSU5URUdFUiAgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19hZHJfZG9jcyAoaWRfZG9jKSBPTiBERUxFVEUgQ0FTQ0FERQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBTRVQgREVGQVVMVCwKICAgIGlkX2dvb2QgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgUkVGRVJFTkNFUyBSU19nb29kcyAoaWQpLAogICAgaWRfcHJvcGVydGllcyBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3Byb3BlcnRpZXMgKGlkKSwKICAgIGlkX3NlcmllcyAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3VuaXQgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU191bml0cyAoaWQpLAogICAgcXR0eSAgICAgICAgICBSRUFMLAogICAgcXR0eV9wbGFuICAgICBSRUFMLAogICAgc2VudCAgICAgICAgICBJTlRFR0VSLAogICAgbGFzdF91cGRhdGVkICBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiAgICAgICBURVhUICAgICBERUZBVUxUIFRydWUsCiAgICBpZF9jZWxsICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSwgCiAgICB0YWJsZV90eXBlICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgIERFRkFVTFQgJ291dCcsCiAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkKICAgICkKICAgICcnJykKCiAgICBScy5hcHBlbmQoJycnCiAgICAgICAgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgRXJyb3JfbG9nICgKICAgICAgICBsb2cgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoJycpLAogICAgICAgIHRpbWVzdGFtcCBEQVRFVElNRSBERUZBVUxUIChDVVJSRU5UX1RJTUVTVEFNUCkpIAogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX25hbWUgT04gUlNfY2VsbHMgKAogICAgbmFtZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBJTkRFWCAgSUYgTk9UIEVYSVNUUyBjZWxsX2JhcmNvZGUgT04gUlNfY2VsbHMgKAogICAgYmFyY29kZQogICAgKQogICAgJycnKQoKICAgIFJzLmFwcGVuZCgnJycKICAgIENSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIFJTX2RvY3Nfc2VyaWVzICgKICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQsCiAgICBpZF9kb2MgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICBpZF9nb29kICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2dvb2RzIChpZCksCiAgICBpZF9wcm9wZXJ0aWVzICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzIChpZCksCiAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgIGlkX3dhcmVob3VzZSAgICBURVhUICAgICBSRUZFUkVOQ0VTIFJTX3dhcmVob3VzZXMgKGlkKSwKICAgIHF0dHkgICAgICAgICAgICBSRUFMLAogICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgYmVzdF9iZWZvcmUgICAgIERBVEVUSU1FLAogICAgbnVtYmVyICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgY2VsbCAgICAgICAgICAgIFRFWFQgICAgIFJFRkVSRU5DRVMgUlNfY2VsbHMgKGlkKSBPTiBERUxFVEUgTk8gQUNUSU9OCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICknJycpCgoKCiMgUlNfY29uc3RhbnRzICsgUlNfY2xhc3NpZmllcl91bml0cyArIFJTX3R5cGVzX2dvb2RzCiMgICAgIFJzID0gKyBSU19nb29kcyArIFJTX3Byb3BlcnRpZXNcCiMgICAgICAgICAgKyBSU19zZXJpZXMgKyBSU191bml0cyArIFJTX2JhcmNvZGVzICsgUlNfbWFya2luZ19jb2RlcyArIFJTX2RvY3MgKyBSU19kb2NzX2JhcmNvZGVzXAojICAgICAgICAgICsgUlNfZG9jc190YWJsZSArIFJTX3ByaWNlX3R5cGVzICsgUlNfcHJpY2VzICsgUlNfY291bnRyYWdlbnRzICsgUlNfd2FyZWhvdXNlcwoKICAgIHJldHVybiBScwojcHJpbnQoZGF0YWJhc2Vfc2hlbWEoKSkKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2NvbnN0YW50cykKICAgICMgUnMuYXBwZW5kKFJTX2NsYXNzaWZpZXJfdW5pdHMpCiAgICAjIFJzLmFwcGVuZChSU190eXBlc19nb29kcykKICAgICMKICAgICMgUnMuYXBwZW5kKFJTX2dvb2RzKQogICAgIyBScy5hcHBlbmQoUlNfcHJvcGVydGllcykKICAgICMgUnMuYXBwZW5kKFJTX3NlcmllcykKICAgICMgUnMuYXBwZW5kKFJTX3VuaXRzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19tYXJraW5nX2NvZGVzKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfZG9jcykKICAgICMgUnMuYXBwZW5kKFJTX2RvY3NfYmFyY29kZXMpCiAgICAjIFJzLmFwcGVuZChSU19kb2NzX3RhYmxlKQogICAgIwogICAgIyBScy5hcHBlbmQoUlNfcHJpY2VfdHlwZXMpCiAgICAjIFJzLmFwcGVuZChSU19wcmljZXMpCiAgICAjCiAgICAjIFJzLmFwcGVuZChSU19jb3VudHJhZ2VudHMpCiAgICAjIFJzLmFwcGVuZChSU193YXJlaG91c2VzKQogICAgI3VpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KFJzKQoK"
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\db_services.py",
                "PyFileKey": "db_services",
                "PyFileData": "aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YSwgdGltZXpvbmUKZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIExpdGVyYWwsIE9wdGlvbmFsCgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVTUUxQcm92aWRlciBhcyBzcWxDbGFzcwpmcm9tIHVpX2dsb2JhbCBpbXBvcnQgZ2V0X3F1ZXJ5X3Jlc3VsdCwgYnVsa19xdWVyeQpmcm9tIHRpbnlfZGJfc2VydmljZXMgaW1wb3J0IFNjYW5uaW5nUXVldWVTZXJ2aWNlLCBMb2dnZXJTZXJ2aWNlCgoKY2xhc3MgRGJTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSAnJwogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IE5vbmUKICAgICAgICBzZWxmLmRlYnVnID0gRmFsc2UKICAgICAgICBzZWxmLnByb3ZpZGVyID0gU3FsUXVlcnlQcm92aWRlcihzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlID0gTG9nZ2VyU2VydmljZSgpCgogICAgZGVmIF93cml0ZV9lcnJvcl9vbl9sb2coc2VsZiwgZXJyb3JfdGV4dDogc3RyKToKICAgICAgICBpZiBlcnJvcl90ZXh0OgogICAgICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlLndyaXRlX3RvX2xvZygKICAgICAgICAgICAgICAgIGVycm9yX3R5cGU9IlNRTCIsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PWVycm9yX3RleHQsCiAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSJEQlNlcnZpY2UiCiAgICAgICAgICAgICkKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtczogc3RyID0gJycsIHRhYmxlX25hbWU9JycpOgoKICAgICAgICBpZiB0YWJsZV9uYW1lOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHBhcmFtcykKCgpjbGFzcyBUaW1lclNlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRlZiBfX2ludF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQoKICAgIGRlZiBzYXZlX2xvYWRfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX3ByZXBhcmVfZGF0YV90b19zYXZlKGRhdGEpCgogICAgICAgIGNsZWFyX3RhYmxlcyA9IFsnUlNfZG9jc190YWJsZScsICdSU19hZHJfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfZG9jc19zZXJpZXMnXQoKICAgICAgICBmb3IgdGFibGVfbmFtZSwgdmFsdWVzIGluIGRhdGEuaXRlbXMoKToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiBjbGVhcl90YWJsZXMgYW5kIHZhbHVlczoKICAgICAgICAgICAgICAgIGlkX2RvYyA9IHZhbHVlc1swXVsnaWRfZG9jJ10KICAgICAgICAgICAgICAgIF9maWx0ZXIgPSB7J2lkX2RvYyc6IGlkX2RvY30KCiAgICAgICAgICAgICAgICBzZWxmLnByb3ZpZGVyLmRlbGV0ZShfZmlsdGVyKQogICAgICAgICAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKHZhbHVlcykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucHJvdmlkZXIucmVwbGFjZSh2YWx1ZXMpCgogICAgZGVmIF9wcmVwYXJlX2RhdGFfdG9fc2F2ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiAnUlNfZG9jc19iYXJjb2RlcycgaW4gZGF0YToKICAgICAgICAgICAgZG9jc19iYXJjb2RlcyA9IFtdCiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGFbJ1JTX2RvY3NfYmFyY29kZXMnXToKICAgICAgICAgICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYucGFyc2VfYmFyY29kZShpdGVtWydtYXJrX2NvZGUnXSkKICAgICAgICAgICAgICAgIGRvY3NfYmFyY29kZXMuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGl0ZW1bJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGl0ZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogaXRlbVsnaWRfcHJvcGVydHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Nlcmllcyc6IGl0ZW1bJ2lkX3NlcmllcyddLAogICAgICAgICAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IGl0ZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmtfY29kZSc6IGl0ZW1bJ21hcmtfY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnYmFyY29kZV9mcm9tX3NjYW5uZXInOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2lzX3BsYW4nOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2FwcHJvdmVkJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdHVElOJzogYmFyY29kZV9kYXRhWydHVElOJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICdTZXJpZXMnOiBiYXJjb2RlX2RhdGFbJ1NlcmllcyddCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBkYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NzX2JhcmNvZGVzCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsID0gdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKS5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBndGluID0gdmFsWzI6MTZdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZ3RpbiA9IHZhbFs6MTRdCiAgICAgICAgICAgIHNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBndGluLCAnU2VyaWVzJzogc2VyaWVzfQoKICAgIGRlZiBnZXRfbmV3X2xvYWRfZG9jcyhzZWxmLCBkYXRhOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGxvYWRlZF9kb2N1bWVudHMgPSB7fQoKICAgICAgICBmb3IgZG9jX3R5cGUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ106CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGEuZ2V0KGRvY190eXBlLCBbXSk6CiAgICAgICAgICAgICAgICBsb2FkZWRfZG9jdW1lbnRzW2l0ZW1bJ2lkX2RvYyddXSA9IGl0ZW0KCiAgICAgICAgaWYgbm90IGxvYWRlZF9kb2N1bWVudHM6CiAgICAgICAgICAgIHJldHVybiBsb2FkZWRfZG9jdW1lbnRzCgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2RvY3MKICAgICAgICAgICAgVU5JT04KICAgICAgICAgICAgU0VMRUNUIGlkX2RvYyBGUk9NIFJTX2Fkcl9kb2NzCiAgICAgICAgJycnCgogICAgICAgIGRiX2RvY3MgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxKQogICAgICAgIGZvciBkb2MgaW4gZGJfZG9jczoKICAgICAgICAgICAgaWYgZG9jWydpZF9kb2MnXSBpbiBsb2FkZWRfZG9jdW1lbnRzOgogICAgICAgICAgICAgICAgbG9hZGVkX2RvY3VtZW50cy5wb3AoZG9jWydpZF9kb2MnXSkKCiAgICAgICAgcmV0dXJuIGxvYWRlZF9kb2N1bWVudHMKCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmKToKICAgICAgICBkYXRhID0gRG9jU2VydmljZSgpLmdldF9kYXRhX3RvX3NlbmQoKSArIEFkckRvY1NlcnZpY2UoKS5nZXRfZGF0YV90b19zZW5kKCkKICAgICAgICByZXR1cm4gZGF0YQoKCmNsYXNzIEJhcmNvZGVTZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUnNfYmFyY29kZXMnLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKCiAgICBkZWYgYWRkX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLmNyZWF0ZShiYXJjb2RlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2RlX2RhdGEoc2VsZiwgYmFyY29kZV9pbmZvLCBpZF9kb2MsIGlzX2Fkcl9kb2M9RmFsc2UsIGlkX2NlbGw9JycsIHRhYmxlX3R5cGU9JycpOgogICAgICAgIGlmIGJhcmNvZGVfaW5mby5zY2hlbWUgPT0gJ0dTMSc6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5ndGluWzE6XQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlYXJjaF92YWx1ZSA9IGJhcmNvZGVfaW5mby5iYXJjb2RlCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCBpZF9jZWxsOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdpZF9jZWxsIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIGlmIGlzX2Fkcl9kb2MgYW5kIG5vdCB0YWJsZV90eXBlOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCd0YWJsZV90eXBlIG11c3QgYmUgc3BlY2lmaWVkIGZvciBBZHIgZG9jcycpCgogICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgJ3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLnByaWNlJywKICAgICAgICAgICAgJ2lkX3ByaWNlX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZG9jX3RhYmxlLmlkX3ByaWNlJywKICAgICAgICAgICAgJ2RfcXR0eV9maWVsZCc6ICdkb2NfdGFibGUucXR0eScgaWYgaXNfYWRyX2RvYyBlbHNlICdkb2NfdGFibGUuZF9xdHR5JywKICAgICAgICAgICAgJ3VzZV9tYXJrX2ZpZWxkJzogJ05VTEwnIGlmIGlzX2Fkcl9kb2MgZWxzZSAnZ29vZHMudXNlX21hcmsnLAogICAgICAgICAgICAnZG9jc190YWJsZSc6ICdSU19hZHJfZG9jc190YWJsZScgaWYgaXNfYWRyX2RvYyBlbHNlICdSU19kb2NzX3RhYmxlJywKICAgICAgICAgICAgJ2NlbGxfY29uZGl0aW9uJzogZidBTkQgZG9jX3RhYmxlLmlkX2NlbGwgPSAie2lkX2NlbGx9IicgaWYgaXNfYWRyX2RvYyBlbHNlICcnLAogICAgICAgICAgICAndGFibGVfdHlwZV9jb25kaXRpb24nOiBmJ0FORCBkb2NfdGFibGUudGFibGVfdHlwZSA9ICJ7dGFibGVfdHlwZX0iJyBpZiBpc19hZHJfZG9jIGVsc2UgJycsCiAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgICdndGluJzogYmFyY29kZV9pbmZvLmd0aW4sCiAgICAgICAgICAgICdzZXJpZXMnOiBiYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlYXJjaF92YWx1ZSwKICAgICAgICB9CgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfZ29vZCBBUyBpZF9nb29kLCAKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3Byb3BlcnR5IEFTIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgYmFyY29kZXMuaWRfc2VyaWVzIEFTIGlkX3NlcmllcywKICAgICAgICAgICAgICAgIGJhcmNvZGVzLmlkX3VuaXQgQVMgaWRfdW5pdCwKICAgICAgICAgICAgICAgIGJhcmNvZGVzLnJhdGlvIEFTIHJhdGlvLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY19iYXJjb2Rlcy5hcHByb3ZlZCwgMCkgQVMgYXBwcm92ZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jX2JhcmNvZGVzLmlkLCAwKSBBUyBtYXJrX2lkLAogICAgICAgICAgICAgICAgSUZOVUxMKHt1c2VfbWFya19maWVsZH0sIGZhbHNlKSBBUyB1c2VfbWFyaywKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUuaWQsICcnKSBBUyByb3dfa2V5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS51c2Vfc2VyaWVzLCAwKSBBUyB1c2Vfc2VyaWVzLAogICAgICAgICAgICAgICAgSUZOVUxMKHtkX3F0dHlfZmllbGR9LCAwLjApIEFTIGRfcXR0eSwKICAgICAgICAgICAgICAgIElGTlVMTChkb2NfdGFibGUucXR0eSwgMC4wKSBBUyBxdHR5LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuLAogICAgICAgICAgICAgICAgSUZOVUxMKHtwcmljZV9maWVsZH0sIDAuMCkgQVMgcHJpY2UsCiAgICAgICAgICAgICAgICBJRk5VTEwoe2lkX3ByaWNlX2ZpZWxkfSwgJycpIEFTIGlkX3ByaWNlLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY190YWJsZS5xdHR5X3BsYW4sIDAuMCkgQVMgcXR0eV9wbGFuCgogICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzIEFTIGJhcmNvZGVzCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgICAgICAgICAoU0VMRUNUIAogICAgICAgICAgICAgICAgICAgICAgICBnb29kcy5pZCBBUyBpZF9nb29kcywgCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVzX2dvb2RzLnVzZV9tYXJrIAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBGUk9NICBSU19nb29kcyBBUyBnb29kcwogICAgICAgICAgICAgICAgICAgIEpPSU4gUlNfdHlwZXNfZ29vZHMgQVMgdHlwZXNfZ29vZHMgT04gZ29vZHMudHlwZV9nb29kID0gdHlwZXNfZ29vZHMuaWQpIEFTIGdvb2RzCiAgICAgICAgICAgICAgICBPTiBiYXJjb2Rlcy5pZF9nb29kID0gZ29vZHMuaWRfZ29vZHMKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiB7ZG9jc190YWJsZX0gQVMgZG9jX3RhYmxlIAogICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfZ29vZCA9IGRvY190YWJsZS5pZF9nb29kCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF9wcm9wZXJ0eSA9IGRvY190YWJsZS5pZF9wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgIEFORCBiYXJjb2Rlcy5pZF91bml0ID0gZG9jX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgICAgICAgICAgQU5EIGRvY190YWJsZS5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgICAgICAgICAgICAgIHtjZWxsX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgICAgICAge3RhYmxlX3R5cGVfY29uZGl0aW9ufQogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2RvY3NfYmFyY29kZXMgYXMgZG9jX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBPTiBkb2NfYmFyY29kZXMuaWRfZG9jID0gIntpZF9kb2N9IgogICAgICAgICAgICAgICAgICAgIEFORCBkb2NfYmFyY29kZXMuR1RJTiA9ICJ7Z3Rpbn0iCiAgICAgICAgICAgICAgICAgICAgQU5EIGRvY19iYXJjb2Rlcy5TZXJpZXMgPSAie3Nlcmllc30iCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgYmFyY29kZXMuYmFyY29kZSA9ICJ7YmFyY29kZX0iJycnLmZvcm1hdCgqKnBhcmFtcykKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKICAgICAgICBpZiByZXN1bHQ6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF0KCiAgICBkZWYgZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZiwgaWRfZG9jX3RhYmxlOiBzdHIpIC0+IHN0cjoKICAgICAgICBxID0gJycnCiAgICAgICAgU0VMRUNUIGJhcmNvZGUKICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgCiAgICAgICAgTEVGVCBKT0lOICAgUlNfZG9jc190YWJsZSBPTiAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19iYXJjb2Rlcy5pZF9nb29kIEFORCAKICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMgPSBSU19iYXJjb2Rlcy5pZF9wcm9wZXJ0eSBBTkQgCiAgICAgICAgUlNfZG9jc190YWJsZS5pZF91bml0ID0gUlNfYmFyY29kZXMuaWRfdW5pdCAgCiAgICAgICAgCiAgICAgICAgV0hFUkUgUlNfZG9jc190YWJsZS5pZCA9ID8KICAgICAgICAKICAgICAgICBMSU1JVCAxICcnJwoKICAgICAgICByZXN1bHQgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2NfdGFibGUpCiAgICAgICAgaWYgcmVzdWx0OgogICAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdWydiYXJjb2RlJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gJzAwMDAwMDAwMDAwMTEnCgoKICAgIGRlZiByZXBsYWNlX29yX2NyZWF0ZV90YWJsZShzZWxmLCB0YWJsZV9uYW1lLCBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci5yZXBsYWNlKGRvY3NfdGFibGVfdXBkYXRlX2RhdGEpCgogICAgZGVmIGdldF9iYXJjb2Rlc19ieV9nb29kc19pZChzZWxmLCBnb29kc19pZCkgLT4gbGlzdDoKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBiYXJjb2Rlcy5iYXJjb2RlLAogICAgICAgICAgICAgICAgSUZOVUxMKHByb3BzLm5hbWUsICcnKSBBUyBwcm9wZXJ0eSwKICAgICAgICAgICAgICAgIElGTlVMTCh1bml0cy5uYW1lLCAnJykgQVMgdW5pdAoKICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY29kZXMgQVMgYmFyY29kZXMKICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzIEFTIHByb3BzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfcHJvcGVydHkgPSBwcm9wcy5pZAogICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzIEFTIHVuaXRzCiAgICAgICAgICAgICAgICAgICAgT04gYmFyY29kZXMuaWRfdW5pdCA9IHVuaXRzLmlkCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIFdIRVJFIGJhcmNvZGVzLmlkX2dvb2QgPSAne2dvb2RzX2lkfScKICAgICAgICAnJycKCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbnNlcnRfbm9fc3FsKHF1ZXVlX3VwZGF0ZV9kYXRhKToKICAgICAgICBwcm92aWRlciA9IFNjYW5uaW5nUXVldWVTZXJ2aWNlKCkKICAgICAgICBwcm92aWRlci5zYXZlX3NjYW5uZWRfcm93X2RhdGEocXVldWVfdXBkYXRlX2RhdGEpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF90YWJsZV9saW5lKHRhYmxlX25hbWUsIGZpbHRlcnM6IGRpY3QgPSBOb25lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT10YWJsZV9uYW1lKQogICAgICAgIHNlbGVjdF9wYXJ0ID0gZiIiIlNFTEVDVCAqIEZST00ge3RhYmxlX25hbWV9IiIiCiAgICAgICAgcXVlcnkgPSBzZWxlY3RfcGFydAogICAgICAgIGlmIGZpbHRlcnM6CiAgICAgICAgICAgIGZpbHRlcnNfcGFydCA9ICIiIiBXSEVSRSAiIiIKICAgICAgICAgICAgZm9yIGNvdW50LCBmaWVsZF9uYW1lIGluIGVudW1lcmF0ZShsaXN0KGZpbHRlcnMpKToKICAgICAgICAgICAgICAgIGZpbHRlcnNfcGFydCArPSBmIiIie2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiIGlmIGNvdW50ID09IDAgZWxzZSBcCiAgICAgICAgICAgICAgICAgICAgZiIiIiBBTkQge2ZpZWxkX25hbWV9PSd7ZmlsdGVyc1tmaWVsZF9uYW1lXX0nIiIiCiAgICAgICAgICAgIHF1ZXJ5ID0gZiIiIntzZWxlY3RfcGFydH0ge2ZpbHRlcnNfcGFydH0iIiIKCiAgICAgICAgcmVzdWx0ID0gcHJvdmlkZXIuc3FsX3F1ZXJ5KHF1ZXJ5LCAnJykKICAgICAgICByZXR1cm4gcmVzdWx0WzBdIGlmIHJlc3VsdCBlbHNlIE5vbmUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgdXBkYXRlX2xpbmVfcXR0eSh0YWJsZV9saW5lKToKICAgICAgICBwcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIodGFibGVfbmFtZT0nUlNfZG9jc190YWJsZScpCiAgICAgICAgcHJvdmlkZXIudXBkYXRlKGRhdGE9dGFibGVfbGluZSkKCgpjbGFzcyBEb2NTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRvY19pZD0nJywgaXNfZ3JvdXBfc2Nhbj1GYWxzZSwgaXNfYmFyY19mbG93PUZhbHNlKToKICAgICAgICBzZWxmLmRvY19pZCA9IGRvY19pZAogICAgICAgIHNlbGYuZG9jc190YWJsZV9uYW1lID0gJ1JTX2RvY3MnCiAgICAgICAgc2VsZi5kZXRhaWxzX3RhYmxlX25hbWUgPSAnUlNfZG9jc190YWJsZScKICAgICAgICBzZWxmLmlzQWRyID0gRmFsc2UKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IEZhbHNlCiAgICAgICAgc2VsZi5pc19ncm91cF9zY2FuID0gaXNfZ3JvdXBfc2NhbgogICAgICAgIHNlbGYuaXNfYmFyY19mbG93ID0gaXNfYmFyY19mbG93CiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc2VsZi5kb2NzX3RhYmxlX25hbWUsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2UgPSBMb2dnZXJTZXJ2aWNlKCkKCiAgICBkZWYgZ2V0X2xhc3RfZWRpdGVkX2dvb2RzKHNlbGYsIHRvX2pzb249RmFsc2UpOgogICAgICAgIHF1ZXJ5X2RvY3MgPSBmJ1NFTEVDVCAqIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBXSEVSRSBpZF9kb2MgPSA/IGFuZCB2ZXJpZmllZCA9IDEnCgogICAgICAgIHF1ZXJ5X2dvb2RzID0gZicnJwogICAgICAgIFNFTEVDVCAqIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfV90YWJsZQogICAgICAgIFdIRVJFIGlkX2RvYyA9ID8gYW5kIHNlbnQgPSAwCiAgICAgICAgJycnCgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzX2RvY3MgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2RvY3MsIChzZWxmLmRvY19pZCwpLCBUcnVlKQogICAgICAgICAgICByZXNfZ29vZHMgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2dvb2RzLCAoc2VsZi5kb2NfaWQsKSwgVHJ1ZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJhaXNlIGUKICAgICAgICAgICAgIyByZXR1cm4geydFcnJvcic6IGUuYXJnc1swXX0KCiAgICAgICAgaWYgbm90IHJlc19nb29kczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAgICAgcmV0dXJuIHNlbGYuZm9ybV9kYXRhX2Zvcl9yZXF1ZXN0KHJlc19kb2NzLCByZXNfZ29vZHMsIHRvX2pzb24pCgogICAgZGVmIGZvcm1fZGF0YV9mb3JfcmVxdWVzdChzZWxmLCByZXNfZG9jcywgcmVzX2dvb2RzLCB0b19qc29uKToKICAgICAgICBmb3IgaXRlbSBpbiByZXNfZG9jczoKICAgICAgICAgICAgZmlsdGVyZWRfbGlzdCA9IFtkIGZvciBkIGluIHJlc19nb29kcyBpZiBkWydpZF9kb2MnXSA9PSBpdGVtWydpZF9kb2MnXV0KICAgICAgICAgICAgZ29vZHNfdGFibGUgPSBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX1fdGFibGUnCiAgICAgICAgICAgIGl0ZW1bZ29vZHNfdGFibGVdID0gZmlsdGVyZWRfbGlzdAogICAgICAgICAgICBpZiBub3Qgc2VsZi5pc0FkcjoKICAgICAgICAgICAgICAgIGl0ZW1bJ1JTX2RvY3NfYmFyY29kZXMnXSA9IFtdCiAgICAgICAgICAgICAgICBpdGVtWydSU19iYXJjX2Zsb3cnXSA9IFtdCgogICAgICAgIGlmIHRvX2pzb246CiAgICAgICAgICAgIHJldHVybiBqc29uLmR1bXBzKHJlc19kb2NzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiByZXNfZG9jcwoKICAgIGRlZiB1cGRhdGVfZGF0YV9mcm9tX2pzb24oc2VsZiwganNvbl9kYXRhKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWRzKGpzb25fZGF0YSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGRhdGEgPSBqc29uX2RhdGEKCiAgICAgICAgaWYgZGF0YS5nZXQoc2VsZi5kb2NzX3RhYmxlX25hbWUpOgogICAgICAgICAgICBzZWxmLnVwZGF0ZV9kb2NzKGRhdGEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi51cGRhdGVfbnNpKGRhdGEpCgogICAgZGVmIHVwZGF0ZV9kb2NzKHNlbGYsIGRhdGEpOgogICAgICAgIGRvY19pZHMgPSAnLCcuam9pbihbZicie2l0ZW0uZ2V0KCJpZF9kb2MiKX0iJyBmb3IgaXRlbSBpbiBkYXRhW3NlbGYuZG9jc190YWJsZV9uYW1lXV0pCgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgaWRfZG9jLCB2ZXJpZmllZAogICAgICAgICAgICBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgV0hFUkUgaWRfZG9jIElOICh7ZG9jX2lkc30pCiAgICAgICAgJycnCiAgICAgICAgZG9jcyA9IHtpdGVtWydpZF9kb2MnXTogaXRlbVsndmVyaWZpZWQnXSBvciBGYWxzZSBmb3IgaXRlbSBpbgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0PXF1ZXJ5LCByZXR1cm5fZGljdD1UcnVlKX0KCiAgICAgICAgcXVlcmllcyA9IHNlbGYuanNvbl90b19zcWxpdGVfcXVlcnkoZGF0YSwgZG9jcykKCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJpZXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHJhaXNlIGUKCiAgICAgICAgcmV0dXJuIGRvY3MKCiAgICBkZWYgdXBkYXRlX25zaShzZWxmLCBkYXRhKToKICAgICAgICBxdWVyaWVzID0gc2VsZi5qc29uX3RvX3NxbGl0ZV9xdWVyeShkYXRhKQoKICAgICAgICBmb3IgcXVlcnkgaW4gcXVlcmllczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmFpc2UgZQoKICAgIGRlZiB1cGRhdGVfc2VudF9kYXRhKHNlbGYsIGRhdGEpOgogICAgICAgIGlmIGRhdGE6CiAgICAgICAgICAgIGZvciBkb2MgaW4gZGF0YToKICAgICAgICAgICAgICAgIGlkX2RvYyA9IGRvY1snaWRfZG9jJ10KICAgICAgICAgICAgICAgIGlkX2dvb2RzID0gJywnLmpvaW4oW2YnIntpdGVtLmdldCgiaWRfZ29vZCIpfSInIGZvciBpdGVtIGluIGRvYy5nZXQoJ1JTX2RvY3NfdGFibGUnLCBbXSldKQoKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICAgICAgICAgIFVQREFURSB7c2VsZi5kZXRhaWxzX3RhYmxlX25hbWV9CiAgICAgICAgICAgICAgICAgICAgU0VUIHNlbnQgPSAxCiAgICAgICAgICAgICAgICAgICAgV0hFUkUgaWRfZG9jID0gJ3tpZF9kb2N9JyBBTkQgaWRfZ29vZCBJTiAoe2lkX2dvb2RzfSkKICAgICAgICAgICAgICAgICAgICAnJycKCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgICAgICAgICAgcXVlcnkgPSBmJ1VQREFURSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFNFVCBzZW50PTEgV0hFUkUgaWRfZG9jID0gIntzZWxmLmRvY19pZH0iJwogICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5KQoKICAgIGRlZiBqc29uX3RvX3NxbGl0ZV9xdWVyeShzZWxmLCBkYXRhOiBkaWN0LCBkb2NzPU5vbmUpOgogICAgICAgIGlmIGRvY3MgaXMgTm9uZToKICAgICAgICAgICAgZG9jcyA9IHt9CgogICAgICAgIHFsaXN0ID0gW10KICAgICAgICAjINCm0LjQutC7INC/0L4g0LjQvNC10L3QsNC8INGC0LDQsdC70LjRhgogICAgICAgIHRhYmxlX2xpc3QgPSAoCiAgICAgICAgICAgICdSU19kb2NfdHlwZXMnLCAnUlNfZ29vZHMnLCAnUlNfcHJvcGVydGllcycsICdSU191bml0cycsICdSU190eXBlc19nb29kcycsICdSU19zZXJpZXMnLCAnUlNfY291bnRyYWdlbnRzJywKICAgICAgICAgICAgJ1JTX3dhcmVob3VzZXMnLCAnUlNfcHJpY2VfdHlwZXMnLCAnUlNfY2VsbHMnLCAnUlNfYmFyY29kZXMnLCAnUlNfcHJpY2VzJywgJ1JTX2RvY190eXBlcycsICdSU19kb2NzJywKICAgICAgICAgICAgJ1JTX2RvY3NfdGFibGUnLCAnUlNfZG9jc19iYXJjb2RlcycsICdSU19hZHJfZG9jcycsICdSU19hZHJfZG9jc190YWJsZScpICAjICwsICdSU19iYXJjX2Zsb3cnCiAgICAgICAgdGFibGVfZm9yX2RlbGV0ZSA9ICgnUlNfZG9jc190YWJsZScsICdSU19kb2NzX2JhcmNvZGVzLCBSU19iYXJjX2Zsb3cnLCAnUlNfYWRyX2RvY3NfdGFibGUnKSAgIyAsICdSU19iYXJjX2Zsb3cnCiAgICAgICAgZG9jX2lkX2xpc3QgPSBbXQogICAgICAgIGZvciB0YWJsZV9uYW1lIGluIHRhYmxlX2xpc3Q6CiAgICAgICAgICAgIGlmIG5vdCBkYXRhLmdldCh0YWJsZV9uYW1lKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjINCU0L7QsdCw0LLQuNC8INCyINC30LDQv9GA0L7RgdGLINGD0LTQsNC70LXQvdC40LUg0LjQtyDQsdCw0LfRiyDRgdGC0YDQvtC6INGC0LXRhSDQtNC+0LrRg9C80LXQvdGC0L7Qsiwg0YfRgtC+INC80Ysg0LfQsNCz0YDRg9C20LDQtdC8CiAgICAgICAgICAgIGlmIHRhYmxlX25hbWUgaW4gdGFibGVfZm9yX2RlbGV0ZToKICAgICAgICAgICAgICAgIHF1ZXJ5ID0gZiJERUxFVEUgRlJPTSB7dGFibGVfbmFtZX0gV0hFUkUgaWRfZG9jIGluICh7JywgJy5qb2luKGRvY19pZF9saXN0KX0pICIKICAgICAgICAgICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCiAgICAgICAgICAgIGNvbHVtbl9uYW1lcyA9IGRhdGFbdGFibGVfbmFtZV1bMF0ua2V5cygpCiAgICAgICAgICAgIGlmICdtYXJrX2NvZGUnIGluIGNvbHVtbl9uYW1lczoKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcyA9IGxpc3QoY29sdW1uX25hbWVzKQogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLmFwcGVuZCgnR1RJTicpCiAgICAgICAgICAgICAgICBxdWVyeV9jb2xfbmFtZXMuYXBwZW5kKCdTZXJpZXMnKQogICAgICAgICAgICAgICAgcXVlcnlfY29sX25hbWVzLnJlbW92ZSgnbWFya19jb2RlJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcyA9IGxpc3QoY29sdW1uX25hbWVzKQoKICAgICAgICAgICAgaWYgdGFibGVfbmFtZSBpbiAoJ1JTX2RvY3MnLCAnUlNfYWRyX2RvY3MnKTogICMKICAgICAgICAgICAgICAgIHF1ZXJ5X2NvbF9uYW1lcy5hcHBlbmQoJ3ZlcmlmaWVkJykKCiAgICAgICAgICAgIHF1ZXJ5ID0gZiJSRVBMQUNFIElOVE8ge3RhYmxlX25hbWV9ICh7JywgJy5qb2luKHF1ZXJ5X2NvbF9uYW1lcyl9KSBWQUxVRVMgIgogICAgICAgICAgICB2YWx1ZXMgPSBbXQoKICAgICAgICAgICAgZm9yIHJvdyBpbiBkYXRhW3RhYmxlX25hbWVdOgogICAgICAgICAgICAgICAgcm93X3ZhbHVlcyA9IFtdCiAgICAgICAgICAgICAgICBsaXN0X3F1b3RlZF9maWVsZHMgPSAoJ25hbWUnLCAnZnVsbF9uYW1lJywgIm1hcmtfY29kZSIpCiAgICAgICAgICAgICAgICBmb3IgY29sIGluIHF1ZXJ5X2NvbF9uYW1lczoKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgaW4gbGlzdF9xdW90ZWRfZmllbGRzIGFuZCAiXCIiIGluIHJvd1tjb2xdOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9IHJvd1tjb2xdLnJlcGxhY2UoIlwiIiwgIlwiXCIiKQoKICAgICAgICAgICAgICAgICAgICAjINCX0LTQtdGB0Ywg0YPRgdGC0LDQvdCw0LLQu9C40LLQsNC10Lwg0YTQu9Cw0LMgdmVyaWZpZWQhISEKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgPT0gJ3ZlcmlmaWVkJyBhbmQgKHRhYmxlX25hbWUgaW4gWydSU19kb2NzJywgJ1JTX2Fkcl9kb2NzJ10pOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9IGRvY3MuZ2V0KHJvd1snaWRfZG9jJ10sIDApCgogICAgICAgICAgICAgICAgICAgIGlmIHJvdy5nZXQoY29sKSBpcyBOb25lOgogICAgICAgICAgICAgICAgICAgICAgICByb3dbY29sXSA9ICcnCgogICAgICAgICAgICAgICAgICAgIGlmIGNvbCA9PSAnbWFya19jb2RlJzogICMg0JfQsNC80LXQvdGP0LXQvCDRjdGC0L4g0L/QvtC70LUg0L3QsCDQv9C+0LvRjyBHVElOINC4IFNlcmllcwogICAgICAgICAgICAgICAgICAgICAgICBiYXJjX3N0cnVjdCA9IHNlbGYucGFyc2VfYmFyY29kZShyb3dbY29sXSkKICAgICAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQoYmFyY19zdHJ1Y3RbJ0dUSU4nXSkKICAgICAgICAgICAgICAgICAgICAgICAgcm93X3ZhbHVlcy5hcHBlbmQoYmFyY19zdHJ1Y3RbJ1NlcmllcyddKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHJvd192YWx1ZXMuYXBwZW5kKHJvd1tjb2xdKSAgIyAoZicie3Jvd1tjb2xdfSInKQoKICAgICAgICAgICAgICAgICAgICBpZiBjb2wgPT0gJ2lkX2RvYycgYW5kICh0YWJsZV9uYW1lIGluIFsnUlNfZG9jcycsICdSU19hZHJfZG9jcyddKToKICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2lkX2xpc3QuYXBwZW5kKCciJyArIHJvd1tjb2xdICsgJyInKQoKICAgICAgICAgICAgICAgIGZvcm1hdHRlZF92YWwgPSBbZicie3h9IicgaWYgaXNpbnN0YW5jZSh4LCBzdHIpIGVsc2Ugc3RyKHgpIGZvciB4IGluIHJvd192YWx1ZXNdCiAgICAgICAgICAgICAgICB2YWx1ZXMuYXBwZW5kKGYiKHsnLCAnLmpvaW4oZm9ybWF0dGVkX3ZhbCl9KSIpCiAgICAgICAgICAgIHF1ZXJ5ICs9ICIsICIuam9pbih2YWx1ZXMpCiAgICAgICAgICAgIHFsaXN0LmFwcGVuZChxdWVyeSkKCiAgICAgICAgcmV0dXJuIHFsaXN0CgogICAgZGVmIGdldF9hbGxfYXJ0aWNsZXNfaW5fZG9jdW1lbnQoc2VsZikgLT4gTGlzdFtzdHJdOgogICAgICAgIHF1ZXJ5ID0gKCdTRUxFQ1QgRElTVElOQ1QgUlNfZ29vZHMuYXJ0IGFzIGFydCcKICAgICAgICAgICAgICAgICAnIEZST00gUlNfZG9jc190YWJsZScKICAgICAgICAgICAgICAgICAnIExFRlQgSk9JTiBSU19nb29kcyBPTiBSU19kb2NzX3RhYmxlLmlkX2dvb2QgPSBSU19nb29kcy5pZCcKICAgICAgICAgICAgICAgICAnIFdIRVJFIFJTX2RvY3NfdGFibGUuaWRfZG9jID0gPycpCiAgICAgICAgZ29vZHMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxdWVyeSwgc2VsZi5kb2NfaWQpCiAgICAgICAgcmV0dXJuIFtnb29kWydhcnQnXSBmb3IgZ29vZCBpbiBnb29kc10gaWYgZ29vZHMgaXMgbm90IE5vbmUgZWxzZSBbXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzPU5vbmUsIHJldHVybl9kaWN0PUZhbHNlKToKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBhcmdzPWFyZ3MsIHJldHVybl9kaWN0PXJldHVybl9kaWN0KQoKICAgIGRlZiBzZXRfZG9jX3ZhbHVlKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBTRVQge2tleX0gPSB7dmFsdWV9CiAgICAgICAgICAgIFdIRVJFIGlkX2RvYyA9ICJ7c2VsZi5kb2NfaWR9IgogICAgICAgICAgICAnJycKCiAgICAgICAgc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSkKCiAgICBkZWYgc2V0X2RvY192YWx1ZXMoc2VsZiwgKip2YWx1ZXMpOgogICAgICAgIGlmIG5vdCB2YWx1ZXM6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZXRfZmllbGRzID1bZid7a309e3Z9J2ZvciBrLCB2IGluIHZhbHVlcy5pdGVtcygpXQogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBVUERBVEUge3NlbGYuZG9jc190YWJsZV9uYW1lfQogICAgICAgICAgICBTRVQgeycsJy5qb2luKHNldF9maWVsZHMpfQogICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSAie3NlbGYuZG9jX2lkfSIKICAgICAgICAgICAgJycnCgogICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpCgogICAgZGVmIGdldF9kb2NfdmFsdWUoc2VsZiwga2V5LCBpZF9kb2MpOgogICAgICAgIHF1ZXJ5ID0gZidTRUxFQ1Qge2tleX0gZnJvbSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9ICBXSEVSRSBpZF9kb2MgPSA/JwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIChpZF9kb2MsKSwgVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1ba2V5XQoKICAgIGRlZiBnZXRfZG9jX3R5cGVzKHNlbGYpIC0+IGxpc3Q6CiAgICAgICAgd2hlcmVfZ3JvdXBfc2NhbiA9IGYnaXNfZ3JvdXBfc2NhbiA9ICIwIicgaWYgc2VsZi5pc19ncm91cF9zY2FuIGlzIEZhbHNlIGVsc2UgVHJ1ZQoKICAgICAgICB3aGVyZV9lbXB0eSA9ICgiUlNfZG9jcy5pZF9kb2Mgbm90IGluICIKICAgICAgICAgICAgICAgICAgICAgICAiKFNFTEVDVCBkaXN0aW5jdCBpZF9kb2MgRnJvbSBSU19kb2NzX3RhYmxlKSIpCiAgICAgICAgd2hlcmVfYmFyY19mbG93ID0gZicoaXNfYmFyY19mbG93ID0gIjEiIE9SIHt3aGVyZV9lbXB0eX0pJyBcCiAgICAgICAgICAgIGlmIHNlbGYuaXNfYmFyY19mbG93IGVsc2UgZidpc19iYXJjX2Zsb3cgPSAiMCInCgogICAgICAgIHdoZXJlID0gZiJ7d2hlcmVfZ3JvdXBfc2Nhbn0gQU5EIHt3aGVyZV9iYXJjX2Zsb3d9IgoKICAgICAgICBxdWVyeV90ZXh0ID0gZidTRUxFQ1QgRElTVElOQ1QgZG9jX3R5cGUgZnJvbSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9JwogICAgICAgIHF1ZXJ5ID0gZiJ7cXVlcnlfdGV4dH0gV0hFUkUge3doZXJlfSIKCiAgICAgICAgZG9jX3R5cGVzID0gW3JlY1swXSBmb3IgcmVjIGluIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnkpXQogICAgICAgIHJldHVybiBkb2NfdHlwZXMKCiAgICBkZWYgZ2V0X2RvY192aWV3X2RhdGEoc2VsZiwgZG9jX3R5cGU9JycsIGRvY19zdGF0dXM9JycpIC0+IGxpc3Q6CiAgICAgICAgZmllbGRzID0gWwogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfZG9jJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY190eXBlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19uJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmRvY19kYXRlJywKICAgICAgICAgICAgZid7c2VsZi5kb2NzX3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZScsCiAgICAgICAgICAgIGYnaWZudWxsKFJTX3dhcmVob3VzZXMubmFtZSwiIikgYXMgUlNfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCIiKSBhcyB3YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnZlcmlmaWVkLCAwKSBhcyB2ZXJpZmllZCcsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uc2VudCwgMCkgYXMgc2VudCcsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5hZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgIF0KCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMnKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfZ3JvdXBfc2NhbiwgMCkgYXMgaXNfZ3JvdXBfc2NhbicpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoUlNfY291bnRyYWdlbnRzLmZ1bGxfbmFtZSwgIiIpIGFzIFJTX2NvdW50cmFnZW50JykKCiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgJyArICcsXG4nLmpvaW4oZmllbGRzKQoKICAgICAgICBqb2lucyA9IGYnJydGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgUlNfd2FyZWhvdXNlcwogICAgICAgICAgICAgICAgT04gUlNfd2FyZWhvdXNlcy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlCiAgICAgICAgJycnCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgam9pbnMgKz0gZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY291bnRyYWdlbnRzIGFzIFJTX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgICcnJwogICAgICAgIHdoZXJlID0gJycKCiAgICAgICAgaWYgZG9jX3N0YXR1czoKICAgICAgICAgICAgaWYgZG9jX3N0YXR1cyA9PSAi0JLRi9Cz0YDRg9C20LXQvSI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBzZW50PTEgQU5EIHZlcmlmaWVkPTEiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9Cz0YDRg9C30LrQtSI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBpZm51bGwodmVyaWZpZWQsMCk9MSBBTkQgaWZudWxsKHNlbnQsMCk9MCIKICAgICAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0L/QvtC70L3QtdC90LjRjiI6CiAgICAgICAgICAgICAgICB3aGVyZSA9ICJXSEVSRSBpZm51bGwodmVyaWZpZWQsMCk9MCBBTkQgaWZudWxsKHNlbnQsMCk9MCIKCiAgICAgICAgaWYgbm90IGRvY190eXBlIG9yIGRvY190eXBlID09ICLQktGB0LUiOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3NfdHVwbGUgPSAoZG9jX3R5cGUsKQogICAgICAgICAgICBpZiBub3QgZG9jX3N0YXR1cyBvciBkb2Nfc3RhdHVzID09ICLQktGB0LUiOgogICAgICAgICAgICAgICAgd2hlcmUgPSAnV0hFUkUgZG9jX3R5cGU9PycKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHdoZXJlICs9ICcgQU5EIGRvY190eXBlPT8nCgogICAgICAgIGlmIHNlbGYuaXNfZ3JvdXBfc2NhbiBpcyBGYWxzZSBhbmQgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgICAgIHdoZXJlICs9IGYnIEFORCBpc19ncm91cF9zY2FuPXtpbnQoc2VsZi5pc19ncm91cF9zY2FuKX0nCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB3aGVyZSA9IGYnIFdIRVJFIGlzX2dyb3VwX3NjYW49e2ludChzZWxmLmlzX2dyb3VwX3NjYW4pfScKICAgICAgICAKICAgICAgICBpZiBzZWxmLmlzX2JhcmNfZmxvdyBpcyBGYWxzZSBhbmQgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgICAgIHdoZXJlICs9IGYnIEFORCBpc19iYXJjX2Zsb3c9e2ludChzZWxmLmlzX2JhcmNfZmxvdyl9JwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgd2hlcmUgPSBmJyBXSEVSRSBpc19iYXJjX2Zsb3c9e2ludChzZWxmLmlzX2JhcmNfZmxvdyl9JwogICAgICAgIAogICAgICAgIHF1ZXJ5X3RleHQgPSBmJycnCiAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICB7am9pbnN9CiAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgT1JERVIgQlkge3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfZGF0ZQogICAgICAgICcnJwogICAgICAgIHJlc3VsdCA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc190dXBsZSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGRlbGV0ZV9kb2Moc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeWVzID0gKAogICAgICAgICdERUxFVEUgRlJPTSBSU19iYXJjX2Zsb3cgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgJ0RFTEVURSBGUk9NIFJTX2RvY3Nfc2VyaWVzIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgICdERUxFVEUgRlJPTSBSU19kb2NzX2JhcmNvZGVzIFdIRVJFIGlkX2RvYyA9ID8nLAogICAgICAgIGYnREVMRVRFIEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICApCiAgICAgICAgZm9yIHF1ZXJ5IGluIHF1ZXJ5ZXM6CiAgICAgICAgICAgIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIChpZF9kb2MsKSkKCiAgICBkZWYgZGVsZXRlX2Fkcl9kb2Moc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeWVzID0gKAogICAgICAgICdERUxFVEUgRlJPTSBSU19hZHJfZG9jc190YWJsZSBXSEVSRSBpZF9kb2MgPSA/JywKICAgICAgICAnREVMRVRFIEZST00gUlNfYWRyX2RvY3MgV0hFUkUgaWRfZG9jID0gPycsCiAgICAgICAgKQogICAgICAgIGZvciBxdWVyeSBpbiBxdWVyeWVzOgogICAgICAgICAgICBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCAoaWRfZG9jLCkpCgogICAgZGVmIGRlbGV0ZV9vbGRfZG9jcyhzZWxmLCBkYXlzOiBpbnQpIC0+IGxpc3Q6CiAgICAgICAgb2xkX2RvY3NfaWRzID0gc2VsZi5fZmluZF9vbGRfZG9jcyhkYXlzKQogICAgICAgIG9sZF9hZHJfZG9jc19pZHMgPSBzZWxmLl9maW5kX29sZF9kb2NzKGRheXMsICdSU19hZHJfZG9jcycpCiAgICAgICAgZm9yIGlkX2RvYyBpbiBvbGRfZG9jc19pZHM6CiAgICAgICAgICAgIHNlbGYuZGVsZXRlX2RvYyhpZF9kb2MpCiAgICAgICAgZm9yIGlkX2RvYyBpbiBvbGRfYWRyX2RvY3NfaWRzOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV9hZHJfZG9jKGlkX2RvYykKICAgICAgICByZXR1cm4gb2xkX2RvY3NfaWRzICsgb2xkX2Fkcl9kb2NzX2lkcwoKICAgIGRlZiBfZmluZF9vbGRfZG9jcygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgZGF5czogaW50LAogICAgICAgICAgICB0YWJsZTogTGl0ZXJhbFsnUlNfZG9jcycsICdSU19hZHJfZG9jcyddID0gJ1JTX2RvY3MnCiAgICApIC0+IExpc3Rbc3RyXToKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdC/0LjRgdC+0LogaWQg0LLRgdC10YUg0YPRgdGC0LDRgNC10LLRiNC40YUg0LTQvtC60YPQvNC10L3RgtC+0LIiIiIKICAgICAgICBxdWVyeSA9IGYnJydTRUxFQ1QgaWRfZG9jIEZST00ge3RhYmxlfSBXSEVSRSBjcmVhdGVkX2F0IDwgPycnJwogICAgICAgIGN1cnJlbnRfZGF0ZXRpbWUgPSBkYXRldGltZS5ub3codHo9dGltZXpvbmUudXRjKQogICAgICAgIHRhcmdldF90aW1lID0gY3VycmVudF9kYXRldGltZSAtIHRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAgICAgZG9jcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksICh0YXJnZXRfdGltZSwgKSkKICAgICAgICByZXR1cm4gW2RvY1swXSBmb3IgZG9jIGluIGRvY3NdCgogICAgZGVmIGdldF9kb2NzX3N0YXQoc2VsZik6CiAgICAgICAgd2hlcmVfZ3JvdXBfc2NhbiA9IGYnaXNfZ3JvdXBfc2NhbiA9ICIwIicgaWYgc2VsZi5pc19ncm91cF9zY2FuIGlzIEZhbHNlIGVsc2UgVHJ1ZQogICAgICAgIHdoZXJlX2JhcmNfZmxvdyA9IGYnaXNfYmFyY19mbG93ID0gIjAiJyBpZiBzZWxmLmlzX2JhcmNfZmxvdyBpcyBGYWxzZSBlbHNlIFRydWUKICAgICAgICB3aGVyZSA9IGYie3doZXJlX2dyb3VwX3NjYW59IEFORCB7d2hlcmVfYmFyY19mbG93fSIKCiAgICAgICAgcXVlcnlfc2VsZWN0ID0gZicnJwogICAgICAgIFdJVEggdG1wIEFTICgKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICBkb2NzX3RhYmxlLmlkX2RvYywKICAgICAgICAgICAgICAgIDEgYXMgZG9jX0NvdW50LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUuc2VudCwwKSBhcyBzZW50LAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUudmVyaWZpZWQsMCkgYXMgdmVyaWZpZWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoZG9jc190YWJsZS5pc19ncm91cF9zY2FuLCAwKSBhcyBpc19ncm91cF9zY2FuLAogICAgICAgICAgICAgICAgSUZOVUxMKGRvY3NfdGFibGUuaXNfYmFyY19mbG93LCAwKSBhcyBpc19iYXJjX2Zsb3csCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTAgVEhFTiAKICAgICAgICAgICAgICAgICAgICBDT1VOVChkb2NzX2RldGFpbHMuaWQpCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgY291bnRfdmVyaWZpZWQsCiAgICAgICAgICAgICAgICBDQVNFIFdIRU4gSUZOVUxMKHZlcmlmaWVkLDApPTEgVEhFTiAKICAgICAgICAgICAgICAgICAgICBjb3VudChkb2NzX2RldGFpbHMuaWQpCiAgICAgICAgICAgICAgICBFTFNFIAogICAgICAgICAgICAgICAgICAgIDAgCiAgICAgICAgICAgICAgICBFTkQgYXMgY291bnRfdW52ZXJpZmllZCwKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MCBUSEVOCiAgICAgICAgICAgICAgICAgICAgIFNVTShkb2NzX2RldGFpbHMucXR0eV9wbGFuKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIHF0dHlfcGxhbl92ZXJpZmllZCwKICAgICAgICAgICAgICAgIENBU0UgV0hFTiBJRk5VTEwodmVyaWZpZWQsMCk9MSBUSEVOIAogICAgICAgICAgICAgICAgICAgIFNVTShkb2NzX2RldGFpbHMucXR0eV9wbGFuKQogICAgICAgICAgICAgICAgRUxTRSAKICAgICAgICAgICAgICAgICAgICAwIAogICAgICAgICAgICAgICAgRU5EIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICAgICAgICAgIEZST00gUlNfZG9jcyBBUyBkb2NzX3RhYmxlCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19kb2NzX3RhYmxlIEFTIGRvY3NfZGV0YWlscwogICAgICAgICAgICAgICAgT04gZG9jc19kZXRhaWxzLmlkX2RvYyA9IGRvY3NfdGFibGUuaWRfZG9jCiAgICAgICAgICAgIEdST1VQIEJZIGRvY3NfdGFibGUuaWRfZG9jCiAgICAgICAgKQogICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgZG9jX3R5cGUgYXMgZG9jVHlwZSwgCiAgICAgICAgICAgIENPVU5UKGlkX2RvYyksCiAgICAgICAgICAgIFNVTShkb2NfQ291bnQpIGFzIGNvdW50LCAKICAgICAgICAgICAgU1VNKHNlbnQpIGFzIHNlbnQsIAogICAgICAgICAgICBTVU0odmVyaWZpZWQpIGFzIHZlcmlmaWVkLAogICAgICAgICAgICBTVU0oY291bnRfdmVyaWZpZWQpIGFzIGNvdW50X3ZlcmlmaWVkLAogICAgICAgICAgICBTVU0oY291bnRfdW52ZXJpZmllZCkgYXMgY291bnRfdW52ZXJpZmllZCwKICAgICAgICAgICAgU1VNKHF0dHlfcGxhbl92ZXJpZmllZCkgYXMgcXR0eV9wbGFuX3ZlcmlmaWVkLAogICAgICAgICAgICBTVU0ocXR0eV9wbGFuX3VudmVyaWZpZWQpIGFzIHF0dHlfcGxhbl91bnZlcmlmaWVkCiAgICAgICAgRlJPTSB0bXAKICAgICAgICBXSEVSRSB7d2hlcmV9CiAgICAgICAgR1JPVVAgQlkgZG9jX3R5cGUKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3NlbGVjdCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGdldF9kb2NfZmxvd19zdGF0KHNlbGYpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgIFdJVEggdG1wIEFTICgKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICBSU19kb2NzLmlkX2RvYywKICAgICAgICAgICAgICAgIDEgYXMgZG9jX0NvdW50LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3Muc2VudCwwKSBhcyBzZW50LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MudmVyaWZpZWQsMCkgYXMgdmVyaWZpZWQsCgogICAgICAgICAgICAgICAgY291bnQoUlNfYmFyY19mbG93LmJhcmNvZGUpIGFzIGJhcmNfY291bnQKCiAgICAgICAgICAgIEZST00gUlNfZG9jcwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2JhcmNfZmxvdyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3MuaWRfZG9jID0gUlNfYmFyY19mbG93LmlkX2RvYwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgV0hFUkUgIFJTX2RvY3MuaWRfZG9jIG5vdCBpbiAoU0VMRUNUIGRpc3RpbmN0CiAgICAgICAgICAgICAgICBpZF9kb2MKICAgICAgICAgICAgICAgIEZyb20gCiAgICAgICAgICAgICAgICBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgQU5EIGlzX2dyb3VwX3NjYW4gPSAwCiAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgCiAgICAgICAgICAgR1JPVVAgQlkgUlNfZG9jcy5pZF9kb2MKICAgICAgICApCiAgICAgICAgU0VMRUNUIAogICAgICAgICAgICBkb2NfdHlwZSBhcyBkb2NUeXBlLCAKICAgICAgICAgICAgQ09VTlQoaWRfZG9jKSBhcyBpZF9jb3VudCwKICAgICAgICAgICAgU1VNKGRvY19Db3VudCkgYXMgY291bnQsIAogICAgICAgICAgICBTVU0oc2VudCkgYXMgc2VudCwgCiAgICAgICAgICAgIFNVTSh2ZXJpZmllZCkgYXMgdmVyaWZpZWQsCiAgICAgICAgICAgIFNVTShiYXJjX2NvdW50KSBhcyBiYXJjX2NvdW50CiAgICAgICAgRlJPTSB0bXAKICAgICAgICBHUk9VUCBCWSBkb2NfdHlwZQogICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jX2RldGFpbHNfZGF0YSgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgaWRfZG9jOiBzdHIsCiAgICAgICAgICAgIGZpcnN0X2VsZW06IGludCwKICAgICAgICAgICAgaXRlbXNfb25fcGFnZTogaW50LAogICAgICAgICAgICBhcnRpY2xlc19saXN0OiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM6IE9wdGlvbmFsW3N0cl0gPSBOb25lLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nOiBPcHRpb25hbFtzdHJdID0gTm9uZQogICAgKSAtPiBsaXN0OgogICAgICAgIHNlbGVjdF9xdWVyeSA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZG9jLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgZ29vZF9uYW1lLAogICAgICAgICAgICBSU19nb29kcy5jb2RlLAogICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9zZXJpZXMsCiAgICAgICAgICAgIFJTX3Nlcmllcy5uYW1lIGFzIHNlcmllc19uYW1lLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgICAgIFJTX3VuaXRzLm5hbWUgYXMgdW5pdHNfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5kX3F0dHksCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucHJpY2UsCiAgICAgICAgICAgIFJTX3ByaWNlX3R5cGVzLm5hbWUgYXMgcHJpY2VfbmFtZSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4gLVJTX2RvY3NfdGFibGUucXR0eSBhcyBJc0RvbmUsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUubGFzdF91cGRhdGVkLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLnVzZV9zZXJpZXMKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZG9jc190YWJsZSAKCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcyAKICAgICAgICAgICAgT04gUlNfZ29vZHMuaWQ9UlNfZG9jc190YWJsZS5pZF9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgIE9OIFJTX3Byb3BlcnRpZXMuaWQgPVJTX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfc2VyaWVzCiAgICAgICAgICAgIE9OIFJTX3Nlcmllcy5pZCA9UlNfZG9jc190YWJsZS5pZF9zZXJpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkID0gUlNfZG9jc190YWJsZS5pZF91bml0CiAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcmljZV90eXBlcwogICAgICAgICAgICBPTiBSU19wcmljZV90eXBlcy5pZCA9UlNfZG9jc190YWJsZS5pZF9wcmljZQogICAgICAgICAgICAiIiIKCiAgICAgICAgd2hlcmUgPSBmIiIiV0hFUkUgaWRfZG9jID0gJ3tzdHIoaWRfZG9jKX0nIiIiCiAgICAgICAgcm93X2ZpbHRlcnNfY29uZGl0aW9uID0gIiIiQU5EIHF0dHkgIT0gQ09BTEVTQ0UocXR0eV9wbGFuLCAnMCcpICIiIiBpZiByb3dfZmlsdGVycyBlbHNlICcnCiAgICAgICAgc2VhcmNoX3N0cmluZ19jb25kaXRpb24gPSBmIiIiQU5EIGdvb2RfbmFtZSBMSUtFICcle3NlYXJjaF9zdHJpbmd9JSciIiIgaWYgc2VhcmNoX3N0cmluZyBlbHNlICcnCgogICAgICAgIHdoZXJlX3F1ZXJ5ID0gZiIiIgogICAgICAgIHt3aGVyZX0KICAgICAgICB7cm93X2ZpbHRlcnNfY29uZGl0aW9ufQogICAgICAgIHtzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbn0KICAgICAgICAiIiIKICAgICAgICBhcmdzID0gKCkKICAgICAgICBpZiBhcnRpY2xlc19saXN0OgogICAgICAgICAgICB3aGVyZV9xdWVyeSArPSBmIiIiQU5EIGFydCBJTiAoeycsJy5qb2luKCc/JyBmb3IgXyBpbiBhcnRpY2xlc19saXN0KX0pIiIiCiAgICAgICAgICAgIGFyZ3MgKz0gdHVwbGUoYXJ0aWNsZXNfbGlzdCkKICAgICAgICBvcmRlcl9ieSA9ICIiIk9SREVSIEJZIGxhc3RfdXBkYXRlZCBERVNDIiIiCiAgICAgICAgbGltaXQgPSBmJ0xJTUlUIHtpdGVtc19vbl9wYWdlfSBPRkZTRVQge2ZpcnN0X2VsZW19JwogICAgICAgIHF1ZXJ5ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfcXVlcnl9IHtvcmRlcl9ieX0ge2xpbWl0fSIKCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeSwgYXJncywgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICAjIHJlcyA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeSwgJycpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jX2RldGFpbHNfcm93c19jb3VudChzZWxmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnRpY2xlc19saXN0OiBPcHRpb25hbFtMaXN0W3N0cl1dID0gTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dfZmlsdGVyczogT3B0aW9uYWxbc3RyXSA9IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoX3N0cmluZzogT3B0aW9uYWxbc3RyXSA9IE5vbmUKKToKICAgICAgICBzZWxlY3RfcXVlcnkgPSBmIiIiU0VMRUNUIENPVU5UKCopIGFzIHJvd3NfcXR0eSBGUk9NIHtzZWxmLmRldGFpbHNfdGFibGVfbmFtZX0gQVMgZG9jc190YWJsZQogICAgICAgICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgT04gZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQiIiIKICAgICAgICB3aGVyZSA9IGYiIiJXSEVSRSBpZF9kb2MgPSAne3N0cihpZF9kb2MpfSciIiIKICAgICAgICByb3dfZmlsdGVyc19jb25kaXRpb24gPSAiIiJBTkQgcXR0eSAhPSBDT0FMRVNDRShxdHR5X3BsYW4sICcwJykgIiIiIGlmIHJvd19maWx0ZXJzIGVsc2UgJycKICAgICAgICBzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbiA9IGYiIiJBTkQgbmFtZSBMSUtFICcle3NlYXJjaF9zdHJpbmd9JSciIiIgaWYgc2VhcmNoX3N0cmluZyBlbHNlICcnCgogICAgICAgIHdoZXJlX3F1ZXJ5ID0gZiIiIgogICAgICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICAgICAge3Jvd19maWx0ZXJzX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgIHtzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgICIiIgogICAgICAgIGFyZ3MgPSAoKQogICAgICAgIGlmIGFydGljbGVzX2xpc3Q6CiAgICAgICAgICAgIHdoZXJlX3F1ZXJ5ICs9IGYiIiJBTkQgYXJ0IElOICh7JywnLmpvaW4oJz8nIGZvciBfIGluIGFydGljbGVzX2xpc3QpfSkiIiIKICAgICAgICAgICAgYXJncyArPSB0dXBsZShhcnRpY2xlc19saXN0KQogICAgICAgIHF1ZXJ5ID0gZiJ7c2VsZWN0X3F1ZXJ5fSB7d2hlcmVfcXVlcnl9IgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIGFyZ3MsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlc1swXVsncm93c19xdHR5J10KCgogICAgZGVmIHBhcnNlX2JhcmNvZGUoc2VsZiwgdmFsKToKICAgICAgICBpZiBsZW4odmFsKSA8IDIxOgogICAgICAgICAgICByZXR1cm4geydHVElOJzogJycsICdTZXJpZXMnOiAnJ30KCiAgICAgICAgdmFsLnJlcGxhY2UoJygwMSknLCAnMDEnKQogICAgICAgIHZhbC5yZXBsYWNlKCcoMjEpJywgJzIxJykKCiAgICAgICAgaWYgdmFsWzoyXSA9PSAnMDEnOgogICAgICAgICAgICBHVElOID0gdmFsWzI6MTZdCiAgICAgICAgICAgIFNlcmllcyA9IHZhbFsxODpdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgR1RJTiA9IHZhbFs6MTRdCiAgICAgICAgICAgIFNlcmllcyA9IHZhbFsxNDpdCgogICAgICAgIHJldHVybiB7J0dUSU4nOiBHVElOLCAnU2VyaWVzJzogU2VyaWVzfQoKICAgIGRlZiBjbGVhcl9iYXJjb2RlX2RhdGEoc2VsZiwgaWRfZG9jKToKICAgICAgICBxdWVyeV90ZXh0ID0gKCdVcGRhdGUgUlNfZG9jc19iYXJjb2RlcyBTZXQgYXBwcm92ZWQgPSAwIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX2JhcmNvZGVzIFdoZXJlICBpZF9kb2M9OmlkX2RvYyBBbmQgaXNfcGxhbiA9IDAnLAogICAgICAgICAgICAgICAgICAgICAgJ1VwZGF0ZSBSU19kb2NzX3RhYmxlIFNldCBxdHR5ID0gMCBXaGVyZSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICAgICAgICAgICAnVXBkYXRlIFJTX2RvY3NfdGFibGUgU2V0IGRfcXR0eSA9IDAgV2hlcmUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAgICAgICAgICAgJ1VwZGF0ZSBSU19kb2NzIFNldCBpc19ncm91cF9zY2FuID0gIjAiIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdVcGRhdGUgUlNfZG9jcyBTZXQgaXNfYmFyY19mbG93ID0gIjAiIFdoZXJlIGlkX2RvYz06aWRfZG9jJywKICAgICAgICAgICAgICAgICAgICAgICdEZWxldGUgRnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYz06aWRfZG9jIGFuZCBpc19wbGFuID0gIkZhbHNlIicsCiAgICAgICAgICAgICAgICAgICAgICAnRGVsZXRlIEZyb20gUlNfYmFyY19mbG93IFdoZXJlIGlkX2RvYyA9IDppZF9kb2MnKQogICAgICAgIHRyeToKICAgICAgICAgICAgZm9yIGVsIGluIHF1ZXJ5X3RleHQ6CiAgICAgICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsLCAoeydpZF9kb2MnOiBpZF9kb2N9KSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IEZhbHNlLCAnZXJyb3InOiBlLmFyZ3NbMF19CgogICAgICAgIHJldHVybiB7J3Jlc3VsdCc6IFRydWUsICdlcnJvcic6ICcnfQoKICAgIGRlZiBnZXRfbWFya3NfZGF0YShzZWxmLCBpZF9kb2MsIGRvY19yb3dfaWQpOgogICAgICAgIHF1ZXJ5ID0gZicnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBiLm1hcmtfY29kZSwKICAgICAgICAgICAgICAgIGIuYXBwcm92ZWQgCiAgICAgICAgICAgIEZST00gUlNfZG9jc19iYXJjb2RlcyBBUyBiCiAgICAgICAgICAgIEpPSU4gUlNfZG9jc190YWJsZSBhcyB0CiAgICAgICAgICAgICAgICBPTiBiLmlkX2RvYz10LmlkX2RvYyBBTkQKICAgICAgICAgICAgICAgICAgICBiLmlkX2dvb2QgPSB0LmlkX2dvb2QgQU5ECiAgICAgICAgICAgICAgICAgICAgYi5pZF9wcm9wZXJ0eSA9IHQuaWRfcHJvcGVydGllcyBBTkQKICAgICAgICAgICAgICAgICAgICBiLmlkX3NlcmllcyA9IHQuaWRfc2VyaWVzIEFORAogICAgICAgICAgICAgICAgICAgIHQuaWQgPSAie2RvY19yb3dfaWR9IgogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgYi5pZF9kb2MgPSAie2lkX2RvY30iCiAgICAgICAgJycnCgogICAgICAgIHJlcyA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnksIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgcmV0dXJuIHJlcwoKICAgIGRlZiBnZXRfZG9jc19jb3VudChzZWxmLCBkb2NfdHlwZT0nJyk6CiAgICAgICAgcXVlcnkgPSBmJ1NFTEVDVCBDT1VOVCgqKSBBUyBkb2NzX2NvdW50IEZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfScKICAgICAgICBhcmdzID0gTm9uZQoKICAgICAgICBpZiBkb2NfdHlwZToKICAgICAgICAgICAgcXVlcnkgPSAnXG4nLmpvaW4oW3F1ZXJ5LCAnV0hFUkUgZG9jX3R5cGUgPSA/J10pCiAgICAgICAgICAgIGFyZ3MgPSAoZG9jX3R5cGUsKQoKICAgICAgICByZXMgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5LCBhcmdzLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXS5nZXQoJ2RvY3NfY291bnQnLCAwKQogICAgICAgIHJldHVybiAwCgogICAgZGVmIGdldF9leGlzdGluZ19kb2NzKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIlNFTEVDVCBkb2Nfbixkb2NfdHlwZSBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0iCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0KQogICAgICAgIHJldHVybiByZXMKCiAgICBkZWYgd3JpdGVfZXJyb3Jfb25fbG9nKHNlbGYsIGVycm9yX3RleHQsICoqa3dhcmdzKToKICAgICAgICBzZWxmLmxvZ2dlcl9zZXJ2aWNlLndyaXRlX3RvX2xvZyhlcnJvcl90ZXh0LCAqKmt3YXJncykKCiAgICBkZWYgZ2V0X2RvY3NfYW5kX2dvb2RzX2Zvcl91cGxvYWQoc2VsZik6CgogICAgICAgIHF1ZXJ5X2RvY3MgPSBmJycnU0VMRUNUICogRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IFdIRVJFIHZlcmlmaWVkID0gMSAgYW5kIChzZW50IDw+IDEgb3Igc2VudCBpcyBudWxsKScnJwogICAgICAgIHF1ZXJ5X2dvb2RzID0gZicnJ1NFTEVDVCAqIEZST00ge3NlbGYuZGV0YWlsc190YWJsZV9uYW1lfSBXSEVSRSAoc2VudCA9IDAgT1Igc2VudCBpcyBOdWxsKScnJwogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzX2RvY3MgPSBnZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X2RvY3MsIE5vbmUsIFRydWUpCiAgICAgICAgICAgIHJlc19nb29kcyA9IGdldF9xdWVyeV9yZXN1bHQocXVlcnlfZ29vZHMsIE5vbmUsIFRydWUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgaWYgbm90IHJlc19nb29kczoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICByZXR1cm4gc2VsZi5mb3JtX2RhdGFfZm9yX3JlcXVlc3QocmVzX2RvY3MsIHJlc19nb29kcywgRmFsc2UpCgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmQoc2VsZiwgaWRfZG9jPScnKToKICAgICAgICBkYXRhID0gW10KCiAgICAgICAgZG9jX2lkX2NvbmRpdGlvbiA9IGYnaWRfZG9jPSJ7aWRfZG9jfSInIGlmIGlkX2RvYyBlbHNlICd2ZXJpZmllZCA9IDEgQU5EIElGTlVMTChzZW50LCAwKSA9IDAnCgogICAgICAgIHEgPSBmJycnU0VMRUNUIGlkX2RvYwogICAgICAgICAgICAgICAgRlJPTSB7c2VsZi5kb2NzX3RhYmxlX25hbWV9IAogICAgICAgICAgICAgICAgV0hFUkUge2RvY19pZF9jb25kaXRpb259CiAgICAgICAgICAgICcnJwogICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEpCgogICAgICAgIGZvciByb3cgaW4gcmVzOgogICAgICAgICAgICBpZF9kb2MgPSByb3dbJ2lkX2RvYyddCgogICAgICAgICAgICBkb2NfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdpZF9kb2MnOiBpZF9kb2MsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2lkX2dvb2QnLCAnaWRfcHJvcGVydGllcycsICdpZF9zZXJpZXMnLCAnaWRfdW5pdCcsICdxdHR5JywgJ3F0dHlfcGxhbiddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCAoc2VudCA9IDAgT1Igc2VudCBJUyBOVUxMKQogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBnb29kcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3NfdGFibGUnXSA9IGdvb2RzCgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3Byb3BlcnR5JywgJ2lkX3NlcmllcycsICdiYXJjb2RlX2Zyb21fc2Nhbm5lcicsICdHVElOJywgJ1NlcmllcyddCiAgICAgICAgICAgIHEgPSAnJycKICAgICAgICAgICAgICAgIFNFTEVDVCB7fQogICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX2JhcmNvZGVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCBJRk5VTEwoYmFyY29kZV9mcm9tX3NjYW5uZXIsICcnKSA8PiAnJwogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCgogICAgICAgICAgICBkb2NfYmFyY29kZXMgPSBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBpZF9kb2MpCiAgICAgICAgICAgIGRvY19kYXRhWydSU19kb2NzX2JhcmNvZGVzJ10gPSBkb2NfYmFyY29kZXMKCiAgICAgICAgICAgIGZpZWxkcyA9IFsnaWRfZG9jJywgJ2JhcmNvZGUnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfYmFyY19mbG93CiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIGJhcmNfZmxvdyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2JhcmNfZmxvdyddID0gYmFyY19mbG93CgogICAgICAgICAgICBmaWVsZHMgPSBbJ2lkX2RvYycsICdpZF9nb29kJywgJ2lkX3NlcmllcycsICdpZF93YXJlaG91c2UnLCAncXR0eScsICduYW1lJywgJ2Jlc3RfYmVmb3JlJywgJ251bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIHNlcmllc190YWJsZSA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3Nfc2VyaWVzJ10gPSBzZXJpZXNfdGFibGUKICAgICAgICAgICAgZGF0YS5hcHBlbmQoZG9jX2RhdGEpCgogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIGdldF9kYXRhX3RvX3NlbmRfYnlfZG9jX2lkKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X2RhdGFfdG9fc2VuZChpZF9kb2M9aWRfZG9jKQoKICAgIGRlZiBnZXRfY291bnRfbWFya19jb2RlcyhzZWxmLCBpZF9kb2MpOgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIERJU1RJTkNUIENPVU5UKGlkKSBhcyBjb2xfc3RyIAogICAgICAgICAgICBGUk9NIFJTX2RvY3NfYmFyY29kZXMgV0hFUkUgaWRfZG9jID0gPyBBTkQgaXNfcGxhbiA9IDEKICAgICAgICAnJycKICAgICAgICByZXMgPSBzZWxmLl9zcWxfcXVlcnkoCiAgICAgICAgICAgIHE9cSwKICAgICAgICAgICAgcGFyYW1zPWlkX2RvYywKICAgICAgICApCgogICAgICAgIHJldHVybiByZXNbMF1bJ2NvbF9zdHInXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB1cGRhdGVfdXBsb2FkZWRfZG9jc19zdGF0dXMoZG9jX2luX3N0cik6CiAgICAgICAgcXRleHQgPSBmJ1VQREFURSBSU19kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2Fkcl9kb2NzIFNFVCBzZW50ID0gMSAgV0hFUkUgaWRfZG9jIGluICh7ZG9jX2luX3N0cn0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3NfdGFibGUgU0VUIHNlbnQgPSAxICBXSEVSRSBpZF9kb2MgaW4gKHtkb2NfaW5fc3RyfSkgJwogICAgICAgIGdldF9xdWVyeV9yZXN1bHQocXRleHQpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHVwZGF0ZV9yc19kb2NzX3RhYmxlX3NlbnRfc3RhdHVzKHRhYmxlX3N0cmluZ19pZDogc3RyKToKICAgICAgICBxdGV4dCA9IGYnVVBEQVRFIFJTX2RvY3NfdGFibGUgU0VUIHNlbnQgPSAwICBXSEVSRSBpZCBpbiAoe3RhYmxlX3N0cmluZ19pZH0pICcKICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KHF0ZXh0KQoKICAgIGRlZiBzZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZiwgZG9jX2lkKToKICAgICAgICBxdGV4dCA9IGYiVVBEQVRFIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gU0VUIHNlbnQgPSAwLCB2ZXJpZmllZCA9IDAgIFdIRVJFIGlkX2RvYyA9ICd7ZG9jX2lkfSciCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxdGV4dCkKCiAgICBkZWYgdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgcm93X2lkLCBkYXRhKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSBzZWxmLmRldGFpbHNfdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIudXBkYXRlKGRhdGE9ZGF0YSwgX2ZpbHRlcj17J2lkJzogcm93X2lkfSkKCiAgICBkZWYgX3NxbF9leGVjKHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIGlmIGlzaW5zdGFuY2UocGFyYW1zLCBzdHIpOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjKHEsIHBhcmFtcykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnByb3ZpZGVyLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfc3FsX3F1ZXJ5KHNlbGYsIHEsIHBhcmFtcywgdGFibGVfbmFtZT0nJyk6CiAgICAgICAgaWYgdGFibGVfbmFtZToKICAgICAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnNxbF9xdWVyeShxLCBwYXJhbXMpCiAgICAKICAgIGRlZiBnZXRfZG9jX3Jvd3NfY291bnQoc2VsZiwgaWRfZG9jKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9ICAKICAgICAgICAKICAgICAgICBpZiBpZF9kb2M6ICAKICAgICAgICAgICAgcSA9ICdTRUxFQ1QgY291bnQoaWRfZG9jKSBhcyBkb2Nfcm93cyBGUk9NIFJTX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jPT8nCiAgICAgICAgICAgIHJlcyA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIHN0cihpZF9kb2MpKSAgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXMgYW5kICdkb2Nfcm93cycgaW4gcmVzWzBdOiAKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHsnZG9jX3Jvd3MnOiByZXNbMF1bJ2RvY19yb3dzJ119CiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0ICAKCiAgICBkZWYgZ2V0X2JhcmNvZGUoc2VsZiwgYmFyY29kZSkgLT4gZGljdDoKICAgICAgICByZXN1bHQgPSB7fSAgCgogICAgICAgIGlmIGJhcmNvZGU6ICAKICAgICAgICAgICAgcSA9ICdTRUxFQ1QgKiBGUk9NIFJTX2JhcmNvZGVzIFdIRVJFIGJhcmNvZGU9PycKICAgICAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgc3RyKGJhcmNvZGUpKSAKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlczogIAogICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzWzBdIGlmIHJlcyBlbHNlIHt9CgogICAgICAgIHJldHVybiByZXN1bHQgICAgCgogICAgZGVmIG1hcmtfdmVyaWZpZWQoc2VsZiwgdmFsdWU9MSk6CiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZV9uYW1lID0gc2VsZi5kb2NzX3RhYmxlX25hbWUKICAgICAgICBzZWxmLnByb3ZpZGVyLnVwZGF0ZSh7J3ZlcmlmaWVkJzogdmFsdWV9LCB7J2lkX2RvYyc6IHNlbGYuZG9jX2lkfSkKCiAgICBkZWYgcmVzZXRfZG9jX3RhYmxlc19xdHR5KHNlbGYpOgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHNlbGYuZGV0YWlsc190YWJsZV9uYW1lCiAgICAgICAgc2VsZi5wcm92aWRlci51cGRhdGUoeydxdHR5JzogMH0sIHsnaWRfZG9jJzogc2VsZi5kb2NfaWR9KQoKCmNsYXNzIFNlcmllc1NlcnZpY2UoRGJTZXJ2aWNlKToKICAgIGRvY19iYXNpY190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICBkb2NfYmFzaWNfaGFuZGxlcl9uYW1lID0gJ1JTX2RvY3MnCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgI2lmIHBhcmFtcyBhbmQgaXNpbnN0YW5jZShwYXJhbXMsIGRpY3QpOgogICAgICAgICMgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMKICAgICAgICAjZWxzZToKICAgICAgICBzZWxmLnBhcmFtcyA9IHt9CgogICAgZGVmIGdldF9zZXJpZXNfYnlfYmFyY29kZShzZWxmLCBiYXJjb2RlLCBwYXJhbXM6IGRpY3QpOgoKICAgICAgICBwYXJhbXMgPSBbCiAgICAgICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksCiAgICAgICAgICAgIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLAogICAgICAgICAgICBzZWxmLnBhcmFtcy5nZXQoJ2lkX3Byb3BlcnRpZXMnKSwKICAgICAgICAgICAgYmFyY29kZSwKICAgICAgICAgICAgYmFyY29kZQogICAgICAgIF0gICMgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKSwKICAgICAgICBxID0gJycnCiAgICAgICAgU0VMRUNUIGlkLAogICAgICAgICAgIGlkX2RvYywKICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgIGlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICBxdHR5LAogICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgbnVtYmVyLAogICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZSwKICAgICAgICAgICBjZWxsCiAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgIFdIRVJFIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9ID8gQU5EIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9nb29kID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3Byb3BlcnRpZXMgPSA/IAogICAgICAgICAgICBBTkQgKG5hbWUgPSA/IE9SIG51bWJlciA9ID8pJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBnZXRfYWRyX3Nlcmllc19ieV9iYXJjb2RlKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIHBhcmFtcyA9IFtzZWxmLnBhcmFtcy5nZXQoJ2lkX2RvYycpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2dvb2QnKSwgc2VsZi5wYXJhbXMuZ2V0KCdjZWxsJyksCiAgICAgICAgICAgICAgICAgIGJhcmNvZGUsICBiYXJjb2RlXSAgIyBzZWxmLnBhcmFtcy5nZXQoJ2lkX3dhcmVob3VzZScpLAogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgaWRfcHJvcGVydGllcywKICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgIHF0dHksCiAgICAgICAgICAgbmFtZSwKICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgIGNlbGwKICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSA/IEFORCBSU19kb2NzX3Nlcmllcy5jZWxsID0gPwogICAgICAgICAgICBBTkQgKG5hbWUgPSA/IE9SIG51bWJlciA9ID8pJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBnZXRfc2VyaWVzX2J5X2RvY19hbmRfZ29vZHMoc2VsZik6CiAgICAgICAgcGFyYW1zID0gKHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpKSAgIyAsIHNlbGYucGFyYW1zLmdldCgnaWRfd2FyZWhvdXNlJykKCiAgICAgICAgcSA9ICcnJwogICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZCBhcyBrZXksCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MgYXMgaWRfZG9jLAogICAgICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCwKICAgICAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3Byb3BlcnRpZXMsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9zZXJpZXMsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF93YXJlaG91c2UsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5xdHR5LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLm5hbWUsICcnKSBBUyBuYW1lLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLmJlc3RfYmVmb3JlLCAnJykgQVMgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5udW1iZXIsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMucHJvZHVjdGlvbl9kYXRlLCAnJykgQVMgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX3R5cGUsICcnKSBBUyBkb2NfdHlwZSwKICAgICAgICAgICAgICAgIElGTlVMTChSU19kb2NzLmRvY19uLCAnJykgQVMgZG9jX24sCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfZGF0ZSwgJycpIEFTIGRvY19kYXRlLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmFydCwgJycpIEFTIGFydCwKICAgICAgICAgICAgICAgIElGTlVMTChSU193YXJlaG91c2VzLm5hbWUgLCAnJykgQVMgd2FyZWhvdXNlX25hbWUKICAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzIAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2RvY3MgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSBSU19kb2NzLmlkX2RvYwogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMgCiAgICAgICAgICAgICAgICBPTiBSU19kb2NzX3Nlcmllcy5pZF9wcm9wZXJ0aWVzID0gUlNfcHJvcGVydGllcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzIAogICAgICAgICAgICAgICAgT04gUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9IFJTX2dvb2RzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfd2FyZWhvdXNlcyAKICAgICAgICAgICAgICAgIE9OIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSA9IFJTX3dhcmVob3VzZXMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIFdIRVJFIFJTX2RvY3Nfc2VyaWVzLmlkX2RvYyA9ID8gQU5EIAogICAgICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCA9ID8gCiAgICAgICAgICAgIAogICAgICAgICcnJwogICAgICAgIHJldHVybiBnZXRfcXVlcnlfcmVzdWx0KHEsIHBhcmFtcywgVHJ1ZSkKCiAgICBkZWYgZ2V0X3Nlcmllc19ieV9hZHJfZG9jX2FuZF9nb29kcyhzZWxmKToKICAgICAgICBjdXJyX2NlbGwgPSBzZWxmLnBhcmFtcy5nZXQoJ2NlbGwnKSBpZiBzZWxmLnBhcmFtcy5nZXQoJ2NlbGwnKSBlbHNlIHNlbGYucGFyYW1zLmdldCgnaWRfY2VsbCcpCiAgICAgICAgcGFyYW1zID0gKHNlbGYucGFyYW1zLmdldCgnaWRfZG9jJyksIHNlbGYucGFyYW1zLmdldCgnaWRfZ29vZCcpLCBjdXJyX2NlbGwpICAjICwgc2VsZi5wYXJhbXMuZ2V0KCdpZF93YXJlaG91c2UnKQoKICAgICAgICBxID0gJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkIGFzIGtleSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZG9jIGFzIGlkX2RvYywKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcywKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfc2VyaWVzLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF93YXJlaG91c2UsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLnF0dHksCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLm5hbWUsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmJlc3RfYmVmb3JlLAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5udW1iZXIsCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLnByb2R1Y3Rpb25fZGF0ZSwKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCwKICAgICAgICAgICAgUlNfZG9jcy5kb2NfdHlwZSwKICAgICAgICAgICAgUlNfZG9jcy5kb2NfbiwgCiAgICAgICAgICAgIFJTX2RvY3MuZG9jX2RhdGUsCiAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgZ29vZF9uYW1lLAogICAgICAgICAgICBSU19wcm9wZXJ0aWVzLm5hbWUgYXMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgIFJTX3dhcmVob3VzZXMubmFtZSBhcyB3YXJlaG91c2VfbmFtZSwKICAgICAgICAgICAgUlNfY2VsbHMubmFtZSBhcyBjZWxsX25hbWUKICAgICAgICAgICAgIAogICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzIAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIAogICAgICAgICAgICBSU19kb2NzIE9OIAogICAgICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MgPSAgUlNfZG9jcy5pZF9kb2MKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgUlNfZ29vZHMgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSAgUlNfZ29vZHMuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiAKICAgICAgICAgICAgUlNfcHJvcGVydGllcyBPTiAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfcHJvcGVydGllcyA9ICBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gCiAgICAgICAgICAgIFJTX3dhcmVob3VzZXMgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX3dhcmVob3VzZSA9ICBSU193YXJlaG91c2VzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY2VsbHMgT04gCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmNlbGwgPSBSU19jZWxscy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgV0hFUkUgUlNfZG9jc19zZXJpZXMuaWRfZG9jID0gPyBBTkQgCiAgICAgICAgICAgIFJTX2RvY3Nfc2VyaWVzLmlkX2dvb2QgPSA/IEFORCAKICAgICAgICAgICAgUlNfZG9jc19zZXJpZXMuY2VsbCA9ID8KICAgICAgICAgICAgJycnCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zLCBUcnVlKQoKICAgIGRlZiBhZGRfcXR0eV90b190YWJsZV9zdHIoc2VsZiwgaXRlbV9pZCk6CiAgICAgICAgcGFyYW1zID0gKGl0ZW1faWQsKQogICAgICAgIHEgPSAnJydVUERBVEUgUlNfZG9jc19zZXJpZXMKICAgICAgICAgICAgU0VUIHF0dHkgPSBxdHR5ICsgMQogICAgICAgICAgICBXSEVSRSBpZCA9ID8nJycKCiAgICAgICAgcmV0dXJuIGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zKQoKCiAgICBkZWYgYWRkX25ld19zZXJpZXNfaW5fZG9jX3Nlcmllc190YWJsZShzZWxmLCBiYXJjb2RlKToKICAgICAgICBxX3BhcmFtcyA9ICgKICAgICAgICBzZWxmLnBhcmFtcy5nZXQoJ2lkX2RvYycpLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2dvb2QnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9wcm9wZXJ0aWVzJyksIHNlbGYucGFyYW1zLmdldCgnaWRfd2FyZWhvdXNlJyksIDEsCiAgICAgICAgICAgICAgICBiYXJjb2RlLCBiYXJjb2RlLCBzZWxmLnBhcmFtcy5nZXQoJ2lkX2NlbGwnKSkKICAgICAgICBxID0gJ0lOU0VSVCBJTlRPIFJTX2RvY3Nfc2VyaWVzIChpZF9kb2MsIGlkX2dvb2QsIGlkX3Byb3BlcnRpZXMsIGlkX3dhcmVob3VzZSwgcXR0eSwgbmFtZSwgbnVtYmVyLCBjZWxsKSBWQUxVRVMoPyw/LD8sPyw/LD8sPyw/KScKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBxX3BhcmFtcykKCiAgICBkZWYgZ2V0X2l0ZW1fYnlfbmFtZShzZWxmLCBpdGVtX25hbWUsIHRhYmxlX25hbWUpOgogICAgICAgIHEgPSBmJ1NFTEVDVCBpZCBGUk9NIHt0YWJsZV9uYW1lfSBXSEVSRSB7dGFibGVfbmFtZX0ubmFtZSA9ID8nCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCAoaXRlbV9uYW1lLCkpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgZGVsZXRlX2N1cnJlbnRfc3Qoc2VsZiwgaWQpOgogICAgICAgIHEgPSAnREVMRVRFIEZST00gUlNfZG9jc19zZXJpZXMgIFdIRVJFIGlkID0gPycKICAgICAgICByZXR1cm4gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCAoaWQsKSkKCgogICAgZGVmIGdldF9zZXJpZXNfcHJvcF9ieV9pZChzZWxmLCBpZCk6CiAgICAgICAgdGFibGVfbmFtZSA9IHNlbGYuZG9jX2Jhc2ljX3RhYmxlX25hbWUKICAgICAgICBpc19hZHIgPSBGYWxzZSBpZiB0YWJsZV9uYW1lID09ICdSU19kb2NzX3RhYmxlJyBlbHNlIFRydWUKICAgICAgICBxID0gZicnJwogICAgICAgICAgIFNFTEVDVCB7dGFibGVfbmFtZX0uaWQsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX2RvYywKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfZ29vZCwKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfcHJvcGVydGllcywKICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfc2VyaWVzLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5pZF91bml0LAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5xdHR5LAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5xdHR5X3BsYW4sCiAgICAgICAgICAgICAgICAgICAgICcnJwogICAgICAgIHEgPSBxICsgZicnJyB7dGFibGVfbmFtZX0uaWRfY2VsbCwgCiAgICAgICAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX2NlbGwgYXMgY2VsbCwgCiAgICAgICAgICAgICAgICBSU19jZWxscy5uYW1lIGFzIGNlbGxfbmFtZSwgCiAgICAgICAgICAgICAgICAwIGFzIHByaWNlLAogICAgICAgICAgICAgICAgTnVsbCBhcyBpZF9wcmljZSwnJycgaWYgaXNfYWRyIGVsc2UgcSArICBmJycnCiAgICAgICAgICAgICAgICB7dGFibGVfbmFtZX0ucHJpY2UsCiAgICAgICAgICAgICAgICB7dGFibGVfbmFtZX0uaWRfcHJpY2UsJycnCgogICAgICAgIHEgPSBxICsgZicnJwogICAgICAgICAgIHt0YWJsZV9uYW1lfS51c2Vfc2VyaWVzLAogICAgICAgICAgIFJTX2dvb2RzLmFydCBhcyBjb2RlX2FydCwgCiAgICAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgUlNfcHJvcGVydGllcy5uYW1lIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICBSU191bml0cy5uYW1lIGFzIHVuaXRzX25hbWUKICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIEZST00ge3RhYmxlX25hbWV9IAogICAgICAgICAgICBMRUZUIEpPSU4gICBSU19nb29kcwogICAgICAgICAgICBPTiB7dGFibGVfbmFtZX0uaWRfZ29vZCA9IFJTX2dvb2RzLmlkCiAgICAgICAgICAgIAogICAgICAgICAgICBMRUZUIEpPSU4gICBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgIE9OIHt0YWJsZV9uYW1lfS5pZF9wcm9wZXJ0aWVzID0gUlNfcHJvcGVydGllcy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOICAgUlNfdW5pdHMKICAgICAgICAgICAgT04ge3RhYmxlX25hbWV9LmlkX3VuaXQgPSBSU191bml0cy5pZAogICAgICAgICAgICAnJycKICAgICAgICBxID0gcSArIGYnJycKICAgICAgICAgICAgTEVGVCBKT0lOICAgUlNfY2VsbHMKICAgICAgICAgICAgT04ge3RhYmxlX25hbWV9LmlkX2NlbGwgPSBSU19jZWxscy5pZAogICAgICAgICAgICAnJycgaWYgaXNfYWRyIGVsc2UgcQoKICAgICAgICBxID0gcSArIGYnJycKICAgICAgICAgICAgV0hFUkUge3RhYmxlX25hbWV9LmlkID0gPwogICAgICAgICAgICAnJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIChpZCwpLCBUcnVlKQogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiB7fQoKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0X3Nlcmllc190YWJsZV9zdHIoaWQpOgogICAgICAgIHEgPSAnJycKICAgICAgIFNFTEVDVCAKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZCwKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9kb2MsCiAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfZ29vZCwKICAgICAgICBSU19kb2NzX3Nlcmllcy5pZF9zZXJpZXMsCiAgICAgICAgUlNfZG9jc19zZXJpZXMuaWRfd2FyZWhvdXNlLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLnF0dHksCiAgICAgICAgSUZOVUxMKFJTX2RvY3Nfc2VyaWVzLm5hbWUsICcnKSBBUyBuYW1lLAogICAgICAgIElGTlVMTChSU19kb2NzX3Nlcmllcy5iZXN0X2JlZm9yZSwgJycpIEFTIGJlc3RfYmVmb3JlLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLm51bWJlciwKICAgICAgICBJRk5VTEwoUlNfZG9jc19zZXJpZXMucHJvZHVjdGlvbl9kYXRlLCAnJykgQVMgcHJvZHVjdGlvbl9kYXRlLAogICAgICAgIFJTX2RvY3Nfc2VyaWVzLmNlbGwsCiAgICAgICAgUlNfZ29vZHMubmFtZSBhcyBnb29kX25hbWUsIAogICAgICAgIFJTX2NlbGxzLm5hbWUgYXMgY2VsbF9uYW1lCiAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllcwogICAgICAgIExFRlQgSk9JTiBSU19nb29kcwogICAgICAgIE9OIFJTX2dvb2RzLmlkID0gUlNfZG9jc19zZXJpZXMuaWRfZ29vZAogICAgICAgIExFRlQgSk9JTiBSU19jZWxscwogICAgICAgIE9OIFJTX2NlbGxzLmlkID0gUlNfZG9jc19zZXJpZXMuY2VsbAogICAgICAgIFdIRVJFIFJTX2RvY3Nfc2VyaWVzLmlkID0gPwogICAgICAgICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgKGlkLCksVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCgogICAgZGVmIGdldF9kb2NfcHJvcF9ieV9pZChzZWxmLCBpZF9kb2MpOgogICAgICAgIHRhYmxlX25hbWUgPSBzZWxmLmRvY19iYXNpY19oYW5kbGVyX25hbWUKICAgICAgICBxID0gZicnJwogICAgICAgIFNFTEVDVCB7dGFibGVfbmFtZX0uaWRfZG9jLAogICAgICAgICAgIHt0YWJsZV9uYW1lfS5kb2NfbiwKICAgICAgICAgICB7dGFibGVfbmFtZX0uZG9jX2RhdGUsCiAgICAgICAgICAge3RhYmxlX25hbWV9LmlkX3dhcmVob3VzZSBhcyBpZF93YXJlaG91c2UsCiAgICAgICAgICAgUlNfd2FyZWhvdXNlcy5uYW1lIGFzIHdhcmVob3VzZQogICAgICAgICAgIAogICAgICAgIEZST00ge3RhYmxlX25hbWV9CiAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgT04KICAgICAgICB7dGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlID0gUlNfd2FyZWhvdXNlcy5pZAogICAgICAgICAgCiAgICAgICAgV0hFUkUge3RhYmxlX25hbWV9LmlkX2RvYyA9ID8KICAgICAgICAnJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsKGlkX2RvYywpLFRydWUpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzWzBdCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgZGVmIGdldF92YWx1ZXNfZm9yX3NjcmVlbl9ieV9pZChzZWxmLCBpZCkgLT4gZGljdDoKCiAgICAgICAgcSA9IGYnJycKICAgICAgICBTRUxFQ1QgUlNfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucHJpY2UsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUudXNlX3NlcmllcywKICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX3R5cGUsICcnKSBBUyBkb2NfdHlwZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX24sICcnKSBBUyBkb2NfbiwKICAgICAgICAgICAgSUZOVUxMKFJTX2RvY3MuZG9jX2RhdGUsICcnKSBBUyBkb2NfZGF0ZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLm5hbWUsICcnKSBBUyBnb29kX25hbWUsCiAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5hcnQsICcnKSBBUyBnb29kX2FydCwKICAgICAgICAgICAgSUZOVUxMKFJTX3Byb3BlcnRpZXMubmFtZSwgJycpIEFTIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsICcnKSBBUyBnb29kX3VuaXQgCiAgICAgICAgRlJPTSBSU19kb2NzX3RhYmxlIEFTIFJTX2RvY3NfdGFibGUKICAgICAgICAKICAgICAgICBMRUZUIEpPSU4gUlNfZG9jcyBBUyBSU19kb2NzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZG9jID0gUlNfZG9jcy5pZF9kb2MKICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCA9IFJTX3VuaXRzLmlkCiAgICAgICAgV0hFUkUgUlNfZG9jc190YWJsZS5pZCA9ID8KICAgICAgICAnJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsKGlkLCksVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCiAgICBkZWYgc2F2ZV90YWJsZV9zdHIoc2VsZiwgcGFyYW1zKToKICAgICAgICBxID0gJycnCiAgICAgICAgVVBEQVRFIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgU0VUIAogICAgICAgICAgIGlkX3Byb3BlcnRpZXMgPSA6aWRfcHJvcGVydGllcywKICAgICAgICAgICBpZF9zZXJpZXMgPSA6aWRfc2VyaWVzLAogICAgICAgICAgIGlkX3dhcmVob3VzZSA9IDppZF93YXJlaG91c2UsCiAgICAgICAgICAgcXR0eSA9IDpxdHR5LAogICAgICAgICAgIG5hbWUgPSA6bmFtZSwKICAgICAgICAgICBiZXN0X2JlZm9yZSA9IDpiZXN0X2JlZm9yZSwKICAgICAgICAgICBudW1iZXIgPSA6bnVtYmVyLAogICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZSA9IDpwcm9kdWN0aW9uX2RhdGUsCiAgICAgICAgICAgY2VsbCAgPSA6Y2VsbAogICAgICAgIFdIRVJFIGlkID0gOmlkICcnJwogICAgICAgIHJlcyA9IGdldF9xdWVyeV9yZXN1bHQocSwgcGFyYW1zKQogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGdldF90b3RhbF9xdHR5KHNlbGYpOgoKICAgICAgICBwYXJhbXMgPSAoc2VsZi5wYXJhbXMuZ2V0KCdpZF9kb2MnKSwgc2VsZi5wYXJhbXMuZ2V0KCdpZF9nb29kJyksIHNlbGYucGFyYW1zLmdldCgnaWRfcHJvcGVydGllcycpKQogICAgICAgIHEgPSAnJycKICAgICAgICBTRUxFQ1QgCiAgICAgICAgc3VtKHF0dHkpIEZST00gUlNfZG9jc19zZXJpZXMKICAgICAgICAgV0hFUkUgaWRfZG9jID0gPyBBTkQgaWRfZ29vZCA9ID8gQU5EIGlkX3Byb3BlcnRpZXMgPSA/JycnCiAgICAgICAgcmVzID0gZ2V0X3F1ZXJ5X3Jlc3VsdChxLCBwYXJhbXMpCiAgICAgICAgaWYgcmVzIGFuZCByZXNbMF1bMF0gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiByZXNbMF1bMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gMAoKICAgIGRlZiB1cGRhdGVfdG90YWxfcXR5KHNlbGYsIHF0eSwgcm93X2lkKToKICAgICAgICBxID0gZicnJwogICAgICAgICAgICBVUERBVEUgUlNfZG9jc190YWJsZQogICAgICAgICAgICBTRVQgZF9xdHR5ID0ge3F0eX0sIHVzZV9zZXJpZXMgPSAxCiAgICAgICAgICAgIFdIRVJFIGlkID0ge3Jvd19pZH0KICAgICAgICAgICAgJycnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxKQoKCmNsYXNzIEFkclNlcmllc1NlcnZpY2UoU2VyaWVzU2VydmljZSk6CiAgICBkZWYgZ2V0X3ZhbHVlc19mb3Jfc2NyZWVuX2J5X2lkKHNlbGYsIF9pZCkgLT4gZGljdDoKCiAgICAgICAgcSA9IGYnJycKICAgICAgICBTRUxFQ1QgUlNfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZ29vZCwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3VuaXQsCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUucXR0eSwKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5xdHR5X3BsYW4sCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUudXNlX3NlcmllcywKICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9jZWxsLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfdHlwZSwgJycpIEFTIGRvY190eXBlLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfbiwgJycpIEFTIGRvY19uLAogICAgICAgICAgICBJRk5VTEwoUlNfZG9jcy5kb2NfZGF0ZSwgJycpIEFTIGRvY19kYXRlLAogICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMubmFtZSwgJycpIEFTIGdvb2RfbmFtZSwKICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmFydCwgJycpIEFTIGdvb2RfYXJ0LAogICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCAnJykgQVMgcHJvcGVydGllc19uYW1lLAogICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwgJycpIEFTIGdvb2RfdW5pdCwgCiAgICAgICAgICAgIElGTlVMTChSU19jZWxscy5uYW1lLCAnJykgQVMgY2VsbF9uYW1lCiAgICAgICAgRlJPTSBSU19hZHJfZG9jc190YWJsZSBBUyBSU19kb2NzX3RhYmxlCgogICAgICAgIExFRlQgSk9JTiBSU19hZHJfZG9jcyBBUyBSU19kb2NzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfZG9jID0gUlNfZG9jcy5pZF9kb2MKICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgT04KICAgICAgICAgICAgUlNfZG9jc190YWJsZS5pZF9nb29kID0gUlNfZ29vZHMuaWQKICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcyBPTgogICAgICAgICAgICBSU19kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMgPSBSU19wcm9wZXJ0aWVzLmlkCiAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfdW5pdCA9IFJTX3VuaXRzLmlkCiAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzIE9OCiAgICAgICAgICAgIFJTX2RvY3NfdGFibGUuaWRfY2VsbCA9IFJTX2NlbGxzLmlkCiAgICAgICAgV0hFUkUgUlNfZG9jc190YWJsZS5pZCA9ID8KICAgICAgICAnJycKICAgICAgICByZXMgPSBnZXRfcXVlcnlfcmVzdWx0KHEsIChfaWQsKSwgVHJ1ZSkKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIHJldHVybiByZXNbMF0KICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4ge30KCiAgICBkZWYgdXBkYXRlX3RvdGFsX3F0eShzZWxmLCBxdHksIHJvd19pZCk6CiAgICAgICAgcSA9IGYnJycKICAgICAgICAgICAgVVBEQVRFIFJTX2Fkcl9kb2NzX3RhYmxlCiAgICAgICAgICAgIFNFVCBxdHR5ID0ge3F0eX0sIHVzZV9zZXJpZXMgPSAxCiAgICAgICAgICAgIFdIRVJFIGlkID0ge3Jvd19pZH0KICAgICAgICAgICAgJycnCiAgICAgICAgZ2V0X3F1ZXJ5X3Jlc3VsdChxKQoKCmNsYXNzIFNlbGVjdEl0ZW1TZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGFibGVfbmFtZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQoKICAgIGRlZiBnZXRfc2VsZWN0X2RhdGEoc2VsZiwgKipjb25kKSAtPiBsaXN0OgogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHNlbGYudGFibGVfbmFtZQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnNlbGVjdChjb25kKQoKCmNsYXNzIEFkckRvY1NlcnZpY2UoRG9jU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaWRfZG9jPScnLCBjdXJfY2VsbD0nJywgdGFibGVfdHlwZT0naW4nKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmRvY19pZCA9IGlkX2RvYwogICAgICAgIHNlbGYuZG9jc190YWJsZV9uYW1lID0gJ1JTX0Fkcl9kb2NzJwogICAgICAgIHNlbGYuZGV0YWlsc190YWJsZV9uYW1lID0gJ1JTX2Fkcl9kb2NzX3RhYmxlJwogICAgICAgIHNlbGYuaXNBZHIgPSBUcnVlCiAgICAgICAgc2VsZi5pc19iYXJjX2Zsb3cgPSBGYWxzZQogICAgICAgIHNlbGYuY3VycmVudF9jZWxsID0gY3VyX2NlbGwKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSB0YWJsZV90eXBlCiAgICAgICAgc2VsZi5wcm92aWRlciA9IFNxbFF1ZXJ5UHJvdmlkZXIoc2VsZi5kb2NzX3RhYmxlX25hbWUsIHNxbF9jbGFzcz1zcWxDbGFzcygpKQogICAgICAgIHNlbGYuaXNfZ3JvdXBfc2NhbiA9IEZhbHNlCiAgICAgICAgc2VsZi5pc19iYXJjX2Zsb3cgPSBGYWxzZQoKICAgIGRlZiBnZXRfZG9jX2RldGFpbHNfZGF0YSgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgZmlyc3RfZWxlbSwKICAgICAgICAgICAgaXRlbXNfb25fcGFnZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM9Tm9uZSwKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1Ob25lLAogICAgICAgICAgICBpZF9kb2M9JycsCiAgICAgICAgICAgIGNlbGw9JycKICAgICkgLT4gbGlzdDoKCiAgICAgICAgc2VsZWN0X3F1ZXJ5ID0gJycnU0VMRUNUCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5pZF9kb2MsCiAgICAgICAgICAgIFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5uYW1lLCA6TnVsbFZhbHVlKSBhcyBnb29kX25hbWUsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5jb2RlLCA6RW1wdHlTdHJpbmcpIGFzIGNvZGUsCiAgICAgICAgICAgIGlmbnVsbChSU19nb29kcy5hcnQsIDpFbXB0eVN0cmluZykgYXMgYXJ0LAogICAgICAgICAgICBpZm51bGwoUlNfYWRyX2RvY3NfdGFibGUuaWRfcHJvcGVydGllcywgOkVtcHR5U3RyaW5nKSBhcyBpZF9wcm9wZXJ0aWVzLAogICAgICAgICAgICBpZm51bGwoUlNfcHJvcGVydGllcy5uYW1lLCA6RW1wdHlTdHJpbmcpIGFzIHByb3BlcnRpZXNfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3NlcmllcywgOkVtcHR5U3RyaW5nKSBhcyBpZF9zZXJpZXMsCiAgICAgICAgICAgIGlmbnVsbChSU19zZXJpZXMubmFtZSwgOkVtcHR5U3RyaW5nKSBhcyBzZXJpZXNfbmFtZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQsIDpFbXB0eVN0cmluZykgYXMgaWRfdW5pdCwKICAgICAgICAgICAgaWZudWxsKFJTX3VuaXRzLm5hbWUsIDpFbXB0eVN0cmluZykgYXMgdW5pdHNfbmFtZSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUucXR0eSBhcyBxdHR5LAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5X3BsYW4gYXMgcXR0eV9wbGFuLAogICAgICAgICAgICBSU19hZHJfZG9jc190YWJsZS5xdHR5X3BsYW4gLSBSU19hZHJfZG9jc190YWJsZS5xdHR5IGFzIElzRG9uZSwKICAgICAgICAgICAgaWZudWxsKFJTX2Fkcl9kb2NzX3RhYmxlLmlkX2NlbGwsIDpFbXB0eVN0cmluZykgYXMgaWRfY2VsbCwKICAgICAgICAgICAgaWZudWxsKFJTX2NlbGxzLm5hbWUsIDpOdWxsVmFsdWUpIGFzIGNlbGxfbmFtZSwKICAgICAgICAgICAgUlNfYWRyX2RvY3NfdGFibGUudXNlX3NlcmllcwogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgCgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfZ29vZHMgCiAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMKICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9IFJTX2Fkcl9kb2NzX3RhYmxlLmlkX3Byb3BlcnRpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgICAgICBPTiBSU19zZXJpZXMuaWQgPSBSU19hZHJfZG9jc190YWJsZS5pZF9zZXJpZXMKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgIE9OIFJTX3VuaXRzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX3VuaXQKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2NlbGxzCiAgICAgICAgICAgIE9OIFJTX2NlbGxzLmlkPVJTX2Fkcl9kb2NzX3RhYmxlLmlkX2NlbGwKICAgICAgICAgICAgJycnCgogICAgICAgIGJhc2ljX3doZXJlID0gZiIiIldIRVJFIGlkX2RvYyA9IDppZF9kb2MgYW5kIHRhYmxlX3R5cGUgPSA6dGFibGVfdHlwZSIiIgoKICAgICAgICBjdXJfY2VsbF9jb25kaXRpb24gPSAnJydhbmQgKGlkX2NlbGw9OmN1cnJlbnRfY2VsbCBPUiBpZF9jZWxsPSIiIE9SIGlkX2NlbGwgaXMgTnVsbCknJycgaWYgY2VsbCBlbHNlICcnCiAgICAgICAgcm93X2ZpbHRlcnNfY29uZGl0aW9uID0gIiIiQU5EIHF0dHkgIT0gQ09BTEVTQ0UocXR0eV9wbGFuLCAnMCcpICIiIiBpZiByb3dfZmlsdGVycyBlbHNlICcnCiAgICAgICAgc2VhcmNoX3N0cmluZ19jb25kaXRpb24gPSBmIiIiQU5EIGdvb2RfbmFtZSBMSUtFICcle3NlYXJjaF9zdHJpbmd9JSciIiIgaWYgc2VhcmNoX3N0cmluZyBlbHNlICcnCgogICAgICAgIHdoZXJlX2Z1bGwgPSBmIiIiCiAgICAgICAgICAgICAgICB7YmFzaWNfd2hlcmV9CiAgICAgICAgICAgICAgICB7Y3VyX2NlbGxfY29uZGl0aW9ufQogICAgICAgICAgICAgICAge3Jvd19maWx0ZXJzX2NvbmRpdGlvbn0KICAgICAgICAgICAgICAgIHtzZWFyY2hfc3RyaW5nX2NvbmRpdGlvbn0KICAgICAgICAiIiIKCiAgICAgICAgb3JkZXJfYnkgPSBmIiIiT1JERVIgQlkgUlNfY2VsbHMubmFtZSwgUlNfYWRyX2RvY3NfdGFibGUubGFzdF91cGRhdGVkIERFU0MiIiIKICAgICAgICBsaW1pdCA9IGYnTElNSVQge2l0ZW1zX29uX3BhZ2V9IE9GRlNFVCB7Zmlyc3RfZWxlbX0nCiAgICAgICAgcXVlcnlfdGV4dCA9IGYie3NlbGVjdF9xdWVyeX0ge3doZXJlX2Z1bGx9IHtvcmRlcl9ieX0ge2xpbWl0fSIKCiAgICAgICAgcGFyYW1zX2RpY3QgPSB7J2lkX2RvYyc6IGlkX2RvYywgJ051bGxWYWx1ZSc6IE5vbmUsICdFbXB0eVN0cmluZyc6ICcnLCAndGFibGVfdHlwZSc6IHNlbGYudGFibGVfdHlwZX0KICAgICAgICBpZiBjZWxsOgogICAgICAgICAgICBwYXJhbXNfZGljdFsnY3VycmVudF9jZWxsJ10gPSBjZWxsCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCBwYXJhbXNfZGljdCwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzCgogICAgZGVmIGNsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIF9maWx0ZXIgPSB7J2lkX2RvYyc6IGlkX2RvY30KICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnUlNfZG9jc19zZXJpZXMnCiAgICAgICAgc2VsZi5wcm92aWRlci5kZWxldGUoX2ZpbHRlcj1fZmlsdGVyKQoKICAgICAgICBxdWVyeV90ZXh0ID0gKAogICAgICAgICAgICAnVVBEQVRFIFJTX2Fkcl9kb2NzX3RhYmxlIHNldCBxdHR5ID0gMCBXSEVSRSBpZF9kb2M9OmlkX2RvYycsCiAgICAgICAgICAgICdVUERBVEUgUlNfYWRyX2RvY3Mgc2V0IHZlcmlmaWVkID0gMCwgc2VudCA9IDAgV0hFUkUgaWRfZG9jPTppZF9kb2MnLAogICAgICAgICAgICAnREVMRVRFIEZST00gUlNfYWRyX2RvY3NfdGFibGUgV0hFUkUgaWRfZG9jPTppZF9kb2MgQU5EIGlzX3BsYW4gPSAiRmFsc2UiJwogICAgICAgICkKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBmb3IgZWwgaW4gcXVlcnlfdGV4dDoKICAgICAgICAgICAgICAgIGdldF9xdWVyeV9yZXN1bHQoZWwsICh7J2lkX2RvYyc6IGlkX2RvY30pKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi53cml0ZV9lcnJvcl9vbl9sb2coZS5hcmdzWzBdKQogICAgICAgICAgICByZXR1cm4geydyZXN1bHQnOiBGYWxzZSwgJ2Vycm9yJzogZS5hcmdzWzBdfQoKICAgICAgICByZXR1cm4geydyZXN1bHQnOiBUcnVlLCAnZXJyb3InOiAnJ30KCiAgICBkZWYgZ2V0X2RhdGFfdG9fc2VuZChzZWxmLCBpZF9kb2M9JycpOgogICAgICAgIGRhdGEgPSBbXQoKICAgICAgICBkb2NfaWRfY29uZGl0aW9uID0gZidpZF9kb2M9IntpZF9kb2N9IicgaWYgaWRfZG9jIGVsc2UgJ3ZlcmlmaWVkID0gMSBBTkQgSUZOVUxMKHNlbnQsIDApID0gMCcKCiAgICAgICAgcSA9IGYnJydTRUxFQ1QgaWRfZG9jCiAgICAgICAgICAgICAgICBGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0gCiAgICAgICAgICAgICAgICBXSEVSRSB7ZG9jX2lkX2NvbmRpdGlvbn0KICAgICAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSkKCiAgICAgICAgZm9yIHJvdyBpbiByZXM6CiAgICAgICAgICAgIGlkX2RvYyA9IHJvd1snaWRfZG9jJ10KCiAgICAgICAgICAgIGRvY19kYXRhID0gewogICAgICAgICAgICAgICAgJ2lkX2RvYyc6IGlkX2RvYywKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnaWRfZ29vZCcsICdpZF9wcm9wZXJ0aWVzJywgJ2lkX3NlcmllcycsICdpZF91bml0JywgJ3F0dHknLCAncXR0eV9wbGFuJywgJ3RhYmxlX3R5cGUnLAogICAgICAgICAgICAgICAgICAgICAgJ2lkX2NlbGwnXQogICAgICAgICAgICBxID0gJycnCiAgICAgICAgICAgICAgICBTRUxFQ1Qge30KICAgICAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/IEFORCAoc2VudCA9IDAgT1Igc2VudCBJUyBOVUxMKQogICAgICAgICAgICAnJycuZm9ybWF0KCcsJy5qb2luKGZpZWxkcykpCiAgICAgICAgICAgIGdvb2RzID0gc2VsZi5wcm92aWRlci5zcWxfcXVlcnkocSwgaWRfZG9jKQogICAgICAgICAgICBkb2NfZGF0YVsnUlNfYWRyX2RvY3NfdGFibGUnXSA9IGdvb2RzCgoKICAgICAgICAgICAgZmllbGRzID0gWydpZF9kb2MnLCAnaWRfZ29vZCcsICdpZF9zZXJpZXMnLCAnaWRfd2FyZWhvdXNlJywgJ2NlbGwnLCAncXR0eScsICduYW1lJywgJ2Jlc3RfYmVmb3JlJywgJ251bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJ10KICAgICAgICAgICAgcSA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIHt9CiAgICAgICAgICAgICAgICBGUk9NIFJTX2RvY3Nfc2VyaWVzCiAgICAgICAgICAgICAgICBXSEVSRSBpZF9kb2MgPSA/CiAgICAgICAgICAgICcnJy5mb3JtYXQoJywnLmpvaW4oZmllbGRzKSkKCiAgICAgICAgICAgIHNlcmllc190YWJsZSA9IHNlbGYucHJvdmlkZXIuc3FsX3F1ZXJ5KHEsIGlkX2RvYykKICAgICAgICAgICAgZG9jX2RhdGFbJ1JTX2RvY3Nfc2VyaWVzJ10gPSBzZXJpZXNfdGFibGUKCiAgICAgICAgICAgIGRhdGEuYXBwZW5kKGRvY19kYXRhKQoKCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgZmluZF9jZWxsKHNlbGYsIGJhcmNvZGUpOgogICAgICAgICMgVE9ETyDQvdC1INGD0YfQuNGC0YvQstCw0LXRgtGB0Y8g0LLQsNGA0LjQsNC90YIg0YEg0L7QtNC40L3QsNC60L7QstGL0LzQuCDQqNCaINGB0LXRgNC40LkKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnUlNfY2VsbHMnCiAgICAgICAgcmVzID0gc2VsZi5wcm92aWRlci5zZWxlY3QoeydiYXJjb2RlJzogYmFyY29kZX0pCgogICAgICAgIGlmIHJlczoKICAgICAgICAgICAgcmV0dXJuIHJlc1swXQoKICAgIGRlZiBnZXRfZG9jX2RhdGFfYnlfaWQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5kb2NfaWQ6CiAgICAgICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgICAgICBTRUxFQ1QgCiAgICAgICAgICAgICAgICAgICAgZC4qLCAKICAgICAgICAgICAgICAgICAgICB3Lm5hbWUgQVMgd2FyZWhvdXNlIAogICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jcyBhcyBkCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU193YXJlaG91c2VzIGFzIHcgCiAgICAgICAgICAgICAgICAgICAgT04gZC5pZF93YXJlaG91c2UgPSB3LmlkCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBXSEVSRSBkLmlkX2RvYyA9ICJ7c2VsZi5kb2NfaWR9IgogICAgICAgICAgICAnJycKICAgICAgICAgICAgZG9jX2RhdGEgPSBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHEsIHJldHVybl9kaWN0PVRydWUpCiAgICAgICAgICAgIHJldHVybiBkb2NfZGF0YVswXSBpZiBkb2NfZGF0YSBlbHNlIE5vbmUKCiAgICBkZWYgZ2V0X2RvY192aWV3X2RhdGEoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRvY190eXBlPScnLAogICAgICAgICAgICBkb2Nfc3RhdHVzOiBMaXRlcmFsWyfQktGL0LPRgNGD0LbQtdC9JywgJ9CaINCy0YvQs9GA0YPQt9C60LUnLCAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nXSA9ICcnCiAgICApIC0+IGxpc3Q6CiAgICAgICAgZmllbGRzID0gWwogICAgICAgICAgICAnZG9jLmlkX2RvYycsCiAgICAgICAgICAgICdkb2MuZG9jX3R5cGUnLAogICAgICAgICAgICAnZG9jLmRvY19uJywKICAgICAgICAgICAgJ2RvYy5kb2NfZGF0ZScsCiAgICAgICAgICAgICdkb2MuaWRfd2FyZWhvdXNlJywKICAgICAgICAgICAgJ2RvYy5hZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgICAgICAnSUZOVUxMKGRvYy52ZXJpZmllZCwgMCkgQVMgdmVyaWZpZWQnLAogICAgICAgICAgICAnSUZOVUxMKGRvYy5zZW50LCAwKSBBUyBzZW50JywKICAgICAgICAgICAgJ0lGTlVMTChSU193YXJlaG91c2VzLm5hbWUsICInJyIpIEFTIHdhcmVob3VzZScsCiAgICAgICAgXQoKICAgICAgICBxdWVyeV90ZXh0ID0gJ1NFTEVDVCAnICsgJyxcbicuam9pbihmaWVsZHMpCgogICAgICAgIGpvaW5zID0gZicnJ0ZST00ge3NlbGYuZG9jc190YWJsZV9uYW1lfSBBUyBkb2MKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgUlNfd2FyZWhvdXNlcwogICAgICAgICAgICAgICAgT04gUlNfd2FyZWhvdXNlcy5pZCA9IGRvYy5pZF93YXJlaG91c2UKICAgICAgICAnJycKCiAgICAgICAgd2hlcmUgPSAnJwogICAgICAgIGNvbmRpdGlvbiA9IFtdCgogICAgICAgIGlmIGRvY19zdGF0dXMgPT0gItCS0YvQs9GA0YPQttC10L0iOgogICAgICAgICAgICBjb25kaXRpb24uYXBwZW5kKCJzZW50ID0gMSBBTkQgdmVyaWZpZWQgPSAxIikKICAgICAgICBlbGlmIGRvY19zdGF0dXMgPT0gItCaINCy0YvQs9GA0YPQt9C60LUiOgogICAgICAgICAgICBjb25kaXRpb24uYXBwZW5kKCJJRk5VTEwodmVyaWZpZWQsIDApID0gMSBBTkQgSUZOVUxMKHNlbnQsIDApID0gMCIpCiAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0L/QvtC70L3QtdC90LjRjiI6CiAgICAgICAgICAgIGNvbmRpdGlvbi5hcHBlbmQoIklGTlVMTCh2ZXJpZmllZCwgMCkgPSAwIEFORCBJRk5VTEwoc2VudCwgMCkgPSAwIikKCiAgICAgICAgaWYgZG9jX3R5cGU6CiAgICAgICAgICAgIGNvbmRpdGlvbi5hcHBlbmQoZidkb2NfdHlwZT0ie2RvY190eXBlfSInKQoKICAgICAgICBpZiBjb25kaXRpb246CiAgICAgICAgICAgIHdoZXJlID0gJ1dIRVJFICcgKyAnIEFORFxuJy4gam9pbihjb25kaXRpb24pCgogICAgICAgIHF1ZXJ5X3RleHQgPSBmJycnCiAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICB7am9pbnN9CiAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgT1JERVIgQlkgZG9jLmRvY19kYXRlCiAgICAgICAgJycnCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCByZXR1cm5fZGljdD1UcnVlKQogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZ2V0X2RvY19yb3dfZGF0YShzZWxmLCByb3dfaWQpOgogICAgICAgIHEgPSBmJycnCiAgICAgICAgICAgIFNFTEVDVCAKICAgICAgICAgICAgICAgIHQuaWRfZG9jIEFTIGlkX2RvYywKICAgICAgICAgICAgICAgIHQuaWRfZ29vZCBBUyBpdGVtX2lkLAogICAgICAgICAgICAgICAgdC5pZF9wcm9wZXJ0aWVzIGFzIHByb3BlcnR5X2lkLAogICAgICAgICAgICAgICAgdC5pZF91bml0IGFzIHVuaXRfaWQsCiAgICAgICAgICAgICAgICB0LnF0dHlfcGxhbiwKICAgICAgICAgICAgICAgIHQucXR0eSwKICAgICAgICAgICAgICAgIHQudXNlX3NlcmllcywKICAgICAgICAgICAgICAgIElGTlVMTChnLm5hbWUsICcnKSBBUyBpdGVtX25hbWUsCiAgICAgICAgICAgICAgICBJRk5VTEwoZy5hcnQsICcnKSBBUyBhcnRpY2xlLAogICAgICAgICAgICAgICAgSUZOVUxMKHAubmFtZSwgJycpIEFTIHByb3BlcnR5LAogICAgICAgICAgICAgICAgSUZOVUxMKHUubmFtZSwgJycpIEFTIHVuaXQKICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfYWRyX2RvY3NfdGFibGUgQVMgdAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2dvb2RzICBBUyBnCiAgICAgICAgICAgIE9OIHQuaWRfZ29vZD0gZy5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3Byb3BlcnRpZXMgIEFTIHAKICAgICAgICAgICAgT04gdC5pZF9wcm9wZXJ0aWVzID0gcC5pZAogICAgICAgICAgICAKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzICBBUyB1CiAgICAgICAgICAgIE9OIHQuaWRfdW5pdCA9IHUuaWQKICAgICAgICAgICAgCiAgICAgICAgICAgIFdIRVJFIHQuaWQgPSAie3Jvd19pZH0iCiAgICAgICAgJycnCiAgICAgICAgcmVzID0gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxLCByZXR1cm5fZGljdD1UcnVlKQoKICAgICAgICByZXR1cm4gcmVzWzBdIGlmIHJlcyBlbHNlIHt9CgoKY2xhc3MgRmxvd0RvY1NlcnZpY2UoRG9jU2VydmljZSk6CgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGRvY19pZD0nJyk6CiAgICAgICAgc2VsZi5kb2NfaWQgPSBkb2NfaWQKICAgICAgICBzZWxmLmRvY3NfdGFibGVfbmFtZSA9ICdSU19kb2NzJwogICAgICAgIHNlbGYuZGV0YWlsc190YWJsZV9uYW1lID0gJ1JTX2RvY3NfdGFibGUnCiAgICAgICAgc2VsZi5pc0FkciA9IEZhbHNlCiAgICAgICAgc2VsZi5zcWxfdGV4dCA9ICcnCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gTm9uZQogICAgICAgIHNlbGYuZGVidWcgPSBGYWxzZQogICAgICAgIHNlbGYucHJvdmlkZXIgPSBTcWxRdWVyeVByb3ZpZGVyKHNlbGYuZG9jc190YWJsZV9uYW1lLCBzcWxfY2xhc3M9c3FsQ2xhc3MoKSkKICAgICAgICBzZWxmLmlzX2dyb3VwX3NjYW4gPSBGYWxzZQogICAgICAgIHNlbGYuaXNfYmFyY19mbG93ID0gVHJ1ZQoKICAgIGRlZiBnZXRfZG9jX3ZpZXdfZGF0YShzZWxmLCBkb2NfdHlwZT0nJywgZG9jX3N0YXR1cz0nJykgLT4gbGlzdDoKICAgICAgICBmaWVsZHMgPSBbCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9kb2MnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX3R5cGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX24nLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uZG9jX2RhdGUnLAogICAgICAgICAgICBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlJywKICAgICAgICAgICAgZidpZm51bGwoUlNfd2FyZWhvdXNlcy5uYW1lLCIiKSBhcyBSU193YXJlaG91c2UnLAogICAgICAgICAgICBmJ2lmbnVsbCh7c2VsZi5kb2NzX3RhYmxlX25hbWV9LnZlcmlmaWVkLCAwKSBhcyB2ZXJpZmllZCcsCiAgICAgICAgICAgIGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uc2VudCwgMCkgYXMgc2VudCcsCiAgICAgICAgICAgIGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5hZGRfbWFya19zZWxlY3Rpb24nLAogICAgICAgIF0KCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX25hbWUgPT0gJ1JTX2RvY3MnOgogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYne3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMnKQogICAgICAgICAgICBmaWVsZHMuYXBwZW5kKGYnaWZudWxsKHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfZ3JvdXBfc2NhbiwgMCkgYXMgaXNfZ3JvdXBfc2NhbicpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoe3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19iYXJjX2Zsb3csIDApIGFzIGlzX2JhcmNfZmxvdycpCiAgICAgICAgICAgIGZpZWxkcy5hcHBlbmQoZidpZm51bGwoUlNfY291bnRyYWdlbnRzLmZ1bGxfbmFtZSwgIiIpIGFzIFJTX2NvdW50cmFnZW50JykKCiAgICAgICAgcXVlcnlfdGV4dCA9ICdTRUxFQ1QgJyArICcsXG4nLmpvaW4oZmllbGRzKQoKICAgICAgICBqb2lucyA9IGYnJydGUk9NIHtzZWxmLmRvY3NfdGFibGVfbmFtZX0KICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3dhcmVob3VzZXMgYXMgUlNfd2FyZWhvdXNlcwogICAgICAgICAgICAgICAgT04gUlNfd2FyZWhvdXNlcy5pZCA9IHtzZWxmLmRvY3NfdGFibGVfbmFtZX0uaWRfd2FyZWhvdXNlCiAgICAgICAgJycnCgogICAgICAgIGlmIHNlbGYuZG9jc190YWJsZV9uYW1lID09ICdSU19kb2NzJzoKICAgICAgICAgICAgam9pbnMgKz0gZicnJwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfY291bnRyYWdlbnRzIGFzIFJTX2NvdW50cmFnZW50cwogICAgICAgICAgICAgICAgT04gUlNfY291bnRyYWdlbnRzLmlkID0ge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pZF9jb3VudHJhZ2VudHMKICAgICAgICAgICAgICAgICcnJwoKICAgICAgICB3aGVyZV9ub3RfZ3JvdXBfc2NhbiA9IGYnV0hFUkUge3NlbGYuZG9jc190YWJsZV9uYW1lfS5pc19ncm91cF9zY2FuID0gMCcKICAgICAgICB3aGVyZV9iYXJjX2Zsb3cgPSBmJ3tzZWxmLmRvY3NfdGFibGVfbmFtZX0uaXNfYmFyY19mbG93ID0gMScKICAgICAgICB3aGVyZV9lbXB0eSA9ICgiUlNfZG9jcy5pZF9kb2Mgbm90IGluICIKICAgICAgICAgICAgICAgICAgICAgICAiKFNFTEVDVCBkaXN0aW5jdCBpZF9kb2MgRnJvbSBSU19kb2NzX3RhYmxlKSIpCiAgICAgICAgd2hlcmUgPSBmInt3aGVyZV9ub3RfZ3JvdXBfc2Nhbn0gQU5EICh7d2hlcmVfYmFyY19mbG93fSBPUiB7d2hlcmVfZW1wdHl9KSIKCiAgICAgICAgaWYgZG9jX3N0YXR1czoKICAgICAgICAgICAgaWYgZG9jX3N0YXR1cyA9PSAi0JLRi9Cz0YDRg9C20LXQvSI6CiAgICAgICAgICAgICAgICB3aGVyZSArPSAiQU5EIHNlbnQ9MSBBTkQgdmVyaWZpZWQ9MSIKICAgICAgICAgICAgZWxpZiBkb2Nfc3RhdHVzID09ICLQmiDQstGL0LPRgNGD0LfQutC1IjoKICAgICAgICAgICAgICAgIHdoZXJlICs9ICJBTkQgaWZudWxsKHZlcmlmaWVkLDApPTEgQU5EIGlmbnVsbChzZW50LDApPTAiCiAgICAgICAgICAgIGVsaWYgZG9jX3N0YXR1cyA9PSAi0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4iOgogICAgICAgICAgICAgICAgd2hlcmUgKz0gIkFORCBpZm51bGwodmVyaWZpZWQsMCk9MCBBTkQgaWZudWxsKHNlbnQsMCk9MCIKCiAgICAgICAgaWYgbm90IGRvY190eXBlIG9yIGRvY190eXBlID09ICLQktGB0LUiOgogICAgICAgICAgICBhcmdzX3R1cGxlID0gTm9uZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFyZ3NfdHVwbGUgPSAoZG9jX3R5cGUsKQogICAgICAgICAgICB3aGVyZSArPSAnIEFORCBkb2NfdHlwZT0/JwogICAgICAgIHF1ZXJ5X3RleHQgPSBmJycnCiAgICAgICAgICAgIHtxdWVyeV90ZXh0fQogICAgICAgICAgICB7am9pbnN9CiAgICAgICAgICAgIHt3aGVyZX0KICAgICAgICAgICAgT1JERVIgQlkge3NlbGYuZG9jc190YWJsZV9uYW1lfS5kb2NfZGF0ZQogICAgICAgICcnJwogICAgICAgIHJlc3VsdCA9IHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgYXJnc190dXBsZSwgcmV0dXJuX2RpY3Q9VHJ1ZSkKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGdldF9mbG93X3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgcXVlcnlfdGV4dCA9ICcnJ1dJVEggdGVtcF9xIGFzIChTRUxFQ1QKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY19mbG93LmJhcmNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QgYXMgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHkgYXMgaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgICAgIDEgYXMgcXR0eQoKICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjX2Zsb3cKICAgICAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2JhcmNvZGVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19iYXJjb2Rlcy5iYXJjb2RlID0gUlNfYmFyY19mbG93LmJhcmNvZGUKICAgICAgICAgICAgICAgICAgICAgICAgV0hFUkUgUlNfYmFyY19mbG93LmlkX2RvYyA9ID8pCgogICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgdGVtcF9xLmJhcmNvZGUsIHRlbXBfcS5pZF9nb29kLCB0ZW1wX3EuaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgIHN1bShxdHR5KSBhcyBxdHR5CiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gdGVtcF9xCiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcwogICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkID0gdGVtcF9xLmlkX2dvb2QKICAgICAgICAgICAgICAgICAgICAgICAgR1JPVVAgQlkgdGVtcF9xLmJhcmNvZGUnJycKCiAgICAgICAgcmV0dXJuIHNlbGYuX2dldF9xdWVyeV9yZXN1bHQocXVlcnlfdGV4dCwgKHNlbGYuZG9jX2lkLCksIFRydWUpCgogICAgZGVmIGdldF9kYXRhX2Zvcl90aWNrZXRfcHJpbnRpbmcoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgcXVlcnlfdGV4dCA9ICcnJ1dJVEggdGVtcF9xIGFzIChTRUxFQ1QKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY19mbG93LmJhcmNvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmlkX2dvb2QgYXMgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfcHJvcGVydHkgYXMgaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgICAgIDEgYXMgcXR0eQoKICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjX2Zsb3cKICAgICAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX2JhcmNvZGVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19iYXJjb2Rlcy5iYXJjb2RlID0gUlNfYmFyY19mbG93LmJhcmNvZGUKICAgICAgICAgICAgICAgICAgICAgICAgV0hFUkUgUlNfYmFyY19mbG93LmlkX2RvYz0/IEFORCBSU19iYXJjX2Zsb3cuYmFyY29kZSA9ID8pCgogICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgdGVtcF9xLmJhcmNvZGUsIHRlbXBfcS5pZF9nb29kLCB0ZW1wX3EuaWRfcHJvcGVydHksCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUgYXMgbmFtZSwgCiAgICAgICAgICAgICAgICAgICAgICAgIFJTX3Byb3BlcnRpZXMubmFtZSBhcyBQcm9wX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHN1bShxdHR5KSBhcyBxdHR5CiAgICAgICAgICAgICAgICAgICAgICAgIEZST00gdGVtcF9xCiAgICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcwogICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFJTX2dvb2RzLmlkID0gdGVtcF9xLmlkX2dvb2QKICAgICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19wcm9wZXJ0aWVzCiAgICAgICAgICAgICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gdGVtcF9xLmlkX3Byb3BlcnR5ICAgIAogICAgICAgICAgICAgICAgICAgICAgR1JPVVAgQlkgdGVtcF9xLmJhcmNvZGUKICAgICAgICAgICAgICAgICAgICAgICcnJwogICAgICAgIHJldHVybiBzZWxmLl9nZXRfcXVlcnlfcmVzdWx0KHF1ZXJ5X3RleHQsIChzZWxmLmRvY19pZCwgYmFyY29kZSksIFRydWUpCgogICAgZGVmIGFkZF9iYXJjb2RlX3RvX2RhdGFiYXNlKHNlbGYsIGJhcmNvZGU6IHN0cik6CiAgICAgICAgaWYgbm90IGJhcmNvZGU6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHF0ZXh0ID0gJycnSU5TRVJUIElOVE8gUlNfYmFyY19mbG93IChpZF9kb2MsIGJhcmNvZGUpIFZBTFVFUyAoPyw/KScnJwogICAgICAgIHNlbGYucHJvdmlkZXIuc3FsX2V4ZWMocXRleHQsICcsJy5qb2luKFtzZWxmLmRvY19pZCwgYmFyY29kZV0pKQogICAgICAgIHNlbGYuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuZG9jX2lkKQoKICAgIGRlZiBzZXRfYmFyY19mbG93X3N0YXR1cyhzZWxmKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSBzZWxmLmRvY3NfdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIudXBkYXRlKHsnaXNfYmFyY19mbG93JzogJzEnfSwgeydpZF9kb2MnOiBzZWxmLmRvY19pZH0pCgoKY2xhc3MgR29vZHNTZXJ2aWNlKERiU2VydmljZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaXRlbV9pZD0nJyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5pdGVtX2lkID0gaXRlbV9pZAogICAgICAgIHNlbGYucHJvdmlkZXIgPSBTcWxRdWVyeVByb3ZpZGVyKHRhYmxlX25hbWU9IlJTX2dvb2RzIiwgc3FsX2NsYXNzPXNxbENsYXNzKCkpCgogICAgZGVmIGdldF90eXBlX25hbWVfYnlfaWQoc2VsZiwgaWQpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIlNFTEVDVCBuYW1lIEZST00gUlNfdHlwZXNfZ29vZHMgV0hFUkUgaWQgPSd7aWR9JyIKICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0LCByZXR1cm5fZGljdD1UcnVlKQoKICAgIGRlZiBnZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGYsIGdvb2RzX3R5cGU9JycsIGl0ZW1faWQ9JycpIC0+IGxpc3Q6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiIKICAgICAgICAgICAgU0VMRUNUCiAgICAgICAgICAgICAgICBSU19nb29kcy5pZCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5jb2RlLCAn4oCUJykgQVMgY29kZSwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLm5hbWUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5hcnQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwn4oCUJykgQVMgdW5pdCwKICAgICAgICAgICAgICAgIElGTlVMTChSU190eXBlc19nb29kcy5uYW1lLCAn4oCUJykgQVMgdHlwZV9nb29kLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX2dvb2RzLmRlc2NyaXB0aW9uLCfigJQnKSBBUyBkZXNjcmlwdGlvbgogICAgICAgICAgICBGUk9NIFJTX2dvb2RzCiAgICAgICAgICAgIExFRlQgSk9JTiBSU190eXBlc19nb29kcwogICAgICAgICAgICAgICAgT04gUlNfdHlwZXNfZ29vZHMuaWQgPSBSU19nb29kcy50eXBlX2dvb2QKICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3VuaXRzCiAgICAgICAgICAgICAgICBPTiBSU191bml0cy5pZCA9IFJTX2dvb2RzLnVuaXQKICAgICAgICAgICAgIiIiCiAgICAgICAgd2hlcmUgPSAnJyBpZiBub3QgZ29vZHNfdHlwZSBlbHNlICdXSEVSRSBSU19nb29kcy50eXBlX2dvb2Q9PycKICAgICAgICBpZiB3aGVyZSA9PSAnJyBhbmQgaXRlbV9pZDoKICAgICAgICAgICAgd2hlcmUgKz0gJ1dIRVJFIFJTX2dvb2RzLmlkPT8nCgogICAgICAgIHF1ZXJ5X3RleHQgPSBmJycnCiAgICAgICAgICAgICAgICAgICAge3F1ZXJ5X3RleHR9CiAgICAgICAgICAgICAgICAgICAge3doZXJlfQogICAgICAgICAgICAgICAgICAgIE9SREVSIEJZIFJTX2dvb2RzLmlkCiAgICAgICAgICAgICAgICAnJycKCiAgICAgICAgaWYgZ29vZHNfdHlwZToKICAgICAgICAgICAgYXJncyA9IGdvb2RzX3R5cGUKICAgICAgICBlbGlmIGl0ZW1faWQ6CiAgICAgICAgICAgIGFyZ3MgPSBpdGVtX2lkCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYXJncyA9IE5vbmUKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsIGFyZ3MpCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBnZXRfaXRlbV9kYXRhX2J5X2lkKHNlbGYsIGl0ZW1faWQpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmIiIiCiAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgUlNfZ29vZHMuaWQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMuY29kZSwgJ+KAlCcpIEFTIGNvZGUsCiAgICAgICAgICAgICAgICBSU19nb29kcy5uYW1lLAogICAgICAgICAgICAgICAgUlNfZ29vZHMuYXJ0LAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsJ+KAlCcpIEFTIHVuaXQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdHlwZXNfZ29vZHMubmFtZSwgJ+KAlCcpIEFTIHR5cGVfZ29vZCwKICAgICAgICAgICAgICAgIElGTlVMTChSU19nb29kcy5kZXNjcmlwdGlvbiwn4oCUJykgQVMgZGVzY3JpcHRpb24KICAgICAgICAgICAgRlJPTSBSU19nb29kcwogICAgICAgICAgICBMRUZUIEpPSU4gUlNfdHlwZXNfZ29vZHMKICAgICAgICAgICAgICAgIE9OIFJTX3R5cGVzX2dvb2RzLmlkID0gUlNfZ29vZHMudHlwZV9nb29kCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSBSU19nb29kcy51bml0CiAgICAgICAgICAgIFdIRVJFIFJTX2dvb2RzLmlkID0gIntpdGVtX2lkfSIKICAgICAgICAgICAgCiAgICAgICAgICAgIExJTUlUIDEKICAgICAgICAgICAgIiIiCiAgICAgICAgcmVzdWx0ID0gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQpCiAgICAgICAgcmV0dXJuIHJlc3VsdFswXSBpZiByZXN1bHQgZWxzZSB7fQoKICAgIGRlZiBnZXRfaXRlbV9kYXRhX2J5X2NvbmRpdGlvbihzZWxmLCBpdGVtX2lkLCBwcm9wZXJ0eV9pZD0nJywgdW5pdF9pZD0nJykgLT4gZGljdDoKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIgogICAgICAgICAgICBTRUxFQ1QKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmlkIEFTIGlkLAogICAgICAgICAgICAgICAgUlNfZ29vZHMuY29kZSBBUyBjb2RlLAogICAgICAgICAgICAgICAgUlNfZ29vZHMubmFtZSBBUyBuYW1lLAogICAgICAgICAgICAgICAgUlNfZ29vZHMuYXJ0IGFzIGFydCwKICAgICAgICAgICAgICAgIFJTX2dvb2RzLmRlc2NyaXB0aW9uIEFTIGRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgSUZOVUxMKFJTX3VuaXRzLm5hbWUsJ+KAlCcpIEFTIHVuaXQsCiAgICAgICAgICAgICAgICBJRk5VTEwoUlNfcHJvcGVydGllcy5uYW1lLCfigJQnKSBBUyBwcm9wZXJ0eQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEZST00gUlNfZ29vZHMKICAgICAgICAgICAgCiAgICAgICAgICAgIExFRlQgSk9JTiBSU191bml0cwogICAgICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSAie3VuaXRfaWR9IgogICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICAgICAgT04gUlNfcHJvcGVydGllcy5pZCA9ICJ7cHJvcGVydHlfaWR9IgogICAgICAgICAgICBXSEVSRSBSU19nb29kcy5pZCA9ICJ7aXRlbV9pZH0iCgogICAgICAgICAgICBMSU1JVCAxCiAgICAgICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0KQogICAgICAgIHJldHVybiByZXN1bHRbMF0gaWYgcmVzdWx0IGVsc2Uge30KCiAgICBkZWYgZ2V0X2FsbF9nb29kc190eXBlc19kYXRhKHNlbGYpOgogICAgICAgIHF1ZXJ5X3RleHQgPSAnU0VMRUNUIGlkLG5hbWUgRlJPTSBSU190eXBlc19nb29kcycKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSAnUlNfdHlwZXNfZ29vZHMnCiAgICAgICAgcmV0dXJuIHNlbGYuX3NxbF9xdWVyeShxdWVyeV90ZXh0LCAnJykKCiAgICBkZWYgZ2V0X3ZhbHVlc19mcm9tX2JhcmNvZGUoc2VsZiwgaWRlbnRpZnlfZmllbGQ6IHN0ciwgaWRlbnRpZnlfdmFsdWU6IHN0cikgLT4gbGlzdDoKICAgICAgICBxdWVyeV90ZXh0ID0gZiIiIgogICAgICAgICAgICAgICAgICAgIFNFTEVDVAogICAgICAgICAgICAgICAgICAgIFJTX2JhcmNvZGVzLmJhcmNvZGUsCiAgICAgICAgICAgICAgICAgICAgUlNfYmFyY29kZXMuaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICBJRk5VTEwoUlNfZ29vZHMubmFtZSwgJycpIEFTIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgSUZOVUxMKFJTX3Byb3BlcnRpZXMubmFtZSwgJycpIEFTIHByb3BlcnR5LAogICAgICAgICAgICAgICAgICAgIElGTlVMTChSU19zZXJpZXMubmFtZSwgJycpIEFTIHNlcmllcywKICAgICAgICAgICAgICAgICAgICBJRk5VTEwoUlNfdW5pdHMubmFtZSwgJycpIEFTIHVuaXQKCiAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19iYXJjb2RlcwogICAgICAgICAgICAgICAgICAgIExFRlQgSk9JTiBSU19nb29kcwogICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19nb29kcy5pZCA9IFJTX2JhcmNvZGVzLmlkX2dvb2QKICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfcHJvcGVydGllcwogICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19wcm9wZXJ0aWVzLmlkID0gUlNfYmFyY29kZXMuaWRfcHJvcGVydHkKICAgICAgICAgICAgICAgICAgICBMRUZUIEpPSU4gUlNfdW5pdHMKICAgICAgICAgICAgICAgICAgICAgICAgT04gUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICAgICAgICAgICAgICAgICAgTEVGVCBKT0lOIFJTX3NlcmllcwogICAgICAgICAgICAgICAgICAgICAgICBPTiBSU19zZXJpZXMuaWQgPSBSU19iYXJjb2Rlcy5pZF9zZXJpZXMKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBXSEVSRSB7aWRlbnRpZnlfZmllbGR9ID0gJ3tpZGVudGlmeV92YWx1ZX0nCiAgICAgICAgICAgICAgICAgICAgIiIiCgogICAgICAgIHJldHVybiBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgJycpCgogICAgZGVmIGdldF92YWx1ZXNfYnlfZmllbGQoc2VsZiwgdGFibGVfbmFtZSwgZmllbGQsIGZpZWxkX3ZhbHVlKToKICAgICAgICBzZWxmLnByb3ZpZGVyLnRhYmxlX25hbWUgPSB0YWJsZV9uYW1lCiAgICAgICAgcmV0dXJuIHNlbGYucHJvdmlkZXIuc2VsZWN0KHtmaWVsZDogZmllbGRfdmFsdWV9KQoKICAgIGRlZiBnZXRfcXVlcnlfd2l0aF9hcmdfbGlzdChzZWxmLCB0YWJsZV9uYW1lLCB2YWx1ZSwgZmllbGQsIHRhYmxlX3N0cmluZ19pZCk6CiAgICAgICAgcXVlcnlfdGV4dCA9IGYiIiJTRUxFQ1QgaWZudWxsKHt2YWx1ZX0sICctJykgYXMge3ZhbHVlfSBGUk9NIHt0YWJsZV9uYW1lfSBXSEVSRSB7ZmllbGR9IGluICh7dGFibGVfc3RyaW5nX2lkfSkiIiIKICAgICAgICAjIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICAjIHJldHVybiBzZWxmLl9zcWxfcXVlcnkocXVlcnlfdGV4dCwgdGFibGVfbmFtZT10YWJsZV9uYW1lLCBwYXJhbXM9JycpCiAgICAgICAgcmV0dXJuIHF1ZXJ5X3RleHQKCiAgICBkZWYgZ2V0X3NlbGVjdF9kYXRhKHNlbGYsIHRhYmxlX25hbWUpOgogICAgICAgIHF1ZXJ5X3RleHQgPSBmJ1NFTEVDVCAqIEZST00ge3RhYmxlX25hbWV9JwogICAgICAgIHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICByZXR1cm4gc2VsZi5fc3FsX3F1ZXJ5KHF1ZXJ5X3RleHQsICcnKQoKCmNsYXNzIERiQ3JlYXRvcihEYlNlcnZpY2UpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQoKICAgIGRlZiBjcmVhdGVfdGFibGVzKHNlbGYpOgogICAgICAgIGltcG9ydCBkYXRhYmFzZV9pbml0X3F1ZXJ5ZXMKICAgICAgICAjINCh0L7Qt9C00LDQtdC8INGC0LDQsdC70LjRhtGLINC10YHQu9C4INC40YUg0L3QtdGCCiAgICAgICAgc2NoZW1hID0gZGF0YWJhc2VfaW5pdF9xdWVyeWVzLmRhdGFiYXNlX3NoZW1hKCkKICAgICAgICBmb3IgZWwgaW4gc2NoZW1hOgogICAgICAgICAgICBnZXRfcXVlcnlfcmVzdWx0KGVsKQoKICAgIGRlZiBkcm9wX2FsbF90YWJsZXMoc2VsZik6CiAgICAgICAgdGFibGVzID0gc2VsZi5nZXRfYWxsX3RhYmxlcygpCgogICAgICAgIGZvciB0YWJsZSBpbiB0YWJsZXM6CiAgICAgICAgICAgIHNlbGYuX3NxbF9xdWVyeShmJ0RST1AgVEFCTEUge3RhYmxlfScpCgogICAgZGVmIGdldF9hbGxfdGFibGVzKHNlbGYpOgogICAgICAgIHEgPSAnJycKICAgICAgICAgICAgU0VMRUNUIAogICAgICAgICAgICAgICAgbmFtZSAKICAgICAgICAgICAgRlJPTSAKICAgICAgICAgICAgICAgIHNxbGl0ZV9tYXN0ZXIKICAgICAgICAgICAgV0hFUkUgCiAgICAgICAgICAgICAgICB0eXBlPSd0YWJsZScgQU5EIAogICAgICAgICAgICAgICAgbmFtZSBOT1QgTElLRSAnc3FsaXRlXyUnCiAgICAgICAgJycnCiAgICAgICAgdGFibGVzID0gc2VsZi5fc3FsX3F1ZXJ5KHEpCgogICAgICAgIHJldHVybiBbdGFibGVbJ25hbWUnXSBmb3IgdGFibGUgaW4gdGFibGVzXQoKCmNsYXNzIFVuaXZlcnNhbENhcmRzU2VydmljZShEYlNlcnZpY2UpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYudGFibGVfbmFtZTogc3RyCiAgICAgICAgc2VsZi5maWx0ZXJfZmllbGRzID0gW10KICAgICAgICBzZWxmLmZpbHRlcl92YWx1ZSA9ICcnCiAgICAgICAgc2VsZi5leGNsdWRlX2xpc3QgPSBbXQogICAgICAgIHNlbGYubm9fbGFiZWwgPSBGYWxzZQogICAgICAgIHNlbGYudGFibGVfbmFtZXMgPSBzZWxmLl90YWJsZV9uYW1lc19kaWN0KCkKCiAgICBkZWYgZ2V0X3ZpZXdzX2RhdGEoc2VsZiwgdGFibGVfbmFtZTogc3RyKToKICAgICAgICBmaWVsZHMgPSBzZWxmLl9nZXRfZmllbGRzKHRhYmxlX25hbWUpCiAgICAgICAgZmllbGRzX2xpbmtzID0ge30KICAgICAgICBxX2ZpZWxkcyA9IFtdCiAgICAgICAgcV9qb2lucyA9IFtdCiAgICAgICAgcV9jb25kaXRpb25zID0gWyd0cnVlJ10KCiAgICAgICAgZm9yIGZpZWxkIGluIGZpZWxkczoKICAgICAgICAgICAgaWYgZmllbGQgaW4gc2VsZi5leGNsdWRlX2xpc3Q6CiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgcV9maWVsZHMuYXBwZW5kKCd7fS57fSBBUyB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgdGFibGVfbmFtZSwgZmllbGQsICdrZXknIGlmIGZpZWxkID09ICdpZCcgZWxzZSBmaWVsZCkpCgogICAgICAgICAgICBsaW5rX3RhYmxlX25hbWUgPSBzZWxmLnRhYmxlX25hbWVzLmdldChmaWVsZCkKICAgICAgICAgICAgaWYgbGlua190YWJsZV9uYW1lOgogICAgICAgICAgICAgICAgcV9maWVsZHMuYXBwZW5kKGYne2xpbmtfdGFibGVfbmFtZX0ubmFtZSBhcyB7bGlua190YWJsZV9uYW1lfV9uYW1lJykKICAgICAgICAgICAgICAgIHFfam9pbnMuYXBwZW5kKCdMRUZUIEpPSU4ge30gT04ge30uaWQgPSB7fS57fScuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGxpbmtfdGFibGVfbmFtZSwgbGlua190YWJsZV9uYW1lLCB0YWJsZV9uYW1lLCBmaWVsZAogICAgICAgICAgICAgICAgKSkKCiAgICAgICAgICAgICAgICBmaWVsZHNfbGlua3NbZmllbGRdID0gZid7bGlua190YWJsZV9uYW1lfV9uYW1lJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZmllbGRzX2xpbmtzW2ZpZWxkXSA9ICdrZXknIGlmIGZpZWxkID09ICdpZCcgZWxzZSBmaWVsZAoKICAgICAgICBpZiBzZWxmLmZpbHRlcl92YWx1ZToKICAgICAgICAgICAgcV9jb25kaXRpb25zID0gW2Yie3RhYmxlX25hbWV9LntmaWVsZH0gTElLRSAnJXtzZWxmLmZpbHRlcl92YWx1ZX0lJyIgZm9yIGZpZWxkIGluIHNlbGYuZmlsdGVyX2ZpZWxkc10KCiAgICAgICAgcSA9ICcnJ1NFTEVDVCB7fSAKICAgICAgICAgICAgICAgIEZST00ge30KICAgICAgICAgICAgICAgIHt9CiAgICAgICAgICAgICAgICBXSEVSRSB7fQogICAgICAgICcnJy4gZm9ybWF0KCcsJy5qb2luKHFfZmllbGRzKSwgdGFibGVfbmFtZSwgJyAnLmpvaW4ocV9qb2lucyksICcgT1IgJy5qb2luKHFfY29uZGl0aW9ucykpCgogICAgICAgIHJldHVybiBmaWVsZHNfbGlua3MsIHNlbGYuX3NxbF9xdWVyeShxKQoKICAgIGRlZiBfZ2V0X2ZpZWxkcyhzZWxmLCB0YWJsZV9uYW1lKSAtPiBMaXN0W3N0cl06CiAgICAgICAgIiIiCiAgICAgICAgOnBhcmFtIHRhYmxlX25hbWU6CiAgICAgICAgOnJldHVybiBsaXN0IGNvbHVtbiBuYW1lczoKICAgICAgICAiIiIKICAgICAgICBxID0gZidQUkFHTUEgdGFibGVfaW5mbyh7dGFibGVfbmFtZX0pJwogICAgICAgIHJlcyA9IHNlbGYuX3NxbF9xdWVyeShxLCB0YWJsZV9uYW1lPXRhYmxlX25hbWUpCgogICAgICAgIHJldHVybiBbcm93WyduYW1lJ10gZm9yIHJvdyBpbiByZXNdCgogICAgZGVmIF90YWJsZV9uYW1lc19kaWN0KHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdpZF9nb29kJzogJ1JTX2dvb2RzJywKICAgICAgICAgICAgJ3R5cGVfZ29vZCc6ICdSU190eXBlc19nb29kcycsCiAgICAgICAgICAgICd1bml0JzogJ1JTX3VuaXRzJywKICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogJ1JTX3Byb3BlcnRpZXMnLAogICAgICAgICAgICAnaWRfc2VyaWVzJzogJ1JTX3NlcmllcycsCiAgICAgICAgICAgICdpZF91bml0JzogJ1JTX3VuaXRzJywKICAgICAgICAgICAgJ2lkX2NvdW50cmFnZW50cyc6ICdSU19jb3VudHJhZ2VudHMnLAogICAgICAgICAgICAnaWRfd2FyZWhvdXNlJzogJ1JTX3dhcmVob3VzZXMnLAogICAgICAgICAgICAnaWRfZG9jJzogJ1JTX2RvY3MnLAogICAgICAgICAgICAnaWRfY2VsbCc6ICdSU19jZWxscycsCiAgICAgICAgICAgICdpZF9vd25lcic6ICdSU19nb29kcycsCiAgICAgICAgICAgICdpZF9wcmljZV90eXBlcyc6ICdSU19wcmljZV90eXBlcycKICAgICAgICB9CgpjbGFzcyBTcWxRdWVyeVByb3ZpZGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRhYmxlX25hbWU9JycsIHNxbF9jbGFzcz1zcWxDbGFzcygpLCBkZWJ1Zz1GYWxzZSk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgICMgc2VsZi5zcWwgPSBzcWxfY2xhc3MKICAgICAgICBzZWxmLnNxbCA9IHNlbGYKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gJycKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBOb25lCiAgICAgICAgc2VsZi5kZWJ1ZyA9IGRlYnVnCgogICAgQHByb3BlcnR5CiAgICBkZWYgdGFibGVfbmFtZShzZWxmKToKICAgICAgICBpZiBzZWxmLl90YWJsZV9uYW1lOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fdGFibGVfbmFtZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoZid7c2VsZn06IHRhYmxlX25hbWUgbXVzdCBiZSBzcGVjaWZpZWQnKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidTcWxRdWVyeVByb3ZpZGVyKHRhYmxlX25hbWU9e3NlbGYuX3RhYmxlX25hbWV9KScKCiAgICBAdGFibGVfbmFtZS5zZXR0ZXIKICAgIGRlZiB0YWJsZV9uYW1lKHNlbGYsIHYpOgogICAgICAgIHNlbGYuX3RhYmxlX25hbWUgPSB2CgogICAgZGVmIGNyZWF0ZShzZWxmLCBkYXRhKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSkKCiAgICAgICAgcmV0dXJuIHNlbGYuX2V4ZWNfY3JlYXRlKAogICAgICAgICAgICBjb2x1bW5zPXF1ZXJ5X2RhdGFbJ2NvbHVtbnMnXSwKICAgICAgICAgICAgcGFyYW1zPXF1ZXJ5X2RhdGFbJ3BhcmFtcyddCiAgICAgICAgKQoKICAgIGRlZiByZXBsYWNlKHNlbGYsIGRhdGEpOgogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcXVlcnlfZGF0YSA9IHNlbGYuX2NvbnZlcnRfcXVlcnlfZGF0YShkYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19yZXBsYWNlKAogICAgICAgICAgICBjb2x1bW5zPXF1ZXJ5X2RhdGFbJ2NvbHVtbnMnXSwKICAgICAgICAgICAgcGFyYW1zPXF1ZXJ5X2RhdGFbJ3BhcmFtcyddCiAgICAgICAgKQoKICAgIGRlZiB1cGRhdGUoc2VsZiwgZGF0YSwgX2ZpbHRlcj1Ob25lKToKICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIGZpbHRlcl9kYXRhID0gW10KICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBsaXN0KF9maWx0ZXIudmFsdWVzKCkpCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoZGF0YSwgZmlsdGVyX2RhdGE9ZmlsdGVyX2RhdGEpCgogICAgICAgIHJldHVybiBzZWxmLl9leGVjX3VwZGF0ZSgKICAgICAgICAgICAgY29sdW1ucz1xdWVyeV9kYXRhWydjb2x1bW5zJ10sCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXSwKICAgICAgICAgICAgd2hlcmU9d2hlcmUKICAgICAgICApCgogICAgZGVmIGRlbGV0ZShzZWxmLCBfZmlsdGVyPU5vbmUpOgogICAgICAgIHdoZXJlID0gTm9uZQogICAgICAgIGZpbHRlcl9kYXRhID0gW10KICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBsaXN0KF9maWx0ZXIudmFsdWVzKCkpCgogICAgICAgIHF1ZXJ5X2RhdGEgPSBzZWxmLl9jb252ZXJ0X3F1ZXJ5X2RhdGEoe30sIGZpbHRlcl9kYXRhPWZpbHRlcl9kYXRhKQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19kZWxldGUoCiAgICAgICAgICAgIHBhcmFtcz1xdWVyeV9kYXRhWydwYXJhbXMnXSwKICAgICAgICAgICAgd2hlcmU9d2hlcmUKICAgICAgICApCgogICAgZGVmIHNlbGVjdChzZWxmLCBfZmlsdGVyPU5vbmUpIC0+IGxpc3Q6CiAgICAgICAgd2hlcmUgPSBOb25lCiAgICAgICAgcGFyYW1zID0gJycKICAgICAgICBpZiBfZmlsdGVyOgogICAgICAgICAgICB3aGVyZSA9IGxpc3QoX2ZpbHRlcikKICAgICAgICAgICAgcGFyYW1zID0gW3N0cih2KSBmb3IgdiBpbiBfZmlsdGVyLnZhbHVlcygpXQoKICAgICAgICByZXR1cm4gc2VsZi5fZXhlY19zZWxlY3QoCiAgICAgICAgICAgIHBhcmFtcz1wYXJhbXMsCiAgICAgICAgICAgIHdoZXJlPXdoZXJlLAogICAgICAgICkKCiAgICBkZWYgX2V4ZWNfY3JlYXRlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcyk6CiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsJy5qb2luKCc/JyAqIGxlbihjb2x1bW5zKSkKICAgICAgICBzdHJfa2V5cyA9ICcsICcuam9pbihbZid7bmFtZX0nIGZvciBuYW1lIGluIGNvbHVtbnNdKQoKICAgICAgICBxID0gZidJTlNFUlQgSU5UTyB7c2VsZi50YWJsZV9uYW1lfSAoe3N0cl9rZXlzfSkgVkFMVUVTICh7c3RyX3ZhbHVlc30pJwoKICAgICAgICBwYXJhbXMgPSBqc29uLmR1bXBzKHBhcmFtcywgZW5zdXJlX2FzY2lpPUZhbHNlKQogICAgICAgIHJldHVybiBzZWxmLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfZXhlY19yZXBsYWNlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcyk6CiAgICAgICAgc3RyX2NvbHVtbnMgPSAnLCAnLmpvaW4oY29sdW1ucykKICAgICAgICBzdHJfdmFsdWVzID0gJywnLmpvaW4oJz8nICogbGVuKGNvbHVtbnMpKQoKICAgICAgICBxID0gZidSRVBMQUNFIElOVE8ge3NlbGYudGFibGVfbmFtZX0gKHtzdHJfY29sdW1uc30pIFZBTFVFUyAoe3N0cl92YWx1ZXN9KScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfdXBkYXRlKHNlbGYsIGNvbHVtbnMsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgc3RyX3ZhbHVlcyA9ICcsICcuam9pbihbZid7bmFtZX09PycgZm9yIG5hbWUgaW4gY29sdW1uc10pCgogICAgICAgIHEgPSBmJ1VQREFURSB7c2VsZi50YWJsZV9uYW1lfSBTRVQge3N0cl92YWx1ZXN9IFdIRVJFIHtzdHJfd2hlcmV9JwoKICAgICAgICBwYXJhbXMgPSBqc29uLmR1bXBzKHBhcmFtcywgZW5zdXJlX2FzY2lpPUZhbHNlKQogICAgICAgIHJldHVybiBzZWxmLnNxbF9leGVjX21hbnkocSwgcGFyYW1zKQoKICAgIGRlZiBfZXhlY19kZWxldGUoc2VsZiwgcGFyYW1zLCB3aGVyZT1Ob25lKToKICAgICAgICBpZiB3aGVyZToKICAgICAgICAgICAgc3RyX3doZXJlID0gJyBhbmQgJy5qb2luKFtmJ3trZXl9PT8nIGZvciBrZXkgaW4gd2hlcmVdKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICd0cnVlJwoKICAgICAgICBxID0gZidERUxFVEUgRlJPTSB7c2VsZi50YWJsZV9uYW1lfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0ganNvbi5kdW1wcyhwYXJhbXMsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICByZXR1cm4gc2VsZi5zcWxfZXhlY19tYW55KHEsIHBhcmFtcykKCiAgICBkZWYgX2V4ZWNfc2VsZWN0KHNlbGYsIHBhcmFtcywgd2hlcmU9Tm9uZSk6CiAgICAgICAgaWYgd2hlcmU6CiAgICAgICAgICAgIHN0cl93aGVyZSA9ICcgYW5kICcuam9pbihbZid7a2V5fT0/JyBmb3Iga2V5IGluIHdoZXJlXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdHJfd2hlcmUgPSAndHJ1ZScKCiAgICAgICAgcSA9IGYnU0VMRUNUICogRlJPTSB7c2VsZi50YWJsZV9uYW1lfSBXSEVSRSB7c3RyX3doZXJlfScKCiAgICAgICAgcGFyYW1zID0gJywgJy5qb2luKHBhcmFtcykKICAgICAgICByZXR1cm4gc2VsZi5zcWxfcXVlcnkocSwgcGFyYW1zKQoKICAgIGRlZiBzcWxfZXhlY19tYW55KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgbm90IHNlbGYuZGVidWc6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnNxbC5TUUxFeGVjTWFueShxLCBwYXJhbXMpCgogICAgZGVmIHNxbF9leGVjKHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgbm90IHNlbGYuZGVidWc6CiAgICAgICAgICAgIHJldHVybiBzZWxmLnNxbC5TUUxFeGVjKHEsIHBhcmFtcz1wYXJhbXMpCgogICAgZGVmIHNxbF9xdWVyeShzZWxmLCBxLCBwYXJhbXM6IHN0ciA9ICcnKSAtPiBMaXN0W2RpY3RdOgogICAgICAgIHNlbGYuc3FsX3RleHQgPSBxCiAgICAgICAgc2VsZi5zcWxfcGFyYW1zID0gcGFyYW1zCgogICAgICAgIGlmIG5vdCBzZWxmLmRlYnVnOgogICAgICAgICAgICByZXN1bHQgPSBzZWxmLnNxbC5TUUxRdWVyeShxLCBwYXJhbXMpCiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWRzKHJlc3VsdCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2NvbnZlcnRfcXVlcnlfZGF0YShkYXRhLCBmaWx0ZXJfZGF0YT1Ob25lKToKICAgICAgICBjb2x1bW5zID0gW10KICAgICAgICBwYXJhbXMgPSBbXQogICAgICAgIGlmIG5vdCBmaWx0ZXJfZGF0YToKICAgICAgICAgICAgZmlsdGVyX2RhdGEgPSBbXQoKICAgICAgICBpZiBpc2luc3RhbmNlKGRhdGEsIGxpc3QpOgogICAgICAgICAgICBjb2x1bW5zID0gbGlzdChkYXRhWzBdKQogICAgICAgICAgICBmb3Igcm93IGluIGRhdGE6CiAgICAgICAgICAgICAgICBwYXJhbXMuYXBwZW5kKFt2IGZvciB2IGluIHJvdy52YWx1ZXMoKV0gKyBmaWx0ZXJfZGF0YSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UoZGF0YSwgZGljdCk6CiAgICAgICAgICAgIGNvbHVtbnMgPSBsaXN0KGRhdGEpCiAgICAgICAgICAgIHBhcmFtcyA9IFtbdiBmb3IgdiBpbiBkYXRhLnZhbHVlcygpXSArIGZpbHRlcl9kYXRhXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIFZhbHVlRXJyb3IoZidkYXRhIG11c3QgYmUgbGlzdCBvciBkaWN0LCBub3Qge3R5cGUoZGF0YSl9JykKCiAgICAgICAgcmV0dXJuIHsnY29sdW1ucyc6IGNvbHVtbnMsICdwYXJhbXMnOiBwYXJhbXN9CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNvbnZlcnRfc3FsX3BhcmFtcyhzcWxfcXVlcnksIHBhcmFtc19kaWN0KToKICAgICAgICBpbXBvcnQgcmUKICAgICAgICBwYXJhbV92YWx1ZXMgPSBbXQoKICAgICAgICBkZWYgcmVwbGFjZV9uYW1lZF9wYXJhbShtYXRjaCk6CiAgICAgICAgICAgIHBhcmFtX25hbWUgPSBtYXRjaC5ncm91cCgxKQoKICAgICAgICAgICAgcGFyYW1fdmFsdWVzLmFwcGVuZChwYXJhbXNfZGljdFtwYXJhbV9uYW1lXSkKCiAgICAgICAgICAgIHJldHVybiAiPyIKCiAgICAgICAgbmV3X3F1ZXJ5ID0gcmUuc3ViKHInOihcdyspJywgcmVwbGFjZV9uYW1lZF9wYXJhbSwgc3FsX3F1ZXJ5KQoKICAgICAgICByZXR1cm4gbmV3X3F1ZXJ5LCBwYXJhbV92YWx1ZXMKCiAgICAjINC80LXRgtC+0LTRiyDQvdC40LbQtSDQtNC+0LHQsNCy0LvQtdC90Ysg0LTQu9GPINCy0YDQtdC80LXQvdC90L7Qs9C+INGA0LXRiNC10L3QuNGPINC/0YDQvtCx0LvQtdC80YsgU1FMUHJvdmlkZXIg0L3QsCA5INCw0L3QtNGA0L7QuNC00LUKICAgIGRlZiBTUUxFeGVjKHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgcGFyYW1zOgogICAgICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhnZXRfcXVlcnlfcmVzdWx0KHEsIHR1cGxlKHBhcmFtcy5zcGxpdCgnLCcpKSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxKSkKCiAgICBkZWYgU1FMRXhlY01hbnkoc2VsZiwgcSwgcGFyYW1zKToKICAgICAgICBzZWxmLnNxbF90ZXh0ID0gcQogICAgICAgIHNlbGYuc3FsX3BhcmFtcyA9IHBhcmFtcwoKICAgICAgICByZXR1cm4gYnVsa19xdWVyeShxLCBqc29uLmxvYWRzKHBhcmFtcykpCgogICAgZGVmIFNRTFF1ZXJ5KHNlbGYsIHEsIHBhcmFtcyk6CiAgICAgICAgc2VsZi5zcWxfdGV4dCA9IHEKICAgICAgICBzZWxmLnNxbF9wYXJhbXMgPSBwYXJhbXMKCiAgICAgICAgaWYgcGFyYW1zOgogICAgICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhnZXRfcXVlcnlfcmVzdWx0KHEsIHR1cGxlKHBhcmFtcy5zcGxpdCgnLCcpKSwgcmV0dXJuX2RpY3Q9VHJ1ZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoZ2V0X3F1ZXJ5X3Jlc3VsdChxLCByZXR1cm5fZGljdD1UcnVlKSkK"
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\hs_services.py",
                "PyFileKey": "hs_services",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IE9wdGlvbmFsLCBDYWxsYWJsZSwgVW5pb24KZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdGlueV9kYl9zZXJ2aWNlcyBpbXBvcnQgTG9nZ2VyU2VydmljZQoKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmZyb20gcmVxdWVzdHMuYXV0aCBpbXBvcnQgSFRUUEJhc2ljQXV0aAoKCmNsYXNzIEhzU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBodHRwX3BhcmFtcyk6CiAgICAgICAgc2VsZi51cmwgPSBodHRwX3BhcmFtc1sndXJsJ10KICAgICAgICBzZWxmLnVzZXJuYW1lID0gaHR0cF9wYXJhbXNbJ3VzZXInXQogICAgICAgIHNlbGYucGFzc3dvcmQgPSBodHRwX3BhcmFtc1sncGFzcyddCiAgICAgICAgc2VsZi5hbmRyb2lkX2lkID0gaHR0cF9wYXJhbXNbJ2FuZHJvaWRfaWQnXQogICAgICAgIHNlbGYuZGV2aWNlX21vZGVsID0gaHR0cF9wYXJhbXNbJ2RldmljZV9tb2RlbCddCiAgICAgICAgc2VsZi51c2VyX25hbWUgPSBodHRwX3BhcmFtc1sndXNlcl9uYW1lJ10KICAgICAgICBzZWxmLnBhcmFtcyA9IHsndXNlcl9uYW1lJzogc2VsZi51c2VyX25hbWUsICdkZXZpY2VfbW9kZWwnOiBzZWxmLmRldmljZV9tb2RlbH0KICAgICAgICBzZWxmLl9ocyA9ICcnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5hdXRoID0gSFRUUEJhc2ljQXV0aChzZWxmLnVzZXJuYW1lLCBzZWxmLnBhc3N3b3JkKQogICAgICAgIHNlbGYuaGVhZGVycyA9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD11dGYtOCd9CiAgICAgICAgc2VsZi5odHRwX2Fuc3dlcjogT3B0aW9uYWxbSHNTZXJ2aWNlLkh0dHBBbnN3ZXJdID0gTm9uZQogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2UgPSBMb2dnZXJTZXJ2aWNlKCkKCiAgICBkZWYgZ2V0X3RlbXBsYXRlcyhzZWxmLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5faHMgPSAnbGFiZWxfdGVtcGxhdGVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbi5sb2FkcyhhbnN3ZXJbJ3RleHQnXSkKICAgICAgICAgICAgI3JldHVybiBqc29uX2RhdGEKICAgICAgICBlbGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgIHByaW50KGFuc3dlcikKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXJbJ3JlYXNvbiddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXIuZ2V0KCd0ZXh0JykKCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfZGF0YShzZWxmLCAqKmt3YXJncykgLT4gZGljdDoKICAgICAgICBzZWxmLl9ocyA9ICdkYXRhJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyWyd0ZXh0J10pCiAgICAgICAgICAgIGZvcm1hdF9kYXRhID0ganNvbl9kYXRhLmdldCgnZm9ybWF0JykKCiAgICAgICAgICAgIGlmIGZvcm1hdF9kYXRhOgogICAgICAgICAgICAgICAgYW5zd2VyWydmb3JtYXQnXSA9IGZvcm1hdF9kYXRhCiAgICAgICAgICAgICAgICBpZiAnaXNfb2snID09IGZvcm1hdF9kYXRhIGFuZCBqc29uX2RhdGEuZ2V0KCdiYXRjaCcpOgogICAgICAgICAgICAgICAgICAgICMg0J3QsNGIINC30LDQv9GA0L7RgSDQv9GA0LjQvdGP0YIsINC90L4g0LLQtdGA0L3Rg9GC0Ywg0L/QvtC60LAg0L3QtdGH0LXQs9C+LiDQlNCw0L3QvdGL0LUg0LjQu9C4INCz0L7RgtC+0LLRj9GC0YHRjyDQuNC70Lgg0LjRhSDQvdC10YIKICAgICAgICAgICAgICAgICAgICBhbnN3ZXJbJ2JhdGNoJ10gPSBqc29uX2RhdGEuZ2V0KCdiYXRjaCcpCgogICAgICAgICAgICAgICAgZWxpZiBmb3JtYXRfZGF0YSA9PSAnaXNfZGF0YSc6CiAgICAgICAgICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGFbJ2RhdGEnXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydmb3JtYXQnXSA9IE5vbmUKICAgICAgICBlbGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgIHByaW50KGFuc3dlcikKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXJbJ3JlYXNvbiddCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYW5zd2VyWydlcnJvcl9wb29sJ10gPSBhbnN3ZXIuZ2V0KCd0ZXh0JykKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jOiBzdHIsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5wYXJhbXNbJ2lkX2RvYyddID0gaWRfZG9jCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBkYXRhLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIHNlbGYucGFyYW1zWydpZF9kb2MnXSA9IGlkX2RvYwoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgc2VuZF9hbGxfZG9jdW1lbnRfbGluZXMoc2VsZiwgaWRfZG9jLCBkYXRhLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKCiAgICAgICAgc2VsZi5faHMgPSAnZG9jdW1lbnRfbGluZXNfcmV3cml0ZScKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CiAgICAgICAgc2VsZi5wYXJhbXNbJ2lkX2RvYyddID0gaWRfZG9jCgogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgaWYgYW5zd2VyWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAganNvbl9kYXRhID0ganNvbi5sb2FkcyhhbnN3ZXIuZ2V0KCd0ZXh0JykpCiAgICAgICAgICAgIGFuc3dlclsnZGF0YSddID0ganNvbl9kYXRhCgogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQoKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiByZXNldF9leGNoYW5nZShzZWxmLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5faHMgPSAncmVzZXRfZXhjaGFuZ2UnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBjcmVhdGVfbWVzc2FnZXMoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBjb21tdW5pY2F0aW9uX3Rlc3Qoc2VsZiwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgc2VsZi5faHMgPSAnY29tbXVuaWNhdGlvbl90ZXN0JwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLmdldAogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIGFuc3dlcgoKICAgIGRlZiBnZXRfYmFsYW5jZXNfZ29vZHMoc2VsZiwgaWRfd2FyZWhvdXNlPUZhbHNlLCBpZF9jZWxsPUZhbHNlLCBpZF9nb29kPUZhbHNlLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgcGFyYW1zID0ge30KICAgICAgICBpZiBpZF9nb29kOgogICAgICAgICAgICBwYXJhbXNbJ2lkX2dvb2QnXSA9IGlkX2dvb2QKICAgICAgICBpZiBpZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9ocyA9ICdnb29kX2JhbGFuY2VzL2NlbGxzJwogICAgICAgICAgICBwYXJhbXNbJ2lkX2NlbGwnXSA9IGlkX2NlbGwKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9ocyA9ICdnb29kX2JhbGFuY2VzL3dhcmVob3VzZXMnCiAgICAgICAgICAgIGlmIGlkX3dhcmVob3VzZToKICAgICAgICAgICAgICAgIHBhcmFtc1snaWRfd2FyZWhvdXNlJ10gPSBpZF93YXJlaG91c2UKICAgICAgICBzZWxmLnBhcmFtcyA9IHBhcmFtcwogICAgICAgIGFuc3dlciA9IHNlbGYuX3NlbmRfcmVxdWVzdChrd2FyZ3MpCgogICAgICAgIGlmIGFuc3dlclsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGpzb25fZGF0YSA9IGpzb24ubG9hZHMoYW5zd2VyLmdldCgndGV4dCcpKQogICAgICAgICAgICBhbnN3ZXJbJ2RhdGEnXSA9IGpzb25fZGF0YQoKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBnZXRfcHJpY2VzX2dvb2RzKHNlbGYsIGlkX2dvb2QsIGlkX3Byb3BlcnR5PUZhbHNlLCBpZF91bml0PUZhbHNlLCBpZF9wcmljZV90eXBlPUZhbHNlLCAqKmt3YXJncyk6CiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMuZ2V0CiAgICAgICAgc2VsZi5faHMgPSAnZ29vZF9wcmljZXMnCiAgICAgICAgcGFyYW1zID0geydpZF9nb29kJzogaWRfZ29vZH0KICAgICAgICBpZiBpZF9wcm9wZXJ0eToKICAgICAgICAgICAgcGFyYW1zWydpZF9wcm9wZXJ0eSddID0gaWRfcHJvcGVydHkKICAgICAgICBpZiBpZF91bml0OgogICAgICAgICAgICBwYXJhbXNbJ2lkX3VuaXQnXSA9IGlkX3VuaXQKICAgICAgICBpZiBpZF9wcmljZV90eXBlOgogICAgICAgICAgICBwYXJhbXNbJ2lkX3ByaWNlX3R5cGUnXSA9IGlkX3ByaWNlX3R5cGUKCiAgICAgICAgc2VsZi5wYXJhbXMgPSBwYXJhbXMKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQoKICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gPT0gMjAwOgogICAgICAgICAgICBqc29uX2RhdGEgPSBqc29uLmxvYWRzKGFuc3dlci5nZXQoJ3RleHQnKSkKICAgICAgICAgICAgYW5zd2VyWydkYXRhJ10gPSBqc29uX2RhdGEKCiAgICAgICAgc2VsZi5odHRwX2Fuc3dlciA9IHNlbGYuX2NyZWF0ZV9odHRwX2Fuc3dlcihhbnN3ZXIpCiAgICAgICAgcmV0dXJuIHNlbGYuaHR0cF9hbnN3ZXIKCiAgICBkZWYgc2VuZF9kb2N1bWVudHMoc2VsZiwgZGF0YSwgKiprd2FyZ3MpIC0+IGRpY3Q6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybiB7J2VtcHR5JzogVHJ1ZX0KCiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdkb2N1bWVudHMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgc2VuZF9kYXRhKHNlbGYsIGRhdGEsICoqa3dhcmdzKSAtPiAnSHR0cEFuc3dlcic6CiAgICAgICAga3dhcmdzWydkYXRhJ10gPSBkYXRhIGlmIGlzaW5zdGFuY2UoZGF0YSwgc3RyKSBlbHNlIGpzb24uZHVtcHMoZGF0YSkKICAgICAgICBzZWxmLl9ocyA9ICdkb2N1bWVudHMnCiAgICAgICAgc2VsZi5fbWV0aG9kID0gcmVxdWVzdHMucG9zdAoKICAgICAgICBhbnN3ZXIgPSBzZWxmLl9zZW5kX3JlcXVlc3Qoa3dhcmdzKQogICAgICAgIHNlbGYuaHR0cF9hbnN3ZXIgPSBzZWxmLl9jcmVhdGVfaHR0cF9hbnN3ZXIoYW5zd2VyKQogICAgICAgIHJldHVybiBzZWxmLmh0dHBfYW5zd2VyCgogICAgZGVmIHNlbmRfYmFyY29kZXMoc2VsZiwgZGF0YTogbGlzdCwgKiprd2FyZ3MpIC0+ICdIdHRwQW5zd2VyJzoKICAgICAgICAiIiIKICAgICAgICA6cGFyYW0gZGF0YTogZGljdCAoJ2JhcmNvZGUnLCAnaWRfZ29vZCcsICdpZF9wcm9wZXJ0eScsICdpZF91bml0JykKICAgICAgICA6cGFyYW0ga3dhcmdzOiByZXF1ZXN0cyBwb3N0IHBhcmFtcwogICAgICAgIDpyZXR1cm46IEh0dHBBbnN3ZXIKICAgICAgICAiIiIKICAgICAgICBrd2FyZ3NbJ2RhdGEnXSA9IGRhdGEgaWYgaXNpbnN0YW5jZShkYXRhLCBzdHIpIGVsc2UganNvbi5kdW1wcyhkYXRhKQogICAgICAgIHNlbGYuX2hzID0gJ2JhcmNvZGVzJwogICAgICAgIHNlbGYuX21ldGhvZCA9IHJlcXVlc3RzLnBvc3QKCiAgICAgICAgYW5zd2VyID0gc2VsZi5fc2VuZF9yZXF1ZXN0KGt3YXJncykKICAgICAgICBzZWxmLmh0dHBfYW5zd2VyID0gc2VsZi5fY3JlYXRlX2h0dHBfYW5zd2VyKGFuc3dlcikKICAgICAgICByZXR1cm4gc2VsZi5odHRwX2Fuc3dlcgoKICAgIGRlZiBfc2VuZF9yZXF1ZXN0KHNlbGYsIGt3YXJncykgLT4gZGljdDoKICAgICAgICBhbnN3ZXIgPSB7J2VtcHR5JzogVHJ1ZX0KICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSBzZWxmLl9tZXRob2QoZid7c2VsZi51cmx9L3NpbXBsZV9hY2NvdW50aW5nL3tzZWxmLl9oc30/YW5kcm9pZF9pZD17c2VsZi5hbmRyb2lkX2lkfScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aD1zZWxmLmF1dGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1zZWxmLmhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zPXNlbGYucGFyYW1zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBhbnN3ZXJbJ3VybCddID0gci51cmwKICAgICAgICAgICAgYW5zd2VyWydyZWFzb24nXSA9IHIucmVhc29uCiAgICAgICAgICAgIGFuc3dlclsndGV4dCddID0gci50ZXh0LmVuY29kZSgidXRmLTgiKQoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW5zd2VyWydqc29uJ10gPSByLmpzb24oKQogICAgICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ2pzb24nXSA9IHt9CgogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhbnN3ZXJbJ0Vycm9yJ10gPSByLnJlYXNvbgogICAgICAgICAgICAgICAgYW5zd2VyWydyZWFzb24nXSA9IHIucmVhc29uCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCiAgICAgICAgICAgICMgYW5zd2VyWydFcnJvciddID0gZS5hcmdzWzBdCgogICAgICAgIHJldHVybiBhbnN3ZXIKCiAgICBkZWYgX2NyZWF0ZV9odHRwX2Fuc3dlcihzZWxmLCBhbnN3ZXI6IGRpY3QpOgogICAgICAgIGFuc3dlcl9kYXRhID0gewogICAgICAgICAgICAnc3RhdHVzX2NvZGUnOiBhbnN3ZXIuZ2V0KCdzdGF0dXNfY29kZScpLAogICAgICAgICAgICAndXJsJzogYW5zd2VyLmdldCgndXJsJyksCiAgICAgICAgICAgICdqc29uJzogYW5zd2VyLmdldCgnanNvbicpCiAgICAgICAgfQoKICAgICAgICBpZiBhbnN3ZXJfZGF0YVsnc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIGFuc3dlcl9kYXRhWydkYXRhJ10gPSBhbnN3ZXIuZ2V0KCdkYXRhJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBhbnN3ZXJfZGF0YVsnZXJyb3InXSA9IFRydWUKICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yX3RleHQnXSA9IGFuc3dlci5nZXQoJ0Vycm9yJykgb3IgYW5zd2VyLmdldCgnZXJyb3InKQogICAgICAgICAgICBpZiBhbnN3ZXJfZGF0YVsnc3RhdHVzX2NvZGUnXSA9PSA0MDE6CiAgICAgICAgICAgICAgICBhbnN3ZXJfZGF0YVsndW5hdXRob3JpemVkJ10gPSBUcnVlCiAgICAgICAgICAgIGVsaWYgYW5zd2VyX2RhdGFbJ3N0YXR1c19jb2RlJ10gPT0gNDAzOgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2ZvcmJpZGRlbiddID0gVHJ1ZQoKICAgICAgICAgICAgaWYgYW5zd2VyLmdldCgndGV4dCcpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGpzb25fcmVzdWx0ID0ganNvbi5sb2FkcyhhbnN3ZXJbJ3RleHQnXSkKICAgICAgICAgICAgICAgICAgICBlcnJvcl90ZXh0ID0ganNvbl9yZXN1bHQuZ2V0KCdlcnJvcicpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dCA9IGFuc3dlclsndGV4dCddLmRlY29kZSgpCgogICAgICAgICAgICAgICAgYW5zd2VyX2RhdGFbJ2Vycm9yX3RleHQnXSA9IGVycm9yX3RleHQKCiAgICAgICAgcmV0dXJuIHNlbGYuSHR0cEFuc3dlcigqKmFuc3dlcl9kYXRhKQoKICAgIGRlZiBnZXRfbWV0aG9kX2J5X3BhdGgoc2VsZiwgcGF0aCkgLT4gVW5pb25bQ2FsbGFibGUsIE5vbmVdOgogICAgICAgIG1ldGhvZHMgPSB7CiAgICAgICAgICAgICdiYXJjb2Rlcyc6IHNlbGYuc2VuZF9iYXJjb2RlcywKICAgICAgICAgICAgJ2RvY3VtZW50cyc6IHNlbGYuc2VuZF9kb2N1bWVudHMKICAgICAgICB9CgogICAgICAgIHJldHVybiBtZXRob2RzLmdldChwYXRoKQoKICAgIGRlZiB3cml0ZV9lcnJvcl90b19sb2coc2VsZiwgZXJyb3JfdGV4dCwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYubG9nZ2VyX3NlcnZpY2Uud3JpdGVfdG9fbG9nKGVycm9yX3RleHQ9ZXJyb3JfdGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl90eXBlPSJIU19zZXJ2aWNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKmt3YXJncykKCiAgICBAZGF0YWNsYXNzCiAgICBjbGFzcyBIdHRwQW5zd2VyOgogICAgICAgIHVybDogc3RyCiAgICAgICAgc3RhdHVzX2NvZGU6IGludAogICAgICAgIGpzb246IE9wdGlvbmFsID0gTm9uZQogICAgICAgIGVycm9yX3RleHQ6IE9wdGlvbmFsW3N0cl0gPSAnJwogICAgICAgIGRhdGE6IE9wdGlvbmFsID0gTm9uZQogICAgICAgIHVuYXV0aG9yaXplZDogYm9vbCA9IEZhbHNlCiAgICAgICAgZm9yYmlkZGVuOiBib29sID0gRmFsc2UKICAgICAgICBlcnJvcjogYm9vbCA9IEZhbHNlCgoKY2xhc3MgRGVidWdTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlwX2hvc3QsIHBvcnQ9MjQ0NCk6CiAgICAgICAgc2VsZi5pcF9ob3N0ID0gaXBfaG9zdAogICAgICAgIHNlbGYucG9ydCA9IHBvcnQKICAgICAgICBzZWxmLnVybCA9IGYnaHR0cDovL3tzZWxmLmlwX2hvc3R9OntzZWxmLnBvcnR9JwogICAgICAgIHNlbGYuX2hzID0gJycKICAgICAgICBzZWxmLl9tZXRob2QgPSByZXF1ZXN0cy5wb3N0CgogICAgZGVmIGV4cG9ydF9kYXRhYmFzZShzZWxmLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHsnU2ltcGxlS2VlcC5kYic6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2ZpbGUoc2VsZiwgZmlsZV9uYW1lLCBmaWxlKToKICAgICAgICBzZWxmLl9ocyA9ICdwb3N0JwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3QoeydmaWxlcyc6IHtmaWxlX25hbWU6IGZpbGV9fSkKCiAgICBkZWYgZXhwb3J0X2xvZyhzZWxmLCBkYXRhKToKICAgICAgICBzZWxmLl9ocyA9ICd1bmxvYWRfbG9nJwogICAgICAgIHJldHVybiBzZWxmLl9zZW5kX3JlcXVlc3Qoeydqc29uJzoganNvbi5kdW1wcyhkYXRhKX0pCgogICAgZGVmIF9zZW5kX3JlcXVlc3Qoc2VsZiwga3dhcmdzKSAtPiBkaWN0OgogICAgICAgIGFuc3dlciA9IHsnZW1wdHknOiBUcnVlfQogICAgICAgIHRyeToKICAgICAgICAgICAgciA9IHNlbGYuX21ldGhvZChmJ3tzZWxmLnVybH0ve3NlbGYuX2hzfScsICoqa3dhcmdzKQoKICAgICAgICAgICAgYW5zd2VyWydzdGF0dXNfY29kZSddID0gci5zdGF0dXNfY29kZQogICAgICAgICAgICBpZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGFuc3dlclsnZW1wdHknXSA9IEZhbHNlCiAgICAgICAgICAgICAgICBhbnN3ZXJbJ3RleHQnXSA9IHIudGV4dC5lbmNvZGUoInV0Zi04IikKICAgICAgICAgICAgICAgIGFuc3dlclsncmVhc29uJ10gPSByLnJlYXNvbgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYW5zd2VyWydFcnJvciddID0gci50ZXh0CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICByYWlzZSBlCgogICAgICAgIHJldHVybiBhbnN3ZXIK"
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\ui_global.py",
                "PyFileKey": "ui_global",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QKaW1wb3J0IHNxbGl0ZTMKZnJvbSBzcWxpdGUzIGltcG9ydCBFcnJvcgppbXBvcnQgb3MKaW1wb3J0IHF1ZXVlCgoKCnF1ZXJ5X2xpc3QgPSBxdWV1ZS5RdWV1ZSgpCiMg0JLQvtGCINGC0LDQutC40Lwg0L3QtdC30LDRgtC10LnQu9C40LLRi9C8INC80LXRgtC+0LTQvtC8INC+0L/RgNC10LTQtdC70Y/QtdC8LCDQvNGLINC30LDQv9GD0YHRgtC40LvQuNGB0Ywg0L3QsCDQutC+0LzQv9C1INC40LvQuCDQvdCwINCi0KHQlCAqKgojINCd0YMg0Lgg0LIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCLCDQuNGB0L/QvtC70YzQt9GD0LXQvCDQsdCw0LfRgyAqKioqCmlmIG9zLnBhdGguZXhpc3RzKCcvL2RhdGEvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS9kYXRhYmFzZXMvJyk6ICPQu9C+0LrQsNC70YzQvdC+CiAgICBkYl9wYXRoID0gJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcy9TaW1wbGVLZWVwJyAgIyByaWdodHNjYW4nCmVsc2U6CiAgICBkYl9wYXRoID0gZmlsZV9hYnNfcGF0aCA9IG9zLnBhdGguYWJzcGF0aCgnLi9TaW1wbGVLZWVwLmRiJykgICMgRDpcUHl0aG9uUHJvamVjdHNcUmlnaHRTY2FuXFNVSV9ub1BvbnlcCgpjb25uID0gTm9uZQoKCgpkZWYgZ2V0X3F1ZXJ5X3Jlc3VsdChxdWVyeV90ZXh0OiBzdHIsIGFyZ3MgPSAiIiwgcmV0dXJuX2RpY3Q9RmFsc2UpIC0+IGxpc3Q6CiAgICAjICoqKioqKioqKioqKioqKioqKioqKioKCiAgICAjIGdsb2JhbCBjb25uCiAgICAjIGdldF9kYXRhYmFzZV9jb25uZWN0aW9uKCkKICAgIHRyeToKICAgICAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KGRiX3BhdGgpCgogICAgZXhjZXB0IEVycm9yOgoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCdObyBjb25uZWN0aW9uIHdpdGggZGF0YWJhc2UnKQoKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHRyeToKICAgICAgICBpZiBhcmdzOgogICAgICAgICAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeV90ZXh0LCBhcmdzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5X3RleHQpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmFpc2UgZQoKICAgICMg0JXRgdC70Lgg0L3QsNC00L4gLSDQstC+0LfQstGA0LDRidCw0LXQvCDQvdC1INGA0LXQt9GD0LvRjNGC0LDRgiDQt9Cw0L/RgNC+0YHQsCwg0LAg0YHQu9C+0LLQsNGA0Ywg0YEg0LjQvNC/0L7RgNGC0LjRgNC+0LLQsNC90L3Ri9C8INGA0LXQt9GD0LvRjNGC0LDRgtC+0LwKICAgIGlmIHJldHVybl9kaWN0OgogICAgICAgIHJlcyA9IFtkaWN0KGxpbmUpIGZvciBsaW5lIGluCiAgICAgICAgICAgICAgIFt6aXAoW2NvbHVtblswXSBmb3IgY29sdW1uIGluIGN1cnNvci5kZXNjcmlwdGlvbl0sIHJvdykgZm9yIHJvdyBpbiBjdXJzb3IuZmV0Y2hhbGwoKV1dCiAgICBlbHNlOgogICAgICAgIHJlcyA9IGN1cnNvci5mZXRjaGFsbCgpCiAgICBjb25uLmNvbW1pdCgpCiAgICBjb25uLmNsb3NlKCkKICAgIHJldHVybiByZXMKCmRlZiBidWxrX3F1ZXJ5KHE6IHN0ciwgYXJnczogTGlzdFt0dXBsZV0pOgogICAgdHJ5OgogICAgICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoZGJfcGF0aCkKICAgIGV4Y2VwdCBzcWxpdGUzLkVycm9yOgogICAgICAgIHJhaXNlIFZhbHVlRXJyb3IoJ05vIGNvbm5lY3Rpb24gd2l0aCBkYXRhYmFzZScpCgogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQoKICAgIHRyeToKICAgICAgICBjdXJzb3IuZXhlY3V0ZW1hbnkocSwgYXJncykKICAgICAgICBjb25uLmNvbW1pdCgpCiAgICBleGNlcHQgc3FsaXRlMy5FcnJvciBhcyBlcjoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGVyKQoKICAgIGNvbm4uY2xvc2UoKQoKCgoKCg=="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\ui_models.py",
                "PyFileKey": "ui_models",
                "PyFileData": "aW1wb3J0IHJlCmZyb20gYWJjIGltcG9ydCBBQkMsIGFic3RyYWN0bWV0aG9kCmltcG9ydCBqc29uCmZyb20ganNvbi5kZWNvZGVyIGltcG9ydCBKU09ORGVjb2RlRXJyb3IKaW1wb3J0IG9zCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aAppbXBvcnQgdGltZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIHR5cGluZyBpbXBvcnQgRGljdCwgTGlzdCwgVHVwbGUsIENhbGxhYmxlCmltcG9ydCBzaHV0aWwKaW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCBoc19zZXJ2aWNlcwpmcm9tIHByaW50aW5nX2ZhY3RvcnkgaW1wb3J0IEhUTUxEb2N1bWVudCwgUHJpbnRTZXJ2aWNlLCBidApmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwLCBnZXRfaXBfYWRkcmVzcwpmcm9tIGJhcmNvZGVfd29ya2VycyBpbXBvcnQgQmFyY29kZVdvcmtlcgpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBEb2NTZXJ2aWNlLCBHb29kc1NlcnZpY2UsIEJhcmNvZGVTZXJ2aWNlLCBUaW1lclNlcnZpY2UKZnJvbSB0aW55X2RiX3NlcnZpY2VzIGltcG9ydCBTY2FubmluZ1F1ZXVlU2VydmljZSwgRXhjaGFuZ2VRdWV1ZUJ1ZmZlciwgTG9nZ2VyU2VydmljZSwgRGF0ZUZvcm1hdApmcm9tIGhzX3NlcnZpY2VzIGltcG9ydCBIc1NlcnZpY2UKaW1wb3J0IHN0YXRpY19kYXRhCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZVV0aWxpdGVzIGFzIHN1Q2xhc3MKCmltcG9ydCB3aWRnZXRzCmltcG9ydCB1aV9nbG9iYWwKaW1wb3J0IGJhc2U2NApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpjdXJyZW50X3NjcmVlbjogJ1NjcmVlbicgPSBOb25lCm5leHRfc2NyZWVuOiAnU2NyZWVuJyA9IE5vbmUKX3JzX3NldHRpbmdzID0gbm9DbGFzcygicnNfc2V0dGluZ3MiKQoKY2xhc3MgU2NyZWVuKEFCQyk6CiAgICBzY3JlZW5fbmFtZTogc3RyCiAgICBwcm9jZXNzX25hbWU6IHN0cgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9X3JzX3NldHRpbmdzKToKICAgICAgICBzZWxmLmhhc2hfbWFwOiBIYXNoTWFwID0gaGFzaF9tYXAKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7fQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MgPSByc19zZXR0aW5ncwogICAgICAgIHNlbGYuZXZlbnQ6IHN0ciA9IHNlbGYuaGFzaF9tYXBbJ2V2ZW50J10KICAgICAgICBzZWxmLmlzX2ZpbmlzaF9wcm9jZXNzID0gRmFsc2UKICAgICAgICBzZWxmLnBhcmVudF9zY3JlZW4gPSBOb25lCiAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVyczogTGlzdFtDYWxsYWJsZV09W10KICAgICAgICBzZWxmLmluaXRfcGFyYW1zID0ge30KCiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLnJlbW92ZShmJ3tzZWxmLl9fY2xhc3NfXy5fX25hbWVfX31faW5pdCcpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGFyZ3MpCiAgICAgICAgc2VsZi5faW5pdF9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUpCgogICAgZGVmIHNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZikKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGFyZ3MpCiAgICAgICAgc2VsZi5faW5pdF9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZi5wcm9jZXNzX25hbWUsIHNlbGYuc2NyZWVuX25hbWUpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYne3NlbGYuX19jbGFzc19fLl9fbmFtZV9ffV9pbml0JykKICAgICAgICByZXR1cm4gc2VsZgoKICAgIGRlZiByZWZyZXNoX3NjcmVlbihzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIEBwcm9wZXJ0eQogICAgZGVmIGxpc3RlbmVyKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmxpc3RlbmVyCgogICAgQGxpc3RlbmVyLnNldHRlcgogICAgZGVmIGxpc3RlbmVyKHNlbGYsIHYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2NsZWFyX3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIGtleSBpbiBzZWxmLnNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgdG9hc3Qoc2VsZiwgdGV4dCk6CiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCh0ZXh0KQoKICAgIGRlZiBfaXNfcmVzdWx0X3Bvc2l0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdFBvc2l0aXZlJwoKICAgIGRlZiBfaXNfcmVzdWx0X25lZ2F0aXZlKHNlbGYsIGxpc3RlbmVyKSAtPiBib29sOgogICAgICAgIHJldHVybiBzZWxmLmxpc3RlbmVyID09IGxpc3RlbmVyIGFuZCBzZWxmLmV2ZW50ID09ICdvblJlc3VsdE5lZ2F0aXZlJwoKICAgIGRlZiBfX3N0cl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmJ3tzZWxmLnByb2Nlc3NfbmFtZX0gLyB7c2VsZi5zY3JlZW5fbmFtZX0nCgogICAgZGVmIF92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBpZiB2YWx1ZSBpcyBOb25lOgogICAgICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvcihmJ1Byb2Nlc3M6IHtzZWxmLnByb2Nlc3NfbmFtZX0sIHNjcmVlbjoge3NlbGYuc2NyZWVuX25hbWV9LicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZidGb3Iga2V5IHtrZXl9IG11c3QgYmUgc2V0IHZhbHVlIG5vdCBOb25lJykKCiAgICBkZWYgZ2V0X2h0dHBfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgaHR0cF9zZXR0aW5ncyA9IHsKICAgICAgICAgICAgJ3VybCc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJVUkwiKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnVVNFUicpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdQQVNTJyksCiAgICAgICAgICAgICdkZXZpY2VfbW9kZWwnOiBzZWxmLmhhc2hfbWFwWydERVZJQ0VfTU9ERUwnXSwKICAgICAgICAgICAgJ2FuZHJvaWRfaWQnOiBzZWxmLmhhc2hfbWFwWydBTkRST0lEX0lEJ10sCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgndXNlcl9uYW1lJyl9CiAgICAgICAgcmV0dXJuIGh0dHBfc2V0dGluZ3MKCiAgICBkZWYgcHV0X25vdGlmaWNhdGlvbihzZWxmLCB0ZXh0LCB0aXRsZT1Ob25lKToKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vdGlmaWNhdGlvbih0ZXh0LCB0aXRsZSkKCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBfbGlzdGVuZXJfbm90X2ltcGxlbWVudGVkKHNlbGYpOgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IgKGYnbGlzdGVuZXIge3NlbGYubGlzdGVuZXJ9IG5vdCBpbXBsZW1lbnRlZCcpCgogICAgZGVmIF9pc19pbml0X2hhbmRsZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoZid7c2VsZi5fX2NsYXNzX18uX19uYW1lX199X2luaXQnKQoKICAgIGRlZiBfaW5pdF9zY3JlZW5fdmFsdWVzKHNlbGYpOgogICAgICAgIGZvciBrIGluIHNlbGYuc2NyZWVuX3ZhbHVlczoKICAgICAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzW2tdID0gc2VsZi5oYXNoX21hcFtrXQoKICAgIGRlZiBfZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5pc19maW5pc2hfcHJvY2VzcyA9IFRydWUKICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxmLmlzX2ZpbmlzaF9wcm9jZXNzID0gVHJ1ZQogICAgICAgIGlmIHNlbGYucGFyZW50X3NjcmVlbjoKICAgICAgICAgICAgc2VsZi5wYXJlbnRfc2NyZWVuLmhhc2hfbWFwID0gc2VsZi5oYXNoX21hcAogICAgICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZi5wYXJlbnRfc2NyZWVuKQogICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3NfcmVzdWx0KCkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYucGFyZW50X3NjcmVlbjoKICAgICAgICAgICAgc2VsZi5wYXJlbnRfc2NyZWVuLmhhc2hfbWFwID0gc2VsZi5oYXNoX21hcAogICAgICAgICAgICBzZXRfbmV4dF9zY3JlZW4oc2VsZi5wYXJlbnRfc2NyZWVuKQogICAgICAgIHNlbGYuaGFzaF9tYXAuYmFja19zY3JlZW4oKQoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YShzZWxmLCByZW1vdmU9VHJ1ZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICBpZiByZW1vdmU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdzZWxlY3RlZF9jYXJkX2RhdGEnKQoKICAgICAgICByZXR1cm4gc2VsZWN0ZWRfY2FyZF9kYXRhCgogICAgZGVmIF9ydW5fb25fc3RhcnRfaGFuZGxlcnMoc2VsZik6CiAgICAgICAgZm9yIGhhbmRsZXIgaW4gc2VsZi5vbl9zdGFydF9oYW5kbGVyczoKICAgICAgICAgICAgaGFuZGxlcigpCiAgICAgICAgICAgIHNlbGYub25fc3RhcnRfaGFuZGxlcnMucmVtb3ZlKGhhbmRsZXIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9mb3JtYXRfcXVhbnRpdHkocXR0eSk6CiAgICAgICAgaWYgZmxvYXQocXR0eSkgJSAxID09IDA6CiAgICAgICAgICAgIHJldHVybiBpbnQoZmxvYXQocXR0eSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHF0dHkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2Zvcm1hdF9kYXRlKGRhdGVfc3RyOiBzdHIpOgogICAgICAgIHJldHVybiBkYXRldGltZS5mcm9taXNvZm9ybWF0KGRhdGVfc3RyKS5zdHJmdGltZSgnJW0tJWQtJVkgJUg6JU06JVMnKQoKICAgIGNsYXNzIFRleHRWaWV3KHdpZGdldHMuVGV4dFZpZXcpOgogICAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZSwgcnNfc2V0dGluZ3MpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9IHJzX3NldHRpbmdzLmdldCgnRG9jVHlwZUNhcmRUZXh0U2l6ZScpCiAgICAgICAgICAgIHNlbGYuVGV4dENvbG9yID0gJyMzMzMzMzMnCiAgICAgICAgICAgIHNlbGYuQmFja2dyb3VuZENvbG9yID0gJ0ZGQ0M5OScKICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAwCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgojID09PT09PT09PT09PT09PT09PT09IFByaW50aW5nIHNjcmVlbnMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCgpjbGFzcyBIdG1sVmlldyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KDQtdC30YPQu9GM0YLQsNGCJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGxhYmxlX2Z1bGxfcGF0aCA9IHNlbGYucHJpbnRfbmNsLmdldCgnbGFibGVfZnVsbF9wYXRoJykKICAgICAgICBiYXJjb2RlX3dpZHRoID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfd2lkdGgnKQogICAgICAgIGJhcmNvZGVfd2lkdGggPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfd2lkdGgpKSkgaWYgYmFyY29kZV93aWR0aCBlbHNlICcyMCcKICAgICAgICBiYXJjb2RlX2hlaWdodCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2hlaWdodCcpCiAgICAgICAgYmFyY29kZV9oZWlnaHQgPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfaGVpZ2h0KSkpIGlmIGJhcmNvZGVfaGVpZ2h0IGVsc2UgJzIwJwogICAgICAgIGJhcmNvZGVfbGVmdCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2xlZnQnKQogICAgICAgIGJhcmNvZGVfbGVmdCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9sZWZ0KSkpIGlmIGJhcmNvZGVfbGVmdCBlbHNlICcwJwogICAgICAgIGJhcmNvZGVfcmlnaHQgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9yaWdodCcpCiAgICAgICAgYmFyY29kZV9yaWdodCA9IHN0cihpbnQoZmxvYXQoYmFyY29kZV9yaWdodCkpKSBpZiBiYXJjb2RlX3JpZ2h0IGVsc2UgJzAnCiAgICAgICAgYmFyY29kZV91cCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3VwJykKICAgICAgICBiYXJjb2RlX3VwID0gc3RyKGludChmbG9hdChiYXJjb2RlX3VwKSkpIGlmIGJhcmNvZGVfdXAgZWxzZSAnMCcKICAgICAgICBiYXJjb2RlX2Rvd24gPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9kb3duJykKICAgICAgICBiYXJjb2RlX2Rvd24gPSBzdHIoaW50KGZsb2F0KGJhcmNvZGVfZG93bikpKSBpZiBiYXJjb2RlX2Rvd24gZWxzZSAnMCcKICAgICAgICBiYXJjb2RlX3R5cGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV90eXBlX2NsaWNrJykgb3IgJ2VhbjEzJwoKICAgICAgICBiYXJjb2RlX3R5cGVzID0gWydlYW4xMycsICdjb2RlMzknLCAnY29kZTEyOCcsICdxci1jb2RlJ10KCiAgICAgICAgdGVtcGxhdGVfZGlyLCB0ZW1wbGF0ZV9maWxlID0gb3MucGF0aC5zcGxpdChsYWJsZV9mdWxsX3BhdGgpCiAgICAgICAgaHRtbF9kb2NfcGFyYW1zID0gSFRNTERvY3VtZW50LmZpbmRfdGVtcGxhdGVfdmFyaWFibGVzKHRlbXBsYXRlX2RpciwgdGVtcGxhdGVfZmlsZSkKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuZ2V0X2RldGFpbHNfZGF0YShodG1sX2RvY19wYXJhbXMpCgogICAgICAgIGRhdGFfZm9yX3ByaW50aW5nID0ge2VsZW1bJ2tleSddOiBlbGVtWyd2YWx1ZSddIGZvciBlbGVtIGluIGRvY19kZXRhaWxzfQogICAgICAgIGRhdGFfZm9yX3ByaW50aW5nLnVwZGF0ZShiYXJjb2RlPScxMjMxMjMxMjMxMjMnKQogICAgICAgIGxpc3RfZm9yX2Nob29zZSA9ICc7Jy5qb2luKGRhdGFfZm9yX3ByaW50aW5nLmtleXMoKSkKCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShkb2NfZGV0YWlscykKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2RvY190YWJsZV92aWV3KHRhYmxlX2RhdGE9dGFibGVfZGF0YSkKCiAgICAgICAgaHRtbCA9IEhUTUxEb2N1bWVudCh0ZW1wbGF0ZV9kaXIsIHRlbXBsYXRlX2ZpbGUpLmNyZWF0ZV9odG1sKAogICAgICAgICAgICBkYXRhX2Zvcl9wcmludGluZywgYmFyY29kZV90eXBlPWJhcmNvZGVfdHlwZSkKCiAgICAgICAgaHRtbCA9IEhUTUxEb2N1bWVudC5pbmplY3RfY3NzX3N0eWxlKAogICAgICAgICAgICBodG1sLAogICAgICAgICAgICB3aWR0aD1iYXJjb2RlX3dpZHRoLAogICAgICAgICAgICBoZWlnaHQ9YmFyY29kZV9oZWlnaHQsCiAgICAgICAgICAgIHg9c3RyKGludChiYXJjb2RlX3JpZ2h0KSAtIGludChiYXJjb2RlX2xlZnQpKSwKICAgICAgICAgICAgeT1zdHIoaW50KGJhcmNvZGVfZG93bikgLSBpbnQoYmFyY29kZV91cCkpLAogICAgICAgICkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV93aWR0aCcsIGJhcmNvZGVfd2lkdGgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfaGVpZ2h0JywgYmFyY29kZV9oZWlnaHQpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfbGVmdCcsIGJhcmNvZGVfbGVmdCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnYmFyY29kZV9yaWdodCcsIGJhcmNvZGVfcmlnaHQpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfdXAnLCBiYXJjb2RlX3VwKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX2Rvd24nLCBiYXJjb2RlX2Rvd24pCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JhcmNvZGVfdHlwZXMnLCAnOycuam9pbihiYXJjb2RlX3R5cGVzKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaHRtbCcsIGh0bWwpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RhdGFfZm9yX3ByaW50aW5nX2tleXMnLCBsaXN0X2Zvcl9jaG9vc2UpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ21hdGNoaW5nX3RhYmxlJywgdGFibGVfdmlldy50b19qc29uKCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgZ2V0X2RldGFpbHNfZGF0YShzZWxmLCBodG1sX2RvY19wYXJhbXM6IHNldCkgLT4gTGlzdFtEaWN0XToKICAgICAgICBtYXRjaGluZ190YWJsZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdtYXRjaGluZ190YWJsZScpCiAgICAgICAgaWYgbm90IG1hdGNoaW5nX3RhYmxlOgogICAgICAgICAgICByZXR1cm4gW3sna2V5JzogZWxlbSwgJ3ZhbHVlJzogZWxlbX0gZm9yIGVsZW0gaW4gaHRtbF9kb2NfcGFyYW1zXQogICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhtYXRjaGluZ190YWJsZSkKICAgICAgICBtYXRjaGluZ190YWJsZV9kYXRhID0gbWF0Y2hpbmdfdGFibGVbJ2N1c3RvbXRhYmxlJ11bJ3RhYmxlZGF0YSddCiAgICAgICAgcmVzdWx0ID0gW10KICAgICAgICBmb3IgZWxlbSBpbiBodG1sX2RvY19wYXJhbXM6CiAgICAgICAgICAgIHZhbHVlID0gZWxlbQogICAgICAgICAgICBmb3IgZGF0YSBpbiBtYXRjaGluZ190YWJsZV9kYXRhOgogICAgICAgICAgICAgICAgaWYgZGF0YS5nZXQoJ2tleScpID09IGVsZW06CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkYXRhWyd2YWx1ZSddCiAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoeydrZXknOiBlbGVtLCAndmFsdWUnOiB2YWx1ZX0pCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBpZiBzZWxmLnByaW50X25jbC5nZXQoJ2Zyb21fZmlsZV9icm93c2VyJyk6CiAgICAgICAgICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2Zyb21fZmlsZV9icm93c2VyJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3NfcmVzdWx0KCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQodC/0LjRgdC+0Log0YjQsNCx0LvQvtC90L7QsicpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX3NhdmUnOgogICAgICAgICAgICBtYXRjaGluZ190YWJsZSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoIm1hdGNoaW5nX3RhYmxlIikpCiAgICAgICAgICAgIGN1cnJlbnRfdGFibGUgPSBtYXRjaGluZ190YWJsZVsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ10KICAgICAgICAgICAgY3VycmVudF90YWJsZS5wb3AoMCkKICAgICAgICAgICAgZm9yIGVsIGluIGN1cnJlbnRfdGFibGU6CiAgICAgICAgICAgICAgICBpZiBlbC5nZXQoJ2tleScpOgogICAgICAgICAgICAgICAgICAgIGVsLnBvcCgnX2xheW91dCcpCgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfd2lkdGgnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV93aWR0aCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV9oZWlnaHQnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9oZWlnaHQnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfbGVmdCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2xlZnQnKSxUcnVlKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ2JhcmNvZGVfcmlnaHQnLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9yaWdodCcpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV91cCcsIHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX3VwJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdiYXJjb2RlX2Rvd24nLCBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9kb3duJyksVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdtYXRjaGluZ190YWJsZScsIGpzb24uZHVtcHMoY3VycmVudF90YWJsZSksIFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnYmFyY29kZV90eXBlJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfdHlwZV9jbGljaycpLFRydWUpCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9uYW1lJywgc2VsZi5wcmludF9uY2wuZ2V0KCdsYWJsZV9maWxlX25hbWUnKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX3BhdGgnLCBzZWxmLnByaW50X25jbC5nZXQoJ2xhYmxlX2Z1bGxfcGF0aCcpLCBUcnVlKQogICAgICAgICAgICBodG1sID0gc2VsZi5oYXNoX21hcC5nZXQoJ2h0bWwnKQoKICAgICAgICAgICAgb2xkX3ByZXZpZXdfdG1wID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnKQogICAgICAgICAgICBpZiBvbGRfcHJldmlld190bXAgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3X3RtcCk6CiAgICAgICAgICAgICAgICBvcy5yZW1vdmUob2xkX3ByZXZpZXdfdG1wKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCgogICAgICAgICAgICBvbGRfcHJldmlldyA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgICAgIGlmIG9sZF9wcmV2aWV3IGFuZCBvcy5wYXRoLmV4aXN0cyhvbGRfcHJldmlldyk6CiAgICAgICAgICAgICAgICBvcy5yZW1vdmUob2xkX3ByZXZpZXcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdQcmludFByZXZpZXcnLCBodG1sKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUHJpbnRUb0JpdG1hcCcpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnUHJpbnRCaXRtYXAnOgogICAgICAgICAgICBwYXRoX3RvX3BuZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdQcmludEJpdG1hcFBhdGgnKQogICAgICAgICAgICAjINCf0LXRgNC10L3QvtGBINGI0LDQsdC70L7QvdC+0LIg0LIg0L7RgtC00LXQu9GM0L3Rg9GOINC/0LDQv9C60YMuCiAgICAgICAgICAgIGRpcmVjdG9yeSwgbmFtZSA9IG9zLnBhdGguc3BsaXQocGF0aF90b19wbmcpCiAgICAgICAgICAgIG5ld19wYXRoID0gb3MucGF0aC5qb2luKGRpcmVjdG9yeSwgJ3NhdmVkX2xhYmVsX3RlbXBsYXRlcycsIG5hbWUpCiAgICAgICAgICAgIG9zLm1ha2VkaXJzKG9zLnBhdGguam9pbihkaXJlY3RvcnksICdzYXZlZF9sYWJlbF90ZW1wbGF0ZXMnKSwgZXhpc3Rfb2s9VHJ1ZSkKICAgICAgICAgICAgc2h1dGlsLmNvcHkocGF0aF90b19wbmcsIG5ld19wYXRoKQogICAgICAgICAgICBvcy5yZW1vdmUocGF0aF90b19wbmcpCgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnLCBuZXdfcGF0aCwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC9INGB0L7RhdGA0LDQvdGR0L0nKQogICAgICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2Zyb21fZmlsZV9icm93c2VyJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQqNCw0LHQu9C+0L3RiycpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnQ2FyZHNDbGljayc6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScpKQogICAgICAgICAgICBpZiBub3QgY2FyZF9kYXRhOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdsaXN0X2ZpZWxkJywgc2VsZi5oYXNoX21hcC5nZXQoJ2RhdGFfZm9yX3ByaW50aW5nX2tleXMnKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygn0J3QsNGB0YLRgNC+0LnQutCw0KHQvtC+0YLQstC10YLRgdGC0LLQuNGP0JTQuNCw0LvQvtCzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT1jYXJkX2RhdGFbJ2tleSddLCBidXR0b25zPVsn0JTQsCcsICfQndC10YInXSkKCiAgICAgICAgZWxpZiBzZWxmLmhhc2hfbWFwLmdldCgiZXZlbnQiKSA9PSAnb25SZXN1bHRQb3NpdGl2ZSc6CiAgICAgICAgICAgIGNhcmRfcG9zaXRpb24gPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfcG9zaXRpb24nKSkKICAgICAgICAgICAgbWF0Y2hpbmdfdGFibGUgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCJtYXRjaGluZ190YWJsZSIpKQogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBtYXRjaGluZ190YWJsZVsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ11bY2FyZF9wb3NpdGlvbl0KICAgICAgICAgICAgY3VycmVudF9lbGVtWyd2YWx1ZSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdF9maWVsZCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJtYXRjaGluZ190YWJsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24uZHVtcHMobWF0Y2hpbmdfdGFibGUsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3V0ZjgnKS5kZWNvZGUoKSkKICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBkZXRhaWxzOiBMaXN0W2RpY3RdKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIGZvciByZWNvcmQgaW4gZGV0YWlsczoKICAgICAgICAgICAgcmVjb3JkLnVwZGF0ZShfbGF5b3V0PXNlbGYuX2dldF9kb2NfdGFibGVfcm93X3ZpZXcoKSkKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkZGRkZGIiBpZiByZWNvcmRbJ3ZhbHVlJ10gZWxzZSAnI0ZCRTlFNycKICAgICAgICAgICAgcmVjb3JkWydfbGF5b3V0J10uQmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZF9jb2xvcgogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChyZWNvcmQpCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQmtC70Y7RhycsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0JfQvdCw0YfQtdC90LjQtScsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAa2V5Jywgc2VsZi5yc19zZXR0aW5ncyksCgogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdmFsdWUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKCmNsYXNzIFRlbXBsYXRlc0xpc3QoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGxpc3RfZGF0YSA9IHNlbGYuZ2V0X2FsbF9maWxlc19mcm9tX3BhdGNoKCkKICAgICAgICBpZiBub3QgbGlzdF9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQodC/0LjRgdC+0Log0YjQsNCx0LvQvtC90L7QsiDQv9GD0YHRgicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcobGlzdF9kYXRhKQogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgndGVtcGxhdGVzX2NhcmRzJywgZG9jX2NhcmRzLnRvX2pzb24oKSwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndGVtcGxhdGVzX2NhcmRzJywgZG9jX2NhcmRzLnRvX2pzb24oKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdtYXRjaGluZ190YWJsZScpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2RhdGEnKSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdsYWJsZV9maWxlX25hbWUnLCBjYXJkX2RhdGEuZ2V0KCdmaWxlX25hbWUnKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdsYWJsZV9mdWxsX3BhdGgnLCBjYXJkX2RhdGEuZ2V0KCdmdWxsX3BhdGgnKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0KDQtdC30YPQu9GM0YLQsNGCJykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9nZXRfZG9jX2NhcmRzX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfZGF0ZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCgogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BmaWxlX25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249Imhvcml6b250YWwiCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BmaWxlX3NpemUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNyZWF0aW9uX3RpbWUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiBkb2NfY2FyZHMKCiAgICBkZWYgZ2V0X2FsbF9maWxlc19mcm9tX3BhdGNoKHNlbGYpOgogICAgICAgIHRlbXBsYXRlc19kaXIgPSBzZWxmLnByaW50X25jbC5nZXQoJ2xhYmVsX3RlbXBsYXRlc19kaXInKQogICAgICAgIGZvbGRlcl9wYXRoID0gdGVtcGxhdGVzX2RpciBvciBvcy5wYXRoLmpvaW4oc3VDbGFzcy5nZXRfdGVtcF9kaXIoKSwgJ2xhYmVscycpCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdsYWJlbF90ZW1wbGF0ZXNfZGlyJywgZm9sZGVyX3BhdGgsIFRydWUpCiAgICAgICAgaHRtbF9maWxlc19pbmZvID0gW10KCiAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZm9sZGVyX3BhdGgpOgogICAgICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgICAgIGlmIGZpbGUubG93ZXIoKS5lbmRzd2l0aCgnLmh0bScpOiAgIyBhbmQgbWFzayBpbiBmaWxlOgogICAgICAgICAgICAgICAgICAgIGZpbGVfcGF0aCA9IG9zLnBhdGguam9pbihyb290LCBmaWxlKQogICAgICAgICAgICAgICAgICAgIGZpbGVfc2l6ZV9ieXRlcyA9IG9zLnBhdGguZ2V0c2l6ZShmaWxlX3BhdGgpCiAgICAgICAgICAgICAgICAgICAgZmlsZV9zaXplX2tiID0gZmlsZV9zaXplX2J5dGVzIC8gMTAyNCAgIyBDb252ZXJ0IGJ5dGVzIHRvIGtpbG9ieXRlcwogICAgICAgICAgICAgICAgICAgIGNyZWF0aW9uX3RpbWUgPSBkYXRldGltZS5mcm9tdGltZXN0YW1wKG9zLnBhdGguZ2V0Y3RpbWUoZmlsZV9wYXRoKSkKICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfY3JlYXRpb25fdGltZSA9IGNyZWF0aW9uX3RpbWUuc3RyZnRpbWUoCiAgICAgICAgICAgICAgICAgICAgICAgICclWS0lbS0lZCAlSDolTTolUycpICAjIEZvcm1hdCBkYXRldGltZSBmb3IgdXNlciBleWVzICkpCgogICAgICAgICAgICAgICAgICAgIGZpbGVfaW5mbyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Z1bGxfcGF0aCc6IGZpbGVfcGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbGVfbmFtZSc6IGZpbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICdmaWxlX3NpemUnOiBmJ3tmaWxlX3NpemVfa2I6LjJmfSBLQicsCiAgICAgICAgICAgICAgICAgICAgICAgICMgRm9ybWF0IGZpbGUgc2l6ZSB3aXRoIDIgZGVjaW1hbCBwbGFjZXMKICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWF0aW9uX3RpbWUnOiBmb3JtYXR0ZWRfY3JlYXRpb25fdGltZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBodG1sX2ZpbGVzX2luZm8uYXBwZW5kKGZpbGVfaW5mbykKICAgICAgICByZXR1cm4gaHRtbF9maWxlc19pbmZvCgoKY2xhc3MgUHJpbnRTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCdwcmludF9uY2wnKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwcmludF90aHJvdWdoID0gc2VsZi5wcmludF9uY2wuZ2V0KCdwcmludF90aHJvdWdoJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2hlY2tfYm94X2JsdWV0b290aF9wcmludCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyKHByaW50X3Rocm91Z2ggPT0gJ0JUJykubG93ZXIoKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2hlY2tfYm94X3dpZmlfcHJpbnQnLCBzdHIocHJpbnRfdGhyb3VnaCA9PSAnV2lGaScpLmxvd2VyKCkpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fYmx1ZXRvb3RoX3ByaW50ZXJfc2V0dGluZ3MnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4IEJsdWV0b290aCcpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3dpZmlfcHJpbnRlcl9zZXR0aW5ncyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggV2lGaScpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2xhYmVsX3RlbXBsYXRlc19zZXR0aW5ncyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2NoZWNrX2JveF9ibHVldG9vdGhfcHJpbnQnOgogICAgICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3ByaW50X3Rocm91Z2gnLCAnQlQnLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQn9C10YfQsNGC0Ywg0YfQtdGA0LXQtyBCbHVldG9vdGgnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2NoZWNrX2JveF93aWZpX3ByaW50JzoKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdwcmludF90aHJvdWdoJywgJ1dpRmknLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQn9C10YfQsNGC0Ywg0YfQtdGA0LXQtyBXaUZpJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKY2xhc3MgUHJpbnRCbHVldG9vdGhTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCBCbHVldG9vdGgnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QtdGH0LDRgtGMJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuYnRfbmNsID0gbm9DbGFzcygiYnRfc2V0dGluZ3MiKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwcmludGVyID0gc2VsZi5idF9uY2wuZ2V0KCJkZWZhdWx0X3ByaW50ZXIiKSBvciAn0J3QtSDQstGL0LHRgNCw0L0nCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RlZmF1bHRfcHJpbnRlcicsIHByaW50ZXIpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fc2hvd19jb25uZWN0ZWQnOgogICAgICAgICAgICBkZXZpY2VzID0gc2VsZi5oYXNoX21hcC5nZXQoIkJUUmVzdWx0IikKICAgICAgICAgICAgZGV2aWNlcyA9IGpzb24ubG9hZHMoZGV2aWNlcykgaWYgZGV2aWNlcyBlbHNlIFtdCiAgICAgICAgICAgIGpjYXJkcyA9IHsiY2FyZHMiOiBbXX0KCiAgICAgICAgICAgIGZvciBkZXZpY2UgaW4gZGV2aWNlczoKICAgICAgICAgICAgICAgIGNhcmQgPSB7ImtleSI6IGRldmljZS5nZXQoImFkZHJlc3MiKSwKICAgICAgICAgICAgICAgICAgICAgICAgIml0ZW1zIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJrZXkiOiAi0KPRgdGC0YDQvtC50YHRgtCy0L4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ2YWx1ZSI6IGRldmljZS5nZXQoIm5hbWUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2l6ZSI6ICIxNSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbG9yIjogIiMxYjMxYzIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX3NpemUiOiAiMTIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjYXB0aW9uX2NvbG9yIjogIiMxYjMxYzIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJrZXkiOiAiTUFDIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBkZXZpY2UuZ2V0KCJhZGRyZXNzIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNpemUiOiAiMTUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb2xvciI6ICIjMTMxZTYxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9zaXplIjogIjEyIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2FwdGlvbl9jb2xvciI6ICIjMWIzMWMyIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAia2V5IjogInN0YXRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBkZXZpY2UuZ2V0KCJzdGF0ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzaXplIjogIjE1IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY29sb3IiOiAiIzEzMWU2MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fc2l6ZSI6ICIxMiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNhcHRpb25fY29sb3IiOiAiIzFiMzFjMiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgXX0KCiAgICAgICAgICAgICAgICBqY2FyZHNbImNhcmRzIl0uYXBwZW5kKGNhcmQpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiY2FyZHMiLCBqc29uLmR1bXBzKGpjYXJkcykpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9zdG9wX3NjYW4nOgogICAgICAgICAgICBpZiBzZWxmLmJ0X25jbC5nZXQoJ3NjYW5uaW5nJyk6CiAgICAgICAgICAgICAgICBzZWxmLmJ0X25jbC5wdXQoJ3NjYW5uaW5nJywgRmFsc2UsIFRydWUpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnQlRTdG9wU2NhbicsICcnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KHQutCw0L3QuNGA0L7QstCw0L3QuNC1INC+0YHRgtCw0L3QvtCy0LvQtdC90L4nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fYnRfZGlzY29ubmVjdCc6CiAgICAgICAgICAgIGlmIHNlbGYuYnRfbmNsLmdldCgnZGVmYXVsdF9wcmludGVyJyk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgYnQuY2xvc2Vfc29ja2V0KCkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnZGVmYXVsdF9wcmludGVyJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmJ0X25jbC5kZWxldGUoJ2RlZmF1bHRfcHJpbnRlcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RlZmF1bHRfcHJpbnRlcicsICfQndC1INCy0YvQsdGA0LDQvScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J/RgNC40L3RgtC10YAg0L7RgtC60LvRjtGH0LXQvScpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90YvRhSDQv9GA0LjQvdGC0LXRgNC+0LInKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdGCINC/0L7QtNC60LvRjtGH0LXQvdC90YvRhSDQv9GA0LjQvdGC0LXRgNC+0LInKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc3RhcnRfc2Nhbic6CiAgICAgICAgICAgIGJ0X2Rpc2NvdmVyX2hhbmRsZXJzID0gW3sKICAgICAgICAgICAgICAgICJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAic2V0IiwKICAgICAgICAgICAgICAgICJtZXRob2QiOiAiYmVlcDt0b2FzdD1AQlREaXNjb3ZlclJlc3VsdCIsCiAgICAgICAgICAgICAgICAicG9zdEV4ZWN1dGUiOiAiIgogICAgICAgICAgICB9XQogICAgICAgICAgICBzZWxmLmJ0X25jbC5wdXQoJ3NjYW5uaW5nJywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkJUU3RhcnRTY2FuIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJCVERpc2NvdmVySGFuZGxlcnMiLCBqc29uLmR1bXBzKGJ0X2Rpc2NvdmVyX2hhbmRsZXJzKSkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ch0LrQsNC90LjRgNC+0LLQsNC90LjQtScpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBidF9oYW5kbGVycyA9IFsKICAgICAgICAgICAgICAgIHsiYWN0aW9uIjogInJ1biIsICJ0eXBlIjogInB5dGhvbiIsICJtZXRob2QiOiAiYmx1ZXRvb3RoX2Vycm9yIn0KICAgICAgICAgICAgXQoKICAgICAgICAgICAgbWFjID0gc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfa2V5IikKICAgICAgICAgICAgZGV2aWNlID0gYnQuZ2V0X2RldmljZShtYWMpCiAgICAgICAgICAgIGlmIGRldmljZSBpcyBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgi0J3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8g0Log0YPRgdGC0YDQvtC50YHRgtCy0YMiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9GC0LXRgdGCJykKICAgICAgICAgICAgY29ubmVjdGVkID0gYnQuY29ubmVjdF90b19jbGllbnQoZGV2aWNlLCBqc29uLmR1bXBzKGJ0X2hhbmRsZXJzKSkKICAgICAgICAgICAgaWYgbm90IGNvbm5lY3RlZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoItCj0YHRgtGA0L7QudGB0YLQstC+INC90LUg0Y/QstC70Y/QtdGC0YHRjyDQv9GA0LjQvdGC0LXRgNC+0LwiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuYnRfbmNsLnB1dCgiZGVmYXVsdF9wcmludGVyIiwgbWFjLCBGYWxzZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRlZmF1bHRfcHJpbnRlciIsIG1hYykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KPRgdC/0LXRiNC90L4nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fdGVzdF9wcmludCc6CiAgICAgICAgICAgIGlmIHNlbGYuYnRfbmNsLmdldCgnZGVmYXVsdF9wcmludGVyJyk6CiAgICAgICAgICAgICAgICB6cGwgPSAnXlhBXkNGQSwzMF5GTzEwLDUwXkZEVGVzdF5GU15CWTMsMiwxMjBeRk8xMCwxNTBeQkNeRkQxMjM0NTY3OF5GU15YWicKICAgICAgICAgICAgICAgIHNlbnQsIHJlc3VsdCA9IFByaW50U2VydmljZS5wcmludF9idCh6cGwpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KHJlc3VsdCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdGL0YUg0L/RgNC40L3RgtC10YDQvtCyJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4JykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKY2xhc3MgUHJpbnRXaUZpU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0LggV2lGaScKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBpbXBvcnQgcmUKICAgICAgICBpcCA9IHNlbGYucHJpbnRfbmNsLmdldCgnY3VycmVudF9pcCcpCiAgICAgICAgaWYgaXA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3aV9maV9pcCcsIGlwKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5mb193aWZpX2N1cnJlbnRfaXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ0lQINC/0L7QtNC60LvRjtGH0LXQvdC90L7Qs9C+INC/0YDQuNC90YLQtdGA0LA6IHtpcH0nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlwID0gc2VsZi5oYXNoX21hcC5nZXQoJ3dpX2ZpX2lwJykKICAgICAgICAgICAgaWYgaXA6CiAgICAgICAgICAgICAgICBwYXR0ZXJuID0gcideKFxkezEsM31cLil7M31cZHsxLDN9JCcKICAgICAgICAgICAgICAgIGlmIG5vdCByZS5tYXRjaChwYXR0ZXJuLCBpcCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5kZWxldGUoJ3dpX2ZpX2lwJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10LLQtdGA0L3Ri9C5INGE0L7RgNC80LDRgiBJUCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2luZm9fd2lmaV9jdXJyZW50X2lwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ9Cd0LXRgiDQv9C+0LTQutC70Y7Rh9C10L3QvdC+0LPQviDQv9GA0LjQvdGC0LXRgNCwJykKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbmZvX3dpZmlfY3VycmVudF9pcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ0lQINC/0L7QtNC60LvRjtGH0LXQvdC90L7Qs9C+INC/0YDQuNC90YLQtdGA0LA6IHtpcH0nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2luZm9fd2lmaV9jdXJyZW50X2lwJywgZifQndC10YIg0L/QvtC00LrQu9GO0YfQtdC90L3QvtCz0L4g0L/RgNC40L3RgtC10YDQsCcpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICdidG5fd2lmaV9zYXZlX2lwJzoKICAgICAgICAgICAgc2VsZi5fd2lmaV9zYXZlX2lwKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fd2lmaV9kZWxldGVfaXAnOgogICAgICAgICAgICBzZWxmLl93aWZpX2RlbGV0ZV9pcCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Rlc3Rfd2lfZmknOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQotC10YHRgiDQv9C10YfQsNGC0LgnKQogICAgICAgICAgICBzZWxmLl90ZXN0X3dpX2ZpKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fd2lfZmlfcHJpbnRfenBsJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KLQtdGB0YIgenBsJykKICAgICAgICAgICAgc2VsZi5fcHJpbnRfenBsKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4JykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF93aWZpX3NhdmVfaXAoc2VsZik6CiAgICAgICAgaW1wb3J0IHJlCiAgICAgICAgaXAgPSBzZWxmLmhhc2hfbWFwLmdldCgnd2lfZmlfaXAnKQogICAgICAgIGlmIG5vdCBpcDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtSDRg9C60LDQt9Cw0L0gaXAnKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBwYXR0ZXJuID0gcideKFxkezEsM31cLil7M31cZHsxLDN9JCcKICAgICAgICBpZiBub3QgcmUubWF0Y2gocGF0dGVybiwgaXApOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnd2lfZmlfaXAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC10LLQtdGA0L3Ri9C5INGE0L7RgNC80LDRgiBJUCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnY3VycmVudF9pcCcsIGlwLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgnSVAg0L/RgNC40L3RgtC10YDQsCDQt9Cw0L/QuNGB0LDQvScpCgogICAgZGVmIF93aWZpX2RlbGV0ZV9pcChzZWxmKToKICAgICAgICBpcCA9IHNlbGYucHJpbnRfbmNsLmdldCgnY3VycmVudF9pcCcpCiAgICAgICAgaWYgbm90IGlwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCd3aV9maV9pcCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdjdXJyZW50X2lwJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCdJUCDQv9GA0LjQvdGC0LXRgNCwINGD0LTQsNC70ZHQvScpCgogICAgZGVmIF9wcmludF96cGwoc2VsZik6CiAgICAgICAgenBsID0gc2VsZi5oYXNoX21hcC5nZXQoJ3dpX2ZpX3pwbF9pbnB1dCcpCiAgICAgICAgaWYgbm90IHpwbDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J3QtdGCIHpwbCDQutC+0LTQsCDQtNC70Y8g0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGwsIFRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3ByaW50X3dpZmknKQoKICAgIGRlZiBfdGVzdF93aV9maShzZWxmKToKICAgICAgICB6cGwgPSAnXlhBXkNGQSwzMF5GTzEwLDUwXkZEVGVzdF5GU15CWTMsMiwxMjBeRk8xMCwxNTBeQkNeRkQxMjM0NTY3OF5GU15YWicKICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3dpZmlfZGF0YV90b19wcmludCcsIHpwbCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygncHJpbnRfd2lmaScpCgoKY2xhc3MgUHJpbnRMYWJlbFRlbXBsYXRlc1NldHRpbmdzKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCo0LDQsdC70L7QvdGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LXRh9Cw0YLRjCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgdGVtcGxhdGUgPSBzZWxmLnByaW50X25jbC5nZXQoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfbmFtZScpIG9yICfQndC10YInCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfbmFtZScsIGYn0KLQtdC60YPRidC40Lkg0YjQsNCx0LvQvtC9OiB7dGVtcGxhdGV9JykKICAgICAgICBwYXRoX3RvX2xhYmVsX3ByZXZpZXdfaW1hZ2UgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2UnKQogICAgICAgIGlmIG5vdCBwYXRoX3RvX2xhYmVsX3ByZXZpZXdfaW1hZ2U6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHRlbXBfcHJldmlldyA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKICAgICAgICBwYXRoID0gdGVtcF9wcmV2aWV3IGlmIHRlbXBfcHJldmlldyBlbHNlIHBhdGhfdG9fbGFiZWxfcHJldmlld19pbWFnZQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlJywgJ34nICsgcGF0aCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ2J0bl9nZXRfbGFiZWxzJzoKICAgICAgICAgICAgc2VsZi5fZ2V0X2xhYmVscygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3NlbGVjdF9sYWJlbF90ZW1wbGF0ZSc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Ch0L/QuNGB0L7QuiDRiNCw0LHQu9C+0L3QvtCyJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZGVsZXRlX3RlbXBsYXRlX3NldHRpbmdzJzoKICAgICAgICAgICAgc2VsZi5kZWxldGVfdGVtcGxhdGVfc2V0dGluZ3MoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9sYWJlbF90ZW1wbGF0ZV9zaXplX3NldHRpbmdzJzoKICAgICAgICAgICAgcGF0aF90b19sYWJlbCA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgICAgIGlmIG5vdCBwYXRoX3RvX2xhYmVsIG9yIG5vdCBvcy5wYXRoLmlzZmlsZShwYXRoX3RvX2xhYmVsKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ch0L3QsNGH0LDQu9CwINC90YPQttC90L4g0LLRi9Cx0YDQsNGC0Ywg0YjQsNCx0LvQvtC9JykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4INCg0LDQt9C80LXRgNGLJykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0L/QtdGH0LDRgtC4JykKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9nZXRfbGFiZWxzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLmdldF90ZW1wbGF0ZXMoKQogICAgICAgICAgICBpZiBhbnN3ZXJbJ3N0YXR1c19jb2RlJ10gIT0gMjAwOgogICAgICAgICAgICAgICAgcmVhc29uID0gYW5zd2VyWydlcnJvcl9wb29sJ10KICAgICAgICAgICAgICAgIHJhaXNlIGYn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0Lw6IHtyZWFzb259JwoKICAgICAgICAgICAgb3V0cHV0X2ZvbGRlciA9IG9zLnBhdGguam9pbihzdUNsYXNzLmdldF90ZW1wX2RpcigpLCAnbGFiZWxzJykKCiAgICAgICAgICAgIG9zLm1ha2VkaXJzKG91dHB1dF9mb2xkZXIsIGV4aXN0X29rPVRydWUpCgogICAgICAgICAgICBkYXRhX2xpc3QgPSBhbnN3ZXJbJ2RhdGEnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGYnZGF0YV9saXN0Ont0eXBlKGRhdGFfbGlzdCl9LCB7ZGF0YV9saXN0fScpCgogICAgICAgICAgICBmb3IgZGF0YV9kaWN0IGluIGRhdGFfbGlzdDoKICAgICAgICAgICAgICAgIGZpbGVfbmFtZSA9IHNlbGYuX2NvcnJlY3RfZmlsZW5hbWUoZGF0YV9kaWN0WyduYW1lJ10pICsgJy5odG0nCiAgICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ob3V0cHV0X2ZvbGRlciwgZmlsZV9uYW1lKQoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB3aXRoIG9wZW4oZmlsZV9wYXRoLCAndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGZpbGU6CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUud3JpdGUoYmFzZTY0LmI2NGRlY29kZShkYXRhX2RpY3RbJ2h0bWwnXSkuZGVjb2RlKCd1dGYtOCcpKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoCiAgICAgICAgICAgICAgICAgICAgICAgIGYn0J7RiNC40LHQutCwINGB0L7RhdGA0LDQvdC10L3QuNGPINGE0LDQudC70LAge2ZpbGVfcGF0aH06IHtzdHIoZSl9JykKICAgICAgICAgICAgICAgICAgICByYWlzZSBmJ9Ce0YjQuNCx0LrQsCDRgdC+0YXRgNCw0L3QtdC90LjRjyDRhNCw0LnQu9CwIHtmaWxlX3BhdGh9OiB7c3RyKGUpfScKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdsYWJlbF90ZW1wbGF0ZXNfZGlyJywgb3V0cHV0X2ZvbGRlciwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC90Ysg0LfQsNCz0YDRg9C20LXQvdGLJykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc3RyKGUpKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfY29ycmVjdF9maWxlbmFtZShmaWxlbmFtZSk6CiAgICAgICAgaWxsZWdhbF9jaGFycyA9IFsnPCcsICc+JywgJzonLCAnIicsICInIiwgJy8nLCAnXFwnLCAnfCcsICc/JywgJyonLCAiPCIsICI+IiwKICAgICAgICAgICAgICAgICAgICAgICAgICdceDAwJ10KICAgICAgICBmb3IgY2hhciBpbiBpbGxlZ2FsX2NoYXJzOgogICAgICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lLnJlcGxhY2UoY2hhciwgJycpCiAgICAgICAgcmV0dXJuIGZpbGVuYW1lCgogICAgZGVmIGRlbGV0ZV90ZW1wbGF0ZV9zZXR0aW5ncyhzZWxmKToKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfd2lkdGgnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV9oZWlnaHQnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV9sZWZ0JykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2JhcmNvZGVfcmlnaHQnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV91cCcpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdiYXJjb2RlX2Rvd24nKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnbWF0Y2hpbmdfdGFibGUnKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgnYmFyY29kZV90eXBlJykKICAgICAgICBzZWxmLnByaW50X25jbC5kZWxldGUoJ2N1cnJlbnRfbGFiZWxfdGVtcGxhdGVfbmFtZScpCiAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdjdXJyZW50X2xhYmVsX3RlbXBsYXRlX3BhdGgnKQoKICAgICAgICBvbGRfcHJldmlld190bXAgPSBzZWxmLnByaW50X25jbC5nZXQoJ3ByZXZpZXdfbGFiZWxfdGVtcGxhdGVfaW1hZ2VfdGVtcCcpCiAgICAgICAgaWYgb2xkX3ByZXZpZXdfdG1wIGFuZCBvcy5wYXRoLmV4aXN0cyhvbGRfcHJldmlld190bXApOgogICAgICAgICAgICBvcy5yZW1vdmUob2xkX3ByZXZpZXdfdG1wKQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZV90ZW1wJykKICAgICAgICBvbGRfcHJldmlldyA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgaWYgb2xkX3ByZXZpZXcgYW5kIG9zLnBhdGguZXhpc3RzKG9sZF9wcmV2aWV3KToKICAgICAgICAgICAgb3MucmVtb3ZlKG9sZF9wcmV2aWV3KQogICAgICAgIHNlbGYucHJpbnRfbmNsLmRlbGV0ZSgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCgoKY2xhc3MgUHJpbnRUZW1wbGF0ZVNpemVTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC/0LXRh9Cw0YLQuCDQoNCw0LfQvNC10YDRiycKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9C10YfQsNGC0YwnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5wcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICB3aWR0aF90ZW1wbGF0ZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCd3aWR0aF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgd2lkdGhfdGVtcGxhdGUgPSBpbnQoZmxvYXQod2lkdGhfdGVtcGxhdGUpKSBpZiB3aWR0aF90ZW1wbGF0ZSBlbHNlIDUwCiAgICAgICAgaGVpZ2h0X3RlbXBsYXRlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2hlaWdodF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgaGVpZ2h0X3RlbXBsYXRlID0gaW50KGZsb2F0KGhlaWdodF90ZW1wbGF0ZSkpIGlmIGhlaWdodF90ZW1wbGF0ZSBlbHNlIDUwCiAgICAgICAgZHBtbSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdkcG1tX3ByaW50X3RlbXBsYXRlJykKICAgICAgICBkcG1tID0gaW50KGRwbW0pIGlmIGRwbW0gZWxzZSA4CiAgICAgICAgaW1hZ2VfaGVpZ2h0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgaW1hZ2VfaGVpZ2h0ID0gaW50KGZsb2F0KGltYWdlX2hlaWdodCkpIGlmIGltYWdlX2hlaWdodCBlbHNlIDUwCiAgICAgICAgaW1hZ2Vfd2lkdGggPSBzZWxmLmhhc2hfbWFwLmdldCgnaW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGltYWdlX3dpZHRoID0gaW50KGZsb2F0KGltYWdlX3dpZHRoKSkgaWYgaW1hZ2Vfd2lkdGggZWxzZSA1MAogICAgICAgIGxsID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX2xsX3ByaW50X3RlbXBsYXRlJykKICAgICAgICBsbCA9IGludChmbG9hdChsbCkpIGlmIGxsIGVsc2UgMTUKICAgICAgICBwdyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV9wd19wcmludF90ZW1wbGF0ZScpCiAgICAgICAgcHcgPSBpbnQoZmxvYXQocHcpKSBpZiBwdyBlbHNlIDEwMDAKICAgICAgICB5ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ltYWdlX3lfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIHkgPSBpbnQoZmxvYXQoeSkpIGlmIHkgZWxzZSAwCiAgICAgICAgeCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpbWFnZV94X3ByaW50X3RlbXBsYXRlJykKICAgICAgICB4ID0gaW50KGZsb2F0KHgpKSBpZiB4IGVsc2UgMAoKICAgICAgICBwYXRoX3RvX2ltZyA9IHNlbGYucHJpbnRfbmNsLmdldCgncHJldmlld19sYWJlbF90ZW1wbGF0ZV9pbWFnZScpCiAgICAgICAgenBsZGF0YSA9IFByaW50U2VydmljZS5tYWtlX3pwbF9mcm9tX2xhYmVsKAogICAgICAgICAgICBpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZT1pbWFnZV93aWR0aCwKICAgICAgICAgICAgaW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlPWltYWdlX2hlaWdodCwKICAgICAgICAgICAgZHBtbV9wcmludF90ZW1wbGF0ZT1kcG1tLAogICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZT1sbCwKICAgICAgICAgICAgaW1hZ2VfcHdfcHJpbnRfdGVtcGxhdGU9cHcsCiAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU9eCwKICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZT15LAogICAgICAgICAgICBwYXRoX3RvX2ltZz1wYXRoX3RvX2ltZwogICAgICAgICkKICAgICAgICBzZWxmLnByaW50X25jbC5wdXQoJ3pwbGRhdGEnLCB6cGxkYXRhLCBUcnVlKQogICAgICAgIHN1Y2Nlc3MsIGFuc3dlciA9IFByaW50U2VydmljZS56cGxfdG9fcG5nX2Zyb21fYXBpKAogICAgICAgICAgICB6cGxkYXRhLCBkcG1tLCB3aWR0aF90ZW1wbGF0ZSwgaGVpZ2h0X3RlbXBsYXRlKQogICAgICAgIGlmIG5vdCBzdWNjZXNzOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgcGF0aCwgZXh0ID0gb3MucGF0aC5zcGxpdGV4dChwYXRoX3RvX2ltZykKICAgICAgICBwcmV2aWV3X3BhdGggPSBwYXRoICsgJ19wcmV2aWV3JyArIGV4dAogICAgICAgIHdpdGggb3BlbihwcmV2aWV3X3BhdGgsICd3YicpIGFzIG91dF9maWxlOgogICAgICAgICAgICBzaHV0aWwuY29weWZpbGVvYmooYW5zd2VyLCBvdXRfZmlsZSkKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wucHV0KCdwcmV2aWV3X2xhYmVsX3RlbXBsYXRlX2ltYWdlX3RlbXAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld19wYXRoLCBUcnVlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV9wcmludCcsICd+JyArIHByZXZpZXdfcGF0aCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnd2lkdGhfcHJpbnRfdGVtcGxhdGUnLCBzdHIod2lkdGhfdGVtcGxhdGUpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdoZWlnaHRfcHJpbnRfdGVtcGxhdGUnLCBzdHIoaGVpZ2h0X3RlbXBsYXRlKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUnLCBzdHIoaW1hZ2Vfd2lkdGgpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUnLCBzdHIoaW1hZ2VfaGVpZ2h0KSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZHBtbV9wcmludF90ZW1wbGF0ZScsIHN0cihkcG1tKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGUnLCBzdHIobGwpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbWFnZV9wd19wcmludF90ZW1wbGF0ZScsIHN0cihwdykpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3hfcHJpbnRfdGVtcGxhdGUnLCBzdHIoeCkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2ltYWdlX3lfcHJpbnRfdGVtcGxhdGUnLCBzdHIoeSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xpc3RlbmVyJykKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQv9C10YfQsNGC0Lgg0KjQsNCx0LvQvtC90YsnKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2F2ZV90ZW1wbGF0ZV9zaXplcyc6CiAgICAgICAgICAgIHRlbXBsYXRlID0gZGljdCgKICAgICAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2ltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgZHBtbV9wcmludF90ZW1wbGF0ZT1zZWxmLnByaW50X25jbC5nZXQoJ2RwbW1fcHJpbnRfdGVtcGxhdGUnKSwKICAgICAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV94X3ByaW50X3RlbXBsYXRlJyksCiAgICAgICAgICAgICAgICBpbWFnZV95X3ByaW50X3RlbXBsYXRlPXNlbGYucHJpbnRfbmNsLmdldCgnaW1hZ2VfeV9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2VfbGxfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV9sbF9wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICAgICAgaW1hZ2VfcHdfcHJpbnRfdGVtcGxhdGU9c2VsZi5wcmludF9uY2wuZ2V0KCdpbWFnZV9wd19wcmludF90ZW1wbGF0ZScpLAogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYucHJpbnRfbmNsLnB1dCgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnLCBqc29uLmR1bXBzKHRlbXBsYXRlKSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjQsNCx0LvQvtC9INGB0L7RhdGA0LDQvdGR0L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fZGVsZXRlX3ByaW50X3RlbXBsYXRlJzoKICAgICAgICAgICAgc2VsZi5wcmludF9uY2wuZGVsZXRlKCdzYXZlZF9wcmludF90ZW1wbGF0ZScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRg9C00LDQu9GR0L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fc2VudF90b19wcmludCc6CiAgICAgICAgICAgIHpwbGRhdGEgPSBzZWxmLnByaW50X25jbC5nZXQoJ3pwbGRhdGEnKQogICAgICAgICAgICBQcmludFNlcnZpY2UucHJpbnRfenBsKHpwbGRhdGEsIHNlbGYuaGFzaF9tYXApCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gUHJpbnRpbmcgc2NyZWVucyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKY2xhc3MgU2ltcGxlRmlsZUJyb3dzZXIoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Ch0L/QuNGB0L7QuiDRhNCw0LnQu9C+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0J/RgNC+0LLQvtC00L3QuNC6JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGVidWdfaG9zdF9pcCA9IHJzX3NldHRpbmdzLmdldCgnZGVidWdfaG9zdF9pcCcpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuRGVidWdTZXJ2aWNlKGlwX2hvc3Q9c2VsZi5oYXNoX21hcC5nZXQoJ2lwX2hvc3QnKSBvciBzZWxmLmRlYnVnX2hvc3RfaXApICAjICcxOTIuMTY4LjEuNzcnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGN1cnJlbnRfZGlyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZGlyJykgb3Igc3VDbGFzcy5nZXRfdGVtcF9kaXIoKQogICAgICAgIGxpc3RfZGF0YSA9IHNlbGYuZ2V0X2FsbF9maWxlc19mcm9tX3BhdGNoKGN1cnJlbnRfZGlyKQogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldyhsaXN0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZGlyJywgY3VycmVudF9kaXIpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZmlsZV9icm93c2VyX2NhcmRzJ10gPSBkb2NfY2FyZHMudG9fanNvbigpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgY3VycmVudF9kaXJlY3RvcnkgPSBQYXRoKHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2RpcicpKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZmluaXNoX3Byb2Nlc3MoKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ2J0bl9nZXRfdXAnOgogICAgICAgICAgICBpZiBub3Qgb3MuYWNjZXNzKGN1cnJlbnRfZGlyZWN0b3J5LnBhcmVudCwgb3MuUl9PSyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQlNC+0YHRgtGD0L8g0LfQsNC/0YDQtdGJ0ZHQvScpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9kaXInXSA9IGN1cnJlbnRfZGlyZWN0b3J5LnBhcmVudAoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2RhdGEiKSkKICAgICAgICAgICAgaWYgY3VycmVudF9lbGVtWydmaWxlX3R5cGUnXSA9PSAnRm9sZGVyJzoKICAgICAgICAgICAgICAgIG5ld19kaXIgPSBQYXRoKGN1cnJlbnRfZGlyZWN0b3J5LCBjdXJyZW50X2VsZW1bJ2ZpbGVfbmFtZSddKQogICAgICAgICAgICAgICAgaWYgb3MuYWNjZXNzKG5ld19kaXIsIG9zLlJfT0spOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2N1cnJlbnRfZGlyJ10gPSBuZXdfZGlyCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCgogICAgZGVmIF9nZXRfZG9jX2NhcmRzX3ZpZXcoc2VsZiwgdGFibGVfZGF0YTogTGlzdFtEaWN0XSk6CiAgICAgICAgZm9yIHJvdyBpbiB0YWJsZV9kYXRhOgogICAgICAgICAgICBpZiByb3dbJ2ZpbGVfdHlwZSddICE9ICdGaWxlJzoKICAgICAgICAgICAgICAgIHJvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2xheW91dChpc19maWxlPUZhbHNlKQogICAgICAgICAgICBlbGlmIHJvd1snZXh0ZW5zaW9uJ10gPT0gJy5odG0nOgogICAgICAgICAgICAgICAgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfbGF5b3V0KGlzX2h0bT1UcnVlKQogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHNlbGYuX2dldF9sYXlvdXQoKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YSwKICAgICAgICApCgogICAgICAgIHJldHVybiBkb2NfY2FyZHMKCiAgICBkZWYgX2dldF9sYXlvdXQoc2VsZiwgaXNfZmlsZTogYm9vbCA9IFRydWUsIGlzX2h0bTogYm9vbCA9IEZhbHNlKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF9kYXRlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkRGF0ZVRleHRTaXplJykKICAgICAgICBwb3B1cF92YWx1ZXMgPSBbJ9CY0L3RhNC+J10KICAgICAgICBpZiBpc19maWxlOgogICAgICAgICAgICBwb3B1cF92YWx1ZXMuYXBwZW5kKCfQn9C10YDQtdC00LDRgtGMINC90LAg0JHQkScpCiAgICAgICAgICAgIGlmIGlzX2h0bToKICAgICAgICAgICAgICAgIHBvcHVwX3ZhbHVlcy5hcHBlbmQoJ9Co0LDQsdC70L7QvSDQv9C10YfQsNGC0LgnKQogICAgICAgIGxheW91dCA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BwaWN0dXJlJywKICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1GYWxzZSwKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BmaWxlX25hbWUnLAogICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlBvcHVwTWVudUJ1dHRvbigKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nOycuam9pbihwb3B1cF92YWx1ZXMpLAogICAgICAgICAgICAgICAgICAgIFZhcmlhYmxlPSJzZW50IiwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MCwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSJob3Jpem9udGFsIiwKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZmlsZV9zaXplJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNyZWF0aW9uX3RpbWUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgKSwKCiAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiCiAgICAgICAgKQogICAgICAgIHJldHVybiBsYXlvdXQKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0X2FsbF9maWxlc19mcm9tX3BhdGNoKGRpcmVjdG9yeTogc3RyKSAtPiBMaXN0W0RpY3RdOgogICAgICAgIGZpbGVzX2luZm8gPSBbXQogICAgICAgICMgV2FsayB0aHJvdWdoIHRoZSBmb2xkZXIgYW5kIGl0cyBzdWJkaXJlY3RvcmllcwogICAgICAgIGRpcmVjdG9yeV9wYXRoID0gUGF0aChkaXJlY3RvcnkpCiAgICAgICAgZm9yIGZpbGUgaW4gZGlyZWN0b3J5X3BhdGguaXRlcmRpcigpOgogICAgICAgICAgICBwaWMgPSAoJyNmMTViJyBpZiBmaWxlLmlzX2ZpbGUoKSBlbHNlCiAgICAgICAgICAgICAgICAgICAnI2YwYzEnIGlmIGZpbGUuaXNfc3ltbGluaygpIGVsc2UgJyNmMDdiJykKICAgICAgICAgICAgZmlsZV90eXBlID0gKCJGaWxlIiBpZiBmaWxlLmlzX2ZpbGUoKSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAiU3ltTGluayIgaWYgZmlsZS5pc19zeW1saW5rKCkgZWxzZSAiRm9sZGVyIikKICAgICAgICAgICAgZm9ybWF0dGVkX2NyZWF0aW9uX3RpbWUgPSB0aW1lLnN0cmZ0aW1lKAogICAgICAgICAgICAgICAgJyVZLSVtLSVkICVIOiVNOiVTJywKICAgICAgICAgICAgICAgIHRpbWUubG9jYWx0aW1lKGludChmaWxlLnN0YXQoKS5zdF9jdGltZSkpCiAgICAgICAgICAgICkKICAgICAgICAgICAgZmlsZV9pbmZvID0gewogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMsCiAgICAgICAgICAgICAgICAnZmlsZV90eXBlJzogZmlsZV90eXBlLAogICAgICAgICAgICAgICAgJ2ZpbGVfbmFtZSc6IGZpbGUubmFtZSwKICAgICAgICAgICAgICAgICdmdWxsX3BhdGgnOiBzdHIoZGlyZWN0b3J5X3BhdGguam9pbnBhdGgoZmlsZS5uYW1lKSksCiAgICAgICAgICAgICAgICAnZmlsZV9zaXplJzogZid7ZmlsZS5zdGF0KCkuc3Rfc2l6ZSAvIDEwMjQ6LjJmfSBLQicsCiAgICAgICAgICAgICAgICAnY3JlYXRpb25fdGltZSc6IGZvcm1hdHRlZF9jcmVhdGlvbl90aW1lLAogICAgICAgICAgICAgICAgJ2V4dGVuc2lvbic6IGZpbGUuc3VmZml4CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZmlsZXNfaW5mby5hcHBlbmQoZmlsZV9pbmZvKQoKICAgICAgICByZXR1cm4gZmlsZXNfaW5mbwoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdsYXlvdXRfbGlzdGVuZXInKQogICAgICAgIHNlbGVjdGVkX2NhcmQ6IGRpY3QgPSBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KCdjYXJkX2RhdGEnKSkKICAgICAgICBpZiBsaXN0ZW5lciA9PSAn0J/QtdGA0LXQtNCw0YLRjCDQvdCwINCR0JEnOgogICAgICAgICAgICBzZWxmLl9jb3B5X2ZpbGUoUGF0aChzZWxlY3RlZF9jYXJkWydmdWxsX3BhdGgnXSkpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAn0JjQvdGE0L4nOgogICAgICAgICAgICBzZWxlY3RlZF9jYXJkLnBvcCgnX2xheW91dCcsIE5vbmUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc3RyKHNlbGVjdGVkX2NhcmQpKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ9Co0LDQsdC70L7QvSDQv9C10YfQsNGC0LgnOgogICAgICAgICAgICBwcmludF9uY2wgPSBub0NsYXNzKCJwcmludF9uY2wiKQogICAgICAgICAgICBwcmludF9uY2wucHV0KCdsYWJsZV9maWxlX25hbWUnLCBzZWxlY3RlZF9jYXJkLmdldCgnZmlsZV9uYW1lJyksIFRydWUpCiAgICAgICAgICAgIHByaW50X25jbC5wdXQoJ2xhYmxlX2Z1bGxfcGF0aCcsIHNlbGVjdGVkX2NhcmQuZ2V0KCdmdWxsX3BhdGgnKSwgVHJ1ZSkKICAgICAgICAgICAgcHJpbnRfbmNsLnB1dCgnZnJvbV9maWxlX2Jyb3dzZXInLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ9Cf0LXRh9Cw0YLRjCcsICfQoNC10LfRg9C70YzRgtCw0YInKQoKICAgIGRlZiBfY29weV9maWxlKHNlbGYsIGZpbGU6IFBhdGgpOgogICAgICAgIGlwX2hvc3QgPSBzZWxmLmhhc2hfbWFwLmdldCgnaXBfaG9zdCcpIG9yIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdkZWJ1Z19ob3N0X2lwJykgIyAnMTkyLjE2OC4xLjc3JwogICAgICAgIHdpdGggb3BlbihmaWxlLCAncmInKSBhcyBmOgogICAgICAgICAgICAjIHNlbmRfc2VydmljZSA9IHNlbGYuaHNfc2VydmljZShpcF9ob3N0KQogICAgICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UuZXhwb3J0X2ZpbGUoZmlsZS5uYW1lLCBmKQoKICAgICAgICAgICAgaWYgcmVzWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZifQpNCw0LnQuyB7ZmlsZS5uYW1lfSDRg9GB0L/QtdGI0L3QviDQstGL0LPRgNGD0LbQtdC9JykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjycpCgoKIyA9PT09PT09PT09PT09PT09PT09PSBUaWxlcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgVGlsZXMoU2NyZWVuKToKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9nZXRfdGlsZV9yb3coc2VsZiwgbGF5b3V0LCB0aWxlX2VsZW1lbnQsIHN0YXJ0X3NjcmVlbj0n0JTQvtC60YPQvNC10L3RgtGLJyk6CiAgICAgICAgdGlsZSA9IHsKICAgICAgICAgICAgImxheW91dCI6IGxheW91dCwKICAgICAgICAgICAgImRhdGEiOiBzZWxmLl9nZXRfdGlsZV9kYXRhKHRpbGVfZWxlbWVudCksCiAgICAgICAgICAgICJoZWlnaHQiOiAid3JhcF9jb250ZW50IiwKICAgICAgICAgICAgImNvbG9yIjogJyNGRkZGRkYnLAogICAgICAgICAgICAic3RhcnRfc2NyZWVuIjogZiJ7c3RhcnRfc2NyZWVufSIsCiAgICAgICAgICAgICJzdGFydF9wcm9jZXNzIjogIiIsCiAgICAgICAgICAgICdrZXknOiB0aWxlX2VsZW1lbnRbJ2RvY1R5cGUnXQogICAgICAgIH0KICAgICAgICByZXR1cm4gdGlsZQoKICAgIGRlZiBfZ2V0X21lc3NhZ2VfdGlsZShzZWxmLCBtZXNzYWdlLCB0ZXh0X2NvbG9yPScjMDAwMDAwJyk6CiAgICAgICAgdGlsZV92aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICBWYWx1ZT0nQG5vX2RhdGEnLAogICAgICAgICAgICAgICAgVGV4dFNpemU9c2VsZi5yc19zZXR0aW5ncy5nZXQoJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZScpLAogICAgICAgICAgICAgICAgVGV4dENvbG9yPXRleHRfY29sb3IsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0wLAogICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSJjZW50ZXIiLAogICAgICAgICAgICAgICAgZ3Jhdml0eV92ZXJ0aWNhbD0iY2VudGVyIiwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTAsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9IiNmZmZmZmYiLAogICAgICAgICAgICAgICAgUGFkZGluZz0wCgogICAgICAgICAgICApLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgYXV0b1NpemVUZXh0VHlwZT0ndW5pZm9ybScsCiAgICAgICAgICAgIHdlaWdodD0wLAogICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0iY2VudGVyIiwKICAgICAgICAgICAgZ3Jhdml0eV92ZXJ0aWNhbD0iY2VudGVyIiwKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPSIjZmZmZmZmIiwKICAgICAgICAgICAgUGFkZGluZz0wCiAgICAgICAgKQoKICAgICAgICBsYXlvdXQgPSBqc29uLmxvYWRzKHRpbGVfdmlldy50b19qc29uKCkpCgogICAgICAgIHRpbGVzX2xpc3QgPSBbewogICAgICAgICAgICAibGF5b3V0IjogbGF5b3V0LAogICAgICAgICAgICAiZGF0YSI6IHsibm9fZGF0YSI6IG1lc3NhZ2V9LAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJjb2xvciI6ICcjZmZmZmZmJywKICAgICAgICAgICAgInN0YXJ0X3NjcmVlbiI6ICIiLAogICAgICAgICAgICAic3RhcnRfcHJvY2VzcyI6ICIiLAogICAgICAgICAgICAnU3Ryb2tlV2lkdGgnOiAnJywKICAgICAgICB9XQoKICAgICAgICBjb3VudF9yb3dfZWxlbWVudHMgPSAxCiAgICAgICAgdGlsZXMgPSB7CiAgICAgICAgICAgICd0aWxlcyc6IFt0aWxlc19saXN0XSwKICAgICAgICAgICAgJ2JhY2tncm91bmRfY29sb3InOiAnI2ZmZmZmZicsCiAgICAgICAgICAgICdTdHJva2VXaWR0aCc6ICcnLAogICAgICAgICAgICAnaGVpZ2h0JzogJycKCiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdGlsZXMKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KToKICAgICAgICBjb3VudF92ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsnY291bnRfdmVyaWZpZWQnXSBvciAwCiAgICAgICAgY291bnRfdW52ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsnY291bnRfdW52ZXJpZmllZCddIG9yIDAKICAgICAgICBxdHR5X3BsYW5fdmVyaWZpZWQgPSB0aWxlX2VsZW1lbnRbJ3F0dHlfcGxhbl92ZXJpZmllZCddIG9yIDAKICAgICAgICBxdHR5X3BsYW5fdW52ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsncXR0eV9wbGFuX3VudmVyaWZpZWQnXSBvciAwCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJkb2NOYW1lIjogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10sCiAgICAgICAgICAgICdRdHR5T2ZEb2NzJzogJ3t9L3t9Jy5mb3JtYXQodGlsZV9lbGVtZW50Wydjb3VudCddLCB0aWxlX2VsZW1lbnRbJ3ZlcmlmaWVkJ10pLAogICAgICAgICAgICAnY291bnRfdmVyaWZpZWQnOiAne30ve30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIGNvdW50X3ZlcmlmaWVkICsgY291bnRfdW52ZXJpZmllZCwKICAgICAgICAgICAgICAgIGNvdW50X3VudmVyaWZpZWQpLAogICAgICAgICAgICAncXR0eV9wbGFuX3ZlcmlmaWVkJzogJ3t9L3t9Jy5mb3JtYXQoCiAgICAgICAgICAgICAgICBxdHR5X3BsYW5fdmVyaWZpZWQgKyBxdHR5X3BsYW5fdW52ZXJpZmllZCwKICAgICAgICAgICAgICAgIHF0dHlfcGxhbl91bnZlcmlmaWVkKQogICAgICAgIH0KCiAgICBkZWYgX2dldF90aWxlX3ZpZXcoc2VsZikgLT4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQ6CiAgICAgICAgdGlsZXNfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgVmFsdWU9J0Bkb2NOYW1lJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXNlbGYucnNfc2V0dGluZ3MuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQFF0dHlPZkRvY3MnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQodGC0YDQvtC6OiAnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bjb3VudF92ZXJpZmllZCcsIHNlbGYucnNfc2V0dGluZ3MpLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ci0L7QstCw0YDQvtCyOiAnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BxdHR5X3BsYW5fdmVyaWZpZWQnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGF1dG9TaXplVGV4dFR5cGU9J3VuaWZvcm0nLAogICAgICAgICAgICB3ZWlnaHQ9MAogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRpbGVzX3ZpZXcKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUsIHJzX3NldHRpbmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgICAgIHNlbGYuVGV4dFNpemUgPSByc19zZXR0aW5ncy5nZXQoJ0RvY1R5cGVDYXJkVGV4dFNpemUnKQogICAgICAgICAgICBzZWxmLlRleHRDb2xvciA9ICcjMzMzMzMzJwogICAgICAgICAgICBzZWxmLkJhY2tncm91bmRDb2xvciA9ICdGRkNDOTknCiAgICAgICAgICAgIHNlbGYud2VpZ2h0ID0gMAogICAgICAgICAgICBzZWxmLlZhbHVlID0gdmFsdWUKCgpjbGFzcyBGbG93VGlsZXNTY3JlZW4oVGlsZXMpOgogICAgc2NyZWVuX25hbWUgPSAn0J/Qu9C40YLQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9Ch0LHQvtGAINCo0JonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZShpc19iYXJjX2Zsb3c9VHJ1ZSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKCiAgICAgICAgZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfZG9jX2Zsb3dfc3RhdCgpCiAgICAgICAgaWYgZGF0YToKICAgICAgICAgICAgIyBsYXlvdXQgPSBzZWxmLl9nZXRfdGlsZV92aWV3KCkKICAgICAgICAgICAgbGF5b3V0ID0ganNvbi5sb2FkcyhzZWxmLl9nZXRfdGlsZV92aWV3KCkudG9fanNvbigpKQoKICAgICAgICAgICAgdGlsZXNfbGlzdCA9IFtzZWxmLl9nZXRfdGlsZV9yb3cobGF5b3V0LCBpdGVtKSBmb3IgaXRlbSBpbiBkYXRhXQoKICAgICAgICAgICAgIyBzcGxpdCBsaXN0IGJ5IHR3byBlbGVtZW50IGluIHJvdwogICAgICAgICAgICBjb3VudF9yb3dfZWxlbWVudHMgPSAyCiAgICAgICAgICAgIHRpbGVzID0gewogICAgICAgICAgICAgICAgJ3RpbGVzJzogWwogICAgICAgICAgICAgICAgICAgIHRpbGVzX2xpc3RbaTppICsgY291bnRfcm93X2VsZW1lbnRzXQogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbih0aWxlc19saXN0KSwgY291bnRfcm93X2VsZW1lbnRzKQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICdiYWNrZ3JvdW5kX2NvbG9yJzogJyNmNWY1ZjUnCgogICAgICAgICAgICB9CiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGlsZXMgPSBzZWxmLl9nZXRfbWVzc2FnZV90aWxlKCLQndC10YIg0LfQsNCz0YDRg9C20LXQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0L7QsiIpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0aWxlcycsIHRpbGVzLCB0b19qc29uPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgX2dldF90aWxlX3ZpZXcoc2VsZikgLT4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQ6CiAgICAgICAgdGlsZXNfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgVmFsdWU9J0Bkb2NOYW1lJywKICAgICAgICAgICAgICAgIFRleHRTaXplPXNlbGYucnNfc2V0dGluZ3MuZ2V0KCd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnKSwKICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQFF0dHlPZkRvY3MnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQodGC0YDQvtC6OiAnLCBzZWxmLnJzX3NldHRpbmdzKSwKICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BiYXJjX2NvdW50Jywgc2VsZi5yc19zZXR0aW5ncyksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICksCgogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgYXV0b1NpemVUZXh0VHlwZT0ndW5pZm9ybScsCiAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGlsZXNfdmlldwoKICAgIGRlZiBfZ2V0X3RpbGVfcm93KHNlbGYsIGxheW91dCwgdGlsZV9lbGVtZW50LCBzdGFydF9zY3JlZW49J9CU0L7QutGD0LzQtdC90YLRiycpOgogICAgICAgIHRpbGUgPSB7CiAgICAgICAgICAgICJsYXlvdXQiOiBsYXlvdXQsCiAgICAgICAgICAgICJkYXRhIjogc2VsZi5fZ2V0X3RpbGVfZGF0YSh0aWxlX2VsZW1lbnQpLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJjb2xvciI6ICcjRkZGRkZGJywKICAgICAgICAgICAgInN0YXJ0X3NjcmVlbiI6IGYie3N0YXJ0X3NjcmVlbn0iLAogICAgICAgICAgICAic3RhcnRfcHJvY2VzcyI6ICIiLAogICAgICAgICAgICAna2V5JzogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgX2dldF90aWxlX2RhdGEodGlsZV9lbGVtZW50KToKICAgICAgICBjb3VudF92ZXJpZmllZCA9IHRpbGVfZWxlbWVudFsndmVyaWZpZWQnXSBvciAwCiAgICAgICAgIyBjb3VudF91bnZlcmlmaWVkID0gdGlsZV9lbGVtZW50Wydjb3VudF91bnZlcmlmaWVkJ10gb3IgMAogICAgICAgIGJhcmNfY291bnQgPSB0aWxlX2VsZW1lbnRbJ2JhcmNfY291bnQnXSBvciAwCgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJkb2NOYW1lIjogdGlsZV9lbGVtZW50Wydkb2NUeXBlJ10sCiAgICAgICAgICAgICdRdHR5T2ZEb2NzJzogJ3t9L3t9Jy5mb3JtYXQodGlsZV9lbGVtZW50Wydjb3VudCddLCB0aWxlX2VsZW1lbnRbJ3ZlcmlmaWVkJ10pLAogICAgICAgICAgICAnY291bnRfdmVyaWZpZWQnOiBzdHIoY291bnRfdmVyaWZpZWQpLAogICAgICAgICAgICAnYmFyY19jb3VudCc6IHN0cihiYXJjX2NvdW50KQogICAgICAgIH0KCgpjbGFzcyBHcm91cFNjYW5UaWxlcyhUaWxlcyk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C70LjRgtC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKGlzX2dyb3VwX3NjYW49VHJ1ZSkKICAgICAgICBzZWxmLnNjcmVlbl9uYW1lID0gc2VsZi5oYXNoX21hcC5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIHNlbGYucHJvY2Vzc19uYW1lID0gc2VsZi5oYXNoX21hcC5nZXRfY3VycmVudF9wcm9jZXNzKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBpZiBub3Qgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICB0aWxlcyA9IHNlbGYuX2dldF9tZXNzYWdlX3RpbGUoItCe0YLRgdGD0YLRgdGC0LLRg9C10YIg0YHQvtC10LTQuNC90LXQvdC40LUg0YEg0YHQtdGA0LLQtdGA0L7QvCIsIHRleHRfY29sb3I9IiNmZjAwMDAiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndGlsZXMnLCB0aWxlcywgdG9fanNvbj1UcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY2hlY2tfY29ubmVjdGlvbiddID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NoZWNrX2Nvbm5lY3Rpb24nXSA9IFRydWUKCiAgICAgICAgZGF0YSA9IHNlbGYuX2dldF9kb2NzX3N0YXQoKQoKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBsYXlvdXQgPSBqc29uLmxvYWRzKHNlbGYuX2dldF90aWxlX3ZpZXcoKS50b19qc29uKCkpCgogICAgICAgICAgICB0aWxlc19saXN0ID0gW3NlbGYuX2dldF90aWxlX3JvdyhsYXlvdXQsIGl0ZW0pIGZvciBpdGVtIGluIGRhdGFdCgogICAgICAgICAgICAjIHNwbGl0IGxpc3QgYnkgdHdvIGVsZW1lbnQgaW4gcm93CiAgICAgICAgICAgIGNvdW50X3Jvd19lbGVtZW50cyA9IDIKICAgICAgICAgICAgdGlsZXMgPSB7CiAgICAgICAgICAgICAgICAndGlsZXMnOiBbCiAgICAgICAgICAgICAgICAgICAgdGlsZXNfbGlzdFtpOmkgKyBjb3VudF9yb3dfZWxlbWVudHNdCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHRpbGVzX2xpc3QpLCBjb3VudF9yb3dfZWxlbWVudHMpCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgJ2JhY2tncm91bmRfY29sb3InOiAnI2Y1ZjVmNScKCiAgICAgICAgICAgIH0KICAgICAgICBlbHNlOgogICAgICAgICAgICB0aWxlcyA9IHNlbGYuX2dldF9tZXNzYWdlX3RpbGUoItCd0LXRgiDQt9Cw0LPRgNGD0LbQtdC90L3Ri9GFINC00L7QutGD0LzQtdC90YLQvtCyIikKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3RpbGVzJywgdGlsZXMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgaWYgKHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBvcgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5jb250YWluc0tleSgnY2hlY2tfY29ubmVjdGlvbicpKToKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPWhzX3NlcnZpY2UudXJsKQogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIF9nZXRfZG9jc19zdGF0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRiX3NlcnZpY2UuZ2V0X2RvY3Nfc3RhdCgpCgoKY2xhc3MgRG9jdW1lbnRzVGlsZXMoR3JvdXBTY2FuVGlsZXMpOgogICAgc2NyZWVuX25hbWUgPSAn0J/Qu9C40YLQutC4JwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBEb2NTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIF9jaGVja19jb25uZWN0aW9uKHNlbGYpOgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9nZXRfZG9jc19zdGF0KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmRiX3NlcnZpY2UuZ2V0X2RvY3Nfc3RhdCgpCgoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gVGlsZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBEb2NzTGlzdCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERvY3NMaXN0U2NyZWVuKFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzPU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gRG9jU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0ge30KICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICcnCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIGRvY190eXBlcyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3R5cGVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9zZWxlY3QnXSA9ICc7Jy5qb2luKFsn0JLRgdC1J10gKyBkb2NfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3N0YXR1c19zZWxlY3QnXSA9ICfQktGB0LU70Jog0LLRi9C/0L7Qu9C90LXQvdC40Y470JLRi9Cz0YDRg9C20LXQvTvQmiDQstGL0LPRgNGD0LfQutC1JwoKICAgICAgICBkb2NfdHlwZSA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3RpbGVfa2V5J10gb3Igc2VsZi5oYXNoX21hcFsnZG9jX3R5cGVfY2xpY2snXQogICAgICAgIGRvY19zdGF0dXMgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9kb2Nfc3RhdHVzJ10KICAgICAgICBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddID0gZG9jX3R5cGUKICAgICAgICBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF90aWxlX2tleSddID0gJycKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLl9nZXRfZG9jX2xpc3RfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKCiAgICAgICAgcHJlcGFyZWRfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShsaXN0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICcnCiAgICAgICAgZG9jX2NhcmRzID0gc2VsZi5fZ2V0X2RvY19jYXJkc192aWV3KHByZXBhcmVkX2RhdGEsIHNlbGYucG9wdXBfbWVudV9kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY0NhcmRzJ10gPSBkb2NfY2FyZHMudG9fanNvbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAiZG9jX3N0YXR1c19jbGljayI6CiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfZG9jX3N0YXR1cyddID0gc2VsZi5oYXNoX21hcFsiZG9jX3N0YXR1c19jbGljayJdCiAgICAgICAgICAgIHNlbGYuX2RvY19zdGF0dXNfY2xpY2soKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIHNlbGYuX2xheW91dF9hY3Rpb24oKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV9kZWxldGUnKToKICAgICAgICAgICAgc2VsZi5jb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fcmVzZW5kX2RvYycpOgogICAgICAgICAgICBzZWxmLl9yZXNlbmRfZG9jKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUsIGFyZ3MpCgogICAgZGVmIF9sYXlvdXRfYWN0aW9uKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcFsnbGF5b3V0X2xpc3RlbmVyJ10KCiAgICAgICAgaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQo9C00LDQu9C40YLRjCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coCiAgICAgICAgICAgICAgICBsaXN0ZW5lcj0nY29uZmlybV9kZWxldGUnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Cj0LTQsNC70LjRgtGMINC00L7QutGD0LzQtdC90YIg0YEg0YPRgdGC0YDQvtC50YHRgtCy0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coCiAgICAgICAgICAgICAgICBsaXN0ZW5lcj0nY29uZmlybV9jbGVhcl9iYXJjb2RlX2RhdGEnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsD8nCiAgICAgICAgICAgICkKICAgICAgICBlbGlmIGxheW91dF9saXN0ZW5lciA9PSAn0J7RgtC/0YDQsNCy0LjRgtGMINC/0L7QstGC0L7RgNC90L4nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fcmVzZW5kX2RvYycsCiAgICAgICAgICAgICAgICB0aXRsZT0n0J7RgtC/0YDQsNCy0LjRgtGMINC00L7QutGD0LzQtdC90YIg0L/QvtCy0YLQvtGA0L3Qvj8nCiAgICAgICAgICAgICkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0LvQuNGC0LrQuCcpCgogICAgZGVmIF9kb2Nfc3RhdHVzX2NsaWNrKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2RvY19zdGF0dXMnXSA9IHNlbGYuaGFzaF9tYXBbImRvY19zdGF0dXNfY2xpY2siXQogICAgICAgIHNlbGYuY3VycmVudF9zdGF0dXMgPSBzZWxmLmhhc2hfbWFwWyJkb2Nfc3RhdHVzX2NsaWNrIl0KCiAgICBkZWYgX3Jlc2VuZF9kb2Moc2VsZik6CiAgICAgICAgaWRfZG9jID0gc2VsZi5nZXRfaWRfZG9jKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydkZWJ1Z19pZF9kb2MnXSA9IGlkX2RvYwogICAgICAgIGRvY19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kYXRhX3RvX3NlbmRfYnlfZG9jX2lkKGlkX2RvYykKCiAgICAgICAgaWYgZG9jX2RhdGE6CiAgICAgICAgICAgIGh0dHBfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShodHRwX3BhcmFtcz1zZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFuc3dlciA9IGh0dHBfc2VydmljZS5zZW5kX2RhdGEoZG9jX2RhdGEpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGh0dHBfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0LLRi9Cz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0LAnKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICAgICBpZiBhbnN3ZXIuZXJyb3I6CiAgICAgICAgICAgICAgICBodHRwX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9YW5zd2VyLmVycm9yX3RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQstGL0LPRgNGD0LfQutC4INC00L7QutGD0LzQtdC90YLQsCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY192YWx1ZXModmVyaWZpZWQ9MSwgc2VudD0xKQogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDQvtGC0L/RgNCw0LLQu9C10L0g0L/QvtCy0YLQvtGA0L3QvicpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L7RgtC/0YDQsNCy0LrQuCcpCiAgICAgICAgICAgIHJldHVybgoKICAgIGRlZiBfZ2V0X2RvY19saXN0X2RhdGEoc2VsZiwgZG9jX3R5cGUsIGRvY19zdGF0dXMpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZpZXdfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKICAgICAgICByZXR1cm4gcmVzdWx0cwoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGxpc3RfZGF0YSk6CiAgICAgICAgdGFibGVfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBsaXN0X2RhdGE6CiAgICAgICAgICAgIGRvY19zdGF0dXMgPSAnJwoKICAgICAgICAgICAgaWYgcmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0JLRi9Cz0YDRg9C20LXQvScKICAgICAgICAgICAgZWxpZiByZWNvcmRbJ3ZlcmlmaWVkJ106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQs9GA0YPQt9C60LUnCiAgICAgICAgICAgIGVsaWYgbm90IChyZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddKToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nCgogICAgICAgICAgICBkb2NfdGl0bGUgPSAne30g4oSWIHt9INC+0YIge30nLmZvcm1hdCgKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10pCgogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZF9kb2MnXSwKICAgICAgICAgICAgICAgICd0eXBlJzogcmVjb3JkWydkb2NfdHlwZSddLAogICAgICAgICAgICAgICAgJ251bWJlcic6IHJlY29yZFsnZG9jX24nXSwKICAgICAgICAgICAgICAgICdkb2NfdGl0bGUnOiBkb2NfdGl0bGUsCiAgICAgICAgICAgICAgICAnZGF0YSc6IHNlbGYuX2Zvcm1hdF9kYXRlKHJlY29yZFsnZG9jX2RhdGUnXSksCiAgICAgICAgICAgICAgICAnd2FyZWhvdXNlJzogcmVjb3JkWydSU193YXJlaG91c2UnXSwKICAgICAgICAgICAgICAgICdjb3VudHJhZ2VudCc6IHJlY29yZFsnUlNfY291bnRyYWdlbnQnXSwKICAgICAgICAgICAgICAgICdhZGRfbWFya19zZWxlY3Rpb24nOiByZWNvcmRbJ2FkZF9tYXJrX3NlbGVjdGlvbiddLAogICAgICAgICAgICAgICAgJ3N0YXR1cyc6IGRvY19zdGF0dXMsCiAgICAgICAgICAgICAgICAnaXNfZ3JvdXBfc2Nhbic6IHJlY29yZFsnaXNfZ3JvdXBfc2NhbiddCiAgICAgICAgICAgIH0pCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX2NhcmRzX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSwgcG9wdXBfbWVudV9kYXRhKToKICAgICAgICB0aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgiVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfZGF0ZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZERhdGVUZXh0U2l6ZScpCgogICAgICAgIGRvY19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzdGF0dXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdHlwZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT1wb3B1cF9tZW51X2RhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgIFZhcmlhYmxlPSJtZW51X2RlbGV0ZSIsCiAgICAgICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAoKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG51bWJlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAY291bnRyYWdlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHdhcmVob3VzZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfZGF0ZV90ZXh0X3NpemUKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoc2VsZiwgcHV0X2RhdGE9Tm9uZSk6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXQoInNlbGVjdGVkX2NhcmRfZGF0YSIsIGZyb21fanNvbj1UcnVlKQoKICAgICAgICBwdXRfZGF0YSA9IHB1dF9kYXRhIG9yIHt9CiAgICAgICAgcHV0X2RhdGFbJ2lkX2RvYyddID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgIHB1dF9kYXRhWydkb2NfdHlwZSddID0gY2FyZF9kYXRhWyd0eXBlJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX24nXSA9IGNhcmRfZGF0YVsnbnVtYmVyJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX2RhdGUnXSA9IGNhcmRfZGF0YVsnZGF0YSddCiAgICAgICAgcHV0X2RhdGFbJ3dhcmVob3VzZSddID0gY2FyZF9kYXRhWyd3YXJlaG91c2UnXQogICAgICAgIHB1dF9kYXRhWydjb3VudHJhZ2VudCddID0gY2FyZF9kYXRhWydjb3VudHJhZ2VudCddCgogICAgICAgIHJldHVybiBwdXRfZGF0YQoKICAgIGRlZiBfc2V0X2RvY192ZXJpZmllZChzZWxmLCBpZF9kb2MsIHZhbHVlPVRydWUpOgogICAgICAgICMgc2VydmljZSA9IERvY1NlcnZpY2UoaWRfZG9jKQogICAgICAgIHZhbHVlID0gc3RyKGludCh2YWx1ZSkpCgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2NfdmFsdWUoJ3ZlcmlmaWVkJywgdmFsdWUpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhlLmFyZ3NbMF0pCgogICAgZGVmIGRvY19kZWxldGUoc2VsZiwgaWRfZG9jKToKCiAgICAgICAgcmVzdWx0ID0gVHJ1ZQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS5kZWxldGVfZG9jKGlkX2RvYykKICAgICAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlLnJlbW92ZV9kb2NfbGluZXMoaWRfZG9jKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5lcnJvcl9sb2coZS5hcmdzWzBdKQogICAgICAgICAgICByZXN1bHQgPSBGYWxzZQoKICAgICAgICByZXR1cm4gcmVzdWx0CgogICAgZGVmIGdldF9kb2NzX2NvdW50KHNlbGYsIGRvY190eXBlPScnKToKICAgICAgICBkb2NfdHlwZSA9ICcnIGlmIG5vdCBkb2NfdHlwZSBvciBkb2NfdHlwZSA9PSAn0JLRgdC1JyBlbHNlIGRvY190eXBlCiAgICAgICAgcmV0dXJuIHNlbGYuc2VydmljZS5nZXRfZG9jc19jb3VudChkb2NfdHlwZSkKCiAgICBkZWYgX2NsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKCiAgICBkZWYgY29uZmlybV9kZWxldGVfZG9jX2xpc3RlbmVyKHNlbGYpOgogICAgICAgIGNhcmRfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpCiAgICAgICAgaWRfZG9jID0gY2FyZF9kYXRhWydrZXknXQogICAgICAgIGRvY190eXBlID0gc2VsZi5oYXNoX21hcFsnZG9jX3R5cGVfY2xpY2snXQoKICAgICAgICBpZiBzZWxmLmRvY19kZWxldGUoaWRfZG9jKToKICAgICAgICAgICAgZG9jc19jb3VudCA9IHNlbGYuZ2V0X2RvY3NfY291bnQoZG9jX3R5cGU9ZG9jX3R5cGUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CU0L7QutGD0LzQtdC90YIg0YPRgdC/0LXRiNC90L4g0YPQtNCw0LvRkdC9JykKICAgICAgICAgICAgaWYgZG9jc19jb3VudDoKICAgICAgICAgICAgICAgIHNlbGYub25fc3RhcnQoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/Qu9C40YLQutC4JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YPQtNCw0LvQtdC90LjRjyDQtNC+0LrRg9C80LXQvdGC0LAnKQoKICAgIGRlZiBfZm9ybWF0X2RhdGUoc2VsZiwgZGF0ZV9zdHI6IHN0cik6CiAgICAgICAgcmV0dXJuIGRhdGV0aW1lLmZyb21pc29mb3JtYXQoZGF0ZV9zdHIpLnN0cmZ0aW1lKCclbS0lZC0lWSAlSDolTTolUycpCgogICAgZGVmIGdldF9pZF9kb2Moc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikgb3Ige30KICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGEuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKICAgIGRlZiBnZXRfZG9jX251bWJlcihzZWxmKToKICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCJjYXJkX2RhdGEiKSBvciB7fQogICAgICAgIGRvY19udW1iZXIgPSBjYXJkX2RhdGEuZ2V0KCdudW1iZXInKQogICAgICAgIHJldHVybiBkb2NfbnVtYmVyCgoKY2xhc3MgR3JvdXBTY2FuRG9jc0xpc3RTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlLmlzX2dyb3VwX3NjYW4gPSBUcnVlCiAgICAgICAgc2VsZi5wb3B1cF9tZW51X2RhdGEgPSAnOycuam9pbigKICAgICAgICAgICAgWyfQo9C00LDQu9C40YLRjCcsIF0pICAjJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCcKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjdXJyZW50X21vZGUgPSAi0L7RhNGE0LvQsNC50L0iIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKSBlbHNlICLQvtC90LvQsNC50L0iCiAgICAgICAgICAgIHdhcm5pbmdfbXNnID0gIiDQlNC+0LrRg9C80LXQvdGCINC90LUg0LHRg9C00LXRgiDQtNC+0YHRgtGD0L/QtdC9INCyINC00YDRg9Cz0LjRhSDQv9GA0L7RhtC10YHRgdCw0YUuIgogICAgICAgICAgICBtc2cgPSAoZiLQktGLINC+0YLQutGA0YvQstCw0LXRgtC1INC00L7QutGD0LzQtdC90YIg0LPRgNGD0L/Qv9C+0LLRg9GOINC+0LHRgNCw0LHQvtGC0LrRgyDQtNC+0LrRg9C80LXQvdGC0LAgIgogICAgICAgICAgICAgICAgICAgZiLQsiB7Y3VycmVudF9tb2RlLnVwcGVyKCl9INGA0LXQttC40LzQtS4iKQogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKVsnaXNfZ3JvdXBfc2NhbiddID09ICcwJzoKICAgICAgICAgICAgICAgIG1zZyArPSB3YXJuaW5nX21zZwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZ3JvdXBfc2Nhbl9tZXNzYWdlJywgbXNnKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygn0J/QvtC00YLQstC10YDQtNC40YLQtSDQtNC10LnRgdGC0LLQuNC1JykKICAgICAgICAgICAgc2VsZWN0ZWRfY2FyZF9rZXkgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2lkX2RvYyddID0gc2VsZWN0ZWRfY2FyZF9rZXkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9Cf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0LTQtdC50YHRgtCy0LjQtScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgICAgICBzZWxmLnNlcnZpY2UuZG9jX2lkID0gaWRfZG9jCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpWydpc19ncm91cF9zY2FuJ10gPT0gJzAnOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnJlc2V0X2RvY190YWJsZXNfcXR0eSgpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCd2ZXJpZmllZCcsIDEpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3ZhbHVlKCdpc19ncm91cF9zY2FuJywgJzEnKQoKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICAgICAgICAgIHNjcmVlbiA9IFNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgICAgICBzY3JlZW5fbmFtZT1zY3JlZW5fbmFtZSwKICAgICAgICAgICAgICAgIHByb2Nlc3M9c2VsZi5wcm9jZXNzX25hbWUsCiAgICAgICAgICAgICAgICBoYXNoX21hcD1zZWxmLmhhc2hfbWFwLAogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3M9c2VsZi5yc19zZXR0aW5ncykKCiAgICAgICAgICAgIHNjcmVlbi5zaG93KGFyZ3M9c2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoKSkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2NsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCiAgICAgICAgICAgIHNlbGYucXVldWVfc2VydmljZS5yZW1vdmVfZG9jX2xpbmVzKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQlNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwINC4INC80LDRgNC60LjRgNC+0LLQutC4INC+0YfQuNGJ0LXQvdGLJykKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoaWRfZG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J/RgNC4INC+0YfQuNGB0YLQutC1INC00LDQvdC90YvRhSDQv9C10YDQtdGB0YfQtdGC0LAg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gRmFsc2UKCgpjbGFzcyBEb2N1bWVudHNEb2NzTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQlNC+0LrRg9C80LXQvdGC0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZS5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCcsICfQntGC0L/RgNCw0LLQuNGC0Ywg0L/QvtCy0YLQvtGA0L3QviddKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzdXBlcigpLm9uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXSA9IGlkX2RvYwogICAgICAgICAgICAjIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX2NhcmRfa2V5J10KICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRvY19pZCA9IGlkX2RvYwoKICAgICAgICAgICAgbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICAgICAgICAgIHNjcmVlbiA9IFNjcmVlbnNGYWN0b3J5LmNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgICAgICBzY3JlZW5fbmFtZT1zY3JlZW5fbmFtZSwKICAgICAgICAgICAgICAgIHByb2Nlc3M9c2VsZi5wcm9jZXNzX25hbWUsCiAgICAgICAgICAgICAgICBoYXNoX21hcD1zZWxmLmhhc2hfbWFwLAogICAgICAgICAgICAgICAgcnNfc2V0dGluZ3M9c2VsZi5yc19zZXR0aW5ncykKCiAgICAgICAgICAgIHNjcmVlbi5zaG93KGFyZ3M9c2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoKSkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJyk6CiAgICAgICAgICAgIGlkX2RvYyA9IHNlbGYuZ2V0X2lkX2RvYygpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2NsZWFyX2JhcmNvZGVfZGF0YShpZF9kb2MpCiAgICAgICAgICAgIHNlbGYucXVldWVfc2VydmljZS5yZW1vdmVfZG9jX2xpbmVzKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQlNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwINC4INC80LDRgNC60LjRgNC+0LLQutC4INC+0YfQuNGJ0LXQvdGLJykKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoaWRfZG9jKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0J/RgNC4INC+0YfQuNGB0YLQutC1INC00LDQvdC90YvRhSDQv9C10YDQtdGB0YfQtdGC0LAg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCgogICAgZGVmIGdldF9pZF9kb2Moc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikgb3Ige30KICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGEuZ2V0KCdrZXknKSBvciBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKICAgIGRlZiBfZ2V0X2RvY19saXN0X2RhdGEoc2VsZiwgZG9jX3R5cGUsIGRvY19zdGF0dXMpIC0+IGxpc3Q6CiAgICAgICAgcmVzdWx0cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZpZXdfZGF0YShkb2NfdHlwZSwgZG9jX3N0YXR1cykKICAgICAgICByZXR1cm4gcmVzdWx0cwoKCmNsYXNzIERvY3NPZmZsaW5lTGlzdFNjcmVlbihEb2NzTGlzdFNjcmVlbik6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICc7Jy5qb2luKAogICAgICAgICAgICBbJ9Cj0LTQsNC70LjRgtGMJywgJ9Ce0YfQuNGB0YLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0LXRgNC10YHRh9C10YLQsCddKQoKCmNsYXNzIEZsb3dEb2NTY3JlZW4oRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9Ch0LHQvtGAINCo0JonCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2VydmljZS5kb2NzX3RhYmxlX25hbWUgPSAnUlNfZG9jcycKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICfQo9C00LDQu9C40YLRjDvQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgYXJncyA9IHNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX3B1dF9kYXRhKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/QvtGC0L7QutCo0YLRgNC40YXQutC+0LTQvtCy0JTQvtC60YPQvNC10L3RgtCwJywgYXJncykKICAgICAgICAgICAgIyBzY3JlZW46IEZsb3dEb2NEZXRhaWxzU2NyZWVuID0gRmxvd0RvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICAgICAgIyBzY3JlZW4uc2hvdyhhcmdzPWFyZ3MpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQn9C70LjRgtC60LgnKSAgIyBmaW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdkb2NfdHlwZV9jbGljayc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YScpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmdldF9pZF9kb2MoKQogICAgICAgICAgICByZXMgPSBzZWxmLl9jbGVhcl9iYXJjb2RlX2RhdGEoaWRfZG9jKQogICAgICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKGlkX2RvYykKICAgICAgICAgICAgaWYgcmVzLmdldCgncmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQktGB0LUg0YjRgtGA0LjRhdC60L7QtNGLINGD0LTQsNC70LXQvdGLINC40Lcg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cf0YDQuCDQvtGH0LjRgdGC0LrQtSDQtNCw0L3QvdGL0YUg0LLQvtC30L3QuNC60LvQsCDQvtGI0LjQsdC60LAuJykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKHJlcy5nZXQoJ2Vycm9yJykpCgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERvY3NMaXN0IF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gRG9jRGV0YWlscyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERvY0RldGFpbHNTY3JlZW4oU2NyZWVuKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gTm9uZQogICAgICAgIHNlbGYuaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICBzZWxmLnNlcnZpY2UgPSBEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuaXRlbXNfb25fcGFnZSA9IDIwCiAgICAgICAgc2VsZi5xdWV1ZV9zZXJ2aWNlID0gU2Nhbm5pbmdRdWV1ZVNlcnZpY2UoKQogICAgICAgIHNlbGYuZG9jX3Jvd3MgPSBOb25lCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgcGFzcwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIm5leHRfcGFnZSI6CiAgICAgICAgICAgIHNlbGYuX25leHRfcGFnZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJldmlvdXNfcGFnZSc6CiAgICAgICAgICAgIHNlbGYuX3ByZXZpb3VzX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdpdGVtc19vbl9wYWdlX2NsaWNrJzoKICAgICAgICAgICAgc2VsZi5fc2V0X2l0ZW1zX29uX3BhZ2UoKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcm93c19maWx0ZXJfb24nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsICcxJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Jvd3NfZmlsdGVyJywgJzEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Jvd3NfZmlsdGVyX29mZic6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCdyb3dzX2ZpbHRlcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTZWFyY2hTdHJpbmcnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIlNlYXJjaCI6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9wYWdlJywgJzEnKQogICAgICAgICAgICBzZWxmLl9vbl9zdGFydCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9iYXJjb2Rlcyc6CiAgICAgICAgICAgIHNlbGYuX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2V0VGl0bGUnLCBzZWxmLmhhc2hfbWFwWyJkb2NfdHlwZSJdKQoKICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IEZhbHNlCiAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgIGhhdmVfbWFya19wbGFuID0gRmFsc2UKCiAgICAgICAgbGFzdF9zY2FubmVkX2RldGFpbHMgPSBzZWxmLl9nZXRfZG9jX2RldGFpbHNfZGF0YShsYXN0X3NjYW5uZWQ9VHJ1ZSkKICAgICAgICBsYXN0X3NjYW5uZWRfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShsYXN0X3NjYW5uZWRfZGV0YWlscykKICAgICAgICBsYXN0X3NjYW5uZWRfaXRlbSA9IGxhc3Rfc2Nhbm5lZF9kYXRhWzFdIGlmIGxlbihsYXN0X3NjYW5uZWRfZGF0YSkgPj0gMiBlbHNlIE5vbmUKICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX2dldF9kb2NfZGV0YWlsc19kYXRhKCkKICAgICAgICB0YWJsZV9kYXRhID0gc2VsZi5fcHJlcGFyZV90YWJsZV9kYXRhKGRvY19kZXRhaWxzKQogICAgICAgIGlmIHRhYmxlX2RhdGEgYW5kIGxhc3Rfc2Nhbm5lZF9pdGVtOgogICAgICAgICAgICB0YWJsZV9kYXRhLmluc2VydCgxLCBsYXN0X3NjYW5uZWRfaXRlbSkKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpID09ICcxJzoKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEucG9wKDEpCiAgICAgICAgICAgIHRhYmxlX2RhdGFbMV0gPSBsYXN0X3NjYW5uZWRfaXRlbQogICAgICAgIHRhYmxlX3ZpZXcgPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3ZpZXcodGFibGVfZGF0YT10YWJsZV9kYXRhKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtc19vbl9wYWdlX3NlbGVjdCddID0gJzIwOzQwOzYwJwogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hpZ2hsaWdodCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGlnaGxpZ2h0JywgRmFsc2UpCiAgICAgICAgICAgICMgc2VsZi5lbmFibGVfaGlnaGxpZ2h0KHRhYmxlX3ZpZXcuY3VzdG9tdGFibGUpCiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ2hpZ2hsaWdodF9zY2FubmVkX2l0ZW0nKQoKICAgICAgICBpZiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsndGFibGVfbGluZXNfcXR0eSddID0gbGVuKGRvY19kZXRhaWxzKQogICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHN1bSgKICAgICAgICAgICAgICAgIFtzZWxmLl9mb3JtYXRfdG9fZmxvYXQoc3RyKGl0ZW1bJ3F0dHlfcGxhbiddKSkgZm9yIGl0ZW0gaW4gZG9jX2RldGFpbHMgaWYgaXRlbVsncXR0eV9wbGFuJ11dKSA+IDAKICAgICAgICAgICAgIyBoYXZlX3plcm9fcGxhbiA9IG5vdCBoYXZlX3F0dHlfcGxhbgogICAgICAgICAgICBoYXZlX3plcm9fcGxhbiA9IFRydWUKICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBzZWxmLl9nZXRfaGF2ZV9tYXJrX3BsYW4oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3F0dHlfcGxhbiddID0gaGF2ZV9xdHR5X3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX3plcm9fcGxhbiddID0gaGF2ZV96ZXJvX3BsYW4KICAgICAgICBzZWxmLmhhc2hfbWFwWydoYXZlX21hcmtfcGxhbiddID0gaGF2ZV9tYXJrX3BsYW4KCiAgICAgICAgY29udHJvbCA9IHNlbGYuc2VydmljZS5nZXRfZG9jX3ZhbHVlKCdjb250cm9sJywgc2VsZi5pZF9kb2MpIG5vdCBpbiAoMCwgJzAnLCAnZmFsc2UnLCAnRmFsc2UnLCBOb25lKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2NvbnRyb2wnXSA9IGNvbnRyb2wKCiAgICAgICAgc2VsZi5oYXNoX21hcFsncmV0dXJuX3NlbGVjdGVkX2RhdGEnXSA9ICcnCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImRvY19nb29kc190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQoKICAgIGRlZiBfaXRlbV9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lkX2RvYycpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgiZXZlbnQiKSA9PSAib25SZXN1bHRQb3NpdGl2ZSI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQoKICAgICAgICBpZiBub3QgYmFyY29kZToKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgICAgIHNlbGYuYmFyY29kZV93b3JrZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKnNlbGYuX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlX3NjYW5uaW5nX3F1ZXVlPVRydWUpCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdoYXZlX3F0dHlfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfcXR0eV9wbGFuJyksCiAgICAgICAgICAgICdoYXZlX3plcm9fcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfemVyb19wbGFuJyksCiAgICAgICAgICAgICdoYXZlX21hcmtfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfbWFya19wbGFuJyksCiAgICAgICAgICAgICdjb250cm9sJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgfQoKICAgIGRlZiBfcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUoc2VsZiwgc2Nhbl9yZXN1bHQpOgogICAgICAgIGlmIHNjYW5fcmVzdWx0LmVycm9yID09ICd1c2Vfc2VyaWVzJzoKICAgICAgICAgICAgc2VsZi5vbl9zdGFydF9oYW5kbGVycy5hcHBlbmQoCiAgICAgICAgICAgICAgICBsYW1iZGE6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzY2FuX3Jlc3VsdC5yb3dfa2V5KQogICAgICAgICAgICApCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzY2FuX3Jlc3VsdC5kZXNjcmlwdGlvbikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIF92YXJzID0gWyd3YXJlaG91c2UnLCAnY291bnRyYWdlbnQnXQoKICAgICAgICBmb3IgdiBpbiBfdmFyczoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdhbGxvd19mYWN0X2lucHV0JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19mYWN0X3F0dHlfaW5wdXQiLCAnMScgaWYgYWxsb3dfZmFjdF9pbnB1dCBlbHNlICctMScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X25vdGUiLCAnLTEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnMScpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHNlbGYuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCiAgICAgICAgZmluZGVkX2FydGljbGVzID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpLmdldCgnZmluZGVkX2FydGljbGVzJykKICAgICAgICBkYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2NfZGV0YWlsc19kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGZpcnN0X2VsZW09MCBpZiBsYXN0X3NjYW5uZWQgZWxzZSBmaXJzdF9lbGVtZW50LAogICAgICAgICAgICBpdGVtc19vbl9wYWdlPTEgaWYgbGFzdF9zY2FubmVkIGVsc2Ugc2VsZi5pdGVtc19vbl9wYWdlLAogICAgICAgICAgICBhcnRpY2xlc19saXN0PWpzb24ubG9hZHMoZmluZGVkX2FydGljbGVzKSBpZiBmaW5kZWRfYXJ0aWNsZXMgZWxzZSBOb25lLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQogICAgICAgIHNlbGYuZG9jX3Jvd3MgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX3Jvd3NfY291bnQoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgYXJ0aWNsZXNfbGlzdD1qc29uLmxvYWRzKGZpbmRlZF9hcnRpY2xlcykgaWYgZmluZGVkX2FydGljbGVzIGVsc2UgTm9uZSwKICAgICAgICAgICAgcm93X2ZpbHRlcnM9cm93X2ZpbHRlcnMsCiAgICAgICAgICAgIHNlYXJjaF9zdHJpbmc9c2VhcmNoX3N0cmluZwogICAgICAgICkKCiAgICAgICAgaWYgbm90IGxhc3Rfc2Nhbm5lZDoKICAgICAgICAgICAgc2VsZi5fY2hlY2tfbmV4dF9wYWdlKGxlbihkYXRhKSkKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfbmV4dF9wYWdlKHNlbGYpOgogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkgKyBzZWxmLml0ZW1zX29uX3BhZ2UKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsIHN0cihmaXJzdF9lbGVtZW50KSkKICAgICAgICBjdXJyZW50X3BhZ2UgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfcGFnZScpKSArIDEgb3IgMQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCBzdHIoY3VycmVudF9wYWdlKSkKCiAgICBkZWYgX3ByZXZpb3VzX3BhZ2Uoc2VsZik6CiAgICAgICAgZmlyc3RfZWxlbWVudCA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKSAtIHNlbGYuaXRlbXNfb25fcGFnZQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgc3RyKGZpcnN0X2VsZW1lbnQpKQogICAgICAgIGN1cnJlbnRfcGFnZSA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9wYWdlJykpIC0gMSBvciAxCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfcGFnZScsIHN0cihjdXJyZW50X3BhZ2UpKQoKICAgIGRlZiBfY2hlY2tfcHJldmlvdXNfcGFnZShzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpOgogICAgICAgICAgICBmaXJzdF9lbGVtZW50ID0gaW50KHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJykpCiAgICAgICAgICAgIGlmIGZpcnN0X2VsZW1lbnQgPiAwOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcHJldmlvdXNfcGFnZSIsICIxIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X2ZpcnN0X2VsZW1lbnRfbnVtYmVyJywgJzAnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCAnMScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcHJldmlvdXNfcGFnZSIsICIwIikKCiAgICBkZWYgX2NoZWNrX25leHRfcGFnZShzZWxmLCBlbGVtc19jb3VudCk6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCAnMCcpCiAgICAgICAgcGFnZV9lbGVtc19zdW0gPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkgKyBzZWxmLml0ZW1zX29uX3BhZ2UKICAgICAgICBpZiBwYWdlX2VsZW1zX3N1bSA8IHNlbGYuZG9jX3Jvd3M6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X25leHRfcGFnZSIsICIxIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19uZXh0X3BhZ2UiLCAiMCIpCgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdTaG93X3ByZXZpb3VzX3BhZ2UnKSA9PSAnMCcgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdTaG93X25leHRfcGFnZScpID09ICcwJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcGFnaW5hdGlvbl9jb250cm9scyIsICItMSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfcGFnaW5hdGlvbl9jb250cm9scyIsICIxIikKCiAgICBkZWYgX3NldF9pdGVtc19vbl9wYWdlKHNlbGYpOgogICAgICAgIHZhbHVlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1zX29uX3BhZ2VfY2xpY2snKQogICAgICAgIHNlbGYuaXRlbXNfb25fcGFnZSA9IGludCh2YWx1ZSkKICAgICAgICBuZXdfcGFnZSA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicpKS8vc2VsZi5pdGVtc19vbl9wYWdlICsgMQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3BhZ2UnLCBuZXdfcGFnZSkKICAgICAgICBuZXdfY3VycmVudF9maXJzdCA9IHNlbGYuaXRlbXNfb25fcGFnZSAqIChuZXdfcGFnZSAtIDEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInLCBzdHIobmV3X2N1cnJlbnRfZmlyc3QpKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIGRvY19kZXRhaWxzKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIHJvd19maWx0ZXIgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdyb3dzX2ZpbHRlcicpCgogICAgICAgIGZvciByZWNvcmQgaW4gZG9jX2RldGFpbHM6CiAgICAgICAgICAgIGlmIHJvd19maWx0ZXIgYW5kIHJlY29yZFsnZF9xdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gPT0gMCBhbmQgcmVjb3JkWydxdHR5X3BsYW4nXSA9PSAwOgogICAgICAgICAgICAgICAgcGljID0gJycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2lkJ10pLAogICAgICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHN0cihyZWNvcmRbJ2dvb2RfbmFtZSddKSwKICAgICAgICAgICAgICAgICdpZF9nb29kJzogc3RyKHJlY29yZFsnaWRfZ29vZCddKSwKICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFsnaWRfc2VyaWVzJ10pLAogICAgICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFsnc2VyaWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAndW5pdHNfbmFtZSc6IHN0cihyZWNvcmRbJ3VuaXRzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnY29kZV9hcnQnOiAn0JrQvtC0OiAnICsgc3RyKHJlY29yZFsnY29kZSddKSwKICAgICAgICAgICAgICAgICdhcnQnOiBzdHIocmVjb3JkWydhcnQnXSksCiAgICAgICAgICAgICAgICAncHJpY2UnOiBzdHIocmVjb3JkWydwcmljZSddIGlmIHJlY29yZFsncHJpY2UnXSBpcyBub3QgTm9uZSBlbHNlIDApLAogICAgICAgICAgICAgICAgJ3ByaWNlX25hbWUnOiBzdHIocmVjb3JkWydwcmljZV9uYW1lJ10gb3IgJycpLAogICAgICAgICAgICAgICAgJ3BpY3R1cmUnOiBwaWMsCiAgICAgICAgICAgICAgICAndXNlX3Nlcmllcyc6IHN0cihyZWNvcmRbJ3VzZV9zZXJpZXMnXSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvcHMgPSBbCiAgICAgICAgICAgICAgICAne30gJy5mb3JtYXQocHJvZHVjdF9yb3dbJ2FydCddKSBpZiBwcm9kdWN0X3Jvd1snYXJ0J10gZWxzZSAnJywKICAgICAgICAgICAgICAgICcoe30pICcuZm9ybWF0KHByb2R1Y3Rfcm93Wydwcm9wZXJ0aWVzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgICAgICAne30nLmZvcm1hdChwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3Nlcmllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICcsIHt9Jy5mb3JtYXQocHJvZHVjdF9yb3dbJ3VuaXRzX25hbWUnXSkgaWYgcHJvZHVjdF9yb3dbJ3VuaXRzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICBdCiAgICAgICAgICAgIHByb2R1Y3Rfcm93Wydnb29kX2luZm8nXSA9ICcnLmpvaW4ocHJvcHMpCgogICAgICAgICAgICBmb3Iga2V5IGluIFsncXR0eScsICdkX3F0dHknLCAncXR0eV9wbGFuJ106CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHNlbGYuX2Zvcm1hdF90b19mbG9hdChzdHIocmVjb3JkLmdldChrZXksIDAuMCkgb3IgMC4wKSkKICAgICAgICAgICAgICAgIHByb2R1Y3Rfcm93W2tleV0gPSBzdHIoaW50KHZhbHVlKSkgaWYgdmFsdWUuaXNfaW50ZWdlcigpIGVsc2UgdmFsdWUKCiAgICAgICAgICAgIHVzZV9zZXJpZXMgPSBib29sKGludChwcm9kdWN0X3Jvdy5nZXQoJ3VzZV9zZXJpZXMnLCAwKSkpCiAgICAgICAgICAgIHByb2R1Y3Rfcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkKICAgICAgICAgICAgc2VsZi5fc2V0X2JhY2tncm91bmRfcm93X2NvbG9yKHByb2R1Y3Rfcm93KQoKICAgICAgICAgICAgaWYgc2VsZi5fYWRkZWRfZ29vZHNfaGFzX2tleShwcm9kdWN0X3Jvd1sna2V5J10pOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5pbnNlcnQoMSwgcHJvZHVjdF9yb3cpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChwcm9kdWN0X3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTMKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucyhvdmVycmlkZV9zZWFyY2g9VHJ1ZSkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYsIHVzZV9zZXJpZXM9RmFsc2UsIHVzZV9tYXJrPUZhbHNlKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUGljdHVyZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9c3RhdGljX2RhdGEuc25faWNvbl9ncmVlbiBpZiB1c2Vfc2VyaWVzIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9MTYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD0xMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUGljdHVyZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9c3RhdGljX2RhdGEubWFya19ncmVlbiBpZiB1c2VfbWFyayBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPTE2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9MTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFkZGluZyA9IDE2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0VmlldygnQGdvb2RfbmFtZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCgogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bnb29kX2luZm8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MywKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eV9wbGFuJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BkX3F0dHknLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgZGVmIF9zZXRfYmFja2dyb3VuZF9yb3dfY29sb3Ioc2VsZiwgcHJvZHVjdF9yb3cpOgogICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAnI0ZGRkZGRicKICAgICAgICBxdHR5LCBxdHR5X3BsYW4gPSBmbG9hdChwcm9kdWN0X3Jvd1snZF9xdHR5J10pLCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10pCiAgICAgICAgaWYgcXR0eV9wbGFuID4gcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkJFOUU3IgoKICAgICAgICBlbGlmIHF0dHlfcGxhbiA8IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRjlDNCIKCiAgICAgICAgcHJvZHVjdF9yb3dbJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kX2NvbG9yCgogICAgZGVmIF9hZGRlZF9nb29kc19oYXNfa2V5KHNlbGYsIGtleSk6CiAgICAgICAgYWRkZWRfZ29vZHMgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdhZGRlZF9nb29kcycpCiAgICAgICAgcmVzdWx0ID0gRmFsc2UKCiAgICAgICAgaWYgYWRkZWRfZ29vZHM6CiAgICAgICAgICAgIGFkZGVkX2dvb2RzX2RvYyA9IGFkZGVkX2dvb2RzLmdldChzZWxmLmlkX2RvYywgW10pCiAgICAgICAgICAgIHJlc3VsdCA9IHN0cihrZXkpIGluIFtzdHIoaXRlbSkgZm9yIGl0ZW0gaW4gYWRkZWRfZ29vZHNfZG9jXQogICAgICAgICAgICBzZWxmLnRvYXN0KHJlc3VsdCkKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBlbmFibGVfaGlnaGxpZ2h0KGN1c3RvbXRhYmxlKToKICAgICAgICBjdXN0b210YWJsZVsndGFibGVkYXRhJ11bMV1bJ19sYXlvdXQnXS5CYWNrZ3JvdW5kQ29sb3IgPSAnI0YwRjhGRicKCiAgICBkZWYgZGlzYWJsZV9oaWdobGlnaHQoc2VsZik6CiAgICAgICAgc2VsZi5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfZmlsbF9ub25lX3ZhbHVlcyhzZWxmLCBkYXRhLCBrZXlzLCBkZWZhdWx0PScnKToKICAgICAgICBub25lX2xpc3QgPSBbTm9uZSwgJ05vbmUnXQogICAgICAgIGZvciBrZXkgaW4ga2V5czoKICAgICAgICAgICAgZGF0YVtrZXldID0gZGVmYXVsdCBpZiBkYXRhW2tleV0gaW4gbm9uZV9saXN0IGVsc2UgZGF0YVtrZXldCgogICAgZGVmIHNjYW5fZXJyb3Jfc291bmQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3NjYW5fZXJyb3InKSBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ3NjYW5fZXJyb3InKSAhPSAiTm9uZSI6CiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdzY2FuX2Vycm9yJykgaW4gWydRdWFudGl0eVBsYW5SZWFjaGVkJywgJ0FscmVhZHlTY2FubmVkJywgJ1plcm9fcGxhbl9lcnJvciddOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3dhcm5pbmcnKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlZnJlc2hfc2NyZWVuKCkKCiAgICBkZWYgX2Zvcm1hdF90b19mbG9hdChzZWxmLCB2YWx1ZTogc3RyKToKICAgICAgICByZXR1cm4gZmxvYXQodmFsdWUucmVwbGFjZSh1J1x4YTAnLCB1JycpLnJlcGxhY2UoJywnLCAnLicpIG9yICcwLjAnKQoKICAgIGRlZiBfZ2V0X2hhdmVfbWFya19wbGFuKHNlbGYpOgogICAgICAgIGNvdW50ID0gc2VsZi5zZXJ2aWNlLmdldF9jb3VudF9tYXJrX2NvZGVzKGlkX2RvYz1zZWxmLmlkX2RvYykKICAgICAgICByZXR1cm4gY291bnQgPiAwCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CgogICAgICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIFNlcmllc1NlbGVjdFNjcmVlbiwKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcz1zY3JlZW5fdmFsdWVzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoc2VsZik6CiAgICAgICAgbG95YXV0ID0gJycnewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBmbGRfYmFyY29kZSIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogImZsZF9iYXJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJFZGl0VGV4dE51bWVyaWMiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9JycnCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnLCB0aXRsZT0i0JLQstC10LTQuNGC0LUg0YjRgtGA0LjRhdC60L7QtCDRgtC+0LLQsNGA0LAiLCBkaWFsb2dfbGF5b3V0PWxveWF1dCkKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgoKY2xhc3MgR3JvdXBTY2FuRG9jRGV0YWlsc1NjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuZ2V0X2h0dHBfc2V0dGluZ3MoKSkKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdpZF9kb2MnOiBoYXNoX21hcFsnaWRfZG9jJ10sCiAgICAgICAgICAgICdkb2NfdHlwZSc6IGhhc2hfbWFwWydkb2NfdHlwZSddLAogICAgICAgICAgICAnZG9jX24nOiBoYXNoX21hcFsnZG9jX24nXSwKICAgICAgICAgICAgJ2RvY19kYXRlJzogaGFzaF9tYXBbJ2RvY19kYXRlJ10sCiAgICAgICAgICAgICd3YXJlaG91c2UnOiBoYXNoX21hcFsnd2FyZWhvdXNlJ10sCiAgICAgICAgICAgICdjb3VudHJhZ2VudCc6IGhhc2hfbWFwWydjb3VudHJhZ2VudCddLAogICAgICAgIH0KCiAgICBkZWYgb25fc3RhcnQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLl9vbl9zdGFydCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3N0b3BfdGltZXJfdXBkYXRlJywgJ3RydWUnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVyID0gc2VsZi5oYXNoX21hcFsnbGlzdGVuZXInXQoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICAgICAgc2VsZi5fcnVuX3Byb2dyZXNzX2JhcmNvZGVfc2Nhbm5pbmcoKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnKToKICAgICAgICAgICAgc2VsZi5fcnVuX3Byb2dyZXNzX2JhcmNvZGVfc2Nhbm5pbmcoKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnUmV0cnlDb25uZWN0aW9uJyk6CiAgICAgICAgICAgIHNlbGYuX3J1bl9wcm9ncmVzc19iYXJjb2RlX3NjYW5uaW5nKCkKCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfbmVnYXRpdmUoJ1JldHJ5Q29ubmVjdGlvbicpOgogICAgICAgICAgICBzZWxmLnNldF9zY2FubmVyX2xvY2soRmFsc2UpCiAgICAgICAgZWxpZiBsaXN0ZW5lciBpbiBbJ09OX0JBQ0tfUFJFU1NFRCcsICdCQUNLX0JVVFRPTiddOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93U2NyZWVuIiwgItCU0L7QutGD0LzQtdC90YLRiyIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICdmYWxzZScpCgogICAgZGVmIF9ydW5fcHJvZ3Jlc3NfYmFyY29kZV9zY2FubmluZyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9wcm9ncmVzcygnZG9jX2RldGFpbHNfYmVmb3JlX3Byb2Nlc3NfYmFyY29kZScpCgogICAgZGVmIGJlZm9yZV9wcm9jZXNzX2JhcmNvZGUoc2VsZik6CiAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKFRydWUpCiAgICAgICAgaWYgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICBzZWxmLl91cGRhdGVfZG9jdW1lbnRfZGF0YSgpCiAgICAgICAgICAgIHNjYW5fcmVzdWx0ID0gc2VsZi5fYmFyY29kZV9zY2FubmVkKCkKCiAgICAgICAgICAgIGlmIHNjYW5fcmVzdWx0LmdldCgnRXJyb3InKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50KCdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9hc3luYygnZG9jX3J1bl9wb3N0X2JhcmNvZGVfc2Nhbm5lZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0X2V4ZWN1dGVfbWV0aG9kPSdkb2Nfc2Nhbl9lcnJvcl9zb3VuZCcpCiAgICAgICAgICAgIHNlbGYuc2V0X3NjYW5uZXJfbG9jayhGYWxzZSkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5iZWVwKCc3MCcpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2cobGlzdGVuZXI9IlJldHJ5Q29ubmVjdGlvbiIsIHRpdGxlPSfQntGC0YHRg9GC0YHRgtCy0YPQtdGCINGB0L7QtdC00LjQvdC10L3QuNC1INGBINGB0LXRgNCy0LXRgNC+0LwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyLQn9C+0LLRgtC+0YDQuNGC0YwiLCAi0J7RgtC80LXQvdCwIl0pCgogICAgZGVmIF91cGRhdGVfZG9jdW1lbnRfZGF0YShzZWxmKToKICAgICAgICBkb2NzX2RhdGEgPSBzZWxmLl9nZXRfdXBkYXRlX2N1cnJlbnRfZG9jX2RhdGEoKQogICAgICAgIGlmIGRvY3NfZGF0YToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kYXRhX2Zyb21fanNvbihkb2NzX2RhdGEpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuc2VydmljZS53cml0ZV9lcnJvcl9vbl9sb2coCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdHlwZT0iR3JvdXBTY2FuIHVwZGF0ZV9kb2NfZGF0YSIsCiAgICAgICAgICAgICAgICAgICAgZXJyb3JfdGV4dD1lLAogICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQt9Cw0L/QuNGB0Lgg0LTQvtC60YPQvNC10L3RgtCwJykKCiAgICBkZWYgX2dldF91cGRhdGVfY3VycmVudF9kb2NfZGF0YShzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS5nZXRfZGF0YSgpCiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgoKICAgICAgICAgICAgaWYgYW5zd2VyLnVuYXV0aG9yaXplZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDQsNCy0YLQvtGA0LjQt9Cw0YbQuNC4INGB0LXRgNCy0LXRgNCwIDHQoScpCiAgICAgICAgICAgIGVsaWYgYW5zd2VyLmZvcmJpZGRlbjoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKGFuc3dlci5lcnJvcl90ZXh0LCB0aXRsZT0n0J7RiNC40LHQutCwINC+0LHQvNC10L3QsCcpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGFuc3dlci5lcnJvcl90ZXh0KQogICAgICAgICAgICBlbGlmIGFuc3dlci5lcnJvcjoKICAgICAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1hbnN3ZXIuZXJyb3JfdGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINC30LDQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBhbnN3ZXIuZGF0YQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi5zZXRfc2Nhbm5lcl9sb2NrKEZhbHNlKQoKICAgIGRlZiBwb3N0X2JhcmNvZGVfc2Nhbm5lZChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdiYXJjb2RlX3NjYW5uZWQnKToKICAgICAgICAgICAgYW5zd2VyID0gTm9uZQogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLl9wb3N0X2dvb2RzX3RvX3NlcnZlcigpCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHNlbGYuaHNfc2VydmljZS53cml0ZV9lcnJvcl90b19sb2coZXJyb3JfdGV4dD1lLmFyZ3NbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQvtGC0L/RgNCw0LLQutC4INC00LDQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0LAnKQogICAgICAgICAgICBpZiBhbnN3ZXIgYW5kIGFuc3dlci5nZXQoJ0Vycm9yJykgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmVycm9yX2xvZyhhbnN3ZXIuZ2V0KCdFcnJvcicpKQoKICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCgogICAgZGVmIF9wb3N0X2dvb2RzX3RvX3NlcnZlcihzZWxmKToKICAgICAgICByZXMgPSBzZWxmLnNlcnZpY2UuZ2V0X2xhc3RfZWRpdGVkX2dvb2RzKHRvX2pzb249RmFsc2UpCiAgICAgICAgaHNfc2VydmljZSA9IEhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCgogICAgICAgIGlmIGlzaW5zdGFuY2UocmVzLCBkaWN0KSBhbmQgcmVzLmdldCgnRXJyb3InKToKICAgICAgICAgICAgYW5zd2VyID0geydlbXB0eSc6IFRydWUsICdFcnJvcic6IHJlcy5nZXQoJ0Vycm9yJyl9CiAgICAgICAgICAgIHJldHVybiBhbnN3ZXIKICAgICAgICBlbGlmIHJlczoKICAgICAgICAgICAgaHNfc2VydmljZS5zZW5kX2RvY3VtZW50cyhyZXMpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWFuc3dlci5lcnJvcl90ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0L7RgtC/0YDQsNCy0LrQuCDQtNCw0L3QvdGL0YUg0LTQvtC60YPQvNC10L3RgtCwJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX3NlbnRfZGF0YShyZXMpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWUuYXJnc1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yX2luZm89J9Ce0YjQuNCx0LrQsCDQvtGC0L/RgNCw0LLQutC4INC00LDQvdC90YvRhSDQtNC+0LrRg9C80LXQvdGC0LAnKQoKICAgICAgICAjINC/0L7QutCwINGH0YLQviDQvtGC0LrQu9GO0YfQuNC7INC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0LkgZ2V0LdC30LDQv9GA0L7RgSwg0L/RgNC+0LLQtdGA0Y/QtdC8INC/0YDQvtC40LfQstC+0LTQuNGC0LXQu9GM0L3QvtGB0YLRjAoKICAgICAgICAjIGRvY3NfZGF0YSA9IGhzX3NlcnZpY2UuZ2V0X2RhdGEoKQogICAgICAgICMKICAgICAgICAjIGlmIGRvY3NfZGF0YS5nZXQoJ2RhdGEnKToKICAgICAgICAjICAgICB0cnk6CiAgICAgICAgIyAgICAgICAgIHNlbGYuc2VydmljZS51cGRhdGVfZGF0YV9mcm9tX2pzb24oZG9jc19kYXRhWydkYXRhJ10pCiAgICAgICAgIyAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICMgICAgICAgICBzZWxmLnNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKGUuYXJnc1swXSkKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLmh0dHBfYW5zd2VyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPXNlbGYuaHNfc2VydmljZS51cmwpCgogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIHNldF9zY2FubmVyX2xvY2soc2VsZiwgdmFsdWU6IGJvb2wpOgogICAgICAgIGlmICd1cm92bycgaW4gc2VsZi5oYXNoX21hcC5nZXQoJ0RFVklDRV9NT0RFTCcpLmxvd2VyKCk6CiAgICAgICAgICAgIHN1Q2xhc3MudXJvdm9fc2V0X2xvY2tfdHJpZ2dlcih2YWx1ZSkKCiAgICBkZWYgY2FuX2xhdW5jaF90aW1lcihzZWxmKToKICAgICAgICByZXR1cm4gRmFsc2UKCgpjbGFzcyBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3KERvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JPRgNGD0L/Qv9C+0LLQsNGPINC+0LHRgNCw0LHQvtGC0LrQsCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBoc19zZXJ2aWNlcy5Ic1NlcnZpY2Uoc2VsZi5nZXRfaHR0cF9zZXR0aW5ncygpKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLnF1ZXVlX3NlcnZpY2UgPSBTY2FubmluZ1F1ZXVlU2VydmljZSgpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0ge30KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3RpbWVyX3VwZGF0ZScsICd0cnVlJykKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3N0b3Bfc3luY19kb2MnKSBhbmQgXAogICAgICAgICAgICAgICAgbm90IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKToKICAgICAgICAgICAgc2VsZi5fc3luY19kb2MoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzdG9wX3N5bmNfZG9jJywgJ3RydWUnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBsYW1iZGE6IHNlbGYuX2dyb3VwX2JhcmNvZGVfc2Nhbm5lZChzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKSksCiAgICAgICAgICAgICdidG5fYmFyY29kZXMnOiBsYW1iZGE6IHNlbGYuX3Nob3dfZGlhbG9nX2lucHV0X2JhcmNvZGUoKSwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuZ29fYmFjaywKICAgICAgICAgICAgJ3N5bmNfZG9jJzogc2VsZi5fc3luY19kb2MsCiAgICAgICAgICAgICdzZW5kX2FsbF9zY2FuX2xpbmVzJzogc2VsZi5zZW5kX2FsbF9zY2FuX2xpbmVzX2NhbGxfaGFuZGxlciwKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljawogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X2JhcmNvZGUnKToKICAgICAgICAgICAgc2VsZi5fZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYuaGFzaF9tYXAuZ2V0KCdmbGRfYmFyY29kZScpKQoKICAgIGRlZiBfZ3JvdXBfYmFyY29kZV9zY2FubmVkKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5iYXJjb2RlX3dvcmtlciA9IEJhcmNvZGVXb3JrZXIoaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2Vfc2Nhbm5pbmdfcXVldWU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cF9zY2FuPVRydWUpCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCgogICAgICAgIGlmIHJlc3VsdC5lcnJvcjoKICAgICAgICAgICAgc2VsZi5fcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUocmVzdWx0KQogICAgICAgICAgICByZXR1cm4gcmVzdWx0LmVycm9yCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdzZW5kX2RvY3VtZW50X2xpbmVzX3J1bm5pbmcnKSBhbmQgXAogICAgICAgICAgICAgICAgbm90IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdvZmZsaW5lX21vZGUnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5ydW5fZXZlbnRfYXN5bmMoJ3NlbmRfcG9zdF9saW5lc19kYXRhJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdF9leGVjdXRlX21ldGhvZD0nYWZ0ZXJfc2VuZF9wb3N0X2xpbmVzX2RhdGEnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VuZF9kb2N1bWVudF9saW5lc19ydW5uaW5nJywgVHJ1ZSkKCiAgICBkZWYgZ29fYmFjayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc3RvcF9zeW5jX2RvYycpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3N0b3BfdGltZXJfdXBkYXRlJywgJ2ZhbHNlJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQlNC+0LrRg9C80LXQvdGC0YsnKQoKICAgIGRlZiBzZW5kX3Bvc3RfbGluZXNfZGF0YShzZWxmLCBzZW50PU5vbmUpOgogICAgICAgIHNlbmRfZGF0YSA9IHNlbGYucXVldWVfc2VydmljZS5nZXRfZG9jdW1lbnRfbGluZXMoc2VsZi5pZF9kb2MsIHNlbnQ9c2VudCkKICAgICAgICB2YWxpZGF0ZWRfc2VuZF9kYXRhID0gbGlzdCgoZGljdCgoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gZC5pdGVtcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYga2V5IG5vdCBpbiBbJ3Jvd19rZXknLCAnc2VudCddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZCBpbiBzZW5kX2RhdGEpKQogICAgICAgIGlmIG5vdCB2YWxpZGF0ZWRfc2VuZF9kYXRhOgogICAgICAgICAgICB2YWxpZGF0ZWRfc2VuZF9kYXRhID0gW3t9XQoKICAgICAgICBpZiBzZW50IGlzIEZhbHNlOgogICAgICAgICAgICBodHRwX3Jlc3VsdCA9IHNlbGYuaHNfc2VydmljZS5zZW5kX2RvY3VtZW50X2xpbmVzKHNlbGYuaWRfZG9jLCB2YWxpZGF0ZWRfc2VuZF9kYXRhLCB0aW1lb3V0PTgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaHR0cF9yZXN1bHQgPSBzZWxmLmhzX3NlcnZpY2Uuc2VuZF9hbGxfZG9jdW1lbnRfbGluZXMoc2VsZi5pZF9kb2MsIHZhbGlkYXRlZF9zZW5kX2RhdGEsIHRpbWVvdXQ9OCkKCiAgICAgICAgaWYgaHR0cF9yZXN1bHQuc3RhdHVzX2NvZGUgIT0gMjAwOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9InJlc3BvbnNlIHN0YXR1cyBjb2RlICE9IDIwMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINC/0YDQuCDQvtGC0L/RgNCw0LLQutC1INC00LDQvdC90YvRhSDQs9GA0YPQv9C/0L7QstC+0LPQviAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0YHQutCw0L3QuNGA0L7QstCw0L3QuNGPINGC0L7QstCw0YDQsCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIG5vdCBodHRwX3Jlc3VsdC5kYXRhLmdldCgnZGF0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gaHR0cF9yZXN1bHQuZGF0YVsnZGF0YSddOgogICAgICAgICAgICB0YWJsZV9saW5lID0gc2VsZi5kYl9zZXJ2aWNlLmdldF90YWJsZV9saW5lKCdSU19kb2NzX3RhYmxlJywgZmlsdGVycz17CiAgICAgICAgICAgICAgICAnaWRfZG9jJzogZWxlbWVudFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAnaWRfZ29vZCc6IGVsZW1lbnRbJ2lkX2dvb2QnXSwKICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogZWxlbWVudFsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAgICAgJ2lkX3VuaXQnOiBlbGVtZW50WydpZF91bml0J119KQogICAgICAgICAgICBpZiB0YWJsZV9saW5lOgogICAgICAgICAgICAgICAgdGFibGVfbGluZVsncXR0eSddID0gZWxlbWVudFsncXR0eSddCiAgICAgICAgICAgICAgICB0YWJsZV9saW5lWydzZW50J10gPSAxCiAgICAgICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUoJ1JTX2RvY3NfdGFibGUnLCB0YWJsZV9saW5lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgbmV3X3RhYmxlX2xpbmUgPSBzZWxmLmNyZWF0ZV9uZXdfdGFibGVfbGluZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKCdSU19kb2NzX3RhYmxlJywgbmV3X3RhYmxlX2xpbmUpCgogICAgICAgIHNlbGYucXVldWVfc2VydmljZS51cGRhdGVfc2VudF9saW5lcyhzZW5kX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbmRfZG9jdW1lbnRfbGluZXNfcnVubmluZycsIEZhbHNlKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQogICAgICAgIHNlbGYub25fc3RhcnQoKQoKICAgIGRlZiBhZnRlcl9zZW5kX2RhdGEoc2VsZik6CiAgICAgICAgaWYgc2VsZi5xdWV1ZV9zZXJ2aWNlLmhhc191bnNlbnRfbGluZXMoc2VsZi5pZF9kb2MpIGFuZCBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdzZW5kX3Bvc3RfbGluZXNfZGF0YScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RfZXhlY3V0ZV9tZXRob2Q9J2FmdGVyX3NlbmRfcG9zdF9saW5lc19kYXRhJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgY3JlYXRlX25ld190YWJsZV9saW5lKGVsZW1lbnQpOgogICAgICAgIG5ld190YWJsZV9saW5lID0gZWxlbWVudAogICAgICAgIGRlbCBuZXdfdGFibGVfbGluZVsndGFibGVfdHlwZSddCiAgICAgICAgbmV3X3RhYmxlX2xpbmUudXBkYXRlKHsnZF9xdHR5JzogbmV3X3RhYmxlX2xpbmVbJ3F0dHknXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiAnJywgJ2lkX3ByaWNlJzogJycsICdzZW50JzogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdHR5X3BsYW4nOiBOb25lfSkKICAgICAgICByZXR1cm4gbmV3X3RhYmxlX2xpbmUKCiAgICBkZWYgX2dldF9iYXJjb2RlX3Byb2Nlc3NfcGFyYW1zKHNlbGYpOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICdoYXZlX3F0dHlfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfcXR0eV9wbGFuJyksCiAgICAgICAgICAgICdoYXZlX3plcm9fcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfemVyb19wbGFuJyksCiAgICAgICAgICAgICdoYXZlX21hcmtfcGxhbic6IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2hhdmVfbWFya19wbGFuJyksCiAgICAgICAgICAgICdjb250cm9sJzogc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgfQoKICAgIGRlZiBfcHJvY2Vzc19lcnJvcl9zY2FuX2JhcmNvZGUoc2VsZiwgc2Nhbl9yZXN1bHQpOgogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTQKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YIg0YPRgdGC0YDQvtC50YHRgtCy0LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ce0LHRidC40Lkg0YTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCdAZ29vZF9uYW1lJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGdvb2RfaW5mbycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD00LAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5X3BsYW4nLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRfcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MiwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0yLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX2NoZWNrX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2UuY29tbXVuaWNhdGlvbl90ZXN0KHRpbWVvdXQ9MSkKICAgICAgICAgICAgYW5zd2VyID0gc2VsZi5oc19zZXJ2aWNlLmh0dHBfYW5zd2VyCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBhbnN3ZXIgPSBzZWxmLmhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPXNlbGYuaHNfc2VydmljZS51cmwpCgogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgogICAgZGVmIF9zeW5jX2RvYyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19jb25uZWN0aW9uKCk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucnVuX2V2ZW50X3Byb2dyZXNzKCdzZW5kX3Bvc3RfbGluZXNfZGF0YScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgMdChJykKCiAgICBkZWYgc2VuZF9hbGxfc2Nhbl9saW5lc19jYWxsX2hhbmRsZXIoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fY2hlY2tfY29ubmVjdGlvbigpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJ1bl9ldmVudF9wcm9ncmVzcygnc2VuZF9hbGxfc2Nhbl9saW5lcycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdGCINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwgMdChJykKCiAgICBkZWYgc2VuZF9hbGxfc2Nhbl9saW5lc19ydW4oc2VsZik6CiAgICAgICAgc2VsZi5zZW5kX3Bvc3RfbGluZXNfZGF0YSgpCgogICAgZGVmIHNlbmRfdW5zZW50X2xpbmVzX3J1bihzZWxmKToKICAgICAgICBzZWxmLnNlbmRfcG9zdF9saW5lc19kYXRhKHNlbnQ9RmFsc2UpCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwCgogICAgICAgIGN1cnJlbnRfZWxlbSA9IGpzb24ubG9hZHMoc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfZGF0YScpKQogICAgICAgICMg0L/RgNC4INC60LvQuNC60LUg0L/QviDRiNCw0L/QutC1INGC0LDQsdC70LjRhtGLINC/0YDQuNC70LXRgtCw0LXRgiDQv9GD0YHRgtC+0Lkg0YHQu9C+0LLQsNGA0YwKICAgICAgICBpZiBub3QgY3VycmVudF9lbGVtOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgY3VycmVudF9zdHIgPSBzZWxmLmhhc2hfbWFwWyJzZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIl0KICAgICAgICB0YWJsZV9saW5lc19xdHR5ID0gc2VsZi5oYXNoX21hcFsndGFibGVfbGluZXNfcXR0eSddCiAgICAgICAgdGl0bGUgPSAne30g4oSWIHt9INC+0YIge30nLmZvcm1hdChzZWxmLmhhc2hfbWFwWydkb2NfdHlwZSddLCBzZWxmLmhhc2hfbWFwWydkb2NfbiddLCBzZWxmLmhhc2hfbWFwWydkb2NfZGF0ZSddKQogICAgICAgIHB1dF9kYXRhX2RpY3QgPSB7CiAgICAgICAgICAgICdEb2NfZGF0YSc6IHRpdGxlLAogICAgICAgICAgICAnR29vZCc6IGN1cnJlbnRfZWxlbVsnZ29vZF9uYW1lJ10sCiAgICAgICAgICAgICdpZF9nb29kJzogY3VycmVudF9lbGVtWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF91bml0JzogY3VycmVudF9lbGVtWydpZF91bml0J10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6IGN1cnJlbnRfZWxlbVsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAnZ29vZF9hcnQnOiBjdXJyZW50X2VsZW1bJ2FydCddLAogICAgICAgICAgICAnZ29vZF9zbic6IGN1cnJlbnRfZWxlbVsnc2VyaWVzX25hbWUnXSwKICAgICAgICAgICAgJ2dvb2RfcHJvcGVydHknOiBjdXJyZW50X2VsZW1bJ3Byb3BlcnRpZXNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9wcmljZSc6IGN1cnJlbnRfZWxlbVsncHJpY2UnXSwKICAgICAgICAgICAgJ2dvb2RfdW5pdCc6IGN1cnJlbnRfZWxlbVsndW5pdHNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9zdHInOiBmJ3tjdXJyZW50X3N0cn0gLyB7dGFibGVfbGluZXNfcXR0eX0nLAogICAgICAgICAgICAncXR0eV9wbGFuJzogY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2dvb2RfcGxhbic6IGN1cnJlbnRfZWxlbVsncXR0eV9wbGFuJ10sCiAgICAgICAgICAgICdrZXknOiBjdXJyZW50X2VsZW1bJ2tleSddLAogICAgICAgICAgICAncHJpY2UnOiBjdXJyZW50X2VsZW1bJ3ByaWNlJ10sCiAgICAgICAgICAgICdwcmljZV90eXBlJzogY3VycmVudF9lbGVtWydwcmljZV9uYW1lJ10sCiAgICAgICAgICAgICdxdHR5Jzogc2VsZi5fZm9ybWF0X3F1YW50aXR5KGN1cnJlbnRfZWxlbVsnZF9xdHR5J10pLAogICAgICAgIH0KICAgICAgICBzY3JlZW4gPSBHcm91cFNjYW5JdGVtU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpCiAgICAgICAgc2NyZWVuLnNob3coYXJncz1wdXRfZGF0YV9kaWN0KQoKCmNsYXNzIERvY3VtZW50c0RvY0RldGFpbFNjcmVlbihEb2NEZXRhaWxzU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9CU0L7QutGD0LzQtdC90YIg0YLQvtCy0LDRgNGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmRiX3NlcnZpY2UgPSBkYl9zZXJ2aWNlcy5CYXJjb2RlU2VydmljZSgpCiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKICAgICAgICBsaXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xpc3RlbmVyJ10KICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxlY3RlZF9jYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgICAgICBpZiBub3Qgc2VsZWN0ZWRfY2FyZF9kYXRhOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGlmIChzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICAgICAgICAgIGFuZCBub3Qgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKSk6CiAgICAgICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coCiAgICAgICAgICAgICAgICAgICAgZGF0YT17J3NlbnQnOiAwLCAnZF9xdHR5JzogZmxvYXQoc2VsZWN0ZWRfY2FyZF9kYXRhWydkX3F0dHknXSkgKyAxLjB9LAogICAgICAgICAgICAgICAgICAgIHJvd19pZD1pbnQoc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkpCiAgICAgICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wuZGVsZXRlKCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgKICAgICAgICAgICAgICAgICAgICBmJ9CQ0YDRgtC40LrRg9C7OiB7c2VsZWN0ZWRfY2FyZF9kYXRhWyJhcnQiXX1cbicKICAgICAgICAgICAgICAgICAgICBmJ3tzZWxlY3RlZF9jYXJkX2RhdGFbImdvb2RfbmFtZSJdfVxuJwogICAgICAgICAgICAgICAgICAgIGYne3NlbGVjdGVkX2NhcmRfZGF0YVsicHJvcGVydGllc19uYW1lIl19XG4nCiAgICAgICAgICAgICAgICAgICAgZifQmtC+0LvQuNGH0LXRgdGC0LLQviDRg9Cy0LXQu9C40YfQtdC90L4g0L3QsCAxJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnZG9jX2dvb2RzX3RhYmxlJykKICAgICAgICAgICAgaWYgc2VsZWN0ZWRfY2FyZF9kYXRhLmdldCgndXNlX3NlcmllcycpID09ICcxJzoKICAgICAgICAgICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzZWxlY3RlZF9jYXJkX2RhdGFbJ2tleSddKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnd2FzX2NsaWNrZWQnLCAnMScpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQotC+0LLQsNGAINCy0YvQsdC+0YAiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJyBvciBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ21vZGFsX2RpYWxvZ19pbnB1dF9iYXJjb2RlJyk6CiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgICAgIHJlcyA9IHNlbGYuX2l0ZW1fYmFyY29kZV9zY2FubmVkKCkKICAgICAgICAgICAgIyBUT0RPINGBINGA0LXQt9GD0LvRjNGC0LDRgtC+0Lwg0L7QsdGA0LDQsdC+0YLQutGDCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9nb29kc19vY3InOgogICAgICAgICAgICBhcnRpY2xlcyA9IHNlbGYuc2VydmljZS5nZXRfYWxsX2FydGljbGVzX2luX2RvY3VtZW50KCkKICAgICAgICAgICAgaWYgbm90IGFydGljbGVzOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JIg0LTQvtC60YPQvNC10L3RgtC1INC+0YLRgdGC0YPRgtGB0YLQstGD0Y7RgiDQsNGA0YLQuNC60YPQu9GLJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLl9zZXRfdmlzaW9uX3NldHRpbmdzKGFydGljbGVzPWFydGljbGVzKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUnVuQ1YnLCAn0KDQsNGB0L/QvtC30L3QsNCy0LDQvdC40LUg0LDRgNGC0LjQutGD0LvQvtCyJykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnQWN0aXZlQ1YnOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnYnV0dG9uX21hbmFnZV9hcnRpY2xlcycpOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnKQogICAgICAgICAgICBmaW5kZWRfYXJ0aWNsZXMgPSBzZWxmLmFydGljbGVzX29jcl9uY2wuZ2V0KCdmaW5kZWRfYXJ0aWNsZXMnKQogICAgICAgICAgICBpZiBmaW5kZWRfYXJ0aWNsZXMgaXMgTm9uZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9CQ0YDRgtC40LrRg9C70Ysg0L3QtSDQvdCw0LnQtNC10L3RiycpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIGxpc3RlbmVyIGluIFsnT05fQkFDS19QUkVTU0VEJywgJ0JBQ0tfQlVUVE9OJ106CiAgICAgICAgICAgIGlmIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpOgogICAgICAgICAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmRlbGV0ZSgnZmluZGVkX2FydGljbGVzJykKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgncm93c19maWx0ZXInKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9maXJzdF9lbGVtZW50X251bWJlcicsICcwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2l0ZW1zX29uX3BhZ2VfY2xpY2snLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnY29uZmlybV92ZXJpZmllZCcpOgogICAgICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgICAgICBzZWxmLnNlcnZpY2UubWFya192ZXJpZmllZCgpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZWFyY2hTdHJpbmciLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnY29uZmlybV92ZXJpZmllZCcsICfQl9Cw0LLQtdGA0YjQuNGC0Ywg0LTQvtC60YPQvNC10L3Rgj8nLCBbJ9CU0LAnLCAn0J3QtdGCJ10pCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYsIGFydGljbGVzOiBMaXN0W3N0cl0pOgogICAgICAgIHNldHRpbmdzID0gewogICAgICAgICAgICAidmFsdWVzX2xpc3QiOiAnOycuam9pbihhcnRpY2xlcyksCiAgICAgICAgICAgICJtaW5fbGVuZ3RoIjogbGVuKG1pbihhcnRpY2xlcywga2V5PWxlbikpLAogICAgICAgICAgICAibWF4X2xlbmd0aCI6IGxlbihtYXgoYXJ0aWNsZXMsIGtleT1sZW4pKSwKICAgICAgICB9CiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsLnB1dCgnYXJ0aWNsZXNfb2NyX3NldHRpbmdzJywganNvbi5kdW1wcyhzZXR0aW5ncyksIFRydWUpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogZG9jX3Jvd19rZXksCiAgICAgICAgICAgICd0aXRsZSc6ICfQodC10YDQuNC4JywKICAgICAgICAgICAgJ3VzZV9hZHJfZG9jc190YWJsZXMnOiAnMCcKICAgICAgICB9CgogICAgICAgIHNjcmVlbiA9IGNyZWF0ZV9zY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIFNlcmllc1NlbGVjdFNjcmVlbiwKICAgICAgICAgICAgc2NyZWVuX3ZhbHVlcz1zY3JlZW5fdmFsdWVzCiAgICAgICAgKQogICAgICAgIHNjcmVlbi5zaG93KCkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9ICctMScgaWYgc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnZmluZGVkX2FydGljbGVzJykgZWxzZSAnMScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd19idG5fZG9jX21hcmtfdmVyaWZpZWQnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfZG9jX2RhdGUnLCBmaW5kZWRfYXJ0aWNsZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1Nob3dfd2FyZWhvdXNlJywgZmluZGVkX2FydGljbGVzKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2NvdW50cmFnZW50JywgZmluZGVkX2FydGljbGVzKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdTaG93X2ZpbmRlZF9ieV9hcnRpY2xlJywgc3RyKC1pbnQoZmluZGVkX2FydGljbGVzKSkpCgoKY2xhc3MgRmxvd0RvY0RldGFpbHNTY3JlZW4oRG9jRGV0YWlsc1NjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9C+0YLQvtC60KjRgtGA0LjRhdC60L7QtNC+0LLQlNC+0LrRg9C80LXQvdGC0LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0KHQsdC+0YAg0KjQmicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5GbG93RG9jU2VydmljZShzZWxmLmlkX2RvYykKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2VsZi5zY3JlZW5fbmFtZSwgYXJncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fYmFyY29kZV9mbG93X29uX3N0YXJ0KCkKICAgICAgICBzZWxmLl9zZXRfdmlzaW9uX3NldHRpbmdzKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGlzdGVuZXInKQogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgY3VycmVudF9zdHIgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiIpCiAgICAgICAgICAgIGpsaXN0ID0ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldCgiZG9jX2JhcmNfZmxvdyIpKQogICAgICAgICAgICBjdXJyZW50X2VsZW0gPSBqbGlzdFsnY3VzdG9tdGFibGUnXVsndGFibGVkYXRhJ11baW50KGN1cnJlbnRfc3RyKV0KICAgICAgICAgICAgZGF0YSA9IHsnYmFyY29kZSc6IGN1cnJlbnRfZWxlbVsnYmFyY29kZSddLAogICAgICAgICAgICAgICAgICAgICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiBjdXJyZW50X2VsZW1bJ25hbWUnXSwKICAgICAgICAgICAgICAgICAgICAncXR0eSc6IGN1cnJlbnRfZWxlbVsncXR0eSddLCAn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCc6ICcnfQoKICAgICAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50KHNlbGYuaGFzaF9tYXAsIGRhdGEpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIkJBQ0tfQlVUVE9OIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3Jvd3NfZmlsdGVyJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2JhcmNvZGVzJzoKICAgICAgICAgICAgc2VsZi5fc2hvd19kaWFsb2dfaW5wdXRfYmFyY29kZSgpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGVfY2FtZXJhJykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9iYXJjb2RlX3RvX2RhdGFiYXNlKGJhcmNvZGUpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5pZF9kb2MpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfYmFyY19mbG93X3N0YXR1cygpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdtb2RhbF9kaWFsb2dfaW5wdXRfYmFyY29kZScpOgogICAgICAgICAgICBiYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoJ2ZsZF9iYXJjb2RlJykKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9iYXJjb2RlX3RvX2RhdGFiYXNlKGJhcmNvZGUpCiAgICAgICAgICAgIHNlbGYuc2VydmljZS5zZXRfZG9jX3N0YXR1c190b191cGxvYWQoc2VsZi5pZF9kb2MpCgogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX3ZlcmlmaWVkJyk6CiAgICAgICAgICAgIHNlbGYuc2VydmljZS5tYXJrX3ZlcmlmaWVkKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgtGLIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19tYXJrX3ZlcmlmaWVkJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnY29uZmlybV92ZXJpZmllZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ9CX0LDQstC10YDRiNC40YLRjCDQtNC+0LrRg9C80LXQvdGCPycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyfQlNCwJywgJ9Cd0LXRgiddKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQlNC+0LrRg9C80LXQvdGC0YsiKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd2aXNpb25fY2FuY2VsJzoKICAgICAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsX2NvdW50ZXIuZGVzdHJveSgpCgogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbic6CiAgICAgICAgICAgIFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbF9jb3VudGVyLmRlc3Ryb3koKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICfQn9C10YfQsNGC0YzQn9GA0LXQstGM0Y4nOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fb2NyX3NlcmlhbF90ZW1wbGF0ZV9zZXR0aW5ncyc6CiAgICAgICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdzaG93X3Byb2Nlc3NfcmVzdWx0JywgVHJ1ZSwgVHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCdPY3JUZXh0UmVjb2duaXRpb24nLCAnU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MnKQoKICAgIGRlZiBfYmFyY29kZV9mbG93X29uX3N0YXJ0KHNlbGYpOgoKICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykKICAgICAgICBmYWxzZVZhbHVlTGlzdCA9ICgwLCAnMCcsICdmYWxzZScsICdGYWxzZScsIE5vbmUpCiAgICAgICAgIyDQpNC+0YDQvNC40YDRg9C10Lwg0YLQsNCx0LvQuNGG0YMg0LrQsNGA0YLQvtGH0LXQuiDQuCDQt9Cw0L/RgNC+0YEg0Log0LHQsNC30LUKCiAgICAgICAgZG9jX2RldGFpbHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2Zsb3dfdGFibGVfZGF0YSgpCiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShkb2NfZGV0YWlscykKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2RvY190YWJsZV92aWV3KHRhYmxlX2RhdGE9dGFibGVfZGF0YSkKCiAgICAgICAgaWYgZG9jX2RldGFpbHM6CiAgICAgICAgICAgICMgaGFzaE1hcC5wdXQoJ2lkX2RvYycsIHN0cihyZXN1bHRzWzBdWydpZF9kb2MnXSkpCgogICAgICAgICAgICAjINCf0YDQuNC30L3QsNC6LCBoYXZlX3F0dHlfcGxhbiDQldGB0YLRjNCf0LvQsNC90J/QntCa0J7Qu9C40YfQtdGB0YLQstGDICAtICDQmNGB0YLQuNC90LAg0LrQvtCz0LTQsCDRgdGD0LzQvNCwINC60L7Qu9C+0L3QutC4IFF0dHlfcGxhbiA+IDAKICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAgaGF2ZV9tYXJrX3BsYW4gItCV0YHRgtGM0J/Qu9Cw0L3QmtCe0LTQvtCy0JzQsNGA0LrQuNGA0L7QstC60Lgg4oCTINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQvtC6INGC0LDQsdC7LiBSU19kb2NzX2JhcmNvZGVzINGBINC30LDQtNCw0L3QvdGL0LwgaWRfZG9jINC4IGlzX3BsYW4gINCx0L7Qu9GM0YjQtSDQvdGD0LvRjy4KICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiBoYXZlX3plcm9fcGxhbiAi0JXRgdGC0Ywg0YHRgtGA0L7QutC4INGC0L7QstCw0YDQsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUiINCY0YHRgtC40L3QsCwg0LrQvtCz0LTQsCDQtdGB0YLRjCDQt9Cw0L/QvtC70L3QtdC90L3Ri9C1INGB0YLRgNC+0LrQuCDRgtC+0LLQsNGA0L7QsiDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICAgICAgIyDQn9GA0LjQt9C90LDQuiAi0JrQvtC90YLRgNC+0LvQuNGA0L7QstCw0YLRjCIgIC0g0L/RgNC40LfQvdCw0Log0LTQu9GPINC00L7QutGD0LzQtdC90YLQsCwg0L3QsNC00L4g0LvQuCDQutC+0L3RgtGA0L7Qu9C40YDQvtCy0LDRgtGMCgogICAgICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyLAogICAgICAgICAgICAgICAgc3VtKGlmbnVsbChxdHR5X3BsYW4sMCkpIGFzIHF0dHlfcGxhbgogICAgICAgICAgICAgICAgZnJvbSBSU19kb2NzX3RhYmxlIFdoZXJlIGlkX2RvYyA9IDppZF9kb2MnJycKICAgICAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQsIHsnaWRfZG9jJzogaWRfZG9jfSkKICAgICAgICAgICAgaWYgbm90IHJlczoKICAgICAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gRmFsc2UKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfemVyb19wbGFuID0gcmVzWzBdWzBdID4gMCAgIyDQkiDQtNC+0LrRg9C80LXQvdGC0LUg0LXRgdGC0Ywg0YHRgtGA0L7QutC4CiAgICAgICAgICAgICAgICBpZiBoYXZlX3plcm9fcGxhbjoKICAgICAgICAgICAgICAgICAgICBoYXZlX3F0dHlfcGxhbiA9IHJlc1swXVsxXSA+IDAgICMg0JIg0LTQvtC60YPQvNC10L3RgtC1INC10YHRgtGMINC60L7Qu9Cy0L4g0L/Qu9Cw0L0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaGF2ZV9xdHR5X3BsYW4gPSBGYWxzZQogICAgICAgICAgICAjINCV0YHRgtGMINC70Lgg0LIg0LTQvtC60YPQvNC10L3RgtC1INC/0LvQsNC9INC/0L4g0LrQvtC00LDQvCDQvNCw0YDQutC40YDQvtCy0LrQuAogICAgICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgICAgICAgICAgU0VMRUNUIGRpc3RpbmN0IGNvdW50KGlkKSBhcyBjb2xfc3RyCiAgICAgICAgICAgICAgICBmcm9tIFJTX2RvY3NfYmFyY29kZXMgV2hlcmUgaWRfZG9jID0gOmlkX2RvYyBBTkQgaXNfcGxhbiA9IDppc19wbGFuJycnCiAgICAgICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KHF0ZXh0LCB7J2lkX2RvYyc6IGlkX2RvYywgJ2lzX3BsYW4nOiAnMSd9KQogICAgICAgICAgICBpZiBub3QgcmVzOgogICAgICAgICAgICAgICAgaGF2ZV9tYXJrX3BsYW4gPSBGYWxzZQoKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGhhdmVfbWFya19wbGFuID0gcmVzWzBdWzBdID4gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhhdmVfcXR0eV9wbGFuID0gRmFsc2UKICAgICAgICAgICAgaGF2ZV96ZXJvX3BsYW4gPSBGYWxzZQogICAgICAgICAgICBoYXZlX21hcmtfcGxhbiA9IEZhbHNlCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdoYXZlX3F0dHlfcGxhbicsIHN0cihoYXZlX3F0dHlfcGxhbikpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2hhdmVfemVyb19wbGFuJywgc3RyKGhhdmVfemVyb19wbGFuKSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaGF2ZV9tYXJrX3BsYW4nLCBzdHIoaGF2ZV9tYXJrX3BsYW4pKQogICAgICAgIHJlcyA9IHVpX2dsb2JhbC5nZXRfcXVlcnlfcmVzdWx0KCdTRUxFQ1QgY29udHJvbCBmcm9tIFJTX2RvY3MgIFdIRVJFIGlkX2RvYyA9ID8nLCAoaWRfZG9jLCkpCiAgICAgICAgIyDQldGB0YLRjCDQu9C4INC60L7QvdGC0YDQvtC70Ywg0L/Qu9Cw0L3QsCDQsiDQtNC+0LrRg9C80LXQvdGC0LUKICAgICAgICBpZiByZXM6CiAgICAgICAgICAgIGlmIHJlc1swXVswXToKICAgICAgICAgICAgICAgIGlmIHJlc1swXVswXSBpbiBmYWxzZVZhbHVlTGlzdDoKICAgICAgICAgICAgICAgICAgICBjb250cm9sID0gJ0ZhbHNlJwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjb250cm9sID0gJ1RydWUnCgogICAgICAgICAgICAgICAgIyBjb250cm9sID0gcmVzWzBdWzBdICMnVHJ1ZScKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGNvbnRyb2wgPSAnRmFsc2UnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udHJvbCA9ICdGYWxzZScKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NvbnRyb2wnLCBjb250cm9sKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJkb2NfYmFyY19mbG93IiwgdGFibGVfdmlldy50b19qc29uKCkpCgogICAgICAgIGlmIFRydWUgaW4gKGhhdmVfcXR0eV9wbGFuLCBoYXZlX3plcm9fcGxhbiwgaGF2ZV9tYXJrX3BsYW4sIGNvbnRyb2wpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndG9hc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn0JTQsNC90L3Ri9C5INC00L7QutGD0LzQtdC90YIg0YHQvtC00LXRgNC20LjRgiDQv9C70LDQvdC+0LLRi9C1INGB0YLRgNC+0LrQuC4g0KHQv9C40YHQvtC6INGI0YLRgNC40YXQutC+0LTQvtCyINCyINC90LXQs9C+INC/0L7QvNC10YHRgtC40YLRjCDQvdC10LvRjNC30Y8nKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd1NjcmVlbicsICfQlNC+0LrRg9C80LXQvdGC0YsnKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9kb2NfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTMKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KHNlbGYpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0BiYXJjb2RlJyksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MywKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBkb2NfZGV0YWlscyk6CgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCJldmVudCIpID09ICJvblJlc3VsdFBvc2l0aXZlIjoKICAgICAgICAgICAgYmFyY29kZSA9IHN0cihzZWxmLmhhc2hfbWFwLmdldCgnZmxkX2JhcmNvZGUnKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlID0gc3RyKHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlX2NhbWVyYScpKQoKICAgICAgICBpZiBiYXJjb2RlOgogICAgICAgICAgICBkb2NfZGV0YWlscyA9IHNlbGYuX3NvcnRfdGFibGVfYnlfYmFyY29kZShkb2NfZGV0YWlscywgYmFyY29kZSkKCiAgICAgICAgdGFibGVfZGF0YSA9IFt7fV0KICAgICAgICAjIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2VsZi5oYXNoX21hcC5nZXQoJ2FkZGVkX2dvb2RzJykpCgogICAgICAgIGZvciByZWNvcmQgaW4gZG9jX2RldGFpbHM6CgogICAgICAgICAgICBwcm9kdWN0X3JvdyA9IHsna2V5Jzogc3RyKHJlY29yZFsnYmFyY29kZSddKSwgJ2JhcmNvZGUnOiBzdHIocmVjb3JkWydiYXJjb2RlJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZFsnbmFtZSddIGlmIHJlY29yZFsnbmFtZSddIGlzIG5vdCBOb25lIGVsc2UgJy3QvdC10YIg0LTQsNC90L3Ri9GFLScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICdxdHR5Jzogc3RyKHJlY29yZFsncXR0eSddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCl9CgogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddLkJhY2tncm91bmRDb2xvciA9ICcjRkZGRkZGJyBpZiByZWNvcmRbJ25hbWUnXSBpcyBub3QgTm9uZSBlbHNlICIjRkJFOUU3IgoKICAgICAgICAgICAgIyDRjdGC0L4g0L3QtSDRgNCw0LHQvtGC0LDQtdGCINGB0YPQtNGPINC/0L4g0LLRgdC10LzRgyDQv9C+0YLQvtC80YMg0YfRgtC+INC90LXRgiDQsiBoYXNoX21hcCDQutC70Y7Rh9CwIGFkZGVkX2dvb2RzCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9zb3J0X3RhYmxlX2J5X2JhcmNvZGUoc2VsZiwgdGFibGUsIGJhcmNvZGUpOgoKICAgICAgICBmb3IgaSwgcm93IGluIGVudW1lcmF0ZSh0YWJsZSk6CiAgICAgICAgICAgIGlmIHN0cihyb3cuZ2V0KCdiYXJjb2RlJykpID09IGJhcmNvZGU6CiAgICAgICAgICAgICAgICBkZWwgdGFibGVbaV0KICAgICAgICAgICAgICAgIHRhYmxlLmluc2VydCgwLCByb3cpCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICByZXR1cm4gdGFibGUKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICBvY3Jfbm9zcWwgPSBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWwKICAgICAgICBzZXJpYWxfb2NyX3NldHRpbmdzID0gb2NyX25vc3FsLmdldCgnc2VyaWFsX29jcl9zZXR0aW5ncycpCiAgICAgICAgaWYgc2VyaWFsX29jcl9zZXR0aW5nczoKICAgICAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IGpzb24ubG9hZHMoc2VyaWFsX29jcl9zZXR0aW5ncykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdmlzaW9uX3NldHRpbmdzKCoqc2VyaWFsX29jcl9zZXR0aW5ncykKICAgICAgICAgICAgb2NyX25vc3FsLnB1dCgnZnJvbV9zY3JlZW4nLCAnRmxvd0RvY0RldGFpbHNTY3JlZW4nLCBUcnVlKQoKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBEb2NEZXRhaWxzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gR29vZHMgc2VsZWN0ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgQmFzZUdvb2RTZWxlY3QoU2NyZWVuKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgX3JzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6ICcnCiAgICAgICAgfQogICAgICAgIHNlbGYuaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnaWRfZG9jJ10KICAgICAgICBzZWxmLnNlcnZpY2UgPSBEb2NTZXJ2aWNlKHNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuY3VycmVudF90b2FzdF9tZXNzYWdlID0gJycKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ2lkX2RvYyddCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgICMg0KDQtdC20LjQvCDRgNCw0LHQvtGC0Ysg0YEg0LzRg9C70YzRgtC40LzQtdC00LjQsCDQuCDRhNCw0LnQu9Cw0LzQuCDQv9C+INGB0YHRi9C70LrQsNC8ICjRhNC70LDQsyBtbV9sb2NhbCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydtbV9sb2NhbCddID0gJycKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdxdHR5JywgJzAnKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ25ld19xdHR5Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfcXR0eScsIHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5JykpCgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKToKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gImJ0bl9vayI6CiAgICAgICAgICAgIHNlbGYuX2hhbmRsZV9idG5fb2soKQogICAgICAgIGVsaWYgJ29wcycgaW4gbGlzdGVuZXI6CiAgICAgICAgICAgICIiItCf0YDQtdGE0LjQutGBINC60L3QvtC/0L7QuiArLy0sINC30L3QsNGH0LXQvdC40LUg0LIg0L3QsNC30LLQsNC90LjRj9GFINC60L3QvtC/0L7QuiIiIgogICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgndXNlX3NlcmllcycpID09ICIxIjoKICAgICAgICAgICAgICAgIHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbihzZWxmLmhhc2hfbWFwWydrZXknXSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShpbnQobGlzdGVuZXJbNDpdKSkKICAgICAgICBlbGlmIGxpc3RlbmVyIGluIFsiYnRuX2NhbmNlbCIsICdCQUNLX0JVVFRPTicsICdPTl9CQUNLX1BSRVNTRUQnXToKICAgICAgICAgICBzZWxmLl9oYW5kbGVfYnRuX29rKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcHJpbnQnOgogICAgICAgICAgICBzZWxmLnByaW50X3RpY2tldCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX3Byb2Nlc3NfdGhlX2JhcmNvZGUoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzZWxmLnByaW50X3RpY2tldCgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX2RvY19nb29kX2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9oYW5kbGVfZG9jX2dvb2RfYmFyY29kZSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYnRuX3Nlcmllc19zaG93JzoKICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9pbnB1dF9xdHR5JzoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zaG93X2RpYWxvZ19xdHR5KCkKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgnbW9kYWxfZGlhbG9nX2lucHV0X3F0dHknKToKICAgICAgICAgICAgaWYgc2VsZi5fdmFsaWRhdGVfZGVsdGFfaW5wdXQoKToKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YSgwKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9tYXJrc19zaG93JzoKICAgICAgICAgICAgc2VsZi5fb3Blbl9tYXJrc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCgogICAgZGVmIF9oYW5kbGVfYnRuX29rKHNlbGYpOgogICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuX2dldF9jdXJyZW50X2VsZW0oKQoKICAgICAgICBuZXdfcXR0eSA9IGZsb2F0KHNlbGYuaGFzaF9tYXBbJ25ld19xdHR5J10gb3IgMCkKICAgICAgICBxdHR5X3BsYW4gPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eV9wbGFuJykgb3IgMCkKICAgICAgICBxdHR5ID0gZmxvYXQoY3VycmVudF9lbGVtLmdldCgnZF9xdHR5Jykgb3IgMCkKCiAgICAgICAgaWYgbmV3X3F0dHkgPCAwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQmNGC0L7Qs9C+0LLQvtC1INC60L7Qu9C40YfQtdGB0YLQstC+INC80LXQvdGM0YjQtSAwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjb250cm9sID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgaWYgY29udHJvbCBhbmQgKG1heChuZXdfcXR0eSwgcXR0eSkgPiBxdHR5X3BsYW4pOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUg0L/RgNC10LLRi9GI0LXQvdC+JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjdXJyZW50X2VsZW0gPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgIHF0dHkgPSBuZXdfcXR0eQoKICAgICAgICBzZWxmLl9oYW5kbGVfY2hvaWNlKGN1cnJlbnRfZWxlbSwgcXR0eSkKCiAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19xdHR5JywgJycpCgogICAgZGVmIF9oYW5kbGVfY2hvaWNlKHNlbGYsIGN1cnJlbnRfZWxlbSwgcXR0eSk6CiAgICAgICAgcm93X2lkID0gaW50KGN1cnJlbnRfZWxlbVsna2V5J10pIGlmIGN1cnJlbnRfZWxlbSBlbHNlIHNlbGYuc2NyZWVuX3ZhbHVlcy5nZXQoJ2tleScpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdrZXknKQogICAgICAgIHVwZGF0ZV9kYXRhID0gewogICAgICAgICAgICAnc2VudCc6IDAsCiAgICAgICAgICAgICdxdHR5JzogZmxvYXQocXR0eSkgaWYgcXR0eSBlbHNlIDAsCiAgICAgICAgfQogICAgICAgIHNlbGYuX3VwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykpCiAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgIGRlZiBfaGFuZGxlX2RvY19nb29kX2JhcmNvZGUoc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICBpbml0X2RhdGEgPSB7CiAgICAgICAgICAgICdpdGVtX2lkJzogc2VsZWN0ZWRfY2FyZF9kYXRhLmdldCgnaWRfZ29vZCcsICcnKSwKICAgICAgICAgICAgJ3Byb3BlcnR5X2lkJzogc2VsZWN0ZWRfY2FyZF9kYXRhLmdldCgnaWRfcHJvcGVydGllcycsICcnKSwKICAgICAgICAgICAgJ3VuaXRfaWQnOiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCdpZF91bml0JywgJycpCiAgICAgICAgfQogICAgICAgIEJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvd19wcm9jZXNzX3Jlc3VsdChpbml0X2RhdGEpCgogICAgZGVmIF92YWxpZGF0ZV9kZWx0YV9pbnB1dChzZWxmKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZsb2F0KHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgc2VsZi50b2FzdCgn0JLQstC10LTQtdC90L3QvtC1INC30L3QsNGH0LXQvdC40LUg0L3QtSDRj9Cy0LvRj9C10YLRgdGPINCy0LDQu9C40LTQvdGL0Lwg0YfQuNGB0LvQvtC8JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCgogICAgZGVmIF9maWxsX25vbmVfdmFsdWVzKHNlbGYsIGRhdGEsIGtleXMsIGRlZmF1bHQ9JycpOgogICAgICAgIG5vbmVfbGlzdCA9IFtOb25lLCAnTm9uZSddCiAgICAgICAgZm9yIGtleSBpbiBrZXlzOgogICAgICAgICAgICBkYXRhW2tleV0gPSBkZWZhdWx0IGlmIGRhdGFba2V5XSBpbiBub25lX2xpc3QgZWxzZSBkYXRhW2tleV0KCiAgICBkZWYgX21hdGNoX3JlY29yZChzZWxmLCByZWNvcmQsIGlkX2dvb2QsIGlkX3Byb3BlcnR5LCBpZF91bml0KToKICAgICAgICByZXR1cm4gKHJlY29yZFsnaWRfZ29vZCddID09IGlkX2dvb2QgYW5kCiAgICAgICAgICAgICAgICByZWNvcmRbJ2lkX3Byb3BlcnRpZXMnXSA9PSBpZF9wcm9wZXJ0eSBhbmQKICAgICAgICAgICAgICAgIHJlY29yZFsnaWRfdW5pdCddID09IGlkX3VuaXQpCgogICAgZGVmIF9maW5kX21hdGNoaW5nX2dvb2Qoc2VsZiwgdGFibGVfZGF0YSwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIGZvciBpLCByZWNvcmQgaW4gZW51bWVyYXRlKHRhYmxlX2RhdGFbMTpdLCBzdGFydD0xKToKICAgICAgICAgICAgaWYgc2VsZi5fbWF0Y2hfcmVjb3JkKHJlY29yZCwgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgICAgICAgICAgcmV0dXJuIGkKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBfaGFuZGxlX2ZvdW5kX2JhcmNvZGUoc2VsZiwgcmVzLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgaWRfZ29vZF9iciwgaWRfcHJvcGVydHlfYnIsIGlkX3VuaXRfYnIsIHJhdGlvID0gcmVzWydpZF9nb29kJ10sIHJlc1snaWRfcHJvcGVydHknXSwgcmVzWydpZF91bml0J10sIGludChyZXNbJ3JhdGlvJ10pCgogICAgICAgIGlmIGlkX2dvb2QgPT0gaWRfZ29vZF9iciBhbmQgaWRfcHJvcGVydHkgPT0gaWRfcHJvcGVydHlfYnIgYW5kIGlkX3VuaXQgPT0gaWRfdW5pdF9icjoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZi5oYXNoX21hcFsna2V5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmF0aW8pCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBfZ2V0X2N1cnJlbnRfZWxlbShzZWxmKToKICAgICAgICBjdXJyZW50X2VsZW0gPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX2RhdGEnKQogICAgICAgIHJldHVybiBjdXJyZW50X2VsZW0gb3Igc2VsZi5zY3JlZW5fdmFsdWVzCgogICAgZGVmIF9zYXZlX25ld19kZWx0YShzZWxmKToKICAgICAgICBuZXdfcXR0eSA9IHNlbGYuX2dldF9mbG9hdF92YWx1ZShzZWxmLmhhc2hfbWFwLmdldCgnbmV3X3F0dHknKSkKCiAgICAgICAgaWYgbmV3X3F0dHkgPCAwOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQmNGC0L7Qs9C+0LLQvtC1INC60L7Qu9C40YfQtdGB0YLQstC+INC80LXQvdGM0YjQtSAwJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc2V0PVRydWUpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBjb250cm9sID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgnY29udHJvbCcpCiAgICAgICAgaWYgY29udHJvbDoKICAgICAgICAgICAgaWYgbmV3X3F0dHkgPiBzZWxmLl9nZXRfZmxvYXRfdmFsdWUoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHlfcGxhbicpKToKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Ca0L7Qu9C40YfQtdGB0YLQstC+INC/0LvQsNC9INCyINC00L7QutGD0LzQtdC90YLQtSDQv9GA0LXQstGL0YjQtdC90L4nKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgICAgIHNlbGYuX3NldF9kZWx0YShyZXNldD1UcnVlKQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuX2dldF9jdXJyZW50X2VsZW0oKQogICAgICAgIHF0dHkgPSBuZXdfcXR0eQogICAgICAgIG9sZF9xdHR5ID0gZmxvYXQoY3VycmVudF9lbGVtLmdldCgncXR0eScpIG9yIDApCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3BhcmVudF9zY3JlZW4nKSA9PSAn0JLRi9Cx0L7RgNCi0L7QstCw0YDQsNCQ0YDRgtC40LrRg9C7JzoKICAgICAgICAgICAgY3VycmVudF9lbGVtID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9kYXRhJykKICAgICAgICAgICAgaWYgcXR0eSA9PSBzZWxmLl9nZXRfZmxvYXRfdmFsdWUoc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKSk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQktGL0LHQvtGA0KLQvtCy0LDRgNCw0JDRgNGC0LjQutGD0LsiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGZpbmRlZF9nb29kc19jYXJkcyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdmaW5kZWRfZ29vZHNfY2FyZHMnLCBmcm9tX2pzb249VHJ1ZSkKICAgICAgICAgICAgY2FyZHNkYXRhID0gZmluZGVkX2dvb2RzX2NhcmRzWydjdXN0b21jYXJkcyddWydjYXJkc2RhdGEnXQoKICAgICAgICAgICAgY2FyZF9kYXRhID0gbmV4dChlbGVtIGZvciBlbGVtIGluIGNhcmRzZGF0YQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGVsZW1bJ2tleSddID09IGN1cnJlbnRfZWxlbVsna2V5J10pCiAgICAgICAgICAgIGNhcmRfZGF0YVsncXR0eSddID0gcXR0eQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZmluZGVkX2dvb2RzX2NhcmRzJywgZmluZGVkX2dvb2RzX2NhcmRzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oItCS0YvQsdC+0YDQotC+0LLQsNGA0LDQkNGA0YLQuNC60YPQuyIpCiAgICAgICAgZWxpZiBxdHR5ICE9IG9sZF9xdHR5OgogICAgICAgICAgICB1cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgICAgICdxdHR5JzogcXR0eSwKICAgICAgICAgICAgfQogICAgICAgICAgICByb3dfaWQgPSBpbnQoY3VycmVudF9lbGVtWydrZXknXSkKICAgICAgICAgICAgc2VsZi5fdXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXJvd19pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19xdHR5Jywgc3RyKHJvdW5kKHF0dHksIDMpKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3F0dHknLCBzdHIocXR0eSkpCgogICAgZGVmIF9nZXRfZmxvYXRfdmFsdWUoc2VsZiwgdmFsdWUpOgogICAgICAgIGlmIHZhbHVlIGFuZCByZS5tYXRjaCgiXlxkK1wuP1xkKiQiLCB2YWx1ZSk6CiAgICAgICAgICAgIHJldHVybiBmbG9hdCh2YWx1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gMC4wCgogICAgZGVmIF9wcm9jZXNzX3RoZV9iYXJjb2RlKHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9nb29kX3NlbGVjdCcpCiAgICAgICAgYWxsb3dlZF9mYWN0X2lucHV0ID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2FsbG93X2ZhY3RfaW5wdXQnKQogICAgICAgIGlmIG5vdCAoYmFyY29kZSBhbmQgYWxsb3dlZF9mYWN0X2lucHV0KToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KjRgtGA0LjRhdC60L7QtCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUhJykgIyDQv9C+0LrQsCDRgtC+0YHRgiwg0LzQvtC00LDQu9C60LAg0L7Rh9C40YnQsNC10YIg0LTQtdC70YzRgtGDCiAgICAgICAgICAgICMgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZyhsaXN0ZW5lcj0nYmFyY29kZV9ub3RfZm91bmQnLCB0aXRsZT0n0KjRgtGA0LjRhdC60L7QtCDQvdC1INC90LDQudC00LXQvSDQsiDQtNC+0LrRg9C80LXQvdGC0LUhJykKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlkX2dvb2QgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfZ29vZCcpCiAgICAgICAgaWRfcHJvcGVydHkgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfcHJvcGVydHknKSBvciAnJwogICAgICAgIGlkX3VuaXQgPSBzZWxmLmhhc2hfbWFwLmdldCgnaWRfdW5pdCcpIG9yICcnCgogICAgICAgIHJlcyA9IHNlbGYuc2VydmljZS5nZXRfYmFyY29kZShiYXJjb2RlKQogICAgICAgIGlmIHJlcyBhbmQgc2VsZi5faGFuZGxlX2ZvdW5kX2JhcmNvZGUocmVzLCBpZF9nb29kLCBpZF9wcm9wZXJ0eSwgaWRfdW5pdCk6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdChzZWxmLmN1cnJlbnRfdG9hc3RfbWVzc2FnZSBvciBmJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LTQvtC60YPQvNC10L3RgtC1IScpICMg0L/QvtC60LAg0YLQvtGB0YIsINC80L7QtNCw0LvQutCwINC+0YfQuNGJ0LDQtdGCINC00LXQu9GM0YLRgwogICAgICAgICNzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKGxpc3RlbmVyPSdiYXJjb2RlX25vdF9mb3VuZCcsIHRpdGxlPSfQqNGC0YDQuNGF0LrQvtC0INC90LUg0L3QsNC50LTQtdC9INCyINC00L7QutGD0LzQtdC90YLQtSEnKQoKICAgIGRlZiBfc2V0X2RlbHRhKHNlbGYsIHZhbHVlOiBpbnQgPSAwLCByZXNldDogYm9vbCA9IEZhbHNlKToKICAgICAgICAiIiLQodC+0LfQtNCw0LXQvCAo0L7QsdC90YPQu9GP0LXQvCkg0L/QvtC70LUg0LLQstC+0LTQsCIiIgogICAgICAgIGlmIHJlc2V0OgogICAgICAgICAgICBkZWx0YSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfcXR0eScsIHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5JykpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGVsdGEgPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKSBvciAwKSArIHZhbHVlIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpIGVsc2UgdmFsdWUKICAgICAgICAgICAgZGVsdGEgPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoZGVsdGEpCiAgICAgICAgICAgIHNlbGYuX3NldF9yZXN1bHRfcXR0eShkZWx0YSkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RlbHRhJywgZGVsdGEpCgogICAgZGVmIF9mb3JtYXRfcXVhbnRpdHkoc2VsZiwgcXR0eSk6CiAgICAgICAgaWYgZmxvYXQocXR0eSkgJSAxID09IDA6CiAgICAgICAgICAgIHJldHVybiBpbnQoZmxvYXQocXR0eSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHF0dHkKCiAgICBkZWYgX3NldF9yZXN1bHRfcXR0eShzZWxmLCBkZWx0YSk6CiAgICAgICAgbmV3X3F0dHkgPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpIG9yIDApICsgZGVsdGEKICAgICAgICBuZXdfcXR0eSA9IHN0cihzZWxmLl9mb3JtYXRfcXVhbnRpdHkobmV3X3F0dHkpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCduZXdfcXR0eScsIG5ld19xdHR5KQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbigi0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsiKQoKICAgIGRlZiBwcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgIyDQn9C+0LvRg9GH0LjQvCDQv9C10YDQstGL0Lkg0LHQsNGA0LrQvtC0INC00L7QutGD0LzQtdC90YLQsAoKICAgICAgICBiYXJjb2RlID0gZGJfc2VydmljZXMuQmFyY29kZVNlcnZpY2UoKS5nZXRfYmFyY29kZV9mcm9tX2RvY190YWJsZShzZWxmLmhhc2hfbWFwLmdldCgna2V5JykpCgogICAgICAgIGRhdGEgPSB7J9CU0LDRgtCwX9C00L7Quic6ICdEb2NfZGF0YScsICfQndC+0LzQtdC90LrQu9Cw0YLRg9GA0LAnOiAnR29vZCcsCiAgICAgICAgICAgICAgICAn0JDRgNGC0LjQutGD0LsnOiAnZ29vZF9hcnQnLCAn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAJzogJ2dvb2Rfc24nLAogICAgICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiAnZ29vZF9wcm9wZXJ0eScsICfQptC10L3QsCc6ICdnb29kX3ByaWNlJywKICAgICAgICAgICAgICAgICfQldC00JjQt9C8JzogJ2dvb2RfdW5pdCcsICfQmtC70Y7Rhyc6ICdrZXknLCAn0JLQsNC70Y7RgtCwJzogJ3ByaWNlX3R5cGUnfQogICAgICAgIGZvciBrZXkgaW4gZGF0YToKICAgICAgICAgICAgZGF0YVtrZXldID0gc2VsZi5oYXNoX21hcC5nZXQoZGF0YVtrZXldKQogICAgICAgIGRhdGFbJ2JhcmNvZGUnXSA9IGJhcmNvZGUgaWYgYmFyY29kZSBlbHNlICcwMDAwMDAwMDAwMDAwJwogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYsIGRvY19yb3dfa2V5KToKICAgICAgICBzZXRfY3VycmVudF9zY3JlZW4oTm9uZSkKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgICAgICd1c2VfYWRyX2RvY3NfdGFibGVzJzogJzAnCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IFNlcmllc1NlbGVjdFNjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncwogICAgICAgICkKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdChzY3JlZW5fdmFsdWVzKQoKICAgIGRlZiBfb3Blbl9tYXJrc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19pZCk6CiAgICAgICAgdGFibGVfZGF0YSA9IHNlbGYuX2dldF9tYXJrc19kYXRhKGRvY19yb3dfaWQpCiAgICAgICAgaWYgbm90IHRhYmxlX2RhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzY3JlZW5fYXJncyA9IHsKICAgICAgICAgICAgJ3RpdGxlJzogJ9Cc0LDRgNC60Lgg0YLQvtCy0LDRgNCwJywKICAgICAgICAgICAgJ3RhYmxlX2RhdGEnOiBqc29uLmR1bXBzKHRhYmxlX2RhdGEpLAogICAgICAgICAgICAndGFibGVfaGVhZGVyJzoganNvbi5kdW1wcyh7J21hcmtfY29kZSc6ICfQnNCw0YDQutCwJ30pLAogICAgICAgICAgICAnZW51bWVyYXRlJzogVHJ1ZQogICAgICAgIH0KICAgICAgICBTaG93SXRlbXNTY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvd19wcm9jZXNzX3Jlc3VsdChzY3JlZW5fYXJncykKCiAgICBkZWYgX2dldF9tYXJrc19kYXRhKHNlbGYsIGRvY19yb3dfaWQpOgogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuZ2V0X21hcmtzX2RhdGEoc2VsZi5pZF9kb2MsIGRvY19yb3dfaWQpCgogICAgZGVmIF91cGRhdGVfZG9jX3RhYmxlX3JvdyhzZWxmLCBkYXRhOiBEaWN0LCByb3dfaWQpOgogICAgICAgIGlmIG5vdCBzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHVwZGF0ZV9kYXRhID0gewogICAgICAgICAgICAnc2VudCc6IDAsCiAgICAgICAgICAgICdkX3F0dHknOiBmbG9hdChkYXRhWydxdHR5J10pLAogICAgICAgICAgICAncXR0eSc6IGZsb2F0KGRhdGFbJ3F0dHknXSksCiAgICAgICAgfQoKICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX2RvY190YWJsZV9yb3coZGF0YT11cGRhdGVfZGF0YSwgcm93X2lkPXJvd19pZCkKICAgICAgICBzZWxmLnNlcnZpY2Uuc2V0X2RvY19zdGF0dXNfdG9fdXBsb2FkKHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSkKCiAgICBkZWYgX3Nob3dfZGlhbG9nX3F0dHkoc2VsZik6CiAgICAgICAgbG95YXV0ID0gJycnewogICAgICAgICAgICAidHlwZSI6ICJMaW5lYXJMYXlvdXQiLAogICAgICAgICAgICAiVmFyaWFibGUiOiAiIiwKICAgICAgICAgICAgIm9yaWVudGF0aW9uIjogImhvcml6b250YWwiLAogICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICJ3aWR0aCI6ICJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAid2VpZ2h0IjogIjAiLAogICAgICAgICAgICAiRWxlbWVudHMiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgIlZhbHVlIjogIkBkZWx0YSIsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhYmxlIjogImRlbHRhIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIndyYXBfY29udGVudCIsCiAgICAgICAgICAgICAgICAgICAgIndpZHRoIjogIm1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICAgICAgIndlaWdodCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJFZGl0VGV4dE51bWVyaWMiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9JycnCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygnbW9kYWxfZGlhbG9nX2lucHV0X3F0dHknLCB0aXRsZT0i0JLQstC+0LQg0LrQvtC70LjRh9C10YHRgtCy0LAg0YLQvtCy0LDRgNCwIiwgZGlhbG9nX2xheW91dD1sb3lhdXQpCgoKY2xhc3MgR29vZHNTZWxlY3RTY3JlZW4oQmFzZUdvb2RTZWxlY3QpOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgCDQstGL0LHQvtGAJwogICAgcHJvY2Vzc19uYW1lID0gJ9CU0L7QutGD0LzQtdC90YLRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCiAgICAgICAgI9CT0L7RgtC+0LLQuNC8INC00LDQvdC90YvQtSDQtNC70Y8g0L/QtdGA0LLQuNGH0L3QvtCz0L4g0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQv9GA0Lgg0L7RgtC60YDRi9GC0LjQuCDQv9C+INC60LvQuNC60YMKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnd2FzX2NsaWNrZWQnKSA9PSAnMSc6CiAgICAgICAgICAgIGRvY19yb3dzID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfcm93c19jb3VudChzZWxmLmlkX2RvYylbJ2RvY19yb3dzJ10KICAgICAgICAgICAgZG9jX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX2RhdGEoc2VsZi5pZF9kb2MsIDAsIGRvY19yb3dzKQogICAgICAgICAgICBkb2NfZGF0YS5pbnNlcnQoMCwge30pCiAgICAgICAgICAgIGN1cnJlbnRfZWxlbSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmRfZGF0YScpCgogICAgICAgICAgICAjINGC0LXQutGD0YnQuNC5INGN0LvQtdC80LXQvdGCINC90LUg0L3QsNC50LTQtdC9INC40LvQuCDRjdGC0L4g0LfQsNCz0L7Qu9C+0LLQvtC6INGC0LDQsdC70LjRhtGLCiAgICAgICAgICAgIGlmIGN1cnJlbnRfZWxlbSBpcyBOb25lIG9yICdnb29kX25hbWUnIG5vdCBpbiBjdXJyZW50X2VsZW06CiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIHNob3dfaGlkZSA9ICcxJwogICAgICAgICAgICAjINCS0LjQtNC40LzQvtGB0YLRjCDQutC90L7Qv9C+0LogJzwnICc+JwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydTaG93X2J0bl9uZXh0X2dvb2QnXSA9IHNob3dfaGlkZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydTaG93X2J0bl9wcmV2aW91c19nb29kJ10gPSBzaG93X2hpZGUKCiAgICAgICAgICAgIGRvY19wb3NpdGlvbiA9IHNlbGYuX2ZpbmRfbWF0Y2hpbmdfZ29vZChkb2NfZGF0YSwgY3VycmVudF9lbGVtWydpZF9nb29kJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZWxlbVsnaWRfcHJvcGVydGllcyddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2VsZW1bJ2lkX3VuaXQnXSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX2RvY19kYXRhJywgZG9jX2RhdGEsIHRvX2pzb249VHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY19yb3dzJywgZG9jX3Jvd3MpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX2RhdGEnLCBjdXJyZW50X2VsZW0sIHRvX2pzb249VHJ1ZSkKCiAgICAgICAgICAgIGlmIGRvY19wb3NpdGlvbjoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uJywgc3RyKGRvY19wb3NpdGlvbikpCiAgICAgICAgICAgICAgICBzZWxmLl9nb29kc19zZWxlY3RvcignaW5kZXgnLCBpbmRleD1kb2NfcG9zaXRpb24pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd3YXNfY2xpY2tlZCcsICctMScpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnYnRuX25leHRfZ29vZCc6CiAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKCJuZXh0IikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdidG5fcHJldmlvdXNfZ29vZCc6CiAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKCJwcmV2aW91cyIpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfZG9jKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2dldF9jdXJyZW50X2VsZW0oc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbiA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBmcm9tX2pzb249VHJ1ZSkKICAgICAgICBjdXJyZW50X2VsZW0gPSB0YWJsZV9kYXRhW3NlbGVjdGVkX2NhcmRfcG9zaXRpb25dCiAgICAgICAgY3VycmVudF9lbGVtWydrZXknXSA9IGN1cnJlbnRfZWxlbS5nZXQoJ2lkJykKICAgICAgICByZXR1cm4gY3VycmVudF9lbGVtCgogICAgZGVmIF9nb29kc19zZWxlY3RvcihzZWxmLCBhY3Rpb24sIGluZGV4ID0gTm9uZSk6CiAgICAgICAgCiAgICAgICAgZ2xvYmFsX3Bvc2l0aW9uID0gaW5kZXggaWYgaW5kZXggZWxzZSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ0dvb2RzU2VsZWN0U2NyZWVuX3NlbGVjdGVkX2NhcmRfcG9zaXRpb24nKSkKCiAgICAgICAgZG9jX3Jvd3MgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2RvY19yb3dzJykpCiAgICAgICAgZG9jX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBmcm9tX2pzb249VHJ1ZSkKCiAgICAgICAgaWYgaW5kZXggaXMgTm9uZToKICAgICAgICAgICAgIyDQv9C10YDQtdC0INC/0LXRgNC10LvQuNGB0YLRi9Cy0LDQvdC40LXQvCDRgdC+0YXRgNCw0L3QuNC8INC00LXQu9GM0YLRgyDQuCDQvtCx0L3QvtCy0LjQvCDQutC+0Lst0LLQviDQsiDRgdC70L7QstCw0YDQtQogICAgICAgICAgICBzZWxmLl9zYXZlX25ld19kZWx0YSgpCiAgICAgICAgICAgIGRvY19kYXRhW2dsb2JhbF9wb3NpdGlvbl1bJ2RfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ3F0dHknKQogICAgICAgICAgICBkb2NfZGF0YVtnbG9iYWxfcG9zaXRpb25dWyduZXdfcXR0eSddID0gc2VsZi5oYXNoX21hcC5nZXQoJ25ld19xdHR5JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX2RvY19kYXRhJywgZG9jX2RhdGEsIHRvX2pzb249VHJ1ZSkKCiAgICAgICAgaWYgYWN0aW9uID09ICduZXh0JzoKICAgICAgICAgICAgcG9zID0gZ2xvYmFsX3Bvc2l0aW9uICsgMSBpZiBnbG9iYWxfcG9zaXRpb24gPCBkb2Nfcm93cyBlbHNlIDEKICAgICAgICBlbGlmIGFjdGlvbiA9PSAncHJldmlvdXMnOgogICAgICAgICAgICBwb3MgPSBnbG9iYWxfcG9zaXRpb24gLSAxIGlmIGdsb2JhbF9wb3NpdGlvbiA+IDEgZWxzZSBkb2Nfcm93cwogICAgICAgIGVsaWYgYWN0aW9uID09ICdpbmRleCcgYW5kIGluZGV4OgogICAgICAgICAgICBwb3MgPSBpbmRleAoKICAgICAgICBjdXJyZW50X3N0ciA9IHBvcwogICAgICAgIGN1cnJlbnRfZWxlbSA9IGRvY19kYXRhW3Bvc10KCiAgICAgICAgIyDRgtC10LrRg9GJ0LjQuSDRjdC70LXQvNC10L3RgiDQvdC1INC90LDQudC00LXQvSDQuNC70Lgg0Y3RgtC+INC30LDQs9C+0LvQvtCy0L7QuiDRgtCw0LHQu9C40YbRiwogICAgICAgIGlmIGN1cnJlbnRfZWxlbSBpcyBOb25lIG9yICdnb29kX25hbWUnIG5vdCBpbiBjdXJyZW50X2VsZW06CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KHNlbGYuaGFzaF9tYXBbJ2RvY190eXBlJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19uJ10sIHNlbGYuaGFzaF9tYXBbJ2RvY19kYXRlJ10pCgogICAgICAgIHF0dHkgPSBjdXJyZW50X2VsZW1bJ2RfcXR0eSddCiAgICAgICAgcXR0eSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShzZWxmLl9nZXRfZmxvYXRfdmFsdWUoc3RyKHF0dHkpKSkKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ0RvY19kYXRhJzogdGl0bGUsCiAgICAgICAgICAgICdHb29kJzogY3VycmVudF9lbGVtWydnb29kX25hbWUnXSwKICAgICAgICAgICAgJ2lkX2dvb2QnOiBjdXJyZW50X2VsZW1bJ2lkX2dvb2QnXSwKICAgICAgICAgICAgJ2lkX3VuaXQnOiBjdXJyZW50X2VsZW1bJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JzogY3VycmVudF9lbGVtWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICdnb29kX2FydCc6IGN1cnJlbnRfZWxlbVsnYXJ0J10sCiAgICAgICAgICAgICdnb29kX3NuJzogY3VycmVudF9lbGVtWydzZXJpZXNfbmFtZSddLAogICAgICAgICAgICAnZ29vZF9wcm9wZXJ0eSc6IGN1cnJlbnRfZWxlbVsncHJvcGVydGllc19uYW1lJ10sCiAgICAgICAgICAgICdnb29kX3ByaWNlJzogY3VycmVudF9lbGVtWydwcmljZSddIGlmICdwcmljZScgaW4gY3VycmVudF9lbGVtIGVsc2UgJycsCiAgICAgICAgICAgICdnb29kX3VuaXQnOiBjdXJyZW50X2VsZW1bJ3VuaXRzX25hbWUnXSwKICAgICAgICAgICAgJ2dvb2Rfc3RyJzogZid7Y3VycmVudF9zdHJ9IC8ge2RvY19yb3dzfScsCiAgICAgICAgICAgICdxdHR5X3BsYW4nOiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSkgaWYgY3VycmVudF9lbGVtWydxdHR5X3BsYW4nXSBlbHNlIDAsCiAgICAgICAgICAgICdnb29kX3BsYW4nOiBjdXJyZW50X2VsZW1bJ3F0dHlfcGxhbiddLAogICAgICAgICAgICAna2V5JzogY3VycmVudF9lbGVtWydpZCddLAogICAgICAgICAgICAncHJpY2UnOiBjdXJyZW50X2VsZW1bJ3ByaWNlJ10gaWYgJ3ByaWNlJyBpbiBjdXJyZW50X2VsZW0gZWxzZSAnJywKICAgICAgICAgICAgJ3ByaWNlX3R5cGUnOiBjdXJyZW50X2VsZW1bJ3ByaWNlX25hbWUnXSBpZiAncHJpY2VfbmFtZScgaW4gY3VycmVudF9lbGVtIGVsc2UgJycsCiAgICAgICAgICAgICdxdHR5JzogcXR0eSwKICAgICAgICAgICAgJ25ld19xdHR5JzogcXR0eSwKICAgICAgICAgICAgJ3VzZV9zZXJpZXMnOiBjdXJyZW50X2VsZW1bJ3VzZV9zZXJpZXMnXQogICAgICAgIH0KCiAgICAgICAgc2VsZi5fZmlsbF9ub25lX3ZhbHVlcygKICAgICAgICAgICAgcHV0X2RhdGEsCiAgICAgICAgICAgICgnZ29vZF9hcnQnLCAnZ29vZF9zbicsICdnb29kX3Byb3BlcnR5JywgJ2dvb2RfcHJpY2UnLCAnZ29vZF9wbGFuJywgJ3ByaWNlJywgJ3ByaWNlX3R5cGUnKSwKICAgICAgICAgICAgZGVmYXVsdD0n0L7RgtGB0YPRgtGB0YLQstGD0LXRgicpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJHb29kc1NlbGVjdFNjcmVlbl9zZWxlY3RlZF9jYXJkX3Bvc2l0aW9uIiwgY3VycmVudF9zdHIpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmVzZXQ9VHJ1ZSkKCiAgICBkZWYgX2hhbmRsZV9mb3VuZF9iYXJjb2RlKHNlbGYsIHJlcywgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIGlkX2dvb2RfYnIsIGlkX3Byb3BlcnR5X2JyLCBpZF91bml0X2JyLCByYXRpbyA9IHJlc1snaWRfZ29vZCddLCByZXNbJ2lkX3Byb3BlcnR5J10sIHJlc1snaWRfdW5pdCddLCBpbnQocmVzWydyYXRpbyddKQoKICAgICAgICBpZiBpZF9nb29kID09IGlkX2dvb2RfYnIgYW5kIGlkX3Byb3BlcnR5ID09IGlkX3Byb3BlcnR5X2JyIGFuZCBpZF91bml0ID09IGlkX3VuaXRfYnI6CiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJhdGlvKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBpZiBpZF9nb29kICE9IGlkX2dvb2RfYnI6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fZG9jX2RhdGEnLCBmcm9tX2pzb249VHJ1ZSkKICAgICAgICAgICAgbWF0Y2hfaW5kZXggPSBzZWxmLl9maW5kX21hdGNoaW5nX2dvb2QodGFibGVfZGF0YSwgaWRfZ29vZF9iciwgaWRfcHJvcGVydHlfYnIsIGlkX3VuaXRfYnIpCgogICAgICAgICAgICBpZiBtYXRjaF9pbmRleCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICMg0YHQvtGF0YDQsNC90LjQvCDQtNCw0L3QvdGL0LUg0Lgg0L7QsdC90L7QstC40Lwg0YHQu9C+0LLQsNGA0Ywg0L/QtdGA0LXQtCDQv9C10YDQtdGF0L7QtNC+0Lwg0L3QsCDQvdC+0LLRg9GOINC/0L7Qt9C40YbQuNGOCiAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX25ld19kZWx0YSgpCiAgICAgICAgICAgICAgICBzZWxmLl9yZWZyZXNoX3F0dHlfaW5fdGFibGUodGFibGVfZGF0YSkKICAgICAgICAgICAgICAgIHNlbGYuX2dvb2RzX3NlbGVjdG9yKCJpbmRleCIsIGluZGV4PW1hdGNoX2luZGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3VzZV9zZXJpZXMnKSA9PSAiMSI6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRfZGVsdGEocmF0aW8pCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgX3JlZnJlc2hfcXR0eV9pbl90YWJsZShzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICBpbmRleCA9IGludChzZWxmLmhhc2hfbWFwLmdldCgnR29vZHNTZWxlY3RTY3JlZW5fc2VsZWN0ZWRfY2FyZF9wb3NpdGlvbicpKQogICAgICAgIHRhYmxlX2RhdGFbaW5kZXhdWydkX3F0dHknXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdxdHR5JykKICAgICAgICB0YWJsZV9kYXRhW2luZGV4XVsnbmV3X3F0dHknXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCduZXdfcXR0eScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0dvb2RzU2VsZWN0U2NyZWVuX2RvY19kYXRhJywgdGFibGVfZGF0YSwgdG9fanNvbj1UcnVlKQoKCmNsYXNzIEdyb3VwU2Nhbkl0ZW1TY3JlZW4oQmFzZUdvb2RTZWxlY3QpOgogICAgc2NyZWVuX25hbWUgPSAn0KLQvtCy0LDRgCDQstGL0LHQvtGAJwogICAgcHJvY2Vzc19uYW1lID0gJ9CT0YDRg9C/0L/QvtCy0LDRjyDQvtCx0YDQsNCx0L7RgtC60LAnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc3RvcF9zeW5jX2RvYycsICcnKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfdXBkYXRlX2RvY190YWJsZV9yb3coc2VsZiwgZGF0YTogRGljdCwgcm93X2lkKToKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ2RfcXR0eSc6IGRhdGFbJ3F0dHknXSwKICAgICAgICB9CiAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLmhhc2hfbWFwLmdldCgnaWRfZG9jJykpCgogICAgICAgIGluc2VydF90b19xdWV1ZSA9IHsKICAgICAgICAgICAgImlkX2RvYyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpZF9kb2MnKSwKICAgICAgICAgICAgImlkX2dvb2QiOiBzZWxmLmhhc2hfbWFwLmdldCgiaWRfZ29vZCIpLAogICAgICAgICAgICAiaWRfcHJvcGVydGllcyI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF9wcm9wZXJ0eSIpLAogICAgICAgICAgICAiaWRfc2VyaWVzIjogc2VsZi5oYXNoX21hcC5nZXQoImlkX3NlcmllcyIpLAogICAgICAgICAgICAiaWRfdW5pdCI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJpZF91bml0IiksCiAgICAgICAgICAgICJpZF9jZWxsIjogIiIsCiAgICAgICAgICAgICJkX3F0dHkiOiBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgnZGVsdGEnKSksCiAgICAgICAgICAgICJzZW50IjogRmFsc2UsCiAgICAgICAgICAgICJwcmljZSI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX3ByaWNlIiksCiAgICAgICAgICAgICJpZF9wcmljZSI6ICIiCiAgICAgICAgfQoKICAgICAgICBiYXJjb2RlX3dvcmtlciA9IEJhcmNvZGVXb3JrZXIoc2VsZi5oYXNoX21hcC5nZXQoImlkX2RvYyIpKQogICAgICAgIGJhcmNvZGVfd29ya2VyLnF1ZXVlX3VwZGF0ZV9kYXRhID0gaW5zZXJ0X3RvX3F1ZXVlCiAgICAgICAgYmFyY29kZV93b3JrZXIudXBkYXRlX2RvY3VtZW50X2JhcmNvZGVfZGF0YSgpCgoKY2xhc3MgQmFyY29kZVJlZ2lzdHJhdGlvblNjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnQmFyY29kZVJlZ2lzdHJhdGlvbicKICAgIHByb2Nlc3NfbmFtZSA9ICdCYXJjb2RlUmVnaXN0cmF0aW9uJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLmdvb2RzX3NlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwWydpdGVtX2lkJ10sCiAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6IHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X2lkJ10gb3IgJycsCiAgICAgICAgICAgICd1bml0X2lkJzogc2VsZi5oYXNoX21hcFsndW5pdF9pZCddIG9yICcnLAogICAgICAgIH0KICAgICAgICBzZWxmLnRpdGxlID0gJ9Cg0LXQs9C40YHRgtGA0LDRhtC40Y8g0YjRgtGA0LjRhdC60L7QtNCwJwoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSBzZWxmLmdvb2RzX3NlcnZpY2UuZ2V0X2l0ZW1fZGF0YV9ieV9jb25kaXRpb24oKipzZWxmLnNjcmVlbl92YWx1ZXMpCiAgICAgICAgaWYgaW5pdF9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RfbmFtZV9iYXJjb2RlJ10gPSBpbml0X2RhdGFbJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9IGluaXRfZGF0YVsncHJvcGVydHknXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gaW5pdF9kYXRhWyd1bml0J10KCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Byb3BlcnR5X3NlbGVjdF9pZCddID0gc2VsZi5zY3JlZW5fdmFsdWVzWydwcm9wZXJ0eV9pZCddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VuaXRfc2VsZWN0X2lkJ10gPSBzZWxmLnNjcmVlbl92YWx1ZXNbJ3VuaXRfaWQnXQoKICAgICAgICAgICAgc2VsZi5fZmlsbF9iYXJjb2Rlc190YWJsZShzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi50aXRsZSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0Jzogc2VsZi5fc2VsZWN0X2l0ZW0sCiAgICAgICAgICAgICd1bml0X3NlbGVjdCc6IHNlbGYuX3NlbGVjdF9pdGVtLAogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0X3N1Y2Nlc3MnOiBsYW1iZGEgOiBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3Byb3BlcnR5X3NlbGVjdCcpLAogICAgICAgICAgICAndW5pdF9zZWxlY3Rfc3VjY2Vzcyc6IGxhbWJkYSA6IHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgndW5pdF9zZWxlY3QnKSwKICAgICAgICAgICAgJ2JhcmNvZGUnOiBzZWxmLl9iYXJjb2RlX3NjYW5uZWQsCiAgICAgICAgICAgICdidG5fb2snOiBzZWxmLl9oYW5kbGVfb2ssCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9maW5pc2hfcHJvY2VzcywKICAgICAgICAgICAgJ0JBQ0tfQlVUVE9OJzogc2VsZi5fZmluaXNoX3Byb2Nlc3MsCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBfc2VsZWN0X2l0ZW0oc2VsZik6CiAgICAgICAgaXRlbV90YWJsZXMgPSB7CiAgICAgICAgICAgICdwcm9wZXJ0eV9zZWxlY3QnOiAnUlNfcHJvcGVydGllcycsCiAgICAgICAgICAgICd1bml0X3NlbGVjdCc6ICdSU191bml0cycsCiAgICAgICAgfQoKICAgICAgICBpdGVtX3R5cGUgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgc2NyZWVuID0gU2VsZWN0SXRlbVNjcmVlbigKICAgICAgICAgICAgc2VsZi5oYXNoX21hcCwKICAgICAgICAgICAgdGFibGVfbmFtZT1pdGVtX3RhYmxlc1tpdGVtX3R5cGVdLAogICAgICAgICAgICByZXN1bHRfbGlzdGVuZXI9Zid7aXRlbV90eXBlfV9zdWNjZXNzJwogICAgICAgICkKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9zZWxlY3RfaXRlbV9yZXN1bHQoc2VsZiwgZmllbGRfbmFtZSk6CiAgICAgICAgc2VsZWN0ZWRfY2FyZCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX2NhcmQ6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSBzZWxlY3RlZF9jYXJkLmdldCgnbmFtZScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZid7ZmllbGRfbmFtZX1faWQnXSA9IHNlbGVjdGVkX2NhcmQuZ2V0KCdpZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFtmaWVsZF9uYW1lXSA9ICcnCgogICAgZGVmIF9iYXJjb2RlX3NjYW5uZWQoc2VsZik6CiAgICAgICAgc2Nhbm5lZF9iYXJjb2RlID0gc2VsZi5oYXNoX21hcC5nZXQoImJhcmNvZGUiKQogICAgICAgIHNlbGYuX2NoZWNrX2JhcmNvZGUoc2Nhbm5lZF9iYXJjb2RlKQoKICAgIGRlZiBfaGFuZGxlX29rKHNlbGYpOgogICAgICAgIHNjYW5uZWRfYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCJzY2FubmVkX2JhcmNvZGUiKQogICAgICAgIGlmIG5vdCBzY2FubmVkX2JhcmNvZGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoItCo0YLRgNC40YXQutC+0LQg0L3QtSDQvtGC0YHQutCw0L3QuNGA0L7QstCw0L0iKQogICAgICAgIGVsaWYgc2VsZi5fY2hlY2tfYmFyY29kZShzY2FubmVkX2JhcmNvZGUpOgogICAgICAgICAgICBpdGVtX2lkID0gc2VsZi5oYXNoX21hcC5nZXQoIml0ZW1faWQiKQogICAgICAgICAgICBiYXJjb2RlX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAiaWRfZ29vZCI6IGl0ZW1faWQsCiAgICAgICAgICAgICAgICAiYmFyY29kZSI6IHNjYW5uZWRfYmFyY29kZSwKICAgICAgICAgICAgICAgICJpZF9wcm9wZXJ0eSI6IHNlbGYuaGFzaF9tYXAuZ2V0KCJwcm9wZXJ0eV9zZWxlY3RfaWQiKSBvciAnJywKICAgICAgICAgICAgICAgICJpZF91bml0Ijogc2VsZi5oYXNoX21hcC5nZXQoInVuaXRfc2VsZWN0X2lkIikgb3IgJycsCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYuX3NhdmVfYmFyY29kZShiYXJjb2RlX2RhdGEpCiAgICAgICAgICAgIHNlbGYuX2ZpbGxfYmFyY29kZXNfdGFibGUoaXRlbV9pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9zYXZlX2JhcmNvZGUoc2VsZiwgYmFyY29kZV9kYXRhKToKICAgICAgICBzZWxmLnNlcnZpY2UuYWRkX2JhcmNvZGUoYmFyY29kZV9kYXRhKQoKICAgICAgICBidWZmZXIgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgYnVmZmVyLnNhdmVfZGF0YV90b19zZW5kKGJhcmNvZGVfZGF0YSwgcGs9J2JhcmNvZGUnKQoKICAgIGRlZiBfY2hlY2tfYmFyY29kZShzZWxmLCBiYXJjb2RlKToKICAgICAgICBiYXJjb2RlX2RhdGEgPSBzZWxmLmdvb2RzX3NlcnZpY2UuZ2V0X3ZhbHVlc19mcm9tX2JhcmNvZGUoImJhcmNvZGUiLCBiYXJjb2RlKQoKICAgICAgICBpZiBiYXJjb2RlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoZifQqNGC0YDQuNGF0LrQvtC0IHtiYXJjb2RlfSDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIg0LIg0LHQsNC30LUg0LTQsNC90L3Ri9GFJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnc2Nhbm5lZF9iYXJjb2RlJ10gPSAnJwogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzY2FubmVkX2JhcmNvZGUnXSA9IGJhcmNvZGUKCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX2ZpbGxfYmFyY29kZXNfdGFibGUoc2VsZiwgaXRlbV9pZCk6CiAgICAgICAgIyBiYXJjb2Rlc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9iYXJjb2Rlc19ieV9nb29kc19pZChzZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKICAgICAgICBiYXJjb2Rlc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9iYXJjb2Rlc19ieV9nb29kc19pZChpdGVtX2lkKQogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEoYmFyY29kZXNfZGF0YSkKICAgICAgICBzZWxmLmhhc2hfbWFwWydiYXJjb2Rlc19kYXRhJ10gPSBzZWxmLl9nZXRfYmFyY29kZXNfdGFibGVfdmlldyh0YWJsZV9kYXRhKS50b19qc29uKCkKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBiYXJjb2Rlc19kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW10KICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZCh7J19sYXlvdXQnOiBzZWxmLl9nZXRfdGFibGVfaGVhZGVyKCl9KSAjINGI0LDQv9C60LAKICAgICAgICBmb3Igcm93IGluIGJhcmNvZGVzX2RhdGE6CiAgICAgICAgICAgICMgcm93WydfbGF5b3V0J10gPSBzZWxmLl9nZXRfZG9jX3RhYmxlX3Jvd192aWV3KCkg0L/RgNC+0LHQu9C10LzQsCDQv9GA0L7QuNC30LLQvtC00LjRgtC10LvRjNC90L7RgdGC0LgKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocm93KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3RhYmxlX2hlYWRlcihzZWxmKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQqNGC0YDQuNGF0LrQvtC0JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQsCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cj0L/QsNC60L7QstC60LAnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApCgogICAgZGVmIF9nZXRfYmFyY29kZXNfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGJhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRCb2xkID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0eScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICB0YWJsZWRhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEdvb2RzIHNlbGVjdCBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kcyhQcm9jZXNzKSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgR29vZHNMaXN0U2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6JwogICAgcHJvY2Vzc19uYW1lID0gJ9Ci0L7QstCw0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKSAtPiBOb25lOgogICAgICAgIGNhcmRzX2RhdGEgPSBzZWxmLl9nZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9nb29kc190eXBlJykpCiAgICAgICAgZ29vZHNfY2FyZHMgPSBzZWxmLl9nZXRfZ29vZHNfY2FyZHNfdmlldyhjYXJkc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RzX2NhcmRzJ10gPSBnb29kc19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gIiIKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBzY3JlZW5fdmFsdWVzID0geydpdGVtX2lkJzogc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXX0KICAgICAgICAgICAgSXRlbUNhcmQoc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykuc2hvdyhhcmdzPXNjcmVlbl92YWx1ZXMpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAic2VsZWN0X2dvb2RzX3R5cGUiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCLQktGL0LHQvtGAINC60LDRgtC10LPQvtGA0LjQuCDRgtC+0LLQsNGA0L7QsiIpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5faWRlbnRpZnlfYmFyY29kZV9nb29kcygpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9nZXRfZ29vZHNfbGlzdF9kYXRhKHNlbGYsIHNlbGVjdGVkX2dvb2RfdHlwZT1Ob25lKSAtPiBsaXN0OgogICAgICAgIHJlc3VsdHMgPSBzZWxmLnNlcnZpY2UuZ2V0X2dvb2RzX2xpc3RfZGF0YShzZWxlY3RlZF9nb29kX3R5cGUpCiAgICAgICAgY2FyZHNfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiByZXN1bHRzOgogICAgICAgICAgICBzaW5nbGVfY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWQnXSwKICAgICAgICAgICAgICAgICdjb2RlJzogcmVjb3JkWydjb2RlJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IHJlY29yZFsnbmFtZSddLAogICAgICAgICAgICAgICAgJ2FydCc6IHJlY29yZFsnYXJ0J10gaWYgcmVjb3JkWydhcnQnXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgJ3VuaXQnOiByZWNvcmRbJ3VuaXQnXSBpZiByZWNvcmRbJ3VuaXQnXSBlbHNlICLigJQiLAogICAgICAgICAgICAgICAgJ3R5cGVfZ29vZCc6IHJlY29yZFsndHlwZV9nb29kJ10sCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiByZWNvcmRbJ2Rlc2NyaXB0aW9uJ10gaWYgcmVjb3JkWydkZXNjcmlwdGlvbiddIGVsc2UgIuKAlCIKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXJkc19kYXRhLmFwcGVuZChzaW5nbGVfY2FyZF9kYXRhKQoKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2dvb2RzX2NhcmRzX3ZpZXcoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpCgogICAgICAgIGdvb2RzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyM3QTAwNUMnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNvZGUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BhcnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B1bml0JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdHlwZV9nb29kJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1jYXJkc19kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZ29vZHNfY2FyZHMKCiAgICBkZWYgX2lkZW50aWZ5X2JhcmNvZGVfZ29vZHMoc2VsZik6CiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKToKICAgICAgICAgICAgYmFyY29kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYXJjb2RlJykKICAgICAgICAgICAgdmFsdWVzID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfZnJvbV9iYXJjb2RlKCJiYXJjb2RlIiwgYmFyY29kZSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnaXRlbV9pZCddID0gdmFsdWVzWzBdWydpZF9nb29kJ10KICAgICAgICAgICAgICAgIEl0ZW1DYXJkKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3coKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi50b2FzdCgn0KLQvtCy0LDRgCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSDQv9C+INGI0YLRgNC40YXQutC+0LTRgycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQoKCmNsYXNzIFNlbGVjdEdvb2RzVHlwZShTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JLRi9Cx0L7RgCDQutCw0YLQtdCz0L7RgNC40Lgg0YLQvtCy0LDRgNC+0LInCiAgICBwcm9jZXNzX25hbWUgPSAn0KLQvtCy0LDRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IEdvb2RzU2VydmljZSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGdvb2RzX3R5cGVzX2RhdGEgPSBzZWxmLl9nZXRfZ29vZHNfdHlwZXNfZGF0YSgpCiAgICAgICAgZ29vZHNfdHlwZXNfY2FyZHMgPSBzZWxmLl9nZXRfZ29vZHNfdHlwZXNfY2FyZHNfdmlldyhnb29kc190eXBlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2dvb2RzX3R5cGVzX2NhcmRzJ10gPSBnb29kc190eXBlc19jYXJkcy50b19qc29uKCkKICAgICAgICBzZWxmLmhhc2hfbWFwWydyZXR1cm5fc2VsZWN0ZWRfZGF0YSddID0gIiIKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCiAgICAgICAgaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9kYXRhIiwgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIHR5cGVfaWQgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgICAgIHR5cGVfbmFtZSA9IGNhcmRfZGF0YVsnbmFtZSddCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RfZ29vZHNfdHlwZScsIHR5cGVfbmFtZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2dvb2RzX3R5cGUnLCB0eXBlX2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQotC+0LLQsNGA0Ysg0YHQv9C40YHQvtC6IikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0X2dvb2RzX3R5cGUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2dvb2RzX3R5cGUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkJhY2tTY3JlZW4iLCAiIikKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9nZXRfZ29vZHNfdHlwZXNfZGF0YShzZWxmKToKICAgICAgICBnb29kc190eXBlc19kYXRhX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfYWxsX2dvb2RzX3R5cGVzX2RhdGEoKQogICAgICAgIGdvb2RzX3R5cGVzX2RhdGEgPSBbXQogICAgICAgIGZvciByZWNvcmQgaW4gZ29vZHNfdHlwZXNfZGF0YV9yZXN1bHQ6CiAgICAgICAgICAgIHNpbmdsZV9jYXJkX2RhdGEgPSB7CiAgICAgICAgICAgICAgICAna2V5JzogcmVjb3JkWydpZCddLAogICAgICAgICAgICAgICAgJ25hbWUnOiByZWNvcmRbJ25hbWUnXSwKICAgICAgICAgICAgfQogICAgICAgICAgICBnb29kc190eXBlc19kYXRhLmFwcGVuZChzaW5nbGVfY2FyZF9kYXRhKQogICAgICAgIHJldHVybiBnb29kc190eXBlc19kYXRhCgogICAgZGVmIF9nZXRfZ29vZHNfdHlwZXNfY2FyZHNfdmlldyhzZWxmLCBnb29kc190eXBlc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCgogICAgICAgIHR5cGVfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J3ZlcnRpY2FsJywKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1nb29kc190eXBlc19kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdHlwZV9jYXJkcwoKCmNsYXNzIEl0ZW1DYXJkKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQmtCw0YDRgtC+0YfQutCwINGC0L7QstCw0YDQsCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQotC+0LLQsNGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnaXRlbV9pZCc6IHNlbGYuaGFzaF9tYXBbJ2l0ZW1faWQnXSwKICAgICAgICB9CiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgICAgICAnQ2FyZHNDbGljayc6IHNlbGYuX3ByaW50X3RpY2tldCwKICAgICAgICAgICAgJ2J0bl9wcmludCc6IHNlbGYuX3ByaW50X3RpY2tldCwKICAgICAgICAgICAgJ3RvX3ByaWNlcyc6IHNlbGYuX3RvX3ByaWNlcywKICAgICAgICAgICAgJ3RvX2JhbGFuY2VzJzogc2VsZi5fdG9fYmFsYW5jZXMsCiAgICAgICAgICAgICdidG5faXRlbV9nb29kX2JhcmNvZGUnOiBzZWxmLl9oYW5kbGVfYmFyY29kZV9yZWdpc3RlciwKCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fcHJvcGVydGllcyA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2Zyb21fYmFyY29kZSgiaWRfZ29vZCIsIHNlbGYuc2NyZWVuX3ZhbHVlc1snaXRlbV9pZCddKQoKICAgICAgICBpZiBpdGVtX3Byb3BlcnRpZXM6CiAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzX2RhdGEgPSBzZWxmLl9nZXRfdmFyaWFudHNfY2FyZHNfZGF0YShpdGVtX3Byb3BlcnRpZXMpCiAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzID0gc2VsZi5fZ2V0X3ZhcmlhbnRzX2NhcmRzX3ZpZXcodmFyaWFudHNfY2FyZHNfZGF0YSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnYmFyY29kZV9jYXJkcyddID0gdmFyaWFudHNfY2FyZHMudG9fanNvbigpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJsb2FkX2luZm8iLCAiIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgibG9hZF9pbmZvIiwgItCU0LDQvdC90YvQtSDQviDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQutCw0YUg0L7RgtGB0YPRgtGB0YLQstGD0Y7RgiIpCgoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzdXBlcigpLmluaXRfc2NyZWVuKCkKCiAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9pdGVtX2RhdGFfYnlfaWQoaXRlbV9pZD1zZWxmLnNjcmVlbl92YWx1ZXNbJ2l0ZW1faWQnXSkKICAgICAgICBpZiBpdGVtX2RhdGE6CiAgICAgICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAgICAgImdvb2RfbmFtZSI6IGl0ZW1fZGF0YVsnbmFtZSddLAogICAgICAgICAgICAgICAgImdvb2RfYXJ0IjogaXRlbV9kYXRhWydhcnQnXSBpZiBpdGVtX2RhdGFbJ2FydCddIGVsc2UgIuKAlCIsCiAgICAgICAgICAgICAgICAiZ29vZF9jb2RlIjogaXRlbV9kYXRhWydjb2RlJ10sCiAgICAgICAgICAgICAgICAiZ29vZF9kZXNjciI6IGl0ZW1fZGF0YVsnZGVzY3JpcHRpb24nXSBpZiBpdGVtX2RhdGFbJ2Rlc2NyaXB0aW9uJ10gZWxzZSAi4oCUIiwKICAgICAgICAgICAgICAgICJnb29kX3R5cGUiOiBpdGVtX2RhdGFbJ3R5cGVfZ29vZCddLAogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEocHV0X2RhdGEpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLl9jbGVhcl9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnYmFyY29kZV9jYXJkcycpCiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbihzZWxmLmhhc2hfbWFwWydwYXJlbnRfc2NyZWVuJ10pCgogICAgZGVmIF90b19iYWxhbmNlcyhzZWxmKToKICAgICAgICBkaWN0X2RhdGEgPSB7CiAgICAgICAgICAgICdpbnB1dF9pdGVtX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1faWQnKSwKICAgICAgICAgICAgJ2l0ZW1fYXJ0X2lucHV0Jzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JyksCiAgICAgICAgICAgICdzZWxlY3RlZF9vYmplY3RfbmFtZSc6IGYne3NlbGYuaGFzaF9tYXAuZ2V0KCJnb29kX25hbWUiKX0sIHtzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9jb2RlIil9JywKICAgICAgICAgICAgJ29iamVjdF9uYW1lJzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfbmFtZScpLAogICAgICAgICAgICAicmV0dXJuX3RvX2l0ZW1fY2FyZCI6ICJ0cnVlIiwKICAgICAgICAgICAgJ1Nob3dQcm9jZXNzUmVzdWx0JzogJ9Ce0YHRgtCw0YLQutC4fNCf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCcsCiAgICAgICAgICAgICJub1JlZnJlc2giOiAnJwogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX3RvX3ByaWNlcyhzZWxmKToKICAgICAgICBkaWN0X2RhdGEgPSB7CiAgICAgICAgICAgICdpbnB1dF9nb29kX2lkJzogc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1faWQnKSwKICAgICAgICAgICAgJ2lucHV0X2dvb2RfYXJ0Jzogc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JyksCiAgICAgICAgICAgICdwcmljZXNfb2JqZWN0X25hbWUnOiBmJ3tzZWxmLmhhc2hfbWFwLmdldCgiZ29vZF9uYW1lIil9LCB7c2VsZi5oYXNoX21hcC5nZXQoImdvb2RfY29kZSIpfScsCiAgICAgICAgICAgICJyZXR1cm5fdG9faXRlbV9jYXJkIjogInRydWUiLAogICAgICAgICAgICAnb2JqZWN0X25hbWUnOiBzZWxmLmhhc2hfbWFwLmdldCgnZ29vZF9uYW1lJyksCiAgICAgICAgICAgICdTaG93UHJvY2Vzc1Jlc3VsdCc6ICfQptC10L3Ri3zQn9GA0L7QstC10YDQutCwINGG0LXQvScsCiAgICAgICAgICAgICJub1JlZnJlc2giOiAnJwogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX2hhbmRsZV9iYXJjb2RlX3JlZ2lzdGVyKHNlbGYpOgogICAgICAgIGluaXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2l0ZW1faWQnOiBzZWxmLmhhc2hfbWFwLmdldCgnaXRlbV9pZCcpLAogICAgICAgICAgICAncHJvcGVydHlfaWQnOiAnJywKICAgICAgICAgICAgJ3VuaXRfaWQnOiAnJwogICAgICAgIH0KICAgICAgICBCYXJjb2RlUmVnaXN0cmF0aW9uU2NyZWVuKHNlbGYuaGFzaF9tYXAsIHNlbGYucnNfc2V0dGluZ3MpLnNob3dfcHJvY2Vzc19yZXN1bHQoaW5pdF9kYXRhKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3ZhcmlhbnRzX2NhcmRzX2RhdGEoaXRlbV9wcm9wZXJ0aWVzKToKICAgICAgICB2YXJpYW50c19jYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgaSwgZWxlbWVudCBpbiBlbnVtZXJhdGUoaXRlbV9wcm9wZXJ0aWVzKToKICAgICAgICAgICAgdmFyaWFudHNfY2FyZHNfZGF0YS5hcHBlbmQoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImtleSI6IHN0cihpKSwKICAgICAgICAgICAgICAgICAgICAiYmFyY29kZSI6IGVsZW1lbnRbJ2JhcmNvZGUnXSwKICAgICAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6IGVsZW1lbnRbJ3Byb3BlcnR5J10gaWYgZWxlbWVudFsncHJvcGVydHknXSBlbHNlICIiLAogICAgICAgICAgICAgICAgICAgICJ1bml0IjogZWxlbWVudFsndW5pdCddLAogICAgICAgICAgICAgICAgICAgICJzZXJpZXMiOiBlbGVtZW50WydzZXJpZXMnXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgcmV0dXJuIHZhcmlhbnRzX2NhcmRzX2RhdGEKCiAgICBkZWYgX2dldF92YXJpYW50c19jYXJkc192aWV3KHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZScpIGVsc2UgMjAKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKSBpZiBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykgZWxzZSAxNQoKICAgICAgICB2YXJpYW50c19jYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0Bwcm9wZXJ0aWVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHVuaXQnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGJhcmNvZGUnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzZXJpZXMnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gdmFyaWFudHNfY2FyZHMKCiAgICBkZWYgX3ByaW50X3RpY2tldChzZWxmKToKICAgICAgICBjdXJyZW50X2NhcmQgPSBzZWxmLl9nZXRfc2VsZWN0ZWRfY2FyZF9kYXRhKCkKCiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBjdXJyZW50X2NhcmQuZ2V0KCdiYXJjb2RlJywgJzAwMDAwMDAwMDAwMDAnKSwKICAgICAgICAgICAgJ9Cd0L7QvNC10L3QutC70LDRgtGD0YDQsCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdnb29kX25hbWUnKSwKICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiBjdXJyZW50X2NhcmQuZ2V0KCdwcm9wZXJ0aWVzJywgJycpLAogICAgICAgICAgICAn0KPQv9Cw0LrQvtCy0LrQsCc6IGN1cnJlbnRfY2FyZC5nZXQoJ3VuaXQnLCAnJykKICAgICAgICB9CgogICAgICAgIFByaW50U2VydmljZS5wcmludChzZWxmLmhhc2hfbWFwLCBkYXRhKQoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YShzZWxmKSAtPiBkaWN0OgogICAgICAgIHJlc3VsdCA9IHt9CiAgICAgICAgY2FyZF9rZXkgPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9rZXknKQogICAgICAgIGNhcmRzID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiYmFyY29kZV9jYXJkcyIpCgogICAgICAgIGlmIGNhcmRfa2V5IGFuZCBjYXJkczoKICAgICAgICAgICAgcmVzdWx0ID0gY2FyZHNbJ2N1c3RvbWNhcmRzJ11bJ2NhcmRzZGF0YSddW2ludChjYXJkX2tleSldCgogICAgICAgIHJldHVybiByZXN1bHQKCmNsYXNzIEl0ZW1DYXJkT2ZmbGluZVNjcmVlbihJdGVtQ2FyZCk6CgogICAgZGVmIF90b19wcmljZXMoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygncHJpY2VzX25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQt9Cw0L/RgNC+0YEg0YbQtdC9INC90LXQtNC+0YHRgtGD0L/QtdC9JykKCiAgICBkZWYgX3RvX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19kaWFsb2coJ2JhbGFuY2VzX25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQt9Cw0L/RgNC+0YEg0L7RgdGC0LDRgtC60L7QsiDQvdC10LTQvtGB0YLRg9C/0LXQvScpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygncHJpbnRfdGlja2V0X25vdF9hdmFpbGFibGVfbW9kYWwnLCB0aXRsZT0n0JIg0Y3RgtC+0Lwg0L/RgNC+0LTRg9C60YLQtSDQv9C10YfQsNGC0Ywg0L3QtdC00L7RgdGC0YPQv9C90LAnKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHMoUHJvY2VzcykgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBHb29kc0JhbGFuY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc0JhbGFuY2VzSXRlbUNhcmQoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cf0YDQvtCy0LXRgNC40YLRjCDQvtGB0YLQsNGC0LrQuCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQntGB0YLQsNGC0LrQuCcKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQogICAgICAgIHNlbGYuaHNfc2VydmljZSA9IGhzX3NlcnZpY2VzLkhzU2VydmljZShzZWxmLmdldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgc2VsZi50YWJsZV90eXBlID0gJ3dhcmVob3VzZXMnCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF9vYmplY3RfbmFtZScsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfY2VsbF9uYW1lJywKICAgICAgICAgICAgICAgICdzZWxlY3RlZF93aF9uYW1lJywKICAgICAgICAgICAgICAgICdpdGVtX2JhcmNvZGUnCiAgICAgICAgICAgIF0KICAgICAgICApCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdiYWxhbmNlc190YWJsZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfYmFsYW5jZXNfY29udHJvbHMiLCAiMSIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICItMSIpCgogICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ25ld19hcnQnKToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfaXRlbV92YXJpYW50cygpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAnd2hfc2VsZWN0JzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X3doKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICd3aF9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF93aF9yZXN1bHQoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2dldF9iYWxhbmNlX2J0bic6CiAgICAgICAgICAgIHNlbGYuX2dldF9iYWxhbmNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnYmFyY29kZSc6CiAgICAgICAgICAgIHNlbGYuX2lkZW50aWZ5X2JhcmNvZGVfYmFsYW5jZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuX3Jlc2V0X2JhbGFuY2VzX3RhYmxlcygpCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2Vzc1Jlc3VsdCIsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnc2hvd19maWx0ZXJzJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIkNhcmRzQ2xpY2siOgogICAgICAgICAgICBjYXJkX2RhdGEgPSBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2FyZF9kYXRhJywgZnJvbV9qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZiJ7Y2FyZF9kYXRhWyduYW1lJ119LCB7Y2FyZF9kYXRhWydjb2RlJ119IiwKICAgICAgICAgICAgICAgICAgICAiaW5wdXRfaXRlbV9pZCI6IGNhcmRfZGF0YVsnaWQnXSwgJ2l0ZW1fY29kZSc6IGNhcmRfZGF0YVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICd2YXJpYW50X3NlbGVjdGVkJzogVHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKCduZXdfYXJ0JykKICAgICAgICBlbGlmIHNlbGYuX2lzX3Jlc3VsdF9wb3NpdGl2ZSgn0JLRi9Cx0LXRgNC40YLQtSDQstCw0YDQuNCw0L3RgiDRgtC+0LLQsNGA0LA6Jyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9iYWxhbmNlc19jb250cm9scyIsICIxIikKCiAgICBkZWYgX2dldF9iYWxhbmNlcyhzZWxmKToKICAgICAgICBpZiAoc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykgIT0gc2VsZi5oYXNoX21hcC5nZXQoJ2dvb2RfYXJ0JykKICAgICAgICAgICAgYW5kIG5vdCBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCd2YXJpYW50X3NlbGVjdGVkJykpOgoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ25ld19hcnQnLCBUcnVlKQogICAgICAgICAgICBzZWxmLnZhbGlkYXRlX2lucHV0KCkKCiAgICAgICAgcmF3X2JhbGFuY2VzX2RhdGEgPSBzZWxmLl9nZXRfYmFsYW5jZXNfZGF0YSgpCiAgICAgICAgYmFsYW5jZXNfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShyYXdfYmFsYW5jZXNfZGF0YSkKICAgICAgICBiYWxhbmNlc190YWJsZSA9IHNlbGYuX2dldF9iYWxhbmNlc190YWJsZV92aWV3KGJhbGFuY2VzX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoewogICAgICAgICAgICAgICAgJ2JhbGFuY2VzX3RhYmxlJzogYmFsYW5jZXNfdGFibGUudG9fanNvbigpLAogICAgICAgICAgICAgICAgJ1Nob3dfZ2V0X2JhbGFuY2VzX2NvbnRyb2xzJzogJy0xJywKICAgICAgICAgICAgICAgICdTaG93X3Nob3dfZmlsdGVycyc6ICcxJywKICAgICAgICAgICAgICAgICdwcm9wZXJ0eV9pZCc6ICcnLAogICAgICAgICAgICAgICAgJ2Zyb21fYmFyY29kZSc6IEZhbHNlLAogICAgICAgICAgICAgICAgJ2l0ZW1fY29kZSc6ICcnLAogICAgICAgICAgICAgICAgJ3ZhcmlhbnRfc2VsZWN0ZWQnOiBGYWxzZQogICAgICAgICAgICB9KQoKICAgIGRlZiBfc2VsZWN0X3doKHNlbGYpOgogICAgICAgIFNlbGVjdEl0ZW1TY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX3dhcmVob3VzZXMnLAogICAgICAgICAgICByZXN1bHRfbGlzdGVuZXI9J3doX3NlbGVjdF9zdWNjZXNzJywKICAgICAgICAgICAgdGl0bGU9J9CS0YvQsdC10YDQuNGC0LUg0YHQutC70LDQtCcKICAgICAgICApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X3doX3Jlc3VsdChzZWxmKToKICAgICAgICBzZWxlY3RlZF93aCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3NlbGVjdGVkX2NhcmQnKQogICAgICAgIGlmIHNlbGVjdGVkX3doOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd3aF9zZWxlY3QnXSA9IHNlbGVjdGVkX3doLmdldCgnbmFtZScpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnd2hfc2VsZWN0J10gPSAnJwoKICAgIGRlZiB2YWxpZGF0ZV9pbnB1dChzZWxmKToKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KCkKICAgICAgICBzZWxmLl9wcm9jZXNzX2lucHV0X2NlbGwoKQoKICAgICAgICBpZiBub3QgKHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpIG9yIHNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0Jykgb3Igc2VsZi5oYXNoX21hcC5nZXQoJ3doX3NlbGVjdCcpCiAgICAgICAgICAgICAgICBvciBzZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfY2VsbF9pZCcpKToKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoewogICAgICAgICAgICAgICAgICAgICdiYWxhbmNlc190YWJsZXMnOiAnJywKICAgICAgICAgICAgICAgICAgICAnb2JqZWN0X25hbWUnOiAnJywKICAgICAgICAgICAgICAgICAgICAnY2VsbF9uYW1lJzogJycsCiAgICAgICAgICAgICAgICAgICAgJ2Vycm9yX21zZyc6ICLQlNC+0LvQttC10L0g0LHRi9GC0Ywg0LLRi9Cx0YDQsNC9INGB0LrQu9Cw0LQsINGC0L7QstCw0YAg0LjQu9C4INGP0YfQtdC50LrQsCIKICAgICAgICAgICAgICAgIH0pCgogICAgZGVmIF9wcm9jZXNzX2lucHV0X2l0ZW1fYXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0JykKCiAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ2l0ZW1fYXJ0X2lucHV0Jyk6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YSgKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICdvYmplY3RfbmFtZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnbmFtZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnaW5wdXRfaXRlbV9pZCc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnaWQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX29iamVjdF9uYW1lJzogZid7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJuYW1lIl19LCB7aXRlbV92YWx1ZXNfcmVzdWx0WzBdWyJjb2RlIl19JywKICAgICAgICAgICAgICAgICAgICAgICAgJ2l0ZW1fY29kZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICAgICAnZXJyb3JfbXNnJzogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtX2FydF9pbnB1dCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpLAogICAgICAgICAgICAgICAgICAgICAgICAnaXRlbV9iYXJjb2RlJzogJycKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQgIT0gJ+KAlCcgYW5kIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsIGYiINCi0L7QstCw0YAg0YEg0LDRgNGC0LjQutGD0LvQvtC8ICd7aXRlbV9hcnRfaW5wdXR9JyAg0L3QtSDQvdCw0LnQtNC10L0iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdpbnB1dF9pdGVtX2lkJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdvYmplY3RfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCAnJykKCiAgICBkZWYgX3Byb2Nlc3NfaW5wdXRfY2VsbChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgnY2VsbF9pbnB1dCcpOgogICAgICAgICAgICBjZWxsX3ZhbHVlc19yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX2NlbGxzJywKICAgICAgICAgICAgICAgIGZpZWxkPSduYW1lJywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdjZWxsX2lucHV0JykKICAgICAgICAgICAgKQoKICAgICAgICAgICAgaWYgY2VsbF92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgc2VsZi50YWJsZV90eXBlID0gJ2NlbGxzJwogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCBjZWxsX3ZhbHVlc19yZXN1bHRbMF1bJ2lkJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY2VsbF9uYW1lJywgc2VsZi5oYXNoX21hcC5nZXQoJ2NlbGxfaW5wdXQnKSkKCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjdXJyZW50X2Vycm9yID0gZiJ7c2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ119XG4iIGlmIHNlbGYuaGFzaF9tYXBbJ2Vycm9yX21zZyddIGVsc2UgJycKICAgICAgICAgICAgICAgIGVycm9yX3RleHQgPSAne33Qr9GH0LXQudC60LAgYyDQuNC80LXQvdC10Lwge30g0L3QtSDQvdCw0LnQtNC10L3QsCcuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZXJyb3IsIHNlbGYuaGFzaF9tYXBbJ2NlbGxfaW5wdXQnXQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnZXJyb3JfbXNnJ10gPSBlcnJvcl90ZXh0CiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfaWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfbmFtZScsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfY2VsbF9uYW1lJywgJycpCgogICAgZGVmIF9pZGVudGlmeV9iYXJjb2RlX2JhbGFuY2VzKHNlbGYpOgogICAgICAgIG5vX2RhdGEgPSBGYWxzZQogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICB0YWJsZV9uYW1lPSJSU19iYXJjb2RlcyIsCiAgICAgICAgICAgIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKQogICAgICAgICkKCiAgICAgICAgaWYgYmFyY29kZV9kYXRhOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKSkKCiAgICAgICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5Jyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJvcGVydHlfaWQnLCBiYXJjb2RlX2RhdGFbMF0uZ2V0KCdpZF9wcm9wZXJ0eScpKQoKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfZ29vZCcpOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IGJhcmNvZGVfZGF0YVswXVsnaWRfZ29vZCddCgogICAgICAgICAgICAgICAgaXRlbV9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQoCiAgICAgICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfZ29vZHMiLAogICAgICAgICAgICAgICAgICAgIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9aXRlbV9pZAogICAgICAgICAgICAgICAgKQoKICAgICAgICAgICAgICAgIGlmIGl0ZW1fZGF0YVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfaXRlbV9pZCcsIGl0ZW1faWQpCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdWydhcnQnXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2l0ZW1fYXJ0X2lucHV0JywgaXRlbV9kYXRhWzBdWydhcnQnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9hcnRfaW5wdXQnLCAn4oCUJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfb2JqZWN0X25hbWUnLCBmJ3tpdGVtX2RhdGFbMF1bIm5hbWUiXX0sICB7aXRlbV9kYXRhWzBdWyJjb2RlIl19JykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgIiIpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdmcm9tX2JhcmNvZGUnLCBUcnVlKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaXRlbV9iYXJjb2RlJywgJycpCiAgICAgICAgICAgIGNlbGxfZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0iUlNfY2VsbHMiLCBmaWVsZD0nYmFyY29kZScsCiAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpCiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGNlbGxfZGF0YToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9jZWxsX2lkJywgY2VsbF9kYXRhWzBdWydpZCddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX2NlbGxfbmFtZScsIGNlbGxfZGF0YVswXVsnbmFtZSddKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2NlbGxfaW5wdXQnLCBjZWxsX2RhdGFbMF1bJ25hbWUnXSkKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5vX2RhdGEgPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdlcnJvcl9tc2cnLCAi0KjRgtGA0LjRhdC60L7QtCDQvdC1INGA0LDRgdC/0L7Qt9C90LDQvSIpCiAgICAgICAgaWYgbm90IG5vX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2dldF9iYWxhbmNlcygpCgogICAgZGVmIF9yZXNldF9iYWxhbmNlc190YWJsZXMoc2VsZik6CiAgICAgICAgdmFyc19saXN0ID0gWyd3aF9zZWxlY3QnLCAnaW5wdXRfaXRlbV9pZCcsICdjZWxsX2lucHV0JywgJ2NlbGxfbmFtZScsICdvYmplY3RfbmFtZScsICdlcnJvcl9tc2cnLAogICAgICAgICAgICAgICAgICAgICAnYmFsYW5jZXNfdGFibGUnLCAnYmFyY29kZScsICdzZWxlY3RlZF9jZWxsX2lkJywgJ3Byb3BlcnR5X2lkJywgJ3NlbGVjdGVkX29iamVjdF9uYW1lJywKICAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3doX2lkJywgJ2l0ZW1fYmFyY29kZScsICdzZWxlY3RlZF93aF9uYW1lJywgJ3NlbGVjdGVkX2NlbGxfbmFtZSddCiAgICAgICAgZGljdF9kYXRhID0ge3ZhcjogIiIgZm9yIHZhciBpbiB2YXJzX2xpc3R9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShkaWN0X2RhdGEpCgogICAgZGVmIF9zZXRfdmlzaWJpbGl0eV9vbl9zdGFydChzZWxmLCBlbGVtZW50cyk6CiAgICAgICAgZm9yIHYgaW4gZWxlbWVudHM6CiAgICAgICAgICAgIG5hbWUgPSBmJ1Nob3dfe3Z9JwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW25hbWVdID0gJzEnIGlmIHNlbGYuaGFzaF9tYXBbdl0gZWxzZSAnLTEnCgogICAgZGVmIF9nZXRfYmFsYW5jZXNfZGF0YShzZWxmKToKICAgICAgICBkYXRhID0gc2VsZi5oc19zZXJ2aWNlLmdldF9iYWxhbmNlc19nb29kcygKICAgICAgICAgICAgaWRfZ29vZD1zZWxmLmhhc2hfbWFwLmdldCgnaW5wdXRfaXRlbV9pZCcpLAogICAgICAgICAgICBpZF9jZWxsPXNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jZWxsX2lkJyksCiAgICAgICAgICAgIGlkX3dhcmVob3VzZT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfd2hfaWQnKQogICAgICAgICkuZGF0YQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYsIHJhd19iYWxhbmNlc19kYXRhKToKICAgICAgICB0YWJsZV9kYXRhID0gW3t9XQogICAgICAgIGZvciBlbCBpbiByYXdfYmFsYW5jZXNfZGF0YToKICAgICAgICAgICAgc3RvcmFnZV9uYW1lID0gc3RyKGVsWyduYW1lX3dhcmVob3VzZSddKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc3RyKGVsWyduYW1lX2NlbGwnXSkKCiAgICAgICAgICAgIGl0ZW1fbGF5b3V0ID0gc2VsZi5fZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoewogICAgICAgICAgICAgICAgJ3N0b3JhZ2VfbmFtZV9sZW4nOiBsZW4oc3RvcmFnZV9uYW1lKSwKICAgICAgICAgICAgICAgICdpdGVtX25hbWVfbGVuJzogbGVuKGVsWyduYW1lX2dvb2QnXSkKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIHRhYmxlX3JvdyA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBzdHIoZWxbJ2lkX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnaXRlbV9uYW1lJzogc3RyKGVsWyduYW1lX2dvb2QnXSksCiAgICAgICAgICAgICAgICAnc3RvcmFnZV9uYW1lJzogc3RvcmFnZV9uYW1lLAogICAgICAgICAgICAgICAgJ3F0dHknOiBzdHIoZWxbJ3F0dHknXSksCiAgICAgICAgICAgICAgICAncHJvcGVydGllcyc6IHN0cihlbFsnbmFtZV9wcm9wZXJ0eSddIG9yICfigJQnKSwKICAgICAgICAgICAgICAgICdfbGF5b3V0JzogaXRlbV9sYXlvdXQKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgc2VsZi5oYXNoX21hcC5nZXQoJ3Byb3BlcnR5X2lkJyk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldCgncHJvcGVydHlfaWQnKSA9PSBzdHIoZWxbJ2lkX3Byb3BlcnR5J10pOgogICAgICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9iYWxhbmNlc190YWJsZV92aWV3KHNlbGYsIGRhdGEpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0LrQu9Cw0LQnKSBpZiBzZWxmLnRhYmxlX3R5cGUgPT0gJ3dhcmVob3VzZXMnIGVsc2Ugc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC+0LLQsNGAJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQmtC+0LvQuNGH0LXRgdGC0LLQvicpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KXQsNGA0LDQutGC0LXRgNC40YHRgtC40LrQuCcpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnCiAgICAgICAgICAgICksCgogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT1kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2l0ZW1fdGFibGVfcm93X3ZpZXcoc2VsZiwgcm93X2RhdGEpOgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHN0b3JhZ2VfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J3dyYXBfY29udGVudCcKCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JyBpZiByb3dfZGF0YVsnc3RvcmFnZV9uYW1lX2xlbiddIDwgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSBlbHNlICd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGl0ZW1fbmFtZScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcgaWYgcm93X2RhdGFbJ2l0ZW1fbmFtZV9sZW4nXSA8IHJvd19kYXRhWydzdG9yYWdlX25hbWVfbGVuJ10gZWxzZSAnd3JhcF9jb250ZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BxdHR5JywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByb3BlcnRpZXMnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRjBGOEZGJywKICAgICAgICApCgogICAgICAgIHJldHVybiByb3dfdmlldwoKICAgIGRlZiBfY2hlY2tfaXRlbV92YXJpYW50cyhzZWxmKToKICAgICAgICBpdGVtX2FydF9pbnB1dCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdpdGVtX2FydF9pbnB1dCcpCiAgICAgICAgaWYgaXRlbV9hcnRfaW5wdXQ6CiAgICAgICAgICAgIGl0ZW1fdmFsdWVzX3Jlc3VsdCA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKAogICAgICAgICAgICAgICAgdGFibGVfbmFtZT0nUlNfZ29vZHMnLCBmaWVsZD0nYXJ0JywKICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0CiAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIGl0ZW1fdmFsdWVzX3Jlc3VsdDoKICAgICAgICAgICAgICAgIGlmIGxlbihpdGVtX3ZhbHVlc19yZXN1bHQpID4gMToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncmV0dXJuX3NlbGVjdGVkX2RhdGEnLCAnJykKICAgICAgICAgICAgICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAnQ2FyZFRpdGxlVGV4dFNpemUnKSBlbHNlIDE4CgogICAgICAgICAgICAgICAgICAgIHZhcmlhbnRzX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG5hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMDAwMDAwJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKSksCiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgY2FyZHNkYXRhPWl0ZW1fdmFsdWVzX3Jlc3VsdAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydpdGVtX3ZhcmlhbnRzJ10gPSB2YXJpYW50c19jYXJkcy50b19qc29uKCkKCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXI9J9CS0YvQsdC10YDQuNGC0LUg0LLQsNGA0LjQsNC90YIg0YLQvtCy0LDRgNCwOicsCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM9WyfQktGL0LHRgNCw0YLRjCcsICfQntGC0LzQtdC90LAnXQogICAgICAgICAgICAgICAgICAgICkKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBHb29kc0JhbGFuY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IEdvb2RzUHJpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHb29kc1ByaWNlc0l0ZW1DYXJkKEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQn9GA0L7QstC10YDQutCwINGG0LXQvScKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5fc2V0X3Zpc2liaWxpdHlfb25fc3RhcnQoCiAgICAgICAgICAgIFsncHJpY2VzX2Vycm9yX21zZycsICdwcmljZXNfb2JqZWN0X25hbWUnLCAnc2VsZWN0ZWRfcHJpY2VfdHlwZV9uYW1lJywKICAgICAgICAgICAgJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnc2VsZWN0ZWRfdW5pdF9uYW1lJywgJ2JhcmNvZGVfaW5mbyddKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3ByaWNlc190YWJsZScpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKCiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICdwcmljZV90eXBlX3NlbGVjdCc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdwcm9wZXJ0eV9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndW5pdF9zZWxlY3QnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbSgpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAncHJpY2VfdHlwZV9zZWxlY3Rfc3VjY2Vzcyc6CiAgICAgICAgICAgIHNlbGYuX3NlbGVjdF9pdGVtX3Jlc3VsdCgncHJpY2VfdHlwZV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Byb3BlcnR5X3NlbGVjdF9zdWNjZXNzJzoKICAgICAgICAgICAgc2VsZi5fc2VsZWN0X2l0ZW1fcmVzdWx0KCdwcm9wZXJ0eV9zZWxlY3QnKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3VuaXRfc2VsZWN0X3N1Y2Nlc3MnOgogICAgICAgICAgICBzZWxmLl9zZWxlY3RfaXRlbV9yZXN1bHQoJ3VuaXRfc2VsZWN0JykKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdnZXRfcHJpY2VzX2J0bic6CiAgICAgICAgICAgIHNlbGYuX2dldF9wcmljZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2JhcmNvZGUnOgogICAgICAgICAgICBzZWxmLl9pZGVudGlmeV9iYXJjb2RlX3ByaWNlcygpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5fcmVzZXRfcHJpY2VzX3RhYmxlcygpCiAgICAgICAgICAgIGlmIHNlbGYuaGFzaF9tYXAuZ2V0KCdyZXR1cm5fdG9faXRlbV9jYXJkJyk6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnbm9SZWZyZXNoJywgJycpCiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiRmluaXNoUHJvY2Vzc1Jlc3VsdCIsICIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIkZpbmlzaFByb2Nlc3MiLCAiIikKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdzaG93X2ZpbHRlcnMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19nZXRfcHJpY2VzX2NvbnRyb2xzIiwgIjEiKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd19zaG93X2ZpbHRlcnMiLCAiLTEiKQoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NlbGVjdF9pdGVtKHNlbGYpOgogICAgICAgIGl0ZW1fdGFibGVzID0gewogICAgICAgICAgICAncHJpY2VfdHlwZV9zZWxlY3QnOiAnUlNfcHJpY2VfdHlwZXMnLAogICAgICAgICAgICAncHJvcGVydHlfc2VsZWN0JzogJ1JTX3Byb3BlcnRpZXMnLAogICAgICAgICAgICAndW5pdF9zZWxlY3QnOiAnUlNfdW5pdHMnLAogICAgICAgIH0KICAgICAgICBpdGVtX3R5cGUgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIFNlbGVjdEl0ZW1TY3JlZW4oCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAsCiAgICAgICAgICAgIHRhYmxlX25hbWU9aXRlbV90YWJsZXNbaXRlbV90eXBlXSwKICAgICAgICAgICAgcmVzdWx0X2xpc3RlbmVyPWYne2l0ZW1fdHlwZX1fc3VjY2VzcycKICAgICAgICApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2l0ZW1fcmVzdWx0KHNlbGYsIGZpZWxkX25hbWUpOgogICAgICAgIHNlbGVjdGVkX2NhcmQgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jYXJkOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwW2ZpZWxkX25hbWVdID0gc2VsZWN0ZWRfY2FyZC5nZXQoJ25hbWUnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbZmllbGRfbmFtZV0gPSAnJwoKICAgIGRlZiBfZ2V0X3ByaWNlcyhzZWxmKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgcmF3X3ByaWNlc19kYXRhID0gc2VsZi5fZ2V0X3ByaWNlc19kYXRhKCkKICAgICAgICBwcmljZXNfZGF0YSA9IHNlbGYuX3ByZXBhcmVfdGFibGVfZGF0YShyYXdfcHJpY2VzX2RhdGEpCiAgICAgICAgcHJpY2VzX3RhYmxlID0gc2VsZi5fZ2V0X3ByaWNlc190YWJsZV92aWV3KHByaWNlc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfdGFibGUnLCBwcmljZXNfdGFibGUudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2dldF9wcmljZXNfY29udHJvbHMiLCAiLTEiKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X3Nob3dfZmlsdGVycyIsICIxIikKCiAgICBkZWYgX3ZhbGlkYXRlX2lucHV0KHNlbGYpOgogICAgICAgIHNlbGYuX3Byb2Nlc3NfaW5wdXRfZ29vZF9hcnQoKQogICAgICAgIGlmIG5vdCAoc2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfYXJ0JykpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX3RhYmxlcycsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgJycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwcmljZXNfZXJyb3JfbXNnJywgItCU0L7Qu9C20LXQvSDQsdGL0YLRjCDQstGL0LHRgNCw0L0g0YLQvtCy0LDRgCIpCgogICAgZGVmIF9wcm9jZXNzX2lucHV0X2dvb2RfYXJ0KHNlbGYpOgogICAgICAgIGl0ZW1fYXJ0X2lucHV0ID0gc2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfYXJ0JykKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2lucHV0X2dvb2RfaWQnOiAnJywKICAgICAgICAgICAgJ3ByaWNlc19vYmplY3RfbmFtZSc6ICcnLAogICAgICAgICAgICAnZXJyb3JfbXNnJzogJycKICAgICAgICB9CgogICAgICAgIGlmIGl0ZW1fYXJ0X2lucHV0OgogICAgICAgICAgICBpdGVtX3ZhbHVlc19yZXN1bHQgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9J1JTX2dvb2RzJywgZmllbGQ9J2FydCcsIGZpZWxkX3ZhbHVlPWl0ZW1fYXJ0X2lucHV0KQoKICAgICAgICAgICAgaWYgaXRlbV92YWx1ZXNfcmVzdWx0OgogICAgICAgICAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgJ2lucHV0X2dvb2RfaWQnOiBpdGVtX3ZhbHVlc19yZXN1bHRbMF1bJ2lkJ10sCiAgICAgICAgICAgICAgICAgICAgJ2dvb2RfY29kZSc6IGl0ZW1fdmFsdWVzX3Jlc3VsdFswXVsnY29kZSddLAogICAgICAgICAgICAgICAgICAgICdwcmljZXNfb2JqZWN0X25hbWUnOiBmJ3tpdGVtX3ZhbHVlc19yZXN1bHRbMF1bIm5hbWUiXX0sICdmJ3tpdGVtX3ZhbHVlc19yZXN1bHRbMF1bImNvZGUiXX0nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpZiBpdGVtX2FydF9pbnB1dCAhPSAn4oCUJyBhbmQgc2VsZi5oYXNoX21hcC5nZXQoJ3JldHVybl90b19pdGVtX2NhcmQnKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZXJyb3JfbXNnJywgZiIg0KLQvtCy0LDRgCDRgSDQsNGA0YLQuNC60YPQu9C+0LwgJ3tpdGVtX2FydF9pbnB1dH0nINC90LUg0L3QsNC50LTQtdC9IikKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgX2lkZW50aWZ5X2JhcmNvZGVfcHJpY2VzKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdiYXJjb2RlX2luZm8nLCBzdHIoc2VsZi5oYXNoX21hcC5nZXQoJ2JhcmNvZGUnKSkpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3ByaWNlc19vYmplY3RfbmFtZScsICcnKQogICAgICAgIG5vX2RhdGEgPSBGYWxzZQoKICAgICAgICBiYXJjb2RlX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSJSU19iYXJjb2RlcyIsIGZpZWxkPSdiYXJjb2RlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpKQogICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXToKICAgICAgICAgICAgaWYgYmFyY29kZV9kYXRhWzBdLmdldCgnaWRfcHJvcGVydHknKToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX3Byb3BlcnR5JykpCiAgICAgICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0nUlNfcHJvcGVydGllcycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9YmFyY29kZV9kYXRhWzBdLmdldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5JykpCiAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lWzBdLmdldCgnbmFtZScpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgc2VsZWN0ZWRfcHJvcGVydHlfbmFtZVswXS5nZXQoJ25hbWUnKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICcnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnJykKCiAgICAgICAgICAgIGlmIGJhcmNvZGVfZGF0YVswXS5nZXQoJ2lkX2dvb2QnKToKICAgICAgICAgICAgICAgIGl0ZW1faWQgPSBiYXJjb2RlX2RhdGFbMF1bJ2lkX2dvb2QnXQoKICAgICAgICAgICAgICAgIGl0ZW1fZGF0YSA9IHNlbGYuc2VydmljZS5nZXRfdmFsdWVzX2J5X2ZpZWxkKHRhYmxlX25hbWU9IlJTX2dvb2RzIiwgZmllbGQ9J2lkJywgZmllbGRfdmFsdWU9aXRlbV9pZCkKICAgICAgICAgICAgICAgIGlmIGl0ZW1fZGF0YVswXToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9pZCcsIGl0ZW1faWQpCiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbV9kYXRhWzBdWydhcnQnXToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2lucHV0X2dvb2RfYXJ0JywgaXRlbV9kYXRhWzBdWydhcnQnXSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnaW5wdXRfZ29vZF9hcnQnLCAn4oCUJykKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgncHJpY2VzX29iamVjdF9uYW1lJywgaXRlbV9kYXRhWzBdWyduYW1lJ10pCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICIiKQoKICAgICAgICBlbHNlOgogICAgICAgICAgICBub19kYXRhID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2JqZWN0X25hbWUnLCAiIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2Vycm9yX21zZycsICLQqNGC0YDQuNGF0LrQvtC0INC90LUg0YDQsNGB0L/QvtC30L3QsNC9IikKCiAgICAgICAgaWYgbm90IG5vX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2dldF9wcmljZXMoKQoKICAgIGRlZiBfcmVzZXRfcHJpY2VzX3RhYmxlcyhzZWxmKToKICAgICAgICB2YXJzX2xpc3QgPSBbJ2lucHV0X2dvb2RfYXJ0JywgJ3ByaWNlc19vYmplY3RfbmFtZScsICdzZWxlY3RlZF9wcmljZV90eXBlX2lkJywgJ3NlbGVjdGVkX3ByaWNlX3R5cGVfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICdwcmljZV90eXBlX3NlbGVjdCcsICdzZWxlY3RlZF9wcm9wZXJ0eV9pZCcsICdzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lJywgJ3Byb3BlcnR5X3NlbGVjdCcsCiAgICAgICAgICAgICAgICAgICAgICdzZWxlY3RlZF91bml0X2lkJywgJ3NlbGVjdGVkX3VuaXRfbmFtZScsICd1bml0X3NlbGVjdCcsICdwcmljZXNfY3VzdG9tX3RhYmxlJywgJ2lucHV0X2dvb2RfaWQnLAogICAgICAgICAgICAgICAgICAgICAnYmFyY29kZScsICdiYXJjb2RlX2luZm8nLCAncHJpY2VzX3RhYmxlJ10KICAgICAgICBkaWN0X2RhdGEgPSB7dmFyOiAiIiBmb3IgdmFyIGluIHZhcnNfbGlzdH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGRpY3RfZGF0YSkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYsIGVsZW1lbnRzKToKICAgICAgICBmb3IgdiBpbiBlbGVtZW50czoKICAgICAgICAgICAgbmFtZSA9IGYnU2hvd197dn0nCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbbmFtZV0gPSAnMScgaWYgc2VsZi5oYXNoX21hcFt2XSBlbHNlICctMScKCiAgICBkZWYgX2dldF9wcmljZXNfZGF0YShzZWxmKToKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ3Byb3BlcnR5X3NlbGVjdCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnLCAnJykKCiAgICAgICAgZGF0YSA9IHNlbGYuaHNfc2VydmljZS5nZXRfcHJpY2VzX2dvb2RzKGlkX2dvb2Q9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfcHJvcGVydHk9c2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3VuaXQ9c2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX3VuaXRfaWQnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfcHJpY2VfdHlwZT1zZWxmLmhhc2hfbWFwLmdldCgnc2VsZWN0ZWRfcHJpY2VfdHlwZV9pZCcpKS5kYXRhCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCByYXdfYmFsYW5jZXNfZGF0YSk6CgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgZm9yIGVsIGluIHJhd19iYWxhbmNlc19kYXRhOgogICAgICAgICAgICB0YWJsZV9yb3cgPSB7J2tleSc6IHN0cihlbFsnaWRfZ29vZCddKSwKICAgICAgICAgICAgICAgICAgICAgICAgICdwcmljZV90eXBlJzogc3RyKGVsWyduYW1lX3ByaWNlX3R5cGUnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAncHJpY2UnOiBzdHIoZWxbJ3ByaWNlJ10pLAogICAgICAgICAgICAgICAgICAgICAgICAgJ3VuaXQnOiBzdHIoZWxbJ25hbWVfdW5pdCddKSBvciAn4oCUJywKICAgICAgICAgICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzJzogc3RyKGVsWyduYW1lX3Byb3BlcnR5J10gb3IgJ+KAlCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgJ19sYXlvdXQnOiBzZWxmLl9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyhlbCl9CiAgICAgICAgICAgIHRhYmxlX2RhdGEuYXBwZW5kKHRhYmxlX3JvdykKCiAgICAgICAgcmV0dXJuIHRhYmxlX2RhdGEKCiAgICBkZWYgX2dldF9wcmljZXNfdGFibGVfdmlldyhzZWxmLCBkYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQotC40L8g0YbQtdC90YsnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LgnKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Cm0LXQvdCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQo9C/0LDQutC+0LLQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0YwRjhGRicKICAgICAgICAgICAgKSwKCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPWRhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3CgogICAgZGVmIF9nZXRfaXRlbV90YWJsZV9yb3dfdmlldyhzZWxmLCByb3dfZGF0YSk6CgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHByaWNlX3R5cGUnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvcGVydGllcycsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJpY2UnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAdW5pdCcsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGMEY4RkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBjbGFzcyBUZXh0Vmlldyh3aWRnZXRzLlRleHRWaWV3KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgdmFsdWUpOgogICAgICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICAgICAgc2VsZi5UZXh0U2l6ZSA9ICcxNScKICAgICAgICAgICAgc2VsZi5UZXh0Qm9sZCA9IFRydWUKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICdtYXRjaF9wYXJlbnQnCiAgICAgICAgICAgIHNlbGYuVmFsdWUgPSB2YWx1ZQoKICAgIGNsYXNzIExpbmVhckxheW91dCh3aWRnZXRzLkxpbmVhckxheW91dCk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHN1cGVyKCkuX19pbml0X18oKmFyZ3MsICoqa3dhcmdzKQogICAgICAgICAgICBzZWxmLm9yaWVudGF0aW9uID0gJ2hvcml6b250YWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgpjbGFzcyBTZWxlY3RQcm9wZXJ0aWVzKEdvb2RzUHJpY2VzSXRlbUNhcmQpOgogICAgc2NyZWVuX25hbWUgPSAn0JLRi9Cx0L7RgCDRhdCw0YDQsNC60YLQtdGA0LjRgdGC0LjQuicKICAgIHByb2Nlc3NfbmFtZSA9ICfQptC10L3RiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLnNlcnZpY2UgPSBHb29kc1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9pbnB1dCgpCiAgICAgICAgY2FyZHNfZGF0YSA9IHNlbGYuX2dldF9kYXRhKCkKICAgICAgICBwcm9wZXJ0aWVzX2NhcmRzID0gc2VsZi5fZ2V0X2NhcmRzKGNhcmRzX2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3Byb3BlcnR5X2NhcmRzJywgcHJvcGVydGllc19jYXJkcy50b19qc29uKCkpCgogICAgZGVmIF9nZXRfZGF0YShzZWxmKToKICAgICAgICB0YWJsZV9uYW1lID0gIlJTX3Byb3BlcnRpZXMiCiAgICAgICAgcmF3X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lLCBmaWVsZD0naWRfb3duZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfdmFsdWU9c2VsZi5oYXNoX21hcC5nZXQoJ2lucHV0X2dvb2RfaWQnKSkKICAgICAgICBjYXJkc19kYXRhID0gW10KICAgICAgICBmb3IgZWxlbWVudCBpbiByYXdfZGF0YToKICAgICAgICAgICAgY2FyZF9kYXRhID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGVsZW1lbnRbJ2lkJ10sCiAgICAgICAgICAgICAgICAnbmFtZSc6IGVsZW1lbnRbJ25hbWUnXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhcmRzX2RhdGEuYXBwZW5kKGNhcmRfZGF0YSkKICAgICAgICByZXR1cm4gY2FyZHNfZGF0YQoKICAgIGRlZiBfZ2V0X2NhcmRzKHNlbGYsIGNhcmRzX2RhdGEpOgogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGV4dFNpemUnKQoKICAgICAgICBjYXJkcyA9IHdpZGdldHMuQ3VzdG9tQ2FyZHMoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BuYW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9Y2FyZF90aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRDb2xvcj0nIzAwMDAwMCcKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgICwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9Y2FyZHNfZGF0YQogICAgICAgICkKICAgICAgICByZXR1cm4gY2FyZHMKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXIgPSBzZWxmLmxpc3RlbmVyCgogICAgICAgIGlmIGxpc3RlbmVyID09ICJDYXJkc0NsaWNrIjoKICAgICAgICAgICAgc2VsZWN0ZWRfcHJvcGVydHlfaWQgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZT0nUlNfcHJvcGVydGllcycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZF92YWx1ZT1zZWxlY3RlZF9wcm9wZXJ0eV9pZClbMF1bJ25hbWUnXQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnc2VsZWN0ZWRfcHJvcGVydHlfaWQnLCBzZWxlY3RlZF9wcm9wZXJ0eV9pZCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsncHJvcGVydHlfc2VsZWN0J10gPSBzZWxlY3RlZF9wcm9wZXJ0eV9uYW1lCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnXSA9IHNlbGVjdGVkX3Byb3BlcnR5X25hbWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiIG9yICdiYWNrX3RvX3ByaWNlcyc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X2lkJ10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydwcm9wZXJ0eV9zZWxlY3QnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3NlbGVjdGVkX3Byb3BlcnR5X25hbWUnXSA9ICcnCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKCmNsYXNzIFNlbGVjdFVuaXQoR29vZHNQcmljZXNJdGVtQ2FyZCk6CiAgICBzY3JlZW5fbmFtZSA9ICfQktGL0LHQvtGAINGD0L/QsNC60L7QstC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0KbQtdC90YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5zZXJ2aWNlID0gR29vZHNTZXJ2aWNlKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5vbl9zdGFydCgpCiAgICAgICAgc2VsZi5fdmFsaWRhdGVfaW5wdXQoKQogICAgICAgIGNhcmRzX2RhdGEgPSBzZWxmLl9nZXRfZGF0YSgpCiAgICAgICAgcHJvcGVydGllc19jYXJkcyA9IHNlbGYuX2dldF9jYXJkcyhjYXJkc19kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd1bml0X2NhcmRzJywgcHJvcGVydGllc19jYXJkcy50b19qc29uKCkpCgogICAgZGVmIF9nZXRfZGF0YShzZWxmKToKICAgICAgICB0YWJsZV9uYW1lID0gIlJTX3VuaXRzIgogICAgICAgIHJhd19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfYnlfZmllbGQodGFibGVfbmFtZSwgZmllbGQ9J2lkX293bmVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGYuaGFzaF9tYXAuZ2V0KCdpbnB1dF9nb29kX2lkJykpCiAgICAgICAgY2FyZHNfZGF0YSA9IFtdCiAgICAgICAgZm9yIGVsZW1lbnQgaW4gcmF3X2RhdGE6CiAgICAgICAgICAgIGNhcmRfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdrZXknOiBlbGVtZW50WydpZCddLAogICAgICAgICAgICAgICAgJ25hbWUnOiBlbGVtZW50WyduYW1lJ10KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXJkc19kYXRhLmFwcGVuZChjYXJkX2RhdGEpCiAgICAgICAgcmV0dXJuIGNhcmRzX2RhdGEKCiAgICBkZWYgX2dldF9jYXJkcyhzZWxmLCBjYXJkc19kYXRhKToKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdDYXJkVGl0bGVUZXh0U2l6ZScpCiAgICAgICAgY2FyZF90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRleHRTaXplJykKCiAgICAgICAgY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApKQogICAgICAgICAgICAsCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCiAgICAgICAgcmV0dXJuIGNhcmRzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgoKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGVjdGVkX3VuaXRfaWQgPSBzZWxmLmhhc2hfbWFwLmdldCgic2VsZWN0ZWRfY2FyZF9rZXkiKQogICAgICAgICAgICBzZWxlY3RlZF91bml0X25hbWUgPSBzZWxmLnNlcnZpY2UuZ2V0X3ZhbHVlc19ieV9maWVsZCh0YWJsZV9uYW1lPSdSU191bml0cycsIGZpZWxkPSdpZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX3ZhbHVlPXNlbGVjdGVkX3VuaXRfaWQpWzBdWyduYW1lJ10KICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfaWQnLCBzZWxlY3RlZF91bml0X2lkKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gc2VsZWN0ZWRfdW5pdF9uYW1lCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdzZWxlY3RlZF91bml0X25hbWUnLCBzZWxlY3RlZF91bml0X25hbWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cf0YDQvtCy0LXRgNC60LAg0YbQtdC9JykKCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiT05fQkFDS19QUkVTU0VEIiBvciAnYmFja190b19wcmljZXMnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF91bml0X2lkJ10gPSAnJwogICAgICAgICAgICBzZWxmLmhhc2hfbWFwWyd1bml0X3NlbGVjdCddID0gJycKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3NlbGVjdGVkX3VuaXRfbmFtZScsICcnKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J/RgNC+0LLQtdGA0LrQsCDRhtC10L0nKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gR29vZHNQcmljZXMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKIyA9PT09PT09PT09PT09PT09PT09PSBTZXJpZXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNlcmllc1NlbGVjdFNjcmVlbihTY3JlZW4pOgogICAgcHJvY2Vzc19uYW1lID0gJ1Nlcmllc1Byb2Nlc3MnCiAgICBzY3JlZW5fbmFtZSA9ICdTZXJpZXNTZWxlY3RTY3JlZW4nCiAgICBkb2NfYmFzaWNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZSA9ICdSU19kb2NzJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3M9Tm9uZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKICAgICAgICBzZWxmLnNlcnZpY2UgPSBkYl9zZXJ2aWNlcy5TZXJpZXNTZXJ2aWNlKCkKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0ge30KICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICd0aXRsZSc6ICfQktGL0LHQvtGAINGB0LXRgNC40LgnLAogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IHNlbGYuaGFzaF9tYXBbJ2RvY19yb3dfaWQnXSwKICAgICAgICB9CiAgICAgICAgc2VsZi51c2VfYWRyX2RvY3NfdGFibGVzID0gc2VsZi5oYXNoX21hcC5nZXRfYm9vbCgndXNlX2Fkcl9kb2NzX3RhYmxlcycpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYudXNlX2Fkcl9kb2NzX3RhYmxlczoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlID0gZGJfc2VydmljZXMuQWRyU2VyaWVzU2VydmljZSgpCiAgICAgICAga2V5ID0gc2VsZi5zY3JlZW5fdmFsdWVzWydkb2Nfcm93X2lkJ10KICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF92YWx1ZXNfZm9yX3NjcmVlbl9ieV9pZChrZXkpCiAgICAgICAgIyAjINCe0LHRgNCw0LHQvtGC0LDQtdC8INGH0LjRgdC70L7QstGL0LUg0LrQu9GO0YfQuCDQsiDRgdC70L7QstCw0YDQtQogICAgICAgIHNlbGYuX2hhbmRsZV9udW1fa2V5cyhzZWxmLnNjcmVlbl9kYXRhKQogICAgICAgIHNlbGYuc2VydmljZS5wYXJhbXMgPSBzZWxmLnNjcmVlbl9kYXRhCiAgICAgICAgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQoKICAgICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoJ2RvY190aXRsZScpOgogICAgICAgICAgICB0aXRsZSA9ICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgc2VsZi5zY3JlZW5fZGF0YVsnZG9jX3R5cGUnXSwKICAgICAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ2RvY19uJ10sCiAgICAgICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWydkb2NfZGF0ZSddCiAgICAgICAgICAgICkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2RvY190aXRsZScsIHRpdGxlKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHNlbGYuc2NyZWVuX2RhdGEpCiAgICAgICAgc2VsZi5fcmVmcmVzaF90b3RhbF9xdHR5KCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdmFsdWVzWyd0aXRsZSddKQogICAgICAgIHNlbGYuaW5pdF9zY3JlZW4oKQogICAgICAgIHNlbGYuX3NldF92aXNpb25fc2V0dGluZ3MoKQogICAgICAgICMgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lciA9IHNlbGYubGlzdGVuZXIKICAgICAgICBpZiBsaXN0ZW5lciA9PSAiQ2FyZHNDbGljayI6CiAgICAgICAgICAgIHNlbGYuX2NhcmRzX2NsaWNrX2hhbmRsZXIoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gIk9OX0JBQ0tfUFJFU1NFRCI6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICdiYXJjb2RlJzoKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAndmlzaW9uX2NhbmNlbCc6CiAgICAgICAgICAgIFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbF9jb3VudGVyLmRlc3Ryb3koKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ3Zpc2lvbic6CiAgICAgICAgICAgIHNlbGYuX2JhcmNvZGVfbGlzdGVuZXIoKQogICAgICAgICAgICBTZXJpYWxOdW1iZXJPQ1JTZXR0aW5ncy5vY3Jfbm9zcWxfY291bnRlci5kZXN0cm95KCkKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0xheW91dEFjdGlvbic6CiAgICAgICAgICAgIHNlbGYuX2xheW91dF9hY3Rpb24oKQogICAgICAgIGVsaWYgc2VsZi5faXNfcmVzdWx0X3Bvc2l0aXZlKCdjb25maXJtX2RlbGV0ZScpOgogICAgICAgICAgICBzZWxmLmRlbGV0ZV9zZXJpZXMoKQogICAgICAgIGVsaWYgbGlzdGVuZXIgPT0gJ2J0bl9vY3Jfc2VyaWFsX3RlbXBsYXRlX3NldHRpbmdzJzoKICAgICAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfcHJvY2Vzc19yZXN1bHQoJ09jclRleHRSZWNvZ25pdGlvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MnKQogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLnNob3dfcHJvY2Vzc19yZXN1bHQoYXJncykKCiAgICBkZWYgX2NhcmRzX2NsaWNrX2hhbmRsZXIoc2VsZik6CiAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfaXRlbV9zY3JlZW4oKQoKICAgIGRlZiBfb3Blbl9zZXJpZXNfaXRlbV9zY3JlZW4oc2VsZik6CiAgICAgICAgYXJncyA9IHsKICAgICAgICAgICAgJ3Nlcmllc19pZCc6IHNlbGYuaGFzaF9tYXAuZ2V0KCJzZWxlY3RlZF9jYXJkX2tleSIpLAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjRjycKICAgICAgICB9CiAgICAgICAgc2NyZWVuID0gU2VyaWVzSXRlbShzZWxmLmhhc2hfbWFwLCBzZWxmLnJzX3NldHRpbmdzKQogICAgICAgIHNjcmVlbi5wYXJlbnRfc2NyZWVuID0gc2VsZgogICAgICAgIHNjcmVlbi5zaG93KGFyZ3MpCgogICAgZGVmIF9yZWZyZXNoX3RvdGFsX3F0dHkoc2VsZik6CiAgICAgICAgcmVhbF9xdHR5ID0gc2VsZi5zZXJ2aWNlLmdldF90b3RhbF9xdHR5KCkKICAgICAgICBvbGRfcXR5ID0gZmxvYXQoc2VsZi5oYXNoX21hcFsncXR0eSddIG9yIDApCgogICAgICAgIGlmIG9sZF9xdHkgIT0gZmxvYXQocmVhbF9xdHR5IG9yIDApOgogICAgICAgICAgICBzZWxmLnNlcnZpY2UudXBkYXRlX3RvdGFsX3F0eShxdHk9cmVhbF9xdHR5LCByb3dfaWQ9c2VsZi5zY3JlZW5fdmFsdWVzWydkb2Nfcm93X2lkJ10pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ3F0dHknXSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShyZWFsX3F0dHkpCgogICAgZGVmIF9iYXJjb2RlX2xpc3RlbmVyKHNlbGYpOgogICAgICAgIHNlbGYuX2lkZW50aWZ5X2FkZF9iYXJjb2RlX3NlcmllcygpCiAgICAgICAgc2VsZi5fcmVmcmVzaF9zZXJpZXNfY2FyZHMoKQogICAgICAgIHNlbGYuX3JlZnJlc2hfdG90YWxfcXR0eSgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9jaGVja19xdHR5X2xpbWl0cyhzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdjb250cm9sJyk6CiAgICAgICAgICAgIHF0dHkgPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eScpKQogICAgICAgICAgICBxdHR5X3BsYW4gPSBmbG9hdChzZWxmLmhhc2hfbWFwLmdldCgncXR0eV9wbGFuJykpCiAgICAgICAgICAgIGlmIHF0dHkgPiBxdHR5X3BsYW46CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCLQpNCw0LrRgiDQv9GA0LXQstGL0YjQsNC10YIg0L/Qu9Cw0L0iKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIGlmIHNlbGYuX2NoZWNrX3F0dHlfbGltaXRzKCk6CiAgICAgICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2ZpbmlzaF9wcm9jZXNzKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX2ZpbmlzaF9wcm9jZXNzX3Jlc3VsdCgpCgogICAgZGVmIF9yZWZyZXNoX3Nlcmllc19jYXJkcyhzZWxmKToKICAgICAgICBsaXN0X2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc19ieV9kb2NfYW5kX2dvb2RzKCkKICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5faGFuZGxlX251bV9rZXlzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBsaXN0X2RhdGEgPSBbc2VsZi5fYWRkX3RleHRfaW5fdmFsdWVzKGl0ZW0pIGZvciBpdGVtIGluIGxpc3RfZGF0YV0KICAgICAgICBkb2NfY2FyZHMgPSBzZWxmLl9nZXRfZG9jX2NhcmRzX3ZpZXcobGlzdF9kYXRhKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3Nlcmllc19jYXJkcyddID0gZG9jX2NhcmRzLnRvX2pzb24oKQoKICAgIGRlZiBfaGFuZGxlX251bV9rZXlzKHNlbGYsIHZhbHVlczogZGljdCkgLT4gZGljdDoKICAgICAgICBudW1lcmljX2tleXMgPSAoJ3F0dHknLCAncXR0eV9wbGFuJywgJ2RfcXR0eScpCiAgICAgICAgZm9yIGtleSBpbiBudW1lcmljX2tleXM6CiAgICAgICAgICAgIGlmIGtleSBpbiB2YWx1ZXMgYW5kIHJlLm1hdGNoKCJeXGQrXC4/XGQqJCIsIHN0cih2YWx1ZXNba2V5XSkpOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoZmxvYXQodmFsdWVzW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSAnMCcKICAgICAgICByZXR1cm4gdmFsdWVzCgogICAgZGVmIF9hZGRfdGV4dF9pbl92YWx1ZXMoc2VsZiwgdmFsdWVzOiBkaWN0KSAtPiBkaWN0OgogICAgICAgIGZvciBrZXkgaW4gdmFsdWVzLmtleXMoKToKICAgICAgICAgICAgaWYga2V5ID09ICdiZXN0X2JlZm9yZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9Cz0L7QtNC10L0g0LTQvjoge3ZhbHVlc1trZXldfScKICAgICAgICAgICAgZWxpZiBrZXkgPT0gJ3Byb2R1Y3Rpb25fZGF0ZScgYW5kIHZhbHVlc1trZXldOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C00LDRgtCwINC/0YDQvtC40LfQsi46IHt2YWx1ZXNba2V5XX0nCiAgICAgICAgICAgIGVsaWYga2V5ID09ICdxdHR5JyBhbmQgdmFsdWVzW2tleV0gaXMgbm90IE5vbmUgYW5kIHZhbHVlc1trZXldICE9ICcnOgogICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSBmJ9C60L7Quy3QstC+OiB7dmFsdWVzW2tleV19JwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2dldF9kb2NfY2FyZHNfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKCiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MgogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BiZXN0X2JlZm9yZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPXRpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuUG9wdXBNZW51QnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0n0KPQtNCw0LvQuNGC0YwnLAogICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZT0ibWVudV9kZWxldGUiLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHknLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BudW1iZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dENvbG9yPScjMGYwM2ZjJwogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9JyAnLAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcHJvZHVjdGlvbl9kYXRlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCgogICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIKICAgICAgICAgICAgKSwKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMoKS5vcHRpb25zLAogICAgICAgICAgICBjYXJkc2RhdGE9dGFibGVfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfaWRlbnRpZnlfYWRkX2JhcmNvZGVfc2VyaWVzKHNlbGYpOgogICAgICAgIG9jcl9ub3NxbCA9IFNlcmlhbE51bWJlck9DUlNldHRpbmdzLm9jcl9ub3NxbAogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZScpIG9yIG9jcl9ub3NxbC5nZXQoJ29jcl9yZXN1bHQnKQogICAgICAgIGlmIGJhcmNvZGU6CiAgICAgICAgICAgIG9jcl9ub3NxbC5kZWxldGUoJ29jcl9yZXN1bHQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnYmFyY29kZScpCiAgICAgICAgICAgIHZhbHVlcyA9IHNlbGYuc2VydmljZS5nZXRfc2VyaWVzX2J5X2JhcmNvZGUoYmFyY29kZSwgc2VsZi5zY3JlZW5fZGF0YSkKICAgICAgICAgICAgaWYgdmFsdWVzOgogICAgICAgICAgICAgICAgaXRlbV9pZCA9IHZhbHVlc1swXVsnaWQnXQogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9xdHR5X3RvX3RhYmxlX3N0cihpdGVtX2lkKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmFkZF9uZXdfc2VyaWVzX2luX2RvY19zZXJpZXNfdGFibGUoYmFyY29kZSkKCiAgICBkZWYgX2xheW91dF9hY3Rpb24oc2VsZik6CiAgICAgICAgbGF5b3V0X2xpc3RlbmVyID0gc2VsZi5oYXNoX21hcC5nZXQoJ2xheW91dF9saXN0ZW5lcicpCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDRgdC10YDQuNGOPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQmNC30LzQtdC90LjRgtGMJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnY3VycmVudF9zZXJpZXNfaWQnXSA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLCBzZWxmLnBhcmFtcykKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKICAgIGRlZiBkZWxldGVfc2VyaWVzKHNlbGYpOgogICAgICAgIGlkID0gc2VsZi5oYXNoX21hcC5nZXQoJ3NlbGVjdGVkX2NhcmRfa2V5JykKICAgICAgICBzZWxmLnNlcnZpY2UuZGVsZXRlX2N1cnJlbnRfc3QoaWQpCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgb2NyX25vc3FsID0gU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsCiAgICAgICAgc2VyaWFsX29jcl9zZXR0aW5ncyA9IG9jcl9ub3NxbC5nZXQoJ3NlcmlhbF9vY3Jfc2V0dGluZ3MnKQogICAgICAgIGlmIHNlcmlhbF9vY3Jfc2V0dGluZ3M6CiAgICAgICAgICAgIHNlcmlhbF9vY3Jfc2V0dGluZ3MgPSBqc29uLmxvYWRzKHNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3Zpc2lvbl9zZXR0aW5ncygqKnNlcmlhbF9vY3Jfc2V0dGluZ3MpCiAgICAgICAgICAgIG9jcl9ub3NxbC5wdXQoJ2Zyb21fc2NyZWVuJywgJ1Nlcmllc1NlbGVjdFNjcmVlbicsIFRydWUpCgpjbGFzcyBTZXJpZXNJdGVtKFNjcmVlbik6CiAgICBwcm9jZXNzX25hbWUgPSAnU2VyaWVzUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ0ZpbGxpbmdTZXJpZXNTY3JlZW4nCiAgICBkb2NfYmFzaWNfdGFibGVfbmFtZSA9ICdSU19kb2NzX3RhYmxlJwogICAgZG9jX2Jhc2ljX2hhbmRsZXJfbmFtZSA9ICdSU19kb2NzJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlcmllc1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHsKICAgICAgICAgICAgJ3RpdGxlJzogJ9CX0LDQv9C+0LvQvdC10L3QuNC1INGB0LXRgNC40LgnLAogICAgICAgICAgICAnc2VyaWVzX2lkJzogc2VsZi5oYXNoX21hcFsnc2VyaWVzX2lkJ10sCiAgICAgICAgfQoKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQoKICAgICAgICBwdXRfZGF0YSA9IHsKICAgICAgICAgICAgJ2dvb2RfbmFtZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ2dvb2RfbmFtZSddLAogICAgICAgICAgICAnbmFtZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ25hbWUnXSwKICAgICAgICAgICAgJ251bWJlcic6IHNlbGYuc2NyZWVuX2RhdGFbJ251bWJlciddLAogICAgICAgICAgICAncHJvZHVjdGlvbl9kYXRlJzogc2VsZi5zY3JlZW5fZGF0YVsncHJvZHVjdGlvbl9kYXRlJ10sCiAgICAgICAgICAgICdiZXN0X2JlZm9yZSc6IHNlbGYuc2NyZWVuX2RhdGFbJ2Jlc3RfYmVmb3JlJ10sCiAgICAgICAgICAgICdGaWxsaW5nU2VyaWVzU2NyZWVuX3F0dHknIDogc2VsZi5zY3JlZW5fZGF0YVsncXR0eSddCiAgICAgICAgfQoKICAgICAgICBzZWxmLl9oYW5kbGVfbnVtX2tleXMocHV0X2RhdGEpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VyaWVzX2lkID0gc2VsZi5zY3JlZW5fdmFsdWVzWydzZXJpZXNfaWQnXQogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X3Nlcmllc190YWJsZV9zdHIoc2VyaWVzX2lkKQogICAgICAgICMgc2VsZi5pbml0X3NjcmVlbigpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVyID0gc2VsZi5saXN0ZW5lcgogICAgICAgIGlmIGxpc3RlbmVyID09ICJidG5fc2F2ZSI6CiAgICAgICAgICAgIHNlbGYuX3NhdmVfZGF0YSgpCiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKICAgICAgICBlbGlmIGxpc3RlbmVyID09ICJPTl9CQUNLX1BSRVNTRUQiOgogICAgICAgICAgICBzZWxmLl9iYWNrX3NjcmVlbigpCiAgICAgICAgZWxpZiBsaXN0ZW5lciA9PSAiYnRuX2NhbmNlbCI6CiAgICAgICAgICAgIHNlbGYuX2JhY2tfc2NyZWVuKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9zYXZlX2RhdGEoc2VsZik6CiAgICAgICAgcGFyYW1zID0geydpZCc6IGludChzZWxmLnNjcmVlbl9kYXRhWydpZCddKSwKICAgICAgICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuc2NyZWVuX2RhdGFbJ2lkX2RvYyddLAogICAgICAgICAgICAgICAgICAnaWRfZ29vZCc6ICBzZWxmLnNjcmVlbl9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzpzZWxmLmhhc2hfbWFwWydpZF9wcm9wZXJ0aWVzJ10sCiAgICAgICAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmhhc2hfbWFwWydpZF9zZXJpZXMnXSwKICAgICAgICAgICAgICAgICAgJ2lkX3dhcmVob3VzZSc6IHNlbGYuaGFzaF9tYXBbJ2lkX3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgICAncXR0eSc6IHNlbGYuaGFzaF9tYXBbJ0ZpbGxpbmdTZXJpZXNTY3JlZW5fcXR0eSddLAogICAgICAgICAgICAgICAgICAnbmFtZSc6IHNlbGYuaGFzaF9tYXBbJ25hbWUnXSwKICAgICAgICAgICAgICAgICAgJ2Jlc3RfYmVmb3JlJzogc2VsZi5oYXNoX21hcFsnYmVzdF9iZWZvcmUnXSBpZiBzZWxmLl9pc192YWxpZF9kYXRlX2Zvcm1hdChzZWxmLmhhc2hfbWFwWydiZXN0X2JlZm9yZSddKSBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICdudW1iZXInOiBzZWxmLmhhc2hfbWFwWydudW1iZXInXSwKICAgICAgICAgICAgICAgICAgJ3Byb2R1Y3Rpb25fZGF0ZSc6IHNlbGYuaGFzaF9tYXBbJ3Byb2R1Y3Rpb25fZGF0ZSddIGlmIHNlbGYuX2lzX3ZhbGlkX2RhdGVfZm9ybWF0KHNlbGYuaGFzaF9tYXBbJ3Byb2R1Y3Rpb25fZGF0ZSddKSBlbHNlIE5vbmUsCiAgICAgICAgICAgICAgICAgICdjZWxsJzogc2VsZi5oYXNoX21hcFsnaWRfY2VsbCddCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICBzZWxmLnNlcnZpY2Uuc2F2ZV90YWJsZV9zdHIocGFyYW1zKQoKICAgIGRlZiBfaXNfdmFsaWRfZGF0ZV9mb3JtYXQoc2VsZiwgZGF0ZV9zdHIpOgogICAgICAgIHBhdHRlcm4gPSByIl4oMFsxLTldfFsxMl1bMC05XXwzWzAxXSlcLigwWzEtOV18MVswLTJdKVwuXGR7NH0kIgogICAgICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIGRhdGVfc3RyKSkKCiAgICBkZWYgX2hhbmRsZV9udW1fa2V5cyhzZWxmLCB2YWx1ZXM6IGRpY3QpIC0+IGRpY3Q6CiAgICAgICAgbnVtZXJpY19rZXlzID0gKCdxdHR5JywgJ3F0dHlfcGxhbicsICdkX3F0dHknLCAnRmlsbGluZ1Nlcmllc1NjcmVlbl9xdHR5JykKICAgICAgICBmb3Iga2V5IGluIG51bWVyaWNfa2V5czoKICAgICAgICAgICAgaWYga2V5IGluIHZhbHVlcyBhbmQgcmUubWF0Y2goIl5cZCtcLj9cZCokIiwgc3RyKHZhbHVlc1trZXldKSk6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9IHNlbGYuX2Zvcm1hdF9xdWFudGl0eShmbG9hdCh2YWx1ZXNba2V5XSkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9ICcwJwogICAgICAgIHJldHVybiB2YWx1ZXMKCiAgICBkZWYgX2Zvcm1hdF9xdWFudGl0eShzZWxmLCBxdHR5KToKICAgICAgICBpZiBmbG9hdChxdHR5KSAlIDEgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIGludChmbG9hdChxdHR5KSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gcXR0eQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlcmllcyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgojID09PT09PT09PT09PT09PT09PT09IFNlbGVjdEl0ZW1TY3JlZW4gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNlbGVjdEl0ZW1TY3JlZW4oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICdTZWxlY3RJdGVtUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ1NlbGVjdEl0ZW1TY3JlZW4nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCB0YWJsZV9uYW1lLCAqKmt3YXJncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCkKCiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHNlbGYuZmllbGRzOiBMaXN0W3N0cl0gPSBrd2FyZ3MuZ2V0KCdmaWVsZHMnLCBbJ25hbWUnXSkKICAgICAgICBzZWxmLnJlc3VsdF9saXN0ZW5lciA9IGt3YXJncy5nZXQoJ3Jlc3VsdF9saXN0ZW5lcicsICdzZWxlY3Rfc3VjY2VzcycpCiAgICAgICAgc2VsZi5yZXR1cm5fdmFsdWVfa2V5ID0ga3dhcmdzLmdldCgncmV0dXJuX3ZhbHVlX2tleScsICdzZWxlY3RlZF9jYXJkJykKICAgICAgICBzZWxmLnRpdGxlID0ga3dhcmdzLmdldCgndGl0bGUnLCAn0JLRi9Cx0L7RgCDQt9C90LDRh9C10L3QuNGPJykKCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gZGJfc2VydmljZXMuU2VsZWN0SXRlbVNlcnZpY2Uoc2VsZi50YWJsZV9uYW1lKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF90aXRsZShzZWxmLnRpdGxlKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2ssCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLlNlbGVjdEl0ZW1TZXJ2aWNlKHNlbGYudGFibGVfbmFtZSkKICAgICAgICBjYXJkc19kYXRhID0gc2VsZi5kYl9zZXJ2aWNlLmdldF9zZWxlY3RfZGF0YSgpCiAgICAgICAgY2FyZHMgPSBzZWxmLl9nZXRfY2FyZHMoY2FyZHNfZGF0YSkKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnU2VsZWN0SXRlbVNjcmVlbl9pdGVtc19jYXJkcyddID0gY2FyZHMudG9fanNvbigpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ1NldFJlc3VsdExpc3RlbmVyJ10gPSBzZWxmLnJlc3VsdF9saXN0ZW5lcgogICAgICAgIHNlbGYuc2hvd19wcm9jZXNzX3Jlc3VsdCgpCgogICAgZGVmIF9nZXRfY2FyZHMoc2VsZiwgY2FyZHNfZGF0YSk6CiAgICAgICAgY2FyZF90aXRsZV90ZXh0X3NpemUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnQ2FyZFRpdGxlVGV4dFNpemUnKQogICAgICAgIGNhcmRfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUZXh0U2l6ZScpCgogICAgICAgIGZpZWxkc192aWV3cyA9IFtdCiAgICAgICAgZm9yIGZpZWxkIGluIHNlbGYuZmllbGRzOgogICAgICAgICAgICBmaWVsZHNfdmlld3MuYXBwZW5kKAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9ZidAe2ZpZWxkfScsCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPWNhcmRfdGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Q29sb3I9JyMwMDAwMDAnLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCgogICAgICAgIGNhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAqZmllbGRzX3ZpZXdzLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgY2FyZHNkYXRhPWNhcmRzX2RhdGEKICAgICAgICApCiAgICAgICAgcmV0dXJuIGNhcmRzCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChzZWxmLnJldHVybl92YWx1ZV9rZXksIHNlbGYuX2dldF9zZWxlY3RlZF9jYXJkX2RhdGEoKSwgdG9fanNvbj1UcnVlKQogICAgICAgIHNlbGYuX2ZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgX2JhY2tfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKHNlbGYucmV0dXJuX3ZhbHVlX2tleSkKICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIF9maW5pc2hfcHJvY2VzcyhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnU2VsZWN0SXRlbVNjcmVlbl9pdGVtc19jYXJkcycpCiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3NfcmVzdWx0KCkKCgpjbGFzcyBTaG93SXRlbXNTY3JlZW4oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICdTZWxlY3RJdGVtUHJvY2VzcycKICAgIHNjcmVlbl9uYW1lID0gJ1Nob3dJdGVtc1NjcmVlbicKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmluaXRfcGFyYW1zID0gWyd0aXRsZScsICd0YWJsZV9kYXRhJywgJ3RhYmxlX2hlYWRlcicsICdlbnVtZXJhdGUnXQogICAgICAgIHNlbGYuZW51bWVyYXRlPVRydWUKICAgICAgICBzZWxmLnRhYmxlX2RhdGEgPSBbXQogICAgICAgIHNlbGYuZmllbGRzID0gW10KICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHt9CiAgICAgICAgc2VsZi50ZXh0X3NpemUgPSAxNQogICAgICAgIHNlbGYuaGVhZGVyX3RleHRfc2l6ZSA9IDE1CgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2V0X3RpdGxlKHNlbGYuaGFzaF9tYXBbJ3RpdGxlJ10gb3IgJ9Ch0L/QuNGB0L7QuicpCiAgICAgICAgc2VsZi5lbnVtZXJhdGUgPSBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdlbnVtZXJhdGUnKQogICAgICAgIHNlbGYudGFibGVfZGF0YSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ3RhYmxlX2RhdGEnKQogICAgICAgIHNlbGYudGFibGVfaGVhZGVyID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigndGFibGVfaGVhZGVyJykKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfZGF0YToKICAgICAgICAgICAgcmFpc2UgVmFsdWVFcnJvciAoJ3RhYmxlX2RhdGEgbm90IGluaXRpYWxpemVkJykKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfaGVhZGVyOgogICAgICAgICAgICBzZWxmLnRhYmxlX2hlYWRlciA9IHtrZXk6IGtleSBmb3Iga2V5IGluIG5leHQoaXRlcihzZWxmLnRhYmxlX2RhdGEpKS5rZXlzKCl9CgogICAgICAgIHRhYmxlX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEoKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2l0ZW1zX3RhYmxlJ10gPSBzZWxmLl9nZXRfdGFibGVfdmlldyh0YWJsZV9kYXRhKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZWxmLmluaXRfc2NyZWVuKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLm5vX3JlZnJlc2goKQoKICAgIGRlZiBfcHJlcGFyZV90YWJsZV9kYXRhKHNlbGYpOgogICAgICAgIHNlbGYuZmllbGRzID0gbGlzdChzZWxmLnRhYmxlX2hlYWRlci5rZXlzKCkpCiAgICAgICAgdGFibGVfaGVhZGVyX2xheW91dCA9IHsnX2xheW91dCc6IHNlbGYuX2dldF90YWJsZV9oZWFkZXJfdmlldygpfQoKICAgICAgICBpZiBzZWxmLmVudW1lcmF0ZToKICAgICAgICAgICAgdGFibGVfZGF0YSA9IFtkaWN0KCoqeydwb3MnOiAnTid9LCAqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXQogICAgICAgICAgICB0YWJsZV9kYXRhICs9IFtkaWN0KCoqeydwb3MnOiBwb3N9LCAqKnJvdykgZm9yIHBvcywgcm93IGluIGVudW1lcmF0ZShzZWxmLnRhYmxlX2RhdGEsIHN0YXJ0PTEpXQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhYmxlX2RhdGEgPSBbZGljdCgqKnNlbGYudGFibGVfaGVhZGVyLCAqKnRhYmxlX2hlYWRlcl9sYXlvdXQpXSArIHNlbGYudGFibGVfZGF0YQogICAgICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X3RhYmxlX2hlYWRlcl92aWV3KHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLl9nZXRfZmllbGRzX2xheW91dChpc19oZWFkZXI9VHJ1ZSkKCiAgICBkZWYgX2dldF9maWVsZHNfbGF5b3V0KHNlbGYsIGlzX2hlYWRlcj1GYWxzZSwgYmFja2dyb3VuZF9jb2xvcj0nI0ZCRTlFNycsIHdlaWdodD0xKToKICAgICAgICBpZiBpc19oZWFkZXI6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAnI0ZGRkZGRicKICAgICAgICAgICAgdGV4dF9zaXplID0gc2VsZi5oZWFkZXJfdGV4dF9zaXplCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGV4dF9zaXplID0gc2VsZi50ZXh0X3NpemUKCiAgICAgICAgaWYgbm90IHNlbGYudGFibGVfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGZpZWxkc19sYXlvdXQgPSB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPWJhY2tncm91bmRfY29sb3IsCiAgICAgICAgKQoKICAgICAgICBpZiBzZWxmLmVudW1lcmF0ZToKICAgICAgICAgICAgcG9zX2xheW91dCA9IHNlbGYuX2dldF9jb2x1bW5fdmlldyh2YWx1ZT0ncG9zJywgdGV4dF9zaXplPXRleHRfc2l6ZSwgd2VpZ2h0PXdlaWdodCkKICAgICAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQocG9zX2xheW91dCkKCiAgICAgICAgZmllbGRzX2xheW91dC5hcHBlbmQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgKltzZWxmLl9nZXRfY29sdW1uX3ZpZXcodmFsdWU9ZmllbGQsIHRleHRfc2l6ZT10ZXh0X3NpemUsIHdlaWdodD13ZWlnaHQpIGZvciBmaWVsZCBpbiBzZWxmLmZpZWxkc10sCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIHdlaWdodD04CiAgICAgICAgICAgICkKICAgICAgICApCgogICAgICAgIHJldHVybiBmaWVsZHNfbGF5b3V0CgogICAgZGVmIF9nZXRfY29sdW1uX3ZpZXcoc2VsZiwgdmFsdWUsIHRleHRfc2l6ZT0yMCwgd2VpZ2h0PTEpOgogICAgICAgIHJldHVybiB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgIFZhbHVlPWYnQHt2YWx1ZX0nLAogICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgVGV4dFNpemU9dGV4dF9zaXplLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgd2VpZ2h0PXdlaWdodCwKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MSwKICAgICAgICApCgogICAgZGVmIF9nZXRfdGFibGVfdmlldyhzZWxmLCB0YWJsZV9kYXRhKToKICAgICAgICB0YWJsZV92aWV3ID0gd2lkZ2V0cy5DdXN0b21UYWJsZSgKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICBzZWxmLl9nZXRfZmllbGRzX2xheW91dCgpLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX2RhdGEKICAgICAgICApCgogICAgICAgIHJldHVybiB0YWJsZV92aWV3LnRvX2pzb24oKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlbGVjdEl0ZW1TY3JlZW4gXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXgoKCgojID09PT09PT09PT09PT09PT09PT09IFNldHRpbmdzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTZXR0aW5nc1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBzZXR0aW5nc19rZXlzID0gWwogICAgICAgICAgICAndXNlX21hcmsnLAogICAgICAgICAgICAnYWxsb3dfZmFjdF9pbnB1dCcsCiAgICAgICAgICAgICdhZGRfaWZfbm90X2luX3BsYW4nLAogICAgICAgICAgICAncGF0aCcsCiAgICAgICAgICAgICdhbGxvd19vdmVyc2NhbicsCiAgICAgICAgICAgICdvZmZsaW5lX21vZGUnCiAgICAgICAgXQoKICAgICAgICBwdXRfZGF0YSA9IHtrZXk6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KGtleSkgZm9yIGtleSBpbiBzZXR0aW5nc19rZXlzfQogICAgICAgIHB1dF9kYXRhWydpcF9hZHInXSA9IHNlbGYuX2dldF9pcF9hZGRyZXNzKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgc2VsZi5fdXBkYXRlX3JzX3NldHRpbmdzKCkKCiAgICAgICAgbGlzdGVuZXJzID0gewogICAgICAgICAgICAnYnRuX2h0dHBfc2V0dGluZ3MnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60LggaHR0cCDRgdC+0LXQtNC40L3QtdC90LjRjycpLAogICAgICAgICAgICAnYnRuX3NpemUnOiBsYW1iZGE6IHNlbGYuX3Nob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0KjRgNC40YTRgtC+0LInKSwKICAgICAgICAgICAgJ2J0bl9zb3VuZF9zZXR0aW5ncyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQsCDQt9Cy0YPQutCwJyksCiAgICAgICAgICAgICdidG5fZG9jdW1lbnRzX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLl9zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyJyksCiAgICAgICAgICAgICdidG5fb2NyX3JlY29nbml0aW9uX3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnB1dCgnU3RhcnRQcm9jZXNzJywgJ09jclRleHRSZWNvZ25pdGlvbicpLAogICAgICAgICAgICAnYnRuX3ByaW50X3NldHRpbmdzJzogbGFtYmRhOiBzZWxmLmhhc2hfbWFwLnB1dCgnU3RhcnRQcm9jZXNzJywgJ9Cf0LXRh9Cw0YLRjCcpLAogICAgICAgICAgICAnYnRuX3Rlc3RfYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Ci0LXRgdGCINGB0LrQsNC90LXRgNCwJyksCiAgICAgICAgICAgICdidG5fZXJyX2xvZyc6IGxhbWJkYTogc2VsZi5fc2hvd19zY3JlZW4oJ9Ce0YjQuNCx0LrQuCcpLAogICAgICAgICAgICAnYnRuX3VwbG9hZF9kb2NzJzogc2VsZi5fdXBsb2FkX2RvY3MsCiAgICAgICAgICAgICdidG5fdGltZXInOiBzZWxmLl9sb2FkX2RvY3MsCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBsYW1iZGE6IHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzJywgJycpLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF91cGxvYWRfZG9jcyhzZWxmKToKICAgICAgICBpZiBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHRpbWVyID0gVGltZXIoc2VsZi5oYXNoX21hcCkKICAgICAgICAgICAgdGltZXIudXBsb2FkX2RhdGEoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYudG9hc3QoJ9Cd0LUg0LfQsNC00LDQvdGLINC90LDRgdGC0YDQvtC50LrQuCDRgdC+0LXQtNC40L3QtdC90LjRjycpCgogICAgZGVmIF9sb2FkX2RvY3Moc2VsZik6CiAgICAgICAgaWYgc2VsZi5fY2hlY2tfaHR0cF9zZXR0aW5ncygpOgogICAgICAgICAgICB0aW1lciA9IFRpbWVyKHNlbGYuaGFzaF9tYXApCiAgICAgICAgICAgIHRpbWVyLnRpbWVyX29uX3N0YXJ0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INC30LDQtNCw0L3RiyDQvdCw0YHRgtGA0L7QudC60Lgg0YHQvtC10LTQuNC90LXQvdC40Y8nKQoKICAgIGRlZiBfdXBkYXRlX3JzX3NldHRpbmdzKHNlbGYpIC0+IE5vbmU6CiAgICAgICAgdXNlX21hcmsgPSBzZWxmLmhhc2hfbWFwLmdldCgndXNlX21hcmsnKSBvciAnZmFsc2UnCiAgICAgICAgcGF0aCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdwYXRoJykgb3IgJy8vc3RvcmFnZS9lbXVsYXRlZC8wL0FuZHJvaWQvZGF0YS9ydS50cmF2ZWxmb29kLnNpbXBsZV91aS8nCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ2FsbG93X2ZhY3RfaW5wdXQnKSBvciBGYWxzZQogICAgICAgIG9mZmxpbmVfbW9kZSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ29mZmxpbmVfbW9kZScpIG9yIEZhbHNlCgogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VfbWFyaycsIHVzZV9tYXJrLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdwYXRoJywgcGF0aCwgVHJ1ZSkKICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnYWxsb3dfZmFjdF9pbnB1dCcsIGFsbG93X2ZhY3RfaW5wdXQsIFRydWUpCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ29mZmxpbmVfbW9kZScsIG9mZmxpbmVfbW9kZSwgVHJ1ZSkKCiAgICBkZWYgX3Nob3dfc2NyZWVuKHNlbGYsIHNjcmVlbl9uYW1lKSAtPiBOb25lOgogICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oc2NyZWVuX25hbWUpCgogICAgZGVmIF9nZXRfaHR0cF9zZXR0aW5ncyhzZWxmKSAtPiBkaWN0OgogICAgICAgIGh0dHBfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgiVVJMIiksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1VTRVInKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnUEFTUycpLAogICAgICAgICAgICAnZGV2aWNlX21vZGVsJzogc2VsZi5oYXNoX21hcFsnREVWSUNFX01PREVMJ10sCiAgICAgICAgICAgICdhbmRyb2lkX2lkJzogc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIF9nZXRfaXBfYWRkcmVzcygpIC0+IHN0cjoKICAgICAgICByZXMgPSBnZXRfaXBfYWRkcmVzcygpCiAgICAgICAgaWYgcmVzOgogICAgICAgICAgICByZXR1cm4gcmVzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuICfQvdC10YIg0YHQtdGC0LgnCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKCmNsYXNzIEZvbnRTaXplU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCDQqNGA0LjRhNGC0L7QsicKICAgIHByb2Nlc3NfbmFtZSA9ICfQn9Cw0YDQsNC80LXRgtGA0YsnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHB1dF9kYXRhID0ge30KICAgICAgICBmaWVsZHNfZGF0YSA9IHsKICAgICAgICAgICAgJ1RpdGxlVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINC30LDQs9C+0LvQvtCy0LrQsCcsCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQoNCw0LfQvNC10YAg0LfQsNCz0L7Qu9C+0LLQutCwINC60LDRgNGC0L7Rh9C60LgnLAogICAgICAgICAgICAiQ2FyZERhdGVUZXh0U2l6ZSI6ICfQlNCw0L3QvdGL0LUg0LrQsNGA0YLQvtGH0LrQuCcsCiAgICAgICAgICAgICdDYXJkVGV4dFNpemUnOiAn0KDQsNC30LzQtdGAINGC0LXQutGB0YLQsCDRjdC70LXQvNC10L3RgtC+0LInLAogICAgICAgICAgICAnR29vZHNDYXJkVGl0bGVUZXh0U2l6ZSc6ICfQl9Cw0LPQvtC70L7QstC+0Log0YLQvtCy0LDRgNCwJywKICAgICAgICAgICAgJ2dvb2RzVGV4dFNpemUnOiAn0KLQvtCy0LDRgCcsCiAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiAn0KHQtdGA0LjQuCDRgdCy0L7QudGB0YLQstCwJywKICAgICAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAn0KLQuNC/INC00L7QutGD0LzQtdC90YLQsCcsCiAgICAgICAgICAgICd0aXRsZURvY1R5cGVDYXJkVGV4dFNpemUnOiAn0J3QsNC30LLQsNC90LjQtSDQtNC+0LrRg9C80LXQvdGC0LAg0LIg0LrQsNGA0YLQvtGH0LrQtScKICAgICAgICB9CgogICAgICAgIGZvciBmaWVsZCwgaGludCBpbiBmaWVsZHNfZGF0YS5pdGVtcygpOgogICAgICAgICAgICBwdXRfZGF0YVtmaWVsZF0gPSB3aWRnZXRzLk1vZGVybkZpZWxkKAogICAgICAgICAgICAgICAgaGludD1oaW50LAogICAgICAgICAgICAgICAgZGVmYXVsdF90ZXh0PXNlbGYucnNfc2V0dGluZ3MuZ2V0KGZpZWxkKSBvciAnJwogICAgICAgICAgICApLnRvX2pzb24oKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHB1dF9kYXRhKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fb25fc2F2ZSc6CiAgICAgICAgICAgIHNhdmVfZGF0YSA9IHsKICAgICAgICAgICAgICAgICdUaXRsZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnVGl0bGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0NhcmRUaXRsZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnQ2FyZFRpdGxlVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdDYXJkVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydDYXJkVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdDYXJkRGF0ZVRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnQ2FyZERhdGVUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ0dvb2RzQ2FyZFRpdGxlVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydHb29kc0NhcmRUaXRsZVRleHRTaXplJ10sCiAgICAgICAgICAgICAgICAnZ29vZHNUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ2dvb2RzVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiBzZWxmLmhhc2hfbWFwWydTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnXSwKICAgICAgICAgICAgICAgICdEb2NUeXBlQ2FyZFRleHRTaXplJzogc2VsZi5oYXNoX21hcFsnRG9jVHlwZUNhcmRUZXh0U2l6ZSddLAogICAgICAgICAgICAgICAgJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSc6IHNlbGYuaGFzaF9tYXBbJ3RpdGxlRG9jVHlwZUNhcmRUZXh0U2l6ZSddLAogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgaywgdiBpbiBzYXZlX2RhdGEuaXRlbXMoKToKICAgICAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KGssIHYsIFRydWUpCgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnYnRuX29uX2NhbmNlbCcgb3Igc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JhY2tTY3JlZW4nLCAnJykKCiAgICAgICAgc2VsZi5oYXNoX21hcFsnbm9SZWZyZXNoJ10gPSAnJwoKICAgIGRlZiBvbl9wb3N0X3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgc2hvdyhzZWxmLCBhcmdzPU5vbmUpOgogICAgICAgIHBhc3MKCgpjbGFzcyBCYXJjb2RlVGVzdFNjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0KLQtdGB0YIg0YHQutCw0L3QtdGA0LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2JhcmNvZGUnOiBzZWxmLl9iYXJjb2RlX3NjYW5uZWQsCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ0JBQ0tfQlVUVE9OJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnQmFja1NjcmVlbicsICcnKQoKICAgIGRlZiBfYmFyY29kZV9zY2FubmVkKHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKQogICAgICAgIGlmIG5vdCBiYXJjb2RlOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgYmFyY29kZV9wYXJzZXIgPSBCYXJjb2RlV29ya2VyKGlkX2RvYz0nJykKICAgICAgICByZXN1bHQgPSBiYXJjb2RlX3BhcnNlci5wYXJzZShiYXJjb2RlKQogICAgICAgIGZpZWxkc19jb3VudCA9IDcKCiAgICAgICAga2V5c19saXN0ID0gWydFUlJPUicsICdHVElOJywgJ1NFUklBTCcsICdGdWxsQ29kZScsICdCQVJDT0RFJywgJ1NDSEVNRScsICdFWFBJUlknLCAnQkFUQ0gnLCAnTkhSTicsICdDSEVDSycsCiAgICAgICAgICAgICAgICAgICAgICdXRUlHSFQnLCAnUFBOJ10KCiAgICAgICAgdmFsdWVzID0gW2Yne2tleX06IHtyZXN1bHRba2V5XX0nIGZvciBrZXkgaW4ga2V5c19saXN0IGlmIHJlc3VsdC5nZXQoa2V5KSBpcyBub3QgTm9uZV0KCiAgICAgICAgcHV0X2RhdGEgPSB7CiAgICAgICAgICAgIGYnZmxkX3tpICsgMX0nOiB2YWx1ZXNbaV0gaWYgbGVuKHZhbHVlcykgPiBpIGVsc2UgJycKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMCwgZmllbGRzX2NvdW50KQogICAgICAgIH0KCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCgpjbGFzcyBIdHRwU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ9Cd0LDRgdGC0YDQvtC50LrQuCBodHRwINGB0L7QtdC00LjQvdC10L3QuNGPJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmhzX3NlcnZpY2UgPSBOb25lCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnYnRuX3Rlc3RfY29ubmVjdGlvbiddID0gJ9Ci0LXRgdGCINGB0L7QtdC00LjQvdC10L3QuNGPJwogICAgICAgIGh0dHBfc2V0dGluZ3MgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCgogICAgICAgIHB1dF9kYXRhID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSfQkNC00YDQtdGBINGB0LXRgNCy0LXRgNCwJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VybCddIG9yICcnKSwKICAgICAgICAgICAgJ3VzZXInOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9Cf0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCcsIGRlZmF1bHRfdGV4dD1odHRwX3NldHRpbmdzWyd1c2VyJ10gb3IgJycpLAogICAgICAgICAgICAncGFzcyc6IHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0n0J/QsNGA0L7Qu9GMJywgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3Bhc3MnXSBvciAnJywgcGFzc3dvcmQ9VHJ1ZSksCiAgICAgICAgICAgICd1c2VyX25hbWUnOiBzZWxmLl9nZXRfbW9kZXJuX2ZpZWxkKGhpbnQ9J9CS0LDRiNC1INC40LzRjyDQtNC70Y8g0LjQtNC10L3RgtC40YTQuNC60LDRhtC40Lgg0LIgMdChJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdF90ZXh0PWh0dHBfc2V0dGluZ3NbJ3VzZXJfbmFtZSddIG9yICcnKSwKICAgICAgICB9CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXRfZGF0YShwdXRfZGF0YSkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fdGVzdF9jb25uZWN0aW9uJzogc2VsZi5fdGVzdF9jb25uZWN0aW9uLAogICAgICAgICAgICAnYnRuX3NhdmUnOiBzZWxmLl9zYXZlX3NldHRpbmdzLAogICAgICAgICAgICAnYmFyY29kZSc6IHNlbGYuX2JhcmNvZGVfc2Nhbm5lZCwKICAgICAgICAgICAgJ2J0bl9jYW5jZWwnOiBzZWxmLl9iYWNrX3NjcmVlbiwKICAgICAgICAgICAgJ09OX0JBQ0tfUFJFU1NFRCc6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgogICAgZGVmIF90ZXN0X2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkpCgogICAgICAgIGlmIHNlbGYuX2NoZWNrX2h0dHBfc2V0dGluZ3MoKToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTMpCiAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYuaHNfc2VydmljZS5odHRwX2Fuc3dlcgoKICAgICAgICAgICAgaWYgcmVzdWx0LnVuYXV0aG9yaXplZDoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Ce0YjQuNCx0LrQsCDQsNCy0YLQvtGA0LjQt9Cw0YbQuNC4INGB0LXRgNCy0LXRgNCwIDHQoScpCiAgICAgICAgICAgIGVsaWYgcmVzdWx0LmZvcmJpZGRlbjoKICAgICAgICAgICAgICAgIHNlbGYudG9hc3QoJ9CX0LDQv9GA0L7RgSDQvdCwINCw0LLRgtC+0YDQuNC30LDRhtC40Y4g0L/RgNC40L3Rj9GCJykKICAgICAgICAgICAgZWxpZiByZXN1bHQuZXJyb3I6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQndC1INGD0LTQsNC70L7RgdGMINGD0YHRgtCw0L3QvtCy0LjRgtGMINGB0L7QtdC00LjQvdC10L3QuNC1JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnRvYXN0KCfQodC+0LXQtNC40L3QtdC90LjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC+JykKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdzdWNjZXNzJykKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi50b2FzdCgi0J3QtSDRg9C60LDQt9Cw0L3RiyDQvdCw0YHRgtGA0L7QudC60LggSFRUUCDQv9C+0LTQutC70Y7Rh9C10L3QuNGPINC6INGB0LXRgNCy0LXRgNGDIikKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ2Vycm9yJykKCiAgICBkZWYgX3NhdmVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VSTCcsIHNlbGYuaGFzaF9tYXBbJ3VybCddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVU0VSJywgc2VsZi5oYXNoX21hcFsndXNlciddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdQQVNTJywgc2VsZi5oYXNoX21hcFsncGFzcyddLCBUcnVlKQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBzZWxmLmhhc2hfbWFwWyd1c2VyX25hbWUnXSwgVHJ1ZSkKCiAgICAgICAgc2VsZi5fYmFja19zY3JlZW4oKQoKICAgIGRlZiBfYmFyY29kZV9zY2FubmVkKHNlbGYpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEyJykKICAgICAgICB0cnk6CiAgICAgICAgICAgIGJhcmNfc3RydWN0ID0ganNvbi5sb2FkcyhiYXJjb2RlKQoKICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ1VSTCcsIGJhcmNfc3RydWN0LmdldCgndXJsJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdVU0VSJywgYmFyY19zdHJ1Y3QuZ2V0KCd1c2VyJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdQQVNTJywgYmFyY19zdHJ1Y3QuZ2V0KCdwYXNzJyksIFRydWUpCiAgICAgICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCd1c2VyX25hbWUnLCBiYXJjX3N0cnVjdC5nZXQoJ3VzZXJfbmFtZScpLCBUcnVlKQoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VybCcsIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXJsJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgndXJsJykpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgndXNlcicsIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXNlcicsIGRlZmF1bHRfdGV4dD1iYXJjX3N0cnVjdC5nZXQoJ3VzZXInKSkpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdwYXNzJywgc2VsZi5fZ2V0X21vZGVybl9maWVsZChoaW50PSdwYXNzJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgncGFzcycpKSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3VzZXJfbmFtZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2dldF9tb2Rlcm5fZmllbGQoaGludD0ndXNlcl9uYW1lJywgZGVmYXVsdF90ZXh0PWJhcmNfc3RydWN0LmdldCgndXNlcl9uYW1lJykpKQogICAgICAgIGV4Y2VwdCAoSlNPTkRlY29kZUVycm9yLCBBdHRyaWJ1dGVFcnJvcikgYXMgZToKICAgICAgICAgICAgc2VsZi50b2FzdCgn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIgUVIt0LrQvtC00LAnKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0JhY2tTY3JlZW4nLCAnJykKCiAgICBkZWYgX2dldF9tb2Rlcm5fZmllbGQoc2VsZiwgKipkYXRhKToKICAgICAgICByZXR1cm4gd2lkZ2V0cy5Nb2Rlcm5GaWVsZCgqKmRhdGEpLnRvX2pzb24oKQoKICAgIGRlZiBfY2hlY2tfaHR0cF9zZXR0aW5ncyhzZWxmKSAtPiBib29sOgogICAgICAgIGh0dHAgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgcmV0dXJuIGFsbChbaHR0cC5nZXQoJ3VybCcpLCBodHRwLmdldCgndXNlcicpLCBodHRwLmdldCgncGFzcycpXSkKCiAgICBkZWYgX2dldF9odHRwX3NldHRpbmdzKHNlbGYpOgogICAgICAgIGh0dHBfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICd1cmwnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgiVVJMIiksCiAgICAgICAgICAgICd1c2VyJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1VTRVInKSwKICAgICAgICAgICAgJ3Bhc3MnOiBzZWxmLnJzX3NldHRpbmdzLmdldCgnUEFTUycpLAogICAgICAgICAgICAnZGV2aWNlX21vZGVsJzogc2VsZi5oYXNoX21hcFsnREVWSUNFX01PREVMJ10sCiAgICAgICAgICAgICdhbmRyb2lkX2lkJzogc2VsZi5oYXNoX21hcFsnQU5EUk9JRF9JRCddLAogICAgICAgICAgICAndXNlcl9uYW1lJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3VzZXJfbmFtZScpfQogICAgICAgIHJldHVybiBodHRwX3NldHRpbmdzCgoKY2xhc3MgU291bmRTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutCwINC30LLRg9C60LAnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuZXZlbnRzID0geydzdWNjZXNzJzogJ9Ch0LjQs9C90LDQuyDRg9C00LDRh9C90L7Qs9C+INGB0L7QsdGL0YLQuNGPJywgJ3dhcm5pbmcnOiAn0KHQuNCz0L3QsNC7INC/0YDQtdC00YPQv9GA0LXQttC00LXQvdC40Y8nLAogICAgICAgICAgICAgICAgICAgICAgICdlcnJvcic6ICfQodC40LPQvdCw0Lsg0L7RiNC40LHQutC4J30KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5faW5pdF9zb3VuZHMoKQogICAgICAgIGV2ZW50c19kYXRhID0gc2VsZi5fZ2V0X2V2ZW50c19kYXRhKCkKICAgICAgICBldmVudHNfY2FyZHMgPSBzZWxmLl9nZXRfZXZlbnRfY2FyZHNfdmlldyhldmVudHNfZGF0YSwgcG9wdXBfbWVudV9kYXRhPScxOzI7Mzs0OzU7Njs3Ozg7OTsxMDsxMTsxMjsxMzsxNDsxNScpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2V2ZW50X2NhcmRzJywgZXZlbnRzX2NhcmRzLnRvX2pzb24oKSkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnc2F2ZV9idG4nOgogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnc3VjY2Vzc19zaWduYWwnLCBzZWxmLmhhc2hfbWFwLmdldCgiY3VycmVudF9zdWNjZXNzX3NpZ25hbCIpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnd2FybmluZ19zaWduYWwnLCBzZWxmLmhhc2hfbWFwLmdldCgiY3VycmVudF93YXJuaW5nX3NpZ25hbCIpLCBUcnVlKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZXJyb3Jfc2lnbmFsJywgc2VsZi5oYXNoX21hcC5nZXQoImN1cnJlbnRfZXJyb3Jfc2lnbmFsIiksIFRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuc2hvd19zY3JlZW4oJ9Cd0LDRgdGC0YDQvtC50LrQuCDQuCDQvtCx0LzQtdC9JykKICAgICAgICAgICAgIyBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICAgICAgZWxpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fb25fY2FuY2VsJyBvciBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9zdWNjZXNzX3NpZ25hbCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF93YXJuaW5nX3NpZ25hbCcsICcnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9lcnJvcl9zaWduYWwnLCAnJykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ0NhcmRzQ2xpY2snOgogICAgICAgICAgICBzZWxlY3RlZF9ldmVudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdzZWxlY3RlZF9jYXJkX2tleScpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKGV2ZW50PXNlbGVjdGVkX2V2ZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VuZF92YWw9c2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3tzZWxlY3RlZF9ldmVudH1fc2lnbmFsJykpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnTGF5b3V0QWN0aW9uJzoKICAgICAgICAgICAgc2VsZi5fbGF5b3V0X2FjdGlvbigpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5pdF9zb3VuZHMoc2VsZik6CiAgICAgICAgIyBmb3Iga2V5LCB2YWwgaW4gc2VsZi5ldmVudHMuaXRlbXMoKToKICAgICAgICAjICAgICBpZiBub3Qgc2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3trZXl9X3NpZ25hbCcpOgogICAgICAgICMgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dChmJ2N1cnJlbnRfe2tleX1fc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoZid7ZXZlbnR9X3NpZ25hbCcgb3IgIjYiKSkKCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3N1Y2Nlc3Nfc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3N1Y2Nlc3Nfc2lnbmFsJykpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X3dhcm5pbmdfc2lnbmFsJyk6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdjdXJyZW50X3dhcm5pbmdfc2lnbmFsJywgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ3dhcm5pbmdfc2lnbmFsJykpCiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdjdXJyZW50X2Vycm9yX3NpZ25hbCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnY3VycmVudF9lcnJvcl9zaWduYWwnLCBzZWxmLnJzX3NldHRpbmdzLmdldCgnZXJyb3Jfc2lnbmFsJykpCgogICAgZGVmIF9nZXRfZXZlbnRzX2RhdGEoc2VsZik6CiAgICAgICAgZGF0YSA9IFtdCiAgICAgICAgZm9yIGtleSwgdmFsIGluIHNlbGYuZXZlbnRzLml0ZW1zKCk6CiAgICAgICAgICAgIGV2ZW50ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IGtleSwKICAgICAgICAgICAgICAgICdldmVudF9uYW1lJzogdmFsLAogICAgICAgICAgICAgICAgJ3NlbGVjdGVkX3ZhbHVlJzogc2VsZi5oYXNoX21hcC5nZXQoZidjdXJyZW50X3trZXl9X3NpZ25hbCcpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGF0YS5hcHBlbmQoZXZlbnQpCiAgICAgICAgcmV0dXJuIGRhdGEKCiAgICBkZWYgX2dldF9ldmVudF9jYXJkc192aWV3KHNlbGYsIGV2ZW50c19kYXRhLCBwb3B1cF9tZW51X2RhdGEpOgogICAgICAgIHRpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJUaXRsZVRleHRTaXplIikKICAgICAgICBjYXJkX3RpdGxlX3RleHRfc2l6ZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCJDYXJkVGl0bGVUZXh0U2l6ZSIpCiAgICAgICAgZG9jX2NhcmRzID0gd2lkZ2V0cy5DdXN0b21DYXJkcygKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGV2ZW50X25hbWUnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT10aXRsZV90ZXh0X3NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0wCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0BzZWxlY3RlZF92YWx1ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTI4LAogICAgICAgICAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfc2VsZWN0X3NvdW5kIiwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9ItCf0YDQvtGB0LvRg9GI0LDRgtGMIiwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0eV9ob3Jpem9udGFsPSdjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSd2ZXJ0aWNhbCcsCiAgICAgICAgICAgICAgICBncmF2aXR5X2hvcml6b250YWw9J2NlbnRlcicsCiAgICAgICAgICAgICAgICBncmF2aXR5X3ZlcnRpY2FsPSJjZW50ZXIiLAogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT1ldmVudHNfZGF0YQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIGRvY19jYXJkcwoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKToKICAgICAgICBsYXlvdXRfbGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmdldCgnbGF5b3V0X2xpc3RlbmVyJykKICAgICAgICBjdXJyZW50X2tleSA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oImNhcmRfZGF0YSIpWydrZXknXQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYnY3VycmVudF97Y3VycmVudF9rZXl9X3NpZ25hbCcsIGxheW91dF9saXN0ZW5lcikKCgpjbGFzcyBEb2N1bWVudHNTZXR0aW5ncyhTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0J3QsNGB0YLRgNC+0LnQutC4INC00L7QutGD0LzQtdC90YLQvtCyJwogICAgcHJvY2Vzc19uYW1lID0gJ9Cf0LDRgNCw0LzQtdGC0YDRiycKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuY29udGFpbnNLZXkoJ2RvY19zZXR0aW5nc19vbl9zdGFydCcpOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3NldHRpbmdzX29uX3N0YXJ0JywgJ3RydWUnKQogICAgICAgICAgICBzZWxmLl9pbml0X29sZF9kb2NfZGVsZXRlX3NldHRpbmdzKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZik6CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciA9PSAnc2F2ZV9idG4nOgogICAgICAgICAgICBkZWxfZG9jc19mbGFnID0gc2VsZi5oYXNoX21hcC5nZXQoJ2RvY19zZXR0aW5nc19jb25maXJtX2RlbGV0ZV9vbGRfZG9jcycpCiAgICAgICAgICAgIGRlbF9kb2NzX2ZsYWcgPSBUcnVlIGlmIGRlbF9kb2NzX2ZsYWcgPT0gJ3RydWUnIGVsc2UgRmFsc2UKICAgICAgICAgICAgaWYgbm90IGRlbF9kb2NzX2ZsYWc6CiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZGVsZXRlX29sZF9kb2NzJywgRmFsc2UsIFRydWUpCiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLmRlbGV0ZSgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRheXMgPSBzZWxmLmhhc2hfbWFwLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICAgICAgICAgIGlmIG5vdCBkYXlzIG9yIGRheXMgPT0gJzAnIG9yIG5vdCBkYXlzLmlzZGlnaXQoKToKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cj0LrQsNC20LjRgtC1INC60L7RgNGA0LXQutGC0L3QvtC1INC60L7Qu9C40YfQtdGB0YLQstC+INC00L3QtdC5JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyDQtNC70Y8g0L3QsNGB0YLRgNC+0LnQutC4INGD0LTQsNC70LXQvdC40Y8g0YHRgtCw0YDRi9GFINC00L7QutGD0LzQtdC90YLQvtCyJykKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGlmIGRheXMgPj0gJzk5OTknOgogICAgICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JrQvtC70LjRh9C10YHRgtCy0L4g0LTQvdC10Lkg0L/RgNC10LLRi9GI0LDQtdGCIDk5OTknKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5yc19zZXR0aW5ncy5wdXQoJ2RlbGV0ZV9vbGRfZG9jcycsIFRydWUsIFRydWUpCiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJywgZGF5cywgVHJ1ZSkKCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cd0LDRgdGC0YDQvtC50LrQuCDRgdC+0YXRgNCw0L3QtdC90YsnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmRlbGV0ZSgnZG9jX3NldHRpbmdzX29uX3N0YXJ0JykKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3NjcmVlbign0J3QsNGB0YLRgNC+0LnQutC4INC4INC+0LHQvNC10L0nKQoKICAgICAgICBlbGlmIHNlbGYubGlzdGVuZXIgPT0gJ09OX0JBQ0tfUFJFU1NFRCc6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZGVsZXRlKCdkb2Nfc2V0dGluZ3Nfb25fc3RhcnQnKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKCfQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvScpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5pdF9vbGRfZG9jX2RlbGV0ZV9zZXR0aW5ncyhzZWxmKToKICAgICAgICBjdXJyZW50X2RheXNfdmFsdWUgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykKICAgICAgICBpbml0X2RheXMgPSBzdHIoY3VycmVudF9kYXlzX3ZhbHVlKSBpZiBjdXJyZW50X2RheXNfdmFsdWUgaXMgbm90IE5vbmUgZWxzZSAnMScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJywgaW5pdF9kYXlzKQoKICAgICAgICBmbGFnID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9vbGRfZG9jcycpCiAgICAgICAgaW5pdF9mbGFnID0gc3RyKGZsYWcpLmxvd2VyKCkgaWYgZmxhZyBpcyBub3QgTm9uZSBlbHNlICdmYWxzZScKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnZG9jX3NldHRpbmdzX2NvbmZpcm1fZGVsZXRlX29sZF9kb2NzJywgaW5pdF9mbGFnKQoKCmNsYXNzIEVycm9yTG9nU2NyZWVuKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQntGI0LjQsdC60LgnCiAgICBwcm9jZXNzX25hbWUgPSAn0J/QsNGA0LDQvNC10YLRgNGLJwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCwgcnNfc2V0dGluZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXAsIHJzX3NldHRpbmdzKQogICAgICAgIHNlbGYuc2VydmljZSA9IExvZ2dlclNlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5kZXNjX3NvcnQgPSBUcnVlCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgZXJyb3JzX3RhYmxlX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2FsbF9lcnJvcnMoc2VsZi5kZXNjX3NvcnQpCiAgICAgICAgdGFibGVfcmF3cyA9IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfcm93cyhlcnJvcnNfdGFibGVfZGF0YSkKICAgICAgICB0YWJsZV92aWV3ID0gc2VsZi5fZ2V0X2Vycm9yc190YWJsZV92aWV3KHRhYmxlX3Jhd3MpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoImVycm9yX2xvZ190YWJsZSIsIHRhYmxlX3ZpZXcudG9fanNvbigpKQogICAgICAgIHNlbGYuaGFzaF9tYXBbJ2RhdGVfc29ydF9zZWxlY3QnXSA9ICfQndC+0LLRi9C1O0PRgtCw0YDRi9C1JwoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICJidG5fY2xlYXJfZXJyIjoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmNsZWFyKCkKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdPTl9CQUNLX1BSRVNTRUQnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2hvd1NjcmVlbiIsICLQndCw0YHRgtGA0L7QudC60Lgg0Lgg0L7QsdC80LXQvSIpCgogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAiZGF0ZV9zb3J0X2NsaWNrIjoKICAgICAgICAgICAgc2VsZi5kZXNjX3NvcnQgPSBub3Qgc2VsZi5kZXNjX3NvcnQKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBzZWxmLl92YWxpZGF0ZV9zY3JlZW5fdmFsdWVzKCkKICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfc2NyZWVuKHNlbGYuc2NyZWVuX25hbWUsIGFyZ3MpCgogICAgZGVmIF9nZXRfZXJyb3JzX3RhYmxlX3Jvd3Moc2VsZiwgZXJyb3JzX3RhYmxlX2RhdGEpOgogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgaSA9IDEKICAgICAgICBmb3IgcmVjb3JkIGluIGVycm9yc190YWJsZV9kYXRhOgogICAgICAgICAgICBlcnJvcl9yb3cgPSB7ImtleSI6IGksICJtZXNzYWdlIjogcmVjb3JkWydlcnJvcl90ZXh0J10sCiAgICAgICAgICAgICAgICAgICAgICAgICAidGltZSI6IERhdGVGb3JtYXQoKS5nZXRfdGFibGVfdmlld19mb3JtYXQocmVjb3JkWyd0aW1lc3RhbXAnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAnX2xheW91dCc6IHNlbGYuX2dldF9lcnJvcnNfdGFibGVfcm93X2xheW91dCgpfQogICAgICAgICAgICB0YWJsZV9kYXRhLmFwcGVuZChlcnJvcl9yb3cpCiAgICAgICAgICAgIGkgKz0gMQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2Vycm9yc190YWJsZV92aWV3KHNlbGYsIHRhYmxlX3Jvd3MpOgogICAgICAgIHRhYmxlX3ZpZXcgPSB3aWRnZXRzLkN1c3RvbVRhYmxlKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9CS0YDQtdC80Y8nKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHNlbGYuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ9Ch0L7QvtCx0YnQtdC90LjQtScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0zCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgb3JpZW50YXRpb249J2hvcml6b250YWwnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgd2lkdGg9Im1hdGNoX3BhcmVudCIsCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9wdGlvbnM9d2lkZ2V0cy5PcHRpb25zKCkub3B0aW9ucywKICAgICAgICAgICAgdGFibGVkYXRhPXRhYmxlX3Jvd3MKICAgICAgICApCiAgICAgICAgcmV0dXJuIHRhYmxlX3ZpZXcKCiAgICBkZWYgX2dldF9lcnJvcnNfdGFibGVfcm93X2xheW91dChzZWxmKToKICAgICAgICByb3dfdmlldyA9IHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B0aW1lJywKICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT0xNSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JwogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQG1lc3NhZ2UnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSd3cmFwX2NvbnRlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTMsCiAgICAgICAgICAgICksCiAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcj0nI0ZGRkZGRicsCiAgICAgICAgICAgIGhlaWdodD0nd3JhcF9jb250ZW50JywKICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICkKCiAgICAgICAgcmV0dXJuIHJvd192aWV3CgogICAgY2xhc3MgTGluZWFyTGF5b3V0KHdpZGdldHMuTGluZWFyTGF5b3V0KToKICAgICAgICBkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqYXJncywgKiprd2FyZ3MpCiAgICAgICAgICAgIHNlbGYub3JpZW50YXRpb24gPSAndmVydGljYWwnCiAgICAgICAgICAgIHNlbGYuaGVpZ2h0ID0gIm1hdGNoX3BhcmVudCIKICAgICAgICAgICAgc2VsZi53aWR0aCA9ICJtYXRjaF9wYXJlbnQiCiAgICAgICAgICAgIHNlbGYuU3Ryb2tlV2lkdGggPSAxCgogICAgY2xhc3MgVGV4dFZpZXcod2lkZ2V0cy5UZXh0Vmlldyk6CiAgICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIHZhbHVlKToKICAgICAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgICAgIHNlbGYuVGV4dFNpemUgPSAnMTUnCiAgICAgICAgICAgIHNlbGYuVGV4dEJvbGQgPSBUcnVlCiAgICAgICAgICAgIHNlbGYud2lkdGggPSAnbWF0Y2hfcGFyZW50JwogICAgICAgICAgICBzZWxmLlZhbHVlID0gdmFsdWUKCgojIF5eXl5eXl5eXl5eXl5eXl5eXl5eXiBTZXR0aW5ncyBeXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eCgoKIyA9PT09PT09PT09PT09PT09PT09PSBEZWJ1ZyBzZXR0aW5ncyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCmNsYXNzIERlYnVnU2V0dGluZ3NTY3JlZW4oU2NyZWVuKToKICAgIHByb2Nlc3NfbmFtZSA9ICfQntGC0LvQsNC00LrQsCcKICAgIHNjcmVlbl9uYW1lID0gJ9Ce0YLQu9Cw0LTQvtGH0L3Ri9C5INGN0LrRgNCw0L0nCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5oc19zZXJ2aWNlID0gaHNfc2VydmljZXMuRGVidWdTZXJ2aWNlCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIGRlYnVnX2hvc3RfaXAgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnZGVidWdfaG9zdF9pcCcpIG9yIHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KAogICAgICAgICAgICAnaXBfaG9zdCcsCiAgICAgICAgICAgIHsnaGludCc6ICdJUC3QsNC00YDQtdGBINC00LvRjyDQstGL0LPRgNGD0LfQutC4INCx0LDQt9GLL9C70L7Qs9CwJywgJ2RlZmF1bHRfdGV4dCc6IGRlYnVnX2hvc3RfaXAgb3IgJyd9LAogICAgICAgICAgICB0b19qc29uPVRydWUpCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ2J0bl9maWxsX3JhdGlvJzogc2VsZi5fZmlsbF9yYXRpbywKICAgICAgICAgICAgJ2J0bl9jb3B5X2Jhc2UnOiBzZWxmLl9jb3B5X2Jhc2UsCiAgICAgICAgICAgICdidG5fdW5sb2FkX2xvZyc6IHNlbGYuX3VubG9hZF9sb2csCiAgICAgICAgICAgICdidG5fdGVtcGxhdGVzJzogc2VsZi5vcGVuX3RlbXBsYXRlc19zY3JlZW4sCiAgICAgICAgICAgICdPTl9CQUNLX1BSRVNTRUQnOiBzZWxmLl9vbl9iYWNrX3ByZXNzZWQKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfZmlsbF9yYXRpbyhzZWxmKToKICAgICAgICBxdGV4dCA9ICcnJwogICAgICAgIFVQREFURSBSU19iYXJjb2RlcwogICAgICAgIFNFVCByYXRpbyA9IENPQUxFU0NFKCgKICAgICAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvciAvIFJTX3VuaXRzLmRlbm9taW5hdG9yCiAgICAgICAgICAgIEZST00gUlNfdW5pdHMKICAgICAgICAgICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICAgICAgKSwgMSknJycKCiAgICAgICAgcmVzID0gdWlfZ2xvYmFsLmdldF9xdWVyeV9yZXN1bHQocXRleHQpCiAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0KLQsNCx0LvQuNGG0LAg0LHQsNGA0LrQvtC00L7QsiDQt9Cw0L/QvtC70L3QtdC90LAg0LfQvdCw0YfQtdC90LjRj9C80Lgg0LjQtyDQtdC00LjQvdC40YYg0LjQt9C80LXRgNC10L3QuNGPJykKCiAgICBkZWYgX2NvcHlfYmFzZShzZWxmKToKICAgICAgICBpcF9ob3N0ID0gc2VsZi5oYXNoX21hcFsnaXBfaG9zdCddCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdzcWxpdGVfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGZpbGVfcGF0aCk6CiAgICAgICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGY6CiAgICAgICAgICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2RhdGFiYXNlKGYpCgogICAgICAgICAgICAgICAgaWYgcmVzWydzdGF0dXNfY29kZSddID09IDIwMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQkdCw0LfQsCBTUUxpdGUg0YPRgdC/0LXRiNC90L4g0LLRi9Cz0YDRg9C20LXQvdCwJykKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQpNCw0LnQuyDQvdC1INC90LDQudC00LXQvScpCgogICAgZGVmIF91bmxvYWRfbG9nKHNlbGYpOgogICAgICAgIGlwX2hvc3QgPSBzZWxmLmhhc2hfbWFwWydpcF9ob3N0J10KCiAgICAgICAgcGF0aF90b19kYXRhYmFzZXMgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIGJhc2VfbmFtZSA9IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdsb2dfbmFtZScpCiAgICAgICAgZmlsZV9wYXRoID0gb3MucGF0aC5qb2luKHBhdGhfdG9fZGF0YWJhc2VzLCBiYXNlX25hbWUpCgogICAgICAgICMgVE9ETyDQl9C00LXRgdGMINC90YPQttC90L4g0LHRg9C00LXRgiDQstGL0LfRi9Cy0LDRgtGMINC60LvQsNGB0YEt0YHQtdGA0LLQuNGBINC00LvRjyDQstC30LDQuNC80L7QtNC10LnRgdGC0LLQuNGPINGBIFRpbnlEQgogICAgICAgIGZyb20gdGlueWRiIGltcG9ydCBUaW55REIKCiAgICAgICAgZGIgPSBUaW55REIoZmlsZV9wYXRoKQogICAgICAgIGRhdGEgPSBkYi5hbGwoKQoKICAgICAgICByZXMgPSBzZWxmLmhzX3NlcnZpY2UoaXBfaG9zdCkuZXhwb3J0X2xvZyhkYXRhKQogICAgICAgIGlmIHJlc1snc3RhdHVzX2NvZGUnXSA9PSAyMDA6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Cb0L7QsyDRg9GB0L/QtdGI0L3QviDQstGL0LPRgNGD0LbQtdC9JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KCfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8nKQogICAgZGVmIF9vbl9iYWNrX3ByZXNzZWQoc2VsZik6CiAgICAgICAgaXBfaG9zdCA9IHNlbGYuaGFzaF9tYXBbJ2lwX2hvc3QnXQogICAgICAgIHNlbGYucnNfc2V0dGluZ3MucHV0KCdkZWJ1Z19ob3N0X2lwJywgaXBfaG9zdCwgVHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnRmluaXNoUHJvY2VzcycsICcnKQoKICAgIGRlZiBvcGVuX3RlbXBsYXRlc19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X3Byb2Nlc3NfcmVzdWx0KCfQn9C10YfQsNGC0YwnLCAn0KHQv9C40YHQvtC6INGI0LDQsdC70L7QvdC+0LInKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIERlYnVnIHNldHRpbmdzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCiMgPT09PT09PT09PT09PT09PT09PT0gQWN0aXZlQ1YgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEFjdGl2ZUNWQXJ0aWNsZVJlY29nbml0aW9uKFNjcmVlbik6CiAgICBzY3JlZW5fbmFtZSA9ICfQndC+0LLRi9C5INGI0LDQsyBBY3RpdmVDVicKICAgIHByb2Nlc3NfbmFtZSA9ICfQoNCw0YHQv9C+0LfQvdCw0LLQsNC90LjQtSDQsNGA0YLQuNC60YPQu9C+0LInCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCByc19zZXR0aW5ncyk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXyhoYXNoX21hcCwgcnNfc2V0dGluZ3MpCiAgICAgICAgc2VsZi5pZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydpZF9kb2MnXQogICAgICAgIHNlbGYuc2VydmljZSA9IERvY1NlcnZpY2Uoc2VsZi5pZF9kb2MpCiAgICAgICAgc2VsZi5hcnRpY2xlc19vY3JfbmNsID0gbm9DbGFzcygnYXJ0aWNsZXNfb2NyX25jbCcpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5kZWxldGUoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2FydF9pbmZvJywgJ9Cd0LDQudC00LXQvdC90YvQtSDQsNGA0YLQuNC60YPQu9GLOiAnKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICfQntCx0YDQsNCx0L7RgtCw0YLRjCc6CiAgICAgICAgICAgIHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5wdXQoJ2J1dHRvbl9tYW5hZ2VfYXJ0aWNsZXMnLCBUcnVlLCBUcnVlKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLmZpbmlzaF9wcm9jZXNzKCkKCiAgICBkZWYgb25fb2JqZWN0X2RldGVjdGVkKHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAuYmVlcCgpCiAgICAgICAgY3VycmVudF9vYmplY3QgPSBzZWxmLmhhc2hfbWFwLmdldCgnY3VycmVudF9vYmplY3QnKQogICAgICAgIGZpbmRlZF9hcnRpY2xlcyA9IHNlbGYuYXJ0aWNsZXNfb2NyX25jbC5nZXQoJ2ZpbmRlZF9hcnRpY2xlcycpCiAgICAgICAgZmluZGVkX2FydGljbGVzID0ganNvbi5sb2FkcyhmaW5kZWRfYXJ0aWNsZXMpIGlmIGZpbmRlZF9hcnRpY2xlcyBlbHNlIFtdCiAgICAgICAgaWYgY3VycmVudF9vYmplY3Qgbm90IGluIGZpbmRlZF9hcnRpY2xlczoKICAgICAgICAgICAgZmluZGVkX2FydGljbGVzLmFwcGVuZChjdXJyZW50X29iamVjdCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICAgICAnYXJ0X2luZm8nLCAn0J3QsNC50LTQtdC90L3Ri9C1INCw0YDRgtC40LrRg9C70Ys6ICcgKyAnOycuam9pbihmaW5kZWRfYXJ0aWNsZXMpKQogICAgICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wucHV0KCdmaW5kZWRfYXJ0aWNsZXMnLCBqc29uLmR1bXBzKGZpbmRlZF9hcnRpY2xlcyksIFRydWUpCgogICAgICAgIGdvb2RfbmFtZSA9IHNlbGYuZ2V0X2dvb2RfaW5mbyhjdXJyZW50X29iamVjdCkKICAgICAgICBzZWxmLmhhc2hfbWFwLmFkZF90b19jdl9saXN0KAogICAgICAgICAgICB7J29iamVjdCc6IHN0cihjdXJyZW50X29iamVjdCksCiAgICAgICAgICAgICAnaW5mbyc6IGYn0KLQvtCy0LDRgDogPGJpZz57Z29vZF9uYW1lfTwvYmlnPid9LAogICAgICAgICAgICAnb2JqZWN0X2luZm9fbGlzdCcsIF9kaWN0PVRydWUpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXRfZ29vZF9pbmZvKHNlbGYsIGFydGljbGU6IHN0cikgLT4gc3RyOgogICAgICAgIHF1ZXJ5ID0gKCdTRUxFQ1QgUlNfZ29vZHMubmFtZSBhcyBuYW1lJwogICAgICAgICAgICAgICAgICcgRlJPTSBSU19kb2NzX3RhYmxlJwogICAgICAgICAgICAgICAgICcgTEVGVCBKT0lOIFJTX2dvb2RzIE9OIFJTX2RvY3NfdGFibGUuaWRfZ29vZCA9IFJTX2dvb2RzLmlkJwogICAgICAgICAgICAgICAgICcgV0hFUkUgUlNfZG9jc190YWJsZS5pZF9kb2MgPSA/IEFORCBSU19nb29kcy5hcnQgPSA/JykKICAgICAgICBnb29kcyA9IHNlbGYuc2VydmljZS5wcm92aWRlci5zcWxfcXVlcnkocXVlcnksIGYne3NlbGYuaWRfZG9jfSx7YXJ0aWNsZX0nKQogICAgICAgIHJldHVybiBnb29kc1swXVsnbmFtZSddIGlmIGdvb2RzIGVsc2UgJ9Cd0LUg0L3QsNC50LTQtdC90L4nCgogICAgZGVmIF9zZXRfdmlzaW9uX3NldHRpbmdzKHNlbGYpOgogICAgICAgIHNldHRpbmdzID0gc2VsZi5hcnRpY2xlc19vY3JfbmNsLmdldCgnYXJ0aWNsZXNfb2NyX3NldHRpbmdzJykKICAgICAgICBzZWxmLmhhc2hfbWFwLnNldF92aXNpb25fc2V0dGluZ3MoKipqc29uLmxvYWRzKHNldHRpbmdzKSkKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIEFjdGl2ZUNWIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IE9DUiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3MoU2NyZWVuKToKICAgIHNjcmVlbl9uYW1lID0gJ1NlcmlhbE51bWJlck9DUlNldHRpbmdzJwogICAgcHJvY2Vzc19uYW1lID0gJ09jclRleHRSZWNvZ25pdGlvbicKICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICBvY3Jfbm9zcWxfY291bnRlciA9IG5vQ2xhc3MoIm9jcl9ub3NxbF9jb3VudGVyIikKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwLCByc19zZXR0aW5ncykKICAgICAgICBzZWxmLmFydGljbGVzX29jcl9uY2wgPSBub0NsYXNzKCdhcnRpY2xlc19vY3JfbmNsJykKICAgICAgICBzZWxmLm9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgc2VsZi5zY3JlZW5fdGl0bGUgPSAn0KjQsNCx0LvQvtC9INGA0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIFMvTicKICAgICAgICBzZWxmLnNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX21pbl9yZWNfYW1vdW50JzogJzUnLAogICAgICAgICAgICAnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JzogJzEwJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JzogJ1NOJywKICAgICAgICAgICAgJ29jcl9zZXJpYWxfdGVtcGxhdGVfY29udGludW91c19yZWNvZ25pdGlvbic6ICdmYWxzZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnOiAndHJ1ZScsCiAgICAgICAgICAgICdvY3Jfc2VyaWFsX2N1cnJlbnRfdGVtcGxhdGUnOiAiIgogICAgICAgIH0KCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5zZXRfdGl0bGUoc2VsZi5zY3JlZW5fdGl0bGUpCiAgICAgICAgc2VsZi5fc2V0X3NjcmVlbl92YWx1ZXMoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyID09ICdidG5fc2F2ZV9vY3Jfc2V0dGluZ3MnOgogICAgICAgICAgICBpc192YWxpZCwgZXJyb3IgPSBzZWxmLl92YWxpZGF0ZV9vY3Jfc2V0dGluZ3MoKQogICAgICAgICAgICBpZiBub3QgaXNfdmFsaWQ6CiAgICAgICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnRvYXN0KGVycm9yKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIHNlbGYuX3NhdmVfdGVtcGxhdGVfcGF0dGVybnMoKQogICAgICAgICAgICBzZWxmLl9zYXZlX3RlbXBsYXRlX3NldHRpbmdzKCkKICAgICAgICAgICAgc2VsZi5fc2V0X3Zpc2lvbl9zZXR0aW5ncygpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QoJ9Co0LDQsdC70L7QvSDRgdC+0YXRgNCw0L3RkdC9JykKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgIGVsaWYgc2VsZi5saXN0ZW5lciA9PSAnT05fQkFDS19QUkVTU0VEJzoKICAgICAgICAgICAgaWYgc2VsZi5vY3Jfbm9zcWwuZ2V0KCdzaG93X3Byb2Nlc3NfcmVzdWx0Jyk6CiAgICAgICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5kZWxldGUoJ3Nob3dfcHJvY2Vzc19yZXN1bHQnKQogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2Vzc19yZXN1bHQoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5maW5pc2hfcHJvY2VzcygpCgogICAgZGVmIG9uX3Bvc3Rfc3RhcnQoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzaG93KHNlbGYsIGFyZ3M9Tm9uZSk6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfc2V0X3NjcmVlbl92YWx1ZXMoc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUsIHZhbHVlIGluIHNlbGYuc2NyZWVuX3ZhbHVlcy5pdGVtcygpOgogICAgICAgICAgICBuZXdfdmFsdWUgPSBzZWxmLmhhc2hfbWFwLmdldCh2YWx1ZV9uYW1lKSBvciBzZWxmLm9jcl9ub3NxbC5nZXQodmFsdWVfbmFtZSkgb3IgdmFsdWUKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQodmFsdWVfbmFtZSwgbmV3X3ZhbHVlKQoKCiAgICBkZWYgX3NhdmVfdGVtcGxhdGVfc2V0dGluZ3Moc2VsZik6CiAgICAgICAgZm9yIHZhbHVlX25hbWUgaW4gc2VsZi5zY3JlZW5fdmFsdWVzOgogICAgICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQodmFsdWVfbmFtZSwgc2VsZi5oYXNoX21hcC5nZXQodmFsdWVfbmFtZSksIFRydWUpCgogICAgZGVmIF9zYXZlX3RlbXBsYXRlX3BhdHRlcm5zKHNlbGYpOgogICAgICAgIG51bV9hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50JykKICAgICAgICBwcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wcmVmaXgnKQogICAgICAgIHVzZV9wcmVmaXggPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBpZiB1c2VfcHJlZml4ID09ICd0cnVlJzoKICAgICAgICAgICAgcGF0dGVybnMgPSBbcmYnXntwcmVmaXh9JywgcmYnKFteXGRvT10pKFxke3t7bnVtX2Ftb3VudH19fSkkJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICBwYXR0ZXJucyA9IFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGN1cnJlbnRfdGVtcGxhdGUgPSAoZifQotC10LrRg9GJ0LjQuSDRiNCw0LHQu9C+0L06IHtwcmVmaXggaWYgdXNlX3ByZWZpeCA9PSAidHJ1ZSIgZWxzZSAiIn0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmJ3siKiIgKiBpbnQobnVtX2Ftb3VudCl9JykKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnb2NyX3NlcmlhbF9jdXJyZW50X3RlbXBsYXRlJywgY3VycmVudF90ZW1wbGF0ZSkKICAgICAgICBzZWxmLm9jcl9ub3NxbC5wdXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcGF0dGVybnMnLCBqc29uLmR1bXBzKHBhdHRlcm5zKSwgVHJ1ZSkKCiAgICBkZWYgX3NldF92aXNpb25fc2V0dGluZ3Moc2VsZikgLT4gTm9uZToKICAgICAgICAiIiLQo9GB0YLQsNC90LDQstC70LjQstCw0LXRgiDQvdCw0YHRgtGA0L7QudC60Lgg0LTQu9GPINC60L3QvtC/0LrQuCDRgNCw0YHQv9C+0LfQvdCw0LLQsNC90LjRjyDRgtC10LrRgdGC0LAiIiIKICAgICAgICBudW1fYW1vdW50ID0gaW50KHNlbGYub2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9udW1fYW1vdW50Jykgb3IgJzEwJykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5vY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX3VzZV9wcmVmaXgnKQogICAgICAgIGlmIHVzZV9wcmVmaXggPT0gJ3RydWUnOgogICAgICAgICAgICBwcmVmaXggPSBzZWxmLm9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICAgICAgbWluX2xlbmd0aCA9IG51bV9hbW91bnQgKyBsZW4ocHJlZml4KQogICAgICAgICAgICBtYXhfbGVuZ3RoID0gbWluX2xlbmd0aCArIDIKICAgICAgICBlbHNlOgogICAgICAgICAgICBtaW5fbGVuZ3RoLCBtYXhfbGVuZ3RoID0gbnVtX2Ftb3VudCwgbnVtX2Ftb3VudAogICAgICAgIHZhbHVlc19saXN0ID0gKCJ+W3tcImFjdGlvblwiOlwicnVuXCIsXCJ0eXBlXCI6XCJweXRob25cIiwiCiAgICAgICAgICAgICAgICAgICAgICAgIlwibWV0aG9kXCI6XCJzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jclwifV0iKQogICAgICAgIHJlY19zZXR0aW5ncyA9IGRpY3QoCiAgICAgICAgICAgIHZhbHVlc19saXN0PXZhbHVlc19saXN0LAogICAgICAgICAgICBtYXhfbGVuZ3RoPW1heF9sZW5ndGgsCiAgICAgICAgICAgIG1pbl9sZW5ndGg9bWluX2xlbmd0aCwKICAgICAgICApCiAgICAgICAgU2VyaWFsTnVtYmVyT0NSU2V0dGluZ3Mub2NyX25vc3FsLnB1dCgnc2VyaWFsX29jcl9zZXR0aW5ncycsIGpzb24uZHVtcHMocmVjX3NldHRpbmdzKSwgVHJ1ZSkKCiAgICBkZWYgX3ZhbGlkYXRlX29jcl9zZXR0aW5ncyhzZWxmKSAtPiBUdXBsZVtib29sLCBzdHJdOgogICAgICAgICIiItCS0LDQu9C40LTQsNGG0LjRjyDQtNCw0L3QvdGL0YUg0LLQstC10LTQtdC90L3Ri9GFINCyINC00LjQsNC70L7Qs9C1INCo0LDQsdC70L7QvdCg0LDRgdC/0L7Qt9C90LDQstCw0L3QuNGPIiIiCiAgICAgICAgbWluX3JlY19hbW91bnQgPSBzZWxmLmhhc2hfbWFwLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9taW5fcmVjX2Ftb3VudCcpCiAgICAgICAgbnVtX2Ftb3VudCA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX251bV9hbW91bnQnKQogICAgICAgIHByZWZpeDogc3RyID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfcHJlZml4JykKICAgICAgICB1c2VfcHJlZml4ID0gc2VsZi5oYXNoX21hcC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfdXNlX3ByZWZpeCcpCiAgICAgICAgaWYgbm90IG1pbl9yZWNfYW1vdW50LmlzZGlnaXQoKSBvciBpbnQobWluX3JlY19hbW91bnQpID09IDA6CiAgICAgICAgICAgIGVycm9yID0gKCfQo9C60LDQttC40YLQtSDQutC+0YDRgNC10LrRgtC90L7QtSDQvNC40L3QuNC80LDQu9GM0L3QvtC1INC60L7Qu9C40YfQtdGB0YLQstC+JwogICAgICAgICAgICAgICAgICAgICcg0L7QsdC90LDRgNGD0LbQtdC90LjQuSDRgdC10YDQuNC50L3QvtCz0L4g0L3QvtC80LXRgNCwJykKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIGlmIG5vdCBudW1fYW1vdW50LmlzZGlnaXQoKToKICAgICAgICAgICAgZXJyb3IgPSAn0JrQvtC70LjRh9C10YHRgtCy0L4g0YbQuNGE0YAg0LIg0YjQsNCx0LvQvtC90LUg0L3QtSDQutC+0YDRgNC10LrRgtC90L4nCiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgZXJyb3IKICAgICAgICBpZiBub3QgMSA8IGludChudW1fYW1vdW50KSA8IDIxOgogICAgICAgICAgICBlcnJvciA9ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDRhtC40YTRgCDQsiDRiNCw0LHQu9C+0L3QtSDQtNC+0LvQttC90L4g0LHRi9GC0Ywg0LIg0LjQvdGC0LXRgNCy0LDQu9C1INC+0YIgMiDQtNC+IDIwJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4Lmlzc3BhY2UoKSBhbmQgdXNlX3ByZWZpeCA9PSAndHJ1ZSc6CiAgICAgICAgICAgIGVycm9yID0gJ9Cd0LUg0YPQutCw0LfQsNC9INC/0YDQtdGE0LjQutGBJwogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGVycm9yCiAgICAgICAgaWYgcHJlZml4ICE9IHByZWZpeC5zdHJpcCgpOgogICAgICAgICAgICBlcnJvciA9ICfQn9GA0L7QsdC10LvRiyDQsiDQvdCw0YfQsNC70LUg0LjQu9C4INCyINC60L7QvdGG0LUg0L/RgNC10YTQuNC60YHQsCcKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBlcnJvcgogICAgICAgIHJldHVybiBUcnVlLCAnJwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBzZXJpYWxfa2V5X3JlY29nbml0aW9uX29jcihoYXNoX21hcDogSGFzaE1hcCkgLT4gTm9uZToKICAgICAgICAiIiLQndCw0YXQvtC00LjRgiDQsiDQv9C10YDQtdC00LDQvdC90L7QuSDQuNC3IE9DUiDRgdGC0YDQvtC60LUg0YHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGALCDQv9C+INC30LDQtNCw0L3QvdC+0LzRgyDRiNCw0LHQu9C+0L3RgyIiIgogICAgICAgIG9jcl9ub3NxbCA9IG5vQ2xhc3MoIm9jcl9ub3NxbCIpCiAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIgPSBub0NsYXNzKCJvY3Jfbm9zcWxfY291bnRlciIpCiAgICAgICAgb2NyX3RleHQgPSBoYXNoX21hcC5nZXQoIm9jcl90ZXh0IikKICAgICAgICB1c2VfcHJlZml4ID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV91c2VfcHJlZml4JykKICAgICAgICBudW1fYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbnVtX2Ftb3VudCcpKSBvciAxMAogICAgICAgIHBhdHRlcm5zID0gb2NyX25vc3FsLmdldCgnb2NyX3NlcmlhbF90ZW1wbGF0ZV9wYXR0ZXJucycpCiAgICAgICAgcGF0dGVybnMgPSBqc29uLmxvYWRzKHBhdHRlcm5zKSBpZiBwYXR0ZXJucyBlbHNlIFtyZidcZHt7e251bV9hbW91bnR9fX0nXQogICAgICAgIGZvciBwYXR0ZXJuIGluIHBhdHRlcm5zOgogICAgICAgICAgICBtYXRjaF9udW0gPSByZS5zZWFyY2gocGF0dGVybiwgb2NyX3RleHQpCiAgICAgICAgICAgIGlmIG5vdCBtYXRjaF9udW06CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICByZXN1bHQgPSBtYXRjaF9udW0uZ3JvdXAoMikgaWYgdXNlX3ByZWZpeCA9PSAndHJ1ZScgZWxzZSBtYXRjaF9udW0uZ3JvdXAoKQogICAgICAgIG1pbl9yZWNfYW1vdW50ID0gaW50KG9jcl9ub3NxbC5nZXQoJ29jcl9zZXJpYWxfdGVtcGxhdGVfbWluX3JlY19hbW91bnQnKSkKICAgICAgICByZXN1bHRfaW5fbWVtb3J5ID0gb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHJlc3VsdCkKICAgICAgICBpZiByZXN1bHRfaW5fbWVtb3J5IGlzIE5vbmU6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIDEsIFRydWUpCiAgICAgICAgZWxpZiByZXN1bHRfaW5fbWVtb3J5IDwgbWluX3JlY19hbW91bnQ6CiAgICAgICAgICAgIG9jcl9ub3NxbF9jb3VudGVyLnB1dChyZXN1bHQsIHJlc3VsdF9pbl9tZW1vcnkgKyAxLCBUcnVlKQogICAgICAgIGVsaWYgcmVzdWx0X2luX21lbW9yeSA9PSBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgb2NyX25vc3FsX2NvdW50ZXIucHV0KHJlc3VsdCwgcmVzdWx0X2luX21lbW9yeSArIDEsIFRydWUpCiAgICAgICAgICAgIGZyb21fc2NyZWVuID0gb2NyX25vc3FsLmdldCgnZnJvbV9zY3JlZW4nKQogICAgICAgICAgICBpZiBmcm9tX3NjcmVlbiA9PSAnRmxvd0RvY0RldGFpbHNTY3JlZW4nOgogICAgICAgICAgICAgICAgZGJfc2VydmljZXMuRmxvd0RvY1NlcnZpY2UoaGFzaF9tYXBbJ2lkX2RvYyddKS5hZGRfYmFyY29kZV90b19kYXRhYmFzZShyZXN1bHQpCiAgICAgICAgICAgIGVsaWYgZnJvbV9zY3JlZW4gPT0gJ1Nlcmllc1NlbGVjdFNjcmVlbic6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXQoIm9jcl9yZXN1bHQiLCByZXN1bHQpCiAgICAgICAgICAgICAgICBvY3Jfbm9zcWwucHV0KCdvY3JfcmVzdWx0JywgcmVzdWx0LCBUcnVlKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGhhc2hfbWFwLmJlZXAoKQogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0KHQtdGA0LjQudC90YvQuSDQvdC+0LzQtdGAOiAnICsgcmVzdWx0KQogICAgICAgICAgICBpZiBvY3Jfbm9zcWwuZ2V0KCdvY3Jfc2VyaWFsX3RlbXBsYXRlX2NvbnRpbnVvdXNfcmVjb2duaXRpb24nKSA9PSAnZmFsc2UnOgogICAgICAgICAgICAgICAgaGFzaF9tYXAucHV0KCJvY3JfcmVzdWx0IiwgcmVzdWx0KQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGZvciBzZXJpYWwgaW4ganNvbi5sb2FkcyhvY3Jfbm9zcWxfY291bnRlci5nZXRhbGxrZXlzKCkpOgogICAgICAgICAgICAgICAgaWYgb2NyX25vc3FsX2NvdW50ZXIuZ2V0KHNlcmlhbCkgPCBtaW5fcmVjX2Ftb3VudDoKICAgICAgICAgICAgICAgICAgICBvY3Jfbm9zcWxfY291bnRlci5wdXQoc2VyaWFsLCAwLCBUcnVlKQoKIyBeXl5eXl5eXl5eXl5eXl5eXl5eXl4gT0NSIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IFNlcnZpY2VzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgVGltZXI6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYucnNfc2V0dGluZ3MgPSBfcnNfc2V0dGluZ3MKICAgICAgICBzZWxmLmh0dHBfc2V0dGluZ3MgPSBzZWxmLl9nZXRfaHR0cF9zZXR0aW5ncygpCiAgICAgICAgc2VsZi5kYl9zZXJ2aWNlID0gRG9jU2VydmljZSgpCiAgICAgICAgc2VsZi5odHRwX3NlcnZpY2UgPSBIc1NlcnZpY2Uoc2VsZi5odHRwX3NldHRpbmdzKQoKICAgIGRlZiB0aW1lcl9vbl9zdGFydChzZWxmKToKICAgICAgICBpZiBzZWxmLmhhc2hfbWFwLmdldF9ib29sKCdzdG9wX3RpbWVyX3VwZGF0ZScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgbm90IHNlbGYuX2NoZWNrX2Nvbm5lY3Rpb24oKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuX2xvYWRfZG9jcygpCiAgICAgICAgc2VsZi51cGxvYWRfZGF0YSgpCiAgICAgICAgc2VsZi5fdXBsb2FkX2J1ZmZlcl9kYXRhKCkKCiAgICBkZWYgX3B1dF9ub3RpZmljYXRpb24oc2VsZiwgdGV4dCwgdGl0bGU9Tm9uZSk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5ub3RpZmljYXRpb24odGV4dCwgdGl0bGUpCgogICAgZGVmIF9nZXRfaHR0cF9zZXR0aW5ncyhzZWxmKToKICAgICAgICBodHRwX3NldHRpbmdzID0gewogICAgICAgICAgICAndXJsJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoIlVSTCIpLAogICAgICAgICAgICAndXNlcic6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCdVU0VSJyksCiAgICAgICAgICAgICdwYXNzJzogc2VsZi5yc19zZXR0aW5ncy5nZXQoJ1BBU1MnKSwKICAgICAgICAgICAgJ2RldmljZV9tb2RlbCc6IHNlbGYuaGFzaF9tYXBbJ0RFVklDRV9NT0RFTCddLAogICAgICAgICAgICAnYW5kcm9pZF9pZCc6IHNlbGYuaGFzaF9tYXBbJ0FORFJPSURfSUQnXSwKICAgICAgICAgICAgJ3VzZXJfbmFtZSc6IHNlbGYucnNfc2V0dGluZ3MuZ2V0KCd1c2VyX25hbWUnKX0KICAgICAgICByZXR1cm4gaHR0cF9zZXR0aW5ncwoKICAgIGRlZiBfbG9hZF9kb2NzKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRvY3NfZGF0YSA9IHNlbGYuaHR0cF9zZXJ2aWNlLmdldF9kYXRhKCkKICAgICAgICAgICAgZGF0YSA9IGRvY3NfZGF0YS5nZXQoJ2RhdGEnKQogICAgICAgICAgICBpZiBub3QgZGF0YToKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLlRpbWVyU2VydmljZSgpCiAgICAgICAgICAgIG5ld19kb2N1bWVudHMgPSBzZXJ2aWNlLmdldF9uZXdfbG9hZF9kb2NzKGRhdGEpCiAgICAgICAgICAgIHNlcnZpY2Uuc2F2ZV9sb2FkX2RhdGEoZGF0YSkKICAgICAgICAgICAgIyBzZWxmLmRiX3NlcnZpY2UudXBkYXRlX2RhdGFfZnJvbV9qc29uKGRvY3NfZGF0YVsnZGF0YSddKSDQodGC0LDRgNGL0Lkg0LLQsNGA0LjQsNC90YIg0L7QsdC80LXQvdCwLgoKICAgICAgICAgICAgaWYgbmV3X2RvY3VtZW50czoKICAgICAgICAgICAgICAgIG5vdGlmeV90ZXh0ID0gc2VsZi5fZ2V0X25vdGlmeV90ZXh0KG5ld19kb2N1bWVudHMpCiAgICAgICAgICAgICAgICBzZWxmLl9wdXRfbm90aWZpY2F0aW9uKHRleHQ9bm90aWZ5X3RleHQsIHRpdGxlPSLQl9Cw0LPRgNGD0LbQtdC90Ysg0LTQvtC60YPQvNC10L3RgtGLOiIpCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWUuYXJnc1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl9pbmZvPSfQntGI0LjQsdC60LAg0LfQsNCz0YDRg9C30LrQuCDQtNC+0LrRg9C80LXQvdGC0L7QsicpCgogICAgZGVmIHVwbG9hZF9kYXRhKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLl9jaGVja19odHRwX3NldHRpbmdzKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZXJ2aWNlID0gVGltZXJTZXJ2aWNlKCkKICAgICAgICBkYXRhID0gc2VydmljZS5nZXRfZGF0YV90b19zZW5kKCkKCiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGFuc3dlciA9IHNlbGYuaHR0cF9zZXJ2aWNlLnNlbmRfZGF0YShkYXRhKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5oc19zZXJ2aWNlLndyaXRlX2Vycm9yX3RvX2xvZyhlcnJvcl90ZXh0PWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LInKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgYW5zd2VyLmVycm9yOgogICAgICAgICAgICBzZWxmLmhzX3NlcnZpY2Uud3JpdGVfZXJyb3JfdG9fbG9nKGVycm9yX3RleHQ9YW5zd2VyLmVycm9yX3RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0n0J7RiNC40LHQutCwINCy0YvQs9GA0YPQt9C60Lgg0LTQvtC60YPQvNC10L3RgtC+0LInKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRvY3NfbGlzdF9zdHJpbmcgPSAnLCAnLmpvaW4oW2YiJ3tkWydpZF9kb2MnXX0nIiBmb3IgZCBpbiBkYXRhXSkKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnVwZGF0ZV91cGxvYWRlZF9kb2NzX3N0YXR1cyhkb2NzX2xpc3Rfc3RyaW5nKQoKICAgIGRlZiBfdXBsb2FkX2J1ZmZlcl9kYXRhKHNlbGYpOgogICAgICAgICMg0JjQvNGPINGC0LDQsdC70LjRhtGLINC+0YfQtdGA0LXQtNC4ICjQuNC80Y8g0LzQtdGC0L7QtNCwINCyIHVybCBodHRwLdGB0LXRgNCy0LjRgdCwKQogICAgICAgIGJ1ZmZlcl90YWJsZXMgPSBbCiAgICAgICAgICAgICdiYXJjb2RlcycsCiAgICAgICAgICAgICdkb2N1bWVudHMnCiAgICAgICAgXQoKICAgICAgICBmb3IgYnVmZmVyX3RhYmxlIGluIGJ1ZmZlcl90YWJsZXM6CiAgICAgICAgICAgIGJ1ZmZlcl9zZXJ2aWNlID0gRXhjaGFuZ2VRdWV1ZUJ1ZmZlcihidWZmZXJfdGFibGUpCiAgICAgICAgICAgIGRhdGFfdG9fc2VuZCA9IGJ1ZmZlcl9zZXJ2aWNlLmdldF9kYXRhX3RvX3NlbmQoKQoKICAgICAgICAgICAgbWV0aG9kID0gc2VsZi5odHRwX3NlcnZpY2UuZ2V0X21ldGhvZF9ieV9wYXRoKGJ1ZmZlcl90YWJsZSkKICAgICAgICAgICAgaWYgZGF0YV90b19zZW5kIGFuZCBtZXRob2Q6CiAgICAgICAgICAgICAgICByZXMgPSBtZXRob2QoZGF0YV90b19zZW5kKQoKICAgICAgICAgICAgICAgIGlmIG5vdCByZXMuZXJyb3I6CiAgICAgICAgICAgICAgICAgICAgYnVmZmVyX3NlcnZpY2UucmVtb3ZlX3NlbnRfZGF0YShkYXRhX3RvX3NlbmQpCgogICAgZGVmIF9jaGVja19odHRwX3NldHRpbmdzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgaHR0cCA9IHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkKICAgICAgICByZXR1cm4gYWxsKFtodHRwLmdldCgndXJsJyksIGh0dHAuZ2V0KCd1c2VyJyksIGh0dHAuZ2V0KCdwYXNzJyldKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X25vdGlmeV90ZXh0KG5ld19kb2N1bWVudHMpOgogICAgICAgIGRvY190aXRsZXMgPSBbCiAgICAgICAgICAgICd7fSDihJYge30g0L7RgiB7fScuZm9ybWF0KGl0ZW1bJ2RvY190eXBlJ10sIGl0ZW1bJ2RvY19uJ10sIGl0ZW1bJ2RvY19kYXRlJ10pCiAgICAgICAgICAgIGZvciBpdGVtIGluIG5ld19kb2N1bWVudHMudmFsdWVzKCldCiAgICAgICAgcmV0dXJuICIsICIuam9pbihkb2NfdGl0bGVzKQoKICAgIGRlZiBfY2hlY2tfY29ubmVjdGlvbihzZWxmKToKICAgICAgICBoc19zZXJ2aWNlID0gaHNfc2VydmljZXMuSHNTZXJ2aWNlKHNlbGYuX2dldF9odHRwX3NldHRpbmdzKCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoc19zZXJ2aWNlLmNvbW11bmljYXRpb25fdGVzdCh0aW1lb3V0PTEpCiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuaHR0cF9hbnN3ZXIKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGFuc3dlciA9IGhzX3NlcnZpY2UuSHR0cEFuc3dlcigKICAgICAgICAgICAgICAgIGVycm9yPVRydWUsCiAgICAgICAgICAgICAgICBlcnJvcl90ZXh0PXN0cihlLmFyZ3NbMF0pLAogICAgICAgICAgICAgICAgc3RhdHVzX2NvZGU9NDA0LAogICAgICAgICAgICAgICAgdXJsPWhzX3NlcnZpY2UudXJsKQogICAgICAgIHJldHVybiBub3QgYW5zd2VyLmVycm9yCgpjbGFzcyBXZWJTZXJ2aWNlU3luY0NvbW1hbmQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYubGlzdGVuZXIgPSBzZWxmLmhhc2hfbWFwLmxpc3RlbmVyCgogICAgZGVmIG9uX3NlcnZpY2VfcmVxdWVzdChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdiYXJjb2Rlcyc6IHNlbGYuX2dldF9iYXJjb2Rlc19kYXRhLAogICAgICAgICAgICAnaGFzaF9tYXAnOiBzZWxmLl9nZXRfaGFzaF9tYXAsCiAgICAgICAgICAgICdoYXNoX21hcF9zaXplJzogc2VsZi5fZ2V0X2hhc2hfbWFwX3NpemUsCiAgICAgICAgfQogICAgICAgIGlmIHNlbGYubGlzdGVuZXIgaW4gbGlzdGVuZXJzOgogICAgICAgICAgICBsaXN0ZW5lcnNbc2VsZi5saXN0ZW5lcl0oKQoKICAgIGRlZiBfZ2V0X2JhcmNvZGVzX2RhdGEoc2VsZik6CiAgICAgICAgYnVmZmVyX3NlcnZpY2UgPSBFeGNoYW5nZVF1ZXVlQnVmZmVyKCdiYXJjb2RlcycpCiAgICAgICAgZGF0YV90b19zZW5kID0gYnVmZmVyX3NlcnZpY2UuZ2V0X2RhdGFfdG9fc2VuZCgpCiAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlSGVhZGVycycsIGhlYWRlcnMsIHRvX2pzb249VHJ1ZSkKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZScsIGRhdGFfdG9fc2VuZCwgdG9fanNvbj1UcnVlKQoKICAgIGRlZiBfZ2V0X2hhc2hfbWFwKHNlbGYpOgogICAgICAgIHByb2Nlc3NfbWFwID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigncHJvY2Vzc19tYXAnKQoKICAgICAgICBib2R5ID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbignd3NfYm9keScpCiAgICAgICAgaWYgYm9keToKICAgICAgICAgICAgcmVzcG9uc2UgPSBwcm9jZXNzX21hcC5nZXQoYm9keVsnaXRlbSddKQoKICAgICAgICAgICAgaGVhZGVycyA9IFt7J2tleSc6ICdDb250ZW50LVR5cGUnLCAndmFsdWUnOiAnYXBwbGljYXRpb24vanNvbid9XQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdXU1Jlc3BvbnNlJywgcmVzcG9uc2UpCgogICAgZGVmIF9nZXRfaGFzaF9tYXBfc2l6ZShzZWxmKToKICAgICAgICBpbXBvcnQgc3lzCiAgICAgICAgcHJvY2Vzc19tYXAgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdwcm9jZXNzX21hcCcpIG9yIHt9CgogICAgICAgIGhlYWRlcnMgPSBbeydrZXknOiAnQ29udGVudC1UeXBlJywgJ3ZhbHVlJzogJ2FwcGxpY2F0aW9uL2pzb24nfV0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnV1NSZXNwb25zZUhlYWRlcnMnLCBoZWFkZXJzLCB0b19qc29uPVRydWUpCgogICAgICAgIHJlc3AgPSB7a2V5OiByb3VuZChzeXMuZ2V0c2l6ZW9mKHYpIC8gMTAyNCwgMykgZm9yIGtleSwgdiAgaW4gcHJvY2Vzc19tYXAuaXRlbXMoKX0KICAgICAgICByZXNwWyd0b3RhbCddID0gcm91bmQoc3VtKHJlc3AudmFsdWVzKCkpLCAzKQoKICAgICAgICByZXNwX3NvcnRlZCA9IHtrOiB2IGZvciBrLCB2IGluIHNvcnRlZChyZXNwLml0ZW1zKCksIGtleT1sYW1iZGEgaXRlbTogaXRlbVsxXSwgcmV2ZXJzZT1UcnVlKX0KCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1dTUmVzcG9uc2UnLCByZXNwX3NvcnRlZCwgdG9fanNvbj1UcnVlKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIFNlcnZpY2VzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgojID09PT09PT09PT09PT09PT09PT09IE1haW4gZXZlbnRzID09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgoKY2xhc3MgTWFpbkV2ZW50czoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hfbWFwCiAgICAgICAgc2VsZi5yc19zZXR0aW5ncyA9IF9yc19zZXR0aW5ncwoKICAgIGRlZiBhcHBfb25fc3RhcnQoc2VsZik6CgogICAgICAgICMgc2VsZi5oYXNoX21hcC5wdXQoJ1N0YWNrQWRkTW9kZScsICcnKSAgIyDQktC60LvRjtGH0LDQtdGCINGA0LXQttC40Lwg0L7QsdGK0LXQtNC40L3QtdC90LjRjyDQv9C10YDQtdC80LXQvdC90YvRhSBoYXNoX21hcCDQsiDRgtCw0LnQvNC10YDQsNGFCgogICAgICAgICMgVE9ETyDQntCx0YDQsNCx0L7RgtGH0LjQutC4INC+0LHQvdC+0LLQu9C10L3QuNGPIQogICAgICAgIHJlbGVhc2UgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnUmVsZWFzZScpIG9yICcnCiAgICAgICAgdG9hc3QgPSAn0JPQvtGC0L7QsiDQuiDRgNCw0LHQvtGC0LUnCgogICAgICAgIGN1cnJlbnRfcmVsZWFzZSA9IHNlbGYuaGFzaF9tYXBbJ19jb25maWd1cmF0aW9uVmVyc2lvbiddCgogICAgICAgIHNlbGYuX2NyZWF0ZV90YWJsZXMoKQoKICAgICAgICBpZiBjdXJyZW50X3JlbGVhc2UgaXMgTm9uZToKICAgICAgICAgICAgdG9hc3QgPSAn0J3QtSDRg9C00LDQu9C+0YHRjCDQvtC/0YDQtdC00LXQu9C40YLRjCDQstC10YDRgdC40Y4g0LrQvtC90YTQuNCz0YPRgNCw0YbQuNC4JwoKICAgICAgICBpZiBjdXJyZW50X3JlbGVhc2UgYW5kIHJlbGVhc2UgIT0gY3VycmVudF9yZWxlYXNlOgogICAgICAgICAgICAjIGltcG9ydCB2ZXJzaW9uX2NvbnRyb2wKICAgICAgICAgICAgIyByZXN1bHRfbGlzdCA9IHZlcnNpb25fY29udHJvbC5ydW5fcmVsZWFzZXMocmVsZWFzZSwgY3VycmVudF9yZWxlYXNlKQogICAgICAgICAgICAjIGZvciBlbGVtIGluIHJlc3VsdF9saXN0OgogICAgICAgICAgICAjICAgICBpZiBub3QgZWxlbVsncmVzdWx0J106CiAgICAgICAgICAgICMgICAgICAgICBwYXNzCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdJbnN0YWxsQ29uZmlndXJhdGlvbicsICcnKQogICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dCgnUmVsZWFzZScsIGN1cnJlbnRfcmVsZWFzZSwgVHJ1ZSkKICAgICAgICAgICAgdG9hc3QgPSBmJ9CS0YvQv9C+0LvQvdC10L3QviDQvtCx0L3QvtCy0LvQtdC90LjQtSDQvdCwINCy0LXRgNGB0LjRjiB7Y3VycmVudF9yZWxlYXNlfScKCiAgICAgICAgaWYgc2VsZi5yc19zZXR0aW5ncy5nZXQoJ2RlbGV0ZV9vbGRfZG9jcycpIGlzIFRydWU6CiAgICAgICAgICAgIGRlbGV0ZWRfZG9jcyA9IHNlbGYuX2RlbGV0ZV9vbGRfZG9jcygpCiAgICAgICAgICAgIGlmIGRlbGV0ZWRfZG9jczoKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAubm90aWZpY2F0aW9uKAogICAgICAgICAgICAgICAgICAgIHRleHQ9ZifQo9C00LDQu9C10L3RiyDQtNC+0LrRg9C80LXQvdGC0Ys6ICh7bGVuKGRlbGV0ZWRfZG9jcyl9KScsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YfQuNGB0YLQutCwINC90LXQsNC60YLRg9Cw0LvRjNC90YvRhSDQtNCw0L3QvdGL0YUnKQoKICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzID0gewogICAgICAgICAgICAnVGl0bGVUZXh0U2l6ZSc6IDE4LAogICAgICAgICAgICAndGl0bGVEb2NUeXBlQ2FyZFRleHRTaXplJzogMTgsCiAgICAgICAgICAgICdDYXJkVGl0bGVUZXh0U2l6ZSc6IDIwLAogICAgICAgICAgICAnQ2FyZERhdGVUZXh0U2l6ZSc6IDEwLAogICAgICAgICAgICAnQ2FyZFRleHRTaXplJzogMTUsCiAgICAgICAgICAgICdHb29kc0NhcmRUaXRsZVRleHRTaXplJzogMTgsCiAgICAgICAgICAgICdnb29kc1RleHRTaXplJzogMTgsCiAgICAgICAgICAgICdTZXJpZXNQcm9wZXJ0aWVzVGV4dFNpemUnOiAxNiwKICAgICAgICAgICAgJ0RvY1R5cGVDYXJkVGV4dFNpemUnOiAxNSwKICAgICAgICAgICAgJ3NpZ25hbF9udW0nOiA1LAogICAgICAgICAgICAndXNlX21hcmsnOiAnZmFsc2UnLAogICAgICAgICAgICAnYWRkX2lmX25vdF9pbl9wbGFuJzogJ2ZhbHNlJywKICAgICAgICAgICAgJ3BhdGgnOiAnJywKICAgICAgICAgICAgJ3N1Y2Nlc3Nfc2lnbmFsJzogNywKICAgICAgICAgICAgJ3dhcm5pbmdfc2lnbmFsJzogOCwKICAgICAgICAgICAgJ2Vycm9yX3NpZ25hbCc6IDUsCiAgICAgICAgICAgICdhbGxvd19vdmVyc2Nhbic6ICdmYWxzZScsCiAgICAgICAgICAgICJwYXRoX3RvX2RhdGFiYXNlcyI6ICIuLyIsCiAgICAgICAgICAgICdzcWxpdGVfbmFtZSc6ICdTaW1wbGVLZWVwJywKICAgICAgICAgICAgJ2xvZ19uYW1lJzogJ2xvZy5qc29uJywKICAgICAgICAgICAgJ3RpbWVyX2lzX2Rpc2FibGVkJzogRmFsc2UsCiAgICAgICAgICAgICdhbGxvd19mYWN0X2lucHV0JzogRmFsc2UsCiAgICAgICAgICAgICdvZmZsaW5lX21vZGUnOiBGYWxzZSwKICAgICAgICAgICAgJ2RlbGV0ZV9vbGRfZG9jcyc6IEZhbHNlLAogICAgICAgICAgICAndXNlcl90bXpfb2Zmc2V0Jzogc2VsZi5oYXNoX21hcC5nZXQoIlRNWiIpCiAgICAgICAgfQoKICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygnLy9kYXRhL2RhdGEvcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkvZGF0YWJhc2VzLycpOgogICAgICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzWydwYXRoX3RvX2RhdGFiYXNlcyddID0gJy8vZGF0YS9kYXRhL3J1LnRyYXZlbGZvb2Quc2ltcGxlX3VpL2RhdGFiYXNlcycKICAgICAgICBlbHNlOgogICAgICAgICAgICByc19kZWZhdWx0X3NldHRpbmdzWydwYXRoX3RvX2RhdGFiYXNlcyddID0gIi4vIgoKICAgICAgICBmb3IgaywgdiBpbiByc19kZWZhdWx0X3NldHRpbmdzLml0ZW1zKCk6CiAgICAgICAgICAgIGlmIHNlbGYucnNfc2V0dGluZ3MuZ2V0KGspIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLnJzX3NldHRpbmdzLnB1dChrLCB2LCBUcnVlKQoKICAgICAgICBzZWxmLmhhc2hfbWFwWyJTUUxDb25uZWN0RGF0YWJhc2UiXSA9ICJTaW1wbGVLZWVwIgogICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3QodG9hc3QpCgogICAgZGVmIG9uX3NxbF9lcnJvcihzZWxmKToKICAgICAgICBzcWxfZXJyb3IgPSBzZWxmLmhhc2hfbWFwWydTUUxFcnJvciddCiAgICAgICAgaWYgc3FsX2Vycm9yOgogICAgICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuRG9jU2VydmljZSgpCiAgICAgICAgICAgIHNlcnZpY2Uud3JpdGVfZXJyb3Jfb25fbG9nKAogICAgICAgICAgICAgICAgZXJyb3JfdHlwZT0iU1FMX0Vycm9yIiwKICAgICAgICAgICAgICAgIGVycm9yX3RleHQ9c3FsX2Vycm9yLAogICAgICAgICAgICAgICAgZXJyb3JfaW5mbz0nJwogICAgICAgICAgICAgICAgKQoKICAgIGRlZiBfY3JlYXRlX3RhYmxlcyhzZWxmKToKICAgICAgICBzZXJ2aWNlID0gZGJfc2VydmljZXMuRGJDcmVhdG9yKCkKICAgICAgICBzZXJ2aWNlLmNyZWF0ZV90YWJsZXMoKQoKICAgIGRlZiBfZGVsZXRlX29sZF9kb2NzKHNlbGYpIC0+IGxpc3Q6CiAgICAgICAgZGF5cyA9IGludChzZWxmLnJzX3NldHRpbmdzLmdldCgnZG9jX2RlbGV0ZV9zZXR0aW5nc19kYXlzJykpCiAgICAgICAgc2VydmljZSA9IGRiX3NlcnZpY2VzLkRvY1NlcnZpY2UoKQogICAgICAgIHJldHVybiBzZXJ2aWNlLmRlbGV0ZV9vbGRfZG9jcyhkYXlzKQoKCiMgXl5eXl5eXl5eXl5eXl5eXl5eXl5eIE1haW4gZXZlbnRzIF5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl5eXl4KCgpjbGFzcyBTY3JlZW5zRmFjdG9yeToKICAgIHNjcmVlbnMgPSBbR29vZHNTZWxlY3RTY3JlZW4sCiAgICAgICAgSHRtbFZpZXcsCiAgICAgICAgVGVtcGxhdGVzTGlzdCwKICAgICAgICBGbG93VGlsZXNTY3JlZW4sCiAgICAgICAgRmxvd0RvY1NjcmVlbiwKICAgICAgICBGbG93RG9jRGV0YWlsc1NjcmVlbiwKICAgICAgICBHcm91cFNjYW5UaWxlcywKICAgICAgICBEb2N1bWVudHNUaWxlcywKICAgICAgICBHcm91cFNjYW5Eb2NzTGlzdFNjcmVlbiwKICAgICAgICBEb2N1bWVudHNEb2NzTGlzdFNjcmVlbiwKICAgICAgICBHcm91cFNjYW5Eb2NEZXRhaWxzU2NyZWVuTmV3LAogICAgICAgIEdyb3VwU2NhbkRvY0RldGFpbHNTY3JlZW4sCiAgICAgICAgRG9jdW1lbnRzRG9jRGV0YWlsU2NyZWVuLAogICAgICAgIEVycm9yTG9nU2NyZWVuLAogICAgICAgIERlYnVnU2V0dGluZ3NTY3JlZW4sCiAgICAgICAgSHR0cFNldHRpbmdzU2NyZWVuLAogICAgICAgIFNldHRpbmdzU2NyZWVuLAogICAgICAgIEdvb2RzTGlzdFNjcmVlbiwKICAgICAgICBTZWxlY3RHb29kc1R5cGUsCiAgICAgICAgSXRlbUNhcmQsCiAgICAgICAgRm9udFNpemVTZXR0aW5nc1NjcmVlbiwKICAgICAgICBCYXJjb2RlVGVzdFNjcmVlbiwKICAgICAgICBTb3VuZFNldHRpbmdzLAogICAgICAgIEdvb2RzQmFsYW5jZXNJdGVtQ2FyZCwKICAgICAgICBHb29kc1ByaWNlc0l0ZW1DYXJkLAogICAgXQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lPU5vbmUsIHByb2Nlc3M9Tm9uZSwgKiprd2FyZ3MpOgogICAgICAgIGlmIG5vdCBzY3JlZW5fbmFtZToKICAgICAgICAgICAgc2NyZWVuX25hbWUgPSBrd2FyZ3NbJ2hhc2hfbWFwJ10uZ2V0X2N1cnJlbnRfc2NyZWVuKCkKICAgICAgICBpZiBub3QgcHJvY2VzczoKICAgICAgICAgICAgcHJvY2VzcyA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9wcm9jZXNzKCkKCiAgICAgICAgZm9yIGl0ZW0gaW4gU2NyZWVuc0ZhY3Rvcnkuc2NyZWVuczoKICAgICAgICAgICAgaWYgZ2V0YXR0cihpdGVtLCAnc2NyZWVuX25hbWUnKSA9PSBzY3JlZW5fbmFtZSBhbmQgZ2V0YXR0cihpdGVtLCAncHJvY2Vzc19uYW1lJykgPT0gcHJvY2VzczoKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGNyZWF0ZV9zY3JlZW4oc2NyZWVuX25hbWU9Tm9uZSwgcHJvY2Vzcz1Ob25lLCAqKmt3YXJncyk6CiAgICAgICAgaWYgbm90IHNjcmVlbl9uYW1lOgogICAgICAgICAgICBzY3JlZW5fbmFtZSA9IGt3YXJnc1snaGFzaF9tYXAnXS5nZXRfY3VycmVudF9zY3JlZW4oKQogICAgICAgIGlmIG5vdCBwcm9jZXNzOgogICAgICAgICAgICBwcm9jZXNzID0ga3dhcmdzWydoYXNoX21hcCddLmdldF9jdXJyZW50X3Byb2Nlc3MoKQoKICAgICAgICBzY3JlZW5fY2xhc3MgPSBTY3JlZW5zRmFjdG9yeS5nZXRfc2NyZWVuX2NsYXNzKHNjcmVlbl9uYW1lLCBwcm9jZXNzKQogICAgICAgIHJldHVybiBzY3JlZW5fY2xhc3MoKiprd2FyZ3MpCgoKY2xhc3MgTW9ja1NjcmVlbihTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAnTW9jaycKICAgIHByb2Nlc3NfbmFtZSA9ICdNb2NrJwoKICAgIGRlZiBvbl9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIG9uX2lucHV0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgb25fcG9zdF9zdGFydChzZWxmKToKICAgICAgICBwYXNzCgogICAgZGVmIHNob3coc2VsZiwgYXJncz1Ob25lKToKICAgICAgICBwYXNzCgoKZGVmIHNldF9jdXJyZW50X3NjcmVlbihzY3JlZW4pOgogICAgZ2xvYmFsIGN1cnJlbnRfc2NyZWVuCiAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgpkZWYgc2V0X25leHRfc2NyZWVuKHNjcmVlbik6CiAgICBnbG9iYWwgbmV4dF9zY3JlZW4KICAgIG5leHRfc2NyZWVuID0gc2NyZWVuCiAgICByZXR1cm4gbmV4dF9zY3JlZW4KCmRlZiBjcmVhdGVfc2NyZWVuKGhhc2hfbWFwOiBIYXNoTWFwLCBzY3JlZW5fY2xhc3M9Tm9uZSwgc2NyZWVuX3ZhbHVlcz1Ob25lKToKICAgICIiIgogICAg0JzQtdGC0L7QtCDQtNC70Y8g0L/QvtC70YPRh9C10L3QuNGPINC80L7QtNC10LvQuCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10Lkg0YLQtdC60YPRidC10LzRgyDQv9GA0L7RhtC10YHRgdGDINC4INGN0LrRgNCw0L3Rgy4KICAgINCV0YHQu9C4INC80L7QtNC10LvRjCDQvdC1INGA0LXQsNC70LjQt9C+0LLQsNC90LAg0LLQvtC30LLRgNCw0YnQsNC10YIg0LfQsNCz0LvRg9GI0LrRgwogICAg0KDQtdCw0LvQuNC30L7QstCw0L0g0YHQuNC90LPQu9GC0L7QvSDRh9C10YDQtdC3INCz0LvQvtCx0LDQu9GM0L3Rg9GOINC/0LXRgNC10LzQtdC90L3Rg9GOIGN1cnJlbnRfc2NyZWVuLCDQtNC70Y8g0YHQvtGF0YDQtdC90LXQvdC40Y8g0YHQvtGB0YLQvtGP0L3QuNGPINGC0LXQutGD0YnQtdCz0L4g0Y3QutGA0LDQvdCwCiAgICAiIiIKICAgIGdsb2JhbCBjdXJyZW50X3NjcmVlbiwgbmV4dF9zY3JlZW4KCiAgICBzY3JlZW5fcGFyYW1zID0gewogICAgICAgICdoYXNoX21hcCc6IGhhc2hfbWFwLAogICAgICAgICdyc19zZXR0aW5ncyc6IF9yc19zZXR0aW5ncwogICAgfQogICAgaWYgc2NyZWVuX2NsYXNzIGlzIE5vbmU6CiAgICAgICAgc2NyZWVuX2NsYXNzID0gU2NyZWVuc0ZhY3RvcnkuZ2V0X3NjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCgogICAgaWYgbm90IHNjcmVlbl9jbGFzczoKICAgICAgICBjdXJyZW50X3NjcmVlbiA9IE1vY2tTY3JlZW4oKipzY3JlZW5fcGFyYW1zKQogICAgZWxpZiB0eXBlKGN1cnJlbnRfc2NyZWVuKSBpcyBub3Qgc2NyZWVuX2NsYXNzOgogICAgICAgIGlmIHR5cGUobmV4dF9zY3JlZW4pIGlzIHNjcmVlbl9jbGFzczoKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4gPSBuZXh0X3NjcmVlbgogICAgICAgICAgICBuZXh0X3NjcmVlbiA9IE5vbmUKICAgICAgICAgICAgY3VycmVudF9zY3JlZW4uaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIHNjcmVlbl92YWx1ZXM6CiAgICAgICAgICAgICAgICBoYXNoX21hcC5wdXRfZGF0YShzY3JlZW5fdmFsdWVzKQogICAgICAgICAgICBjdXJyZW50X3NjcmVlbiA9IHNjcmVlbl9jbGFzcygqKnNjcmVlbl9wYXJhbXMpCiAgICBlbHNlOgogICAgICAgIGN1cnJlbnRfc2NyZWVuLmhhc2hfbWFwID0gaGFzaF9tYXAKICAgICAgICBjdXJyZW50X3NjcmVlbi5saXN0ZW5lciA9IGhhc2hfbWFwWydsaXN0ZW5lciddCiAgICAgICAgY3VycmVudF9zY3JlZW4uZXZlbnQgPSBoYXNoX21hcFsnZXZlbnQnXQoKICAgIGlmIGN1cnJlbnRfc2NyZWVuLmlzX2ZpbmlzaF9wcm9jZXNzOgogICAgICAgIGZpbmlzaF9zY3JlZW4gPSBjdXJyZW50X3NjcmVlbgogICAgICAgIGN1cnJlbnRfc2NyZWVuID0gTm9uZQogICAgICAgIHJldHVybiBmaW5pc2hfc2NyZWVuCgogICAgcmV0dXJuIGN1cnJlbnRfc2NyZWVuCgo="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\ui_utils.py",
                "PyFileKey": "ui_utils",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzb2NrZXQKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzLCBhc2RpY3QKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgd3JhcHMKZnJvbSB0eXBpbmcgaW1wb3J0IENhbGxhYmxlLCBVbmlvbiwgTGlzdCwgRGljdCwgTGl0ZXJhbCwgT3B0aW9uYWwsIFR1cGxlCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBIYXNoTWFwOgogICAgIiIiCiAgICAgICAg0JrQu9Cw0YHRgS3QtNC10LrQvtGA0LDRgtC+0YAg0LTQu9GPINGD0LTQvtCx0L3QvtC5INGA0LDQsdC+0YLRiyDRgSBoYXNoTWFwLiDQotCw0LrQttC1INC80L7QttC90L4g0LTQvtCx0LDQstC40YLRjCDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Rg9GOINC70L7Qs9C40LrRgy4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcD1Ob25lLCBkZWJ1ZzogYm9vbCA9IEZhbHNlKToKICAgICAgICBzZWxmLmxpc3RlbmVyID0gTm9uZQogICAgICAgIHNlbGYuaGFzaF9tYXAgPSBoYXNoX21hcAogICAgICAgIHNlbGYuZGVidWdfbW9kZSA9IGRlYnVnCgogICAgZGVmIF9fY2FsbF9fKHNlbGYsIGZ1bmM6IENhbGxhYmxlWy4uLiwgTm9uZV0pOgogICAgICAgIEB3cmFwcyhmdW5jKQogICAgICAgIGRlZiB3cmFwcGVyKGhhc2hNYXAsICphcmdzLCAqKmt3YXJncyk6CiAgICAgICAgICAgIHNlbGYuaW5pdChoYXNoTWFwKQogICAgICAgICAgICBmdW5jKHNlbGYpCiAgICAgICAgICAgIHJldHVybiBoYXNoTWFwCgogICAgICAgIHJldHVybiB3cmFwcGVyCgogICAgZGVmIGluaXQoc2VsZiwgaGFzaE1hcCk6CiAgICAgICAgc2VsZi5oYXNoX21hcCA9IGhhc2hNYXAKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3Moc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ0ZpbmlzaFByb2Nlc3MnLCAnJykKCiAgICBkZWYgZmluaXNoX3Byb2Nlc3NfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCdGaW5pc2hQcm9jZXNzUmVzdWx0JywgJycpCgogICAgQHByb3BlcnR5CiAgICBkZWYgbGlzdGVuZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2xpc3RlbmVyJ10KCiAgICBAbGlzdGVuZXIuc2V0dGVyCiAgICBkZWYgbGlzdGVuZXIoc2VsZiwgdik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBzZXRfcmVzdWx0X2xpc3RlbmVyKHNlbGYsIGxpc3RlbmVyKToKICAgICAgICBpZiBsaXN0ZW5lciBhbmQgaXNpbnN0YW5jZShsaXN0ZW5lciwgc3RyKToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1NldFJlc3VsdExpc3RlbmVyJywgbGlzdGVuZXIpCgogICAgZGVmIHRvYXN0KHNlbGYsIHRleHQsIGFkZF90b19sb2c9RmFsc2UpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsIHN0cih0ZXh0KSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBub3RpZmljYXRpb24oc2VsZiwgdGV4dCwgdGl0bGU9Tm9uZSwgYWRkX3RvX2xvZz1GYWxzZSk6CiAgICAgICAgbm90aWZpY2F0aW9uX2lkID0gcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSArIDEgaWYgcnNfc2V0dGluZ3MuZ2V0KCJub3RpZmljYXRpb25faWQiKSBlbHNlIDEKICAgICAgICBpZiB0aXRsZSBpcyBOb25lOgogICAgICAgICAgICB0aXRsZSA9IHNlbGYuZ2V0X2N1cnJlbnRfc2NyZWVuKCkKCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJiYXNpY19ub3RpZmljYXRpb24iLAogICAgICAgICAgICBqc29uLmR1bXBzKFt7J251bWJlcic6IG5vdGlmaWNhdGlvbl9pZCwgJ3RpdGxlJzogc3RyKHRpdGxlKSwgJ21lc3NhZ2UnOiB0ZXh0fV0pCiAgICAgICAgKQoKICAgICAgICByc19zZXR0aW5ncy5wdXQoIm5vdGlmaWNhdGlvbl9pZCIsIG5vdGlmaWNhdGlvbl9pZCwgVHJ1ZSkKICAgICAgICBpZiBhZGRfdG9fbG9nOgogICAgICAgICAgICBzZWxmLmVycm9yX2xvZyh0ZXh0KQoKICAgIGRlZiBkZWJ1ZyhzZWxmLCB0ZXh0KToKICAgICAgICBpZiBzZWxmLmRlYnVnX21vZGU6CiAgICAgICAgICAgIHNlbGYudG9hc3QodGV4dCwgYWRkX3RvX2xvZz1UcnVlKQoKICAgIGRlZiByZWZyZXNoX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnUmVmcmVzaFNjcmVlbicsICcnKQoKICAgIGRlZiBydW5fZXZlbnQoc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSkpCgogICAgZGVmIHJ1bl9ldmVudF9hc3luYyhzZWxmLCBtZXRob2RfbmFtZSwgcG9zdF9leGVjdXRlX21ldGhvZD1Ob25lKToKICAgICAgICBydW5fZXZlbnQgPSBzZWxmLl9nZXRfZXZlbnQobWV0aG9kX25hbWUsICdydW5hc3luYycpCiAgICAgICAgaWYgcG9zdF9leGVjdXRlX21ldGhvZDoKICAgICAgICAgICAgcnVuX2V2ZW50WzBdWydwb3N0RXhlY3V0ZSddID0ganNvbi5kdW1wcyhzZWxmLl9nZXRfZXZlbnQocG9zdF9leGVjdXRlX21ldGhvZCkpCiAgICAgICAgc2VsZlsnUnVuRXZlbnQnXSA9IGpzb24uZHVtcHMocnVuX2V2ZW50KQoKICAgIGRlZiBydW5fZXZlbnRfcHJvZ3Jlc3Moc2VsZiwgbWV0aG9kX25hbWUpOgogICAgICAgIHNlbGZbJ1J1bkV2ZW50J10gPSBqc29uLmR1bXBzKHNlbGYuX2dldF9ldmVudChtZXRob2RfbmFtZSwgJ3J1bnByb2dyZXNzJykpCgogICAgZGVmIGJlZXAoc2VsZiwgdG9uZT0nJyk6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ2JlZXAnLCBzdHIodG9uZSkpCgogICAgZGVmIHBsYXlzb3VuZChzZWxmLCBldmVudDogc3RyLCBzb3VuZF92YWw6IHN0ciA9ICcnKToKICAgICAgICBpZiBub3Qgc291bmRfdmFsOgogICAgICAgICAgICBzb3VuZCA9IHJzX3NldHRpbmdzLmdldChmJ3tldmVudH1fc2lnbmFsJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzb3VuZCA9IHNvdW5kX3ZhbAogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGYncGxheXNvdW5kX3tzb3VuZH0nLCAiIikKCiAgICBkZWYgX2dldF9ldmVudChzZWxmLCBtZXRob2RfbmFtZSwgYWN0aW9uPU5vbmUpOgogICAgICAgICIiIgogICAgICAgIDpwYXJhbSBtZXRob2RfbmFtZTogaGFuZGxlcnMgbmFtZQogICAgICAgIDpwYXJhbSBhY3Rpb246IHJ1bnxydW5hc3luY3xydW5wcm9ncmVzcwoKICAgICAgICA6cmV0dXJuOiBldmVudCBkaWN0CiAgICAgICAgIiIiCgogICAgICAgIGV2dCA9IFt7CiAgICAgICAgICAgICdhY3Rpb24nOiBhY3Rpb24gaWYgYWN0aW9uIGVsc2UgJ3J1bicsCiAgICAgICAgICAgICd0eXBlJzogJ3B5dGhvbicsCiAgICAgICAgICAgICdtZXRob2QnOiBtZXRob2RfbmFtZSwKICAgICAgICB9XQoKICAgICAgICByZXR1cm4gZXZ0CgogICAgZGVmIGVycm9yX2xvZyhzZWxmLCBlcnJfZGF0YSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBlcnJfZGF0YSA9IGpzb24uZHVtcHMoZXJyX2RhdGEsIGVuc3VyZV9hc2NpaT1GYWxzZSwgaW5kZW50PTIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBlcnJfZGF0YSA9IHN0cihlcnJfZGF0YSkKCiAgICAgICAgcnNfc2V0dGluZ3MucHV0KCdlcnJvcl9sb2cnLCBlcnJfZGF0YSwgVHJ1ZSkKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaXRlbSk6CiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0KGl0ZW0sIEZhbHNlKQoKICAgIGRlZiBfX3NldGl0ZW1fXyhzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBzZWxmLnB1dChrZXksIHZhbHVlLCBGYWxzZSkKCiAgICBkZWYgZ2V0KHNlbGYsIGl0ZW0sIGZyb21fanNvbj1GYWxzZSk6CiAgICAgICAgaWYgZnJvbV9qc29uOgogICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhzZWxmLmhhc2hfbWFwLmdldChpdGVtKSkgaWYgc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkgZWxzZSBOb25lCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pCgogICAgZGVmIGdldF9qc29uKHNlbGYsIGl0ZW0pOgogICAgICAgIHJldHVybiBqc29uLmxvYWRzKHNlbGYuaGFzaF9tYXAuZ2V0KGl0ZW0pKSBpZiBzZWxmLmhhc2hfbWFwLmdldChpdGVtKSBlbHNlIE5vbmUKCiAgICBkZWYgZ2V0X2Jvb2woc2VsZiwgaXRlbSk6CiAgICAgICAgdmFsdWUgPSBzdHIoc2VsZi5oYXNoX21hcC5nZXQoaXRlbSkpLmxvd2VyKCkgbm90IGluICgnMCcsICdmYWxzZScsICdub25lJykKICAgICAgICByZXR1cm4gdmFsdWUKCiAgICBkZWYgcHV0KHNlbGYsIGtleSwgdmFsdWU6IFVuaW9uW3N0ciwgTGlzdCwgRGljdCwgYm9vbF0gPSAnJywgdG9fanNvbj1GYWxzZSk6CiAgICAgICAgaWYgdG9fanNvbjoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoa2V5LCBqc29uLmR1bXBzKHZhbHVlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCBib29sKToKICAgICAgICAgICAgICAgIHZhbHVlID0gc3RyKHZhbHVlKS5sb3dlcigpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KGtleSwgc3RyKHZhbHVlKSkKCiAgICBkZWYgcHV0X2RhdGEoc2VsZiwgZGF0YTogZGljdCwgZmlsbF9ub25lPUZhbHNlLCBkZWZhdWx0PScnKToKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBkYXRhLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBpZiB2YWx1ZSBpcyBOb25lIGFuZCBmaWxsX25vbmU6CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0CgogICAgICAgICAgICAgICAgc2VsZltrZXldID0gdmFsdWUKCiAgICBkZWYgY29udGFpbnNLZXkoc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5oYXNoX21hcC5jb250YWluc0tleShrZXkpCgogICAgZGVmIGtleV9zZXQoc2VsZikgLT4gc3RyOgogICAgICAgIHJldHVybiBzZWxmLmhhc2hfbWFwLmtleVNldCgpCgogICAgZGVmIGtleXMoc2VsZikgLT4gTGlzdFtzdHJdOgogICAgICAgIGtleXMgPSBzdHIoc2VsZi5rZXlfc2V0KCkpCiAgICAgICAgcmV0dXJuIGtleXNbMTpsZW4oa2V5cyktMV0uc3BsaXQoJywgJykKCiAgICBkZWYgaXRlbXMoc2VsZikgLT4gTGlzdFtUdXBsZVtzdHIsIE9wdGlvbmFsW3N0cl1dXToKICAgICAgICByZXR1cm4gWyhrZXksIHNlbGZba2V5XSkgZm9yIGtleSBpbiBzZWxmLmtleXMoKV0KCiAgICBkZWYgc2hvd19pdGVtcygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgb25seTogT3B0aW9uYWxbTGlzdFtzdHJdXSA9IE5vbmUsCiAgICAgICAgICAgIGV4Y2x1ZGU6IE9wdGlvbmFsW0xpc3Rbc3RyXV0gPSBOb25lLAogICAgICAgICAgICBpc192YWx1ZV9leGlzdHM6IGJvb2wgPSBGYWxzZSwKICAgICkgLT4gTm9uZToKICAgICAgICB0ZXh0ID0gJ9Ch0L/QuNGB0L7QuiDRjdC70LXQvNC10L3RgtC+0LIgSGFzaE1hcDogXG4nCiAgICAgICAgaWYgaXNfdmFsdWVfZXhpc3RzOgogICAgICAgICAgICB0ZXh0ICs9ICdUcnVlINC10YHQu9C4INC10YHRgtGMINC70Y7QsdC+0LUg0LfQvdCw0YfQtdC90LjQtSBcbicKICAgICAgICBoYXNobWFwX2tleXMgPSBzZWxmLmtleXMoKQogICAgICAgIGl0ZW1zID0gc2VsZi5pdGVtcygpCiAgICAgICAgaWYgb25seToKICAgICAgICAgICAgaXRlbXMgPSBbaXRlbSBmb3IgaXRlbSBpbiBpdGVtcyBpZiBpdGVtWzBdIGluIG9ubHldCiAgICAgICAgICAgIGZvciBrZXkgaW4gb25seToKICAgICAgICAgICAgICAgIGlmIGtleSBub3QgaW4gaGFzaG1hcF9rZXlzOgogICAgICAgICAgICAgICAgICAgIGl0ZW1zLmFwcGVuZCgoa2V5LCAn0J3QtdGCINC60LvRjtGH0LAnKSkKICAgICAgICBpZiBleGNsdWRlOgogICAgICAgICAgICBpdGVtcyA9IFtpdGVtIGZvciBpdGVtIGluIGl0ZW1zIGlmIGl0ZW1bMF0gbm90IGluIGV4Y2x1ZGVdCgogICAgICAgIGZvciBrZXksIHZhbHVlIGluIGl0ZW1zOgogICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIGlmIG5vdCBpc192YWx1ZV9leGlzdHMgZWxzZSB2YWx1ZSBpcyBub3QgTm9uZQogICAgICAgICAgICB0ZXh0ICs9IGYne2tleX06IHt2YWx1ZX1cbicKICAgICAgICBzZWxmLnRvYXN0KHRleHQpCgoKICAgIGRlZiByZW1vdmUoc2VsZiwga2V5KToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShrZXkpCgogICAgZGVmIGRlbGV0ZShzZWxmLCBrZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKGtleSkKCiAgICBkZWYgYWRkX3RvX2N2X2xpc3QoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGVsZW1lbnQ6IFVuaW9uW3N0ciwgZGljdF0sCiAgICAgICAgICAgIGN2X2xpc3Q6IExpdGVyYWxbJ2dyZWVuX2xpc3QnLCAneWVsbG93X2xpc3QnLCAncmVkX2xpc3QnLCAnZ3JheV9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmx1ZV9saXN0JywgJ2hpZGRlbl9saXN0JywgJ29iamVjdF9pbmZvX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdG9wX2xpc3RlbmVyX2xpc3QnLCAnb2JqZWN0X2NhcHRpb25fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdF9kZXRlY3Rvcl9tb2RlJ10sCiAgICAgICAgICAgIF9kaWN0OiBib29sID0gRmFsc2UKICAgICkgLT4gTm9uZToKICAgICAgICAiIiIg0JTQvtCx0LDQstC70Y/QtdGCINCyIGN2LdGB0L/QuNGB0L7QuiDRjdC70LXQvNC10L3Rgiwg0LjQu9C4INGB0L7Qt9C00LDQtdGCINC90L7QstGL0Lkg0YHQv9C40YHQvtC6INGBINGN0YLQuNC8INGN0LvQtdC80LXQvdGC0L7QvC4KICAgICAgICAgICAgb2JqZWN0X2luZm9fbGlzdCAtINCY0L3RhNC+0YDQvNCw0YbQuNGPINC+0LEg0L7QsdGK0LXQutGC0LUgKNGB0L3QuNC30YMpLiBbeydvYmplY3QnOiBvYmplY3RfaWQ6IHN0ciwgJ2luZm8nOiB2YWx1ZX1dCiAgICAgICAgICAgIG9iamVjdF9kZXRlY3Rvcl9tb2RlIC0g0KDQtdC20LjQvCDQtNC10YLQtdC60YLQvtGA0LAuIFt7J29iamVjdF9pZCc6IG9iamVjdF9pZDogaW50LCAnbW9kZSc6IGJhcmNvZGV8b2NyfHN0b3B9XQogICAgICAgICAgICBvYmplY3RfY2FwdGlvbl9saXN0IC0g0JjQvdGE0L7RgNC80LDRhtC40Y8g0L7QsSDQvtCx0YrQtdC60YLQtSAo0YHQstC10YDRhdGDKS4gW3snb2JqZWN0Jzogb2JqZWN0X2lkOiBzdHIsICdjYXB0aW9uJzogdmFsdWV9XQogICAgICAgICAgICBzdG9wX2xpc3RlbmVyX2xpc3QgLSDQkdC70L7QutC40YDRg9C10YIg0LLRi9C/0L7Qu9C90LjQtSDQvtCx0YDQsNCx0L7RgtGH0LjQutC+0LIg0LTQu9GPINC+0LHRitC10LrRgtC+0LIg0LIg0YHQv9C40YHQutC1CiAgICAgICAgIiIiCgogICAgICAgIGlmIF9kaWN0OgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0LCBmcm9tX2pzb249VHJ1ZSkgb3IgW10KICAgICAgICAgICAgaWYgZWxlbWVudCBub3QgaW4gbHN0OgogICAgICAgICAgICAgICAgbHN0LmFwcGVuZChlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwganNvbi5kdW1wcyhsc3QsIGVuc3VyZV9hc2NpaT1GYWxzZSkpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QpCiAgICAgICAgICAgIGxzdCA9IGxzdC5zcGxpdCgnOycpIGlmIGxzdCBlbHNlIFtdCiAgICAgICAgICAgIGlmIGVsZW1lbnQgbm90IGluIGxzdDoKICAgICAgICAgICAgICAgIGxzdC5hcHBlbmQoZWxlbWVudCkKICAgICAgICAgICAgICAgIHNlbGYucHV0KGN2X2xpc3QsICc7Jy5qb2luKGxzdCkpCgogICAgZGVmIHJlbW92ZV9mcm9tX2N2X2xpc3QoCiAgICAgICAgc2VsZiwKICAgICAgICBlbGVtZW50OiBVbmlvbltzdHIsIGRpY3RdLAogICAgICAgIGN2X2xpc3Q6IExpdGVyYWxbJ2dyZWVuX2xpc3QnLCAneWVsbG93X2xpc3QnLCAncmVkX2xpc3QnLCAnZ3JheV9saXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICdibHVlX2xpc3QnLCAnaGlkZGVuX2xpc3QnLCAnb2JqZWN0X2luZm9fbGlzdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAnc3RvcF9saXN0ZW5lcl9saXN0JywgJ29iamVjdF9jYXB0aW9uX2xpc3QnLAogICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdF9kZXRlY3Rvcl9tb2RlJ10sCiAgICAgICAgX2RpY3Q6IGJvb2wgPSBGYWxzZQogICAgKToKICAgICAgICAiIiLQo9C00LDQu9GP0LXRgiDQuNC3IGN2LdGB0L/QuNGB0LrQsCIiIgogICAgICAgIGlmIF9kaWN0OgogICAgICAgICAgICBsc3QgPSBzZWxmLmdldChjdl9saXN0LCBmcm9tX2pzb249VHJ1ZSkgb3IgW10KICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbHN0LnJlbW92ZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwganNvbi5kdW1wcyhsc3QsIGVuc3VyZV9hc2NpaT1GYWxzZSkpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxzdCA9IHNlbGYuZ2V0KGN2X2xpc3QpCiAgICAgICAgICAgIGxzdCA9IGxzdC5zcGxpdCgnOycpIGlmIGxzdCBlbHNlIFtdCiAgICAgICAgICAgIGlmIGVsZW1lbnQgaW4gbHN0OgogICAgICAgICAgICAgICAgbHN0LnJlbW92ZShlbGVtZW50KQogICAgICAgICAgICAgICAgc2VsZi5wdXQoY3ZfbGlzdCwgJzsnLmpvaW4obHN0KSkKCiAgICBkZWYgc2V0X3Zpc2lvbl9zZXR0aW5ncygKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAgdmFsdWVzX2xpc3Q6IHN0ciwKICAgICAgICAgICAgdHlwZV9yZWM6IHN0ciA9ICdUZXh0JywKICAgICAgICAgICAgTnVtYmVyUmVjb2duaXRpb246IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgRGF0ZVJlY29nbml0aW9uOiBib29sID0gRmFsc2UsCiAgICAgICAgICAgIFBsYXRlTnVtYmVyUmVjb2duaXRpb246IGJvb2wgPSBGYWxzZSwKICAgICAgICAgICAgbWluX2xlbmd0aDogaW50ID0gMSwKICAgICAgICAgICAgbWF4X2xlbmd0aDogaW50ID0gMjAsCiAgICAgICAgICAgIHJlc3VsdF92YXI6IHN0ciA9ICdvY3JfcmVzdWx0JywKICAgICAgICAgICAgbWVzdXJlX3F0eTogaW50ID0gMSwKICAgICAgICAgICAgbWluX2ZyZXE6IGludCA9IDEsCiAgICAgICAgICAgIHF1ZXJ5OiBzdHIgPSAnJywKICAgICAgICAgICAgY29udHJvbF9maWVsZDogc3RyID0gJycsCiAgICAgICAgICAgIGN1cnNvcjogT3B0aW9uYWxbbGlzdF0gPSBOb25lLAogICAgICAgICAgICBjb3VudF9vYmplY3RzOiBpbnQgPSAwLAogICAgICAgICAgICBSZXBsYWNlTzogYm9vbCA9IEZhbHNlLAogICAgICAgICAgICBUb1VwY2FzZTogYm9vbCA9IEZhbHNlLAogICAgKToKICAgICAgICAiIiJxdWVyeSAtIFNRTCDQt9Cw0L/RgNC+0YEg0LTQu9GPINCy0LDRgNC40LDQvdGC0LAg0L/QvtC40YHQutCwINC/0L4gU1FMLdGC0LDQsdC70LjRhtC1INGBINC+0LTQuNC90Lwg0L/QsNGA0LDQvNC10YLRgNC+0Lwo0LIg0LrQvtGC0L7RgNGL0Lkg0L/QtdGA0LXQtNCw0LXRgtGB0Y8g0YDQsNGB0L/QvtC30L3QsNC90L3Ri9C5INGC0LXQutGB0YIgKQogICAgICAgICAgICAgICAg0J3QsNC/0YDQuNC80LXRgDogc2VsZWN0ICogZnJvbSBTV19Hb29kcyB3aGVyZSBwcm9kdWN0X251bWJlciBsaWtlICA/CiAgICAgICAgICAgY29udHJvbF9maWVsZCAtINC/0L7Qu9C1INGC0LDQsdC70LjRhtGLINC/0L4g0LrQvtGC0L7RgNC+0LzRgyDQv9GA0L7QstC10YDRj9C10YLRgdGPIE9DUiAsINGD0YHQu9C+0LLQvdC+INCQ0YDRgtC40LrRg9C7ICjQvdC10YHQvNC+0YLRgNGPINC90LAg0YLQviwg0YfRgtC+INCyIHF1ZXJ5INC+0L3QviDRgdC60L7RgNC10LUg0LLRgdC10LPQviDRgtCw0LrQttC1INGD0YfQsNGB0YLQstGD0LXRgikKICAgICAgICAgICBjdXJzb3IgLSDQnNCw0YHRgdC40LIgINGBINC+0LHRitC10LrRgtCw0LzQuCB7ImZpZWxkIjo80L/QvtC70LUg0YLQsNCx0LvQuNGG0Ys+LCJ2YXIiOjzQv9C10YDQtdC80LXQvdC90LDRjyDRgNC10LfRg9C70YzRgtCw0YI+fQogICAgICAgICAgIHZhbHVlc19saXN0IC0g0KDQtdC20LjQvCDQv9C+0LjRgdC60LAg0L/QviDRgdC/0LjRgdC60YMsINC70LjQsdC+INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QvCAoIn4iKQogICAgICAgICAgIG1lc3VyZV9xdHkgLSDQmtC+0LvQuNGH0LXRgdGC0LLQviDQuNC30LzQtdGA0LXQvdC40Lkg0L/Qu9C+0YLQvdC+0YHRgtC4INCy0LXRgNC+0Y/RgtC90L7RgdGC0LggKNC90L7RgNC8LiDRgNCw0YHQv9GA0LXQtNC10LvQtdC90LjQtSkKICAgICAgICAgICBtaW5fZnJlcSAtINCS0LXRgNC+0Y/RgtC90L7RgdGC0YwgKNCyINC/0YDQvtGG0LXQvdGC0LDRhSDQvtGCIDAg0LTQviAxMDAg0LTQu9GPINGD0LTQvtCx0YHRgtCy0LAg0LLQstC+0LTQsCkKICAgICAgICAgICBtaW5fbGVuZ3RoIC0g0JzQuNC90LjQvNCw0LvRjNC90LDRjyDQtNC70LjQvdCwINGC0LXQutGB0YLQsAogICAgICAgICAgIG1heF9sZW5ndGggLSDQnNCw0LrRgdC40LzQsNC70YzQvdCw0Y8g0LTQu9C40L3QsCDRgtC10LrRgdGC0LAKICAgICAgICAgICBjb3VudF9vYmplY3RzIC0g0JTQu9GPIE51bWJlclJlY29nbml0aW9uINC60L7Qu9C40YfQtdGB0YLQstC+INGG0LjQutC70L7QsiDQuNC30LzQtdGA0LXQvdC40Lkg0LTQu9GPINGA0LXRiNC10L3QuNGPINC60L7QvNCx0LjQvdCw0YLQvtGA0L3QvtC5INC30LDQtNCw0YfQuC4g0KfQtdC8INCx0L7Qu9GM0YjQtSDRhtC40LrQu9C+0LIg0YLQtdC8INCx0L7Qu9GM0YjQtSDRgtC+0YfQvdC+0YHRgtGMCiAgICAgICAgICAgUmVwbGFjZU8gLSDQl9Cw0LzQtdC90LjRgtGMINCx0YPQutCy0Ysg0J4g0L3QsCAwICjQvdGD0LvQuCkKICAgICAgICAgICBUb1VwY2FzZSAtINCf0YDQtdC+0LHRgNCw0LfQvtCy0LDQvdC40LUg0LIg0LLQtdGA0YXQvdC40Lkg0YDQtdCz0LjRgdGC0YAKICAgICAgICAgICBQbGF0ZU51bWJlclJlY29nbml0aW9uIC0g0KDQvtGB0YHQuNC50YHQutC40LUg0L3QvtC80LXRgNCwICjRgtC+0LvRjNC60L4g0LTQu9GPIEFjdGl2ZUNWKQogICAgICAgICAgIE51bWJlclJlY29nbml0aW9uIC0g0KDQsNGB0L/QvtC30L3QsNCy0LDQvdC40LUg0YfQuNGB0LXQuwogICAgICAgICAgIERhdGVSZWNvZ25pdGlvbiAtINCg0LDRgdC/0L7Qt9C90LDQstC90LjQtSDQtNCw0YIKICAgICAgICAgICByZXN1bHRfZmllbGQgINC00LvRjyDRgNCw0YHQv9C+0LfQvdCy0LDQvdC40Y8g0LTQsNGCINC4INC90L7QvNC10YDQvtCyLCDRgtGD0LTQsCDQv9C+0LzQtdGJ0LDQtdGC0YHRjyDRgNC10LfRg9C70YzRgtCw0YLRiyDQvtGB0L7QsdGL0Lwg0L7QsdGA0LDQt9C+0LwgKNGB0LzQvtGC0YDRjyDRh9GC0L4g0LjRidC10LwpIiIiCiAgICAgICAgaWYgY3Vyc29yIGlzIE5vbmU6CiAgICAgICAgICAgIGN1cnNvciA9IFtdCiAgICAgICAgc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICJUeXBlUmVjb2duaXRpb24iOiB0eXBlX3JlYywKICAgICAgICAgICAgIk51bWJlclJlY29nbml0aW9uIjogTnVtYmVyUmVjb2duaXRpb24sCiAgICAgICAgICAgICJEYXRlUmVjb2duaXRpb24iOiBEYXRlUmVjb2duaXRpb24sCiAgICAgICAgICAgICJQbGF0ZU51bWJlclJlY29nbml0aW9uIjogUGxhdGVOdW1iZXJSZWNvZ25pdGlvbiwKICAgICAgICAgICAgIm1pbl9sZW5ndGgiOiBtaW5fbGVuZ3RoLAogICAgICAgICAgICAibWF4X2xlbmd0aCI6IG1heF9sZW5ndGgsCiAgICAgICAgICAgICJ2YWx1ZXNfbGlzdCI6IHZhbHVlc19saXN0LAogICAgICAgICAgICAicmVzdWx0X3ZhciI6IHJlc3VsdF92YXIsCiAgICAgICAgICAgICJtZXN1cmVfcXR5IjogbWVzdXJlX3F0eSwKICAgICAgICAgICAgIm1pbl9mcmVxIjogbWluX2ZyZXEsCiAgICAgICAgICAgICJxdWVyeSI6IHF1ZXJ5LAogICAgICAgICAgICAiY29udHJvbF9maWVsZCI6IGNvbnRyb2xfZmllbGQsCiAgICAgICAgICAgICJjdXJzb3IiOiBjdXJzb3IsCiAgICAgICAgICAgICJjb3VudF9vYmplY3RzIjogY291bnRfb2JqZWN0cywKICAgICAgICAgICAgIlJlcGxhY2VPIjogUmVwbGFjZU8sCiAgICAgICAgICAgICJUb1VwY2FzZSI6IFRvVXBjYXNlCiAgICAgICAgfQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTZXRWaXNpb25TZXR0aW5ncyIsIGpzb24uZHVtcHMoc2V0dGluZ3MpKQoKICAgIGRlZiBzaG93X3NjcmVlbihzZWxmLCBuYW1lLCBkYXRhPU5vbmUpOgogICAgICAgIHNlbGYucHV0KCdTaG93U2NyZWVuJywgbmFtZSkKICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICBzZWxmLnB1dF9kYXRhKGRhdGEpCgogICAgZGVmIHNob3dfcHJvY2Vzc19yZXN1bHQoc2VsZiwgcHJvY2Vzcywgc2NyZWVuLCBkYXRhOiBkaWN0ID0gTm9uZSk6CiAgICAgICAgaWYgcHJvY2VzcyBhbmQgc2NyZWVuOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgnU2hvd1Byb2Nlc3NSZXN1bHQnLCBmJ3twcm9jZXNzfXx7c2NyZWVufScpCgogICAgICAgICAgICBpZiBkYXRhOgogICAgICAgICAgICAgICAgc2VsZi5wdXRfZGF0YShkYXRhKQoKICAgIGRlZiBzd2l0Y2hfcHJvY2Vzc19zY3JlZW4oc2VsZiwgcHJvY2Vzczogc3RyLCBzY3JlZW46IE9wdGlvbmFsW3N0cl0gPSBOb25lKToKICAgICAgICBwcm9jZXNzX3NjcmVlbiA9IGYne3Byb2Nlc3N9fHtzY3JlZW59JyBpZiBzY3JlZW4gZWxzZSBwcm9jZXNzCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ1N3aXRjaFByb2Nlc3NTY3JlZW4nLCBwcm9jZXNzX3NjcmVlbikKCiAgICBkZWYgc2hvd19kaWFsb2coc2VsZiwgbGlzdGVuZXIsIHRpdGxlPScnLCBidXR0b25zPU5vbmUsIGRpYWxvZ19sYXlvdXQ9Tm9uZSk6CiAgICAgICAgc2VsZi5wdXQoIlNob3dEaWFsb2ciLCBsaXN0ZW5lcikKICAgICAgICAKICAgICAgICBpZiBkaWFsb2dfbGF5b3V0OgogICAgICAgICAgICBzZWxmLnB1dCgnU2hvd0RpYWxvZ0xheW91dCcsIGRpYWxvZ19sYXlvdXQpCgogICAgICAgIGlmIHRpdGxlIG9yIGJ1dHRvbnM6CiAgICAgICAgICAgIGRpYWxvZ19zdHlsZSA9IHsKICAgICAgICAgICAgICAgICd0aXRsZSc6IHRpdGxlIG9yIGxpc3RlbmVyLAogICAgICAgICAgICAgICAgJ3llcyc6ICfQntC6JywKICAgICAgICAgICAgICAgICdubyc6ICfQntGC0LzQtdC90LAnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgYnV0dG9ucyBhbmQgbGVuKGJ1dHRvbnMpID4gMToKICAgICAgICAgICAgICAgIGRpYWxvZ19zdHlsZVsneWVzJ10gPSBidXR0b25zWzBdCiAgICAgICAgICAgICAgICBkaWFsb2dfc3R5bGVbJ25vJ10gPSBidXR0b25zWzFdCgogICAgICAgICAgICBzZWxmLnB1dCgnU2hvd0RpYWxvZ1N0eWxlJywgZGlhbG9nX3N0eWxlKQoKICAgIGRlZiBnZXRfY3VycmVudF9zY3JlZW4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2N1cnJlbnRfc2NyZWVuX25hbWUnXSBpZiBzZWxmLmNvbnRhaW5zS2V5KCdjdXJyZW50X3NjcmVlbl9uYW1lJykgZWxzZSAnJwoKICAgIGRlZiBnZXRfcGFyZW50X3NjcmVlbihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZlsncGFyZW50X3NjcmVlbiddIGlmIHNlbGYuY29udGFpbnNLZXkoJ3BhcmVudF9zY3JlZW4nKSBlbHNlICcnCgogICAgZGVmIGdldF9jdXJyZW50X3Byb2Nlc3Moc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGZbJ2N1cnJlbnRfcHJvY2Vzc19uYW1lJ10KCiAgICBkZWYgc2V0X3RpdGxlKHNlbGYsIHRpdGxlKToKICAgICAgICBzZWxmWydTZXRUaXRsZSddID0gdGl0bGUKCiAgICBkZWYgcnVuX3B5X3RocmVhZF9wcm9ncmVzcyhzZWxmLCBoYW5kbGVyc19uYW1lOiBzdHIpOgogICAgICAgICIiIgogICAgICAgINCX0LDQv9GD0YHQutCw0LXRgiDQsNGB0LjQvdGF0YDQvtC90L3QvtC1INGE0L7QvdC+0LLQvtC1INCy0YvQv9C+0LvQvdC10L3QuNC1INGB0LrRgNC40L/RgtCwIGMg0LHQu9C+0LrQuNGA0YPRjtGJ0LjQvCDQv9GA0L7Qs9GA0LXRgdGBLdCx0LDRgNC+0LwsINC60L7RgtC+0YDRi9C5INCx0LvQvtC60LjRgNGD0LXRgiBVSS3Qv9C+0YLQvtC6LgogICAgICAgINCSINC60LDRh9C10YHRgtCy0LUg0LDRgNCz0YPQvNC10L3RgtCwIC0g0LjQvNGPINGE0YPQvdC60YbQuNC4LdGF0LXQvdC00LvQtdGA0LAuCiAgICAgICAgIiIiCgogICAgICAgIHNlbGZbJ1J1blB5VGhyZWFkUHJvZ3Jlc3NEZWYnXSA9IGhhbmRsZXJzX25hbWUKCiAgICBkZWYgc3FsX2V4ZWMoc2VsZiwgcXVlcnksIHBhcmFtcz0nJyk6CiAgICAgICAgc2VsZi5fcHV0X3NxbCgnU1FMRXhlYycsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIHNxbF9leGVjX21hbnkoc2VsZiwgcXVlcnksIHBhcmFtcz1Ob25lKToKICAgICAgICBwYXJhbXMgPSBwYXJhbXMgb3IgW10KICAgICAgICBzZWxmLl9wdXRfc3FsKCdTUUxFeGVjTWFueScsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIHNxbF9xdWVyeShzZWxmLCBxdWVyeSwgcGFyYW1zPScnKToKICAgICAgICBzZWxmLl9wdXRfc3FsKCdTUUxRdWVyeScsIHF1ZXJ5LCBwYXJhbXMpCgogICAgZGVmIF9wdXRfc3FsKHNlbGYsIHNxbF90eXBlLCBxdWVyeSwgcGFyYW1zKToKICAgICAgICBzZWxmLnB1dCgKICAgICAgICAgICAgc3FsX3R5cGUsCiAgICAgICAgICAgIHsicXVlcnkiOiBxdWVyeSwgJ3BhcmFtcyc6IHBhcmFtc30sCiAgICAgICAgICAgIHRvX2pzb249VHJ1ZQogICAgICAgICkKCiAgICBkZWYgYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZlsnQmFja1NjcmVlbiddID0gJycKCiAgICBkZWYgbm9fcmVmcmVzaChzZWxmKToKICAgICAgICBzZWxmWydOb1JlZnJlc2gnXSA9ICcnCgoKY2xhc3MgQmFyY29kZVBhcnNlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBiYXJjb2RlKToKICAgICAgICBzZWxmLmJhcmNvZGUgPSBiYXJjb2RlCiAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8gPSBCYXJjb2RlUGFyc2VyLkJhcmNvZGVJbmZvKGJhcmNvZGU9YmFyY29kZSkKICAgICAgICBzZWxmLm1hY3JvXzA1ID0gZidbKT57Y2hyKDMwKX0wNScKICAgICAgICBzZWxmLm1hY3JvXzA2ID0gZidbKT57Y2hyKDMwKX0wNicKICAgICAgICBzZWxmLmdzMV9zZXBhcmF0b3IgPSBjaHIoMjkpCiAgICAgICAgc2VsZi5pZGVudGlmaWVyID0gJ11kMicKCiAgICBkZWYgcGFyc2Uoc2VsZiwgYXNfZGljdD1UcnVlKToKICAgICAgICBpZiBzZWxmLmlzX3ZhbGlkX2VhbjEzKHNlbGYuYmFyY29kZSk6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdFQU4xMycKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IHNlbGYuYmFyY29kZQoKICAgICAgICBlbGlmIGxlbihzZWxmLmJhcmNvZGUpID09IDI5OgogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5zY2hlbWUgPSAnR1MxJwogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gc2VsZi5iYXJjb2RlWzA6MTRdCiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbCA9IHNlbGYuYmFyY29kZVsxNDoyMV0KICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubXJjID0gc2VsZi5iYXJjb2RlWzIxOjI1XQogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5jaGVjayA9IHNlbGYuYmFyY29kZVsyNToyOV0KCiAgICAgICAgZWxpZiBzZWxmLmdzMV9zZXBhcmF0b3IgaW4gc2VsZi5iYXJjb2RlIG9yICc8R1M+JyBpbiBzZWxmLmJhcmNvZGU6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdHUzEnCiAgICAgICAgICAgIHNlbGYuY2hlY2tfZGF0YW1hdHJpeChzZWxmLmJhcmNvZGUpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9ICdVTktOT1dOJwogICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5ndGluID0gc2VsZi5iYXJjb2RlCgogICAgICAgIGlmIGFzX2RpY3Q6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmJhcmNvZGVfaW5mby5kaWN0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi5iYXJjb2RlX2luZm8KCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgaXNfdmFsaWRfZWFuMTMoY29kZSk6CiAgICAgICAgcGF0dGVybiA9IHInXlxkezEzfSQnCiAgICAgICAgaWYgbm90IHJlLm1hdGNoKHBhdHRlcm4sIGNvZGUpOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgZmFjdG9ycyA9IFsxLCAzXSAqIDYKICAgICAgICBjaGVja3N1bSA9IHN1bShpbnQoY29kZVtpXSkgKiBmYWN0b3JzW2ldIGZvciBpIGluIHJhbmdlKDEyKSkKICAgICAgICBjaGVja3N1bSA9ICgxMCAtIChjaGVja3N1bSAlIDEwKSkgJSAxMAoKICAgICAgICByZXR1cm4gY2hlY2tzdW0gPT0gaW50KGNvZGVbLTFdKQoKICAgIGRlZiBjaGVja19kYXRhbWF0cml4KHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGJhcmNvZGUgPSBzZWxmLmNsZWFyX2lkZW50aWZpZXIoYmFyY29kZSkKICAgICAgICBzZWxmLmNoZWNrX2dzMV9ndGluKGJhcmNvZGUpCgogICAgZGVmIGNoZWNrX2dzMV9ndGluKHNlbGYsIGJhcmNvZGU6IHN0cik6CiAgICAgICAgaWYgc2VsZi5nczFfc2VwYXJhdG9yIGluIGJhcmNvZGU6CiAgICAgICAgICAgIHdoaWxlIGJhcmNvZGU6CiAgICAgICAgICAgICAgICBpZiBiYXJjb2RlWzoyXSA9PSAnMDEnOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmd0aW4gPSBiYXJjb2RlWzI6MTZdCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGJhcmNvZGUpID4gMTY6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzE2Ol0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gTm9uZQoKICAgICAgICAgICAgICAgIGVsaWYgYmFyY29kZVs6M10gPT0gY2hyKDI5KSArICcwMSc6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZ3RpbiA9IGJhcmNvZGVbMzoxN10KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYmFyY29kZSkgPiAxNzoKICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbMTc6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMTcnOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmV4cGlyeSA9IGJhcmNvZGVbMjo4XQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihiYXJjb2RlKSA+IDg6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzg6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnMTAnOgogICAgICAgICAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmJhdGNoID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmJhdGNoID0gYmFyY29kZVsyOl0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICcyMSc6CiAgICAgICAgICAgICAgICAgICAgaWYgY2hyKDI5KSBpbiBiYXJjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGJhcmNvZGUuaW5kZXgoY2hyKDI5KSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLnNlcmlhbCA9IGJhcmNvZGVbMjpdCiAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTEnOgogICAgICAgICAgICAgICAgICAgIGlmIGNocigyOSkgaW4gYmFyY29kZToKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBiYXJjb2RlLmluZGV4KGNocigyOSkpCgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5uaHJuID0gYmFyY29kZVsyOmluZGV4XQogICAgICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVtpbmRleCArIDE6XQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLm5ocm4gPSBiYXJjb2RlWzI6Nl0KICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IE5vbmUKCiAgICAgICAgICAgICAgICBlbGlmIGJhcmNvZGVbOjJdID09ICc5Myc6ICAjINCc0L7Qu9C+0YfQutCwLCDQstC+0LTQsAogICAgICAgICAgICAgICAgICAgIHNlbGYuYmFyY29kZV9pbmZvLmNoZWNrID0gYmFyY29kZVsyOjZdCiAgICAgICAgICAgICAgICAgICAgYmFyY29kZSA9IGJhcmNvZGVbNzpdCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzoyXSA9PSAnOTInOiAgIyDQlNCw0LvQtdC1INGB0LvQtdC00YPQtdGCINC60L7QtCDQv9GA0L7QstC10YDQutC4LCA0NCDRgdC40LzQstC+0LvQsAogICAgICAgICAgICAgICAgICAgICMgaWYgbGVuKGJhcmNvZGVbMjpdKT09NDQ6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uY2hlY2sgPSBiYXJjb2RlWzI6XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzo0XSA9PSAnODAwNSc6ICAjINCi0LDQsdCw0LosINCR0LvQvtC6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8ubmhybiA9IGJhcmNvZGVbNDoxMF0KICAgICAgICAgICAgICAgICAgICBiYXJjb2RlID0gYmFyY29kZVsxMTpdCgogICAgICAgICAgICAgICAgZWxpZiBiYXJjb2RlWzo0XSA9PSAnMzEwMyc6ICAjINCc0L7Qu9C+0YfQutCwINGBINCS0LXRgdC+0LwKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby53ZWlnaHQgPSBiYXJjb2RlWzQ6XQogICAgICAgICAgICAgICAgICAgIGJhcmNvZGUgPSBOb25lCgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmJhcmNvZGVfaW5mby5lcnJvciA9ICdJTlZBTElEIEJBUkNPREUnCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8uZXJyb3IgPSAnTm8gR1MgU2VwYXJhdG9yJwoKICAgICAgICAjIGlmICgnR1RJTicgLCAnQkFUQ0gnICwgJ0VYUElSWScgLCAnU0VSSUFMJykgaW4gcmVzdWx0LmtleXMoKToKICAgICAgICAjICAgICBpZiBndGluX2NoZWNrKHJlc3VsdFsnR1RJTiddKSA9PSBGYWxzZSBhbmQgZXhwaXJ5X2RhdGVfY2hlY2socmVzdWx0WydFWFBJUlknXSkgPT0gRmFsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgR1RJTiAmIEVYUElSWSBEQVRFJywgJ0JBUkNPREUnOiByZXN1bHR9CiAgICAgICAgIyAgICAgZWxpZiBleHBpcnlfZGF0ZV9jaGVjayhyZXN1bHRbJ0VYUElSWSddKSA9PSBGYWxzZToKICAgICAgICAjICAgICAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5WQUxJRCBFWFBJUlkgREFURScsICdCQVJDT0RFJzogcmVzdWx0fQogICAgICAgICMgICAgIGVsaWYgZ3Rpbl9jaGVjayhyZXN1bHRbJ0dUSU4nXSkgPT0gRmFsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiB7J0VSUk9SJzogJ0lOVkFMSUQgR1RJTicsICdCQVJDT0RFJzogcmVzdWx0fQogICAgICAgICMgICAgIGVsc2U6CiAgICAgICAgIyAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcmV0dXJuIHsnRVJST1InOiAnSU5DT01QTEVURSBEQVRBJywgJ0JBUkNPREUnOiByZXN1bHR9CgogICAgZGVmIGNsZWFyX2lkZW50aWZpZXIoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgIiIiCiAgICAgICAgTW9zdCBiYXJjb2RlIHNjYW5uZXJzIHByZXBlbmQgJ11kMicgaWRlbnRpZmllciBmb3IgdGhlIEdTMSBkYXRhbWF0cml4LgogICAgICAgIFRoaXMgc2VjdGlvbiByZW1vdmVzIHRoZSBpZGVudGlmaWVyLgogICAgICAgICIiIgoKICAgICAgICBpZiBiYXJjb2RlWzozXSA9PSBzZWxmLmlkZW50aWZpZXI6CiAgICAgICAgICAgIGJhcmNvZGUgPSBiYXJjb2RlWzM6XQoKICAgICAgICByZXR1cm4gYmFyY29kZQoKICAgIEBkYXRhY2xhc3MKICAgIGNsYXNzIEJhcmNvZGVJbmZvOgogICAgICAgIGJhcmNvZGU6IHN0ciA9ICcnCiAgICAgICAgc2NoZW1lOiBzdHIgPSAnJwogICAgICAgIHNlcmlhbDogc3RyID0gJycKICAgICAgICBndGluOiBzdHIgPSAnJwogICAgICAgIGVycm9yOiBzdHIgPSAnJwogICAgICAgIG1yYzogc3RyID0gJycKICAgICAgICBjaGVjazogc3RyID0gJycKICAgICAgICBmdWxsX2NvZGU6IHN0ciA9ICcnCiAgICAgICAgZXhwaXJ5OiBzdHIgPSAnJwogICAgICAgIGJhdGNoOiBzdHIgPSAnJwogICAgICAgIG5ocm46IHN0ciA9ICcnCiAgICAgICAgd2VpZ2h0OiBzdHIgPSAnJwoKICAgICAgICBkZWYgZGljdChzZWxmKToKICAgICAgICAgICAgcmV0dXJuIHtrLnVwcGVyKCk6IHN0cih2KSBmb3IgaywgdiBpbiBhc2RpY3Qoc2VsZikuaXRlbXMoKSBpZiB2fQoKCmNsYXNzIERhdGVGb3JtYXQ6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF9ub3dfbm9zcWxfZm9ybWF0KCkgLT4gc3RyOgogICAgICAgIHV0Y19kYXRlID0gZGF0ZXRpbWUudXRjbm93KCkKICAgICAgICByZXR1cm4gdXRjX2RhdGUuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIikKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2V0X3RhYmxlX3ZpZXdfZm9ybWF0KGRhdGU6IHN0ciwgdXNlcl90bXpfb2Zmc2V0PU5vbmUpIC0+IHN0cjoKICAgICAgICB1c2VyX3Rtel9vZmZzZXQgPSB1c2VyX3Rtel9vZmZzZXQgb3IgcnNfc2V0dGluZ3MuZ2V0KCd1c2VyX3Rtel9vZmZzZXQnKQogICAgICAgIHRpbWV6b25lX29mZnNldCA9IHRpbWVkZWx0YShob3Vycz1pbnQodXNlcl90bXpfb2Zmc2V0KSkKICAgICAgICBkdF9kYXRlID0gZGF0ZXRpbWUuc3RycHRpbWUoZGF0ZSwgIiVZLSVtLSVkICVIOiVNOiVTIikKICAgICAgICByZXR1cm4gc3RyKGR0X2RhdGUgKyB0aW1lem9uZV9vZmZzZXQpCgoKZGVmIGdldF9pcF9hZGRyZXNzKCk6CiAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICB0cnk6CiAgICAgICAgcy5jb25uZWN0KCgiOC44LjguOCIsIDgwKSkKICAgICAgICBpcF9hZGRyZXNzID0gcy5nZXRzb2NrbmFtZSgpWzBdCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgaXBfYWRkcmVzcyA9IE5vbmUKICAgIGZpbmFsbHk6CiAgICAgICAgcy5jbG9zZSgpCgogICAgcmV0dXJuIGlwX2FkZHJlc3MK"
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\widgets.py",
                "PyFileKey": "widgets",
                "PyFileData": "ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdHlwaW5nIGltcG9ydCBMaXN0CmltcG9ydCBqc29uCgp3cmFwX2NvbnRlbnQgPSAid3JhcF9jb250ZW50IgptYXRjaF9wYXJlbnQgPSAnbWF0Y2hfcGFyZW50JwoKCmNsYXNzIFdpZGdldChBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZTogc3RyCiAgICAgICAgc2VsZi5WYWx1ZTogc3RyCiAgICAgICAgc2VsZi53aWR0aCA9IHdyYXBfY29udGVudAogICAgICAgIHNlbGYuaGVpZ2h0ID0gd3JhcF9jb250ZW50CiAgICAgICAgc2VsZi53ZWlnaHQgPSAwCgogICAgICAgIGlmIGt3YXJnczoKICAgICAgICAgICAgZm9yIGtleSwgdmFsdWUgaW4ga3dhcmdzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBzZWxmLl9fZGljdF9fW2tleV0gPSB2YWx1ZQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZidXaWRnZXQodHlwZT17c2VsZi50eXBlfSwgVmFsdWU9e3NlbGYuVmFsdWV9KScKCiAgICBkZWYgdG9fanNvbihzZWxmKToKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhzZWxmLCBkZWZhdWx0PWxhbWJkYSB4OiB2YXJzKHgpLCBpbmRlbnQ9NCkKCgpjbGFzcyBQaWN0dXJlKFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHBpYycKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQaWN0dXJlIgoKCmNsYXNzIFRleHRWaWV3KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHNlbGYuVmFsdWUgPSAnQHZhbHVlJwogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gIlRleHRWaWV3IgoKCmNsYXNzIENoZWNrQm94KFdpZGdldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKiprd2FyZ3MpCiAgICAgICAgc2VsZi50eXBlID0gJ0NoZWNrQm94JwoKCmNsYXNzIFBvcHVwTWVudUJ1dHRvbihXaWRnZXQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3dhcmdzKToKICAgICAgICBzZWxmLlZhbHVlID0gJ0B2YWx1ZScKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCoqa3dhcmdzKQogICAgICAgIHNlbGYudHlwZSA9ICJQb3B1cE1lbnVCdXR0b24iCiAgICAgICAgc2VsZi5zaG93X2J5X2NvbmRpdGlvbiA9ICcnCiAgICAgICAgc2VsZi5Ob1JlZnJlc2ggPSBGYWxzZQogICAgICAgIHNlbGYuZG9jdW1lbnRfdHlwZSA9ICcnCiAgICAgICAgc2VsZi5tYXNrID0gJycKCgpjbGFzcyBMaW5lYXJMYXlvdXQoV2lkZ2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqYXJncywgKiprd2FyZ3MpOgogICAgICAgIHNlbGYudHlwZSA9ICdMaW5lYXJMYXlvdXQnCiAgICAgICAgc2VsZi5vcmllbnRhdGlvbiA9ICJ2ZXJ0aWNhbCIKCiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygqKmt3YXJncykKICAgICAgICBzZWxmLkVsZW1lbnRzID0gbGlzdChhcmdzKSBvciBbXQoKICAgIGRlZiBhcHBlbmQoc2VsZiwgKndpZGdldHMpOgogICAgICAgIGZvciB3aWRnZXQgaW4gd2lkZ2V0czoKICAgICAgICAgICAgc2VsZi5FbGVtZW50cy5hcHBlbmQod2lkZ2V0KQoKCmNsYXNzIE9wdGlvbnM6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2VhcmNoX2VuYWJsZWQ9VHJ1ZSwgc2F2ZV9wb3NpdGlvbj1UcnVlLCBvdmVycmlkZV9zZWFyY2g9RmFsc2UpOgogICAgICAgIHNlbGYub3B0aW9ucyA9IHsKICAgICAgICAgICAgJ3NlYXJjaF9lbmFibGVkJzogc2VhcmNoX2VuYWJsZWQsCiAgICAgICAgICAgICdzYXZlX3Bvc2l0aW9uJzogc2F2ZV9wb3NpdGlvbiwKICAgICAgICAgICAgJ292ZXJyaWRlX3NlYXJjaCc6IG92ZXJyaWRlX3NlYXJjaAogICAgICAgIH0KCgpjbGFzcyBDdXN0b21DYXJkczoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgY2FyZHNkYXRhOiBMaXN0W2RpY3RdID0gW10pOgogICAgICAgIHNlbGYuY3VzdG9tY2FyZHMgPSB7CiAgICAgICAgICAgICdvcHRpb25zJzogb3B0aW9ucyBvciBPcHRpb25zKCksCiAgICAgICAgICAgICdsYXlvdXQnOiBsYXlvdXQsCiAgICAgICAgICAgICdjYXJkc2RhdGEnOiBjYXJkc2RhdGEKICAgICAgICB9CgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoc2VsZiwgZGVmYXVsdD1sYW1iZGEgeDogdmFycyh4KSwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkKCgpjbGFzcyBDdXN0b21UYWJsZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsYXlvdXQ6IExpbmVhckxheW91dCwgb3B0aW9uczogT3B0aW9ucywgdGFibGVkYXRhOiBMaXN0W2RpY3RdKToKICAgICAgICBzZWxmLmN1c3RvbXRhYmxlID0gewogICAgICAgICAgICAnb3B0aW9ucyc6IG9wdGlvbnMgb3IgT3B0aW9ucygpLAogICAgICAgICAgICAnbGF5b3V0JzogbGF5b3V0LAogICAgICAgICAgICAndGFibGVkYXRhJzogdGFibGVkYXRhCiAgICAgICAgfQoKICAgIGRlZiB0b19qc29uKHNlbGYpOgogICAgICAgIHJldHVybiBqc29uLmR1bXBzKHNlbGYsIGRlZmF1bHQ9bGFtYmRhIHg6IHZhcnMoeCksIGluZGVudD00LCBlbnN1cmVfYXNjaWk9RmFsc2UpLmVuY29kZSgndXRmOCcpLmRlY29kZSgpCgoKQGRhdGFjbGFzcwpjbGFzcyBNb2Rlcm5GaWVsZDoKICAgIGhpbnQ6IHN0ciA9ICcnCiAgICBkZWZhdWx0X3RleHQ6IHN0ciA9ICcnCiAgICBjb3VudGVyOiBib29sID0gRmFsc2UKICAgIGNvdW50ZXJfbWF4OiBpbnQgPSAwCiAgICBpbnB1dF90eXBlOiBpbnQgPSAwCiAgICBwYXNzd29yZDogYm9vbCA9IEZhbHNlCiAgICBldmVudHM6IGJvb2wgPSBGYWxzZQoKICAgICIiIgogICAgVFlQRV9OVUxMOiAwCiAgICAKICAgIFRZUEVfQ0xBU1NfTlVNQkVSOiAyCiAgICBUWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUw6IDgxOTIgCiAgICBUWVBFX05VTUJFUl9GTEFHX1NJR05FRDogNDA5NiAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfTlVNQkVSX1ZBUklBVElPTl9QQVNTV09SRDogMTYKICAgIAogICAgVFlQRV9DTEFTU19EQVRFVElNRSA6IDQKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX0RBVEU6IDE2CiAgICBUWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw6IDAKICAgIFRZUEVfREFURVRJTUVfVkFSSUFUSU9OX1RJTUU6IDMyCiAgICAKICAgIFRZUEVfQ0xBU1NfUEhPTkU6IDMKICAgIAogICAgVFlQRV9NQVNLX0NMQVNTOiAxNQogICAgVFlQRV9NQVNLX0ZMQUdTOiAxNjc3MzEyMCAKICAgIFRZUEVfTUFTS19WQVJJQVRJT046IDQwODAgCgogICAgVFlQRV9DTEFTU19URVhUOiAxCiAgICBUWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFOiA2NTUzNiAKICAgIFRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDogMzI3NjggCiAgICBUWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUzogNDA5NiAKICAgIFRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM6IDE2Mzg0IAogICAgVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTOiA4MTkyICAKICAgIFRZUEVfVEVYVF9GTEFHX0VOQUJMRV9URVhUX0NPTlZFUlNJT05fU1VHR0VTVElPTlM6IDEwNDg1NzYgCiAgICBUWVBFX1RFWFRfRkxBR19JTUVfTVVMVElfTElORTogMjYyMTQ0IAogICAgVFlQRV9URVhUX0ZMQUdfTVVMVElfTElORTogMTMxMDcyIAogICAgVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlM6IDUyNDI4OCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfQUREUkVTUzogMzIKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfU1VCSkVDVDogNDgKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fRklMVEVSOiAxNzYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX0xPTkdfTUVTU0FHRTogODAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMOiAwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEOiAxMjggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1BFUlNPTl9OQU1FOiAgOTYKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUEhPTkVUSUM6IDE5MiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fUE9TVEFMX0FERFJFU1M6IDExMiAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fU0hPUlRfTUVTU0FHRTogNjQgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1VSSTogMTYgCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1ZJU0lCTEVfUEFTU1dPUkQ6IDE0NCAKICAgIFRZUEVfVEVYVF9WQVJJQVRJT05fV0VCX0VESVRfVEVYVDogMTYwCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9FTUFJTF9BRERSRVNTOiAyMDggCiAgICBUWVBFX1RFWFRfVkFSSUFUSU9OX1dFQl9QQVNTV09SRDogMjI0IAogICAgIiIiCgogICAgZGVmIHRvX2pzb24oc2VsZik6CiAgICAgICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGRlZmF1bHQ9bGFtYmRhIHg6IHtrOiB2IGZvciBrLCB2IGluIHZhcnMoeCkuaXRlbXMoKSBpZiB2fSwKICAgICAgICAgICAgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZQogICAgICAgICkuZW5jb2RlKCd1dGY4JykuZGVjb2RlKCkK"
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\version_control.py",
                "PyFileKey": "version_control",
                "PyFileData": "aW1wb3J0IGRiX3NlcnZpY2VzCmltcG9ydCAgcmUKI2Zyb20KZGVmIGlzX3ZhbGlkX3ZlcnNpb24odmVyc2lvbik6CiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBjaGVjayBpZiB0aGUgdmVyc2lvbiBoYXMgdGhlIGNvcnJlY3QgZm9ybWF0ICh4LngueC54KQogICAgaWYgbm90IGlzaW5zdGFuY2UodmVyc2lvbiwgc3RyKToKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBwYXR0ZXJuID0gcideXGR7MSwyfShcLlxkezEsMn0pezR9JwoKICAgIHJldHVybiBib29sKHJlLm1hdGNoKHBhdHRlcm4sIHZlcnNpb24pKQoKCiPQn9C10YDQtdCx0LjRgNCw0LXQvCDRgNC10LvQuNC30Ysg0L/QviDQvtC00L3QvtC80YMuINCk0YPQvdC60YbQuNGPINC/0YvRgtCw0LXRgtGB0Y8g0L3QsNC50YLQuCDQsiDQvNC+0LTRg9C70LUg0YTRg9C90LrRhtC40Y4g0YEg0LjQvNC10L3QtdC8LAojINGB0L7QvtGC0LLQtdGC0YHRgtCy0YPRjtGJ0LjQvCDQvdC+0LzQtdGA0YMg0YDQtdC70LjQt9CwINC4INC10YHQu9C4INC90LDRiNC70LAgLSDQstGL0L/QvtC70L3QuNGC0Ywg0LXRkQpkZWYgcnVuX3JlbGVhc2VzKF9zdGFydF92ZXJzaW9uOnN0ciwgX2VuZF92ZXJzaW9uOnN0cik6CiAgICByZXR1cm5fbGlzdCA9IFtdCiAgICBpZiBub3QgaXNfdmFsaWRfdmVyc2lvbihfc3RhcnRfdmVyc2lvbikgb3Igbm90IGlzX3ZhbGlkX3ZlcnNpb24oX2VuZF92ZXJzaW9uKToKICAgICAgICByZXR1cm5fbGlzdC5hcHBlbmQoeydyZXN1bHQnOiBGYWxzZSwgJ2RldGFpbHMnOiAn0J3QtdCy0LXRgNC90YvQuSDRhNC+0YDQvNCw0YIg0LLQtdGA0YHQuNC4INC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuC4g0KTQvtGA0LzQsNGCINC60L7QvdGE0LjQs9GD0YDQsNGG0LjQuCDQtNC+0LvQttC10L0g0LHRi9GC0YwgeC54LngueCd9KQogICAgICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiAgICB2ZXJzaW9uID0gX3N0YXJ0X3ZlcnNpb24KICAgIHdoaWxlIGNvbXBhcmVfdmVyc2lvbnModmVyc2lvbiwgX2VuZF92ZXJzaW9uKSA8PSAwOgogICAgICAgIHJlbGVhc2VfZnVuY3Rpb25fbmFtZSA9ICdyJyArIHZlcnNpb24ucmVwbGFjZSgnLicsICdfJykKICAgICAgICByZWxlYXNlX2Z1bmN0aW9uID0gZ2xvYmFscygpLmdldChyZWxlYXNlX2Z1bmN0aW9uX25hbWUpCiAgICAgICAgaWYgcmVsZWFzZV9mdW5jdGlvbiBhbmQgY2FsbGFibGUocmVsZWFzZV9mdW5jdGlvbik6CgogICAgICAgICAgICByZXMgPSByZWxlYXNlX2Z1bmN0aW9uKCkKICAgICAgICAgICAgcmV0dXJuX2xpc3QuYXBwZW5kKHJlcykKICAgICAgICAjIGVsc2U6CiAgICAgICAgIyAgICAgcHJpbnQoZiJSZWxlYXNlIGZ1bmN0aW9uICd7cmVsZWFzZV9mdW5jdGlvbl9uYW1lfScgbm90IGZvdW5kLiIpCgogICAgICAgIHZlcnNpb24gPSBpbmNyZW1lbnRfdmVyc2lvbih2ZXJzaW9uKQoKICAgIHJldHVybiByZXR1cm5fbGlzdAoKCiPQodGA0LDQstC90LjQstCw0LXQvCDQvdC+0LzQtdGA0LAg0LLQtdGA0YHQuNC4LiDQktC+0LfQstGA0LDRidCw0LXRgiAtMSDQn9C+0YHQu9C10LTQvdGP0Y8g0LLQtdGA0YHQuNGPINCy0YHQtSDQtdGJ0ZEg0LHQvtC70YzRiNC1LAojIDAg0LXRgdC70Lgg0YDQsNCy0L3RiyDQuCAxINC10YHQu9C4INGC0LXQutGD0YnQsNGPINCy0LXRgNGB0LjRjyDQsdC+0LvRjNGI0LUg0L/QvtGB0LvQtdC00L3QtdC5CmRlZiBjb21wYXJlX3ZlcnNpb25zKHZlcnNpb24xLCB2ZXJzaW9uMik6CiAgICBwYXJ0czEgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24xLnNwbGl0KCcuJykpKQogICAgcGFydHMyID0gbGlzdChtYXAoaW50LCB2ZXJzaW9uMi5zcGxpdCgnLicpKSkKCiAgICBmb3IgcDEsIHAyIGluIHppcChwYXJ0czEsIHBhcnRzMik6CiAgICAgICAgaWYgcDEgPCBwMjoKICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgZWxpZiBwMSA+IHAyOgogICAgICAgICAgICByZXR1cm4gMQoKICAgIHJldHVybiAwCgoKI9Cf0YDQuNCx0LDQstC70Y/QtdC8IDEg0Log0L3QvtC80LXRgNGDINGC0LXQutGD0YnQtdC5INCy0LXRgNGB0LjQuCAo0L/QviDQs9GA0YPQv9C/0LDQvCwKIyDQvNCw0LrRgdC40LzRg9C8IDk5INCyINC+0LTQvdC+0Lkg0LPRgNGD0L/Qv9C1KSDQndCw0L/RgNC40LzQtdGAIDEuMS4xLjEuOTkgKyAxINC00LDRgdGCINC90LDQvCAxLjEuMS4yLjAKZGVmIGluY3JlbWVudF92ZXJzaW9uKHZlcnNpb24pOgogICAgcGFydHMgPSBsaXN0KG1hcChpbnQsIHZlcnNpb24uc3BsaXQoJy4nKSkpCiAgICBwYXJ0c1stMV0gKz0gMQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHBhcnRzKSAtIDEsIDAsIC0xKToKICAgICAgICBpZiBwYXJ0c1tpXSA9PSAxMDA6CiAgICAgICAgICAgIHBhcnRzW2ldID0gMAogICAgICAgICAgICBwYXJ0c1tpIC0gMV0gKz0gMQogICAgcmV0dXJuICcuJy5qb2luKG1hcChzdHIsIHBhcnRzKSkKCgoKZGVmIHIwXzFfMF8xMl8zKGhhc2hfbWFwKToKICAgICMgQ29kZSBmb3IgcmVsZWFzZSAwLjEuMC4xMi4zCiAgICBxdGV4dCA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlIEFTIFNFTEVDVCAqCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIFJTX2JhcmNvZGVzOwogICAgCiAgICBEUk9QIFRBQkxFIFJTX2JhcmNvZGVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfYmFyY29kZXMgKAogICAgICAgIGJhcmNvZGUgICAgIFRFWFQgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBSSU1BUlkgS0VZLAogICAgICAgIGlkX2dvb2QgICAgIFRFWFQgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfcHJvcGVydHkgVEVYVCwKICAgICAgICBpZF9zZXJpZXMgICBURVhULAogICAgICAgIGlkX3VuaXQgICAgIFRFWFQsCiAgICAgICAgcmF0aW8gICAgICAgSU5URUdFUiBERUZBVUxUICgxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5PVCBOVUxMCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19iYXJjb2RlcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgYmFyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9nb29kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3Byb3BlcnR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3NlcmllcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF91bml0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdGlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgICAgICAKICAgIFVQREFURQogICAgUlNfYmFyY29kZXMKICAgIFNFVAogICAgcmF0aW8gPSBDT0FMRVNDRSgoCiAgICAgICAgU0VMRUNUIFJTX3VuaXRzLm5vbWluYXRvci9SU191bml0cy5kZW5vbWluYXRvcgogICAgRlJPTSBSU191bml0cwogICAgV0hFUkUgUlNfdW5pdHMuaWQgPSBSU19iYXJjb2Rlcy5pZF91bml0CiAgICApLCAxKTsKICAgIAogICAgICAgIAogICAgRFJPUCBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZTsKICAgIAogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDE7CiAgICAnJycKCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocXRleHQsJycpCiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOlRydWV9CiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuX3ZhbHVlID0geydyZXN1bHQnOkZhbHNlLCAnZGV0YWlscyc6ZifQntGI0LjQsdC60LAg0LIg0LfQsNC/0YDQvtGB0LU6IHtxdGV4dH0nfQoKCmRlZiByMF8xXzBfMTNfNyhoYXNoX21hcCk6CgogICAgcSA9ICcnJwogICAgUFJBR01BIGZvcmVpZ25fa2V5cyA9IDA7CgogICAgQ1JFQVRFCiAgICBUQUJMRQogICAgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUKICAgIEFTCiAgICBTRUxFQ1QgKiBGUk9NIFJTX2RvY3NfdGFibGU7CgogICAgRFJPUCBUQUJMRSBSU19kb2NzX3RhYmxlOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc190YWJsZSgKICAgIGlkIElOVEVHRVIgUFJJTUFSWSBLRVkgQVVUT0lOQ1JFTUVOVCwKICAgIGlkX2RvYyBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgUlNfZG9jcyhpZF9kb2MpCiAgICBPTiBERUxFVEUgQ0FTQ0FERSBPTiBVUERBVEUgU0VUIERFRkFVTFQsCiAgICBpZF9nb29kIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyBSU19nb29kcyhpZCksCiAgICBpZF9wcm9wZXJ0aWVzIFRFWFQgUkVGRVJFTkNFUyBSU19wcm9wZXJ0aWVzKGlkKSwKICAgIGlkX3NlcmllcyBURVhUIFJFRkVSRU5DRVMgUlNfc2VyaWVzKGlkKSwKICAgIGlkX3VuaXQgVEVYVCBOT1QgTlVMTCBSRUZFUkVOQ0VTIFJTX3VuaXRzKGlkKSwKICAgIHF0dHkgUkVBTCwgCiAgICBxdHR5X3BsYW4gUkVBTCwKICAgIHByaWNlIFJFQUwsCiAgICBpZF9wcmljZSBURVhUIFJFRkVSRU5DRVMgIFJTX3ByaWNlX3R5cGVzKGlkKSwKICAgIHNlbnQgSU5URUdFUiwKICAgIGxhc3RfdXBkYXRlZCBEQVRFVElNRSBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgaXNfcGxhbiBURVhUIERFRkFVTFQgVHJ1ZSwKICAgIGlkX2NlbGwgVEVYVCBSRUZFUkVOQ0VTIFJTX2NlbGxzKGlkKSwKICAgIHVzZV9zZXJpZXMgICAgSU5UICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgREVGQVVMVCAoMCkKICAgICk7CgogICAgSU5TRVJUIElOVE8gUlNfZG9jc190YWJsZSgKICAgICAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksCiAgICAgICAgcXR0eV9wbGFuLCBwcmljZSwgaWRfcHJpY2UsIHNlbnQsIGxhc3RfdXBkYXRlZCwgaXNfcGxhbiwgaWRfY2VsbAogICAgKQogICAgU0VMRUNUCiAgICBpZCwgaWRfZG9jLCBpZF9nb29kLCBpZF9wcm9wZXJ0aWVzLCBpZF9zZXJpZXMsIGlkX3VuaXQsIHF0dHksIHF0dHlfcGxhbiwKICAgIHByaWNlLCBpZF9wcmljZSwgc2VudCwgbGFzdF91cGRhdGVkLCBpc19wbGFuLCBpZF9jZWxsIEZST00gc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKICAgIERST1AgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGU7CiAgICAKCiAgICBDUkVBVEUgVEFCTEUgc3FsaXRlc3R1ZGlvX3RlbXBfdGFibGUgQVMgU0VMRUNUICoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19kb2NzX3NlcmllczsKCiAgICBEUk9QIFRBQkxFIFJTX2RvY3Nfc2VyaWVzOwogICAgCiAgICBDUkVBVEUgVEFCTEUgUlNfZG9jc19zZXJpZXMgKAogICAgICAgIGlkICAgICAgICAgICAgICBJTlRFR0VSICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5ULAogICAgICAgIGlkX2RvYyAgICAgICAgICBURVhUICAgICBOT1QgTlVMTAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSRUZFUkVOQ0VTIFJTX2RvY3MgKGlkX2RvYyksCiAgICAgICAgaWRfZ29vZCAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfZ29vZHMgKGlkKSwKICAgICAgICBpZF9zZXJpZXMgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19zZXJpZXMgKGlkKSwKICAgICAgICBpZF93YXJlaG91c2UgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU193YXJlaG91c2VzIChpZCksCiAgICAgICAgcXR0eSAgICAgICAgICAgIFJFQUwsCiAgICAgICAgbmFtZSAgICAgICAgICAgIFRFWFQgICAgIE5PVCBOVUxMLAogICAgICAgIGJlc3RfYmVmb3JlICAgICBEQVRFVElNRSwKICAgICAgICBudW1iZXIgICAgICAgICAgVEVYVCAgICAgTk9UIE5VTEwsCiAgICAgICAgcHJvZHVjdGlvbl9kYXRlIERBVEVUSU1FLAogICAgICAgIGNlbGwgICAgICAgICAgICAgVEVYVCAgICAgUkVGRVJFTkNFUyBSU19jZWxscyAoaWQpIE9OIERFTEVURSBOTyBBQ1RJT04KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9OIFVQREFURSBOTyBBQ1RJT04KICAgICk7CiAgICAKICAgIElOU0VSVCBJTlRPIFJTX2RvY3Nfc2VyaWVzICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZ29vZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZF9zZXJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF0dHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0X2JlZm9yZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdGlvbl9kYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTRUxFQ1QgaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX2dvb2QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfc2VyaWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdHR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVzdF9iZWZvcmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3Rpb25fZGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICAKICAgIENSRUFURSBUQUJMRSBzcWxpdGVzdHVkaW9fdGVtcF90YWJsZSBBUyBTRUxFQ1QgKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRlJPTSBSU19hZHJfZG9jczsKICAgIAogICAgRFJPUCBUQUJMRSBSU19hZHJfZG9jczsKICAgIAogICAgQ1JFQVRFIFRBQkxFIFJTX2Fkcl9kb2NzICgKICAgICAgICBpZF9kb2MgICAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUFJJTUFSWSBLRVksCiAgICAgICAgZG9jX3R5cGUgICAgICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMLAogICAgICAgIGRvY19uICAgICAgICAgICAgICBURVhUICAgICAgICBOT1QgTlVMTCwKICAgICAgICBkb2NfZGF0ZSAgICAgICAgICAgVEVYVCAgICAgICAgTk9UIE5VTEwsCiAgICAgICAgaWRfd2FyZWhvdXNlICAgICAgIFRFWFQgICAgICAgIE5PVCBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJFRkVSRU5DRVMgUlNfd2FyZWhvdXNlcyAoaWQpLAogICAgICAgIHZlcmlmaWVkICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIHNlbnQgICAgICAgICAgICAgICBJTlRFR0VSLAogICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiBJTlRFR0VSLAogICAgICAgIGNyZWF0ZWRfYXQgICAgICAgICBEQVRFVElNRSAgICBERUZBVUxUIENVUlJFTlRfVElNRVNUQU1QLAogICAgICAgIGNvbnRyb2wgICAgICAgICAgICBURVhUICAgICAgICBERUZBVUxUIDAsCiAgICAgICAgYWxsb3dfZmFjdF9pbnB1dCBURVhUICAgICBERUZBVUxUICgwKSwKICAgICAgICB1c2Vfc2VyaWVzICAgICAgICAgSU5URUdFUiAoMSkgREVGQVVMVCAoMCkgCiAgICApOwogICAgCiAgICBJTlNFUlQgSU5UTyBSU19hZHJfZG9jcyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfZG9jLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY190eXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY19kYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkX3dhcmVob3VzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJpZmllZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9tYXJrX3NlbGVjdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2wKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNFTEVDVCBpZF9kb2MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX3R5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRfd2FyZWhvdXNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlcmlmaWVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21hcmtfc2VsZWN0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGUk9NIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBEUk9QIFRBQkxFIHNxbGl0ZXN0dWRpb190ZW1wX3RhYmxlOwogICAgCiAgICBQUkFHTUEgZm9yZWlnbl9rZXlzID0gMTsKCgogICAgJycnCiAgICB0cnk6CiAgICAgICAgciA9IGRiX3NlcnZpY2VzLlNxbFF1ZXJ5UHJvdmlkZXIoKQogICAgICAgIHIuc3FsX2V4ZWMocSwnJykKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6VHJ1ZX0KICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm5fdmFsdWUgPSB7J3Jlc3VsdCc6RmFsc2UsICdkZXRhaWxzJzpmJ9Ce0YjQuNCx0LrQsCDQsiDQt9Cw0L/RgNC+0YHQtToge3F9J30KCgojIGlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiMgICAgICMgUmVwbGFjZSB0aGVzZSB2ZXJzaW9ucyB3aXRoIHlvdXIgYWN0dWFsIHZlcnNpb24gbnVtYmVycwojICAgICBzdGFydF92ZXJzaW9uID0gIjAuMS4wLjExLjciCiMgICAgIHN0YXJ0X3ZlcnNpb24gPSAoInMiKQojICAgICBlbmRfdmVyc2lvbiA9ICIwLjEuMC4xMi4zIgojCiMgICAgIHByaW50KHJ1bl9yZWxlYXNlcyhzdGFydF92ZXJzaW9uLCBlbmRfdmVyc2lvbikpCiNwcmludChpc192YWxpZF92ZXJzaW9uKCIwMS4xLjAuMTEuMjYiKSk="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\printing_factory.py",
                "PyFileKey": "printing_factory",
                "PyFileData": "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmZyb20gdHlwaW5nIGltcG9ydCBUdXBsZSwgQW55LCBVbmlvbgpmcm9tIHJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpIGltcG9ydCBTaW1wbGVVdGlsaXRlcyBhcyBzdUNsYXNzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgenBsCmZyb20gUElMIGltcG9ydCBJbWFnZQpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cAppbXBvcnQgYmFyY29kZQpmcm9tIGJhcmNvZGUud3JpdGVyIGltcG9ydCBJbWFnZVdyaXRlcgppbXBvcnQgcXJjb2RlCmZyb20gamluamEyIGltcG9ydCBFbnZpcm9ubWVudCwgRmlsZVN5c3RlbUxvYWRlciwgc2VsZWN0X2F1dG9lc2NhcGUsIG1ldGEKaW1wb3J0IGJhc2U2NApmcm9tIGlvIGltcG9ydCBCeXRlc0lPCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9tIGphdmEgaW1wb3J0IGpjbGFzcwpmcm9tIHVpX3V0aWxzIGltcG9ydCBIYXNoTWFwCmZyb20gcnUudHJhdmVsZm9vZC5zaW1wbGVfdWkgaW1wb3J0IFNpbXBsZUJsdWV0b290aApub0NsYXNzID0gamNsYXNzKCJydS50cmF2ZWxmb29kLnNpbXBsZV91aS5Ob1NRTCIpCnByaW50X25jbCA9IG5vQ2xhc3MoInByaW50X25jbCIpCmJ0ID0gU2ltcGxlQmx1ZXRvb3RoKCkKCgpjbGFzcyBIVE1MRG9jdW1lbnQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdGVtcGxhdGVfZGlyZWN0b3J5LCB0ZW1wbGF0ZV9maWxlKToKICAgICAgICBzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSA9IHRlbXBsYXRlX2RpcmVjdG9yeQogICAgICAgIHNlbGYudGVtcGxhdGVfZmlsZSA9IHRlbXBsYXRlX2ZpbGUKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZ2VuZXJhdGVfYmFyY29kZShkYXRhLCBiYXJjb2RlX3R5cGU9J2VhbjEzJyk6CiAgICAgICAgZWFuX2NsYXNzID0gYmFyY29kZS5nZXRfYmFyY29kZV9jbGFzcyhiYXJjb2RlX3R5cGUpCiAgICAgICAgd3JpdGVyID0gSW1hZ2VXcml0ZXIoKQogICAgICAgIGVhbiA9IGVhbl9jbGFzcyhkYXRhLCB3cml0ZXI9d3JpdGVyKQoKICAgICAgICBiYXJjb2RlX2ltYWdlID0gQnl0ZXNJTygpCiAgICAgICAgZWFuLndyaXRlKGJhcmNvZGVfaW1hZ2UpCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYmFyY29kZV9pbWFnZS5nZXR2YWx1ZSgpKS5kZWNvZGUoKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBnZW5lcmF0ZV9xcl9jb2RlKGJhcmNvZGVfZGF0YSk6CiAgICAgICAgcXIgPSBxcmNvZGUuUVJDb2RlKHZlcnNpb249MSwgYm94X3NpemU9MTAsIGJvcmRlcj01KQogICAgICAgIHFyLmFkZF9kYXRhKGJhcmNvZGVfZGF0YSkKICAgICAgICBxci5tYWtlKGZpdD1UcnVlKQogICAgICAgIGltZyA9IHFyLm1ha2VfaW1hZ2UoZmlsbF9jb2xvcj0iYmxhY2siLCBiYWNrX2NvbG9yPSJ3aGl0ZSIpCgogICAgICAgIGJ1ZmZlcmVkID0gQnl0ZXNJTygpCiAgICAgICAgaW1nLnNhdmUoYnVmZmVyZWQsIGZvcm1hdD0iUE5HIikKCiAgICAgICAgcmV0dXJuIGJhc2U2NC5iNjRlbmNvZGUoYnVmZmVyZWQuZ2V0dmFsdWUoKSkuZGVjb2RlKCkKCiAgICBkZWYgY3JlYXRlX2h0bWwoc2VsZiwgcGFyYW1ldGVycywgYmFyY29kZV90eXBlPSdlYW4xMycpOgogICAgICAgIGVudiA9IEVudmlyb25tZW50KAogICAgICAgICAgICBsb2FkZXI9RmlsZVN5c3RlbUxvYWRlcihzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSksCiAgICAgICAgICAgIGF1dG9lc2NhcGU9c2VsZWN0X2F1dG9lc2NhcGUoWydodG1sJywgJ3htbCddKSwKICAgICAgICAgICAgdmFyaWFibGVfc3RhcnRfc3RyaW5nPSdbJywKICAgICAgICAgICAgdmFyaWFibGVfZW5kX3N0cmluZz0nXScsCiAgICAgICAgKQogICAgICAgIGlmIGJhcmNvZGVfdHlwZSA9PSAncXItY29kZSc6CiAgICAgICAgICAgIGJhcmNvZGVfaW1hZ2VfYmFzZTY0ID0gc2VsZi5nZW5lcmF0ZV9xcl9jb2RlKHBhcmFtZXRlcnNbJ2JhcmNvZGUnXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBiYXJjb2RlX2ltYWdlX2Jhc2U2NCA9IHNlbGYuZ2VuZXJhdGVfYmFyY29kZShwYXJhbWV0ZXJzWydiYXJjb2RlJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhcmNvZGVfdHlwZSkKCiAgICAgICAgdGVtcGxhdGUgPSBlbnYuZ2V0X3RlbXBsYXRlKHNlbGYudGVtcGxhdGVfZmlsZSkKCiAgICAgICAgYWEgPSB0ZW1wbGF0ZS5yZW5kZXIocGFyYW1ldGVycykKCiAgICAgICAgc291cCA9IEJlYXV0aWZ1bFNvdXAoYWEsICdodG1sLnBhcnNlcicpCiAgICAgICAgZm9yIGltZ3RhZyBpbiBzb3VwLmZpbmRfYWxsKCJpbWciKToKICAgICAgICAgICAgaW1ndGFnWydzcmMnXSA9ICgiZGF0YTppbWFnZS9wbmc7IHdpZHRoOmF1dG87IGhlaWdodDphdXRvOyBiYXNlNjQsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYmFyY29kZV9pbWFnZV9iYXNlNjQpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgZmluZF90ZW1wbGF0ZV92YXJpYWJsZXMoZGlyZWN0b3J5OiBzdHIsIGZpbGVfbmFtZTogc3RyKToKICAgICAgICBlbnYgPSBFbnZpcm9ubWVudCgKICAgICAgICAgICAgbG9hZGVyPUZpbGVTeXN0ZW1Mb2FkZXIoZGlyZWN0b3J5KSwKICAgICAgICAgICAgYXV0b2VzY2FwZT1zZWxlY3RfYXV0b2VzY2FwZShbJ2h0bWwnLCAneG1sJ10pLAogICAgICAgICAgICB2YXJpYWJsZV9zdGFydF9zdHJpbmc9J1snLAogICAgICAgICAgICB2YXJpYWJsZV9lbmRfc3RyaW5nPSddJywKICAgICAgICApCiAgICAgICAgdGVtcGxhdGVfc291cmNlID0gZW52LmxvYWRlci5nZXRfc291cmNlKGVudiwgZmlsZV9uYW1lKVswXQogICAgICAgIHBhcnNlZF9jb250ZW50ID0gZW52LnBhcnNlKHRlbXBsYXRlX3NvdXJjZSkKICAgICAgICBwYXJhbXMgPSBtZXRhLmZpbmRfdW5kZWNsYXJlZF92YXJpYWJsZXMocGFyc2VkX2NvbnRlbnQpCiAgICAgICAgaWYgJ2JhcmNvZGUnIG5vdCBpbiBwYXJhbXM6CiAgICAgICAgICAgIHBhcmFtcy5hZGQoJ2JhcmNvZGUnKQogICAgICAgIHJldHVybiBwYXJhbXMKCiAgICBkZWYgZ2V0X3RlbXBsYXRlKHNlbGYpOgoKICAgICAgICB3aXRoIG9wZW4oUGF0aChzZWxmLnRlbXBsYXRlX2RpcmVjdG9yeSkgLyBzZWxmLnRlbXBsYXRlX2ZpbGUsICJyIiwKICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc9InV0Zi04IikgYXMgZmlsZToKICAgICAgICAgICAgaHRtbF9ib2R5ID0gZmlsZS5yZWFkKCkKCiAgICAgICAgcmV0dXJuIGh0bWxfYm9keQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBpbmplY3RfY3NzX3N0eWxlKGh0bWwsIHdpZHRoOiBzdHIsIGhlaWdodDogc3RyLCB4OiBzdHIsIHk6IHN0cik6CiAgICAgICAgY3NzX3RlbXBsYXRlMiA9ICcnJwogICAgICAgICAgQHBhZ2UgewogICAgICAgICAgICBtYXJnaW46IDFtbTsgLyogQWRqdXN0IGlmIG5lY2Vzc2FyeSAqLwogICAgICAgIH0KCiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgcGFkZGluZzogMDsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZmZmZjsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsOwogICAgICAgICAgICBmb250LXNpemU6IDhwdDsKICAgICAgICAgICAgZm9udC1zdHlsZTogbm9ybWFsOwogICAgICAgIH0KCiAgICAgICAgLmZ1bGwtdGVtcGxhdGUgewogICAgICAgICAgICB3aWR0aDogY2FsYygxMDB2dyAtIDJtbSk7ICAKICAgICAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMm1tKTsKICAgICAgICAgICAgbWluLXdpZHRoOiA0MG1tOyAgICAvKiBNaW5pbXVtIHdpZHRoICovCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDQwbW07ICAgLyogTWluaW11bSBoZWlnaHQgKi8KICAgICAgICAgICAgYm9yZGVyOiAxcHQgc29saWQgYmxhY2s7CiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7IC8qIGVuc3VyZXMgcGFkZGluZyBhbmQgYm9yZGVyIGFyZSBpbmNsdWRlZCBpbiB0aGUgdG90YWwgd2lkdGggYW5kIGhlaWdodCAqLwogICAgICAgICAgICBwYWdlLWJyZWFrLWluc2lkZTogYXZvaWQ7IC8qIEF2b2lkIGJyZWFraW5nIGluc2lkZSB0aGUgdGVtcGxhdGUgKi8KICAgICAgICB9CgogICAgICAgIGltZyB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKCcnJyArIHggKyAnJydweCwgJycnICsgeSArICcnJ3B4KTsKICAgICAgICAgICAgd2lkdGg6ICcnJyArIHdpZHRoICsgJycnbW07CiAgICAgICAgICAgIGhlaWdodDogJycnICsgaGVpZ2h0ICsgJycnbW07CiAgICAgICAgfQoKICAgICAgICB0YWJsZSB7CiAgICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7CiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7CiAgICAgICAgICAgIHBhZ2UtYnJlYWstaW5zaWRlOiBhdm9pZDsgLyogQXZvaWQgYnJlYWtpbmcgaW5zaWRlIHRoZSB0YWJsZSAqLwogICAgICAgIH0KCiAgICAgICAgdGQgewogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgfQogICAgICAgICcnJwoKICAgICAgICBzb3VwID0gQmVhdXRpZnVsU291cChodG1sLCAiaHRtbC5wYXJzZXIiKQogICAgICAgICMg0JTQvtCx0LDQstC70Y/QtdC8INGB0LLQvtC4INGB0YLQuNC70Lgg0LIg0LTQvtC60YPQvNC10L3RggogICAgICAgIGhlYWRfdGFnID0gc291cC5oZWFkCiAgICAgICAgc3R5bGVfdGFnID0gc291cC5uZXdfdGFnKCJzdHlsZSIpCiAgICAgICAgc3R5bGVfdGFnLnN0cmluZyA9IGNzc190ZW1wbGF0ZTIKICAgICAgICBoZWFkX3RhZy5hcHBlbmQoc3R5bGVfdGFnKQogICAgICAgICMg0JfQsNC/0LjRhdGD0LXQvCDQstC10YHRjCDQtNC+0LrRg9C80LXQvdGCINCyINC60L7QvdGC0LXQudC90LXRgAogICAgICAgIHdyYXBwZXIgPSBzb3VwLm5ld190YWcoImRpdiIpCiAgICAgICAgd3JhcHBlclsnY2xhc3MnXSA9ICdmdWxsLXRlbXBsYXRlJwogICAgICAgIGJvZHlfY2hpbGRyZW4gPSBsaXN0KHNvdXAuYm9keS5jaGlsZHJlbikKICAgICAgICBzb3VwLmJvZHkuY2xlYXIoKQogICAgICAgIHNvdXAuYm9keS5hcHBlbmQod3JhcHBlcikKICAgICAgICBmb3IgY2hpbGQgaW4gYm9keV9jaGlsZHJlbjoKICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoY2hpbGQpCgogICAgICAgICMg0KPQtNCw0LvRj9C10Lwg0L/Rg9GB0YLRi9C1INGP0YfQtdC50LrQuCDQuNC3INGC0LDQsdC70LjRhtGLLCDQutC+0YLQvtGA0YvQtSDRgtCw0Log0LvRjtCx0LjRgiAx0YEKICAgICAgICBmb3IgdHIgaW4gc291cC5maW5kX2FsbCgndHInKToKCiAgICAgICAgICAgIGZvciB0ZCBpbiB0ci5maW5kX2FsbCgndGQnKToKICAgICAgICAgICAgICAgIGlmIG5vdCB0ZC5hdHRycy5nZXQoJ2NsYXNzJyk6CiAgICAgICAgICAgICAgICAgICAgdGQuZGVjb21wb3NlKCkKICAgICAgICAjINCb0LjRiNC90LjQtSDQutC+0LvQvtC90LrQuCDRgdC/0YDQsNCy0LAg0YPQtNCw0LvRj9C10Lwg0YLQvtC20LUKICAgICAgICBmb3IgY29sIGluIHNvdXAuZmluZF9hbGwoJ2NvbCcpOgogICAgICAgICAgICBpZiBub3QgY29sLmF0dHJzOgogICAgICAgICAgICAgICAgY29sLmRlY29tcG9zZSgpCgogICAgICAgIHJldHVybiBzdHIoc291cCkKCgpjbGFzcyBQcmludFNlcnZpY2U6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIG1ha2VfenBsX2Zyb21fbGFiZWwoCiAgICAgICAgICAgIGltYWdlX3dpZHRoX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX2hlaWdodF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBkcG1tX3ByaW50X3RlbXBsYXRlOiBpbnQsCiAgICAgICAgICAgIGltYWdlX3hfcHJpbnRfdGVtcGxhdGU6IGludCwKICAgICAgICAgICAgaW1hZ2VfeV9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9sbF9wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBpbWFnZV9wd19wcmludF90ZW1wbGF0ZTogaW50LAogICAgICAgICAgICBwYXRoX3RvX2ltZzogc3RyCiAgICApIC0+IHN0cjoKICAgICAgICAiIiLQktC+0LfQstGA0LDRidCw0LXRgiDRgdGC0YDQvtC60YMgenBsINGBINC60LDRgNGC0LjQvdC60L7QuSDQstC90YPRgtGA0LgiIiIKICAgICAgICBsYWJlbCA9IHpwbC5MYWJlbCgKICAgICAgICAgICAgd2lkdGg9aW1hZ2Vfd2lkdGhfcHJpbnRfdGVtcGxhdGUgKiAyLAogICAgICAgICAgICBoZWlnaHQ9aW1hZ2VfaGVpZ2h0X3ByaW50X3RlbXBsYXRlICogMiwKICAgICAgICAgICAgZHBtbT1kcG1tX3ByaW50X3RlbXBsYXRlCiAgICAgICAgKQogICAgICAgIGxhYmVsLm9yaWdpbihpbWFnZV94X3ByaW50X3RlbXBsYXRlLCBpbWFnZV95X3ByaW50X3RlbXBsYXRlKQogICAgICAgIGxhYmVsLndyaXRlX2dyYXBoaWMoCiAgICAgICAgICAgIGltYWdlPUltYWdlLm9wZW4ocGF0aF90b19pbWcpLAogICAgICAgICAgICB3aWR0aD1pbWFnZV93aWR0aF9wcmludF90ZW1wbGF0ZSAqIDIsCiAgICAgICAgICAgIGhlaWdodD1pbWFnZV9oZWlnaHRfcHJpbnRfdGVtcGxhdGUgKiAyCiAgICAgICAgKQogICAgICAgIGxhYmVsLmVuZG9yaWdpbigpCiAgICAgICAgenBsX2RhdGEgPSBsYWJlbC5kdW1wWlBMKCkKICAgICAgICBsbCA9IGltYWdlX2xsX3ByaW50X3RlbXBsYXRlCiAgICAgICAgcHcgPSBpbWFnZV9wd19wcmludF90ZW1wbGF0ZQogICAgICAgIGlmIGxsIGFuZCBwdzoKICAgICAgICAgICAgenBsX2RhdGEgPSB6cGxfZGF0YS5yZXBsYWNlKCdeWEEnLCAnXlhBJyArIGYnXkxMe2xsfScgKyBmJ15QV3twd30nLCAxKQogICAgICAgIHJldHVybiB6cGxfZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiB6cGxfdG9fcG5nX2Zyb21fYXBpKAogICAgICAgICAgICB6cGxfZGF0YTogc3RyLAogICAgICAgICAgICBkcG1tOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX3dpZHRoOiBpbnQsCiAgICAgICAgICAgIGxhYmVsX2hlaWdodDogaW50LAogICAgKSAtPiBUdXBsZVtib29sLCBBbnldOgogICAgICAgICIiIgogICAgICAgINCU0LXQu9Cw0LXRgiDQt9Cw0L/RgNC+0YEg0LogQVBJLiDQntGC0L/RgNCw0LLQu9GP0Y7RgtGB0Y8genBsINC60L7QtCDQuCDRgNCw0LfQvNC10YDRiyDRjdGC0LjQutC10YLQutC4LgogICAgICAgICIiIgogICAgICAgIGZpbGVzID0geydmaWxlJzogenBsX2RhdGF9CgogICAgICAgIHVybCA9IChmJ2h0dHA6Ly9hcGkubGFiZWxhcnkuY29tL3YxL3ByaW50ZXJzL3tkcG1tfWRwbW0vJwogICAgICAgICAgICAgICBmJ2xhYmVscy97bW1fdG9faW5jaChsYWJlbF93aWR0aCAqIDIpfXh7bW1fdG9faW5jaChsYWJlbF9oZWlnaHQgKiAyKX0vMC8nKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIHN0cmVhbT1UcnVlKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgcmVzcG9uc2UudGV4dAoKICAgICAgICByZXNwb25zZS5yYXcuZGVjb2RlX2NvbnRlbnQgPSBUcnVlCiAgICAgICAgcmV0dXJuIFRydWUsIHJlc3BvbnNlLnJhdwoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludChoYXNoX21hcCwgZGF0YTogZGljdCk6CiAgICAgICAgaWYgbm90IGRhdGE6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBsYWJlbF9wYXRoID0gcHJpbnRfbmNsLmdldCgnY3VycmVudF9sYWJlbF90ZW1wbGF0ZV9wYXRoJykKICAgICAgICBpZiBub3QgbGFiZWxfcGF0aDoKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRiNCw0LHQu9C+0L3QsCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIG1hdGNoaW5nX3RhYmxlID0ganNvbi5sb2FkcyhwcmludF9uY2wuZ2V0KCdtYXRjaGluZ190YWJsZScpKQogICAgICAgIHRlbXBsYXRlX2RpcmVjdG9yeSwgdGVtcGxhdGVfZmlsZSA9IG9zLnBhdGguc3BsaXQobGFiZWxfcGF0aCkKICAgICAgICBkYXRhX2Zvcl9wcmludGluZyA9IHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGEsIG1hdGNoaW5nX3RhYmxlKQoKICAgICAgICBodG1scmVzdWx0ID0gSFRNTERvY3VtZW50KAogICAgICAgICAgICB0ZW1wbGF0ZV9kaXJlY3RvcnksIHRlbXBsYXRlX2ZpbGUKICAgICAgICApLmNyZWF0ZV9odG1sKGRhdGFfZm9yX3ByaW50aW5nLCBiYXJjb2RlX3R5cGU9cHJpbnRfbmNsLmdldCgnYmFyY29kZV90eXBlJykpCgogICAgICAgIGh0bWxyZXN1bHQgPSBIVE1MRG9jdW1lbnQuaW5qZWN0X2Nzc19zdHlsZSgKICAgICAgICAgICAgaHRtbHJlc3VsdCwKICAgICAgICAgICAgd2lkdGg9c3RyKGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX3dpZHRoJykpKSwKICAgICAgICAgICAgaGVpZ2h0PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9oZWlnaHQnKSkpLAogICAgICAgICAgICB4PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9yaWdodCcpKQogICAgICAgICAgICAgICAgICAtIGludChwcmludF9uY2wuZ2V0KCdiYXJjb2RlX2xlZnQnKSkpLAogICAgICAgICAgICB5PXN0cihpbnQocHJpbnRfbmNsLmdldCgnYmFyY29kZV9kb3duJykpCiAgICAgICAgICAgICAgICAgIC0gaW50KHByaW50X25jbC5nZXQoJ2JhcmNvZGVfdXAnKSkpLAogICAgICAgICkKCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Ce0YLQv9GA0LDQstC70LXQvdC+INC90LAg0L/QtdGH0LDRgtGMJykKICAgICAgICBoYXNoX21hcC5wdXQoCiAgICAgICAgICAgICJSdW5FdmVudCIsCiAgICAgICAgICAgIGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICJhY3Rpb24iOiAicnVuYXN5bmMiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiaHRtbDJpbWFnZSIsCiAgICAgICAgICAgICAgICAibWV0aG9kIjogaHRtbHJlc3VsdCwKICAgICAgICAgICAgICAgICJwb3N0RXhlY3V0ZSI6IGpzb24uZHVtcHMoW3sKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uIjogInJ1biIsCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAicHl0aG9uIiwKICAgICAgICAgICAgICAgICAgICAibWV0aG9kIjogInByaW50X3Bvc3RfZXhlY3V0ZSIKICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICB9XSkKICAgICAgICApCgogICAgICAgIGZpbGVuYW1lID0gc3VDbGFzcy5nZXRfdGVtcF9maWxlKCJwbmciKQogICAgICAgIHByaW50X25jbC5wdXQoJ3BhdGhfdG9faHRtbDJpbWFnZV9maWxlJywgZmlsZW5hbWUsIFRydWUpCiAgICAgICAgaGFzaF9tYXAucHV0KCJodG1sMmltYWdlX1RvRmlsZSIsIGZpbGVuYW1lKQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBwcmludF9wb3N0X2V4ZWN1dGUoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIHBhdGhfdG9faW1nID0gcHJpbnRfbmNsLmdldCgncGF0aF90b19odG1sMmltYWdlX2ZpbGUnKQogICAgICAgIHNhdmVkX3RlbXBsYXRlID0gcHJpbnRfbmNsLmdldCgnc2F2ZWRfcHJpbnRfdGVtcGxhdGUnKQogICAgICAgIGlmIG5vdCBzYXZlZF90ZW1wbGF0ZToKICAgICAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cd0LXRgiDRgdC+0YXRgNCw0L3QtdC90L3QvtCz0L4g0YjQsNCx0LvQvtC90LAg0L/QtdGH0LDRgtC4JykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgc2F2ZWRfdGVtcGxhdGUgPSBqc29uLmxvYWRzKHNhdmVkX3RlbXBsYXRlKQogICAgICAgIHpwbGRhdGEgPSBQcmludFNlcnZpY2UubWFrZV96cGxfZnJvbV9sYWJlbCgKICAgICAgICAgICAgcGF0aF90b19pbWc9cGF0aF90b19pbWcsICoqc2F2ZWRfdGVtcGxhdGUpCiAgICAgICAgUHJpbnRTZXJ2aWNlLnByaW50X3pwbCh6cGxkYXRhLCBoYXNoX21hcCkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfenBsKHpwbF9kYXRhOiBzdHIsIGhhc2hfbWFwOiBIYXNoTWFwKToKICAgICAgICBwcmludF90aHJvdWdoID0gcHJpbnRfbmNsLmdldCgncHJpbnRfdGhyb3VnaCcpCiAgICAgICAgaWYgbm90IHByaW50X3Rocm91Z2g6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INCy0YvQsdGA0LDQvdC+INGD0YHRgtGA0L7QudGB0YLQstC+INC00LvRjyDQv9C10YfQsNGC0LgnKQogICAgICAgIGVsaWYgcHJpbnRfdGhyb3VnaCA9PSAnQlQnOgogICAgICAgICAgICBzZW50LCByZXN1bHQgPSBQcmludFNlcnZpY2UucHJpbnRfYnQoenBsX2RhdGEpCiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KHJlc3VsdCkKICAgICAgICBlbGlmIHByaW50X3Rocm91Z2ggPT0gJ1dpRmknOgogICAgICAgICAgICBwcmludF9uY2wucHV0KCd3aWZpX2RhdGFfdG9fcHJpbnQnLCB6cGxfZGF0YSwgVHJ1ZSkKICAgICAgICAgICAgaGFzaF9tYXAucnVuX2V2ZW50X2FzeW5jKCdwcmludF93aWZpJykKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgcHJpbnRfd2lmaShoYXNoX21hcDogSGFzaE1hcCk6CiAgICAgICAgaXAgPSBwcmludF9uY2wuZ2V0KCdjdXJyZW50X2lwJykKICAgICAgICBpZiBub3QgaXA6CiAgICAgICAgICAgIGhhc2hfbWFwLnRvYXN0KCfQndC1INGD0LrQsNC30LDQvSBpcCcpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRhdGEgPSBwcmludF9uY2wuZ2V0KCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGlmIG5vdCBkYXRhOgogICAgICAgICAgICBoYXNoX21hcC50b2FzdCgn0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0L/QtdGH0LDRgtC4IHdpZmknKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBwcmludF9uY2wuZGVsZXRlKCd3aWZpX2RhdGFfdG9fcHJpbnQnKQogICAgICAgIGZhaWxfaGFuZGxlcnMgPSBbeyJhY3Rpb24iOiAicnVuIiwgInR5cGUiOiAicHl0aG9uIiwgIm1ldGhvZCI6ICJ3aWZpX2Vycm9yIn1dCiAgICAgICAgc2VuZGVkID0gc3VDbGFzcy53cml0ZV9zb2NrZXQoaXAsIDkxMDAsIGRhdGEsIGpzb24uZHVtcHMoZmFpbF9oYW5kbGVycykpCiAgICAgICAgaGFzaF9tYXAudG9hc3QoJ9Cj0YHQv9C10YjQvdC+JyBpZiBzZW5kZWQgZWxzZSAn0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3QvicpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHByaW50X2J0KGRhdGE6IFVuaW9uW3N0ciwgaW50LCBieXRlc10pOgogICAgICAgIG5jbCA9IG5vQ2xhc3MoImJ0X3NldHRpbmdzIikKICAgICAgICBidF9oYW5kbGVycyA9IFt7ImFjdGlvbiI6ICJydW4iLCAidHlwZSI6ICJweXRob24iLCAibWV0aG9kIjogImJsdWV0b290aF9lcnJvciJ9XQogICAgICAgIHByaW50ZXIgPSBuY2wuZ2V0KCJkZWZhdWx0X3ByaW50ZXIiKQogICAgICAgIGlmIHByaW50ZXIgaXMgTm9uZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCAi0J3QtSDQvtGC0L/RgNCw0LLQu9C10L3Qvi7QndC1INCy0YvQsdGA0LDQvSBCVC3Qv9GA0LjQvdGC0LXRgCIKICAgICAgICBkZXZpY2UgPSBidC5nZXRfZGV2aWNlKHByaW50ZXIpCiAgICAgICAgaWYgZGV2aWNlIGlzIE5vbmU6CiAgICAgICAgICAgIHJldHVybiBGYWxzZSwgItCd0LUg0L7RgtC/0YDQsNCy0LvQtdC90L4u0J3QtSDQv9C+0LvRg9GH0LjQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8g0Log0YPRgdGC0YDQvtC50YHRgtCy0YMiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgKCLQntGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjC4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgIiDQn9C10YDQtdC/0L7QtNC60LvRjtGH0LjRgtC1INC/0YDQuNC90YLQtdGALCDQtdGB0LvQuCDQv9C10YfQsNGC0Ywg0L3QtSDQvdCw0YfQsNC70LDRgdGMIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGJ0LmNvbm5lY3RfdG9fY2xpZW50KGRldmljZSwganNvbi5kdW1wcyhidF9oYW5kbGVycykpCiAgICAgICAgICAgICAgICBidC53cml0ZV9kYXRhKGRhdGEsIGpzb24uZHVtcHMoYnRfaGFuZGxlcnMpKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUsICLQo9GB0L/QtdGI0L3QviDQvtGC0L/RgNCw0LLQu9C10L3QviDQvdCwINC/0LXRh9Cw0YLRjCIKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBzdHIoZSkKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgYmx1ZXRvb3RoX2Vycm9yKGhhc2htYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2htYXAucGxheXNvdW5kKCdlcnJvcicpCiAgICAgICAgaGFzaG1hcC5wdXQoInNwZWFrIiwgItCd0LUg0YPQtNCw0LvQvtGB0Ywg0L/QvtC00LrQu9GO0YfQuNGC0YzRgdGPIEJsdWV0b290aCIpCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIHdpZmlfZXJyb3IoaGFzaF9tYXA6IEhhc2hNYXApOgogICAgICAgIGhhc2hfbWFwLnBsYXlzb3VuZCgnZXJyb3InKQogICAgICAgIGhhc2hfbWFwLnB1dCgic3BlYWsiLCAi0J3QtSDRg9C00LDQu9C+0YHRjCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8gV2lGaSIpCgoKZGVmIG1tX3RvX2luY2goc2l6ZV9tbTogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX21tIC8gMjUuNAoKCmRlZiBpbmNoX3RvX21tKHNpemVfaW5jaDogaW50KSAtPiBmbG9hdDoKICAgIHJldHVybiBzaXplX2luY2ggKiAyNS40CgoKZGVmIHJlcGxhc2VfcGFyYW1zX25hbWVzKGRhdGFfZm9yX3ByaW50aW5nLCBwYXJhbXNfbWF0Y2gpOgogICAgbmV3X2RhdGEgPSB7fQogICAgZm9yIG1hdGNoIGluIHBhcmFtc19tYXRjaDoKICAgICAgICBpZiBtYXRjaFsndmFsdWUnXSBpbiBkYXRhX2Zvcl9wcmludGluZy5rZXlzKCk6CiAgICAgICAgICAgIG5ld19kYXRhW21hdGNoWydrZXknXV0gPSBkYXRhX2Zvcl9wcmludGluZ1ttYXRjaFsndmFsdWUnXV0KICAgIHJldHVybiBuZXdfZGF0YQo="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\tiny_db_services.py",
                "PyFileKey": "tiny_db_services",
                "PyFileData": "aW1wb3J0IGRhdGV0aW1lCmltcG9ydCBqc29uCmltcG9ydCBvcwpmcm9tIHR5cGluZyBpbXBvcnQgTGlzdCwgVW5pb24sIERpY3QsIEFueSwgT3B0aW9uYWwsIFR1cGxlCmZyb20gZnVuY3Rvb2xzIGltcG9ydCByZWR1Y2UKZnJvbSB0aW55ZGIgaW1wb3J0IFRpbnlEQiwgUXVlcnksIHdoZXJlCmZyb20gdWlfdXRpbHMgaW1wb3J0IERhdGVGb3JtYXQKCmZyb20gamF2YSBpbXBvcnQgamNsYXNzCgoKbm9DbGFzcyA9IGpjbGFzcygicnUudHJhdmVsZm9vZC5zaW1wbGVfdWkuTm9TUUwiKQpyc19zZXR0aW5ncyA9IG5vQ2xhc3MoInJzX3NldHRpbmdzIikKCgpjbGFzcyBUaW55Tm9TUUxQcm92aWRlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YWJsZV9uYW1lLCBiYXNlX25hbWU9J1NpbXBsZUtlZXAnLCBkYl9wYXRoPScuLycpOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9IHRhYmxlX25hbWUKICAgICAgICBzZWxmLmJhc2VfbmFtZSA9IGJhc2VfbmFtZSBvciByc19zZXR0aW5ncy5nZXQoJ3NxbGl0ZV9uYW1lJykKICAgICAgICBzZWxmLmRiX3BhdGggPSBkYl9wYXRoIG9yIHJzX3NldHRpbmdzLmdldCgncGF0aF90b19kYXRhYmFzZXMnKQogICAgICAgIHNlbGYuZGIgPSBUaW55REIob3MucGF0aC5qb2luKHNlbGYuZGJfcGF0aCwgZid7c2VsZi5iYXNlX25hbWV9Lmpzb24nKSkKICAgICAgICBzZWxmLnRhYmxlID0gc2VsZi5kYi50YWJsZShzZWxmLnRhYmxlX25hbWUpCiAgICAgICAgc2VsZi5xdWVyeSA9IFF1ZXJ5KCkKCiAgICBkZWYgZHJvcF90YWJsZShzZWxmLCB0YWJsZV9uYW1lKToKICAgICAgICBzZWxmLmRiLmRyb3BfdGFibGUodGFibGVfbmFtZSkKCiAgICBkZWYgZ2V0X2FsbChzZWxmKSAtPiBsaXN0OgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmFsbCgpCgogICAgZGVmIGdldChzZWxmLCAqKmNvbmQpIC0+IFVuaW9uW0RpY3QsIE5vbmVdOgogICAgICAgIHJldHVybiBzZWxmLnRhYmxlLmdldChjb25kPXNlbGYuX2NyZWF0ZV9jb25kaXRpb24oKipjb25kKSkKCiAgICBkZWYgc2VhcmNoKHNlbGYsICoqY29uZCkgLT4gbGlzdDoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5zZWFyY2goY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIGluc2VydChzZWxmLCBkYXRhOiBkaWN0KSAtPiBpbnQ6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuaW5zZXJ0KGRhdGEpCgogICAgZGVmIGluc2VydF9tdWx0aXBsZShzZWxmLCBkYXRhOiBMaXN0W2RpY3RdKSAtPiBMaXN0W2ludF06CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuaW5zZXJ0X211bHRpcGxlKGRhdGEpCgogICAgZGVmIHVwZGF0ZShzZWxmLCBkYXRhOiBkaWN0LCAqKmNvbmQpIC0+IExpc3RbaW50XToKICAgICAgICAiIiIKICAgICAgICBkZWxldGUoa2V5KTogZGVsZXRlIGEga2V5IGZyb20gdGhlIGRvY3VtZW50CiAgICAgICAgaW5jcmVtZW50KGtleSk6IGluY3JlbWVudCB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBkZWNyZW1lbnQoa2V5KTogZGVjcmVtZW50IHRoZSB2YWx1ZSBvZiBhIGtleQogICAgICAgIGFkZChrZXksIHZhbHVlKTogYWRkIHZhbHVlIHRvIHRoZSB2YWx1ZSBvZiBhIGtleSAoYWxzbyB3b3JrcyBmb3Igc3RyaW5ncykKICAgICAgICBzdWJ0cmFjdChrZXksIHZhbHVlKTogc3VidHJhY3QgdmFsdWUgZnJvbSB0aGUgdmFsdWUgb2YgYSBrZXkKICAgICAgICBzZXQoa2V5LCB2YWx1ZSk6IHNldCBrZXkgdG8gdmFsdWUKICAgICAgICBkYi51cGRhdGUoZGVsZXRlKCdrZXkxJyksIFVzZXIubmFtZSA9PSAnSm9obicpCiAgICAgICAgZGIudXBkYXRlKHlvdXJfb3BlcmF0aW9uKGFyZ3VtZW50cyksIHF1ZXJ5KQogICAgICAgICIiIgoKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS51cGRhdGUoZGF0YSwgY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHVwc2VydChzZWxmLCBkYXRhLCAqKmNvbmQpIC0+IExpc3RbaW50XToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS51cHNlcnQoZGF0YSwgY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIHJlbW92ZShzZWxmLCBkb2NfaWRzPU5vbmUsICoqY29uZCk6CiAgICAgICAgaWYgZG9jX2lkczoKICAgICAgICAgICAgcmV0dXJuIHNlbGYudGFibGUucmVtb3ZlKGRvY19pZHM9ZG9jX2lkcykKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5yZW1vdmUoY29uZD1zZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCksIGRvY19pZHM9ZG9jX2lkcykKCiAgICBkZWYgY29udGFpbnMoc2VsZiwgKipjb25kKToKICAgICAgICByZXR1cm4gc2VsZi50YWJsZS5jb250YWlucyhzZWxmLl9jcmVhdGVfY29uZGl0aW9uKCoqY29uZCkpCgogICAgZGVmIGNvdW50KHNlbGYsICoqY29uZCk6CiAgICAgICAgcmV0dXJuIHNlbGYudGFibGUuY291bnQoc2VsZi5fY3JlYXRlX2NvbmRpdGlvbigqKmNvbmQpKQoKICAgIGRlZiBjbG9zZShzZWxmKToKICAgICAgICBzZWxmLmRiLmNsb3NlKCkKCiAgICBkZWYgX2NyZWF0ZV9jb25kaXRpb24oc2VsZiwgKipjb25kKSAtPiBRdWVyeToKICAgICAgICBjb25kaXRpb25zID0gWyhzZWxmLnF1ZXJ5W2tleV0gPT0gdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIGNvbmQuaXRlbXMoKV0KICAgICAgICByZXR1cm4gcmVkdWNlKGxhbWJkYSBhLCBiOiBhICYgYiwgY29uZGl0aW9ucykKCgpjbGFzcyBTY2FubmluZ1F1ZXVlU2VydmljZToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcm92aWRlcj1Ob25lKToKICAgICAgICBzZWxmLnRhYmxlX25hbWUgPSAnc2Nhbm5pbmdfcXVldWUnCiAgICAgICAgc2VsZi5wcm92aWRlciA9IHByb3ZpZGVyIG9yIFRpbnlOb1NRTFByb3ZpZGVyKHRhYmxlX25hbWU9c2VsZi50YWJsZV9uYW1lKQoKICAgIGRlZiBnZXRfZG9jX3NjYW5uaW5nX3F1ZXVlKHNlbGYsIGlkX2RvYykgLT4gZGljdDoKICAgICAgICByZXN1bHQgPSB7fQogICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jKQoKICAgICAgICBmb3Igcm93IGluIGRhdGE6CiAgICAgICAgICAgIHJlc3VsdFtyb3dbJ3Jvd19rZXknXV0gPSByb3dbJ3F0dHknXSMjIE5PVCBXT1JLCgogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgc2F2ZV9zY2FubmVkX3Jvd19kYXRhKHNlbGYsIGRhdGEsIHNlbnQ9RmFsc2UpOiAgI1RPRE8g0LIg0YLQtdGB0YLRiyDQntC70LXQswogICAgICAgICMgaWRfZG9jLCByb3dfaWQsIHF0dHkKICAgICAgICBkYXRhWydzZW50J10gPSBzZW50CiAgICAgICAgc2VsZi5wcm92aWRlci5pbnNlcnQoZGF0YT1kYXRhKQogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLmNvdW50KGlkX2RvYz1kYXRhWydpZF9kb2MnXSkKCiAgICBkZWYgZ2V0X3NjYW5uZWRfcm93X3F0dHkoc2VsZiwgaWRfZG9jLCByb3dfaWQpOgogICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jLCByb3dfaWQ9cm93X2lkKQogICAgICAgIHJldHVybiBzdW0oW3Jvd1sncXR0eSddIGZvciByb3cgaW4gZGF0YV0pICAjIG9yICdkX3F0dHknCgogICAgZGVmIGdldF9kb2N1bWVudF9saW5lcyhzZWxmLCBpZF9kb2MsIHNlbnQ9Tm9uZSkgLT4gbGlzdDoKICAgICAgICBpZiBzZW50IGlzIG5vdCBOb25lOgogICAgICAgICAgICBkYXRhID0gc2VsZi5wcm92aWRlci5zZWFyY2goaWRfZG9jPWlkX2RvYywgc2VudD1zZW50KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRhdGEgPSBzZWxmLnByb3ZpZGVyLnNlYXJjaChpZF9kb2M9aWRfZG9jKQogICAgICAgIHJldHVybiBkYXRhCgogICAgZGVmIHVwZGF0ZV9zZW50X2xpbmVzKHNlbGYsIHNlbnRfZGF0YTogbGlzdCwgc2VudD1UcnVlKToKICAgICAgICBkb2NfaWRfbGlzdCA9IFt4LmRvY19pZCBmb3IgeCBpbiBzZW50X2RhdGFdCiAgICAgICAgc2VsZi5wcm92aWRlci50YWJsZS51cGRhdGUoeydzZW50Jzogc2VudH0sIGRvY19pZHM9ZG9jX2lkX2xpc3QpCgogICAgZGVmIGhhc191bnNlbnRfbGluZXMoc2VsZiwgaWRfZG9jKSAtPiBib29sOgogICAgICAgIHF0dHkgPSBzZWxmLnByb3ZpZGVyLmNvdW50KGlkX2RvYz1pZF9kb2MsIHNlbnQ9RmFsc2UpCiAgICAgICAgcmV0dXJuIFRydWUgaWYgcXR0eSA+IDAgZWxzZSBGYWxzZQoKICAgIGRlZiByZW1vdmVfZG9jX2xpbmVzKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgc2VsZi5wcm92aWRlci5yZW1vdmUoaWRfZG9jPWlkX2RvYykKCgpjbGFzcyBFeGNoYW5nZVF1ZXVlQnVmZmVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRhYmxlX25hbWUsICk6CiAgICAgICAgc2VsZi50YWJsZV9uYW1lID0gdGFibGVfbmFtZQogICAgICAgIHNlbGYucHJvdmlkZXIgPSBUaW55Tm9TUUxQcm92aWRlcih0YWJsZV9uYW1lPXNlbGYudGFibGVfbmFtZSkKCiAgICBkZWYgc2F2ZV9kYXRhX3RvX3NlbmQoc2VsZiwgZGF0YSwgcGspOgogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLnVwc2VydChkYXRhPWRhdGEsIHBrPXBrKQoKICAgIGRlZiBnZXRfZGF0YV90b19zZW5kKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLnByb3ZpZGVyLmdldF9hbGwoKQoKICAgIGRlZiByZW1vdmVfc2VudF9kYXRhKHNlbGYsIGRhdGEpOgogICAgICAgIGRvY19pZF9saXN0ID0gW3guZG9jX2lkIGZvciB4IGluIGRhdGFdCiAgICAgICAgc2VsZi5wcm92aWRlci5yZW1vdmUoZG9jX2lkcz1kb2NfaWRfbGlzdCkKCgpjbGFzcyBOb1NRTFByb3ZpZGVyOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWU6IHN0cik6CiAgICAgICAgc2VsZi5ub3NxbCA9IG5vQ2xhc3MobmFtZSkKICAgICAgICBzZWxmLm5vc3FsX25hbWUgPSBuYW1lCgogICAgZGVmIHB1dCgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAga2V5OiBzdHIsCiAgICAgICAgICAgIHZhbHVlOiBVbmlvbltzdHIsIGludCwgYm9vbCwgTGlzdCwgRGljdCwgVHVwbGVdLAogICAgICAgICAgICBxdWV1ZTogYm9vbCA9IFRydWUsCiAgICAgICAgICAgIHRvX2pzb246IGJvb2wgPSBGYWxzZQogICAgKSAtPiBOb25lOgogICAgICAgICIiIgogICAgICAgINCf0L7QvNC10YnQsNC10YIg0LfQvdCw0YfQtdC90LjQtSDQsiDRg9C60LDQt9Cw0L3QvdGL0Lkg0LrQu9GO0YcuCiAgICAgICAgc3RyLCBpbnQsIGJvb2wgLSDQv9C+0LzQtdGJ0LDQtdC8INC60LDQuiDQtdGB0YLRjAogICAgICAgIGxpc3QsIGRpY3QsIHR1cGxlIC0g0L/RgNC10L7QsdGA0LDQt9C+0LLRi9Cy0LDQtdC8INCyINGB0YLRgNC+0LrRgy4KICAgICAgICAiIiIKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShrZXksIHN0cik6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcign0JrQu9GO0YcgTm9TUUwg0LTQvtC70LbQtdC9INCx0YvRgtGMINGB0YLRgNC+0LrQvtC5JykKICAgICAgICBpZiBpc2luc3RhbmNlKHZhbHVlLCAoc3RyLCBpbnQsIGJvb2wpKToKICAgICAgICAgICAgc2VsZi5ub3NxbC5wdXQoa2V5LCB2YWx1ZSwgcXVldWUpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGlmIG5vdCB0b19qc29uOgogICAgICAgICAgICByYWlzZSBUeXBlRXJyb3IoJ9Ch0L/QuNGB0L7QuiDQtNC+0L/Rg9GB0YLQuNC80YvRhSDRgtC40L/QvtCyIE5vU1FMOiBzdHIsIGludCwgYm9vbCcpCiAgICAgICAgaWYgaXNpbnN0YW5jZSh2YWx1ZSwgKExpc3QsIERpY3QsIFR1cGxlKSk6CiAgICAgICAgICAgIHNlbGYubm9zcWwucHV0KGtleSwganNvbi5kdW1wcyh2YWx1ZSksIHF1ZXVlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIFR5cGVFcnJvcihmJ05vU1FMLiDQndC10LvRjNC30Y8g0YHQtdGA0LjQsNC70LjQt9C+0LLQsNGC0Ywge3R5cGUodmFsdWUpfScpCgogICAgZGVmIGdldCgKICAgICAgICAgICAgc2VsZiwKICAgICAgICAgICAga2V5OiBzdHIsCiAgICAgICAgICAgIGRlZmF1bHQ6IE9wdGlvbmFsW0FueV0gPSBOb25lLAogICAgICAgICAgICBmcm9tX2pzb246IGJvb2wgPSBGYWxzZQogICAgKSAtPiBBbnk6CiAgICAgICAgIiIi0J/QvtC70YPRh9Cw0LXRgiDQt9C90LDRh9C10L3QuNC1INC/0L4g0LrQu9GO0YfRgyIiIgogICAgICAgIHJlc3VsdCA9IHNlbGYubm9zcWwuZ2V0KGtleSkKICAgICAgICBpZiByZXN1bHQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiByZXN1bHQgaWYgbm90IGZyb21fanNvbiBlbHNlIGpzb24ubG9hZHMocmVzdWx0KQogICAgICAgIHJldHVybiByZXN1bHQgaWYgbm90IGRlZmF1bHQgZWxzZSBkZWZhdWx0CgogICAgZGVmIGRlbGV0ZShzZWxmLCBrZXk6IHN0cikgLT4gTm9uZToKICAgICAgICAiIiLQo9C00LDQu9GP0LXRgiDQutC70Y7RhyIiIgogICAgICAgIHNlbGYubm9zcWwuZGVsZXRlKGtleSkKCiAgICBkZWYgZGVzdHJveShzZWxmKSAtPiBOb25lOgogICAgICAgICIiItCj0L3QuNGH0YLQvtC20LDQtdGCINCy0YHQtSDQutC70Y7Rh9C4INCx0LDQt9GLIiIiCiAgICAgICAgc2VsZi5ub3NxbC5kZXN0cm95KCkKCiAgICBkZWYgZ2V0X2FsbF9rZXlzKHNlbGYpIC0+IHN0cjoKICAgICAgICAiIiLQn9C+0LvRg9GH0LjRgtGMINGB0L/QuNGB0L7QuiDQstGB0LXRhSDQutC70Y7Rh9C10Lkg0LHQsNC30Ysg0LIg0LLQuNC00LUg0YHRgtGA0L7QutC4INGE0L7RgNC80LDRgtCwIEpTT04t0LzQsNGB0YHQuNCy0LAg0YHRgtGA0L7QuiIiIgogICAgICAgIHJldHVybiBzZWxmLm5vc3FsLmdldGFsbGtleXMoKQoKICAgIGRlZiBmaW5kX2pzb24oCiAgICAgICAgICAgIHNlbGYsCiAgICAgICAgICAgIGZpZWxkOiBzdHIsCiAgICAgICAgICAgIHZhbHVlOiBBbnksCiAgICAgICAgICAgIGluZGV4X25hbWU6IE9wdGlvbmFsW3N0cl0gPSBOb25lCiAgICApIC0+IHN0cjoKICAgICAgICAiIiIKICAgICAgICDQnNC10LTQu9C10L3QvdGL0Lkg0L/QvtC40YHQuiDRgdGA0LXQtNC4INCy0YHQtdGFINC+0LHRitC10LrRgtC+0LIg0LHQsNC30Ysg0LrQvtGC0L7RgNGL0LUg0LjQvNC10Y7RgiDRgtC40L8gSlNPTgogICAgICAgINC4INCyINC/0L7Qu9C1INC60L7RgtC+0YDRi9GFINC10YHRgtGMINC30L3QsNGH0LXQvdC40LUuINCS0L7Qt9Cy0YDQsNGJ0LDQtdGCINGB0YLRgNC+0LrRgyDRgSBKU09OLdC80LDRgdGB0LjQstC+0LwKICAgICAgICDQvdCw0LnQtNC10L3QvdGL0YUg0L7QsdGK0LXQutGC0L7Qsi4KICAgICAgICDQldGB0LvQuCDQsiDQsdCw0LfQtSDQvNC90L7Qs9C+INC30L3QsNGH0LXQvdC40LkgLSDQu9GD0YfRiNC1INC40YHQv9C+0LvRjNC30L7QstGC0LDRjCDQv9C+0LjRgdC6INGBINC40L3QtNC10LrRgdC+0LwuCiAgICAgICAgIiIiCiAgICAgICAgaWYgaW5kZXhfbmFtZToKICAgICAgICAgICAgcmV0dXJuIHNlbGYubm9zcWwuZmluZEpTT05faW5kZXgoaW5kZXhfbmFtZSwgZmllbGQsIHZhbHVlKQogICAgICAgIHJldHVybiBzZWxmLm5vc3FsLmZpbmRKU09OKGZpZWxkLCB2YWx1ZSkKCiAgICBkZWYgcnVuX2luZGV4KHNlbGYsIGluZGV4OiBzdHIsIGZpZWxkOiBzdHIpIC0+IE5vbmU6CiAgICAgICAgIiIiCiAgICAgICAg0KHQvtC30LTQsNC90LjQtSDQuNC90LTQtdC60YHQsCDQv9C+IEpTT04t0L7QsdGK0LXQutGC0LDQvCDQtNC70Y8g0LTQsNC70YzQvdC10LnRiNC10LPQviDQuNGB0L/QvtC70YzQt9C+0LLQsNC90LjRjyDQtNC70Y8g0L/QvtC40YHQutCwLgogICAgICAgINCh0L7Qt9C00LDQtdGCLCDQsNGB0LjQvdGF0YDQvtC90L3QvdC+INC40L3QtNC10LrRgSwg0YHQvtGB0YLQvtGP0YnQuNC5INC40Lcg0L7QsdGK0LXQutGC0L7QsiDRgSDRg9C60LDQt9Cw0L3QvdGL0Lwg0L/QvtC70LXQvC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLm5vc3FsLnJ1bl9pbmRleChpbmRleCwgZmllbGQpCgogICAgZGVmIGtleXMoc2VsZikgLT4gTGlzdFtzdHJdOgogICAgICAgIHJldHVybiBqc29uLmxvYWRzKHNlbGYubm9zcWwuZ2V0YWxsa2V5cygpKQoKICAgIGRlZiBpdGVtcyhzZWxmKSAtPiBMaXN0W1R1cGxlW3N0ciwgT3B0aW9uYWxbc3RyXV1dOgogICAgICAgIHJldHVybiBbKGtleSwgc2VsZi5ub3NxbC5nZXQoa2V5KSkgZm9yIGtleSBpbiBzZWxmLmtleXMoKV0KCgpjbGFzcyBMb2dnZXJTZXJ2aWNlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByb3ZpZGVyPU5vbmUpOgogICAgICAgIHNlbGYudGFibGVfbmFtZSA9ICJFcnJvckxvZyIKICAgICAgICBzZWxmLnByb3ZpZGVyID0gcHJvdmlkZXIgb3IgVGlueU5vU1FMUHJvdmlkZXIodGFibGVfbmFtZT1zZWxmLnRhYmxlX25hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VfbmFtZT0nU2ltcGxlTG9nZ2VyJykKCiAgICBkZWYgd3JpdGVfdG9fbG9nKHNlbGYsIGVycm9yX3RleHQsICoqa3dhcmdzKToKCiAgICAgICAgZGF0YSA9IHsidGltZXN0YW1wIjogRGF0ZUZvcm1hdC5nZXRfbm93X25vc3FsX2Zvcm1hdCgpLAogICAgICAgICAgICAgICAgImVycm9yX3R5cGUiOiBrd2FyZ3MuZ2V0KCdlcnJvcl90eXBlJykgb3IgJycsCiAgICAgICAgICAgICAgICAiZXJyb3JfdGV4dCI6IGVycm9yX3RleHQsCiAgICAgICAgICAgICAgICAiZXJyb3JfaW5mbyI6IGt3YXJncy5nZXQoJ2Vycm9yX2luZm8nKSBvciAnJ30KCiAgICAgICAgc2VsZi5wcm92aWRlci5pbnNlcnQoZGF0YSkKCiAgICBkZWYgZ2V0X2FsbF9lcnJvcnMoc2VsZiwgZGVzY19zb3J0KToKICAgICAgICBhbGxfZXJyb3JzID0gc29ydGVkKHNlbGYucHJvdmlkZXIuZ2V0X2FsbCgpLCBrZXk9bGFtYmRhIGs6IGtbJ3RpbWVzdGFtcCddLCByZXZlcnNlPWRlc2Nfc29ydCkKICAgICAgICByZXR1cm4gYWxsX2Vycm9ycwoKICAgIGRlZiBjbGVhcihzZWxmKToKICAgICAgICBzZWxmLnByb3ZpZGVyLmRiLnRhYmxlKHNlbGYucHJvdmlkZXIudGFibGVfbmFtZSkudHJ1bmNhdGUoKQo="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\static_data.py",
                "PyFileKey": "static_data",
                "PyFileData": "c25faWNvbl9ncmVlbiA9ICdBQUFCQUFFQUdCZ0FBQUVBSUFBb0NRQUFGZ0FBQUNnQUFBQVlBQUFBTUFBQUFBRUFJQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy85Ly8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vLy8vLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vLzIvLy8vLy8vLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vLy8vLy84di8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaQUl3QW1mLy8vOFQvLy8vKy8vLy8zdi8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUprQWpBQ1pBSXdBbWYvLy8vUC8vLy90Ly8vL3IvLy8vLy8vLy8rOEFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSmtBakFDWi8vLy93di8vLy8vLy8vKzAvLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbVFDTUFKa0FqQUNaLy8vLzcvLy8vKzcvLy85YS8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKa0FqQUNaLy8vLzBmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVkFJd0FtUUNNQUpuLy8vKzAvLy8vLy8vLy83d0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WQUl3QW1RQ01BSm4vLy8vdS8vLy84Ly8vLzJvQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSm4vLy8vNC8vLy81Z0NNQUprQWpBQ1pBSXdBbWYvLy8vNy8vLy9GQUl3QW1RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL1ZBSXdBbWYvLy83TC8vLy8rLy8vL3dnQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbWYvLy81ei8vLy8vQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUpuLy8vL2YvLy8vTlFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vVi8vLy9VZi8vLytuLy8vLzAvLy8vYmdDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtZi8vLzV6Ly8vLy9BSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSm4vLy8vay8vLy9RZ0NNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy9WLy8vL3FmLy8vLzcvLy8vTEFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1mLy8vNXovLy8vL0FJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKbi8vLy9mLy8vL05RQ01BSmtBakFDWi8vLy9YZi8vLy9MLy8vL2UvLy8vNlAvLy8vZi8vLzk1QUl3QW1RQ01BSmtBakFDWi8vLy9uUC8vLy8vLy8vKzhBSXdBbVFDTUFKbi8vLy8yLy8vLzVnQ01BSmtBakFDWkFJd0FtZi8vLy83Ly8vL0ZBSXdBbVFDTUFKa0FqQUNaLy8vL1hmLy8vL0wvLy8vOS8vLy8vdi8vLzg0QWpBQ1pBSXdBbVFDTUFKa0FqQUNaLy8vL25QLy8vLy8vLy8rOEFJd0FtUUNNQUpuLy8vL2EvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2YvLy8rQUFJd0FtUUNNQUprQWpBQ1ovLy8vWGYvLy8vTC8vLy8vLy8vLytmLy8vNElBakFDWkFJd0FtUUNNQUprQWpBQ1ovLy8vblAvLy8vLy8vLys4QUl3QW1RQ01BSmtBakFDWi8vLy96Zi8vLy96Ly8vLysvLy8vN2YvLy80OEFqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKa0FqQUNaQUl3QW1RQ01BSmtBakFDWkFJd0FtUUNNQUprQWpBQ1pBSXdBbVFDTUFKaz0nCnNuX2ljb25fcmVkID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vLzkvLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vLy8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vMi8vLy8vLy8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9BQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1pBQUQvbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNWtBQVArWkFBRC9tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4QUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81a0FBUCtaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tUUFBLzVrQUFQK1ovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVrQUFQK1ovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDhBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WQUFEL21RQUEvNW4vLy8rMC8vLy8vLy8vLzd3QUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1ZBQUQvbVFBQS81bi8vLy91Ly8vLzgvLy8vMm9BQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81bi8vLy80Ly8vLzVnQUEvNWtBQVArWkFBRC9tZi8vLy83Ly8vL0ZBQUQvbVFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vVkFBRC9tZi8vLzdMLy8vLysvLy8vd2dBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tZi8vLzV6Ly8vLy9BQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNW4vLy8vZi8vLy9OUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9iZ0FBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21mLy8vNXovLy8vL0FBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81bi8vLy9rLy8vL1FnQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbWYvLy81ei8vLy8vQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVuLy8vL2YvLy8vTlFBQS81a0FBUCtaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVBQUQvbVFBQS81a0FBUCtaLy8vL25QLy8vLy8vLy8rOEFBRC9tUUFBLzVuLy8vLzIvLy8vNWdBQS81a0FBUCtaQUFEL21mLy8vLzcvLy8vRkFBRC9tUUFBLzVrQUFQK1ovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODRBQVArWkFBRC9tUUFBLzVrQUFQK1ovLy8vblAvLy8vLy8vLys4QUFEL21RQUEvNW4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBQUFEL21RQUEvNWtBQVArWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80SUFBUCtaQUFEL21RQUEvNWtBQVArWi8vLy9uUC8vLy8vLy8vKzhBQUQvbVFBQS81a0FBUCtaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ4QUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrQUFQK1pBQUQvbVFBQS81a0FBUCtaQUFEL21RQUEvNWtBQVArWkFBRC9tUUFBLzVrPScKc25faWNvbl9ncmF5ID0gJ0FBQUJBQUVBR0JnQUFBRUFJQUFvQ1FBQUZnQUFBQ2dBQUFBWUFBQUFNQUFBQUFFQUlBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vLzkvLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vLy8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vMi8vLy8vLy8vLy8vLy8vKzhabVptbVdabVpwbi8vLy8vLy8vLzh2Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9abVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVpabVptbWYvLy84VC8vLy8rLy8vLzN2Ly8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acGxtWm1hWlptWm1tZi8vLy9QLy8vL3QvLy8vci8vLy8vLy8vLys4Wm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbG1abWFaLy8vL3d2Ly8vLy8vLy8rMC8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tV1ptWnBsbVptYVovLy8vNy8vLy8rNy8vLzlhLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBsbVptYVovLy8vMGYvLy8vei8vLy8rLy8vLzdmLy8vNDltWm1hWlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WWm1abW1XWm1acG4vLy8rMC8vLy8vLy8vLzd4bVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1ZabVptbVdabVpwbi8vLy91Ly8vLzgvLy8vMnBtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbi8vLy80Ly8vLzVtWm1acGxtWm1hWlptWm1tZi8vLy83Ly8vL0ZabVptbVdabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vVlptWm1tZi8vLzdMLy8vLysvLy8vd21abVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tZi8vLzV6Ly8vLy9abVptbVdabVpwbG1abWFaWm1abW1XWm1acG4vLy8vZi8vLy9OV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy9WLy8vL1VmLy8vK24vLy8vMC8vLy9ibVptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1mLy8vNXovLy8vL1ptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbi8vLy9rLy8vL1FtWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vL1YvLy8vcWYvLy8vNy8vLy9MWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbWYvLy81ei8vLy8vWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBuLy8vL2YvLy8vTldabVpwbG1abWFaLy8vL1hmLy8vL0wvLy8vZS8vLy82UC8vLy9mLy8vOTVabVptbVdabVpwbG1abWFaLy8vL25QLy8vLy8vLy8rOFptWm1tV1ptWnBuLy8vLzIvLy8vNW1abVpwbG1abWFaWm1abW1mLy8vLzcvLy8vRlptWm1tV1ptWnBsbVptYVovLy8vWGYvLy8vTC8vLy85Ly8vLy92Ly8vODVtWm1hWlptWm1tV1ptWnBsbVptYVovLy8vblAvLy8vLy8vLys4Wm1abW1XWm1acG4vLy8vYS8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vZi8vLytBWm1abW1XWm1acGxtWm1hWi8vLy9YZi8vLy9MLy8vLy8vLy8vK2YvLy80Sm1abWFaWm1abW1XWm1acGxtWm1hWi8vLy9uUC8vLy8vLy8vKzhabVptbVdabVpwbG1abWFaLy8vL3pmLy8vL3ovLy8vKy8vLy83Zi8vLzQ5bVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBsbVptYVpabVptbVdabVpwbG1abWFaWm1abW1XWm1acGxtWm1hWlptWm1tV1ptWnBrPScKbWFya19ncmVlbj0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVY1SlJFRlVPRStsVWlGTXcxQVF2ZjYxV1Nab3dsQUVDSE1zeTRKREROVjZIRmtnd1NFSURzTU1RU0J3S053VWpnUThFNmpXUVRLTEtHNkNEZ0diNk5Ld01aYnkzNVhyRnV5ZXViNS85MTdldjM2ajluaWEwQnd3V21FN3VYeTVwN0s5bXA1b3U1dmFDUm1Ha2ZJL0pFbENoMC9YV3BIeUlIcWo4K29lcWZldmZuWVFSQ0hsbGNtOEdiVEljUndXb2dMb1lRYXpBTFE1dFZ1K2lIK0duR0RUTHRGMmNZTXFpK3ZVcUIrUjUzbmt1aTVYWVBnOW9rSXVUM25Ub3M5UlJGMXRvQkFEZ09za21WQnZQR0FPaUJnVlFBOHprb0N2Y052eG1TQkJ4VjZqSld1QitYNnp3VlhFQUhxWWtYMUJxL2hMQTY0Zk9wWWt1RHUreXFKTFJROHprZ0JRQjZWMFFYQzFsSlVsbUlXa1FBOHprZ0JhaFY4SXdQVzUvNW9sK0w5QUFEM01TQUpvMWM3S0ZoTzQ0amYxeGpIejJRVk9yeER6akNTQTFsd3VGSm1JYXpBSTZheGFKOS8zczhlRWl2ZncwRzFyTm4yNDBNNzVsSWwrQWJSR3NIdGM1a296QUFBQUFFbEZUa1N1UW1DQyIKbWFya19waW5rPSJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBTUNBWUFBQUJyNXoyQkFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQUFKY0VoWmN3QUFEc1FBQUE3RUFaVXJEaHNBQUFVYmFWUllkRmhOVERwamIyMHVZV1J2WW1VdWVHMXdBQUFBQUFBOFAzaHdZV05yWlhRZ1ltVm5hVzQ5SXUrN3Z5SWdhV1E5SWxjMVRUQk5jRU5sYUdsSWVuSmxVM3BPVkdONmEyTTVaQ0kvUGlBOGVEcDRiWEJ0WlhSaElIaHRiRzV6T25nOUltRmtiMkpsT201ek9tMWxkR0V2SWlCNE9uaHRjSFJyUFNKQlpHOWlaU0JZVFZBZ1EyOXlaU0EyTGpBdFl6QXdNaUF4TVRZdU1UWTBOelkyTENBeU1ESXhMekF5THpFNUxUSXpPakV3T2pBM0lDQWdJQ0FnSUNBaVBpQThjbVJtT2xKRVJpQjRiV3h1Y3pweVpHWTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5MekU1T1Rrdk1ESXZNakl0Y21SbUxYTjViblJoZUMxdWN5TWlQaUE4Y21SbU9rUmxjMk55YVhCMGFXOXVJSEprWmpwaFltOTFkRDBpSWlCNGJXeHVjenA0YlhBOUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOGlJSGh0Ykc1ek9tUmpQU0pvZEhSd09pOHZjSFZ5YkM1dmNtY3ZaR012Wld4bGJXVnVkSE12TVM0eEx5SWdlRzFzYm5NNmNHaHZkRzl6YUc5d1BTSm9kSFJ3T2k4dmJuTXVZV1J2WW1VdVkyOXRMM0JvYjNSdmMyaHZjQzh4TGpBdklpQjRiV3h1Y3pwNGJYQk5UVDBpYUhSMGNEb3ZMMjV6TG1Ga2IySmxMbU52YlM5NFlYQXZNUzR3TDIxdEx5SWdlRzFzYm5NNmMzUkZkblE5SW1oMGRIQTZMeTl1Y3k1aFpHOWlaUzVqYjIwdmVHRndMekV1TUM5elZIbHdaUzlTWlhOdmRYSmpaVVYyWlc1MEl5SWdlRzF3T2tOeVpXRjBiM0pVYjI5c1BTSkJaRzlpWlNCUWFHOTBiM05vYjNBZ01qRXVNaUFvVFdGamFXNTBiM05vS1NJZ2VHMXdPa055WldGMFpVUmhkR1U5SWpJd01qRXRNRGd0TVRCVU1UQTZOVFU2TlRNck1ETTZNREFpSUhodGNEcE5iMlJwWm5sRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUI0YlhBNlRXVjBZV1JoZEdGRVlYUmxQU0l5TURJeExUQTRMVEV3VkRFd09qVTJPalF4S3pBek9qQXdJaUJrWXpwbWIzSnRZWFE5SW1sdFlXZGxMM0J1WnlJZ2NHaHZkRzl6YUc5d09rTnZiRzl5VFc5a1pUMGlNeUlnY0dodmRHOXphRzl3T2tsRFExQnliMlpwYkdVOUluTlNSMElnU1VWRE5qRTVOall0TWk0eElpQjRiWEJOVFRwSmJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdlRzF3VFUwNlJHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlJSGh0Y0UxTk9rOXlhV2RwYm1Gc1JHOWpkVzFsYm5SSlJEMGllRzF3TG1ScFpEcGhaVGt5WW1JeVppMHhaRGt6TFRRMlpEUXRZamxrT1MxaE9XVmtNak15TVdRNFptWWlQaUE4ZUcxd1RVMDZTR2x6ZEc5eWVUNGdQSEprWmpwVFpYRStJRHh5WkdZNmJHa2djM1JGZG5RNllXTjBhVzl1UFNKamNtVmhkR1ZrSWlCemRFVjJkRHBwYm5OMFlXNWpaVWxFUFNKNGJYQXVhV2xrT21GbE9USmlZakptTFRGa09UTXRORFprTkMxaU9XUTVMV0U1WldReU16SXhaRGhtWmlJZ2MzUkZkblE2ZDJobGJqMGlNakF5TVMwd09DMHhNRlF4TURvMU5UbzFNeXN3TXpvd01DSWdjM1JGZG5RNmMyOW1kSGRoY21WQloyVnVkRDBpUVdSdlltVWdVR2h2ZEc5emFHOXdJREl4TGpJZ0tFMWhZMmx1ZEc5emFDa2lMejRnUEM5eVpHWTZVMlZ4UGlBOEwzaHRjRTFOT2tocGMzUnZjbmsrSUR3dmNtUm1Pa1JsYzJOeWFYQjBhVzl1UGlBOEwzSmtaanBTUkVZK0lEd3ZlRHA0YlhCdFpYUmhQaUE4UDNod1lXTnJaWFFnWlc1a1BTSnlJajgramxiSzBnQUFBVWhKUkVGVU9FK2xrckZLdzJBVWhXOSt0VlNrb0ZCZE9sa0ZSOGxveVZCOEFVR2NmWUhhWFhBVzNCeWlnNnV6Q0w1QTdWQmNvK0JTcEc1ZEpOS2lGcXFVeG56WDNsQmNleURjLytTY2MzTVM0ajBmWENVeUE3emVmVHZwWGpZbFh5NU83b2hzbk8xTEVBUi9mSUpXcXlXZDQxdVJ5ZU9HcjdHVWFsVnhQMitmMlkzdjlKTGNuUEtiMnJuNHZxOUJwaUxWOE9BRlpGMi8wVlpDZzZXZGRTbFV5c3BQSDY0bERFT3AxK3M2QVJvZWEwdldsWTZxU3RpYWpCTVo5NGJLZ1lXWkFBMlBOU0RyNHJzbkpXeGQzRndWdDVKWGZsSTUxR2xoZ0liSEdwQjFla3JCMXRIN0lHdGdyd0Jzb3VHeEJzQVY5N2Ixd0ZhMzRHVU5wbUV0MFBCWUE3S3VlOUZVd3RiQll6ZHI4UDhEQWpRODFvQ3NXOTdkVXNKV0x6Y3ZvLzZYOHVrUGFFdlE4RmdEc2k2M1ZsREMxbUVubG8vR2kvSW9pdlJuc2duUThGZ0RzalAreWlLL0dWQ3dxRnVUaDl3QUFBQUFTVVZPUks1Q1lJST0iCm1hcmtfYmx1ZT0iaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQU1DQVlBQUFCcjV6MkJBQUFBQVhOU1IwSUFyczRjNlFBQUFBUm5RVTFCQUFDeGp3djhZUVVBQUFBSmNFaFpjd0FBRHNRQUFBN0VBWlVyRGhzQUFBVWJhVlJZZEZoTlREcGpiMjB1WVdSdlltVXVlRzF3QUFBQUFBQThQM2h3WVdOclpYUWdZbVZuYVc0OUl1Kzd2eUlnYVdROUlsYzFUVEJOY0VObGFHbEllbkpsVTNwT1ZHTjZhMk01WkNJL1BpQThlRHA0YlhCdFpYUmhJSGh0Ykc1ek9uZzlJbUZrYjJKbE9tNXpPbTFsZEdFdklpQjRPbmh0Y0hSclBTSkJaRzlpWlNCWVRWQWdRMjl5WlNBMkxqQXRZekF3TWlBeE1UWXVNVFkwTnpZMkxDQXlNREl4THpBeUx6RTVMVEl6T2pFd09qQTNJQ0FnSUNBZ0lDQWlQaUE4Y21SbU9sSkVSaUI0Yld4dWN6cHlaR1k5SW1oMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZNREl2TWpJdGNtUm1MWE41Ym5SaGVDMXVjeU1pUGlBOGNtUm1Pa1JsYzJOeWFYQjBhVzl1SUhKa1pqcGhZbTkxZEQwaUlpQjRiV3h1Y3pwNGJYQTlJbWgwZEhBNkx5OXVjeTVoWkc5aVpTNWpiMjB2ZUdGd0x6RXVNQzhpSUhodGJHNXpPbVJqUFNKb2RIUndPaTh2Y0hWeWJDNXZjbWN2WkdNdlpXeGxiV1Z1ZEhNdk1TNHhMeUlnZUcxc2JuTTZjR2h2ZEc5emFHOXdQU0pvZEhSd09pOHZibk11WVdSdlltVXVZMjl0TDNCb2IzUnZjMmh2Y0M4eExqQXZJaUI0Yld4dWN6cDRiWEJOVFQwaWFIUjBjRG92TDI1ekxtRmtiMkpsTG1OdmJTOTRZWEF2TVM0d0wyMXRMeUlnZUcxc2JuTTZjM1JGZG5ROUltaDBkSEE2THk5dWN5NWhaRzlpWlM1amIyMHZlR0Z3THpFdU1DOXpWSGx3WlM5U1pYTnZkWEpqWlVWMlpXNTBJeUlnZUcxd09rTnlaV0YwYjNKVWIyOXNQU0pCWkc5aVpTQlFhRzkwYjNOb2IzQWdNakV1TWlBb1RXRmphVzUwYjNOb0tTSWdlRzF3T2tOeVpXRjBaVVJoZEdVOUlqSXdNakV0TURndE1UQlVNVEE2TlRVNk5UTXJNRE02TURBaUlIaHRjRHBOYjJScFpubEVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCNGJYQTZUV1YwWVdSaGRHRkVZWFJsUFNJeU1ESXhMVEE0TFRFd1ZERXdPalUyT2pReEt6QXpPakF3SWlCa1l6cG1iM0p0WVhROUltbHRZV2RsTDNCdVp5SWdjR2h2ZEc5emFHOXdPa052Ykc5eVRXOWtaVDBpTXlJZ2NHaHZkRzl6YUc5d09rbERRMUJ5YjJacGJHVTlJbk5TUjBJZ1NVVkROakU1TmpZdE1pNHhJaUI0YlhCTlRUcEpibk4wWVc1alpVbEVQU0o0YlhBdWFXbGtPbUZsT1RKaVlqSm1MVEZrT1RNdE5EWmtOQzFpT1dRNUxXRTVaV1F5TXpJeFpEaG1aaUlnZUcxd1RVMDZSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpSUhodGNFMU5Pazl5YVdkcGJtRnNSRzlqZFcxbGJuUkpSRDBpZUcxd0xtUnBaRHBoWlRreVltSXlaaTB4WkRrekxUUTJaRFF0WWpsa09TMWhPV1ZrTWpNeU1XUTRabVlpUGlBOGVHMXdUVTA2U0dsemRHOXllVDRnUEhKa1pqcFRaWEUrSUR4eVpHWTZiR2tnYzNSRmRuUTZZV04wYVc5dVBTSmpjbVZoZEdWa0lpQnpkRVYyZERwcGJuTjBZVzVqWlVsRVBTSjRiWEF1YVdsa09tRmxPVEppWWpKbUxURmtPVE10TkRaa05DMWlPV1E1TFdFNVpXUXlNekl4WkRobVppSWdjM1JGZG5RNmQyaGxiajBpTWpBeU1TMHdPQzB4TUZReE1EbzFOVG8xTXlzd016b3dNQ0lnYzNSRmRuUTZjMjltZEhkaGNtVkJaMlZ1ZEQwaVFXUnZZbVVnVUdodmRHOXphRzl3SURJeExqSWdLRTFoWTJsdWRHOXphQ2tpTHo0Z1BDOXlaR1k2VTJWeFBpQThMM2h0Y0UxTk9raHBjM1J2Y25rK0lEd3ZjbVJtT2tSbGMyTnlhWEIwYVc5dVBpQThMM0prWmpwU1JFWStJRHd2ZURwNGJYQnRaWFJoUGlBOFAzaHdZV05yWlhRZ1pXNWtQU0p5SWo4K2psYkswZ0FBQVR4SlJFRlVPRStsa3I5S3cyQVV4VysrS2tJR3JRNWFFQlFYZGNtUVJSejZCRG83K3dUQjNRY29ycElYMExtejRnTmtFQWNEWm5MeUR4WkVpQ2pTUUcwaCtydm1odURhQStIbWZPZWN5OGxIdkpPcjIxS21nSmNOOHZJaWU1TE9nbDhkaVJ6dWJrbTMyNjNZSDVJa2tmUHIrNHFKdkg0V3NoK3NpL3NvUnZVQlQ4dnpsUGZPK2hLR29RYVpBTTE4Z0t6TEJ1OUthTEM1MHBidHpxTHkvbWxQNGppV0tJcDBBalE4MXBhczJ3dldsTEMxTEVzcHhoUGx3TUpNZ0liSEdwQjFOdzl2U3RqYW1mZkZuNTFSZm5CMHJOUENBQTJQTlNEcjlPMFhiQjErVCtvRzlnbkFKaG9lYXdEY3pzYXl2ckMxNWJ5NlFSUFdBZzJQTlNEckxyTm5KV3g5ekwvcUJ2OHZFS0Roc1Faa1hiQzZwTVFhREVkajVjMEx0Q1ZvelFaa1hkdWZVOEpXbnJ1WFhIbWFwdm96MlFSbzVnTmtwL3lWUlg0QTZQdXdyalh5NkZJQUFBQUFTVVZPUks1Q1lJST0iCg=="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\sm_adr_docs.py",
                "PyFileKey": "sm_adr_docs",
                "PyFileData": "ZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QKCmltcG9ydCBkYl9zZXJ2aWNlcwppbXBvcnQgd2lkZ2V0cwppbXBvcnQgdWlfbW9kZWxzCmZyb20gcHJpbnRpbmdfZmFjdG9yeSBpbXBvcnQgUHJpbnRTZXJ2aWNlCmZyb20gdWlfdXRpbHMgaW1wb3J0IEhhc2hNYXAKZnJvbSBiYXJjb2RlX3dvcmtlcnMgaW1wb3J0IEJhcmNvZGVBZHJXb3JrZXIKCgpjbGFzcyBBZHJEb2NzTGlzdFNjcmVlbih1aV9tb2RlbHMuRG9jc0xpc3RTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgtGLJwogICAgcHJvY2Vzc19uYW1lID0gJ9CQ0LTRgNC10YHQvdC+0LUg0YXRgNCw0L3QtdC90LjQtScKCiAgICBkZWYgX19pbml0X18oc2VsZiwgaGFzaF9tYXA6IEhhc2hNYXAsIHJzX3NldHRpbmdzPU5vbmUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaGFzaF9tYXApCgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuc2NyZWVuX3ZhbHVlcyA9IHt9CiAgICAgICAgc2VsZi5kb2NfdHlwZXMgPSAoJ9CS0YHQtScsICfQntGC0LHQvtGAJywgJ9Cg0LDQt9C80LXRidC10L3QuNC1JywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnKQogICAgICAgIHNlbGYuZG9jX3N0YXR1c2VzID0gKCfQktGB0LUnLCAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nLCAn0JLRi9Cz0YDRg9C20LXQvScsICfQmiDQstGL0LPRgNGD0LfQutC1JykKICAgICAgICBzZWxmLnBvcHVwX21lbnVfZGF0YSA9ICgn0KPQtNCw0LvQuNGC0YwnLCAn0J7Rh9C40YHRgtC40YLRjCDQtNCw0L3QvdGL0LUg0L/QtdGA0LXRgdGH0LXRgtCwJywgJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JykKICAgICAgICBzZWxmLmN1cnJlbnRfc3RhdHVzID0gJ9CS0YHQtScKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSAn0JLRgdC1JwogICAgICAgIHNlbGYubGlzdF9kYXRhX2tleSA9ICdkb2N1bWVudHNfbGlzdCcKCiAgICBkZWYgaW5pdF9zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX2Fkcl90eXBlX3NlbGVjdCddID0gJzsnLmpvaW4oc2VsZi5kb2NfdHlwZXMpCiAgICAgICAgc2VsZi5oYXNoX21hcFsnZG9jX3N0YXR1c19zZWxlY3QnXSA9ICc7Jy5qb2luKHNlbGYuZG9jX3N0YXR1c2VzKQogICAgICAgIHNlbGYuX2ZpbGxfdGFibGVfZGF0YSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpIC0+IE5vbmU6CiAgICAgICAgc2VsZi5fZmlsbF90YWJsZV9kYXRhKCkKCiAgICBkZWYgb25faW5wdXQoc2VsZikgLT4gTm9uZToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdDYXJkc0NsaWNrJzogc2VsZi5fY2FyZHNfY2xpY2ssCiAgICAgICAgICAgICdkb2NfYWRyX3R5cGVfY2xpY2snOiBzZWxmLl9kb2NfdHlwZV9zZWxlY3QsCiAgICAgICAgICAgICdjb25maXJtX2NsZWFyX2JhcmNvZGVfZGF0YSc6IGxhbWJkYTogc2VsZi5fY2xlYXJfYmFyY29kZV9kYXRhKHNlbGYuZ2V0X2lkX2RvYygpKSwKICAgICAgICB9CiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc3VwZXIoKS5vbl9pbnB1dCgpCgogICAgZGVmIF9jYXJkc19jbGljayhzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZShzZWxmLmxpc3RfZGF0YV9rZXkpCiAgICAgICAgaWRfZG9jID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIEFkckRvY0RldGFpbHNTY3JlZW4oc2VsZi5oYXNoX21hcCwgaWRfZG9jPWlkX2RvYykuc2hvdygpCiAgICAgICAgc2VsZi5oYXNoX21hcC5ub19yZWZyZXNoKCkKCiAgICBkZWYgX2RvY190eXBlX3NlbGVjdChzZWxmKToKICAgICAgICBzZWxmLmN1cnJlbnRfZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfYWRyX3R5cGVfY2xpY2snXQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2VsZi5fZmluaXNoX3Byb2Nlc3MoKQoKICAgIGRlZiBfbGF5b3V0X2FjdGlvbihzZWxmKSAtPiBOb25lOgogICAgICAgIGxheW91dF9saXN0ZW5lciA9IHNlbGYuaGFzaF9tYXBbJ2xheW91dF9saXN0ZW5lciddCgogICAgICAgIGlmIGxheW91dF9saXN0ZW5lciA9PSAn0KPQtNCw0LvQuNGC0YwnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fZGVsZXRlJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQo9C00LDQu9C40YLRjCDQtNC+0LrRg9C80LXQvdGCINGBINGD0YHRgtGA0L7QudGB0YLQstCwPycKICAgICAgICAgICAgKQogICAgICAgIGVsaWYgbGF5b3V0X2xpc3RlbmVyID09ICfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LAnOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnNob3dfZGlhbG9nKAogICAgICAgICAgICAgICAgbGlzdGVuZXI9J2NvbmZpcm1fY2xlYXJfYmFyY29kZV9kYXRhJywKICAgICAgICAgICAgICAgIHRpdGxlPSfQntGH0LjRgdGC0LjRgtGMINC00LDQvdC90YvQtSDQv9C10YDQtdGB0YfQtdGC0LA/JwogICAgICAgICAgICApCiAgICAgICAgZWxpZiBsYXlvdXRfbGlzdGVuZXIgPT0gJ9Ce0YLQv9GA0LDQstC40YLRjCDQv9C+0LLRgtC+0YDQvdC+JzoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZygKICAgICAgICAgICAgICAgIGxpc3RlbmVyPSdjb25maXJtX3Jlc2VuZF9kb2MnLAogICAgICAgICAgICAgICAgdGl0bGU9J9Ce0YLQv9GA0LDQstC40YLRjCDQtNC+0LrRg9C80LXQvdGCINC/0L7QstGC0L7RgNC90L4/JwogICAgICAgICAgICApCgogICAgZGVmIF9maWxsX3RhYmxlX2RhdGEoc2VsZik6CiAgICAgICAgbGlzdF9kYXRhID0gc2VsZi5fZ2V0X2RvY19saXN0X2RhdGEoc2VsZi5jdXJyZW50X2RvY190eXBlLCBzZWxmLmN1cnJlbnRfc3RhdHVzKQogICAgICAgIHByZXBhcmVkX2RhdGEgPSBzZWxmLl9wcmVwYXJlX3RhYmxlX2RhdGEobGlzdF9kYXRhKQogICAgICAgIGRvY19jYXJkcyA9IHNlbGYuX2dldF9kb2NfY2FyZHNfdmlldygKICAgICAgICAgICAgcHJlcGFyZWRfZGF0YSwKICAgICAgICAgICAgcG9wdXBfbWVudV9kYXRhPSc7Jy5qb2luKHNlbGYucG9wdXBfbWVudV9kYXRhKQogICAgICAgICkKICAgICAgICBzZWxmLmhhc2hfbWFwW3NlbGYubGlzdF9kYXRhX2tleV0gPSBkb2NfY2FyZHMudG9fanNvbigpCgogICAgZGVmIF9nZXRfZG9jX2xpc3RfZGF0YShzZWxmLCBkb2NfdHlwZSwgZG9jX3N0YXR1cykgLT4gbGlzdDoKICAgICAgICBkb2NfdHlwZSA9ICcnIGlmIGRvY190eXBlID09ICLQktGB0LUiIGVsc2UgZG9jX3R5cGUKICAgICAgICBkb2Nfc3RhdHVzID0gJycgaWYgZG9jX3N0YXR1cyA9PSAn0JLRgdC1JyBlbHNlIGRvY19zdGF0dXMKCiAgICAgICAgZG9jc19kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfdmlld19kYXRhKGRvY190eXBlLCBkb2Nfc3RhdHVzKQogICAgICAgIHJldHVybiBkb2NzX2RhdGEKCiAgICBkZWYgX3ByZXBhcmVfdGFibGVfZGF0YShzZWxmLCBsaXN0X2RhdGEpIC0+IGxpc3Q6CiAgICAgICAgdGFibGVfZGF0YSA9IFtdCiAgICAgICAgZm9yIHJlY29yZCBpbiBsaXN0X2RhdGE6CiAgICAgICAgICAgIGRvY19zdGF0dXMgPSAnJwoKICAgICAgICAgICAgaWYgcmVjb3JkWyd2ZXJpZmllZCddIGFuZCByZWNvcmRbJ3NlbnQnXToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0JLRi9Cz0YDRg9C20LXQvScKICAgICAgICAgICAgZWxpZiByZWNvcmRbJ3ZlcmlmaWVkJ106CiAgICAgICAgICAgICAgICBkb2Nfc3RhdHVzID0gJ9CaINCy0YvQs9GA0YPQt9C60LUnCiAgICAgICAgICAgIGVsaWYgbm90IChyZWNvcmRbJ3ZlcmlmaWVkJ10gYW5kIHJlY29yZFsnc2VudCddKToKICAgICAgICAgICAgICAgIGRvY19zdGF0dXMgPSAn0Jog0LLRi9C/0L7Qu9C90LXQvdC40Y4nCgogICAgICAgICAgICBkb2NfdGl0bGUgPSAne30g0L7RgiB7fScuZm9ybWF0KAogICAgICAgICAgICAgICAgcmVjb3JkWydkb2NfbiddLCBzZWxmLl9mb3JtYXRfZGF0ZShyZWNvcmRbJ2RvY19kYXRlJ10pKQoKICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQoewogICAgICAgICAgICAgICAgJ2tleSc6IHJlY29yZFsnaWRfZG9jJ10sCiAgICAgICAgICAgICAgICAnZG9jX3R5cGUnOiByZWNvcmRbJ2RvY190eXBlJ10sCiAgICAgICAgICAgICAgICAnZG9jX3RpdGxlJzogZG9jX3RpdGxlLAogICAgICAgICAgICAgICAgJ2RvY19uJzogcmVjb3JkWydkb2NfbiddLAogICAgICAgICAgICAgICAgJ2RvY19kYXRlJzogc2VsZi5fZm9ybWF0X2RhdGUocmVjb3JkWydkb2NfZGF0ZSddKSwKICAgICAgICAgICAgICAgICd3YXJlaG91c2UnOiByZWNvcmRbJ3dhcmVob3VzZSddLAogICAgICAgICAgICAgICAgJ2FkZF9tYXJrX3NlbGVjdGlvbic6IHJlY29yZFsnYWRkX21hcmtfc2VsZWN0aW9uJ10sCiAgICAgICAgICAgICAgICAnc3RhdHVzJzogZG9jX3N0YXR1cwogICAgICAgICAgICB9KQoKICAgICAgICByZXR1cm4gdGFibGVfZGF0YQoKICAgIGRlZiBfZ2V0X2RvY19jYXJkc192aWV3KHNlbGYsIHRhYmxlX2RhdGEsIHBvcHVwX21lbnVfZGF0YSk6CiAgICAgICAgdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoIlRpdGxlVGV4dFNpemUiKQogICAgICAgIGNhcmRfdGl0bGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmRUaXRsZVRleHRTaXplJykKICAgICAgICBjYXJkX2RhdGVfdGV4dF9zaXplID0gc2VsZi5yc19zZXR0aW5ncy5nZXQoJ0NhcmREYXRlVGV4dFNpemUnKQoKICAgICAgICBkb2NfY2FyZHMgPSB3aWRnZXRzLkN1c3RvbUNhcmRzKAogICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAc3RhdHVzJywKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXZpdHlfaG9yaXpvbnRhbD0nbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD0yCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGRvY190eXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9dGl0bGVfdGV4dF9zaXplLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5Qb3B1cE1lbnVCdXR0b24oCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPXBvcHVwX21lbnVfZGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGU9Im1lbnVfZGVsZXRlIiwKICAgICAgICAgICAgICAgICAgICApLAoKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCgogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgICAgIHdpZGdldHMuVGV4dFZpZXcoCiAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZG9jX24nLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0Qm9sZD1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX3RpdGxlX3RleHRfc2l6ZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWRnZXRzLkxpbmVhckxheW91dCgKCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgVmFsdWU9J0B3YXJlaG91c2UnLAogICAgICAgICAgICAgICAgICAgICAgICBUZXh0U2l6ZT1jYXJkX2RhdGVfdGV4dF9zaXplCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKSwKCiAgICAgICAgICAgICAgICB3aWR0aD0ibWF0Y2hfcGFyZW50IgogICAgICAgICAgICApLAogICAgICAgICAgICBvcHRpb25zPXdpZGdldHMuT3B0aW9ucygpLm9wdGlvbnMsCiAgICAgICAgICAgIGNhcmRzZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gZG9jX2NhcmRzCgogICAgZGVmIF9kb2NfZGVsZXRlKHNlbGYsIGlkX2RvYyk6CiAgICAgICAgcmVzdWx0ID0gVHJ1ZQogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlLmRlbGV0ZV9hZHJfZG9jKGlkX2RvYykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAuZXJyb3JfbG9nKGUuYXJnc1swXSkKICAgICAgICAgICAgcmVzdWx0ID0gRmFsc2UKCiAgICAgICAgcmV0dXJuIHJlc3VsdAoKICAgIGRlZiBfZ2V0X3NlbGVjdGVkX2NhcmRfcHV0X2RhdGEoc2VsZiwgcHV0X2RhdGE9Tm9uZSk6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCgogICAgICAgIHRhYmxlX3R5cGUgPSAnb3V0JyBpZiBjYXJkX2RhdGFbJ2RvY190eXBlJ10gaW4gWyfQntGC0LHQvtGAJywgJ9Cf0LXRgNC10LzQtdGJ0LXQvdC40LUnXSBlbHNlICdpbicKCiAgICAgICAgcHV0X2RhdGEgPSBwdXRfZGF0YSBvciB7fQogICAgICAgIHB1dF9kYXRhWydpZF9kb2MnXSA9IGNhcmRfZGF0YVsna2V5J10KICAgICAgICBwdXRfZGF0YVsnZG9jX3R5cGUnXSA9IGNhcmRfZGF0YVsnZG9jX3R5cGUnXQogICAgICAgIHB1dF9kYXRhWyd0YWJsZV90eXBlJ10gPSB0YWJsZV90eXBlCiAgICAgICAgcHV0X2RhdGFbJ2RvY19uJ10gPSBjYXJkX2RhdGFbJ2RvY19uJ10KICAgICAgICBwdXRfZGF0YVsnZG9jX2RhdGUnXSA9IGNhcmRfZGF0YVsnZG9jX2RhdGUnXQogICAgICAgIHB1dF9kYXRhWydkb2NfdGl0bGUnXSA9IGNhcmRfZGF0YVsnZG9jX3RpdGxlJ10KICAgICAgICBwdXRfZGF0YVsnd2FyZWhvdXNlJ10gPSBjYXJkX2RhdGFbJ3dhcmVob3VzZSddCgogICAgICAgIHJldHVybiBwdXRfZGF0YQoKICAgIGRlZiBjb25maXJtX2RlbGV0ZV9kb2NfbGlzdGVuZXIoc2VsZik6CiAgICAgICAgY2FyZF9kYXRhID0gc2VsZi5oYXNoX21hcC5nZXRfanNvbigiY2FyZF9kYXRhIikKICAgICAgICBpZF9kb2MgPSBjYXJkX2RhdGFbJ2tleSddCiAgICAgICAgZG9jX3R5cGUgPSBzZWxmLmhhc2hfbWFwWydkb2NfdHlwZV9jbGljayddCgogICAgICAgIGlmIHNlbGYuZG9jX2RlbGV0ZShpZF9kb2MpOgogICAgICAgICAgICBkb2NzX2NvdW50ID0gc2VsZi5nZXRfZG9jc19jb3VudChkb2NfdHlwZT1kb2NfdHlwZSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0JTQvtC60YPQvNC10L3RgiDRg9GB0L/QtdGI0L3QviDRg9C00LDQu9GR0L0nKQogICAgICAgICAgICBpZiBkb2NzX2NvdW50OgogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFydCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLl9maW5pc2hfcHJvY2VzcygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC50b2FzdCgn0J7RiNC40LHQutCwINGD0LTQsNC70LXQvdC40Y8g0LTQvtC60YPQvNC10L3RgtCwJykKCiAgICBkZWYgX2NsZWFyX2JhcmNvZGVfZGF0YShzZWxmLCBpZF9kb2MpOgogICAgICAgIGlkX2RvYyA9IHNlbGYuaGFzaF9tYXAuZ2V0X2pzb24oJ2NhcmRfZGF0YScpLmdldCgna2V5JykgaWYgc2VsZi5oYXNoX21hcFsnY2FyZF9kYXRhJ10gZWxzZSAnJwogICAgICAgIHJldHVybiBzZWxmLnNlcnZpY2UuY2xlYXJfYmFyY29kZV9kYXRhKGlkX2RvYykKCiAgICBkZWYgZ2V0X2lkX2RvYyhzZWxmKToKICAgICAgICBpZF9kb2MgPSBzZWxmLmhhc2hfbWFwWydzZWxlY3RlZF9jYXJkX2tleSddCiAgICAgICAgcmV0dXJuIGlkX2RvYwoKCmNsYXNzIEFkckRvY0RldGFpbHNTY3JlZW4odWlfbW9kZWxzLkRvY0RldGFpbHNTY3JlZW4pOgogICAgc2NyZWVuX25hbWUgPSAn0JTQvtC60YPQvNC10L3RgiDRgtC+0LLQsNGA0YsnCiAgICBwcm9jZXNzX25hbWUgPSAn0JDQtNGA0LXRgdC90L7QtSDRhdGA0LDQvdC10L3QuNC1JwoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBoYXNoX21hcCwgaWRfZG9jLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwPWhhc2hfbWFwKQogICAgICAgIHNlbGYudGFibGVzX3R5cGVzID0gJ9Ce0YLQsdC+0YA70KDQsNC30LzQtdGJ0LXQvdC40LUnCiAgICAgICAgc2VsZi5pZF9kb2MgPSBpZF9kb2MKICAgICAgICBzZWxmLnNlcnZpY2UgPSBOb25lCiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwgPSAnJwogICAgICAgIHNlbGYuY3VycmVudF9jZWxsX2lkID0gJycKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3R5cGUgPSAnJwogICAgICAgIHNlbGYuZG9jX3RpdGxlID0gJycKICAgICAgICBzZWxmLmRvY19kYXRhID0ge30KICAgICAgICBzZWxmLmxpc3RfZGF0YV9rZXkgPSAnZG9jX2dvb2RzX3RhYmxlJwogICAgICAgIHNlbGYuc2NyZWVuX2RhdGEgPSB7fQogICAgICAgIHNlbGYuaGFzaF9tYXBfa2V5cyA9IFtdCgogICAgZGVmIGluaXRfc2NyZWVuKHNlbGYpOgogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoaWRfZG9jPXNlbGYuaWRfZG9jKQogICAgICAgIHNlbGYuZG9jX2RhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kYXRhX2J5X2lkKCkKCiAgICAgICAgc2VsZi5kb2NfdHlwZSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5kb2NfdHlwZSkKICAgICAgICBzZWxmLnNlcnZpY2UudGFibGVfdHlwZSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfZGF0ZSddID0gc2VsZi5fZm9ybWF0X2RhdGUoc2VsZi5kb2NfZGF0YVsnZG9jX2RhdGUnXSkKICAgICAgICBzZWxmLmRvY190aXRsZSA9ICd7ZG9jX3R5cGV9IOKEliB7ZG9jX259INC+0YIge2RvY19kYXRlfScuZm9ybWF0KAogICAgICAgICAgICAqKnNlbGYuZG9jX2RhdGEKICAgICAgICApCgogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlc190eXBlJ10gPSBzZWxmLnRhYmxlc190eXBlcwogICAgICAgIHNlbGYuZG9jX2RhdGFbJ3RhYmxlX3R5cGUnXSA9IHNlbGYuZG9jX2RhdGFbJ2RvY190eXBlJ10KICAgICAgICBzZWxmLmRvY19kYXRhWydkb2NfdGl0bGUnXSA9IHNlbGYuZG9jX3RpdGxlCgogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0X2RhdGEoc2VsZi5kb2NfZGF0YSwgZmlsbF9ub25lPVRydWUpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKCiAgICBkZWYgb25fc3RhcnQoc2VsZik6CiAgICAgICAgc3VwZXIoKS5fb25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKSAtPiBOb25lOgogICAgICAgIGxpc3RlbmVycyA9IHsKICAgICAgICAgICAgJ0NhcmRzQ2xpY2snOiBzZWxmLl9jYXJkc19jbGljaywKICAgICAgICAgICAgJ2J0bl9iYXJjb2Rlcyc6IGxhbWJkYTogc2VsZi5oYXNoX21hcC5zaG93X2RpYWxvZyhsaXN0ZW5lcj0i0JLQstC10YHRgtC40KjRgtGA0LjRhdC60L7QtCIpLAogICAgICAgICAgICAnYmFyY29kZSc6IGxhbWJkYTogc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwLmdldCgnYmFyY29kZV9jYW1lcmEnKSksCiAgICAgICAgICAgICdidG5fZG9jX21hcmtfdmVyaWZpZWQnOiBzZWxmLl9kb2NfbWFya192ZXJpZmllZCwKICAgICAgICAgICAgJ2J0bl9zZWxlY3RfY2VsbCc6IHNlbGYuX3NlbGVjdF9jZWxsLAogICAgICAgICAgICAnY2VsbF9zZWxlY3Rfc3VjY2Vzcyc6IHNlbGYuX3NlbGVjdF9jZWxsX3Jlc3VsdCwKICAgICAgICAgICAgJ2J0bl9jbGVhcl9jZWxsJzogc2VsZi5fY2xlYXJfY2VsbCwKICAgICAgICAgICAgJ3RhYmxlX3R5cGUnOiBzZWxmLl90YWJsZV90eXBlX3NlbGVjdGVkLAogICAgICAgICAgICAnT05fQkFDS19QUkVTU0VEJzogc2VsZi5fYmFja19zY3JlZW4sCiAgICAgICAgICAgICdCQUNLX0JVVFRPTic6IHNlbGYuX2JhY2tfc2NyZWVuLAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5saXN0ZW5lciBpbiBsaXN0ZW5lcnM6CiAgICAgICAgICAgIGxpc3RlbmVyc1tzZWxmLmxpc3RlbmVyXSgpCiAgICAgICAgZWxpZiBzZWxmLl9pc19yZXN1bHRfcG9zaXRpdmUoJ9CS0LLQtdGB0YLQuNCo0YLRgNC40YXQutC+0LQnKToKICAgICAgICAgICAgc2VsZi5fYmFyY29kZV9saXN0ZW5lcihzZWxmLmhhc2hfbWFwWydmbGRfYmFyY29kZSddKQogICAgICAgIHN1cGVyKCkub25faW5wdXQoKQoKICAgIGRlZiBfY2FyZHNfY2xpY2soc2VsZik6CiAgICAgICAgc2VsZWN0ZWRfY2FyZF9kYXRhID0gc2VsZi5fZ2V0X3NlbGVjdGVkX2NhcmRfZGF0YSgpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkX2NhcmRfZGF0YToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNlbGYuaGFzaF9tYXAucmVtb3ZlKHNlbGYubGlzdF9kYXRhX2tleSkKICAgICAgICBpZiBzZWxlY3RlZF9jYXJkX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJykgPT0gJzEnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZWN0ZWRfY2FyZF9kYXRhWydrZXknXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9vcGVuX3NlbGVjdF9nb29kc19zY3JlZW4oZGF0YT1zZWxlY3RlZF9jYXJkX2RhdGEpCgogICAgICAgIHNlbGYuaGFzaF9tYXAubm9fcmVmcmVzaCgpCgogICAgZGVmIF9iYXJjb2RlX2xpc3RlbmVyKHNlbGYsIGJhcmNvZGUpOgogICAgICAgIGlmIHNlbGYuX3VwZGF0ZV9jdXJyZW50X2NlbGwoYmFyY29kZSk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zID0gc2VsZi5fZ2V0X2JhcmNvZGVfcHJvY2Vzc19wYXJhbXMoKQogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ2lzX2Fkcl9kb2MnXSA9IFRydWUKICAgICAgICBiYXJjb2RlX3Byb2Nlc3NfcGFyYW1zWydpZF9jZWxsJ10gPSBzZWxmLmN1cnJlbnRfY2VsbF9pZAogICAgICAgIGJhcmNvZGVfcHJvY2Vzc19wYXJhbXNbJ3RhYmxlX3R5cGUnXSA9IHNlbGYudGFibGVfdHlwZQoKICAgICAgICBzZWxmLmJhcmNvZGVfd29ya2VyID0gQmFyY29kZUFkcldvcmtlcigKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICAqKmJhcmNvZGVfcHJvY2Vzc19wYXJhbXMsCiAgICAgICAgICAgIHVzZV9zY2FubmluZ19xdWV1ZT1GYWxzZQogICAgICAgICkKCiAgICAgICAgcmVzdWx0ID0gc2VsZi5iYXJjb2RlX3dvcmtlci5wcm9jZXNzX3RoZV9iYXJjb2RlKGJhcmNvZGUpCiAgICAgICAgaWYgcmVzdWx0LmVycm9yOgogICAgICAgICAgICBzZWxmLl9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShyZXN1bHQpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQuZXJyb3IKCiAgICBkZWYgX3VwZGF0ZV9jdXJyZW50X2NlbGwoc2VsZiwgYmFyY29kZSk6CiAgICAgICAgY3VycmVudF9jZWxsID0gc2VsZi5jdXJyZW50X2NlbGxfaWQKICAgICAgICBkb2NfY2VsbCA9IHNlbGYuc2VydmljZS5maW5kX2NlbGwoYmFyY29kZSkKCiAgICAgICAgaWYgZG9jX2NlbGwgYW5kIGN1cnJlbnRfY2VsbCAhPSBkb2NfY2VsbDoKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbChkb2NfY2VsbFsnbmFtZSddLCBkb2NfY2VsbFsnaWQnXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgaWYgbm90IHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnBsYXlzb3VuZCgnd2FybmluZycpCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCd0b2FzdCcsICfQndC1INC90LDQudC00LXQvdCwINGP0YfQtdC50LrQsCcpCiAgICAgICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIF9wcm9jZXNzX2Vycm9yX3NjYW5fYmFyY29kZShzZWxmLCBzY2FuX3Jlc3VsdCk6CiAgICAgICAgaWYgc2Nhbl9yZXN1bHQuZXJyb3IgPT0gJ3VzZV9zZXJpZXMnOgogICAgICAgICAgICBzZWxmLl9vcGVuX3Nlcmllc19zY3JlZW4oc2Nhbl9yZXN1bHQucm93X2tleSkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5wbGF5c291bmQoJ3dhcm5pbmcnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAudG9hc3Qoc2Nhbl9yZXN1bHQuZGVzY3JpcHRpb24pCiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXAucGxheXNvdW5kKCdlcnJvcicpCgogICAgZGVmIF9kb2NfbWFya192ZXJpZmllZChzZWxmKToKICAgICAgICBzZWxmLnNlcnZpY2UubWFya192ZXJpZmllZCgpCiAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIEFkckRvY3NMaXN0U2NyZWVuKHNlbGYuaGFzaF9tYXApLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGwoc2VsZik6CiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNlYXJjaFN0cmluZyIsICIiKQogICAgICAgIHNlbGYuX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKCkKCiAgICBkZWYgX29wZW5fc2VsZWN0X2NlbGxfc2NyZWVuKHNlbGYpOgogICAgICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZWxlY3RJdGVtU2NyZWVuKAogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLAogICAgICAgICAgICB0YWJsZV9uYW1lPSdSU19jZWxscycsCiAgICAgICAgICAgIHJlc3VsdF9saXN0ZW5lcj0nY2VsbF9zZWxlY3Rfc3VjY2VzcycKICAgICAgICApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3coKQoKICAgIGRlZiBfc2VsZWN0X2NlbGxfcmVzdWx0KHNlbGYpOgogICAgICAgIHNlbGVjdGVkX2NlbGwgPSBzZWxmLmhhc2hfbWFwLmdldF9qc29uKCdzZWxlY3RlZF9jYXJkJykKICAgICAgICBpZiBzZWxlY3RlZF9jZWxsOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKHNlbGVjdGVkX2NlbGwuZ2V0KCduYW1lJyksIHNlbGVjdGVkX2NlbGwuZ2V0KCdpZCcpKQogICAgICAgICAgICBzZWxmLmhhc2hfbWFwLnJlbW92ZSgnc2VsZWN0ZWRfY2FyZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5fc2V0X2N1cnJlbnRfY2VsbCgpCgogICAgZGVmIF9jbGVhcl9jZWxsKHNlbGYpOgogICAgICAgIHNlbGYuX3NldF9jdXJyZW50X2NlbGwoKQogICAgICAgIHNlbGYuaGFzaF9tYXAucmVmcmVzaF9zY3JlZW4oKQoKICAgIGRlZiBfdGFibGVfdHlwZV9zZWxlY3RlZChzZWxmKToKICAgICAgICBzZWxmLnRhYmxlX3R5cGUgPSBzZWxmLl9nZXRfdGFibGVfdHlwZV9mcm9tX25hbWUoc2VsZi5oYXNoX21hcFsndGFibGVfdHlwZSddKQogICAgICAgIHNlbGYuc2VydmljZS50YWJsZV90eXBlID0gc2VsZi50YWJsZV90eXBlCiAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCgogICAgZGVmIF9iYWNrX3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dCgiU2VhcmNoU3RyaW5nIiwgIiIpCgogICAgICAgIGlmIHNlbGYuY3VycmVudF9jZWxsX2lkOgogICAgICAgICAgICBzZWxmLl9zZXRfY3VycmVudF9jZWxsKCkKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZWZyZXNoX3NjcmVlbigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5oYXNoX21hcC5yZW1vdmUoJ3JldHVybl9zZWxlY3RlZF9kYXRhJykKICAgICAgICAgICAgQWRyRG9jc0xpc3RTY3JlZW4oc2VsZi5oYXNoX21hcCkuc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19rZXkpOgogICAgICAgIHNlbGYuaGFzaF9tYXBbJ3VzZV9hZHJfZG9jc190YWJsZXMnXSA9IFRydWUKICAgICAgICBzY3JlZW5fdmFsdWVzID0gewogICAgICAgICAgICAnZG9jX3Jvd19pZCc6IGRvY19yb3dfa2V5LAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgfQoKICAgICAgICBzY3JlZW4gPSB1aV9tb2RlbHMuU2VyaWVzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXApCiAgICAgICAgc2NyZWVuLnBhcmVudF9zY3JlZW4gPSBzZWxmCiAgICAgICAgc2NyZWVuLnNob3dfcHJvY2Vzc19yZXN1bHQoc2NyZWVuX3ZhbHVlcykKCiAgICBkZWYgX29wZW5fc2VsZWN0X2dvb2RzX3NjcmVlbihzZWxmLCBkYXRhKToKICAgICAgICBkb2Nfcm93X2lkID0gc2VsZi5oYXNoX21hcFsnc2VsZWN0ZWRfY2FyZF9rZXknXQogICAgICAgIHNjcmVlbiA9IEFkckdvb2RzU2VsZWN0U2NyZWVuKHNlbGYuaGFzaF9tYXAsIGRvY19yb3dfaWQ9ZG9jX3Jvd19pZCkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9nZXRfZG9jX2RldGFpbHNfZGF0YShzZWxmLCBsYXN0X3NjYW5uZWQ9RmFsc2UpOgogICAgICAgIHN1cGVyKCkuX2NoZWNrX3ByZXZpb3VzX3BhZ2UoKQogICAgICAgIGZpcnN0X2VsZW1lbnQgPSBpbnQoc2VsZi5oYXNoX21hcC5nZXQoJ2N1cnJlbnRfZmlyc3RfZWxlbWVudF9udW1iZXInKSkKICAgICAgICByb3dfZmlsdGVycyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdyb3dzX2ZpbHRlcicpCiAgICAgICAgc2VhcmNoX3N0cmluZyA9IHNlbGYuaGFzaF9tYXAuZ2V0KCdTZWFyY2hTdHJpbmcnKSBpZiBzZWxmLmhhc2hfbWFwLmdldCgnU2VhcmNoU3RyaW5nJykgZWxzZSBOb25lCgogICAgICAgIGRhdGEgPSBzZWxmLnNlcnZpY2UuZ2V0X2RvY19kZXRhaWxzX2RhdGEoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgY2VsbD1zZWxmLmN1cnJlbnRfY2VsbF9pZCwKICAgICAgICAgICAgZmlyc3RfZWxlbT0wIGlmIGxhc3Rfc2Nhbm5lZCBlbHNlIGZpcnN0X2VsZW1lbnQsCiAgICAgICAgICAgIGl0ZW1zX29uX3BhZ2U9MSBpZiBsYXN0X3NjYW5uZWQgZWxzZSBzZWxmLml0ZW1zX29uX3BhZ2UsCiAgICAgICAgICAgIHJvd19maWx0ZXJzPXJvd19maWx0ZXJzLAogICAgICAgICAgICBzZWFyY2hfc3RyaW5nPXNlYXJjaF9zdHJpbmcKICAgICAgICApCiAgICAgICAgc2VsZi5kb2Nfcm93cyA9IHNlbGYuc2VydmljZS5nZXRfZG9jX2RldGFpbHNfcm93c19jb3VudCgKICAgICAgICAgICAgaWRfZG9jPXNlbGYuaWRfZG9jLAogICAgICAgICAgICByb3dfZmlsdGVycz1yb3dfZmlsdGVycywKICAgICAgICAgICAgc2VhcmNoX3N0cmluZz1zZWFyY2hfc3RyaW5nCiAgICAgICAgKQoKICAgICAgICBpZiBub3QgbGFzdF9zY2FubmVkOgogICAgICAgICAgICBzdXBlcigpLl9jaGVja19uZXh0X3BhZ2UobGVuKGRhdGEpKQoKICAgICAgICByZXR1cm4gZGF0YQoKICAgIEBzdGF0aWNtZXRob2QKICAgIGRlZiBfZ2V0X3RhYmxlX3R5cGVfZnJvbV9uYW1lKF92YWwpOgogICAgICAgIHJldHVybiAnaW4nIGlmIF92YWwgPT0gJ9Cg0LDQt9C80LXRidC10L3QuNC1JyBlbHNlICdvdXQnCgogICAgZGVmIF9wcmVwYXJlX3RhYmxlX2RhdGEoc2VsZiwgZG9jX2RldGFpbHMpOgogICAgICAgICMgVE9ETyDQtNC+0LHQsNCy0LjRgtGMINCz0YDRg9C/0L/QuNGA0L7QstC60YMg0L/QviDRj9GH0LXQudC60LDQvAogICAgICAgIHRhYmxlX2RhdGEgPSBbe31dCiAgICAgICAgcm93X2ZpbHRlciA9IHNlbGYuaGFzaF9tYXAuZ2V0X2Jvb2woJ3Jvd3NfZmlsdGVyJykKCiAgICAgICAgZm9yIHJlY29yZCBpbiBkb2NfZGV0YWlsczoKICAgICAgICAgICAgaWYgcm93X2ZpbHRlciBhbmQgcmVjb3JkWydxdHR5J10gPT0gcmVjb3JkWydxdHR5X3BsYW4nXToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwaWMgPSAnI2YwMmEnIGlmIHJlY29yZFsnSXNEb25lJ10gIT0gMCBlbHNlICcjZjAwYycKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gPT0gMCBhbmQgcmVjb3JkWydxdHR5X3BsYW4nXSA9PSAwOgogICAgICAgICAgICAgICAgcGljID0gJycKCiAgICAgICAgICAgIHByb2R1Y3Rfcm93ID0gewogICAgICAgICAgICAgICAgJ2tleSc6IHN0cihyZWNvcmRbJ2lkJ10pLAogICAgICAgICAgICAgICAgJ2NlbGwnOiBzdHIocmVjb3JkWydjZWxsX25hbWUnXSksCiAgICAgICAgICAgICAgICAnaWRfY2VsbCc6IHN0cihyZWNvcmRbJ2lkX2NlbGwnXSksCiAgICAgICAgICAgICAgICAnZ29vZF9uYW1lJzogc3RyKHJlY29yZFsnZ29vZF9uYW1lJ10pLAogICAgICAgICAgICAgICAgJ2lkX2dvb2QnOiBzdHIocmVjb3JkWydpZF9nb29kJ10pLAogICAgICAgICAgICAgICAgJ2lkX3Byb3BlcnR5Jzogc3RyKHJlY29yZFsnaWRfcHJvcGVydGllcyddKSwKICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzX25hbWUnOiBzdHIocmVjb3JkWydwcm9wZXJ0aWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfc2VyaWVzJzogc3RyKHJlY29yZFsnaWRfc2VyaWVzJ10pLAogICAgICAgICAgICAgICAgJ3Nlcmllc19uYW1lJzogc3RyKHJlY29yZFsnc2VyaWVzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnaWRfdW5pdCc6IHN0cihyZWNvcmRbJ2lkX3VuaXQnXSksCiAgICAgICAgICAgICAgICAndW5pdHNfbmFtZSc6IHN0cihyZWNvcmRbJ3VuaXRzX25hbWUnXSBvciAnJyksCiAgICAgICAgICAgICAgICAnY29kZV9hcnQnOiAn0JrQvtC0OiAnICsgc3RyKHJlY29yZFsnY29kZSddKSwKICAgICAgICAgICAgICAgICdhcnQnOiBzdHIocmVjb3JkWydhcnQnXSksCiAgICAgICAgICAgICAgICAncGljdHVyZSc6IHBpYywKICAgICAgICAgICAgICAgICd1c2Vfc2VyaWVzJzogc3RyKHJlY29yZFsndXNlX3NlcmllcyddKQogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm9wcyA9IFsKICAgICAgICAgICAgICAgICd7fSAnLmZvcm1hdChwcm9kdWN0X3Jvd1snYXJ0J10pIGlmIHByb2R1Y3Rfcm93WydhcnQnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJyh7fSkgJy5mb3JtYXQocHJvZHVjdF9yb3dbJ3Byb3BlcnRpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sncHJvcGVydGllc19uYW1lJ10gZWxzZSAnJywKICAgICAgICAgICAgICAgICd7fScuZm9ybWF0KHByb2R1Y3Rfcm93WydzZXJpZXNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1snc2VyaWVzX25hbWUnXSBlbHNlICcnLAogICAgICAgICAgICAgICAgJywge30nLmZvcm1hdChwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddKSBpZiBwcm9kdWN0X3Jvd1sndW5pdHNfbmFtZSddIGVsc2UgJycsCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ2dvb2RfaW5mbyddID0gJycuam9pbihwcm9wcykKICAgICAgICAgICAgaWYgcmVjb3JkWydxdHR5J10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gc3RyKGludChyZWNvcmRbJ3F0dHknXSkgaWYgcmVjb3JkWydxdHR5J10uaXNfaW50ZWdlcigpIGVsc2UgcmVjb3JkWydxdHR5J10pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eSddID0gIjAiCiAgICAgICAgICAgIGlmIHJlY29yZFsncXR0eV9wbGFuJ10gaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10gPSBzdHIoaW50KHJlY29yZFsncXR0eV9wbGFuJ10pIGlmIHJlY29yZFsncXR0eV9wbGFuJ10uaXNfaW50ZWdlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSByZWNvcmRbJ3F0dHlfcGxhbiddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJvZHVjdF9yb3dbJ3F0dHlfcGxhbiddID0gIjAiCgogICAgICAgICAgICBwcm9kdWN0X3Jvd1snX2xheW91dCddID0gc2VsZi5fZ2V0X2RvY190YWJsZV9yb3dfdmlldygpCiAgICAgICAgICAgIHNlbGYuX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihwcm9kdWN0X3JvdykKCiAgICAgICAgICAgIGlmIHNlbGYuX2FkZGVkX2dvb2RzX2hhc19rZXkocHJvZHVjdF9yb3dbJ2tleSddKToKICAgICAgICAgICAgICAgIHRhYmxlX2RhdGEuaW5zZXJ0KDEsIHByb2R1Y3Rfcm93KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFibGVfZGF0YS5hcHBlbmQocHJvZHVjdF9yb3cpCgogICAgICAgIHJldHVybiB0YWJsZV9kYXRhCgogICAgZGVmIF9nZXRfZG9jX3RhYmxlX3ZpZXcoc2VsZiwgdGFibGVfZGF0YSk6CiAgICAgICAgdGFibGVfdmlldyA9IHdpZGdldHMuQ3VzdG9tVGFibGUoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0K/Rh9C10LnQutCwJyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTEKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQndCw0LfQstCw0L3QuNC1JyksCiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0PTIKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICBzZWxmLkxpbmVhckxheW91dCgKICAgICAgICAgICAgICAgICAgICBzZWxmLlRleHRWaWV3KCfQn9C70LDQvScpLAogICAgICAgICAgICAgICAgICAgIHdlaWdodD0xCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgc2VsZi5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5UZXh0Vmlldygn0KTQsNC60YInKSwKICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPSdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgIGhlaWdodD0ibWF0Y2hfcGFyZW50IiwKICAgICAgICAgICAgICAgIHdpZHRoPSJtYXRjaF9wYXJlbnQiLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yPScjRkZGRkZGJwogICAgICAgICAgICApLAoKICAgICAgICAgICAgb3B0aW9ucz13aWRnZXRzLk9wdGlvbnMob3ZlcnJpZGVfc2VhcmNoPVRydWUpLm9wdGlvbnMsCiAgICAgICAgICAgIHRhYmxlZGF0YT10YWJsZV9kYXRhCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gdGFibGVfdmlldwoKICAgIGRlZiBfZ2V0X2RvY190YWJsZV9yb3dfdmlldyhzZWxmLCB1c2Vfc2VyaWVzPUZhbHNlLCB1c2VfbWFyaz1GYWxzZSk6CgogICAgICAgIHJvd192aWV3ID0gd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQGNlbGwnLAogICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgaGVpZ2h0PSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTEsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuVGV4dFZpZXcoJ0Bnb29kX25hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAZ29vZF9pbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRleHRTaXplPTE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICAgICAgd2VpZ2h0PTIsCiAgICAgICAgICAgICAgICBTdHJva2VXaWR0aD0xCiAgICAgICAgICAgICksCiAgICAgICAgICAgIHdpZGdldHMuTGluZWFyTGF5b3V0KAogICAgICAgICAgICAgICAgd2lkZ2V0cy5UZXh0VmlldygKICAgICAgICAgICAgICAgICAgICBWYWx1ZT0nQHF0dHlfcGxhbicsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICBoZWlnaHQ9J21hdGNoX3BhcmVudCcsCiAgICAgICAgICAgICAgICB3ZWlnaHQ9MSwKICAgICAgICAgICAgICAgIFN0cm9rZVdpZHRoPTEKICAgICAgICAgICAgKSwKICAgICAgICAgICAgd2lkZ2V0cy5MaW5lYXJMYXlvdXQoCiAgICAgICAgICAgICAgICB3aWRnZXRzLlRleHRWaWV3KAogICAgICAgICAgICAgICAgICAgIFZhbHVlPSdAcXR0eScsCiAgICAgICAgICAgICAgICAgICAgVGV4dFNpemU9MTUsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg9J21hdGNoX3BhcmVudCcKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICB3aWR0aD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIGhlaWdodD0nbWF0Y2hfcGFyZW50JywKICAgICAgICAgICAgICAgIHdlaWdodD0xLAogICAgICAgICAgICAgICAgU3Ryb2tlV2lkdGg9MQogICAgICAgICAgICApLAogICAgICAgICAgICBvcmllbnRhdGlvbj0naG9yaXpvbnRhbCcsCiAgICAgICAgICAgIHdpZHRoPSdtYXRjaF9wYXJlbnQnLAogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3I9JyNGRkZGRkYnCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gcm93X3ZpZXcKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5X29uX3N0YXJ0KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX3NldF9iYWNrZ3JvdW5kX3Jvd19jb2xvcihzZWxmLCBwcm9kdWN0X3Jvdyk6CiAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICcjRkZGRkZGJwogICAgICAgIHF0dHksIHF0dHlfcGxhbiA9IGZsb2F0KHByb2R1Y3Rfcm93WydxdHR5J10pLCBmbG9hdChwcm9kdWN0X3Jvd1sncXR0eV9wbGFuJ10pCiAgICAgICAgaWYgcXR0eV9wbGFuID4gcXR0eToKICAgICAgICAgICAgYmFja2dyb3VuZF9jb2xvciA9ICIjRkJFOUU3IgoKICAgICAgICBlbGlmIHF0dHlfcGxhbiA8IHF0dHk6CiAgICAgICAgICAgIGJhY2tncm91bmRfY29sb3IgPSAiI0ZGRjlDNCIKCiAgICAgICAgc2V0YXR0cihwcm9kdWN0X3Jvd1snX2xheW91dCddLCAnQmFja2dyb3VuZENvbG9yJywgYmFja2dyb3VuZF9jb2xvcikKCiAgICBkZWYgX3NldF9jdXJyZW50X2NlbGwoc2VsZiwgY3VycmVudF9jZWxsPSctINC90LUg0LLRi9Cx0YDQsNC90L4gLScsIGN1cnJlbnRfY2VsbF9pZD0nJyk6CiAgICAgICAgc2VsZi5jdXJyZW50X2NlbGwsIHNlbGYuY3VycmVudF9jZWxsX2lkID0gY3VycmVudF9jZWxsLCBjdXJyZW50X2NlbGxfaWQKICAgICAgICBzZWxmLmhhc2hfbWFwWydjdXJyZW50X2NlbGwnXSA9IGN1cnJlbnRfY2VsbAogICAgICAgIGlmIGN1cnJlbnRfY2VsbF9pZDoKICAgICAgICAgICAgc2VsZi5oYXNoX21hcFsnU2hvd19idG5fY2xlYXJfY2VsbCddID0gMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuaGFzaF9tYXBbJ1Nob3dfYnRuX2NsZWFyX2NlbGwnXSA9IC0xCgoKY2xhc3MgQWRyR29vZHNTZWxlY3RTY3JlZW4odWlfbW9kZWxzLkJhc2VHb29kU2VsZWN0KToKICAgIHNjcmVlbl9uYW1lID0gJ9Ci0L7QstCw0YAg0LLRi9Cx0L7RgCcKICAgIHByb2Nlc3NfbmFtZSA9ICfQkNC00YDQtdGB0L3QvtC1INGF0YDQsNC90LXQvdC40LUnCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGhhc2hfbWFwOiBIYXNoTWFwLCBkb2Nfcm93X2lkLCByc19zZXR0aW5ncz1Ob25lKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKGhhc2hfbWFwKQogICAgICAgIHNlbGYuc2VydmljZSA9IGRiX3NlcnZpY2VzLkFkckRvY1NlcnZpY2UoKQogICAgICAgIHNlbGYuZG9jX3Jvd19pZCA9IGRvY19yb3dfaWQKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0ge30KICAgICAgICBzZWxmLmhhc2hfbWFwX2tleXMgPSBbJ2l0ZW1fbmFtZScsICdhcnRpY2xlJywgJ3Byb3BlcnR5JywgJ3VuaXQnLCAncXR0eV9wbGFuJywgJ3F0dHknXQoKICAgIGRlZiBpbml0X3NjcmVlbihzZWxmKToKICAgICAgICBzZWxmLnNjcmVlbl9kYXRhID0gc2VsZi5zZXJ2aWNlLmdldF9kb2Nfcm93X2RhdGEoc2VsZi5kb2Nfcm93X2lkKQoKICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKHsKICAgICAgICAgICAga2V5OiBzZWxmLl9mb3JtYXRfcXVhbnRpdHkoc2VsZi5zY3JlZW5fZGF0YS5nZXQoa2V5LCAwKSkKICAgICAgICAgICAgaWYga2V5IGluIFsncXR0eV9wbGFuJywgJ3F0dHknXSBlbHNlIHNlbGYuc2NyZWVuX2RhdGEuZ2V0KGtleSwgJycpCiAgICAgICAgICAgIGZvciBrZXkgaW4gc2VsZi5oYXNoX21hcF9rZXlzCiAgICAgICAgfSkKICAgICAgICBzZWxmLl9zZXRfdmlzaWJpbGl0eSgpCgogICAgZGVmIG9uX3N0YXJ0KHNlbGYpOgogICAgICAgIHN1cGVyKCkub25fc3RhcnQoKQoKICAgIGRlZiBvbl9pbnB1dChzZWxmKToKICAgICAgICBsaXN0ZW5lcnMgPSB7CiAgICAgICAgICAgICdidG5fc2VyaWVzX3Nob3cnOiBsYW1iZGE6IHNlbGYuX29wZW5fc2VyaWVzX3NjcmVlbigpLAogICAgICAgICAgICAnYnRuX2RvY19nb29kX2JhcmNvZGUnOiBzZWxmLl9vcGVuX2JhcmNvZGVfcmVnaXN0ZXJfc2NyZWVuLAogICAgICAgICAgICAnYnRuX3ByaW50Jzogc2VsZi5fcHJpbnRfdGlja2V0CiAgICAgICAgfQoKICAgICAgICBpZiBzZWxmLmxpc3RlbmVyIGluIGxpc3RlbmVyczoKICAgICAgICAgICAgbGlzdGVuZXJzW3NlbGYubGlzdGVuZXJdKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzdXBlcigpLm9uX2lucHV0KCkKCiAgICBkZWYgX3NldF92aXNpYmlsaXR5KHNlbGYpOgogICAgICAgIGFsbG93X2ZhY3RfaW5wdXQgPSBzZWxmLnJzX3NldHRpbmdzLmdldCgnYWxsb3dfZmFjdF9pbnB1dCcpIG9yIEZhbHNlCiAgICAgICAgc2VsZi5oYXNoX21hcC5wdXQoIlNob3dfZmFjdF9xdHR5X2lucHV0IiwgJzEnIGlmIGFsbG93X2ZhY3RfaW5wdXQgZWxzZSAnLTEnKQogICAgICAgIHNlbGYuaGFzaF9tYXAucHV0KCJTaG93X2ZhY3RfcXR0eV9ub3RlIiwgJy0xJyBpZiBhbGxvd19mYWN0X2lucHV0IGVsc2UgJzEnKQoKICAgIGRlZiBfYmFja19zY3JlZW4oc2VsZik6CiAgICAgICAgc2NyZWVuID0gQWRyRG9jRGV0YWlsc1NjcmVlbihzZWxmLmhhc2hfbWFwLCBzZWxmLnNjcmVlbl9kYXRhWydpZF9kb2MnXSkKICAgICAgICBzY3JlZW4uc2hvdygpCgogICAgZGVmIF9vcGVuX3Nlcmllc19zY3JlZW4oc2VsZiwgZG9jX3Jvd19pZD0nJyk6CiAgICAgICAgc2VsZi5oYXNoX21hcFsndXNlX2Fkcl9kb2NzX3RhYmxlcyddID0gVHJ1ZQogICAgICAgIHNjcmVlbl92YWx1ZXMgPSB7CiAgICAgICAgICAgICdkb2Nfcm93X2lkJzogc2VsZi5kb2Nfcm93X2lkLAogICAgICAgICAgICAndGl0bGUnOiAn0KHQtdGA0LjQuCcsCiAgICAgICAgfQogICAgICAgIHNjcmVlbiA9IHVpX21vZGVscy5TZXJpZXNTZWxlY3RTY3JlZW4oc2VsZi5oYXNoX21hcCkKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdChzY3JlZW5fdmFsdWVzKQoKICAgIGRlZiBfb3Blbl9iYXJjb2RlX3JlZ2lzdGVyX3NjcmVlbihzZWxmKToKICAgICAgICBpbml0X2RhdGEgPSB7CiAgICAgICAgICAgICdpdGVtX2lkJzogc2VsZi5zY3JlZW5fZGF0YVsnaXRlbV9pZCddLAogICAgICAgICAgICAncHJvcGVydHlfaWQnOiBzZWxmLnNjcmVlbl9kYXRhWydwcm9wZXJ0eV9pZCddLAogICAgICAgICAgICAndW5pdF9pZCc6IHNlbGYuc2NyZWVuX2RhdGFbJ3VuaXRfaWQnXQogICAgICAgIH0KICAgICAgICBzZWxmLmhhc2hfbWFwLnB1dF9kYXRhKGluaXRfZGF0YSkKCiAgICAgICAgc2NyZWVuID0gdWlfbW9kZWxzLkJhcmNvZGVSZWdpc3RyYXRpb25TY3JlZW4oc2VsZi5oYXNoX21hcCwgc2VsZi5yc19zZXR0aW5ncykKICAgICAgICBzY3JlZW4ucGFyZW50X3NjcmVlbiA9IHNlbGYKICAgICAgICBzY3JlZW4uc2hvd19wcm9jZXNzX3Jlc3VsdCgpCgogICAgZGVmIF9wcmludF90aWNrZXQoc2VsZik6CiAgICAgICAgYmFyY29kZSA9IGRiX3NlcnZpY2VzLkJhcmNvZGVTZXJ2aWNlKCkuZ2V0X2JhcmNvZGVfZnJvbV9kb2NfdGFibGUoc2VsZi5oYXNoX21hcC5nZXQoJ2tleScpKQoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAn0J3QvtC80LXQvdC60LvQsNGC0YPRgNCwJzogJ2l0ZW1fbmFtZScsCiAgICAgICAgICAgICfQkNGA0YLQuNC60YPQuyc6ICdhcnRpY2xlJywKICAgICAgICAgICAgJ9Cl0LDRgNCw0LrRgtC10YDQuNGB0YLQuNC60LAnOiAncHJvcGVydHknLAogICAgICAgICAgICAn0JXQtNCY0LfQvCc6ICd1bml0JywKICAgICAgICB9CgogICAgICAgIGZvciBrZXkgaW4gZGF0YToKICAgICAgICAgICAgZGF0YVtrZXldID0gc2VsZi5oYXNoX21hcC5nZXQoZGF0YVtrZXldKQoKICAgICAgICBkYXRhWydiYXJjb2RlJ10gPSBiYXJjb2RlIGlmIGJhcmNvZGUgZWxzZSAnMDAwMDAwMDAwMDAwMCcKICAgICAgICBQcmludFNlcnZpY2UucHJpbnQoc2VsZi5oYXNoX21hcCwgZGF0YSkKCiAgICBkZWYgX3VwZGF0ZV9kb2NfdGFibGVfcm93KHNlbGYsIGRhdGE6IERpY3QsIHJvd19pZD0nJyk6CiAgICAgICAgaWYgbm90IHNlbGYuaGFzaF9tYXAuZ2V0KCdkZWx0YScpOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICdzZW50JzogMCwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChkYXRhWydxdHR5J10pLAogICAgICAgIH0KCiAgICAgICAgc2VsZi5zZXJ2aWNlLnVwZGF0ZV9kb2NfdGFibGVfcm93KGRhdGE9dXBkYXRlX2RhdGEsIHJvd19pZD1zZWxmLmRvY19yb3dfaWQpCiAgICAgICAgc2VsZi5zZXJ2aWNlLnNldF9kb2Nfc3RhdHVzX3RvX3VwbG9hZChzZWxmLnNjcmVlbl9kYXRhWydpZF9kb2MnXSkKCiAgICBkZWYgX2hhbmRsZV9mb3VuZF9iYXJjb2RlKHNlbGYsIHJlcywgaWRfZ29vZCwgaWRfcHJvcGVydHksIGlkX3VuaXQpOgogICAgICAgIGlzX2N1cnJlbnRfcG9zaXRpb24gPSBhbGwoKAogICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWydpdGVtX2lkJ10gPT0gcmVzWydpZF9nb29kJ10sCiAgICAgICAgICAgIHNlbGYuc2NyZWVuX2RhdGFbJ3Byb3BlcnR5X2lkJ10gPT0gcmVzWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICBzZWxmLnNjcmVlbl9kYXRhWyd1bml0X2lkJ10gPT0gcmVzWydpZF91bml0J10KICAgICAgICApKQoKICAgICAgICBpZiBpc19jdXJyZW50X3Bvc2l0aW9uOgogICAgICAgICAgICBpZiBzZWxmLnNjcmVlbl9kYXRhWyd1c2Vfc2VyaWVzJ10gPT0gIjEiOgogICAgICAgICAgICAgICAgc2VsZi5fb3Blbl9zZXJpZXNfc2NyZWVuKHNlbGYuaGFzaF9tYXBbJ2tleSddKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X2RlbHRhKHJlc1sncmF0aW8nXSkKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICAgICAgc2VsZi5jdXJyZW50X3RvYXN0X21lc3NhZ2UgPSAn0KjRgtGA0LjRhdC60L7QtCDQvdC1INGB0L7QvtGC0LLQtdGC0YHRgtCy0YPQtdGCINGC0LXQutGD0YnQtdC5INC/0L7Qt9C40YbQuNC4JwoKICAgICAgICByZXR1cm4gRmFsc2U="
            },
            {
                "file_path": "C:/Users/Gekk0/PycharmProjects/simple_keep\\barcode_workers.py",
                "PyFileKey": "barcode_workers",
                "PyFileData": "ZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCgpmcm9tIGRiX3NlcnZpY2VzIGltcG9ydCBCYXJjb2RlU2VydmljZQpmcm9tIHVpX3V0aWxzIGltcG9ydCBCYXJjb2RlUGFyc2VyCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lZGVsdGEKZnJvbSBqYXZhIGltcG9ydCBqY2xhc3MKCm5vQ2xhc3MgPSBqY2xhc3MoInJ1LnRyYXZlbGZvb2Quc2ltcGxlX3VpLk5vU1FMIikKcnNfc2V0dGluZ3MgPSBub0NsYXNzKCJyc19zZXR0aW5ncyIpCgoKY2xhc3MgQmFyY29kZVdvcmtlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZF9kb2MsICoqa3dhcmdzKToKICAgICAgICBzZWxmLmlkX2RvYyA9IGlkX2RvYwogICAgICAgIHNlbGYuY29udHJvbCA9IGt3YXJncy5nZXQoJ2NvbnRyb2wnLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfbWFya19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9tYXJrX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfcXR0eV9wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV9xdHR5X3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLmhhdmVfemVyb19wbGFuID0ga3dhcmdzLmdldCgnaGF2ZV96ZXJvX3BsYW4nLCBGYWxzZSkKICAgICAgICBzZWxmLnVzZV9zY2FubmluZ19xdWV1ZSA9IGt3YXJncy5nZXQoJ3VzZV9zY2FubmluZ19xdWV1ZScsIEZhbHNlKQogICAgICAgIHNlbGYuYmFyY29kZV9pbmZvID0gTm9uZQogICAgICAgIHNlbGYuZG9jdW1lbnRfcm93ID0gTm9uZQogICAgICAgIHNlbGYuZGJfc2VydmljZSA9IEJhcmNvZGVTZXJ2aWNlKCkKICAgICAgICBzZWxmLnByb2Nlc3NfcmVzdWx0ID0gc2VsZi5Qcm9jZXNzVGhlQmFyY29kZVJlc3VsdCgpCiAgICAgICAgc2VsZi51c2VyX3RteiA9IDAKICAgICAgICBzZWxmLmJhcmNvZGVfZGF0YSA9IHt9CiAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhID0ge30KICAgICAgICBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGEgPSB7fQogICAgICAgIHNlbGYucXVldWVfdXBkYXRlX2RhdGEgPSB7fQogICAgICAgIHNlbGYuZ3JvdXBfc2NhbiA9IGt3YXJncy5nZXQoJ2dyb3VwX3NjYW4nLCBGYWxzZSkKCiAgICBkZWYgcHJvY2Vzc190aGVfYmFyY29kZShzZWxmLCBiYXJjb2RlKToKICAgICAgICBzZWxmLnByb2Nlc3NfcmVzdWx0LmJhcmNvZGUgPSBiYXJjb2RlCiAgICAgICAgc2VsZi5iYXJjb2RlX2luZm8gPSBCYXJjb2RlUGFyc2VyKGJhcmNvZGUpLnBhcnNlKGFzX2RpY3Q9RmFsc2UpCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9pbmZvLmVycm9yOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnaW52YWxpZF9iYXJjb2RlJykKICAgICAgICAgICAgcmV0dXJuIHNlbGYucHJvY2Vzc19yZXN1bHQKCiAgICAgICAgc2VsZi5iYXJjb2RlX2RhdGEgPSBzZWxmLl9nZXRfYmFyY29kZV9kYXRhKCkKCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuX2NoZWNrX3VzZV9zZXJpZXMoKQogICAgICAgICAgICBzZWxmLmNoZWNrX2JhcmNvZGUoKQogICAgICAgICAgICBzZWxmLnVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3NldF9wcm9jZXNzX3Jlc3VsdF9pbmZvKCdub3RfZm91bmQnKQoKICAgICAgICByZXR1cm4gc2VsZi5wcm9jZXNzX3Jlc3VsdAoKICAgIGRlZiBfY2hlY2tfdXNlX3NlcmllcyhzZWxmKToKICAgICAgICBpZiBpbnQoc2VsZi5iYXJjb2RlX2RhdGEuZ2V0KCd1c2Vfc2VyaWVzJywgMCkpOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygndXNlX3NlcmllcycpCgogICAgZGVmIF9nZXRfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIGJhcmNvZGVfZGF0YSA9IHNlbGYuZGJfc2VydmljZS5nZXRfYmFyY29kZV9kYXRhKAogICAgICAgICAgICBpZF9kb2M9c2VsZi5pZF9kb2MsCiAgICAgICAgICAgIGJhcmNvZGVfaW5mbz1zZWxmLmJhcmNvZGVfaW5mbwogICAgICAgICkKICAgICAgICByZXR1cm4gYmFyY29kZV9kYXRhIG9yIHt9CgogICAgZGVmIGNoZWNrX2JhcmNvZGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgc2VsZi5fdXNlX21hcmsoKToKICAgICAgICAgICAgc2VsZi5fY2hlY2tfbWFya19pbl9kb2N1bWVudCgpCiAgICAgICAgc2VsZi5fY2hlY2tfYmFyY29kZV9pbl9kb2N1bWVudCgpCgogICAgZGVmIF9jaGVja19tYXJrX2luX2RvY3VtZW50KHNlbGYpOgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9pbmZvLnNjaGVtZSA9PSAnR1MxJzoKICAgICAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXToKICAgICAgICAgICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydhcHByb3ZlZCddID09ICcxJzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbWFya19hbHJlYWR5X3NjYW5uZWQnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnNlcnRfbWFya19kYXRhKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGlmIHNlbGYuaGF2ZV9tYXJrX3BsYW4gYW5kIHNlbGYuY29udHJvbDoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbWFya19ub3RfZm91bmQnKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9pbnNlcnRfbWFya19kYXRhKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnbm90X3ZhbGlkX2JhcmNvZGUnKQoKICAgIGRlZiBfY2hlY2tfYmFyY29kZV9pbl9kb2N1bWVudChzZWxmKToKICAgICAgICBpZiBzZWxmLnByb2Nlc3NfcmVzdWx0LmVycm9yOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgbmV3X2RldmljZV9xdHR5ID0gc2VsZi5iYXJjb2RlX2RhdGFbJ2RfcXR0eSddICsgc2VsZi5iYXJjb2RlX2RhdGFbJ3JhdGlvJ10KICAgICAgICBuZXdfb3ZlcmFsbF9xdHR5ID0gc2VsZi5iYXJjb2RlX2RhdGFbJ3F0dHknXSArIHNlbGYuYmFyY29kZV9kYXRhWydyYXRpbyddCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J106CiAgICAgICAgICAgIGlmIHNlbGYuaGF2ZV9xdHR5X3BsYW4gYW5kIHNlbGYuY29udHJvbCBhbmQgc2VsZi5iYXJjb2RlX2RhdGFbJ3F0dHlfcGxhbiddIDwgXAogICAgICAgICAgICAgICAgICAgIG1heChuZXdfZGV2aWNlX3F0dHksIG5ld19vdmVyYWxsX3F0dHkpOgogICAgICAgICAgICAgICAgc2VsZi5fc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oJ3F1YW50aXR5X3BsYW5fcmVhY2hlZCcpCgogICAgICAgIGVsaWYgc2VsZi5oYXZlX3plcm9fcGxhbiBhbmQgc2VsZi5jb250cm9sOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnemVyb19wbGFuX2Vycm9yJykKCiAgICAgICAgaWYgbm90IHNlbGYucHJvY2Vzc19yZXN1bHQuZXJyb3I6CiAgICAgICAgICAgIGlmIHNlbGYudXNlX3NjYW5uaW5nX3F1ZXVlOgogICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X3F1ZXVlX2RhdGEoKQogICAgICAgICAgICAgICAgc2VsZi5faW5zZXJ0X2RvY190YWJsZV9kYXRhKG5ld19kZXZpY2VfcXR0eSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX2luc2VydF9kb2NfdGFibGVfZGF0YShuZXdfZGV2aWNlX3F0dHkpCgogICAgZGVmIF9pbnNlcnRfbWFya19kYXRhKHNlbGYpOgogICAgICAgIHNlbGYubWFya191cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0eSc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAnaWRfc2VyaWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAnaWRfdW5pdCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF91bml0J10sCiAgICAgICAgICAgICdiYXJjb2RlX2Zyb21fc2Nhbm5lcic6IHNlbGYuYmFyY29kZV9pbmZvLmJhcmNvZGUsCiAgICAgICAgICAgICdhcHByb3ZlZCc6ICcxJywKICAgICAgICAgICAgJ2d0aW4nOiBzZWxmLmJhcmNvZGVfaW5mby5ndGluLAogICAgICAgICAgICAnc2VyaWVzJzogc2VsZi5iYXJjb2RlX2luZm8uc2VyaWFsLAogICAgICAgICAgICAnbWFya19jb2RlJzogc2VsZi5iYXJjb2RlX2luZm8uYmFyY29kZQogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXToKICAgICAgICAgICAgc2VsZi5tYXJrX3VwZGF0ZV9kYXRhWydpZCddID0gc2VsZi5iYXJjb2RlX2RhdGFbJ21hcmtfaWQnXQoKICAgIGRlZiBfaW5zZXJ0X2RvY190YWJsZV9kYXRhKHNlbGYsIHF0eSk6CgogICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICdpZF91bml0Jzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ3F0dHknOiBzZWxmLmJhcmNvZGVfZGF0YVsncXR0eSddLAogICAgICAgICAgICAnZF9xdHR5JzogZmxvYXQocXR5KSwKICAgICAgICAgICAgJ3F0dHlfcGxhbic6IHNlbGYuYmFyY29kZV9kYXRhWydxdHR5X3BsYW4nXSwKICAgICAgICAgICAgJ2xhc3RfdXBkYXRlZCc6IChkYXRldGltZS5ub3coKSAtIHRpbWVkZWx0YShob3Vycz1zZWxmLnVzZXJfdG16KSkuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIiksCiAgICAgICAgICAgICdpZF9jZWxsJzogJycsCiAgICAgICAgICAgICdwcmljZSc6IHNlbGYuYmFyY29kZV9kYXRhWydwcmljZSddLAogICAgICAgICAgICAnaWRfcHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfcHJpY2UnXQogICAgICAgIH0KCiAgICAgICAgaWYgbm90IHNlbGYuZ3JvdXBfc2NhbjoKICAgICAgICAgICAgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhWydxdHR5J10gPSBmbG9hdChxdHkpCgogICAgICAgIGlmIHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J106CiAgICAgICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YVsnaWQnXSA9IHNlbGYuYmFyY29kZV9kYXRhWydyb3dfa2V5J10KCiAgICBkZWYgX2luc2VydF9xdWV1ZV9kYXRhKHNlbGYpOgogICAgICAgIHNlbGYucXVldWVfdXBkYXRlX2RhdGEgPSB7CiAgICAgICAgICAgICJpZF9kb2MiOiBzZWxmLmlkX2RvYywKICAgICAgICAgICAgImlkX2dvb2QiOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfZ29vZCddLAogICAgICAgICAgICAiaWRfcHJvcGVydGllcyI6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9wcm9wZXJ0eSddLAogICAgICAgICAgICAiaWRfc2VyaWVzIjogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3NlcmllcyddLAogICAgICAgICAgICAiaWRfdW5pdCI6IHNlbGYuYmFyY29kZV9kYXRhWydpZF91bml0J10sCiAgICAgICAgICAgICJpZF9jZWxsIjogJycsCiAgICAgICAgICAgICJkX3F0dHkiOiBzZWxmLmJhcmNvZGVfZGF0YVsncmF0aW8nXSwKICAgICAgICAgICAgJ3Jvd19rZXknOiBzZWxmLmJhcmNvZGVfZGF0YVsncm93X2tleSddLAogICAgICAgICAgICAnc2VudCc6IEZhbHNlLAogICAgICAgICAgICAncHJpY2UnOiBzZWxmLmJhcmNvZGVfZGF0YVsncHJpY2UnXSwKICAgICAgICAgICAgJ2lkX3ByaWNlJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3ByaWNlJ10KICAgICAgICB9CgogICAgZGVmIHVwZGF0ZV9kb2N1bWVudF9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAgICAgaWYgc2VsZi5wcm9jZXNzX3Jlc3VsdC5lcnJvcjoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIHNlbGYubWFya191cGRhdGVfZGF0YToKICAgICAgICAgICAgc2VsZi5kYl9zZXJ2aWNlLnJlcGxhY2Vfb3JfY3JlYXRlX3RhYmxlKHRhYmxlX25hbWU9IlJTX2RvY3NfYmFyY29kZXMiLCBkb2NzX3RhYmxlX3VwZGF0ZV9kYXRhPXNlbGYubWFya191cGRhdGVfZGF0YSkKCiAgICAgICAgaWYgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UucmVwbGFjZV9vcl9jcmVhdGVfdGFibGUodGFibGVfbmFtZT0iUlNfZG9jc190YWJsZSIsIGRvY3NfdGFibGVfdXBkYXRlX2RhdGE9c2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKQoKICAgICAgICBpZiBzZWxmLnF1ZXVlX3VwZGF0ZV9kYXRhOgogICAgICAgICAgICBzZWxmLmRiX3NlcnZpY2UuaW5zZXJ0X25vX3NxbChzZWxmLnF1ZXVlX3VwZGF0ZV9kYXRhKQoKICAgICAgICBpZiBzZWxmLl91c2VfbWFyaygpOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnc3VjY2Vzc19tYXJrJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnc3VjY2Vzc19iYXJjb2RlJykKCiAgICBkZWYgX3VzZV9tYXJrKHNlbGYpOgogICAgICAgIHJldHVybiByc19zZXR0aW5ncy5nZXQoJ3VzZV9tYXJrJykgPT0gJ3RydWUnIGFuZCBzZWxmLmJhcmNvZGVfZGF0YVsndXNlX21hcmsnXQoKICAgIGRlZiBfc2V0X3Byb2Nlc3NfcmVzdWx0X2luZm8oc2VsZiwgaW5mb19rZXkpOgogICAgICAgIHJhdGlvID0gZ2V0YXR0cihzZWxmLmJhcmNvZGVfZGF0YSwgJ3JhdGlvJywgMCkKCiAgICAgICAgaW5mb19kYXRhID0gewogICAgICAgICAgICAnaW52YWxpZF9iYXJjb2RlJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ0ludmFsaWQgYmFyY29kZScsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0J3QtdCy0LXRgNC90YvQuSDRiNGC0YDQuNGF0LrQvtC0JywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ25vdF9mb3VuZCc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdOb3QgZm91bmQnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Co0YLRgNC40YXQutC+0LQg0L3QtSDQvdCw0LnQtNC10L0g0LIg0LHQsNC30LUnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbWFya19ub3RfZm91bmQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnTm90IGZvdW5kJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQnNCw0YDQutCwINC90LUg0L3QsNC50LTQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgtC1JywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ25vdF92YWxpZF9iYXJjb2RlJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJ05vdCB2YWxpZCBiYXJjb2RlJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQotC+0LLQsNGAINC/0L7QtNC70LXQttC40YIg0LzQsNGA0LrQuNGA0L7QstC60LUsINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvSDQvdC10LLQtdGA0L3Ri9C5INGI0YLRgNC40YXQutC+0LQg0LzQsNGA0LrQuNGA0L7QstC60LgnLAogICAgICAgICAgICB9LAogICAgICAgICAgICAnbWFya19hbHJlYWR5X3NjYW5uZWQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnQWxyZWFkeSBzY2FubmVkJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQotCw0LrQsNGPINC80LDRgNC60LAg0YPQttC1INCx0YvQu9CwINC+0YLRgdC60LDQvdC40YDQvtCy0LDQvdCwJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3plcm9fcGxhbl9lcnJvcic6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICdaZXJvIHBsYW4gZXJyb3InLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9CSINC00LDQvdC90YvQuSDQtNC+0LrRg9C80LXQvdGCINC90LXQu9GM0LfRjyDQtNC+0LHQsNCy0LjRgtGMINGC0L7QstCw0YAg0L3QtSDQuNC3INGB0L/QuNGB0LrQsCcsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICdxdWFudGl0eV9wbGFuX3JlYWNoZWQnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAnUXVhbnRpdHkgcGxhbiByZWFjaGVkJywKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICfQmtC+0LvQuNGH0LXRgdGC0LLQviDQv9C70LDQvSDQsdGD0LTQtdGCINC/0YDQtdCy0YvRiNC10L3QviDQv9GA0Lgg0LTQvtCx0LDQstC70LXQvdC40Lgge30g0LXQtNC40L3QuNGGINGC0L7QstCw0YDQsCcuZm9ybWF0KHJhdGlvKSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3N1Y2Nlc3NfYmFyY29kZSc6IHsKICAgICAgICAgICAgICAgICdlcnJvcic6ICcnLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ9Ci0L7QstCw0YAg0LTQvtCx0LDQstC70LXQvSDQsiDQtNC+0LrRg9C80LXQvdGCJwogICAgICAgICAgICB9LAogICAgICAgICAgICAnc3VjY2Vzc19tYXJrJzogewogICAgICAgICAgICAgICAgJ2Vycm9yJzogJycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0JzQsNGA0LrQsCDQtNC+0LHQsNCy0LvQtdC90LAg0LIg0LTQvtC60YPQvNC10L3RgicKICAgICAgICAgICAgfSwKICAgICAgICAgICAgJ3VzZV9zZXJpZXMnOiB7CiAgICAgICAgICAgICAgICAnZXJyb3InOiAndXNlX3NlcmllcycsCiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAn0JTQu9GPINGC0L7QstCw0YDQsCDQvdC10L7QsdGF0L7QtNC40LzQviDQvtGC0YHQutCw0L3QuNGA0L7QstCw0YLRjCDRgdC10YDQuNC4JywKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgaW5mb19kYXRhLmdldChpbmZvX2tleSk6CiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuZXJyb3IgPSBpbmZvX2RhdGFbaW5mb19rZXldWydlcnJvciddCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuZGVzY3JpcHRpb24gPSBpbmZvX2RhdGFbaW5mb19rZXldWydkZXNjcmlwdGlvbiddCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQucm93X2tleSA9IHNlbGYuYmFyY29kZV9kYXRhLmdldCgncm93X2tleScsIDApCiAgICAgICAgICAgIHNlbGYucHJvY2Vzc19yZXN1bHQuYmFyY29kZV9kYXRhID0gc2VsZi5iYXJjb2RlX2RhdGEKCiAgICBkZWYgcGFyc2Uoc2VsZiwgYmFyY29kZTogc3RyKToKICAgICAgICByZXR1cm4gQmFyY29kZVBhcnNlcihiYXJjb2RlKS5wYXJzZSgpCgogICAgQGRhdGFjbGFzcwogICAgY2xhc3MgUHJvY2Vzc1RoZUJhcmNvZGVSZXN1bHQ6CiAgICAgICAgZXJyb3I6IHN0ciA9ICcnCiAgICAgICAgZGVzY3JpcHRpb246IHN0ciA9ICcnCiAgICAgICAgYmFyY29kZTogc3RyID0gJycKICAgICAgICByb3dfa2V5OiBzdHIgPSAnJwogICAgICAgIGJhcmNvZGVfZGF0YSA9IE5vbmUKCgpjbGFzcyBCYXJjb2RlQWRyV29ya2VyKEJhcmNvZGVXb3JrZXIpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGlkX2RvYywgKiprd2FyZ3MpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oaWRfZG9jLCAqKmt3YXJncykKICAgICAgICBzZWxmLmlzX2Fkcl9kb2MgPSBUcnVlCiAgICAgICAgc2VsZi5pZF9jZWxsID0ga3dhcmdzLmdldCgnaWRfY2VsbCcsICcnKQogICAgICAgIHNlbGYudGFibGVfdHlwZSA9IGt3YXJncy5nZXQoJ3RhYmxlX3R5cGUnLCAnJykKCiAgICBkZWYgX2dldF9iYXJjb2RlX2RhdGEoc2VsZik6CiAgICAgICAgYmFyY29kZV9kYXRhID0gc2VsZi5kYl9zZXJ2aWNlLmdldF9iYXJjb2RlX2RhdGEoCiAgICAgICAgICAgIGlkX2RvYz1zZWxmLmlkX2RvYywKICAgICAgICAgICAgYmFyY29kZV9pbmZvPXNlbGYuYmFyY29kZV9pbmZvLAogICAgICAgICAgICBpc19hZHJfZG9jPXNlbGYuaXNfYWRyX2RvYywKICAgICAgICAgICAgaWRfY2VsbD1zZWxmLmlkX2NlbGwsCiAgICAgICAgICAgIHRhYmxlX3R5cGU9c2VsZi50YWJsZV90eXBlCiAgICAgICAgKQoKICAgICAgICByZXR1cm4gYmFyY29kZV9kYXRhIG9yIHt9CgogICAgZGVmIF9jaGVja19tYXJrX2luX2RvY3VtZW50KHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgX2luc2VydF9tYXJrX2RhdGEoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiBfaW5zZXJ0X2RvY190YWJsZV9kYXRhKHNlbGYsIHF0eSk6CgogICAgICAgIHNlbGYuZG9jc190YWJsZV91cGRhdGVfZGF0YSA9IHsKICAgICAgICAgICAgJ2lkX2RvYyc6IHNlbGYuaWRfZG9jLAogICAgICAgICAgICAnaWRfZ29vZCc6IHNlbGYuYmFyY29kZV9kYXRhWydpZF9nb29kJ10sCiAgICAgICAgICAgICdpZF9wcm9wZXJ0aWVzJzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3Byb3BlcnR5J10sCiAgICAgICAgICAgICdpZF9zZXJpZXMnOiBzZWxmLmJhcmNvZGVfZGF0YVsnaWRfc2VyaWVzJ10sCiAgICAgICAgICAgICdpZF91bml0Jzogc2VsZi5iYXJjb2RlX2RhdGFbJ2lkX3VuaXQnXSwKICAgICAgICAgICAgJ3F0dHknOiBmbG9hdChxdHkpLAogICAgICAgICAgICAncXR0eV9wbGFuJzogc2VsZi5iYXJjb2RlX2RhdGFbJ3F0dHlfcGxhbiddLAogICAgICAgICAgICAnbGFzdF91cGRhdGVkJzogKGRhdGV0aW1lLm5vdygpIC0gdGltZWRlbHRhKGhvdXJzPXNlbGYudXNlcl90bXopKS5zdHJmdGltZSgiJVktJW0tJWQgJUg6JU06JVMiKSwKICAgICAgICAgICAgJ2lkX2NlbGwnOiBzZWxmLmlkX2NlbGwsCiAgICAgICAgICAgICd0YWJsZV90eXBlJzogc2VsZi50YWJsZV90eXBlLAogICAgICAgIH0KCiAgICAgICAgaWYgc2VsZi5iYXJjb2RlX2RhdGFbJ3Jvd19rZXknXToKICAgICAgICAgICAgc2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhWydpZCddID0gc2VsZi5iYXJjb2RlX2RhdGFbJ3Jvd19rZXknXQoKICAgIGRlZiBfaW5zZXJ0X3F1ZXVlX2RhdGEoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRlZiB1cGRhdGVfZG9jdW1lbnRfYmFyY29kZV9kYXRhKHNlbGYpOgogICAgICAgIGlmIHNlbGYucHJvY2Vzc19yZXN1bHQuZXJyb3I6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzZWxmLmRvY3NfdGFibGVfdXBkYXRlX2RhdGE6CiAgICAgICAgICAgIHNlbGYuZGJfc2VydmljZS5yZXBsYWNlX29yX2NyZWF0ZV90YWJsZSgKICAgICAgICAgICAgICAgIHRhYmxlX25hbWU9IlJTX2Fkcl9kb2NzX3RhYmxlIiwKICAgICAgICAgICAgICAgIGRvY3NfdGFibGVfdXBkYXRlX2RhdGE9c2VsZi5kb2NzX3RhYmxlX3VwZGF0ZV9kYXRhKQoKICAgICAgICBzZWxmLl9zZXRfcHJvY2Vzc19yZXN1bHRfaW5mbygnc3VjY2Vzc19iYXJjb2RlJykK"
            }
        ],
        "StyleTemplates": [],
        "arch2": true,
        "CommonHandlers": [
            {
                "event": "onLaunch",
                "listener": "",
                "action": "run",
                "type": "pythonreload",
                "method": "app_on_start",
                "postExecute": "",
                "alias": "on_start"
            },
            {
                "event": "onWebServiceSyncCommand",
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "event_service",
                "postExecute": "",
                "alias": "event_service"
            },
            {
                "event": "onBackgroundCommand",
                "listener": "menu_2",
                "action": "run",
                "type": "set",
                "method": "UpdateConfigurations",
                "postExecute": ""
            },
            {
                "event": "onSQLError",
                "listener": "",
                "action": "run",
                "type": "set",
                "method": "beep",
                "postExecute": ""
            },
            {
                "listener": "",
                "action": "run",
                "type": "python",
                "method": "timer_update",
                "postExecute": "",
                "alias": "timer_update"
            }
        ]
    }
}